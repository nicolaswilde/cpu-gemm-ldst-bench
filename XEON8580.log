cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   919   626  1600
Test passed: M N K =   305   995  1600
Test passed: M N K =  1499   830  1152
Test passed: M N K =  1794   416  1856
Test passed: M N K =  1736  2009   832
M N K =  1024  1024   256, Elapsed time =   0.003735 s, Result = 59060000, Performance =   1.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004546 s, Result = a10b0000, Performance =   2.36 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005952 s, Result = e9100000, Performance =   2.71 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006427 s, Result = 31150000, Performance =   3.34 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007150 s, Result = 791a0000, Performance =   3.75 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008237 s, Result = c11f0000, Performance =   3.91 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008916 s, Result = 09240000, Performance =   4.21 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009972 s, Result = 51290000, Performance =   4.31 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010662 s, Result = 992e0000, Performance =   4.53 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011521 s, Result = e1330000, Performance =   4.66 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012555 s, Result = 29380000, Performance =   4.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013525 s, Result = 713d0000, Performance =   4.76 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014495 s, Result = b9420000, Performance =   4.81 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015212 s, Result = 01470000, Performance =   4.94 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016584 s, Result = 494c0000, Performance =   4.86 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017289 s, Result = 91510000, Performance =   4.97 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018690 s, Result = d9560000, Performance =   4.88 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019215 s, Result = 215b0000, Performance =   5.03 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020311 s, Result = 69600000, Performance =   5.02 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021090 s, Result = b1650000, Performance =   5.09 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021881 s, Result = f96a0000, Performance =   5.15 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022899 s, Result = 416f0000, Performance =   5.16 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023761 s, Result = 89740000, Performance =   5.20 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025005 s, Result = d1790000, Performance =   5.15 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025680 s, Result = 197e0000, Performance =   5.23 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026531 s, Result = 61830000, Performance =   5.26 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027626 s, Result = a9880000, Performance =   5.25 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029045 s, Result = f18d0000, Performance =   5.18 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030007 s, Result = 39920000, Performance =   5.19 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030344 s, Result = 81970000, Performance =   5.31 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031192 s, Result = c99c0000, Performance =   5.34 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032333 s, Result = 11a10000, Performance =   5.31 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032760 s, Result = 59a60000, Performance =   5.41 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033550 s, Result = a1ab0000, Performance =   5.44 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034874 s, Result = e9b00000, Performance =   5.39 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.036083 s, Result = 31b50000, Performance =   5.36 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036353 s, Result = 79ba0000, Performance =   5.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.037248 s, Result = c1bf0000, Performance =   5.48 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038264 s, Result = 09c40000, Performance =   5.47 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038859 s, Result = 51c90000, Performance =   5.53 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040367 s, Result = 99ce0000, Performance =   5.45 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040462 s, Result = e1d30000, Performance =   5.57 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041529 s, Result = 29d80000, Performance =   5.56 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042224 s, Result = 71dd0000, Performance =   5.59 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043247 s, Result = b9e20000, Performance =   5.59 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.045086 s, Result = 01e70000, Performance =   5.48 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.045976 s, Result = 49ec0000, Performance =   5.49 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046178 s, Result = 91f10000, Performance =   5.58 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.047242 s, Result = d9f60000, Performance =   5.57 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047789 s, Result = 21fb0000, Performance =   5.62 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048767 s, Result = 6a000000, Performance =   5.61 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.050230 s, Result = b2050000, Performance =   5.56 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050815 s, Result = fa0a0000, Performance =   5.60 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.051159 s, Result = 420f0000, Performance =   5.67 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051901 s, Result = 8a140000, Performance =   5.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.053646 s, Result = d2190000, Performance =   5.60 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.054097 s, Result = 1a1e0000, Performance =   5.66 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.054387 s, Result = 62230000, Performance =   5.73 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055603 s, Result = aa280000, Performance =   5.70 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.056466 s, Result = f22d0000, Performance =   5.70 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.057677 s, Result = 3a320000, Performance =   5.68 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058261 s, Result = 82370000, Performance =   5.71 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.059025 s, Result = ca3c0000, Performance =   5.73 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.060576 s, Result = 12410000, Performance =   5.67 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   712   905  1792
Test passed: M N K =   754   241  1088
Test passed: M N K =   448   819   384
Test passed: M N K =  1478   235  1920
Test passed: M N K =  1133   919   512
M N K =  1024  1024   256, Elapsed time =   0.003077 s, Result = 00050000, Performance =   1.74 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004692 s, Result = 000a0000, Performance =   2.29 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005056 s, Result = 000f0000, Performance =   3.19 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005740 s, Result = 00140000, Performance =   3.74 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006624 s, Result = 00190000, Performance =   4.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007403 s, Result = 001e0000, Performance =   4.35 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008096 s, Result = 00230000, Performance =   4.64 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009358 s, Result = 00280000, Performance =   4.59 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011894 s, Result = 002d0000, Performance =   4.06 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011665 s, Result = 00320000, Performance =   4.60 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012818 s, Result = 00370000, Performance =   4.61 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014086 s, Result = 003c0000, Performance =   4.57 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014632 s, Result = 00410000, Performance =   4.77 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016194 s, Result = 00460000, Performance =   4.64 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016318 s, Result = 004b0000, Performance =   4.94 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017564 s, Result = 00500000, Performance =   4.89 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017880 s, Result = 00550000, Performance =   5.10 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019152 s, Result = 005a0000, Performance =   5.05 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019279 s, Result = 005f0000, Performance =   5.29 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020327 s, Result = 00640000, Performance =   5.28 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021152 s, Result = 00690000, Performance =   5.33 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022082 s, Result = 006e0000, Performance =   5.35 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023320 s, Result = 00730000, Performance =   5.29 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024484 s, Result = 00780000, Performance =   5.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024960 s, Result = 007d0000, Performance =   5.38 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025696 s, Result = 00820000, Performance =   5.43 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026670 s, Result = 00870000, Performance =   5.44 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027642 s, Result = 008c0000, Performance =   5.44 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028294 s, Result = 00910000, Performance =   5.50 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029183 s, Result = 00960000, Performance =   5.52 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030665 s, Result = 009b0000, Performance =   5.43 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031529 s, Result = 00a00000, Performance =   5.45 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032275 s, Result = 00a50000, Performance =   5.49 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032796 s, Result = 00aa0000, Performance =   5.57 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033999 s, Result = 00af0000, Performance =   5.53 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034627 s, Result = 00b40000, Performance =   5.58 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035402 s, Result = 00b90000, Performance =   5.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036310 s, Result = 00be0000, Performance =   5.62 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037182 s, Result = 00c30000, Performance =   5.63 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038459 s, Result = 00c80000, Performance =   5.58 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.038798 s, Result = 00cd0000, Performance =   5.67 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040094 s, Result = 00d20000, Performance =   5.62 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040765 s, Result = 00d70000, Performance =   5.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041676 s, Result = 00dc0000, Performance =   5.67 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.042033 s, Result = 00e10000, Performance =   5.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043975 s, Result = 00e60000, Performance =   5.62 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044137 s, Result = 00eb0000, Performance =   5.72 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046138 s, Result = 00f00000, Performance =   5.59 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045515 s, Result = 00f50000, Performance =   5.78 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.046553 s, Result = 00fa0000, Performance =   5.77 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047487 s, Result = 00ff0000, Performance =   5.77 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048148 s, Result = 01040000, Performance =   5.80 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048827 s, Result = 01090000, Performance =   5.83 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.049782 s, Result = 010e0000, Performance =   5.82 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051116 s, Result = 01130000, Performance =   5.78 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052069 s, Result = 01180000, Performance =   5.77 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.052905 s, Result = 011d0000, Performance =   5.78 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.053263 s, Result = 01220000, Performance =   5.85 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054255 s, Result = 01270000, Performance =   5.84 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055072 s, Result = 012c0000, Performance =   5.85 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.055863 s, Result = 01310000, Performance =   5.86 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.057140 s, Result = 01360000, Performance =   5.83 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.057512 s, Result = 013b0000, Performance =   5.88 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.061736 s, Result = 01400000, Performance =   5.57 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   147   148   640
Test passed: M N K =  1965   514   768
Test passed: M N K =   270   365  1856
Test passed: M N K =   549  1512  1408
Test passed: M N K =   138   408   128
M N K =  1024  1024   256, Elapsed time =   0.002485 s, Result = 0a0f0000, Performance =   2.16 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003216 s, Result = 0a140000, Performance =   3.34 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004273 s, Result = 0a190000, Performance =   3.77 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004924 s, Result = 0a1e0000, Performance =   4.36 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005829 s, Result = 0a230000, Performance =   4.61 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006552 s, Result = 0a280000, Performance =   4.92 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007284 s, Result = 0a2d0000, Performance =   5.16 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008189 s, Result = 0a320000, Performance =   5.24 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009192 s, Result = 0a370000, Performance =   5.26 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009741 s, Result = 0a3c0000, Performance =   5.51 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010617 s, Result = 0a410000, Performance =   5.56 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011585 s, Result = 0a460000, Performance =   5.56 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012474 s, Result = 0a4b0000, Performance =   5.60 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013134 s, Result = 0a500000, Performance =   5.72 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014093 s, Result = 0a550000, Performance =   5.71 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015545 s, Result = 0a5a0000, Performance =   5.53 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015896 s, Result = 0a5f0000, Performance =   5.74 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016954 s, Result = 0a640000, Performance =   5.70 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018040 s, Result = 0a690000, Performance =   5.65 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018974 s, Result = 0a6e0000, Performance =   5.66 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020058 s, Result = 0a730000, Performance =   5.62 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020983 s, Result = 0a780000, Performance =   5.63 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021860 s, Result = 0a7d0000, Performance =   5.65 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022969 s, Result = 0a820000, Performance =   5.61 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023744 s, Result = 0a870000, Performance =   5.65 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024848 s, Result = 0a8c0000, Performance =   5.62 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025486 s, Result = 0a910000, Performance =   5.69 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026849 s, Result = 0a960000, Performance =   5.60 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027414 s, Result = 0a9b0000, Performance =   5.68 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028444 s, Result = 0aa00000, Performance =   5.66 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029189 s, Result = 0aa50000, Performance =   5.70 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031653 s, Result = 0aaa0000, Performance =   5.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.030880 s, Result = 0aaf0000, Performance =   5.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032331 s, Result = 0ab40000, Performance =   5.65 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.032876 s, Result = 0ab90000, Performance =   5.72 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033546 s, Result = 0abe0000, Performance =   5.76 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034489 s, Result = 0ac30000, Performance =   5.76 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035425 s, Result = 0ac80000, Performance =   5.76 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.035916 s, Result = 0acd0000, Performance =   5.83 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037556 s, Result = 0ad20000, Performance =   5.72 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.037742 s, Result = 0ad70000, Performance =   5.83 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.038683 s, Result = 0adc0000, Performance =   5.83 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.039607 s, Result = 0ae10000, Performance =   5.83 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.040654 s, Result = 0ae60000, Performance =   5.81 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.041263 s, Result = 0aeb0000, Performance =   5.85 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.042013 s, Result = 0af00000, Performance =   5.88 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042715 s, Result = 0af50000, Performance =   5.91 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.044298 s, Result = 0afa0000, Performance =   5.82 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.044935 s, Result = 0aff0000, Performance =   5.85 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.045543 s, Result = 0b040000, Performance =   5.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.046266 s, Result = 0b090000, Performance =   5.92 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.047590 s, Result = 0b0e0000, Performance =   5.87 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048066 s, Result = 0b130000, Performance =   5.92 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.048902 s, Result = 0b180000, Performance =   5.93 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.049418 s, Result = 0b1d0000, Performance =   5.98 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.050804 s, Result = 0b220000, Performance =   5.92 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.051662 s, Result = 0b270000, Performance =   5.92 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.052025 s, Result = 0b2c0000, Performance =   5.99 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.053040 s, Result = 0b310000, Performance =   5.97 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.054333 s, Result = 0b360000, Performance =   5.93 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.054819 s, Result = 0b3b0000, Performance =   5.97 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.055962 s, Result = 0b400000, Performance =   5.95 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.056375 s, Result = 0b450000, Performance =   6.00 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.059155 s, Result = 0b4a0000, Performance =   5.81 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   986   752   896
Test passed: M N K =    61   622  1792
Test passed: M N K =  1877   506   128
Test passed: M N K =  1809  1189  1472
Test passed: M N K =   618  2035   640
M N K =  1024  1024   256, Elapsed time =   0.000741 s, Result = 00050000, Performance =   7.25 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001515 s, Result = 000a0000, Performance =   7.09 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002093 s, Result = 000f0000, Performance =   7.70 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002849 s, Result = 00140000, Performance =   7.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003698 s, Result = 00190000, Performance =   7.26 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004666 s, Result = 001e0000, Performance =   6.90 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005425 s, Result = 00230000, Performance =   6.93 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006762 s, Result = 00280000, Performance =   6.35 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007455 s, Result = 002d0000, Performance =   6.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008155 s, Result = 00320000, Performance =   6.58 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009376 s, Result = 00370000, Performance =   6.30 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009685 s, Result = 003c0000, Performance =   6.65 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010123 s, Result = 00410000, Performance =   6.89 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010993 s, Result = 00460000, Performance =   6.84 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011383 s, Result = 004b0000, Performance =   7.07 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013318 s, Result = 00500000, Performance =   6.45 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013430 s, Result = 00550000, Performance =   6.80 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014311 s, Result = 005a0000, Performance =   6.75 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016035 s, Result = 005f0000, Performance =   6.36 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016532 s, Result = 00640000, Performance =   6.49 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017513 s, Result = 00690000, Performance =   6.44 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018429 s, Result = 006e0000, Performance =   6.41 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019608 s, Result = 00730000, Performance =   6.30 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020180 s, Result = 00780000, Performance =   6.39 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021258 s, Result = 007d0000, Performance =   6.31 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022350 s, Result = 00820000, Performance =   6.25 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023167 s, Result = 00870000, Performance =   6.26 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024566 s, Result = 008c0000, Performance =   6.12 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025318 s, Result = 00910000, Performance =   6.15 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026253 s, Result = 00960000, Performance =   6.13 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026704 s, Result = 009b0000, Performance =   6.23 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.028630 s, Result = 00a00000, Performance =   6.00 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029055 s, Result = 00a50000, Performance =   6.10 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029235 s, Result = 00aa0000, Performance =   6.24 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030042 s, Result = 00af0000, Performance =   6.25 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.031731 s, Result = 00b40000, Performance =   6.09 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031749 s, Result = 00b90000, Performance =   6.26 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032740 s, Result = 00be0000, Performance =   6.23 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.033471 s, Result = 00c30000, Performance =   6.26 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.035204 s, Result = 00c80000, Performance =   6.10 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034897 s, Result = 00cd0000, Performance =   6.31 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036522 s, Result = 00d20000, Performance =   6.17 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037170 s, Result = 00d70000, Performance =   6.21 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.038460 s, Result = 00dc0000, Performance =   6.14 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.038875 s, Result = 00e10000, Performance =   6.21 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040377 s, Result = 00e60000, Performance =   6.12 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.040335 s, Result = 00eb0000, Performance =   6.26 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042296 s, Result = 00f00000, Performance =   6.09 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.041997 s, Result = 00f50000, Performance =   6.26 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043815 s, Result = 00fa0000, Performance =   6.13 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.044438 s, Result = 00ff0000, Performance =   6.16 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.045480 s, Result = 01040000, Performance =   6.14 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.045435 s, Result = 01090000, Performance =   6.26 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.047049 s, Result = 010e0000, Performance =   6.16 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.047320 s, Result = 01130000, Performance =   6.24 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.048805 s, Result = 01180000, Performance =   6.16 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.049217 s, Result = 011d0000, Performance =   6.22 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.050665 s, Result = 01220000, Performance =   6.15 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051089 s, Result = 01270000, Performance =   6.20 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051855 s, Result = 012c0000, Performance =   6.21 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052869 s, Result = 01310000, Performance =   6.19 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053951 s, Result = 01360000, Performance =   6.17 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.054715 s, Result = 013b0000, Performance =   6.18 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.056609 s, Result = 01400000, Performance =   6.07 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1994  1507   576
Test passed: M N K =   219   636   384
Test passed: M N K =  1222  1791  1856
Test passed: M N K =    19   306  1344
Test passed: M N K =   209   609   640
M N K =  1024  1024   256, Elapsed time =   0.003887 s, Result = 59060000, Performance =   1.38 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004740 s, Result = a10b0000, Performance =   2.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005808 s, Result = e9100000, Performance =   2.77 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006720 s, Result = 31150000, Performance =   3.20 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007647 s, Result = 791a0000, Performance =   3.51 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008414 s, Result = c11f0000, Performance =   3.83 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009545 s, Result = 09240000, Performance =   3.94 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010583 s, Result = 51290000, Performance =   4.06 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011478 s, Result = 992e0000, Performance =   4.21 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012362 s, Result = e1330000, Performance =   4.34 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013450 s, Result = 29380000, Performance =   4.39 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014430 s, Result = 713d0000, Performance =   4.46 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015292 s, Result = b9420000, Performance =   4.56 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016798 s, Result = 01470000, Performance =   4.47 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017252 s, Result = 494c0000, Performance =   4.67 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021289 s, Result = 91510000, Performance =   4.03 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019765 s, Result = d9560000, Performance =   4.62 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020451 s, Result = 215b0000, Performance =   4.73 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021111 s, Result = 69600000, Performance =   4.83 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022477 s, Result = b1650000, Performance =   4.78 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023377 s, Result = f96a0000, Performance =   4.82 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024158 s, Result = 416f0000, Performance =   4.89 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025313 s, Result = 89740000, Performance =   4.88 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027306 s, Result = d1790000, Performance =   4.72 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026786 s, Result = 197e0000, Performance =   5.01 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027733 s, Result = 61830000, Performance =   5.03 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029236 s, Result = a9880000, Performance =   4.96 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029904 s, Result = f18d0000, Performance =   5.03 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.031344 s, Result = 39920000, Performance =   4.97 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031794 s, Result = 81970000, Performance =   5.07 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032802 s, Result = c99c0000, Performance =   5.07 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.040436 s, Result = 11a10000, Performance =   4.25 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.034358 s, Result = 59a60000, Performance =   5.16 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.035303 s, Result = a1ab0000, Performance =   5.17 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035833 s, Result = e9b00000, Performance =   5.24 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037113 s, Result = 31b50000, Performance =   5.21 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.038050 s, Result = 79ba0000, Performance =   5.22 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038306 s, Result = c1bf0000, Performance =   5.33 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040322 s, Result = 09c40000, Performance =   5.19 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.042762 s, Result = 51c90000, Performance =   5.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041578 s, Result = 99ce0000, Performance =   5.29 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.042664 s, Result = e1d30000, Performance =   5.29 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042995 s, Result = 29d80000, Performance =   5.37 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044688 s, Result = 71dd0000, Performance =   5.29 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.045565 s, Result = b9e20000, Performance =   5.30 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.046120 s, Result = 01e70000, Performance =   5.35 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046274 s, Result = 49ec0000, Performance =   5.45 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.056313 s, Result = 91f10000, Performance =   4.58 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.048267 s, Result = d9f60000, Performance =   5.45 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.049758 s, Result = 21fb0000, Performance =   5.39 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.049579 s, Result = 6a000000, Performance =   5.52 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.051290 s, Result = b2050000, Performance =   5.44 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.051601 s, Result = fa0a0000, Performance =   5.51 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052503 s, Result = 420f0000, Performance =   5.52 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.053218 s, Result = 8a140000, Performance =   5.55 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.057550 s, Result = d2190000, Performance =   5.22 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.055105 s, Result = 1a1e0000, Performance =   5.55 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.056357 s, Result = 62230000, Performance =   5.53 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.057154 s, Result = aa280000, Performance =   5.54 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.058198 s, Result = f22d0000, Performance =   5.53 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.059094 s, Result = 3a320000, Performance =   5.54 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.060145 s, Result = 82370000, Performance =   5.53 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.060606 s, Result = ca3c0000, Performance =   5.58 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.083775 s, Result = 12410000, Performance =   4.10 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   445     6  1536
Test passed: M N K =  1226   525  1216
Test passed: M N K =   866   149  1088
Test passed: M N K =  1378  1488  1088
Test passed: M N K =   464   929   640
M N K =  1024  1024   256, Elapsed time =   0.003124 s, Result = 00050000, Performance =   1.72 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003997 s, Result = 000a0000, Performance =   2.69 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005577 s, Result = 000f0000, Performance =   2.89 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005928 s, Result = 00140000, Performance =   3.62 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006940 s, Result = 00190000, Performance =   3.87 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007929 s, Result = 001e0000, Performance =   4.06 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009181 s, Result = 00230000, Performance =   4.09 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009540 s, Result = 00280000, Performance =   4.50 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010403 s, Result = 002d0000, Performance =   4.64 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011127 s, Result = 00320000, Performance =   4.82 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012075 s, Result = 00370000, Performance =   4.89 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013871 s, Result = 003c0000, Performance =   4.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014024 s, Result = 00410000, Performance =   4.98 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014915 s, Result = 00460000, Performance =   5.04 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016152 s, Result = 004b0000, Performance =   4.99 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019661 s, Result = 00500000, Performance =   4.37 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017976 s, Result = 00550000, Performance =   5.08 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018966 s, Result = 005a0000, Performance =   5.10 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019996 s, Result = 005f0000, Performance =   5.10 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021336 s, Result = 00640000, Performance =   5.03 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021746 s, Result = 00690000, Performance =   5.18 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022962 s, Result = 006e0000, Performance =   5.14 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024032 s, Result = 00730000, Performance =   5.14 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026767 s, Result = 00780000, Performance =   4.81 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027138 s, Result = 007d0000, Performance =   4.95 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027570 s, Result = 00820000, Performance =   5.06 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027986 s, Result = 00870000, Performance =   5.18 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029656 s, Result = 008c0000, Performance =   5.07 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030217 s, Result = 00910000, Performance =   5.15 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031078 s, Result = 00960000, Performance =   5.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031349 s, Result = 009b0000, Performance =   5.31 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.043519 s, Result = 00a00000, Performance =   3.95 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032510 s, Result = 00a50000, Performance =   5.45 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034126 s, Result = 00aa0000, Performance =   5.35 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034453 s, Result = 00af0000, Performance =   5.45 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.036448 s, Result = 00b40000, Performance =   5.30 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036394 s, Result = 00b90000, Performance =   5.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038020 s, Result = 00be0000, Performance =   5.37 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038134 s, Result = 00c30000, Performance =   5.49 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040988 s, Result = 00c80000, Performance =   5.24 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040373 s, Result = 00cd0000, Performance =   5.45 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041478 s, Result = 00d20000, Performance =   5.44 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041497 s, Result = 00d70000, Performance =   5.56 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042963 s, Result = 00dc0000, Performance =   5.50 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043546 s, Result = 00e10000, Performance =   5.55 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.044973 s, Result = 00e60000, Performance =   5.49 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.045360 s, Result = 00eb0000, Performance =   5.56 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.054450 s, Result = 00f00000, Performance =   4.73 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.047220 s, Result = 00f50000, Performance =   5.57 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.048495 s, Result = 00fa0000, Performance =   5.54 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048586 s, Result = 00ff0000, Performance =   5.64 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.049509 s, Result = 01040000, Performance =   5.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050689 s, Result = 01090000, Performance =   5.61 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052169 s, Result = 010e0000, Performance =   5.56 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051999 s, Result = 01130000, Performance =   5.68 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.055315 s, Result = 01180000, Performance =   5.44 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053539 s, Result = 011d0000, Performance =   5.72 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055714 s, Result = 01220000, Performance =   5.59 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055506 s, Result = 01270000, Performance =   5.71 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.057131 s, Result = 012c0000, Performance =   5.64 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.056770 s, Result = 01310000, Performance =   5.77 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058339 s, Result = 01360000, Performance =   5.71 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.058758 s, Result = 013b0000, Performance =   5.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.079872 s, Result = 01400000, Performance =   4.30 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   263  2033   256
Test passed: M N K =   524  1604   256
Test passed: M N K =   981   211  1536
Test passed: M N K =  1495  1852   320
Test passed: M N K =   481  1113  1728
M N K =  1024  1024   256, Elapsed time =   0.002587 s, Result = 0a0f0000, Performance =   2.08 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003386 s, Result = 0a140000, Performance =   3.17 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004618 s, Result = 0a190000, Performance =   3.49 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005372 s, Result = 0a1e0000, Performance =   4.00 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006687 s, Result = 0a230000, Performance =   4.01 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007001 s, Result = 0a280000, Performance =   4.60 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007968 s, Result = 0a2d0000, Performance =   4.72 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008896 s, Result = 0a320000, Performance =   4.83 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009501 s, Result = 0a370000, Performance =   5.09 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010450 s, Result = 0a3c0000, Performance =   5.14 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011191 s, Result = 0a410000, Performance =   5.28 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011901 s, Result = 0a460000, Performance =   5.41 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013318 s, Result = 0a4b0000, Performance =   5.24 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014281 s, Result = 0a500000, Performance =   5.26 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014669 s, Result = 0a550000, Performance =   5.49 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017483 s, Result = 0a5a0000, Performance =   4.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016767 s, Result = 0a5f0000, Performance =   5.44 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017609 s, Result = 0a640000, Performance =   5.49 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018792 s, Result = 0a690000, Performance =   5.43 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019658 s, Result = 0a6e0000, Performance =   5.46 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020299 s, Result = 0a730000, Performance =   5.55 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021866 s, Result = 0a780000, Performance =   5.40 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022574 s, Result = 0a7d0000, Performance =   5.47 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024561 s, Result = 0a820000, Performance =   5.25 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024304 s, Result = 0a870000, Performance =   5.52 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026010 s, Result = 0a8c0000, Performance =   5.37 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026528 s, Result = 0a910000, Performance =   5.46 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027387 s, Result = 0a960000, Performance =   5.49 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028119 s, Result = 0a9b0000, Performance =   5.54 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029471 s, Result = 0aa00000, Performance =   5.47 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029955 s, Result = 0aa50000, Performance =   5.56 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037787 s, Result = 0aaa0000, Performance =   4.55 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.031415 s, Result = 0aaf0000, Performance =   5.64 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032396 s, Result = 0ab40000, Performance =   5.63 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033857 s, Result = 0ab90000, Performance =   5.55 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034760 s, Result = 0abe0000, Performance =   5.56 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035286 s, Result = 0ac30000, Performance =   5.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036255 s, Result = 0ac80000, Performance =   5.63 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037188 s, Result = 0acd0000, Performance =   5.63 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040271 s, Result = 0ad20000, Performance =   5.33 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039049 s, Result = 0ad70000, Performance =   5.64 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040012 s, Result = 0adc0000, Performance =   5.64 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040812 s, Result = 0ae10000, Performance =   5.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041886 s, Result = 0ae60000, Performance =   5.64 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.042224 s, Result = 0aeb0000, Performance =   5.72 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043407 s, Result = 0af00000, Performance =   5.69 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044212 s, Result = 0af50000, Performance =   5.71 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.054006 s, Result = 0afa0000, Performance =   4.77 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045738 s, Result = 0aff0000, Performance =   5.75 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.046816 s, Result = 0b040000, Performance =   5.73 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047554 s, Result = 0b090000, Performance =   5.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.049091 s, Result = 0b0e0000, Performance =   5.69 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.049504 s, Result = 0b130000, Performance =   5.75 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050250 s, Result = 0b180000, Performance =   5.77 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051241 s, Result = 0b1d0000, Performance =   5.76 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.055025 s, Result = 0b220000, Performance =   5.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.052661 s, Result = 0b270000, Performance =   5.81 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.053915 s, Result = 0b2c0000, Performance =   5.78 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054734 s, Result = 0b310000, Performance =   5.79 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055815 s, Result = 0b360000, Performance =   5.77 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.055951 s, Result = 0b3b0000, Performance =   5.85 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.056962 s, Result = 0b400000, Performance =   5.84 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.058199 s, Result = 0b450000, Performance =   5.81 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.076546 s, Result = 0b4a0000, Performance =   4.49 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   297  1230  1600
Test passed: M N K =  1888  1981  1088
Test passed: M N K =    34   563  1664
Test passed: M N K =    85   566   320
Test passed: M N K =  2025  1514   192
M N K =  1024  1024   256, Elapsed time =   0.000514 s, Result = 00050000, Performance =  10.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001554 s, Result = 000a0000, Performance =   6.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002656 s, Result = 000f0000, Performance =   6.06 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003095 s, Result = 00140000, Performance =   6.94 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004389 s, Result = 00190000, Performance =   6.12 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005023 s, Result = 001e0000, Performance =   6.41 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005972 s, Result = 00230000, Performance =   6.29 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006482 s, Result = 00280000, Performance =   6.63 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007921 s, Result = 002d0000, Performance =   6.10 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008491 s, Result = 00320000, Performance =   6.32 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009934 s, Result = 00370000, Performance =   5.94 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009238 s, Result = 003c0000, Performance =   6.97 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011165 s, Result = 00410000, Performance =   6.25 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012019 s, Result = 00460000, Performance =   6.25 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012602 s, Result = 004b0000, Performance =   6.39 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014887 s, Result = 00500000, Performance =   5.77 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014612 s, Result = 00550000, Performance =   6.25 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015474 s, Result = 005a0000, Performance =   6.25 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016672 s, Result = 005f0000, Performance =   6.12 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017043 s, Result = 00640000, Performance =   6.30 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018509 s, Result = 00690000, Performance =   6.09 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019201 s, Result = 006e0000, Performance =   6.15 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020151 s, Result = 00730000, Performance =   6.13 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022195 s, Result = 00780000, Performance =   5.81 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022310 s, Result = 007d0000, Performance =   6.02 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022981 s, Result = 00820000, Performance =   6.07 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024222 s, Result = 00870000, Performance =   5.98 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025782 s, Result = 008c0000, Performance =   5.83 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025928 s, Result = 00910000, Performance =   6.00 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026830 s, Result = 00960000, Performance =   6.00 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.028485 s, Result = 009b0000, Performance =   5.84 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034550 s, Result = 00a00000, Performance =   4.97 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029108 s, Result = 00a50000, Performance =   6.09 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.031397 s, Result = 00aa0000, Performance =   5.81 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.031265 s, Result = 00af0000, Performance =   6.01 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.032438 s, Result = 00b40000, Performance =   5.96 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.033359 s, Result = 00b90000, Performance =   5.95 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.033817 s, Result = 00be0000, Performance =   6.03 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.034956 s, Result = 00c30000, Performance =   5.99 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037080 s, Result = 00c80000, Performance =   5.79 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.036774 s, Result = 00cd0000, Performance =   5.99 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.037447 s, Result = 00d20000, Performance =   6.02 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037800 s, Result = 00d70000, Performance =   6.11 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.039558 s, Result = 00dc0000, Performance =   5.97 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.040568 s, Result = 00e10000, Performance =   5.96 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041543 s, Result = 00e60000, Performance =   5.94 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.041961 s, Result = 00eb0000, Performance =   6.01 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.051024 s, Result = 00f00000, Performance =   5.05 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.044625 s, Result = 00f50000, Performance =   5.90 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.045558 s, Result = 00fa0000, Performance =   5.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.045562 s, Result = 00ff0000, Performance =   6.01 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048020 s, Result = 01040000, Performance =   5.81 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.047824 s, Result = 01090000, Performance =   5.95 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.048794 s, Result = 010e0000, Performance =   5.94 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.048954 s, Result = 01130000, Performance =   6.03 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052854 s, Result = 01180000, Performance =   5.69 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.051497 s, Result = 011d0000, Performance =   5.94 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.053257 s, Result = 01220000, Performance =   5.85 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.053286 s, Result = 01270000, Performance =   5.94 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.054370 s, Result = 012c0000, Performance =   5.92 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.054332 s, Result = 01310000, Performance =   6.03 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.055711 s, Result = 01360000, Performance =   5.97 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.056665 s, Result = 013b0000, Performance =   5.97 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.074268 s, Result = 01400000, Performance =   4.63 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   581  1797   832
Test passed: M N K =  1857  1235   896
Test passed: M N K =    87  2015  1152
Test passed: M N K =  1041   528   320
Test passed: M N K =  1040   743  1152
M N K =  1024  1024   256, Elapsed time =   0.003838 s, Result = 59060000, Performance =   1.40 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004729 s, Result = a10b0000, Performance =   2.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005493 s, Result = e9100000, Performance =   2.93 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006586 s, Result = 31150000, Performance =   3.26 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007674 s, Result = 791a0000, Performance =   3.50 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008527 s, Result = c11f0000, Performance =   3.78 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009424 s, Result = 09240000, Performance =   3.99 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010529 s, Result = 51290000, Performance =   4.08 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011974 s, Result = 992e0000, Performance =   4.04 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012979 s, Result = e1330000, Performance =   4.14 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013806 s, Result = 29380000, Performance =   4.28 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014879 s, Result = 713d0000, Performance =   4.33 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016534 s, Result = b9420000, Performance =   4.22 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017519 s, Result = 01470000, Performance =   4.29 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018628 s, Result = 494c0000, Performance =   4.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022544 s, Result = 91510000, Performance =   3.81 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021327 s, Result = d9560000, Performance =   4.28 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023102 s, Result = 215b0000, Performance =   4.18 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.024048 s, Result = 69600000, Performance =   4.24 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025980 s, Result = b1650000, Performance =   4.13 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026607 s, Result = f96a0000, Performance =   4.24 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027841 s, Result = 416f0000, Performance =   4.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028769 s, Result = 89740000, Performance =   4.29 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.030299 s, Result = d1790000, Performance =   4.25 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031341 s, Result = 197e0000, Performance =   4.28 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032257 s, Result = 61830000, Performance =   4.33 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.032982 s, Result = a9880000, Performance =   4.39 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035349 s, Result = f18d0000, Performance =   4.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035825 s, Result = 39920000, Performance =   4.35 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036572 s, Result = 81970000, Performance =   4.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.035918 s, Result = c99c0000, Performance =   4.63 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.045054 s, Result = 11a10000, Performance =   3.81 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039625 s, Result = 59a60000, Performance =   4.47 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040667 s, Result = a1ab0000, Performance =   4.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040921 s, Result = e9b00000, Performance =   4.59 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.043188 s, Result = 31b50000, Performance =   4.48 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043486 s, Result = 79ba0000, Performance =   4.57 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044994 s, Result = c1bf0000, Performance =   4.53 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.044804 s, Result = 09c40000, Performance =   4.67 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046189 s, Result = 51c90000, Performance =   4.65 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.048115 s, Result = 99ce0000, Performance =   4.57 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.048675 s, Result = e1d30000, Performance =   4.63 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050830 s, Result = 29d80000, Performance =   4.54 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051744 s, Result = 71dd0000, Performance =   4.57 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.051128 s, Result = b9e20000, Performance =   4.73 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053123 s, Result = 01e70000, Performance =   4.65 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.053343 s, Result = 49ec0000, Performance =   4.73 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.062195 s, Result = 91f10000, Performance =   4.14 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056002 s, Result = d9f60000, Performance =   4.70 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057084 s, Result = 21fb0000, Performance =   4.70 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.056803 s, Result = 6a000000, Performance =   4.82 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.060982 s, Result = b2050000, Performance =   4.58 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059847 s, Result = fa0a0000, Performance =   4.75 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.061537 s, Result = 420f0000, Performance =   4.71 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.062464 s, Result = 8a140000, Performance =   4.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.062789 s, Result = d2190000, Performance =   4.79 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.064542 s, Result = 1a1e0000, Performance =   4.74 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.064728 s, Result = 62230000, Performance =   4.81 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.065785 s, Result = aa280000, Performance =   4.81 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.068685 s, Result = f22d0000, Performance =   4.69 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.068690 s, Result = 3a320000, Performance =   4.77 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.069074 s, Result = 82370000, Performance =   4.82 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.068750 s, Result = ca3c0000, Performance =   4.92 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.085298 s, Result = 12410000, Performance =   4.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   444   358  1792
Test passed: M N K =   605  1186    64
Test passed: M N K =   396   744  1408
Test passed: M N K =  1439  1031  1984
Test passed: M N K =   968   548  1984
M N K =  1024  1024   256, Elapsed time =   0.003125 s, Result = 00050000, Performance =   1.72 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003998 s, Result = 000a0000, Performance =   2.69 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005396 s, Result = 000f0000, Performance =   2.98 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005853 s, Result = 00140000, Performance =   3.67 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009021 s, Result = 00190000, Performance =   2.98 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008253 s, Result = 001e0000, Performance =   3.90 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009352 s, Result = 00230000, Performance =   4.02 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010057 s, Result = 00280000, Performance =   4.27 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011090 s, Result = 002d0000, Performance =   4.36 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012645 s, Result = 00320000, Performance =   4.25 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013154 s, Result = 00370000, Performance =   4.49 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013627 s, Result = 003c0000, Performance =   4.73 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014811 s, Result = 00410000, Performance =   4.71 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015949 s, Result = 00460000, Performance =   4.71 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017675 s, Result = 004b0000, Performance =   4.56 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021955 s, Result = 00500000, Performance =   3.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020598 s, Result = 00550000, Performance =   4.43 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021907 s, Result = 005a0000, Performance =   4.41 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023081 s, Result = 005f0000, Performance =   4.42 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025361 s, Result = 00640000, Performance =   4.23 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.025602 s, Result = 00690000, Performance =   4.40 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027262 s, Result = 006e0000, Performance =   4.33 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028064 s, Result = 00730000, Performance =   4.40 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.028449 s, Result = 00780000, Performance =   4.53 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.029588 s, Result = 007d0000, Performance =   4.54 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030755 s, Result = 00820000, Performance =   4.54 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.031658 s, Result = 00870000, Performance =   4.58 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033577 s, Result = 008c0000, Performance =   4.48 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.034628 s, Result = 00910000, Performance =   4.50 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034534 s, Result = 00960000, Performance =   4.66 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.035315 s, Result = 009b0000, Performance =   4.71 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.042262 s, Result = 00a00000, Performance =   4.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.037741 s, Result = 00a50000, Performance =   4.69 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.038989 s, Result = 00aa0000, Performance =   4.68 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.038913 s, Result = 00af0000, Performance =   4.83 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.042508 s, Result = 00b40000, Performance =   4.55 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.042860 s, Result = 00b90000, Performance =   4.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.043224 s, Result = 00be0000, Performance =   4.72 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.044038 s, Result = 00c30000, Performance =   4.75 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044912 s, Result = 00c80000, Performance =   4.78 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.046464 s, Result = 00cd0000, Performance =   4.74 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046919 s, Result = 00d20000, Performance =   4.81 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.048703 s, Result = 00d70000, Performance =   4.74 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.049928 s, Result = 00dc0000, Performance =   4.73 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.050831 s, Result = 00e10000, Performance =   4.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.051645 s, Result = 00e60000, Performance =   4.78 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.052136 s, Result = 00eb0000, Performance =   4.84 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.061527 s, Result = 00f00000, Performance =   4.19 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054432 s, Result = 00f50000, Performance =   4.83 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.055702 s, Result = 00fa0000, Performance =   4.82 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.055393 s, Result = 00ff0000, Performance =   4.94 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059127 s, Result = 01040000, Performance =   4.72 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059231 s, Result = 01090000, Performance =   4.80 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.060624 s, Result = 010e0000, Performance =   4.78 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.061131 s, Result = 01130000, Performance =   4.83 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.060842 s, Result = 01180000, Performance =   4.94 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.063181 s, Result = 011d0000, Performance =   4.84 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.062814 s, Result = 01220000, Performance =   4.96 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.063966 s, Result = 01270000, Performance =   4.95 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.066144 s, Result = 012c0000, Performance =   4.87 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.066860 s, Result = 01310000, Performance =   4.90 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.066513 s, Result = 01360000, Performance =   5.00 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.066612 s, Result = 013b0000, Performance =   5.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.082784 s, Result = 01400000, Performance =   4.15 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1039  1875  1600
Test passed: M N K =  1793   599  1216
Test passed: M N K =   642  1468  1472
Test passed: M N K =    61  1167  1856
Test passed: M N K =  1358   987   576
M N K =  1024  1024   256, Elapsed time =   0.002642 s, Result = 0a0f0000, Performance =   2.03 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003756 s, Result = 0a140000, Performance =   2.86 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004469 s, Result = 0a190000, Performance =   3.60 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005305 s, Result = 0a1e0000, Performance =   4.05 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006224 s, Result = 0a230000, Performance =   4.31 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007095 s, Result = 0a280000, Performance =   4.54 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008306 s, Result = 0a2d0000, Performance =   4.52 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009024 s, Result = 0a320000, Performance =   4.76 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010087 s, Result = 0a370000, Performance =   4.79 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011524 s, Result = 0a3c0000, Performance =   4.66 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012437 s, Result = 0a410000, Performance =   4.75 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013452 s, Result = 0a460000, Performance =   4.79 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014068 s, Result = 0a4b0000, Performance =   4.96 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015330 s, Result = 0a500000, Performance =   4.90 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016318 s, Result = 0a550000, Performance =   4.94 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019816 s, Result = 0a5a0000, Performance =   4.33 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019152 s, Result = 0a5f0000, Performance =   4.77 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020037 s, Result = 0a640000, Performance =   4.82 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021477 s, Result = 0a690000, Performance =   4.75 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023082 s, Result = 0a6e0000, Performance =   4.65 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024184 s, Result = 0a730000, Performance =   4.66 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025006 s, Result = 0a780000, Performance =   4.72 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026372 s, Result = 0a7d0000, Performance =   4.68 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027096 s, Result = 0a820000, Performance =   4.76 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028709 s, Result = 0a870000, Performance =   4.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029332 s, Result = 0a8c0000, Performance =   4.76 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030319 s, Result = 0a910000, Performance =   4.78 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.032524 s, Result = 0a960000, Performance =   4.62 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.032857 s, Result = 0a9b0000, Performance =   4.74 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.033756 s, Result = 0aa00000, Performance =   4.77 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.034147 s, Result = 0aa50000, Performance =   4.87 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.041363 s, Result = 0aaa0000, Performance =   4.15 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.036886 s, Result = 0aaf0000, Performance =   4.80 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.037689 s, Result = 0ab40000, Performance =   4.84 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.038621 s, Result = 0ab90000, Performance =   4.87 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041294 s, Result = 0abe0000, Performance =   4.68 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041524 s, Result = 0ac30000, Performance =   4.78 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042200 s, Result = 0ac80000, Performance =   4.83 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043678 s, Result = 0acd0000, Performance =   4.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.043836 s, Result = 0ad20000, Performance =   4.90 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.044838 s, Result = 0ad70000, Performance =   4.91 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.044691 s, Result = 0adc0000, Performance =   5.05 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.047299 s, Result = 0ae10000, Performance =   4.88 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.049856 s, Result = 0ae60000, Performance =   4.74 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049085 s, Result = 0aeb0000, Performance =   4.92 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.050726 s, Result = 0af00000, Performance =   4.87 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.051135 s, Result = 0af50000, Performance =   4.93 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.059392 s, Result = 0afa0000, Performance =   4.34 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.053553 s, Result = 0aff0000, Performance =   4.91 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.054577 s, Result = 0b040000, Performance =   4.92 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.054635 s, Result = 0b090000, Performance =   5.01 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.058074 s, Result = 0b0e0000, Performance =   4.81 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.057964 s, Result = 0b130000, Performance =   4.91 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.058412 s, Result = 0b180000, Performance =   4.96 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.059095 s, Result = 0b1d0000, Performance =   5.00 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.061196 s, Result = 0b220000, Performance =   4.91 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.062823 s, Result = 0b270000, Performance =   4.87 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.062541 s, Result = 0b2c0000, Performance =   4.98 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.063753 s, Result = 0b310000, Performance =   4.97 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.065780 s, Result = 0b360000, Performance =   4.90 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.065814 s, Result = 0b3b0000, Performance =   4.98 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.066365 s, Result = 0b400000, Performance =   5.02 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.066279 s, Result = 0b450000, Performance =   5.10 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.084300 s, Result = 0b4a0000, Performance =   4.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   196   560  1344
Test passed: M N K =    73   366   320
Test passed: M N K =  1806   174  1472
Test passed: M N K =  1890   296  1280
Test passed: M N K =  1167   790  1984
M N K =  1024  1024   256, Elapsed time =   0.000657 s, Result = 00050000, Performance =   8.18 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001574 s, Result = 000a0000, Performance =   6.82 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001946 s, Result = 000f0000, Performance =   8.28 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003520 s, Result = 00140000, Performance =   6.10 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003861 s, Result = 00190000, Performance =   6.95 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005100 s, Result = 001e0000, Performance =   6.32 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006070 s, Result = 00230000, Performance =   6.19 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006983 s, Result = 00280000, Performance =   6.15 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008332 s, Result = 002d0000, Performance =   5.80 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008733 s, Result = 00320000, Performance =   6.15 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010114 s, Result = 00370000, Performance =   5.84 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011020 s, Result = 003c0000, Performance =   5.85 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012061 s, Result = 00410000, Performance =   5.79 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013142 s, Result = 00460000, Performance =   5.72 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014054 s, Result = 004b0000, Performance =   5.73 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016507 s, Result = 00500000, Performance =   5.20 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016393 s, Result = 00550000, Performance =   5.57 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017367 s, Result = 005a0000, Performance =   5.56 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018499 s, Result = 005f0000, Performance =   5.51 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020416 s, Result = 00640000, Performance =   5.26 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021054 s, Result = 00690000, Performance =   5.36 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022107 s, Result = 006e0000, Performance =   5.34 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023636 s, Result = 00730000, Performance =   5.22 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024503 s, Result = 00780000, Performance =   5.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026330 s, Result = 007d0000, Performance =   5.10 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026789 s, Result = 00820000, Performance =   5.21 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027861 s, Result = 00870000, Performance =   5.20 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029059 s, Result = 008c0000, Performance =   5.17 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029840 s, Result = 00910000, Performance =   5.22 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030729 s, Result = 00960000, Performance =   5.24 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032106 s, Result = 009b0000, Performance =   5.18 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039003 s, Result = 00a00000, Performance =   4.40 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.034591 s, Result = 00a50000, Performance =   5.12 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034660 s, Result = 00aa0000, Performance =   5.27 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.036128 s, Result = 00af0000, Performance =   5.20 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.038518 s, Result = 00b40000, Performance =   5.02 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.038612 s, Result = 00b90000, Performance =   5.14 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039366 s, Result = 00be0000, Performance =   5.18 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040298 s, Result = 00c30000, Performance =   5.20 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.041819 s, Result = 00c80000, Performance =   5.14 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.042909 s, Result = 00cd0000, Performance =   5.13 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.044217 s, Result = 00d20000, Performance =   5.10 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044657 s, Result = 00d70000, Performance =   5.17 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.046277 s, Result = 00dc0000, Performance =   5.10 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.046023 s, Result = 00e10000, Performance =   5.25 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.047705 s, Result = 00e60000, Performance =   5.18 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.048447 s, Result = 00eb0000, Performance =   5.21 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.057589 s, Result = 00f00000, Performance =   4.47 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.049891 s, Result = 00f50000, Performance =   5.27 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.052017 s, Result = 00fa0000, Performance =   5.16 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.052162 s, Result = 00ff0000, Performance =   5.25 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055370 s, Result = 01040000, Performance =   5.04 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.055098 s, Result = 01090000, Performance =   5.16 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.056211 s, Result = 010e0000, Performance =   5.16 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.057700 s, Result = 01130000, Performance =   5.12 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.058235 s, Result = 01180000, Performance =   5.16 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.059126 s, Result = 011d0000, Performance =   5.18 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.059483 s, Result = 01220000, Performance =   5.23 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.061562 s, Result = 01270000, Performance =   5.15 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.062856 s, Result = 012c0000, Performance =   5.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.063000 s, Result = 01310000, Performance =   5.20 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.063473 s, Result = 01360000, Performance =   5.24 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.063443 s, Result = 013b0000, Performance =   5.33 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.083632 s, Result = 01400000, Performance =   4.11 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1773   250  2048
Test passed: M N K =  1801  1844   832
Test passed: M N K =   224   295   512
Test passed: M N K =  1473   650  1408
Test passed: M N K =   528   248  1984
M N K =  1024  1024   256, Elapsed time =   0.003645 s, Result = 8d04c000, Performance =   1.47 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004528 s, Result = f9088000, Performance =   2.37 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005681 s, Result = 650c4000, Performance =   2.84 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006356 s, Result = d1100000, Performance =   3.38 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007206 s, Result = 3d13c000, Performance =   3.73 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007908 s, Result = a9178000, Performance =   4.07 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008480 s, Result = 151b4000, Performance =   4.43 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009825 s, Result = 811f0000, Performance =   4.37 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010048 s, Result = ed22c000, Performance =   4.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011055 s, Result = 59268000, Performance =   4.86 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011522 s, Result = c52a4000, Performance =   5.13 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012169 s, Result = 312e0000, Performance =   5.29 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012982 s, Result = 9d31c000, Performance =   5.38 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013460 s, Result = 09358000, Performance =   5.58 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014296 s, Result = 75394000, Performance =   5.63 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014811 s, Result = e13d0000, Performance =   5.80 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015700 s, Result = 4d40c000, Performance =   5.81 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016222 s, Result = b9448000, Performance =   5.96 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017189 s, Result = 25484000, Performance =   5.93 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017703 s, Result = 914c0000, Performance =   6.07 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018038 s, Result = fd4fc000, Performance =   6.25 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018782 s, Result = 69538000, Performance =   6.29 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019245 s, Result = d5574000, Performance =   6.42 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020486 s, Result = 415b0000, Performance =   6.29 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020860 s, Result = ad5ec000, Performance =   6.43 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021343 s, Result = 19628000, Performance =   6.54 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022759 s, Result = 85664000, Performance =   6.37 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023126 s, Result = f16a0000, Performance =   6.50 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022982 s, Result = 5d6dc000, Performance =   6.77 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023829 s, Result = c9718000, Performance =   6.76 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024619 s, Result = 35754000, Performance =   6.76 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025428 s, Result = a1790000, Performance =   6.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026484 s, Result = 0d7cc000, Performance =   6.69 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026423 s, Result = 79808000, Performance =   6.91 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027133 s, Result = e5844000, Performance =   6.93 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027611 s, Result = 51880000, Performance =   7.00 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029227 s, Result = bd8bc000, Performance =   6.80 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029456 s, Result = 298f8000, Performance =   6.93 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030279 s, Result = 95934000, Performance =   6.92 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030593 s, Result = 01970000, Performance =   7.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031547 s, Result = 6d9ac000, Performance =   6.98 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031509 s, Result = d99e8000, Performance =   7.16 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032255 s, Result = 45a24000, Performance =   7.16 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034164 s, Result = b1a60000, Performance =   6.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034259 s, Result = 1da9c000, Performance =   7.05 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035102 s, Result = 89ad8000, Performance =   7.04 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035224 s, Result = f5b14000, Performance =   7.16 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037533 s, Result = 61b50000, Performance =   6.87 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037062 s, Result = cdb8c000, Performance =   7.10 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037375 s, Result = 39bc8000, Performance =   7.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038060 s, Result = a5c04000, Performance =   7.19 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038232 s, Result = 11c40000, Performance =   7.30 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038864 s, Result = 7dc7c000, Performance =   7.32 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.039663 s, Result = e9cb8000, Performance =   7.31 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040048 s, Result = 55cf4000, Performance =   7.37 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.041428 s, Result = c1d30000, Performance =   7.26 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.041951 s, Result = 2dd6c000, Performance =   7.29 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.042068 s, Result = 99da8000, Performance =   7.40 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043102 s, Result = 05de4000, Performance =   7.35 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.043752 s, Result = 71e20000, Performance =   7.36 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044064 s, Result = dde5c000, Performance =   7.43 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.044955 s, Result = 49e98000, Performance =   7.40 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.045154 s, Result = b5ed4000, Performance =   7.49 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.047366 s, Result = 21f10000, Performance =   7.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   395   854   704
Test passed: M N K =     6  1625   256
Test passed: M N K =   716   962  1728
Test passed: M N K =  1271  1643   960
Test passed: M N K =   689  1766  1472
M N K =  1024  1024   256, Elapsed time =   0.002676 s, Result = 0003c000, Performance =   2.01 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003491 s, Result = 00078000, Performance =   3.08 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004837 s, Result = 000b4000, Performance =   3.33 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005536 s, Result = 000f0000, Performance =   3.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006184 s, Result = 0012c000, Performance =   4.34 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007102 s, Result = 00168000, Performance =   4.54 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008066 s, Result = 001a4000, Performance =   4.66 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008828 s, Result = 001e0000, Performance =   4.87 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009792 s, Result = 0021c000, Performance =   4.93 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010637 s, Result = 00258000, Performance =   5.05 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010733 s, Result = 00294000, Performance =   5.50 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011693 s, Result = 002d0000, Performance =   5.51 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013293 s, Result = 0030c000, Performance =   5.25 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013353 s, Result = 00348000, Performance =   5.63 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014483 s, Result = 00384000, Performance =   5.56 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015022 s, Result = 003c0000, Performance =   5.72 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015040 s, Result = 003fc000, Performance =   6.07 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016906 s, Result = 00438000, Performance =   5.72 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016405 s, Result = 00474000, Performance =   6.22 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017407 s, Result = 004b0000, Performance =   6.17 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017990 s, Result = 004ec000, Performance =   6.27 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019016 s, Result = 00528000, Performance =   6.21 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018741 s, Result = 00564000, Performance =   6.59 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019028 s, Result = 005a0000, Performance =   6.77 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021134 s, Result = 005dc000, Performance =   6.35 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021051 s, Result = 00618000, Performance =   6.63 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022324 s, Result = 00654000, Performance =   6.49 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023173 s, Result = 00690000, Performance =   6.49 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023077 s, Result = 006cc000, Performance =   6.75 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024189 s, Result = 00708000, Performance =   6.66 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024479 s, Result = 00744000, Performance =   6.80 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026667 s, Result = 00780000, Performance =   6.44 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025476 s, Result = 007bc000, Performance =   6.95 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026324 s, Result = 007f8000, Performance =   6.93 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026583 s, Result = 00834000, Performance =   7.07 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027354 s, Result = 00870000, Performance =   7.07 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.027594 s, Result = 008ac000, Performance =   7.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028523 s, Result = 008e8000, Performance =   7.15 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029106 s, Result = 00924000, Performance =   7.19 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030351 s, Result = 00960000, Performance =   7.08 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030418 s, Result = 0099c000, Performance =   7.24 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030831 s, Result = 009d8000, Performance =   7.31 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030794 s, Result = 00a14000, Performance =   7.50 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.032638 s, Result = 00a50000, Performance =   7.24 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032443 s, Result = 00a8c000, Performance =   7.45 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033492 s, Result = 00ac8000, Performance =   7.37 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034037 s, Result = 00b04000, Performance =   7.41 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035003 s, Result = 00b40000, Performance =   7.36 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.035392 s, Result = 00b7c000, Performance =   7.43 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.035665 s, Result = 00bb8000, Performance =   7.53 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.036267 s, Result = 00bf4000, Performance =   7.55 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037751 s, Result = 00c30000, Performance =   7.40 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038015 s, Result = 00c6c000, Performance =   7.48 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.038509 s, Result = 00ca8000, Performance =   7.53 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.039732 s, Result = 00ce4000, Performance =   7.43 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040310 s, Result = 00d20000, Performance =   7.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.040753 s, Result = 00d5c000, Performance =   7.51 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.041640 s, Result = 00d98000, Performance =   7.48 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.041576 s, Result = 00dd4000, Performance =   7.62 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042917 s, Result = 00e10000, Performance =   7.51 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.043028 s, Result = 00e4c000, Performance =   7.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.043281 s, Result = 00e88000, Performance =   7.69 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.044803 s, Result = 00ec4000, Performance =   7.55 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.044973 s, Result = 00f00000, Performance =   7.64 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   274  1858   320
Test passed: M N K =  1637  1055  2048
Test passed: M N K =   525   366   960
Test passed: M N K =   487  1119  1920
Test passed: M N K =   888  1020  1600
M N K =  1024  1024   256, Elapsed time =   0.002277 s, Result = 0a0dc000, Performance =   2.36 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003315 s, Result = 0a118000, Performance =   3.24 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003911 s, Result = 0a154000, Performance =   4.12 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004665 s, Result = 0a190000, Performance =   4.60 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005287 s, Result = 0a1cc000, Performance =   5.08 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005950 s, Result = 0a208000, Performance =   5.41 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006622 s, Result = 0a244000, Performance =   5.68 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007457 s, Result = 0a280000, Performance =   5.76 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007755 s, Result = 0a2bc000, Performance =   6.23 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008456 s, Result = 0a2f8000, Performance =   6.35 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009200 s, Result = 0a334000, Performance =   6.42 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009701 s, Result = 0a370000, Performance =   6.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010373 s, Result = 0a3ac000, Performance =   6.73 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010986 s, Result = 0a3e8000, Performance =   6.84 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011680 s, Result = 0a424000, Performance =   6.89 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012508 s, Result = 0a460000, Performance =   6.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013302 s, Result = 0a49c000, Performance =   6.86 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013678 s, Result = 0a4d8000, Performance =   7.07 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014427 s, Result = 0a514000, Performance =   7.07 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015476 s, Result = 0a550000, Performance =   6.94 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016142 s, Result = 0a58c000, Performance =   6.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016608 s, Result = 0a5c8000, Performance =   7.11 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017289 s, Result = 0a604000, Performance =   7.14 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018533 s, Result = 0a640000, Performance =   6.95 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018576 s, Result = 0a67c000, Performance =   7.23 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019369 s, Result = 0a6b8000, Performance =   7.21 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019757 s, Result = 0a6f4000, Performance =   7.34 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020543 s, Result = 0a730000, Performance =   7.32 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021227 s, Result = 0a76c000, Performance =   7.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021964 s, Result = 0a7a8000, Performance =   7.33 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022512 s, Result = 0a7e4000, Performance =   7.39 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023591 s, Result = 0a820000, Performance =   7.28 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023950 s, Result = 0a85c000, Performance =   7.40 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.024437 s, Result = 0a898000, Performance =   7.47 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025059 s, Result = 0a8d4000, Performance =   7.50 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025866 s, Result = 0a910000, Performance =   7.47 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026437 s, Result = 0a94c000, Performance =   7.51 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.026882 s, Result = 0a988000, Performance =   7.59 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027754 s, Result = 0a9c4000, Performance =   7.54 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.028625 s, Result = 0aa00000, Performance =   7.50 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.028825 s, Result = 0aa3c000, Performance =   7.64 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029794 s, Result = 0aa78000, Performance =   7.57 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030511 s, Result = 0aab4000, Performance =   7.57 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031586 s, Result = 0aaf0000, Performance =   7.48 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031574 s, Result = 0ab2c000, Performance =   7.65 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032276 s, Result = 0ab68000, Performance =   7.65 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033021 s, Result = 0aba4000, Performance =   7.64 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035226 s, Result = 0abe0000, Performance =   7.32 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034344 s, Result = 0ac1c000, Performance =   7.66 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.034679 s, Result = 0ac58000, Performance =   7.74 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.035816 s, Result = 0ac94000, Performance =   7.64 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.036056 s, Result = 0acd0000, Performance =   7.74 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.036949 s, Result = 0ad0c000, Performance =   7.70 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.037221 s, Result = 0ad48000, Performance =   7.79 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.038269 s, Result = 0ad84000, Performance =   7.72 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040722 s, Result = 0adc0000, Performance =   7.38 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.039439 s, Result = 0adfc000, Performance =   7.76 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.040030 s, Result = 0ae38000, Performance =   7.78 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.040836 s, Result = 0ae74000, Performance =   7.76 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.041143 s, Result = 0aeb0000, Performance =   7.83 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.042334 s, Result = 0aeec000, Performance =   7.74 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.042633 s, Result = 0af28000, Performance =   7.81 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.043584 s, Result = 0af64000, Performance =   7.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.050084 s, Result = 0afa0000, Performance =   6.86 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1987  1539  1280
Test passed: M N K =    27   987   256
Test passed: M N K =  1451  1543  2048
Test passed: M N K =  1539  1866  1920
Test passed: M N K =  1477   261   576
M N K =  1024  1024   256, Elapsed time =   0.000457 s, Result = 0003c000, Performance =  11.74 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001108 s, Result = 00078000, Performance =   9.69 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001728 s, Result = 000b4000, Performance =   9.32 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002326 s, Result = 000f0000, Performance =   9.23 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002966 s, Result = 0012c000, Performance =   9.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003527 s, Result = 00168000, Performance =   9.13 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004272 s, Result = 001a4000, Performance =   8.80 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005340 s, Result = 001e0000, Performance =   8.04 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005891 s, Result = 0021c000, Performance =   8.20 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006634 s, Result = 00258000, Performance =   8.09 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006999 s, Result = 00294000, Performance =   8.44 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008132 s, Result = 002d0000, Performance =   7.92 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008320 s, Result = 0030c000, Performance =   8.39 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009498 s, Result = 00348000, Performance =   7.91 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009798 s, Result = 00384000, Performance =   8.22 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010675 s, Result = 003c0000, Performance =   8.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011378 s, Result = 003fc000, Performance =   8.02 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011700 s, Result = 00438000, Performance =   8.26 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012736 s, Result = 00474000, Performance =   8.01 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012984 s, Result = 004b0000, Performance =   8.27 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014109 s, Result = 004ec000, Performance =   7.99 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014456 s, Result = 00528000, Performance =   8.17 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015505 s, Result = 00564000, Performance =   7.96 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016142 s, Result = 005a0000, Performance =   7.98 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016440 s, Result = 005dc000, Performance =   8.16 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017102 s, Result = 00618000, Performance =   8.16 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017675 s, Result = 00654000, Performance =   8.20 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018774 s, Result = 00690000, Performance =   8.01 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018748 s, Result = 006cc000, Performance =   8.30 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019945 s, Result = 00708000, Performance =   8.08 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020394 s, Result = 00744000, Performance =   8.16 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021995 s, Result = 00780000, Performance =   7.81 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021473 s, Result = 007bc000, Performance =   8.25 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021975 s, Result = 007f8000, Performance =   8.31 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023421 s, Result = 00834000, Performance =   8.02 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023898 s, Result = 00870000, Performance =   8.09 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024227 s, Result = 008ac000, Performance =   8.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025013 s, Result = 008e8000, Performance =   8.16 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025413 s, Result = 00924000, Performance =   8.24 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.027311 s, Result = 00960000, Performance =   7.86 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027554 s, Result = 0099c000, Performance =   7.99 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.028529 s, Result = 009d8000, Performance =   7.90 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028504 s, Result = 00a14000, Performance =   8.10 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.029230 s, Result = 00a50000, Performance =   8.08 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.030307 s, Result = 00a8c000, Performance =   7.97 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030596 s, Result = 00ac8000, Performance =   8.07 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.031292 s, Result = 00b04000, Performance =   8.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.033671 s, Result = 00b40000, Performance =   7.65 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.032980 s, Result = 00b7c000, Performance =   7.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.033948 s, Result = 00bb8000, Performance =   7.91 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.033794 s, Result = 00bf4000, Performance =   8.10 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.035147 s, Result = 00c30000, Performance =   7.94 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035485 s, Result = 00c6c000, Performance =   8.02 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.036725 s, Result = 00ca8000, Performance =   7.89 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036741 s, Result = 00ce4000, Performance =   8.04 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.038127 s, Result = 00d20000, Performance =   7.89 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.038078 s, Result = 00d5c000, Performance =   8.04 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.041073 s, Result = 00d98000, Performance =   7.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038030 s, Result = 00dd4000, Performance =   8.33 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.041504 s, Result = 00e10000, Performance =   7.76 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.040685 s, Result = 00e4c000, Performance =   8.05 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.041479 s, Result = 00e88000, Performance =   8.02 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.041479 s, Result = 00ec4000, Performance =   8.15 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.043918 s, Result = 00f00000, Performance =   7.82 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1490  1873   704
Test passed: M N K =    76   323  1728
Test passed: M N K =   944  1992   832
Test passed: M N K =  1631  1596  1984
Test passed: M N K =  1940  2008   320
M N K =  1024  1024   256, Elapsed time =   0.003758 s, Result = 8d04c000, Performance =   1.43 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005093 s, Result = f9088000, Performance =   2.11 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005792 s, Result = 650c4000, Performance =   2.78 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006621 s, Result = d1100000, Performance =   3.24 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007494 s, Result = 3d13c000, Performance =   3.58 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008489 s, Result = a9178000, Performance =   3.79 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009453 s, Result = 151b4000, Performance =   3.98 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010486 s, Result = 811f0000, Performance =   4.10 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010852 s, Result = ed22c000, Performance =   4.45 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011787 s, Result = 59268000, Performance =   4.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012462 s, Result = c52a4000, Performance =   4.74 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013597 s, Result = 312e0000, Performance =   4.74 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014054 s, Result = 9d31c000, Performance =   4.97 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014685 s, Result = 09358000, Performance =   5.12 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015129 s, Result = 75394000, Performance =   5.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017986 s, Result = e13d0000, Performance =   4.78 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016132 s, Result = 4d40c000, Performance =   5.66 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017663 s, Result = b9448000, Performance =   5.47 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018214 s, Result = 25484000, Performance =   5.60 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019084 s, Result = 914c0000, Performance =   5.63 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019108 s, Result = fd4fc000, Performance =   5.90 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020180 s, Result = 69538000, Performance =   5.85 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020462 s, Result = d5574000, Performance =   6.03 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022281 s, Result = 415b0000, Performance =   5.78 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021548 s, Result = ad5ec000, Performance =   6.23 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022539 s, Result = 19628000, Performance =   6.19 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023133 s, Result = 85664000, Performance =   6.27 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023997 s, Result = f16a0000, Performance =   6.26 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024602 s, Result = 5d6dc000, Performance =   6.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025925 s, Result = c9718000, Performance =   6.21 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025978 s, Result = 35754000, Performance =   6.41 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031773 s, Result = a1790000, Performance =   5.41 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027857 s, Result = 0d7cc000, Performance =   6.36 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029829 s, Result = 79808000, Performance =   6.12 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030039 s, Result = e5844000, Performance =   6.26 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.031309 s, Result = 51880000, Performance =   6.17 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031728 s, Result = bd8bc000, Performance =   6.26 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032516 s, Result = 298f8000, Performance =   6.27 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032589 s, Result = 95934000, Performance =   6.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034771 s, Result = 01970000, Performance =   6.18 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034360 s, Result = 6d9ac000, Performance =   6.41 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034552 s, Result = d99e8000, Performance =   6.53 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035592 s, Result = 45a24000, Performance =   6.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.035913 s, Result = b1a60000, Performance =   6.58 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036584 s, Result = 1da9c000, Performance =   6.60 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.036891 s, Result = 89ad8000, Performance =   6.69 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038642 s, Result = f5b14000, Performance =   6.53 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.044982 s, Result = 61b50000, Performance =   5.73 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039256 s, Result = cdb8c000, Performance =   6.70 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039611 s, Result = 39bc8000, Performance =   6.78 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.041046 s, Result = a5c04000, Performance =   6.67 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.041657 s, Result = 11c40000, Performance =   6.70 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.041699 s, Result = 7dc7c000, Performance =   6.82 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.042298 s, Result = e9cb8000, Performance =   6.85 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.044115 s, Result = 55cf4000, Performance =   6.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046651 s, Result = c1d30000, Performance =   6.44 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.044825 s, Result = 2dd6c000, Performance =   6.83 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.045140 s, Result = 99da8000, Performance =   6.90 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.046899 s, Result = 05de4000, Performance =   6.75 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.047605 s, Result = 71e20000, Performance =   6.77 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.048771 s, Result = dde5c000, Performance =   6.71 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.048596 s, Result = 49e98000, Performance =   6.85 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.049218 s, Result = b5ed4000, Performance =   6.87 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.058133 s, Result = 21f10000, Performance =   5.91 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   943   949   768
Test passed: M N K =   565  1968  1856
Test passed: M N K =   599   373   448
Test passed: M N K =  1767   460   512
Test passed: M N K =  1195   369  1408
M N K =  1024  1024   256, Elapsed time =   0.002780 s, Result = 0003c000, Performance =   1.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003742 s, Result = 00078000, Performance =   2.87 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005416 s, Result = 000b4000, Performance =   2.97 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005865 s, Result = 000f0000, Performance =   3.66 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007014 s, Result = 0012c000, Performance =   3.83 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008003 s, Result = 00168000, Performance =   4.03 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008293 s, Result = 001a4000, Performance =   4.53 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009463 s, Result = 001e0000, Performance =   4.54 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009965 s, Result = 0021c000, Performance =   4.85 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012240 s, Result = 00258000, Performance =   4.39 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012419 s, Result = 00294000, Performance =   4.76 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013469 s, Result = 002d0000, Performance =   4.78 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013770 s, Result = 0030c000, Performance =   5.07 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014714 s, Result = 00348000, Performance =   5.11 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015538 s, Result = 00384000, Performance =   5.18 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017945 s, Result = 003c0000, Performance =   4.79 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016293 s, Result = 003fc000, Performance =   5.60 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016822 s, Result = 00438000, Performance =   5.74 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017184 s, Result = 00474000, Performance =   5.94 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017860 s, Result = 004b0000, Performance =   6.01 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018367 s, Result = 004ec000, Performance =   6.14 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019000 s, Result = 00528000, Performance =   6.22 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019649 s, Result = 00564000, Performance =   6.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022280 s, Result = 005a0000, Performance =   5.78 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021255 s, Result = 005dc000, Performance =   6.31 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022032 s, Result = 00618000, Performance =   6.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023199 s, Result = 00654000, Performance =   6.25 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024027 s, Result = 00690000, Performance =   6.26 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024455 s, Result = 006cc000, Performance =   6.37 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024837 s, Result = 00708000, Performance =   6.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025992 s, Result = 00744000, Performance =   6.40 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.029881 s, Result = 00780000, Performance =   5.75 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027060 s, Result = 007bc000, Performance =   6.55 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028974 s, Result = 007f8000, Performance =   6.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029164 s, Result = 00834000, Performance =   6.44 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029441 s, Result = 00870000, Performance =   6.56 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031110 s, Result = 008ac000, Performance =   6.39 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030876 s, Result = 008e8000, Performance =   6.61 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032037 s, Result = 00924000, Performance =   6.54 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033594 s, Result = 00960000, Performance =   6.39 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033418 s, Result = 0099c000, Performance =   6.59 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.033988 s, Result = 009d8000, Performance =   6.63 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035208 s, Result = 00a14000, Performance =   6.56 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.035311 s, Result = 00a50000, Performance =   6.69 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036029 s, Result = 00a8c000, Performance =   6.71 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.037082 s, Result = 00ac8000, Performance =   6.66 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037435 s, Result = 00b04000, Performance =   6.74 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045119 s, Result = 00b40000, Performance =   5.71 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039332 s, Result = 00b7c000, Performance =   6.69 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.040052 s, Result = 00bb8000, Performance =   6.70 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040604 s, Result = 00bf4000, Performance =   6.74 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042984 s, Result = 00c30000, Performance =   6.49 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.042475 s, Result = 00c6c000, Performance =   6.70 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.042300 s, Result = 00ca8000, Performance =   6.85 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.042781 s, Result = 00ce4000, Performance =   6.90 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046048 s, Result = 00d20000, Performance =   6.53 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.044397 s, Result = 00d5c000, Performance =   6.89 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.045396 s, Result = 00d98000, Performance =   6.86 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.045427 s, Result = 00dd4000, Performance =   6.97 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.047154 s, Result = 00e10000, Performance =   6.83 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.051177 s, Result = 00e4c000, Performance =   6.40 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.048651 s, Result = 00e88000, Performance =   6.84 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.048786 s, Result = 00ec4000, Performance =   6.93 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.057417 s, Result = 00f00000, Performance =   5.98 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   139  1254   960
Test passed: M N K =   448   492  1984
Test passed: M N K =   492  1237  1856
Test passed: M N K =  2003  1119  2048
Test passed: M N K =  1551  1885   768
M N K =  1024  1024   256, Elapsed time =   0.002423 s, Result = 0a0dc000, Performance =   2.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003214 s, Result = 0a118000, Performance =   3.34 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004527 s, Result = 0a154000, Performance =   3.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005097 s, Result = 0a190000, Performance =   4.21 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005772 s, Result = 0a1cc000, Performance =   4.65 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006644 s, Result = 0a208000, Performance =   4.85 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007222 s, Result = 0a244000, Performance =   5.20 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008371 s, Result = 0a280000, Performance =   5.13 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008671 s, Result = 0a2bc000, Performance =   5.57 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009606 s, Result = 0a2f8000, Performance =   5.59 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010473 s, Result = 0a334000, Performance =   5.64 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011362 s, Result = 0a370000, Performance =   5.67 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011787 s, Result = 0a3ac000, Performance =   5.92 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012497 s, Result = 0a3e8000, Performance =   6.01 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012873 s, Result = 0a424000, Performance =   6.26 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015621 s, Result = 0a460000, Performance =   5.50 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013831 s, Result = 0a49c000, Performance =   6.60 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014810 s, Result = 0a4d8000, Performance =   6.53 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015335 s, Result = 0a514000, Performance =   6.65 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016063 s, Result = 0a550000, Performance =   6.68 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016674 s, Result = 0a58c000, Performance =   6.76 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017453 s, Result = 0a5c8000, Performance =   6.77 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018006 s, Result = 0a604000, Performance =   6.86 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019768 s, Result = 0a640000, Performance =   6.52 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019310 s, Result = 0a67c000, Performance =   6.95 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020138 s, Result = 0a6b8000, Performance =   6.93 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020817 s, Result = 0a6f4000, Performance =   6.96 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021852 s, Result = 0a730000, Performance =   6.88 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022189 s, Result = 0a76c000, Performance =   7.02 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022932 s, Result = 0a7a8000, Performance =   7.02 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023484 s, Result = 0a7e4000, Performance =   7.09 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.028038 s, Result = 0a820000, Performance =   6.13 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024834 s, Result = 0a85c000, Performance =   7.13 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025713 s, Result = 0a898000, Performance =   7.10 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026420 s, Result = 0a8d4000, Performance =   7.11 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027333 s, Result = 0a910000, Performance =   7.07 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.027577 s, Result = 0a94c000, Performance =   7.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030145 s, Result = 0a988000, Performance =   6.77 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029875 s, Result = 0a9c4000, Performance =   7.01 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032120 s, Result = 0aa00000, Performance =   6.69 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031345 s, Result = 0aa3c000, Performance =   7.02 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031981 s, Result = 0aa78000, Performance =   7.05 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032682 s, Result = 0aab4000, Performance =   7.06 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033644 s, Result = 0aaf0000, Performance =   7.02 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033906 s, Result = 0ab2c000, Performance =   7.13 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034833 s, Result = 0ab68000, Performance =   7.09 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035435 s, Result = 0aba4000, Performance =   7.12 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042355 s, Result = 0abe0000, Performance =   6.08 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036861 s, Result = 0ac1c000, Performance =   7.14 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037504 s, Result = 0ac58000, Performance =   7.16 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038206 s, Result = 0ac94000, Performance =   7.17 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039449 s, Result = 0acd0000, Performance =   7.08 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039716 s, Result = 0ad0c000, Performance =   7.16 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040653 s, Result = 0ad48000, Performance =   7.13 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041193 s, Result = 0ad84000, Performance =   7.17 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.043820 s, Result = 0adc0000, Performance =   6.86 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042478 s, Result = 0adfc000, Performance =   7.20 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043486 s, Result = 0ae38000, Performance =   7.16 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044161 s, Result = 0ae74000, Performance =   7.17 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.044989 s, Result = 0aeb0000, Performance =   7.16 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045345 s, Result = 0aeec000, Performance =   7.22 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.046282 s, Result = 0af28000, Performance =   7.19 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046536 s, Result = 0af64000, Performance =   7.27 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055873 s, Result = 0afa0000, Performance =   6.15 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   392    86  1152
Test passed: M N K =  1619   553   896
Test passed: M N K =  1683   513   512
Test passed: M N K =  1136   380   256
Test passed: M N K =  1124   250   960
M N K =  1024  1024   256, Elapsed time =   0.000487 s, Result = 0003c000, Performance =  11.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001185 s, Result = 00078000, Performance =   9.06 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002035 s, Result = 000b4000, Performance =   7.91 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002574 s, Result = 000f0000, Performance =   8.34 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003826 s, Result = 0012c000, Performance =   7.02 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003973 s, Result = 00168000, Performance =   8.11 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005015 s, Result = 001a4000, Performance =   7.49 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005773 s, Result = 001e0000, Performance =   7.44 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006649 s, Result = 0021c000, Performance =   7.27 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007338 s, Result = 00258000, Performance =   7.32 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008161 s, Result = 00294000, Performance =   7.24 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009196 s, Result = 002d0000, Performance =   7.01 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009799 s, Result = 0030c000, Performance =   7.12 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010354 s, Result = 00348000, Performance =   7.26 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010966 s, Result = 00384000, Performance =   7.34 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014487 s, Result = 003c0000, Performance =   5.93 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012070 s, Result = 003fc000, Performance =   7.56 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012991 s, Result = 00438000, Performance =   7.44 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013484 s, Result = 00474000, Performance =   7.56 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014329 s, Result = 004b0000, Performance =   7.49 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014896 s, Result = 004ec000, Performance =   7.57 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015480 s, Result = 00528000, Performance =   7.63 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015879 s, Result = 00564000, Performance =   7.78 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018186 s, Result = 005a0000, Performance =   7.09 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017743 s, Result = 005dc000, Performance =   7.56 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018513 s, Result = 00618000, Performance =   7.54 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018897 s, Result = 00654000, Performance =   7.67 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019754 s, Result = 00690000, Performance =   7.61 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020296 s, Result = 006cc000, Performance =   7.67 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021523 s, Result = 00708000, Performance =   7.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021621 s, Result = 00744000, Performance =   7.70 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.029763 s, Result = 00780000, Performance =   5.77 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023530 s, Result = 007bc000, Performance =   7.53 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.024177 s, Result = 007f8000, Performance =   7.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024766 s, Result = 00834000, Performance =   7.59 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025466 s, Result = 00870000, Performance =   7.59 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026134 s, Result = 008ac000, Performance =   7.60 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027212 s, Result = 008e8000, Performance =   7.50 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027332 s, Result = 00924000, Performance =   7.66 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030219 s, Result = 00960000, Performance =   7.11 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029002 s, Result = 0099c000, Performance =   7.59 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029783 s, Result = 009d8000, Performance =   7.57 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030826 s, Result = 00a14000, Performance =   7.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031322 s, Result = 00a50000, Performance =   7.54 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031869 s, Result = 00a8c000, Performance =   7.58 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032704 s, Result = 00ac8000, Performance =   7.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033090 s, Result = 00b04000, Performance =   7.63 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042740 s, Result = 00b40000, Performance =   6.03 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034606 s, Result = 00b7c000, Performance =   7.60 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.035696 s, Result = 00bb8000, Performance =   7.52 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.036345 s, Result = 00bf4000, Performance =   7.53 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.036967 s, Result = 00c30000, Performance =   7.55 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.037321 s, Result = 00c6c000, Performance =   7.62 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.038424 s, Result = 00ca8000, Performance =   7.54 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.038349 s, Result = 00ce4000, Performance =   7.70 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.041958 s, Result = 00d20000, Performance =   7.17 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.039926 s, Result = 00d5c000, Performance =   7.66 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.040639 s, Result = 00d98000, Performance =   7.66 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.040958 s, Result = 00dd4000, Performance =   7.73 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042604 s, Result = 00e10000, Performance =   7.56 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.043242 s, Result = 00e4c000, Performance =   7.57 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.044086 s, Result = 00e88000, Performance =   7.55 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.044331 s, Result = 00ec4000, Performance =   7.63 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.056953 s, Result = 00f00000, Performance =   6.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1455   750   576
Test passed: M N K =   381  1204   768
Test passed: M N K =   163  1663   960
Test passed: M N K =   741   542   640
Test passed: M N K =  1988  1133  1600
M N K =  1024  1024   256, Elapsed time =   0.003718 s, Result = 8d04c000, Performance =   1.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004575 s, Result = f9088000, Performance =   2.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005790 s, Result = 650c4000, Performance =   2.78 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006305 s, Result = d1100000, Performance =   3.41 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007330 s, Result = 3d13c000, Performance =   3.66 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008271 s, Result = a9178000, Performance =   3.89 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009081 s, Result = 151b4000, Performance =   4.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010217 s, Result = 811f0000, Performance =   4.20 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011111 s, Result = ed22c000, Performance =   4.35 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012307 s, Result = 59268000, Performance =   4.36 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013506 s, Result = c52a4000, Performance =   4.37 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014603 s, Result = 312e0000, Performance =   4.41 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015430 s, Result = 9d31c000, Performance =   4.52 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016128 s, Result = 09358000, Performance =   4.66 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017819 s, Result = 75394000, Performance =   4.52 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020074 s, Result = e13d0000, Performance =   4.28 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019488 s, Result = 4d40c000, Performance =   4.68 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020598 s, Result = b9448000, Performance =   4.69 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021313 s, Result = 25484000, Performance =   4.79 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022689 s, Result = 914c0000, Performance =   4.73 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023867 s, Result = fd4fc000, Performance =   4.72 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024380 s, Result = 69538000, Performance =   4.84 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024136 s, Result = d5574000, Performance =   5.12 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025441 s, Result = 415b0000, Performance =   5.06 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027875 s, Result = ad5ec000, Performance =   4.81 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027752 s, Result = 19628000, Performance =   5.03 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028566 s, Result = 85664000, Performance =   5.07 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031047 s, Result = f16a0000, Performance =   4.84 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.031305 s, Result = 5d6dc000, Performance =   4.97 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031784 s, Result = c9718000, Performance =   5.07 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032377 s, Result = 35754000, Performance =   5.14 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034520 s, Result = a1790000, Performance =   4.98 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033480 s, Result = 0d7cc000, Performance =   5.29 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.036330 s, Result = 79808000, Performance =   5.02 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.036854 s, Result = e5844000, Performance =   5.10 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.038329 s, Result = 51880000, Performance =   5.04 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.038168 s, Result = bd8bc000, Performance =   5.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039392 s, Result = 298f8000, Performance =   5.18 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040217 s, Result = 95934000, Performance =   5.21 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.039071 s, Result = 01970000, Performance =   5.50 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040661 s, Result = 6d9ac000, Performance =   5.41 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.042647 s, Result = d99e8000, Performance =   5.29 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044114 s, Result = 45a24000, Performance =   5.23 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044542 s, Result = b1a60000, Performance =   5.30 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.045154 s, Result = 1da9c000, Performance =   5.35 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.046298 s, Result = 89ad8000, Performance =   5.33 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046120 s, Result = f5b14000, Performance =   5.47 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.052027 s, Result = 61b50000, Performance =   4.95 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.049039 s, Result = cdb8c000, Performance =   5.36 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.049856 s, Result = 39bc8000, Performance =   5.38 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.050377 s, Result = a5c04000, Performance =   5.44 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.052296 s, Result = 11c40000, Performance =   5.34 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.052604 s, Result = 7dc7c000, Performance =   5.41 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.054212 s, Result = e9cb8000, Performance =   5.35 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.054520 s, Result = 55cf4000, Performance =   5.42 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052999 s, Result = c1d30000, Performance =   5.67 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.055829 s, Result = 2dd6c000, Performance =   5.48 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.057206 s, Result = 99da8000, Performance =   5.44 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.057997 s, Result = 05de4000, Performance =   5.46 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.059335 s, Result = 71e20000, Performance =   5.43 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.059722 s, Result = dde5c000, Performance =   5.48 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059736 s, Result = 49e98000, Performance =   5.57 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.060247 s, Result = b5ed4000, Performance =   5.61 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.066310 s, Result = 21f10000, Performance =   5.18 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1027   944   448
Test passed: M N K =  1887  1346   192
Test passed: M N K =  1570   687   640
Test passed: M N K =   792   919  1536
Test passed: M N K =   693  1397   192
M N K =  1024  1024   256, Elapsed time =   0.002786 s, Result = 0003c000, Performance =   1.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003601 s, Result = 00078000, Performance =   2.98 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005275 s, Result = 000b4000, Performance =   3.05 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005519 s, Result = 000f0000, Performance =   3.89 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006533 s, Result = 0012c000, Performance =   4.11 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007385 s, Result = 00168000, Performance =   4.36 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008136 s, Result = 001a4000, Performance =   4.62 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009524 s, Result = 001e0000, Performance =   4.51 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010041 s, Result = 0021c000, Performance =   4.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011199 s, Result = 00258000, Performance =   4.79 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012260 s, Result = 00294000, Performance =   4.82 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013573 s, Result = 002d0000, Performance =   4.75 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014455 s, Result = 0030c000, Performance =   4.83 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015358 s, Result = 00348000, Performance =   4.89 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016373 s, Result = 00384000, Performance =   4.92 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018883 s, Result = 003c0000, Performance =   4.55 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018446 s, Result = 003fc000, Performance =   4.95 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019467 s, Result = 00438000, Performance =   4.96 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020696 s, Result = 00474000, Performance =   4.93 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022039 s, Result = 004b0000, Performance =   4.87 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022649 s, Result = 004ec000, Performance =   4.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023455 s, Result = 00528000, Performance =   5.04 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024297 s, Result = 00564000, Performance =   5.08 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024570 s, Result = 005a0000, Performance =   5.24 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026384 s, Result = 005dc000, Performance =   5.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027120 s, Result = 00618000, Performance =   5.15 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028451 s, Result = 00654000, Performance =   5.09 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029753 s, Result = 00690000, Performance =   5.05 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029992 s, Result = 006cc000, Performance =   5.19 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030229 s, Result = 00708000, Performance =   5.33 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030800 s, Result = 00744000, Performance =   5.40 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036051 s, Result = 00780000, Performance =   4.77 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.034406 s, Result = 007bc000, Performance =   5.15 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034537 s, Result = 007f8000, Performance =   5.29 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035768 s, Result = 00834000, Performance =   5.25 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037692 s, Result = 00870000, Performance =   5.13 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037758 s, Result = 008ac000, Performance =   5.26 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038523 s, Result = 008e8000, Performance =   5.30 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039561 s, Result = 00924000, Performance =   5.29 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.039267 s, Result = 00960000, Performance =   5.47 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041313 s, Result = 0099c000, Performance =   5.33 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041435 s, Result = 009d8000, Performance =   5.44 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041701 s, Result = 00a14000, Performance =   5.54 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044484 s, Result = 00a50000, Performance =   5.31 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043634 s, Result = 00a8c000, Performance =   5.54 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.044612 s, Result = 00ac8000, Performance =   5.54 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.045287 s, Result = 00b04000, Performance =   5.57 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.050385 s, Result = 00b40000, Performance =   5.11 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.047409 s, Result = 00b7c000, Performance =   5.55 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.048057 s, Result = 00bb8000, Performance =   5.59 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.049079 s, Result = 00bf4000, Performance =   5.58 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.051377 s, Result = 00c30000, Performance =   5.43 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.051872 s, Result = 00c6c000, Performance =   5.49 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.051887 s, Result = 00ca8000, Performance =   5.59 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.053652 s, Result = 00ce4000, Performance =   5.50 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051785 s, Result = 00d20000, Performance =   5.81 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.055318 s, Result = 00d5c000, Performance =   5.53 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055854 s, Result = 00d98000, Performance =   5.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.056837 s, Result = 00dd4000, Performance =   5.57 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.058098 s, Result = 00e10000, Performance =   5.54 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.058513 s, Result = 00e4c000, Performance =   5.60 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059182 s, Result = 00e88000, Performance =   5.62 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.059361 s, Result = 00ec4000, Performance =   5.70 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.066500 s, Result = 00f00000, Performance =   5.17 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1938  1562  1024
Test passed: M N K =   424   813  1728
Test passed: M N K =    92   807  1856
Test passed: M N K =   525   403   768
Test passed: M N K =  1177   326   320
M N K =  1024  1024   256, Elapsed time =   0.002418 s, Result = 0a0dc000, Performance =   2.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003152 s, Result = 0a118000, Performance =   3.41 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004337 s, Result = 0a154000, Performance =   3.71 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004910 s, Result = 0a190000, Performance =   4.37 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005887 s, Result = 0a1cc000, Performance =   4.56 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006616 s, Result = 0a208000, Performance =   4.87 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007362 s, Result = 0a244000, Performance =   5.10 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008262 s, Result = 0a280000, Performance =   5.20 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008989 s, Result = 0a2bc000, Performance =   5.38 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009795 s, Result = 0a2f8000, Performance =   5.48 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011604 s, Result = 0a334000, Performance =   5.09 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012297 s, Result = 0a370000, Performance =   5.24 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012847 s, Result = 0a3ac000, Performance =   5.43 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013995 s, Result = 0a3e8000, Performance =   5.37 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015100 s, Result = 0a424000, Performance =   5.33 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016568 s, Result = 0a460000, Performance =   5.18 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016907 s, Result = 0a49c000, Performance =   5.40 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017783 s, Result = 0a4d8000, Performance =   5.43 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019337 s, Result = 0a514000, Performance =   5.28 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020890 s, Result = 0a550000, Performance =   5.14 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021058 s, Result = 0a58c000, Performance =   5.35 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021323 s, Result = 0a5c8000, Performance =   5.54 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022994 s, Result = 0a604000, Performance =   5.37 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022528 s, Result = 0a640000, Performance =   5.72 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024640 s, Result = 0a67c000, Performance =   5.45 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024841 s, Result = 0a6b8000, Performance =   5.62 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025783 s, Result = 0a6f4000, Performance =   5.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027169 s, Result = 0a730000, Performance =   5.53 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027898 s, Result = 0a76c000, Performance =   5.58 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028554 s, Result = 0a7a8000, Performance =   5.64 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029535 s, Result = 0a7e4000, Performance =   5.63 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.033788 s, Result = 0a820000, Performance =   5.08 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.031853 s, Result = 0a85c000, Performance =   5.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.031878 s, Result = 0a898000, Performance =   5.73 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033201 s, Result = 0a8d4000, Performance =   5.66 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034837 s, Result = 0a910000, Performance =   5.55 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035783 s, Result = 0a94c000, Performance =   5.55 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036496 s, Result = 0a988000, Performance =   5.59 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037458 s, Result = 0a9c4000, Performance =   5.59 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037136 s, Result = 0aa00000, Performance =   5.78 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039142 s, Result = 0aa3c000, Performance =   5.62 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.039483 s, Result = 0aa78000, Performance =   5.71 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041159 s, Result = 0aab4000, Performance =   5.61 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042744 s, Result = 0aaf0000, Performance =   5.53 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043054 s, Result = 0ab2c000, Performance =   5.61 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043490 s, Result = 0ab68000, Performance =   5.68 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044141 s, Result = 0aba4000, Performance =   5.72 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.049263 s, Result = 0abe0000, Performance =   5.23 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045980 s, Result = 0ac1c000, Performance =   5.72 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047697 s, Result = 0ac58000, Performance =   5.63 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047741 s, Result = 0ac94000, Performance =   5.74 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.049644 s, Result = 0acd0000, Performance =   5.62 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050340 s, Result = 0ad0c000, Performance =   5.65 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050871 s, Result = 0ad48000, Performance =   5.70 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.052240 s, Result = 0ad84000, Performance =   5.65 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051014 s, Result = 0adc0000, Performance =   5.89 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.054648 s, Result = 0adfc000, Performance =   5.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.054776 s, Result = 0ae38000, Performance =   5.68 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055640 s, Result = 0ae74000, Performance =   5.69 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.057627 s, Result = 0aeb0000, Performance =   5.59 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.057787 s, Result = 0aeec000, Performance =   5.67 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058226 s, Result = 0af28000, Performance =   5.72 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.057978 s, Result = 0af64000, Performance =   5.83 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.065218 s, Result = 0afa0000, Performance =   5.27 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   508  1145  1280
Test passed: M N K =  1250  1258  1472
Test passed: M N K =  1066   149  1472
Test passed: M N K =  1790   961  1728
Test passed: M N K =   141  1170   128
M N K =  1024  1024   256, Elapsed time =   0.000531 s, Result = 0003c000, Performance =  10.12 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001375 s, Result = 00078000, Performance =   7.81 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002165 s, Result = 000b4000, Performance =   7.44 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002749 s, Result = 000f0000, Performance =   7.81 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003389 s, Result = 0012c000, Performance =   7.92 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004053 s, Result = 00168000, Performance =   7.95 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004684 s, Result = 001a4000, Performance =   8.02 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005826 s, Result = 001e0000, Performance =   7.37 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006516 s, Result = 0021c000, Performance =   7.42 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007632 s, Result = 00258000, Performance =   7.03 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008848 s, Result = 00294000, Performance =   6.67 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010009 s, Result = 002d0000, Performance =   6.44 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010772 s, Result = 0030c000, Performance =   6.48 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011873 s, Result = 00348000, Performance =   6.33 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013002 s, Result = 00384000, Performance =   6.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014937 s, Result = 003c0000, Performance =   5.75 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014513 s, Result = 003fc000, Performance =   6.29 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015593 s, Result = 00438000, Performance =   6.20 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017294 s, Result = 00474000, Performance =   5.90 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018564 s, Result = 004b0000, Performance =   5.78 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018961 s, Result = 004ec000, Performance =   5.95 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019861 s, Result = 00528000, Performance =   5.95 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020948 s, Result = 00564000, Performance =   5.89 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020769 s, Result = 005a0000, Performance =   6.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022045 s, Result = 005dc000, Performance =   6.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022855 s, Result = 00618000, Performance =   6.11 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024463 s, Result = 00654000, Performance =   5.93 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025437 s, Result = 00690000, Performance =   5.91 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025274 s, Result = 006cc000, Performance =   6.16 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026615 s, Result = 00708000, Performance =   6.05 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.027987 s, Result = 00744000, Performance =   5.95 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030793 s, Result = 00780000, Performance =   5.58 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029710 s, Result = 007bc000, Performance =   5.96 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029920 s, Result = 007f8000, Performance =   6.10 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.031525 s, Result = 00834000, Performance =   5.96 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.032217 s, Result = 00870000, Performance =   6.00 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.033020 s, Result = 008ac000, Performance =   6.02 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.034167 s, Result = 008e8000, Performance =   5.97 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.035633 s, Result = 00924000, Performance =   5.88 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034546 s, Result = 00960000, Performance =   6.22 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.036126 s, Result = 0099c000, Performance =   6.09 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.037278 s, Result = 009d8000, Performance =   6.05 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.038819 s, Result = 00a14000, Performance =   5.95 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.039977 s, Result = 00a50000, Performance =   5.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.040334 s, Result = 00a8c000, Performance =   5.99 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040394 s, Result = 00ac8000, Performance =   6.11 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042272 s, Result = 00b04000, Performance =   5.97 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.047195 s, Result = 00b40000, Performance =   5.46 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.043761 s, Result = 00b7c000, Performance =   6.01 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043077 s, Result = 00bb8000, Performance =   6.23 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.044904 s, Result = 00bf4000, Performance =   6.10 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.046382 s, Result = 00c30000, Performance =   6.02 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048257 s, Result = 00c6c000, Performance =   5.90 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.048952 s, Result = 00ca8000, Performance =   5.92 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.049649 s, Result = 00ce4000, Performance =   5.95 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.048474 s, Result = 00d20000, Performance =   6.20 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.052488 s, Result = 00d5c000, Performance =   5.83 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.051723 s, Result = 00d98000, Performance =   6.02 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.053166 s, Result = 00dd4000, Performance =   5.96 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.053351 s, Result = 00e10000, Performance =   6.04 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.054613 s, Result = 00e4c000, Performance =   6.00 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.055954 s, Result = 00e88000, Performance =   5.95 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.056285 s, Result = 00ec4000, Performance =   6.01 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.063379 s, Result = 00f00000, Performance =   5.42 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1967  1665  1280
Test passed: M N K =  1674   286  1152
Test passed: M N K =  1889   747   768
Test passed: M N K =   500   696   576
Test passed: M N K =    31  1236   512
M N K =  1024  1024   256, Elapsed time =   0.003465 s, Result = f5042000, Performance =   1.55 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004298 s, Result = a9074000, Performance =   2.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005465 s, Result = 5d0a6000, Performance =   2.95 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006067 s, Result = 110d8000, Performance =   3.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006598 s, Result = c510a000, Performance =   4.07 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007688 s, Result = 7913c000, Performance =   4.19 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008120 s, Result = 2d16e000, Performance =   4.63 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009327 s, Result = e11a0000, Performance =   4.60 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009412 s, Result = 951d2000, Performance =   5.13 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010187 s, Result = 49204000, Performance =   5.27 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010213 s, Result = fd236000, Performance =   5.78 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011092 s, Result = b1268000, Performance =   5.81 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011309 s, Result = 6529a000, Performance =   6.17 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012059 s, Result = 192cc000, Performance =   6.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012755 s, Result = cd2fe000, Performance =   6.31 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013195 s, Result = 81330000, Performance =   6.51 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013950 s, Result = 35362000, Performance =   6.54 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014662 s, Result = e9394000, Performance =   6.59 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015274 s, Result = 9d3c6000, Performance =   6.68 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015351 s, Result = 513f8000, Performance =   6.99 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015960 s, Result = 0542a000, Performance =   7.06 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016523 s, Result = b945c000, Performance =   7.15 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017369 s, Result = 6d48e000, Performance =   7.11 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018300 s, Result = 214c0000, Performance =   7.04 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018239 s, Result = d54f2000, Performance =   7.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018862 s, Result = 89524000, Performance =   7.40 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019728 s, Result = 3d556000, Performance =   7.35 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020636 s, Result = f1588000, Performance =   7.28 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020667 s, Result = a55ba000, Performance =   7.53 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021084 s, Result = 595ec000, Performance =   7.64 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021643 s, Result = 0d61e000, Performance =   7.69 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.022152 s, Result = c1650000, Performance =   7.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023772 s, Result = 75682000, Performance =   7.45 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023721 s, Result = 296b4000, Performance =   7.70 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024099 s, Result = dd6e6000, Performance =   7.80 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024373 s, Result = 91718000, Performance =   7.93 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.025784 s, Result = 4574a000, Performance =   7.70 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025456 s, Result = f977c000, Performance =   8.01 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025978 s, Result = ad7ae000, Performance =   8.06 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.027030 s, Result = 617e0000, Performance =   7.94 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027059 s, Result = 15812000, Performance =   8.13 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027728 s, Result = c9844000, Performance =   8.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.029992 s, Result = 7d876000, Performance =   7.70 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.029264 s, Result = 318a8000, Performance =   8.07 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.030611 s, Result = e58da000, Performance =   7.89 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.031077 s, Result = 9990c000, Performance =   7.95 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.032219 s, Result = 4d93e000, Performance =   7.83 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.032379 s, Result = 01970000, Performance =   7.96 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.033019 s, Result = b59a2000, Performance =   7.97 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.033571 s, Result = 699d4000, Performance =   8.00 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.033859 s, Result = 1da06000, Performance =   8.09 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.034131 s, Result = d1a38000, Performance =   8.18 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035156 s, Result = 85a6a000, Performance =   8.09 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.035991 s, Result = 39a9c000, Performance =   8.05 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036448 s, Result = edace000, Performance =   8.10 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.036497 s, Result = a1b00000, Performance =   8.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.037125 s, Result = 55b32000, Performance =   8.24 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.038244 s, Result = 09b64000, Performance =   8.14 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038856 s, Result = bdb96000, Performance =   8.15 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038983 s, Result = 71bc8000, Performance =   8.26 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039475 s, Result = 25bfa000, Performance =   8.30 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.039764 s, Result = d9c2c000, Performance =   8.37 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.040911 s, Result = 8dc5e000, Performance =   8.27 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.041967 s, Result = 41c90000, Performance =   8.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   964   970  2048
Test passed: M N K =  1592   466  1664
Test passed: M N K =  1971   940  1088
Test passed: M N K =  1588  1620  1216
Test passed: M N K =  1745  1357  1536
M N K =  1024  1024   256, Elapsed time =   0.002350 s, Result = 00032000, Performance =   2.28 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003048 s, Result = 00064000, Performance =   3.52 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004517 s, Result = 00096000, Performance =   3.57 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005399 s, Result = 000c8000, Performance =   3.98 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005721 s, Result = 000fa000, Performance =   4.69 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006351 s, Result = 0012c000, Performance =   5.07 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006944 s, Result = 0015e000, Performance =   5.41 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008056 s, Result = 00190000, Performance =   5.33 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008770 s, Result = 001c2000, Performance =   5.51 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008837 s, Result = 001f4000, Performance =   6.08 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009340 s, Result = 00226000, Performance =   6.32 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010613 s, Result = 00258000, Performance =   6.07 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011255 s, Result = 0028a000, Performance =   6.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011506 s, Result = 002bc000, Performance =   6.53 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011762 s, Result = 002ee000, Performance =   6.85 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012512 s, Result = 00320000, Performance =   6.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013102 s, Result = 00352000, Performance =   6.97 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015058 s, Result = 00384000, Performance =   6.42 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014704 s, Result = 003b6000, Performance =   6.94 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015115 s, Result = 003e8000, Performance =   7.10 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015311 s, Result = 0041a000, Performance =   7.36 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015616 s, Result = 0044c000, Performance =   7.56 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016518 s, Result = 0047e000, Performance =   7.48 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016655 s, Result = 004b0000, Performance =   7.74 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017278 s, Result = 004e2000, Performance =   7.77 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017801 s, Result = 00514000, Performance =   7.84 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019310 s, Result = 00546000, Performance =   7.51 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019421 s, Result = 00578000, Performance =   7.74 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019724 s, Result = 005aa000, Performance =   7.89 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020510 s, Result = 005dc000, Performance =   7.85 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021083 s, Result = 0060e000, Performance =   7.89 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021301 s, Result = 00640000, Performance =   8.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022938 s, Result = 00672000, Performance =   7.72 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022810 s, Result = 006a4000, Performance =   8.00 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023802 s, Result = 006d6000, Performance =   7.89 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024299 s, Result = 00708000, Performance =   7.95 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024822 s, Result = 0073a000, Performance =   8.00 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024896 s, Result = 0076c000, Performance =   8.19 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.026060 s, Result = 0079e000, Performance =   8.03 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.027024 s, Result = 007d0000, Performance =   7.95 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026859 s, Result = 00802000, Performance =   8.20 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026775 s, Result = 00834000, Performance =   8.42 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028033 s, Result = 00866000, Performance =   8.24 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028297 s, Result = 00898000, Performance =   8.35 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028997 s, Result = 008ca000, Performance =   8.33 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029165 s, Result = 008fc000, Performance =   8.47 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030355 s, Result = 0092e000, Performance =   8.31 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.029985 s, Result = 00960000, Performance =   8.59 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031356 s, Result = 00992000, Performance =   8.39 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031396 s, Result = 009c4000, Performance =   8.55 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032431 s, Result = 009f6000, Performance =   8.44 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032309 s, Result = 00a28000, Performance =   8.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033502 s, Result = 00a5a000, Performance =   8.49 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033804 s, Result = 00a8c000, Performance =   8.58 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034437 s, Result = 00abe000, Performance =   8.57 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034530 s, Result = 00af0000, Performance =   8.71 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.036028 s, Result = 00b22000, Performance =   8.49 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036292 s, Result = 00b54000, Performance =   8.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036767 s, Result = 00b86000, Performance =   8.62 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.037500 s, Result = 00bb8000, Performance =   8.59 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.038676 s, Result = 00bea000, Performance =   8.47 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038192 s, Result = 00c1c000, Performance =   8.72 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039059 s, Result = 00c4e000, Performance =   8.66 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038356 s, Result = 00c80000, Performance =   8.96 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1335   148  2048
Test passed: M N K =  1848  1873   960
Test passed: M N K =  1189  1524  1984
Test passed: M N K =   678    19   384
Test passed: M N K =  1215   496  1152
M N K =  1024  1024   256, Elapsed time =   0.002100 s, Result = 0a0d2000, Performance =   2.56 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003074 s, Result = 0a104000, Performance =   3.49 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003676 s, Result = 0a136000, Performance =   4.38 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004249 s, Result = 0a168000, Performance =   5.05 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004885 s, Result = 0a19a000, Performance =   5.50 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005533 s, Result = 0a1cc000, Performance =   5.82 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006105 s, Result = 0a1fe000, Performance =   6.16 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007076 s, Result = 0a230000, Performance =   6.07 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007072 s, Result = 0a262000, Performance =   6.83 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007690 s, Result = 0a294000, Performance =   6.98 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008239 s, Result = 0a2c6000, Performance =   7.17 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008851 s, Result = 0a2f8000, Performance =   7.28 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009374 s, Result = 0a32a000, Performance =   7.45 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009945 s, Result = 0a35c000, Performance =   7.56 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010487 s, Result = 0a38e000, Performance =   7.68 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010980 s, Result = 0a3c0000, Performance =   7.82 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011584 s, Result = 0a3f2000, Performance =   7.88 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012150 s, Result = 0a424000, Performance =   7.95 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012717 s, Result = 0a456000, Performance =   8.02 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013216 s, Result = 0a488000, Performance =   8.12 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013867 s, Result = 0a4ba000, Performance =   8.13 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014378 s, Result = 0a4ec000, Performance =   8.21 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015012 s, Result = 0a51e000, Performance =   8.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015426 s, Result = 0a550000, Performance =   8.35 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016184 s, Result = 0a582000, Performance =   8.29 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016621 s, Result = 0a5b4000, Performance =   8.40 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017387 s, Result = 0a5e6000, Performance =   8.34 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017747 s, Result = 0a618000, Performance =   8.47 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018375 s, Result = 0a64a000, Performance =   8.47 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018881 s, Result = 0a67c000, Performance =   8.53 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019424 s, Result = 0a6ae000, Performance =   8.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020190 s, Result = 0a6e0000, Performance =   8.51 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020537 s, Result = 0a712000, Performance =   8.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021116 s, Result = 0a744000, Performance =   8.64 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021633 s, Result = 0a776000, Performance =   8.69 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022138 s, Result = 0a7a8000, Performance =   8.73 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022828 s, Result = 0a7da000, Performance =   8.70 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023333 s, Result = 0a80c000, Performance =   8.74 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024095 s, Result = 0a83e000, Performance =   8.69 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.024393 s, Result = 0a870000, Performance =   8.80 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026261 s, Result = 0a8a2000, Performance =   8.38 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026069 s, Result = 0a8d4000, Performance =   8.65 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.026448 s, Result = 0a906000, Performance =   8.73 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.027337 s, Result = 0a938000, Performance =   8.64 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027379 s, Result = 0a96a000, Performance =   8.82 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029580 s, Result = 0a99c000, Performance =   8.35 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029400 s, Result = 0a9ce000, Performance =   8.58 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.029880 s, Result = 0aa00000, Performance =   8.62 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030031 s, Result = 0aa32000, Performance =   8.76 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031366 s, Result = 0aa64000, Performance =   8.56 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031391 s, Result = 0aa96000, Performance =   8.72 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032811 s, Result = 0aac8000, Performance =   8.51 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.032392 s, Result = 0aafa000, Performance =   8.78 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033048 s, Result = 0ab2c000, Performance =   8.77 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033978 s, Result = 0ab5e000, Performance =   8.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035339 s, Result = 0ab90000, Performance =   8.51 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034980 s, Result = 0abc2000, Performance =   8.75 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.035713 s, Result = 0abf4000, Performance =   8.72 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036120 s, Result = 0ac26000, Performance =   8.77 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036944 s, Result = 0ac58000, Performance =   8.72 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.037110 s, Result = 0ac8a000, Performance =   8.82 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.037741 s, Result = 0acbc000, Performance =   8.82 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.038110 s, Result = 0acee000, Performance =   8.88 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.041772 s, Result = 0ad20000, Performance =   8.23 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   869  1938  1472
Test passed: M N K =  1535   771   576
Test passed: M N K =  1355  1070   192
Test passed: M N K =    11   886  1472
Test passed: M N K =   135   957   448
M N K =  1024  1024   256, Elapsed time =   0.000340 s, Result = 00032000, Performance =  15.77 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000879 s, Result = 00064000, Performance =  12.22 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001541 s, Result = 00096000, Performance =  10.45 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002015 s, Result = 000c8000, Performance =  10.66 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002622 s, Result = 000fa000, Performance =  10.24 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003347 s, Result = 0012c000, Performance =   9.63 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003924 s, Result = 0015e000, Performance =   9.58 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004583 s, Result = 00190000, Performance =   9.37 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005222 s, Result = 001c2000, Performance =   9.25 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005684 s, Result = 001f4000, Performance =   9.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006788 s, Result = 00226000, Performance =   8.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007232 s, Result = 00258000, Performance =   8.91 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007710 s, Result = 0028a000, Performance =   9.05 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008877 s, Result = 002bc000, Performance =   8.47 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009323 s, Result = 002ee000, Performance =   8.64 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009839 s, Result = 00320000, Performance =   8.73 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010200 s, Result = 00352000, Performance =   8.95 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011001 s, Result = 00384000, Performance =   8.78 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012235 s, Result = 003b6000, Performance =   8.34 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012873 s, Result = 003e8000, Performance =   8.34 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013317 s, Result = 0041a000, Performance =   8.47 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013798 s, Result = 0044c000, Performance =   8.56 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014916 s, Result = 0047e000, Performance =   8.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015194 s, Result = 004b0000, Performance =   8.48 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016015 s, Result = 004e2000, Performance =   8.38 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016444 s, Result = 00514000, Performance =   8.49 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017109 s, Result = 00546000, Performance =   8.47 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017557 s, Result = 00578000, Performance =   8.56 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018867 s, Result = 005aa000, Performance =   8.25 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019169 s, Result = 005dc000, Performance =   8.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019501 s, Result = 0060e000, Performance =   8.53 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020480 s, Result = 00640000, Performance =   8.39 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021058 s, Result = 00672000, Performance =   8.41 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021349 s, Result = 006a4000, Performance =   8.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021924 s, Result = 006d6000, Performance =   8.57 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022876 s, Result = 00708000, Performance =   8.45 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023007 s, Result = 0073a000, Performance =   8.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023841 s, Result = 0076c000, Performance =   8.56 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024476 s, Result = 0079e000, Performance =   8.55 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025124 s, Result = 007d0000, Performance =   8.55 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025425 s, Result = 00802000, Performance =   8.66 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026910 s, Result = 00834000, Performance =   8.38 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027972 s, Result = 00866000, Performance =   8.25 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.027474 s, Result = 00898000, Performance =   8.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028216 s, Result = 008ca000, Performance =   8.56 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029043 s, Result = 008fc000, Performance =   8.50 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029931 s, Result = 0092e000, Performance =   8.43 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030451 s, Result = 00960000, Performance =   8.46 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030941 s, Result = 00992000, Performance =   8.50 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031483 s, Result = 009c4000, Performance =   8.53 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032015 s, Result = 009f6000, Performance =   8.55 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032556 s, Result = 00a28000, Performance =   8.58 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033489 s, Result = 00a5a000, Performance =   8.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033655 s, Result = 00a8c000, Performance =   8.61 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.035006 s, Result = 00abe000, Performance =   8.43 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035622 s, Result = 00af0000, Performance =   8.44 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035795 s, Result = 00b22000, Performance =   8.55 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036315 s, Result = 00b54000, Performance =   8.57 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037092 s, Result = 00b86000, Performance =   8.54 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036972 s, Result = 00bb8000, Performance =   8.71 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.038396 s, Result = 00bea000, Performance =   8.53 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038155 s, Result = 00c1c000, Performance =   8.72 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039179 s, Result = 00c4e000, Performance =   8.63 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.040249 s, Result = 00c80000, Performance =   8.54 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    31  1580   128
Test passed: M N K =  1322     5  1472
Test passed: M N K =   418   835  1088
Test passed: M N K =   938   402   768
Test passed: M N K =  1841  1850   448
M N K =  1024  1024   256, Elapsed time =   0.003547 s, Result = f5042000, Performance =   1.51 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005045 s, Result = a9074000, Performance =   2.13 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005706 s, Result = 5d0a6000, Performance =   2.82 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006367 s, Result = 110d8000, Performance =   3.37 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007028 s, Result = c510a000, Performance =   3.82 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007925 s, Result = 7913c000, Performance =   4.06 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008669 s, Result = 2d16e000, Performance =   4.33 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010256 s, Result = e11a0000, Performance =   4.19 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011159 s, Result = 951d2000, Performance =   4.33 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011817 s, Result = 49204000, Performance =   4.54 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012124 s, Result = fd236000, Performance =   4.87 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013251 s, Result = b1268000, Performance =   4.86 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013217 s, Result = 6529a000, Performance =   5.28 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014570 s, Result = 192cc000, Performance =   5.16 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014409 s, Result = cd2fe000, Performance =   5.59 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016347 s, Result = 81330000, Performance =   5.25 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015605 s, Result = 35362000, Performance =   5.85 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016709 s, Result = e9394000, Performance =   5.78 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016600 s, Result = 9d3c6000, Performance =   6.14 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017164 s, Result = 513f8000, Performance =   6.26 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017747 s, Result = 0542a000, Performance =   6.35 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018504 s, Result = b945c000, Performance =   6.38 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020385 s, Result = 6d48e000, Performance =   6.06 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021187 s, Result = 214c0000, Performance =   6.08 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020170 s, Result = d54f2000, Performance =   6.65 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021391 s, Result = 89524000, Performance =   6.53 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022915 s, Result = 3d556000, Performance =   6.33 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022852 s, Result = f1588000, Performance =   6.58 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023026 s, Result = a55ba000, Performance =   6.76 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024350 s, Result = 595ec000, Performance =   6.61 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025166 s, Result = 0d61e000, Performance =   6.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.028039 s, Result = c1650000, Performance =   6.13 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025429 s, Result = 75682000, Performance =   6.97 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026444 s, Result = 296b4000, Performance =   6.90 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026758 s, Result = dd6e6000, Performance =   7.02 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029945 s, Result = 91718000, Performance =   6.45 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028756 s, Result = 4574a000, Performance =   6.91 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029030 s, Result = f977c000, Performance =   7.03 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030476 s, Result = ad7ae000, Performance =   6.87 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032953 s, Result = 617e0000, Performance =   6.52 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030448 s, Result = 15812000, Performance =   7.23 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031801 s, Result = c9844000, Performance =   7.09 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032965 s, Result = 7d876000, Performance =   7.00 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034398 s, Result = 318a8000, Performance =   6.87 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036210 s, Result = e58da000, Performance =   6.67 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035390 s, Result = 9990c000, Performance =   6.98 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.036882 s, Result = 4d93e000, Performance =   6.84 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.041713 s, Result = 01970000, Performance =   6.18 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037825 s, Result = b59a2000, Performance =   6.95 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.038553 s, Result = 699d4000, Performance =   6.96 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.039169 s, Result = 1da06000, Performance =   6.99 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039609 s, Result = d1a38000, Performance =   7.05 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.040472 s, Result = 85a6a000, Performance =   7.03 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040747 s, Result = 39a9c000, Performance =   7.11 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.042250 s, Result = edace000, Performance =   6.99 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044569 s, Result = a1b00000, Performance =   6.75 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042625 s, Result = 55b32000, Performance =   7.18 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043313 s, Result = 09b64000, Performance =   7.19 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044654 s, Result = bdb96000, Performance =   7.09 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.044706 s, Result = 71bc8000, Performance =   7.21 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045384 s, Result = 25bfa000, Performance =   7.22 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.046212 s, Result = d9c2c000, Performance =   7.20 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.047407 s, Result = 8dc5e000, Performance =   7.13 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.052473 s, Result = 41c90000, Performance =   6.55 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1230  1782   704
Test passed: M N K =  1644   615  1728
Test passed: M N K =   582   554   704
Test passed: M N K =  1991    76  1984
Test passed: M N K =  1205  1305  1664
M N K =  1024  1024   256, Elapsed time =   0.002489 s, Result = 00032000, Performance =   2.16 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004076 s, Result = 00064000, Performance =   2.63 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004835 s, Result = 00096000, Performance =   3.33 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005467 s, Result = 000c8000, Performance =   3.93 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006585 s, Result = 000fa000, Performance =   4.08 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007669 s, Result = 0012c000, Performance =   4.20 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007981 s, Result = 0015e000, Performance =   4.71 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009385 s, Result = 00190000, Performance =   4.58 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009835 s, Result = 001c2000, Performance =   4.91 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010767 s, Result = 001f4000, Performance =   4.99 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012090 s, Result = 00226000, Performance =   4.88 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012182 s, Result = 00258000, Performance =   5.29 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012374 s, Result = 0028a000, Performance =   5.64 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013202 s, Result = 002bc000, Performance =   5.69 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014144 s, Result = 002ee000, Performance =   5.69 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015481 s, Result = 00320000, Performance =   5.55 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014352 s, Result = 00352000, Performance =   6.36 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015198 s, Result = 00384000, Performance =   6.36 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015684 s, Result = 003b6000, Performance =   6.50 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018173 s, Result = 003e8000, Performance =   5.91 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017437 s, Result = 0041a000, Performance =   6.47 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017966 s, Result = 0044c000, Performance =   6.57 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019567 s, Result = 0047e000, Performance =   6.31 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021309 s, Result = 004b0000, Performance =   6.05 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019868 s, Result = 004e2000, Performance =   6.76 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020698 s, Result = 00514000, Performance =   6.74 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023784 s, Result = 00546000, Performance =   6.09 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022743 s, Result = 00578000, Performance =   6.61 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025475 s, Result = 005aa000, Performance =   6.11 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024662 s, Result = 005dc000, Performance =   6.53 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024973 s, Result = 0060e000, Performance =   6.66 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.028299 s, Result = 00640000, Performance =   6.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026709 s, Result = 00672000, Performance =   6.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027285 s, Result = 006a4000, Performance =   6.69 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027557 s, Result = 006d6000, Performance =   6.82 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028361 s, Result = 00708000, Performance =   6.81 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029380 s, Result = 0073a000, Performance =   6.76 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029719 s, Result = 0076c000, Performance =   6.86 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029717 s, Result = 0079e000, Performance =   7.05 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032613 s, Result = 007d0000, Performance =   6.58 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031165 s, Result = 00802000, Performance =   7.06 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031864 s, Result = 00834000, Performance =   7.08 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032610 s, Result = 00866000, Performance =   7.08 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033174 s, Result = 00898000, Performance =   7.12 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032935 s, Result = 008ca000, Performance =   7.34 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034975 s, Result = 008fc000, Performance =   7.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035330 s, Result = 0092e000, Performance =   7.14 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039287 s, Result = 00960000, Performance =   6.56 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036024 s, Result = 00992000, Performance =   7.30 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037902 s, Result = 009c4000, Performance =   7.08 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038065 s, Result = 009f6000, Performance =   7.19 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038276 s, Result = 00a28000, Performance =   7.29 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038923 s, Result = 00a5a000, Performance =   7.31 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040994 s, Result = 00a8c000, Performance =   7.07 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041119 s, Result = 00abe000, Performance =   7.18 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.043685 s, Result = 00af0000, Performance =   6.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.041560 s, Result = 00b22000, Performance =   7.36 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.044172 s, Result = 00b54000, Performance =   7.05 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043938 s, Result = 00b86000, Performance =   7.21 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.043548 s, Result = 00bb8000, Performance =   7.40 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044143 s, Result = 00bea000, Performance =   7.42 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.046111 s, Result = 00c1c000, Performance =   7.22 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.045911 s, Result = 00c4e000, Performance =   7.37 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.050735 s, Result = 00c80000, Performance =   6.77 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   880   118  1472
Test passed: M N K =   903  1826  1920
Test passed: M N K =    23  1673   640
Test passed: M N K =  1202  1382   640
Test passed: M N K =   917  1858   512
M N K =  1024  1024   256, Elapsed time =   0.002230 s, Result = 0a0d2000, Performance =   2.41 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003518 s, Result = 0a104000, Performance =   3.05 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004251 s, Result = 0a136000, Performance =   3.79 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004928 s, Result = 0a168000, Performance =   4.36 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005682 s, Result = 0a19a000, Performance =   4.72 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006247 s, Result = 0a1cc000, Performance =   5.16 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006807 s, Result = 0a1fe000, Performance =   5.52 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008462 s, Result = 0a230000, Performance =   5.08 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008654 s, Result = 0a262000, Performance =   5.58 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009700 s, Result = 0a294000, Performance =   5.53 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009966 s, Result = 0a2c6000, Performance =   5.93 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010584 s, Result = 0a2f8000, Performance =   6.09 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010935 s, Result = 0a32a000, Performance =   6.38 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012431 s, Result = 0a35c000, Performance =   6.05 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012267 s, Result = 0a38e000, Performance =   6.56 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013917 s, Result = 0a3c0000, Performance =   6.17 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013601 s, Result = 0a3f2000, Performance =   6.71 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014866 s, Result = 0a424000, Performance =   6.50 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016345 s, Result = 0a456000, Performance =   6.24 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016288 s, Result = 0a488000, Performance =   6.59 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016989 s, Result = 0a4ba000, Performance =   6.64 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017410 s, Result = 0a4ec000, Performance =   6.78 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019039 s, Result = 0a51e000, Performance =   6.49 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020063 s, Result = 0a550000, Performance =   6.42 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019681 s, Result = 0a582000, Performance =   6.82 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020525 s, Result = 0a5b4000, Performance =   6.80 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021745 s, Result = 0a5e6000, Performance =   6.67 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021977 s, Result = 0a618000, Performance =   6.84 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022269 s, Result = 0a64a000, Performance =   6.99 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023282 s, Result = 0a67c000, Performance =   6.92 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024413 s, Result = 0a6ae000, Performance =   6.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026739 s, Result = 0a6e0000, Performance =   6.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024905 s, Result = 0a712000, Performance =   7.11 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025417 s, Result = 0a744000, Performance =   7.18 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026379 s, Result = 0a776000, Performance =   7.12 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027721 s, Result = 0a7a8000, Performance =   6.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028032 s, Result = 0a7da000, Performance =   7.09 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028160 s, Result = 0a80c000, Performance =   7.24 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029184 s, Result = 0a83e000, Performance =   7.17 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032310 s, Result = 0a870000, Performance =   6.65 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030707 s, Result = 0a8a2000, Performance =   7.17 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030811 s, Result = 0a8d4000, Performance =   7.32 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032654 s, Result = 0a906000, Performance =   7.07 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033025 s, Result = 0a938000, Performance =   7.15 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033696 s, Result = 0a96a000, Performance =   7.17 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033654 s, Result = 0a99c000, Performance =   7.34 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035146 s, Result = 0a9ce000, Performance =   7.18 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039144 s, Result = 0aa00000, Performance =   6.58 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036155 s, Result = 0aa32000, Performance =   7.28 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.036322 s, Result = 0aa64000, Performance =   7.39 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037498 s, Result = 0aa96000, Performance =   7.30 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038305 s, Result = 0aac8000, Performance =   7.29 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039333 s, Result = 0aafa000, Performance =   7.23 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.039124 s, Result = 0ab2c000, Performance =   7.41 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040527 s, Result = 0ab5e000, Performance =   7.29 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.043150 s, Result = 0ab90000, Performance =   6.97 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.041880 s, Result = 0abc2000, Performance =   7.31 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.041655 s, Result = 0abf4000, Performance =   7.48 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043292 s, Result = 0ac26000, Performance =   7.32 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.043875 s, Result = 0ac58000, Performance =   7.34 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044914 s, Result = 0ac8a000, Performance =   7.29 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.044404 s, Result = 0acbc000, Performance =   7.50 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.045706 s, Result = 0acee000, Performance =   7.40 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051137 s, Result = 0ad20000, Performance =   6.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1625  1582   256
Test passed: M N K =   129   896  1216
Test passed: M N K =  1620  1845   192
Test passed: M N K =  1315  1121   896
Test passed: M N K =   771  1443  1536
M N K =  1024  1024   256, Elapsed time =   0.000363 s, Result = 00032000, Performance =  14.81 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000886 s, Result = 00064000, Performance =  12.12 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001474 s, Result = 00096000, Performance =  10.93 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002267 s, Result = 000c8000, Performance =   9.47 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002671 s, Result = 000fa000, Performance =  10.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003345 s, Result = 0012c000, Performance =   9.63 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004083 s, Result = 0015e000, Performance =   9.20 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005237 s, Result = 00190000, Performance =   8.20 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006004 s, Result = 001c2000, Performance =   8.05 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007187 s, Result = 001f4000, Performance =   7.47 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007666 s, Result = 00226000, Performance =   7.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008975 s, Result = 00258000, Performance =   7.18 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009307 s, Result = 0028a000, Performance =   7.50 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009704 s, Result = 002bc000, Performance =   7.75 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009871 s, Result = 002ee000, Performance =   8.16 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012149 s, Result = 00320000, Performance =   7.07 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010527 s, Result = 00352000, Performance =   8.67 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011840 s, Result = 00384000, Performance =   8.16 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011943 s, Result = 003b6000, Performance =   8.54 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012731 s, Result = 003e8000, Performance =   8.43 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013723 s, Result = 0041a000, Performance =   8.22 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013968 s, Result = 0044c000, Performance =   8.46 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014256 s, Result = 0047e000, Performance =   8.66 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017413 s, Result = 004b0000, Performance =   7.40 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015979 s, Result = 004e2000, Performance =   8.40 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016700 s, Result = 00514000, Performance =   8.36 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016957 s, Result = 00546000, Performance =   8.55 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017885 s, Result = 00578000, Performance =   8.41 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018178 s, Result = 005aa000, Performance =   8.56 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019597 s, Result = 005dc000, Performance =   8.22 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019320 s, Result = 0060e000, Performance =   8.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025001 s, Result = 00640000, Performance =   6.87 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020662 s, Result = 00672000, Performance =   8.57 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022127 s, Result = 006a4000, Performance =   8.25 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021876 s, Result = 006d6000, Performance =   8.59 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022903 s, Result = 00708000, Performance =   8.44 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023220 s, Result = 0073a000, Performance =   8.55 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024084 s, Result = 0076c000, Performance =   8.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025867 s, Result = 0079e000, Performance =   8.09 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029040 s, Result = 007d0000, Performance =   7.39 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026369 s, Result = 00802000, Performance =   8.35 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027734 s, Result = 00834000, Performance =   8.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028185 s, Result = 00866000, Performance =   8.19 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028540 s, Result = 00898000, Performance =   8.28 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029037 s, Result = 008ca000, Performance =   8.32 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029697 s, Result = 008fc000, Performance =   8.32 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030359 s, Result = 0092e000, Performance =   8.31 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.038644 s, Result = 00960000, Performance =   6.67 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031065 s, Result = 00992000, Performance =   8.47 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032577 s, Result = 009c4000, Performance =   8.24 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032877 s, Result = 009f6000, Performance =   8.33 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.033573 s, Result = 00a28000, Performance =   8.32 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033714 s, Result = 00a5a000, Performance =   8.44 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.034903 s, Result = 00a8c000, Performance =   8.31 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.035039 s, Result = 00abe000, Performance =   8.43 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040102 s, Result = 00af0000, Performance =   7.50 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.036648 s, Result = 00b22000, Performance =   8.35 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.037433 s, Result = 00b54000, Performance =   8.32 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037497 s, Result = 00b86000, Performance =   8.45 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.039001 s, Result = 00bb8000, Performance =   8.26 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039151 s, Result = 00bea000, Performance =   8.36 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.039847 s, Result = 00c1c000, Performance =   8.35 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.040327 s, Result = 00c4e000, Performance =   8.39 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.049733 s, Result = 00c80000, Performance =   6.91 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1693   413    64
Test passed: M N K =  1435  1937   512
Test passed: M N K =  1523  1510  1792
Test passed: M N K =  1739  2030  1536
Test passed: M N K =  2012  1111   768
M N K =  1024  1024   256, Elapsed time =   0.003573 s, Result = f5042000, Performance =   1.50 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005175 s, Result = a9074000, Performance =   2.08 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005444 s, Result = 5d0a6000, Performance =   2.96 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006015 s, Result = 110d8000, Performance =   3.57 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006939 s, Result = c510a000, Performance =   3.87 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007831 s, Result = 7913c000, Performance =   4.11 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008751 s, Result = 2d16e000, Performance =   4.29 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010082 s, Result = e11a0000, Performance =   4.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010476 s, Result = 951d2000, Performance =   4.61 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011793 s, Result = 49204000, Performance =   4.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013061 s, Result = fd236000, Performance =   4.52 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013937 s, Result = b1268000, Performance =   4.62 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014479 s, Result = 6529a000, Performance =   4.82 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015528 s, Result = 192cc000, Performance =   4.84 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016252 s, Result = cd2fe000, Performance =   4.96 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018066 s, Result = 81330000, Performance =   4.75 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018459 s, Result = 35362000, Performance =   4.94 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018735 s, Result = e9394000, Performance =   5.16 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020571 s, Result = 9d3c6000, Performance =   4.96 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021580 s, Result = 513f8000, Performance =   4.98 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022142 s, Result = 0542a000, Performance =   5.09 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022555 s, Result = b945c000, Performance =   5.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023815 s, Result = 6d48e000, Performance =   5.18 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024791 s, Result = 214c0000, Performance =   5.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025733 s, Result = d54f2000, Performance =   5.22 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025179 s, Result = 89524000, Performance =   5.54 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028046 s, Result = 3d556000, Performance =   5.17 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027921 s, Result = f1588000, Performance =   5.38 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029050 s, Result = a55ba000, Performance =   5.36 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029565 s, Result = 595ec000, Performance =   5.45 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030914 s, Result = 0d61e000, Performance =   5.38 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031499 s, Result = c1650000, Performance =   5.45 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032447 s, Result = 75682000, Performance =   5.46 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033650 s, Result = 296b4000, Performance =   5.42 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034293 s, Result = dd6e6000, Performance =   5.48 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.035035 s, Result = 91718000, Performance =   5.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036700 s, Result = 4574a000, Performance =   5.41 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035884 s, Result = f977c000, Performance =   5.69 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038169 s, Result = ad7ae000, Performance =   5.49 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038186 s, Result = 617e0000, Performance =   5.62 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039933 s, Result = 15812000, Performance =   5.51 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040202 s, Result = c9844000, Performance =   5.61 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042363 s, Result = 7d876000, Performance =   5.45 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042439 s, Result = 318a8000, Performance =   5.57 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043475 s, Result = e58da000, Performance =   5.56 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043495 s, Result = 9990c000, Performance =   5.68 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046194 s, Result = 4d93e000, Performance =   5.46 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046586 s, Result = 01970000, Performance =   5.53 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.047384 s, Result = b59a2000, Performance =   5.55 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047225 s, Result = 699d4000, Performance =   5.68 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.049668 s, Result = 1da06000, Performance =   5.51 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.050522 s, Result = d1a38000, Performance =   5.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050649 s, Result = 85a6a000, Performance =   5.62 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052094 s, Result = 39a9c000, Performance =   5.57 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.052033 s, Result = edace000, Performance =   5.67 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052507 s, Result = a1b00000, Performance =   5.73 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.054676 s, Result = 55b32000, Performance =   5.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055743 s, Result = 09b64000, Performance =   5.59 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.057336 s, Result = bdb96000, Performance =   5.52 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.056409 s, Result = 71bc8000, Performance =   5.71 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.058048 s, Result = 25bfa000, Performance =   5.64 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058749 s, Result = d9c2c000, Performance =   5.67 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.060265 s, Result = 8dc5e000, Performance =   5.61 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.058694 s, Result = 41c90000, Performance =   5.85 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1162  1781  1024
Test passed: M N K =   269   822  1984
Test passed: M N K =  1717  1363  1792
Test passed: M N K =   113  1711  2048
Test passed: M N K =  2046  2000    64
M N K =  1024  1024   256, Elapsed time =   0.002441 s, Result = 00032000, Performance =   2.20 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003162 s, Result = 00064000, Performance =   3.40 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004733 s, Result = 00096000, Performance =   3.40 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005048 s, Result = 000c8000, Performance =   4.25 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006053 s, Result = 000fa000, Performance =   4.43 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006828 s, Result = 0012c000, Performance =   4.72 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007976 s, Result = 0015e000, Performance =   4.71 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009196 s, Result = 00190000, Performance =   4.67 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009928 s, Result = 001c2000, Performance =   4.87 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010804 s, Result = 001f4000, Performance =   4.97 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012038 s, Result = 00226000, Performance =   4.91 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013043 s, Result = 00258000, Performance =   4.94 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013418 s, Result = 0028a000, Performance =   5.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014373 s, Result = 002bc000, Performance =   5.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015626 s, Result = 002ee000, Performance =   5.15 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016783 s, Result = 00320000, Performance =   5.12 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017299 s, Result = 00352000, Performance =   5.28 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018218 s, Result = 00384000, Performance =   5.30 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019413 s, Result = 003b6000, Performance =   5.25 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019895 s, Result = 003e8000, Performance =   5.40 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020719 s, Result = 0041a000, Performance =   5.44 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021923 s, Result = 0044c000, Performance =   5.39 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022493 s, Result = 0047e000, Performance =   5.49 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024240 s, Result = 004b0000, Performance =   5.32 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024932 s, Result = 004e2000, Performance =   5.38 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024886 s, Result = 00514000, Performance =   5.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027042 s, Result = 00546000, Performance =   5.36 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027816 s, Result = 00578000, Performance =   5.40 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028270 s, Result = 005aa000, Performance =   5.51 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028722 s, Result = 005dc000, Performance =   5.61 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029669 s, Result = 0060e000, Performance =   5.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030449 s, Result = 00640000, Performance =   5.64 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.031461 s, Result = 00672000, Performance =   5.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032194 s, Result = 006a4000, Performance =   5.67 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033837 s, Result = 006d6000, Performance =   5.55 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033881 s, Result = 00708000, Performance =   5.70 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035397 s, Result = 0073a000, Performance =   5.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035962 s, Result = 0076c000, Performance =   5.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037150 s, Result = 0079e000, Performance =   5.64 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.036961 s, Result = 007d0000, Performance =   5.81 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039952 s, Result = 00802000, Performance =   5.51 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.039554 s, Result = 00834000, Performance =   5.70 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040773 s, Result = 00866000, Performance =   5.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041166 s, Result = 00898000, Performance =   5.74 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043396 s, Result = 008ca000, Performance =   5.57 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043140 s, Result = 008fc000, Performance =   5.72 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044027 s, Result = 0092e000, Performance =   5.73 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045058 s, Result = 00960000, Performance =   5.72 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.046464 s, Result = 00992000, Performance =   5.66 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047049 s, Result = 009c4000, Performance =   5.71 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047970 s, Result = 009f6000, Performance =   5.71 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048366 s, Result = 00a28000, Performance =   5.77 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050876 s, Result = 00a5a000, Performance =   5.59 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050320 s, Result = 00a8c000, Performance =   5.76 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051671 s, Result = 00abe000, Performance =   5.71 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052414 s, Result = 00af0000, Performance =   5.74 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.054589 s, Result = 00b22000, Performance =   5.61 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055191 s, Result = 00b54000, Performance =   5.64 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.056001 s, Result = 00b86000, Performance =   5.66 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055799 s, Result = 00bb8000, Performance =   5.77 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.057410 s, Result = 00bea000, Performance =   5.70 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058046 s, Result = 00c1c000, Performance =   5.73 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.058289 s, Result = 00c4e000, Performance =   5.80 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.059292 s, Result = 00c80000, Performance =   5.80 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   632  1354  1344
Test passed: M N K =   509  1774  1472
Test passed: M N K =  1516  1477   192
Test passed: M N K =   690   324   832
Test passed: M N K =   894   826   896
M N K =  1024  1024   256, Elapsed time =   0.002218 s, Result = 0a0d2000, Performance =   2.42 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002918 s, Result = 0a104000, Performance =   3.68 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004148 s, Result = 0a136000, Performance =   3.88 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004755 s, Result = 0a168000, Performance =   4.52 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006023 s, Result = 0a19a000, Performance =   4.46 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006473 s, Result = 0a1cc000, Performance =   4.98 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007004 s, Result = 0a1fe000, Performance =   5.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008161 s, Result = 0a230000, Performance =   5.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008855 s, Result = 0a262000, Performance =   5.46 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009638 s, Result = 0a294000, Performance =   5.57 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011283 s, Result = 0a2c6000, Performance =   5.23 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011892 s, Result = 0a2f8000, Performance =   5.42 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012509 s, Result = 0a32a000, Performance =   5.58 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013523 s, Result = 0a35c000, Performance =   5.56 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014483 s, Result = 0a38e000, Performance =   5.56 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015961 s, Result = 0a3c0000, Performance =   5.38 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016238 s, Result = 0a3f2000, Performance =   5.62 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016465 s, Result = 0a424000, Performance =   5.87 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018803 s, Result = 0a456000, Performance =   5.43 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019450 s, Result = 0a488000, Performance =   5.52 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020157 s, Result = 0a4ba000, Performance =   5.59 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020856 s, Result = 0a4ec000, Performance =   5.66 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021955 s, Result = 0a51e000, Performance =   5.62 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021649 s, Result = 0a550000, Performance =   5.95 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023369 s, Result = 0a582000, Performance =   5.74 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024616 s, Result = 0a5b4000, Performance =   5.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026587 s, Result = 0a5e6000, Performance =   5.45 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026148 s, Result = 0a618000, Performance =   5.75 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026581 s, Result = 0a64a000, Performance =   5.86 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.027892 s, Result = 0a67c000, Performance =   5.77 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029025 s, Result = 0a6ae000, Performance =   5.73 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.029164 s, Result = 0a6e0000, Performance =   5.89 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.030524 s, Result = 0a712000, Performance =   5.80 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.030379 s, Result = 0a744000, Performance =   6.01 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.032656 s, Result = 0a776000, Performance =   5.75 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033872 s, Result = 0a7a8000, Performance =   5.71 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034984 s, Result = 0a7da000, Performance =   5.68 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.034103 s, Result = 0a80c000, Performance =   5.98 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036381 s, Result = 0a83e000, Performance =   5.76 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037076 s, Result = 0a870000, Performance =   5.79 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.037083 s, Result = 0a8a2000, Performance =   5.94 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.038005 s, Result = 0a8d4000, Performance =   5.93 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040776 s, Result = 0a906000, Performance =   5.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.040668 s, Result = 0a938000, Performance =   5.81 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.042000 s, Result = 0a96a000, Performance =   5.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.042220 s, Result = 0a99c000, Performance =   5.85 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042151 s, Result = 0a9ce000, Performance =   5.99 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.044714 s, Result = 0aa00000, Performance =   5.76 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.043291 s, Result = 0aa32000, Performance =   6.08 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.045662 s, Result = 0aa64000, Performance =   5.88 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047245 s, Result = 0aa96000, Performance =   5.80 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048039 s, Result = 0aac8000, Performance =   5.81 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048592 s, Result = 0aafa000, Performance =   5.86 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.048680 s, Result = 0ab2c000, Performance =   5.96 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051092 s, Result = 0ab5e000, Performance =   5.78 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051135 s, Result = 0ab90000, Performance =   5.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.052995 s, Result = 0abc2000, Performance =   5.77 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.052769 s, Result = 0abf4000, Performance =   5.90 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054131 s, Result = 0ac26000, Performance =   5.85 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055015 s, Result = 0ac58000, Performance =   5.86 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.055264 s, Result = 0ac8a000, Performance =   5.93 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.056011 s, Result = 0acbc000, Performance =   5.94 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.056700 s, Result = 0acee000, Performance =   5.97 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.056878 s, Result = 0ad20000, Performance =   6.04 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   621   739  2048
Test passed: M N K =    49    86  1600
Test passed: M N K =  1169   774   320
Test passed: M N K =   583  2041    64
Test passed: M N K =   736  1384   768
M N K =  1024  1024   256, Elapsed time =   0.000392 s, Result = 00032000, Performance =  13.71 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001008 s, Result = 00064000, Performance =  10.66 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001423 s, Result = 00096000, Performance =  11.32 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001934 s, Result = 000c8000, Performance =  11.10 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002743 s, Result = 000fa000, Performance =   9.79 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003208 s, Result = 0012c000, Performance =  10.04 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004012 s, Result = 0015e000, Performance =   9.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004885 s, Result = 00190000, Performance =   8.79 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005653 s, Result = 001c2000, Performance =   8.55 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007394 s, Result = 001f4000, Performance =   7.26 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008596 s, Result = 00226000, Performance =   6.87 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009822 s, Result = 00258000, Performance =   6.56 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010337 s, Result = 0028a000, Performance =   6.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011248 s, Result = 002bc000, Performance =   6.68 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012481 s, Result = 002ee000, Performance =   6.45 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013583 s, Result = 00320000, Performance =   6.32 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014232 s, Result = 00352000, Performance =   6.41 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015190 s, Result = 00384000, Performance =   6.36 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016704 s, Result = 003b6000, Performance =   6.11 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015447 s, Result = 003e8000, Performance =   6.95 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018110 s, Result = 0041a000, Performance =   6.23 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018291 s, Result = 0044c000, Performance =   6.46 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019653 s, Result = 0047e000, Performance =   6.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019736 s, Result = 004b0000, Performance =   6.53 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021589 s, Result = 004e2000, Performance =   6.22 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021967 s, Result = 00514000, Performance =   6.35 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022521 s, Result = 00546000, Performance =   6.44 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023013 s, Result = 00578000, Performance =   6.53 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023720 s, Result = 005aa000, Performance =   6.56 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025305 s, Result = 005dc000, Performance =   6.36 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025435 s, Result = 0060e000, Performance =   6.54 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025925 s, Result = 00640000, Performance =   6.63 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027027 s, Result = 00672000, Performance =   6.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028794 s, Result = 006a4000, Performance =   6.34 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029420 s, Result = 006d6000, Performance =   6.39 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030726 s, Result = 00708000, Performance =   6.29 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031654 s, Result = 0073a000, Performance =   6.28 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032115 s, Result = 0076c000, Performance =   6.35 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.033962 s, Result = 0079e000, Performance =   6.17 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033575 s, Result = 007d0000, Performance =   6.40 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033649 s, Result = 00802000, Performance =   6.54 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.035477 s, Result = 00834000, Performance =   6.36 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.034807 s, Result = 00866000, Performance =   6.63 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036342 s, Result = 00898000, Performance =   6.50 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.038630 s, Result = 008ca000, Performance =   6.25 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.038724 s, Result = 008fc000, Performance =   6.38 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038946 s, Result = 0092e000, Performance =   6.48 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.041509 s, Result = 00960000, Performance =   6.21 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.041835 s, Result = 00992000, Performance =   6.29 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.042261 s, Result = 009c4000, Performance =   6.35 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.044520 s, Result = 009f6000, Performance =   6.15 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.043296 s, Result = 00a28000, Performance =   6.45 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.045016 s, Result = 00a5a000, Performance =   6.32 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.045880 s, Result = 00a8c000, Performance =   6.32 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.047562 s, Result = 00abe000, Performance =   6.21 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045648 s, Result = 00af0000, Performance =   6.59 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.048330 s, Result = 00b22000, Performance =   6.33 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.049948 s, Result = 00b54000, Performance =   6.23 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.050626 s, Result = 00b86000, Performance =   6.26 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.050495 s, Result = 00bb8000, Performance =   6.38 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.050946 s, Result = 00bea000, Performance =   6.43 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053467 s, Result = 00c1c000, Performance =   6.23 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.053757 s, Result = 00c4e000, Performance =   6.29 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051778 s, Result = 00c80000, Performance =   6.64 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   474  1170  1600
Test passed: M N K =   151  1551  1152
Test passed: M N K =  1810  1899   704
Test passed: M N K =  1313   427   128
Test passed: M N K =  1955  1695   256
M N K =  1024  1024   256, Elapsed time =   0.004905 s, Result = 8d04c000, Performance =   1.09 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005970 s, Result = f9088000, Performance =   1.80 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006771 s, Result = 650c4000, Performance =   2.38 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007462 s, Result = d1100000, Performance =   2.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008105 s, Result = 3d13c000, Performance =   3.31 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008813 s, Result = a9178000, Performance =   3.65 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009482 s, Result = 151b4000, Performance =   3.96 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010206 s, Result = 811f0000, Performance =   4.21 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010725 s, Result = ed22c000, Performance =   4.51 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011448 s, Result = 59268000, Performance =   4.69 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011853 s, Result = c52a4000, Performance =   4.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012603 s, Result = 312e0000, Performance =   5.11 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013425 s, Result = 9d31c000, Performance =   5.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013942 s, Result = 09358000, Performance =   5.39 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014859 s, Result = 75394000, Performance =   5.42 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015595 s, Result = e13d0000, Performance =   5.51 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016129 s, Result = 4d40c000, Performance =   5.66 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016722 s, Result = b9448000, Performance =   5.78 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017800 s, Result = 25484000, Performance =   5.73 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018164 s, Result = 914c0000, Performance =   5.91 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018889 s, Result = fd4fc000, Performance =   5.97 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019568 s, Result = 69538000, Performance =   6.04 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020209 s, Result = d5574000, Performance =   6.11 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020786 s, Result = 415b0000, Performance =   6.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021355 s, Result = ad5ec000, Performance =   6.29 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022057 s, Result = 19628000, Performance =   6.33 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023386 s, Result = 85664000, Performance =   6.20 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023364 s, Result = f16a0000, Performance =   6.43 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024032 s, Result = 5d6dc000, Performance =   6.48 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024687 s, Result = c9718000, Performance =   6.52 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025744 s, Result = 35754000, Performance =   6.46 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025816 s, Result = a1790000, Performance =   6.65 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027363 s, Result = 0d7cc000, Performance =   6.47 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027190 s, Result = 79808000, Performance =   6.71 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027592 s, Result = e5844000, Performance =   6.81 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028855 s, Result = 51880000, Performance =   6.70 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029023 s, Result = bd8bc000, Performance =   6.84 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029660 s, Result = 298f8000, Performance =   6.88 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030289 s, Result = 95934000, Performance =   6.91 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.031903 s, Result = 01970000, Performance =   6.73 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031652 s, Result = 6d9ac000, Performance =   6.95 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032283 s, Result = d99e8000, Performance =   6.98 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033009 s, Result = 45a24000, Performance =   6.99 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034251 s, Result = b1a60000, Performance =   6.90 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034249 s, Result = 1da9c000, Performance =   7.05 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035816 s, Result = 89ad8000, Performance =   6.90 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.036208 s, Result = f5b14000, Performance =   6.97 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.036884 s, Result = 61b50000, Performance =   6.99 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037701 s, Result = cdb8c000, Performance =   6.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037977 s, Result = 39bc8000, Performance =   7.07 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038725 s, Result = a5c04000, Performance =   7.07 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039400 s, Result = 11c40000, Performance =   7.09 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039807 s, Result = 7dc7c000, Performance =   7.15 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040488 s, Result = e9cb8000, Performance =   7.16 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041181 s, Result = 55cf4000, Performance =   7.17 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.042139 s, Result = c1d30000, Performance =   7.13 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042551 s, Result = 2dd6c000, Performance =   7.19 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043105 s, Result = 99da8000, Performance =   7.22 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044367 s, Result = 05de4000, Performance =   7.14 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.044703 s, Result = 71e20000, Performance =   7.21 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045254 s, Result = dde5c000, Performance =   7.24 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.045439 s, Result = 49e98000, Performance =   7.33 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046328 s, Result = b5ed4000, Performance =   7.30 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.047395 s, Result = 21f10000, Performance =   7.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   183  1975   192
Test passed: M N K =  1924  1753  1600
Test passed: M N K =  1957  1101  1792
Test passed: M N K =  1671  1925  1536
Test passed: M N K =   223   555  1728
M N K =  1024  1024   256, Elapsed time =   0.003374 s, Result = 0003c000, Performance =   1.59 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004025 s, Result = 00078000, Performance =   2.67 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005033 s, Result = 000b4000, Performance =   3.20 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005399 s, Result = 000f0000, Performance =   3.98 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006077 s, Result = 0012c000, Performance =   4.42 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006902 s, Result = 00168000, Performance =   4.67 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007268 s, Result = 001a4000, Performance =   5.17 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008166 s, Result = 001e0000, Performance =   5.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008578 s, Result = 0021c000, Performance =   5.63 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009353 s, Result = 00258000, Performance =   5.74 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010359 s, Result = 00294000, Performance =   5.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011491 s, Result = 002d0000, Performance =   5.61 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011834 s, Result = 0030c000, Performance =   5.90 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013039 s, Result = 00348000, Performance =   5.76 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013754 s, Result = 00384000, Performance =   5.86 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013964 s, Result = 003c0000, Performance =   6.15 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014468 s, Result = 003fc000, Performance =   6.31 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015168 s, Result = 00438000, Performance =   6.37 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015916 s, Result = 00474000, Performance =   6.41 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017294 s, Result = 004b0000, Performance =   6.21 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017218 s, Result = 004ec000, Performance =   6.55 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017897 s, Result = 00528000, Performance =   6.60 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018993 s, Result = 00564000, Performance =   6.50 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019656 s, Result = 005a0000, Performance =   6.56 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019739 s, Result = 005dc000, Performance =   6.80 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021442 s, Result = 00618000, Performance =   6.51 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021296 s, Result = 00654000, Performance =   6.81 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021967 s, Result = 00690000, Performance =   6.84 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023156 s, Result = 006cc000, Performance =   6.72 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022998 s, Result = 00708000, Performance =   7.00 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023757 s, Result = 00744000, Performance =   7.01 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024173 s, Result = 00780000, Performance =   7.11 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026199 s, Result = 007bc000, Performance =   6.76 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025677 s, Result = 007f8000, Performance =   7.11 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026157 s, Result = 00834000, Performance =   7.18 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027202 s, Result = 00870000, Performance =   7.11 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028351 s, Result = 008ac000, Performance =   7.01 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028174 s, Result = 008e8000, Performance =   7.24 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028794 s, Result = 00924000, Performance =   7.27 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029677 s, Result = 00960000, Performance =   7.24 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029956 s, Result = 0099c000, Performance =   7.35 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030881 s, Result = 009d8000, Performance =   7.30 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.031268 s, Result = 00a14000, Performance =   7.38 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031878 s, Result = 00a50000, Performance =   7.41 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033896 s, Result = 00a8c000, Performance =   7.13 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034030 s, Result = 00ac8000, Performance =   7.26 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034779 s, Result = 00b04000, Performance =   7.26 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035277 s, Result = 00b40000, Performance =   7.31 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.035810 s, Result = 00b7c000, Performance =   7.35 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.036777 s, Result = 00bb8000, Performance =   7.30 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037265 s, Result = 00bf4000, Performance =   7.35 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037369 s, Result = 00c30000, Performance =   7.47 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038346 s, Result = 00c6c000, Performance =   7.42 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.038886 s, Result = 00ca8000, Performance =   7.46 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.039438 s, Result = 00ce4000, Performance =   7.49 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040807 s, Result = 00d20000, Performance =   7.37 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.040546 s, Result = 00d5c000, Performance =   7.55 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.041390 s, Result = 00d98000, Performance =   7.52 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.041929 s, Result = 00dd4000, Performance =   7.55 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042572 s, Result = 00e10000, Performance =   7.57 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.043020 s, Result = 00e4c000, Performance =   7.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.044166 s, Result = 00e88000, Performance =   7.54 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.044555 s, Result = 00ec4000, Performance =   7.59 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.045946 s, Result = 00f00000, Performance =   7.48 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   538   886  1984
Test passed: M N K =  1640   644   192
Test passed: M N K =  1888   351   384
Test passed: M N K =    30   149  1088
Test passed: M N K =   688   915   256
M N K =  1024  1024   256, Elapsed time =   0.002862 s, Result = 0a0dc000, Performance =   1.88 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003520 s, Result = 0a118000, Performance =   3.05 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004249 s, Result = 0a154000, Performance =   3.79 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004706 s, Result = 0a190000, Performance =   4.56 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005222 s, Result = 0a1cc000, Performance =   5.14 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005900 s, Result = 0a208000, Performance =   5.46 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006408 s, Result = 0a244000, Performance =   5.87 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007093 s, Result = 0a280000, Performance =   6.05 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007867 s, Result = 0a2bc000, Performance =   6.14 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008129 s, Result = 0a2f8000, Performance =   6.60 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009094 s, Result = 0a334000, Performance =   6.49 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009770 s, Result = 0a370000, Performance =   6.59 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010587 s, Result = 0a3ac000, Performance =   6.59 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011234 s, Result = 0a3e8000, Performance =   6.69 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012100 s, Result = 0a424000, Performance =   6.66 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013007 s, Result = 0a460000, Performance =   6.60 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013301 s, Result = 0a49c000, Performance =   6.86 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014304 s, Result = 0a4d8000, Performance =   6.76 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015049 s, Result = 0a514000, Performance =   6.78 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015655 s, Result = 0a550000, Performance =   6.86 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016259 s, Result = 0a58c000, Performance =   6.93 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016897 s, Result = 0a5c8000, Performance =   6.99 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017913 s, Result = 0a604000, Performance =   6.89 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018367 s, Result = 0a640000, Performance =   7.02 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018897 s, Result = 0a67c000, Performance =   7.10 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019436 s, Result = 0a6b8000, Performance =   7.18 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020417 s, Result = 0a6f4000, Performance =   7.10 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021034 s, Result = 0a730000, Performance =   7.15 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021575 s, Result = 0a76c000, Performance =   7.22 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022119 s, Result = 0a7a8000, Performance =   7.28 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022696 s, Result = 0a7e4000, Performance =   7.33 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023623 s, Result = 0a820000, Performance =   7.27 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024469 s, Result = 0a85c000, Performance =   7.24 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025033 s, Result = 0a898000, Performance =   7.29 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025626 s, Result = 0a8d4000, Performance =   7.33 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026348 s, Result = 0a910000, Performance =   7.34 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026833 s, Result = 0a94c000, Performance =   7.40 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027550 s, Result = 0a988000, Performance =   7.41 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027946 s, Result = 0a9c4000, Performance =   7.49 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029193 s, Result = 0aa00000, Performance =   7.36 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029316 s, Result = 0aa3c000, Performance =   7.51 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030173 s, Result = 0aa78000, Performance =   7.47 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030564 s, Result = 0aab4000, Performance =   7.55 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031367 s, Result = 0aaf0000, Performance =   7.53 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031987 s, Result = 0ab2c000, Performance =   7.55 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032701 s, Result = 0ab68000, Performance =   7.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033099 s, Result = 0aba4000, Performance =   7.62 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.034526 s, Result = 0abe0000, Performance =   7.46 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034451 s, Result = 0ac1c000, Performance =   7.64 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.035106 s, Result = 0ac58000, Performance =   7.65 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.035800 s, Result = 0ac94000, Performance =   7.65 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.036454 s, Result = 0acd0000, Performance =   7.66 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.036683 s, Result = 0ad0c000, Performance =   7.76 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.037741 s, Result = 0ad48000, Performance =   7.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.038415 s, Result = 0ad84000, Performance =   7.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.039128 s, Result = 0adc0000, Performance =   7.68 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.039439 s, Result = 0adfc000, Performance =   7.76 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.040292 s, Result = 0ae38000, Performance =   7.73 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.041077 s, Result = 0ae74000, Performance =   7.71 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.041816 s, Result = 0aeb0000, Performance =   7.70 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.041983 s, Result = 0aeec000, Performance =   7.80 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.042921 s, Result = 0af28000, Performance =   7.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.043657 s, Result = 0af64000, Performance =   7.75 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.045050 s, Result = 0afa0000, Performance =   7.63 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1191   288  1984
Test passed: M N K =  1583  1122  1280
Test passed: M N K =   538  1359  1856
Test passed: M N K =  2025   322  1408
Test passed: M N K =   769    63    64
M N K =  1024  1024   256, Elapsed time =   0.000409 s, Result = 0003c000, Performance =  13.12 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001036 s, Result = 00078000, Performance =  10.36 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001629 s, Result = 000b4000, Performance =   9.89 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002154 s, Result = 000f0000, Performance =   9.97 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002707 s, Result = 0012c000, Performance =   9.92 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003446 s, Result = 00168000, Performance =   9.35 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003758 s, Result = 001a4000, Performance =  10.00 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004567 s, Result = 001e0000, Performance =   9.40 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004915 s, Result = 0021c000, Performance =   9.83 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005528 s, Result = 00258000, Performance =   9.71 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006428 s, Result = 00294000, Performance =   9.19 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006931 s, Result = 002d0000, Performance =   9.30 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007804 s, Result = 0030c000, Performance =   8.94 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008378 s, Result = 00348000, Performance =   8.97 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009374 s, Result = 00384000, Performance =   8.59 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010794 s, Result = 003c0000, Performance =   7.96 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010886 s, Result = 003fc000, Performance =   8.38 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011738 s, Result = 00438000, Performance =   8.23 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012043 s, Result = 00474000, Performance =   8.47 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013212 s, Result = 004b0000, Performance =   8.13 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013822 s, Result = 004ec000, Performance =   8.16 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014664 s, Result = 00528000, Performance =   8.05 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015677 s, Result = 00564000, Performance =   7.88 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016383 s, Result = 005a0000, Performance =   7.86 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016657 s, Result = 005dc000, Performance =   8.06 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017225 s, Result = 00618000, Performance =   8.10 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017721 s, Result = 00654000, Performance =   8.18 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018706 s, Result = 00690000, Performance =   8.04 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019298 s, Result = 006cc000, Performance =   8.07 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019756 s, Result = 00708000, Performance =   8.15 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020507 s, Result = 00744000, Performance =   8.12 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.022000 s, Result = 00780000, Performance =   7.81 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021515 s, Result = 007bc000, Performance =   8.23 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022312 s, Result = 007f8000, Performance =   8.18 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023746 s, Result = 00834000, Performance =   7.91 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024350 s, Result = 00870000, Performance =   7.94 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024295 s, Result = 008ac000, Performance =   8.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025539 s, Result = 008e8000, Performance =   7.99 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025665 s, Result = 00924000, Performance =   8.16 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.026807 s, Result = 00960000, Performance =   8.01 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026739 s, Result = 0099c000, Performance =   8.23 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027880 s, Result = 009d8000, Performance =   8.09 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.029050 s, Result = 00a14000, Performance =   7.95 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.029455 s, Result = 00a50000, Performance =   8.02 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029348 s, Result = 00a8c000, Performance =   8.23 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030728 s, Result = 00ac8000, Performance =   8.04 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030760 s, Result = 00b04000, Performance =   8.20 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.032407 s, Result = 00b40000, Performance =   7.95 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.032670 s, Result = 00b7c000, Performance =   8.05 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032810 s, Result = 00bb8000, Performance =   8.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.033163 s, Result = 00bf4000, Performance =   8.26 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.034911 s, Result = 00c30000, Performance =   8.00 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.034830 s, Result = 00c6c000, Performance =   8.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.036030 s, Result = 00ca8000, Performance =   8.05 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036109 s, Result = 00ce4000, Performance =   8.18 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.037831 s, Result = 00d20000, Performance =   7.95 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.037648 s, Result = 00d5c000, Performance =   8.13 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.038655 s, Result = 00d98000, Performance =   8.06 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038885 s, Result = 00dd4000, Performance =   8.15 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.040354 s, Result = 00e10000, Performance =   7.98 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.040484 s, Result = 00e4c000, Performance =   8.09 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.041079 s, Result = 00e88000, Performance =   8.10 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.041834 s, Result = 00ec4000, Performance =   8.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.043761 s, Result = 00f00000, Performance =   7.85 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1058  1041  1344
Test passed: M N K =   440    66  1344
Test passed: M N K =  1191   672   384
Test passed: M N K =  1391  1011   960
Test passed: M N K =  2005  1052  1088
M N K =  1024  1024   256, Elapsed time =   0.005075 s, Result = 8d04c000, Performance =   1.06 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005980 s, Result = f9088000, Performance =   1.80 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007136 s, Result = 650c4000, Performance =   2.26 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007799 s, Result = d1100000, Performance =   2.75 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.010691 s, Result = 3d13c000, Performance =   2.51 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009241 s, Result = a9178000, Performance =   3.49 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010280 s, Result = 151b4000, Performance =   3.66 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011153 s, Result = 811f0000, Performance =   3.85 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011797 s, Result = ed22c000, Performance =   4.10 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012671 s, Result = 59268000, Performance =   4.24 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013291 s, Result = c52a4000, Performance =   4.44 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014471 s, Result = 312e0000, Performance =   4.45 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014961 s, Result = 9d31c000, Performance =   4.66 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015652 s, Result = 09358000, Performance =   4.80 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016098 s, Result = 75394000, Performance =   5.00 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018680 s, Result = e13d0000, Performance =   4.60 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017104 s, Result = 4d40c000, Performance =   5.34 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018003 s, Result = b9448000, Performance =   5.37 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018908 s, Result = 25484000, Performance =   5.39 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019555 s, Result = 914c0000, Performance =   5.49 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020019 s, Result = fd4fc000, Performance =   5.63 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020849 s, Result = 69538000, Performance =   5.66 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021085 s, Result = d5574000, Performance =   5.86 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022970 s, Result = 415b0000, Performance =   5.61 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024515 s, Result = ad5ec000, Performance =   5.47 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024567 s, Result = 19628000, Performance =   5.68 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024583 s, Result = 85664000, Performance =   5.90 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026051 s, Result = f16a0000, Performance =   5.77 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026372 s, Result = 5d6dc000, Performance =   5.90 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026848 s, Result = c9718000, Performance =   6.00 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.027331 s, Result = 35754000, Performance =   6.09 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032520 s, Result = a1790000, Performance =   5.28 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029153 s, Result = 0d7cc000, Performance =   6.08 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029736 s, Result = 79808000, Performance =   6.14 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030095 s, Result = e5844000, Performance =   6.24 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.031453 s, Result = 51880000, Performance =   6.14 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031628 s, Result = bd8bc000, Performance =   6.28 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032548 s, Result = 298f8000, Performance =   6.27 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032997 s, Result = 95934000, Performance =   6.35 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.035664 s, Result = 01970000, Performance =   6.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034123 s, Result = 6d9ac000, Performance =   6.45 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.035619 s, Result = d99e8000, Performance =   6.33 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.036306 s, Result = 45a24000, Performance =   6.36 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036881 s, Result = b1a60000, Performance =   6.41 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.037047 s, Result = 1da9c000, Performance =   6.52 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.038793 s, Result = 89ad8000, Performance =   6.37 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.039001 s, Result = f5b14000, Performance =   6.47 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045864 s, Result = 61b50000, Performance =   5.62 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040071 s, Result = cdb8c000, Performance =   6.56 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041561 s, Result = 39bc8000, Performance =   6.46 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.041765 s, Result = a5c04000, Performance =   6.56 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042481 s, Result = 11c40000, Performance =   6.57 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.042924 s, Result = 7dc7c000, Performance =   6.63 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044321 s, Result = e9cb8000, Performance =   6.54 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.044771 s, Result = 55cf4000, Performance =   6.60 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.047087 s, Result = c1d30000, Performance =   6.38 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.045595 s, Result = 2dd6c000, Performance =   6.71 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.047761 s, Result = 99da8000, Performance =   6.52 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.047628 s, Result = 05de4000, Performance =   6.65 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.048474 s, Result = 71e20000, Performance =   6.65 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.048271 s, Result = dde5c000, Performance =   6.78 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.049062 s, Result = 49e98000, Performance =   6.78 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.050213 s, Result = b5ed4000, Performance =   6.74 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.061018 s, Result = 21f10000, Performance =   5.63 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1205   649   448
Test passed: M N K =  1547   792  2048
Test passed: M N K =   897  1984  1728
Test passed: M N K =  1926  1502   832
Test passed: M N K =   532  1091   512
M N K =  1024  1024   256, Elapsed time =   0.003427 s, Result = 0003c000, Performance =   1.57 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004497 s, Result = 00078000, Performance =   2.39 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005059 s, Result = 000b4000, Performance =   3.18 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005646 s, Result = 000f0000, Performance =   3.80 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008253 s, Result = 0012c000, Performance =   3.25 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006968 s, Result = 00168000, Performance =   4.62 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007697 s, Result = 001a4000, Performance =   4.88 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008685 s, Result = 001e0000, Performance =   4.94 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009306 s, Result = 0021c000, Performance =   5.19 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010230 s, Result = 00258000, Performance =   5.25 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011054 s, Result = 00294000, Performance =   5.34 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012079 s, Result = 002d0000, Performance =   5.33 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012786 s, Result = 0030c000, Performance =   5.46 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013639 s, Result = 00348000, Performance =   5.51 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014316 s, Result = 00384000, Performance =   5.63 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018184 s, Result = 003c0000, Performance =   4.72 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015133 s, Result = 003fc000, Performance =   6.03 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016185 s, Result = 00438000, Performance =   5.97 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016676 s, Result = 00474000, Performance =   6.12 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017406 s, Result = 004b0000, Performance =   6.17 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017898 s, Result = 004ec000, Performance =   6.30 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018796 s, Result = 00528000, Performance =   6.28 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019166 s, Result = 00564000, Performance =   6.44 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021441 s, Result = 005a0000, Performance =   6.01 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020618 s, Result = 005dc000, Performance =   6.51 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021518 s, Result = 00618000, Performance =   6.49 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021921 s, Result = 00654000, Performance =   6.61 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022886 s, Result = 00690000, Performance =   6.57 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023759 s, Result = 006cc000, Performance =   6.55 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025051 s, Result = 00708000, Performance =   6.43 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024542 s, Result = 00744000, Performance =   6.78 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032199 s, Result = 00780000, Performance =   5.34 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026293 s, Result = 007bc000, Performance =   6.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026662 s, Result = 007f8000, Performance =   6.85 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028173 s, Result = 00834000, Performance =   6.67 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028467 s, Result = 00870000, Performance =   6.79 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030008 s, Result = 008ac000, Performance =   6.62 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030622 s, Result = 008e8000, Performance =   6.66 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.031349 s, Result = 00924000, Performance =   6.68 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033777 s, Result = 00960000, Performance =   6.36 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032269 s, Result = 0099c000, Performance =   6.82 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032896 s, Result = 009d8000, Performance =   6.85 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033915 s, Result = 00a14000, Performance =   6.81 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034931 s, Result = 00a50000, Performance =   6.76 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034710 s, Result = 00a8c000, Performance =   6.96 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035787 s, Result = 00ac8000, Performance =   6.90 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.036005 s, Result = 00b04000, Performance =   7.01 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046940 s, Result = 00b40000, Performance =   5.49 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036846 s, Result = 00b7c000, Performance =   7.14 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.038218 s, Result = 00bb8000, Performance =   7.02 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038758 s, Result = 00bf4000, Performance =   7.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039734 s, Result = 00c30000, Performance =   7.03 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039613 s, Result = 00c6c000, Performance =   7.18 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.041579 s, Result = 00ca8000, Performance =   6.97 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041687 s, Result = 00ce4000, Performance =   7.08 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045958 s, Result = 00d20000, Performance =   6.54 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042525 s, Result = 00d5c000, Performance =   7.20 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043930 s, Result = 00d98000, Performance =   7.09 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044343 s, Result = 00dd4000, Performance =   7.14 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.045211 s, Result = 00e10000, Performance =   7.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045307 s, Result = 00e4c000, Performance =   7.23 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.046440 s, Result = 00e88000, Performance =   7.17 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046966 s, Result = 00ec4000, Performance =   7.20 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.060747 s, Result = 00f00000, Performance =   5.66 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   864   869  1984
Test passed: M N K =   555   187  1216
Test passed: M N K =  1904   674  1408
Test passed: M N K =  1169  1751  1536
Test passed: M N K =  1390   899  1856
M N K =  1024  1024   256, Elapsed time =   0.002930 s, Result = 0a0dc000, Performance =   1.83 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003749 s, Result = 0a118000, Performance =   2.86 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004417 s, Result = 0a154000, Performance =   3.65 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004970 s, Result = 0a190000, Performance =   4.32 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005716 s, Result = 0a1cc000, Performance =   4.70 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006166 s, Result = 0a208000, Performance =   5.22 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006762 s, Result = 0a244000, Performance =   5.56 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007707 s, Result = 0a280000, Performance =   5.57 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008416 s, Result = 0a2bc000, Performance =   5.74 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009318 s, Result = 0a2f8000, Performance =   5.76 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009982 s, Result = 0a334000, Performance =   5.92 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010916 s, Result = 0a370000, Performance =   5.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011506 s, Result = 0a3ac000, Performance =   6.07 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012482 s, Result = 0a3e8000, Performance =   6.02 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013079 s, Result = 0a424000, Performance =   6.16 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016109 s, Result = 0a460000, Performance =   5.33 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014100 s, Result = 0a49c000, Performance =   6.47 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015108 s, Result = 0a4d8000, Performance =   6.40 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015875 s, Result = 0a514000, Performance =   6.43 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016396 s, Result = 0a550000, Performance =   6.55 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017020 s, Result = 0a58c000, Performance =   6.62 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017883 s, Result = 0a5c8000, Performance =   6.60 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018548 s, Result = 0a604000, Performance =   6.66 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021022 s, Result = 0a640000, Performance =   6.13 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019962 s, Result = 0a67c000, Performance =   6.72 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020746 s, Result = 0a6b8000, Performance =   6.73 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020899 s, Result = 0a6f4000, Performance =   6.94 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022360 s, Result = 0a730000, Performance =   6.72 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022626 s, Result = 0a76c000, Performance =   6.88 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023486 s, Result = 0a7a8000, Performance =   6.86 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024224 s, Result = 0a7e4000, Performance =   6.87 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031554 s, Result = 0a820000, Performance =   5.44 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025258 s, Result = 0a85c000, Performance =   7.01 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026293 s, Result = 0a898000, Performance =   6.94 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026675 s, Result = 0a8d4000, Performance =   7.04 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027961 s, Result = 0a910000, Performance =   6.91 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028609 s, Result = 0a94c000, Performance =   6.94 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029070 s, Result = 0a988000, Performance =   7.02 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029395 s, Result = 0a9c4000, Performance =   7.12 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032918 s, Result = 0aa00000, Performance =   6.52 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030848 s, Result = 0aa3c000, Performance =   7.14 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031722 s, Result = 0aa78000, Performance =   7.11 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032195 s, Result = 0aab4000, Performance =   7.17 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033099 s, Result = 0aaf0000, Performance =   7.14 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033457 s, Result = 0ab2c000, Performance =   7.22 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034366 s, Result = 0ab68000, Performance =   7.19 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034779 s, Result = 0aba4000, Performance =   7.26 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045889 s, Result = 0abe0000, Performance =   5.62 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036210 s, Result = 0ac1c000, Performance =   7.27 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037278 s, Result = 0ac58000, Performance =   7.20 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037353 s, Result = 0ac94000, Performance =   7.33 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038605 s, Result = 0acd0000, Performance =   7.23 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039019 s, Result = 0ad0c000, Performance =   7.29 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040072 s, Result = 0ad48000, Performance =   7.23 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040277 s, Result = 0ad84000, Performance =   7.33 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044369 s, Result = 0adc0000, Performance =   6.78 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.041874 s, Result = 0adfc000, Performance =   7.31 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.042904 s, Result = 0ae38000, Performance =   7.26 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.042846 s, Result = 0ae74000, Performance =   7.39 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.043995 s, Result = 0aeb0000, Performance =   7.32 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044506 s, Result = 0aeec000, Performance =   7.36 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.045658 s, Result = 0af28000, Performance =   7.29 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046115 s, Result = 0af64000, Performance =   7.33 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.060202 s, Result = 0afa0000, Performance =   5.71 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   580   422  1472
Test passed: M N K =   450   374   896
Test passed: M N K =   202  1164  1280
Test passed: M N K =  2036   299  1536
Test passed: M N K =  1388   119  1728
M N K =  1024  1024   256, Elapsed time =   0.000440 s, Result = 0003c000, Performance =  12.19 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001013 s, Result = 00078000, Performance =  10.60 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001619 s, Result = 000b4000, Performance =   9.95 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002338 s, Result = 000f0000, Performance =   9.19 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002813 s, Result = 0012c000, Performance =   9.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003238 s, Result = 00168000, Performance =   9.95 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003818 s, Result = 001a4000, Performance =   9.84 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004743 s, Result = 001e0000, Performance =   9.06 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005324 s, Result = 0021c000, Performance =   9.08 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006323 s, Result = 00258000, Performance =   8.49 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007073 s, Result = 00294000, Performance =   8.35 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007708 s, Result = 002d0000, Performance =   8.36 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008951 s, Result = 0030c000, Performance =   7.80 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009765 s, Result = 00348000, Performance =   7.70 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010233 s, Result = 00384000, Performance =   7.87 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014234 s, Result = 003c0000, Performance =   6.03 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011661 s, Result = 003fc000, Performance =   7.83 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012379 s, Result = 00438000, Performance =   7.81 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012974 s, Result = 00474000, Performance =   7.86 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013819 s, Result = 004b0000, Performance =   7.77 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013899 s, Result = 004ec000, Performance =   8.11 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015384 s, Result = 00528000, Performance =   7.68 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015766 s, Result = 00564000, Performance =   7.83 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017872 s, Result = 005a0000, Performance =   7.21 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017054 s, Result = 005dc000, Performance =   7.87 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018034 s, Result = 00618000, Performance =   7.74 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018545 s, Result = 00654000, Performance =   7.82 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019284 s, Result = 00690000, Performance =   7.80 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020095 s, Result = 006cc000, Performance =   7.75 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020833 s, Result = 00708000, Performance =   7.73 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021288 s, Result = 00744000, Performance =   7.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027072 s, Result = 00780000, Performance =   6.35 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022595 s, Result = 007bc000, Performance =   7.84 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023384 s, Result = 007f8000, Performance =   7.81 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024113 s, Result = 00834000, Performance =   7.79 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025055 s, Result = 00870000, Performance =   7.71 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.025257 s, Result = 008ac000, Performance =   7.86 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.026017 s, Result = 008e8000, Performance =   7.84 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.026990 s, Result = 00924000, Performance =   7.76 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029756 s, Result = 00960000, Performance =   7.22 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027857 s, Result = 0099c000, Performance =   7.90 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.028982 s, Result = 009d8000, Performance =   7.78 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.029326 s, Result = 00a14000, Performance =   7.87 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.030461 s, Result = 00a50000, Performance =   7.75 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031371 s, Result = 00a8c000, Performance =   7.70 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.031832 s, Result = 00ac8000, Performance =   7.76 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.032013 s, Result = 00b04000, Performance =   7.88 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042422 s, Result = 00b40000, Performance =   6.07 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.033275 s, Result = 00b7c000, Performance =   7.91 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.034568 s, Result = 00bb8000, Performance =   7.77 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.034704 s, Result = 00bf4000, Performance =   7.89 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.035828 s, Result = 00c30000, Performance =   7.79 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035926 s, Result = 00c6c000, Performance =   7.92 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.037585 s, Result = 00ca8000, Performance =   7.71 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.037644 s, Result = 00ce4000, Performance =   7.84 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.041566 s, Result = 00d20000, Performance =   7.23 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.038802 s, Result = 00d5c000, Performance =   7.89 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.040591 s, Result = 00d98000, Performance =   7.67 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.040770 s, Result = 00dd4000, Performance =   7.77 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.041771 s, Result = 00e10000, Performance =   7.71 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.041535 s, Result = 00e4c000, Performance =   7.88 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.043237 s, Result = 00e88000, Performance =   7.70 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.043364 s, Result = 00ec4000, Performance =   7.80 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.056475 s, Result = 00f00000, Performance =   6.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   535  1747   192
Test passed: M N K =   893  2019  1728
Test passed: M N K =  1652  1462  1024
Test passed: M N K =  2006  1702   192
Test passed: M N K =   428  1152  1920
M N K =  1024  1024   256, Elapsed time =   0.004962 s, Result = 8d04c000, Performance =   1.08 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005899 s, Result = f9088000, Performance =   1.82 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006956 s, Result = 650c4000, Performance =   2.32 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007514 s, Result = d1100000, Performance =   2.86 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008509 s, Result = 3d13c000, Performance =   3.15 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009413 s, Result = a9178000, Performance =   3.42 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010158 s, Result = 151b4000, Performance =   3.70 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010882 s, Result = 811f0000, Performance =   3.95 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011827 s, Result = ed22c000, Performance =   4.09 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012944 s, Result = 59268000, Performance =   4.15 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014448 s, Result = c52a4000, Performance =   4.09 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015138 s, Result = 312e0000, Performance =   4.26 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015961 s, Result = 9d31c000, Performance =   4.37 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017055 s, Result = 09358000, Performance =   4.41 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018340 s, Result = 75394000, Performance =   4.39 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020634 s, Result = e13d0000, Performance =   4.16 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020582 s, Result = 4d40c000, Performance =   4.43 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021443 s, Result = b9448000, Performance =   4.51 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022574 s, Result = 25484000, Performance =   4.52 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024155 s, Result = 914c0000, Performance =   4.45 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024709 s, Result = fd4fc000, Performance =   4.56 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024678 s, Result = 69538000, Performance =   4.79 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026263 s, Result = d5574000, Performance =   4.70 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026854 s, Result = 415b0000, Performance =   4.80 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028520 s, Result = ad5ec000, Performance =   4.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028394 s, Result = 19628000, Performance =   4.92 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029857 s, Result = 85664000, Performance =   4.85 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031155 s, Result = f16a0000, Performance =   4.83 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.031378 s, Result = 5d6dc000, Performance =   4.96 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031905 s, Result = c9718000, Performance =   5.05 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032778 s, Result = 35754000, Performance =   5.08 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036715 s, Result = a1790000, Performance =   4.68 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.035015 s, Result = 0d7cc000, Performance =   5.06 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.035833 s, Result = 79808000, Performance =   5.09 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.036374 s, Result = e5844000, Performance =   5.17 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.038705 s, Result = 51880000, Performance =   4.99 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.039841 s, Result = bd8bc000, Performance =   4.99 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039495 s, Result = 298f8000, Performance =   5.17 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.041011 s, Result = 95934000, Performance =   5.11 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040122 s, Result = 01970000, Performance =   5.35 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.043047 s, Result = 6d9ac000, Performance =   5.11 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043448 s, Result = d99e8000, Performance =   5.19 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042584 s, Result = 45a24000, Performance =   5.42 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.045673 s, Result = b1a60000, Performance =   5.17 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.047212 s, Result = 1da9c000, Performance =   5.12 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.047073 s, Result = 89ad8000, Performance =   5.25 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.047729 s, Result = f5b14000, Performance =   5.29 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.053444 s, Result = 61b50000, Performance =   4.82 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.050343 s, Result = cdb8c000, Performance =   5.23 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.051099 s, Result = 39bc8000, Performance =   5.25 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.050423 s, Result = a5c04000, Performance =   5.43 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.053929 s, Result = 11c40000, Performance =   5.18 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.054355 s, Result = 7dc7c000, Performance =   5.23 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.054700 s, Result = e9cb8000, Performance =   5.30 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.055953 s, Result = 55cf4000, Performance =   5.28 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.054415 s, Result = c1d30000, Performance =   5.53 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.058462 s, Result = 2dd6c000, Performance =   5.23 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.058311 s, Result = 99da8000, Performance =   5.34 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.059305 s, Result = 05de4000, Performance =   5.34 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.060413 s, Result = 71e20000, Performance =   5.33 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.061431 s, Result = dde5c000, Performance =   5.33 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.061816 s, Result = 49e98000, Performance =   5.38 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.061568 s, Result = b5ed4000, Performance =   5.49 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.069003 s, Result = 21f10000, Performance =   4.98 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   618  1968  1856
Test passed: M N K =   902  1560  2048
Test passed: M N K =  1915  1725  1024
Test passed: M N K =   625  1759   704
Test passed: M N K =   730   722  1216
M N K =  1024  1024   256, Elapsed time =   0.003437 s, Result = 0003c000, Performance =   1.56 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004466 s, Result = 00078000, Performance =   2.40 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005017 s, Result = 000b4000, Performance =   3.21 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005728 s, Result = 000f0000, Performance =   3.75 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006428 s, Result = 0012c000, Performance =   4.18 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007504 s, Result = 00168000, Performance =   4.29 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007834 s, Result = 001a4000, Performance =   4.80 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008733 s, Result = 001e0000, Performance =   4.92 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009427 s, Result = 0021c000, Performance =   5.13 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010568 s, Result = 00258000, Performance =   5.08 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012381 s, Result = 00294000, Performance =   4.77 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012943 s, Result = 002d0000, Performance =   4.98 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014101 s, Result = 0030c000, Performance =   4.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014940 s, Result = 00348000, Performance =   5.03 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016587 s, Result = 00384000, Performance =   4.85 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017981 s, Result = 003c0000, Performance =   4.78 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017924 s, Result = 003fc000, Performance =   5.09 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019417 s, Result = 00438000, Performance =   4.98 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020983 s, Result = 00474000, Performance =   4.86 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022126 s, Result = 004b0000, Performance =   4.85 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022970 s, Result = 004ec000, Performance =   4.91 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023328 s, Result = 00528000, Performance =   5.06 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024311 s, Result = 00564000, Performance =   5.08 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024636 s, Result = 005a0000, Performance =   5.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025963 s, Result = 005dc000, Performance =   5.17 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026150 s, Result = 00618000, Performance =   5.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028194 s, Result = 00654000, Performance =   5.14 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029738 s, Result = 00690000, Performance =   5.05 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030156 s, Result = 006cc000, Performance =   5.16 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030519 s, Result = 00708000, Performance =   5.28 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031578 s, Result = 00744000, Performance =   5.27 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034361 s, Result = 00780000, Performance =   5.00 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033820 s, Result = 007bc000, Performance =   5.24 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034073 s, Result = 007f8000, Performance =   5.36 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034642 s, Result = 00834000, Performance =   5.42 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037084 s, Result = 00870000, Performance =   5.21 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037713 s, Result = 008ac000, Performance =   5.27 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038096 s, Result = 008e8000, Performance =   5.36 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039311 s, Result = 00924000, Performance =   5.33 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038779 s, Result = 00960000, Performance =   5.54 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.042002 s, Result = 0099c000, Performance =   5.24 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041956 s, Result = 009d8000, Performance =   5.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.043224 s, Result = 00a14000, Performance =   5.34 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.045747 s, Result = 00a50000, Performance =   5.16 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.045762 s, Result = 00a8c000, Performance =   5.28 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.045178 s, Result = 00ac8000, Performance =   5.47 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.045703 s, Result = 00b04000, Performance =   5.52 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.052351 s, Result = 00b40000, Performance =   4.92 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.049245 s, Result = 00b7c000, Performance =   5.34 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.049390 s, Result = 00bb8000, Performance =   5.44 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.050519 s, Result = 00bf4000, Performance =   5.42 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.051172 s, Result = 00c30000, Performance =   5.46 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.052339 s, Result = 00c6c000, Performance =   5.44 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052101 s, Result = 00ca8000, Performance =   5.56 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.053556 s, Result = 00ce4000, Performance =   5.51 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052923 s, Result = 00d20000, Performance =   5.68 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.056023 s, Result = 00d5c000, Performance =   5.46 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055833 s, Result = 00d98000, Performance =   5.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.057813 s, Result = 00dd4000, Performance =   5.48 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.058771 s, Result = 00e10000, Performance =   5.48 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.059142 s, Result = 00e4c000, Performance =   5.54 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059839 s, Result = 00e88000, Performance =   5.56 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.059504 s, Result = 00ec4000, Performance =   5.68 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.067163 s, Result = 00f00000, Performance =   5.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1489   146  1984
Test passed: M N K =   365  1088   960
Test passed: M N K =   779  1732   256
Test passed: M N K =  1802  1200  1984
Test passed: M N K =  1715  1660   192
M N K =  1024  1024   256, Elapsed time =   0.002928 s, Result = 0a0dc000, Performance =   1.83 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003866 s, Result = 0a118000, Performance =   2.78 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004339 s, Result = 0a154000, Performance =   3.71 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004879 s, Result = 0a190000, Performance =   4.40 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005618 s, Result = 0a1cc000, Performance =   4.78 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006249 s, Result = 0a208000, Performance =   5.15 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006931 s, Result = 0a244000, Performance =   5.42 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007759 s, Result = 0a280000, Performance =   5.54 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008579 s, Result = 0a2bc000, Performance =   5.63 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009376 s, Result = 0a2f8000, Performance =   5.73 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010814 s, Result = 0a334000, Performance =   5.46 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011863 s, Result = 0a370000, Performance =   5.43 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012377 s, Result = 0a3ac000, Performance =   5.64 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013965 s, Result = 0a3e8000, Performance =   5.38 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015135 s, Result = 0a424000, Performance =   5.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016966 s, Result = 0a460000, Performance =   5.06 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017207 s, Result = 0a49c000, Performance =   5.30 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017643 s, Result = 0a4d8000, Performance =   5.48 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019058 s, Result = 0a514000, Performance =   5.35 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020824 s, Result = 0a550000, Performance =   5.16 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021397 s, Result = 0a58c000, Performance =   5.27 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022025 s, Result = 0a5c8000, Performance =   5.36 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023590 s, Result = 0a604000, Performance =   5.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023144 s, Result = 0a640000, Performance =   5.57 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025054 s, Result = 0a67c000, Performance =   5.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026248 s, Result = 0a6b8000, Performance =   5.32 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025994 s, Result = 0a6f4000, Performance =   5.58 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027219 s, Result = 0a730000, Performance =   5.52 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029135 s, Result = 0a76c000, Performance =   5.34 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028769 s, Result = 0a7a8000, Performance =   5.60 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030173 s, Result = 0a7e4000, Performance =   5.52 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034020 s, Result = 0a820000, Performance =   5.05 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032326 s, Result = 0a85c000, Performance =   5.48 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032577 s, Result = 0a898000, Performance =   5.60 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033760 s, Result = 0a8d4000, Performance =   5.57 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.035616 s, Result = 0a910000, Performance =   5.43 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036428 s, Result = 0a94c000, Performance =   5.45 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035850 s, Result = 0a988000, Performance =   5.69 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037235 s, Result = 0a9c4000, Performance =   5.62 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037285 s, Result = 0aa00000, Performance =   5.76 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039347 s, Result = 0aa3c000, Performance =   5.59 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040598 s, Result = 0aa78000, Performance =   5.55 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042400 s, Result = 0aab4000, Performance =   5.44 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042053 s, Result = 0aaf0000, Performance =   5.62 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.042439 s, Result = 0ab2c000, Performance =   5.69 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041349 s, Result = 0ab68000, Performance =   5.97 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044645 s, Result = 0aba4000, Performance =   5.65 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.050722 s, Result = 0abe0000, Performance =   5.08 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.046897 s, Result = 0ac1c000, Performance =   5.61 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.048486 s, Result = 0ac58000, Performance =   5.54 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048350 s, Result = 0ac94000, Performance =   5.66 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.050550 s, Result = 0acd0000, Performance =   5.52 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.051373 s, Result = 0ad0c000, Performance =   5.54 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.051569 s, Result = 0ad48000, Performance =   5.62 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.052187 s, Result = 0ad84000, Performance =   5.66 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051259 s, Result = 0adc0000, Performance =   5.87 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053387 s, Result = 0adfc000, Performance =   5.73 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055511 s, Result = 0ae38000, Performance =   5.61 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055969 s, Result = 0ae74000, Performance =   5.66 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.058224 s, Result = 0aeb0000, Performance =   5.53 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.058491 s, Result = 0aeec000, Performance =   5.60 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059402 s, Result = 0af28000, Performance =   5.60 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.059279 s, Result = 0af64000, Performance =   5.71 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.065925 s, Result = 0afa0000, Performance =   5.21 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    80   210  1728
Test passed: M N K =  1861   948  1216
Test passed: M N K =  1338  1605  1536
Test passed: M N K =  1172  1242  1152
Test passed: M N K =   794   497  1152
M N K =  1024  1024   256, Elapsed time =   0.000487 s, Result = 0003c000, Performance =  11.03 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000793 s, Result = 00078000, Performance =  13.54 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001427 s, Result = 000b4000, Performance =  11.29 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002002 s, Result = 000f0000, Performance =  10.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002644 s, Result = 0012c000, Performance =  10.15 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003039 s, Result = 00168000, Performance =  10.60 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003777 s, Result = 001a4000, Performance =   9.95 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004815 s, Result = 001e0000, Performance =   8.92 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005376 s, Result = 0021c000, Performance =   8.99 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006277 s, Result = 00258000, Performance =   8.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007360 s, Result = 00294000, Performance =   8.02 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009010 s, Result = 002d0000, Performance =   7.15 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009776 s, Result = 0030c000, Performance =   7.14 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010851 s, Result = 00348000, Performance =   6.93 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012538 s, Result = 00384000, Performance =   6.42 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015003 s, Result = 003c0000, Performance =   5.73 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014527 s, Result = 003fc000, Performance =   6.28 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015614 s, Result = 00438000, Performance =   6.19 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016532 s, Result = 00474000, Performance =   6.17 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017526 s, Result = 004b0000, Performance =   6.13 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018935 s, Result = 004ec000, Performance =   5.95 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019374 s, Result = 00528000, Performance =   6.10 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020577 s, Result = 00564000, Performance =   6.00 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020737 s, Result = 005a0000, Performance =   6.21 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022537 s, Result = 005dc000, Performance =   5.96 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.023091 s, Result = 00618000, Performance =   6.04 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024119 s, Result = 00654000, Performance =   6.01 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024564 s, Result = 00690000, Performance =   6.12 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026267 s, Result = 006cc000, Performance =   5.93 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026434 s, Result = 00708000, Performance =   6.09 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.027079 s, Result = 00744000, Performance =   6.15 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031403 s, Result = 00780000, Performance =   5.47 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029704 s, Result = 007bc000, Performance =   5.96 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.030016 s, Result = 007f8000, Performance =   6.08 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030893 s, Result = 00834000, Performance =   6.08 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.032652 s, Result = 00870000, Performance =   5.92 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.032423 s, Result = 008ac000, Performance =   6.13 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.033696 s, Result = 008e8000, Performance =   6.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.034509 s, Result = 00924000, Performance =   6.07 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033001 s, Result = 00960000, Performance =   6.51 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.036655 s, Result = 0099c000, Performance =   6.01 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036582 s, Result = 009d8000, Performance =   6.16 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.038423 s, Result = 00a14000, Performance =   6.01 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.039706 s, Result = 00a50000, Performance =   5.95 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.039761 s, Result = 00a8c000, Performance =   6.08 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041112 s, Result = 00ac8000, Performance =   6.01 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042059 s, Result = 00b04000, Performance =   6.00 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.047551 s, Result = 00b40000, Performance =   5.42 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.042912 s, Result = 00b7c000, Performance =   6.13 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043992 s, Result = 00bb8000, Performance =   6.10 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.046323 s, Result = 00bf4000, Performance =   5.91 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.047280 s, Result = 00c30000, Performance =   5.90 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048422 s, Result = 00c6c000, Performance =   5.88 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.048117 s, Result = 00ca8000, Performance =   6.03 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.050367 s, Result = 00ce4000, Performance =   5.86 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.047938 s, Result = 00d20000, Performance =   6.27 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.051356 s, Result = 00d5c000, Performance =   5.96 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.051063 s, Result = 00d98000, Performance =   6.10 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.053307 s, Result = 00dd4000, Performance =   5.94 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.054097 s, Result = 00e10000, Performance =   5.95 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.054608 s, Result = 00e4c000, Performance =   6.00 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.055559 s, Result = 00e88000, Performance =   5.99 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.055623 s, Result = 00ec4000, Performance =   6.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.061347 s, Result = 00f00000, Performance =   5.60 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   470  1821  1920
Test passed: M N K =   406  2029   320
Test passed: M N K =  1850   134  1216
Test passed: M N K =  1195  1165  1600
Test passed: M N K =  1836   240  1216
M N K =  1024  1024   256, Elapsed time =   0.004223 s, Result = d1038000, Performance =   1.27 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005047 s, Result = 61060000, Performance =   2.13 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005789 s, Result = f1088000, Performance =   2.78 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006284 s, Result = 810b0000, Performance =   3.42 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006727 s, Result = 110d8000, Performance =   3.99 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007266 s, Result = a1100000, Performance =   4.43 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007659 s, Result = 31128000, Performance =   4.91 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008454 s, Result = c1150000, Performance =   5.08 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009103 s, Result = 51178000, Performance =   5.31 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009285 s, Result = e11a0000, Performance =   5.78 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009473 s, Result = 711c8000, Performance =   6.23 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009896 s, Result = 011f0000, Performance =   6.51 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010282 s, Result = 91218000, Performance =   6.79 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011383 s, Result = 21240000, Performance =   6.60 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011688 s, Result = b1268000, Performance =   6.89 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013152 s, Result = 41290000, Performance =   6.53 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012467 s, Result = d12b8000, Performance =   7.32 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012949 s, Result = 612e0000, Performance =   7.46 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013183 s, Result = f1308000, Performance =   7.74 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014186 s, Result = 81330000, Performance =   7.57 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014119 s, Result = 11358000, Performance =   7.99 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014744 s, Result = a1380000, Performance =   8.01 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014657 s, Result = 313a8000, Performance =   8.42 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015658 s, Result = c13d0000, Performance =   8.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015765 s, Result = 513f8000, Performance =   8.51 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016183 s, Result = e1420000, Performance =   8.63 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016662 s, Result = 71448000, Performance =   8.70 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017131 s, Result = 01470000, Performance =   8.78 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.017673 s, Result = 91498000, Performance =   8.81 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.017913 s, Result = 214c0000, Performance =   8.99 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.018514 s, Result = b14e8000, Performance =   8.99 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019110 s, Result = 41510000, Performance =   8.99 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019327 s, Result = d1538000, Performance =   9.17 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019622 s, Result = 61560000, Performance =   9.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.020021 s, Result = f1588000, Performance =   9.39 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.020589 s, Result = 815b0000, Performance =   9.39 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.020856 s, Result = 115d8000, Performance =   9.52 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.021725 s, Result = a1600000, Performance =   9.39 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.021874 s, Result = 31628000, Performance =   9.57 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.022385 s, Result = c1650000, Performance =   9.59 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.022825 s, Result = 51678000, Performance =   9.64 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023139 s, Result = e16a0000, Performance =   9.74 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.023547 s, Result = 716c8000, Performance =   9.80 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.024290 s, Result = 016f0000, Performance =   9.73 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.024517 s, Result = 91718000, Performance =   9.85 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025091 s, Result = 21740000, Performance =   9.84 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.025306 s, Result = b1768000, Performance =   9.97 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.027261 s, Result = 41790000, Performance =   9.45 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.026407 s, Result = d17b8000, Performance =   9.96 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.026914 s, Result = 617e0000, Performance =   9.97 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026797 s, Result = f1808000, Performance =  10.22 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.028007 s, Result = 81830000, Performance =   9.97 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.027908 s, Result = 11858000, Performance =  10.20 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.028259 s, Result = a1880000, Performance =  10.26 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.029053 s, Result = 318a8000, Performance =  10.16 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029679 s, Result = c18d0000, Performance =  10.13 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.029207 s, Result = 518f8000, Performance =  10.48 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030267 s, Result = e1920000, Performance =  10.29 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.030711 s, Result = 71948000, Performance =  10.31 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.031223 s, Result = 01970000, Performance =  10.32 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031689 s, Result = 91998000, Performance =  10.33 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.032106 s, Result = 219c0000, Performance =  10.37 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.032356 s, Result = b19e8000, Performance =  10.45 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.032649 s, Result = 41a10000, Performance =  10.52 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1648   153   512
Test passed: M N K =  1190  1730   896
Test passed: M N K =   369  1605   256
Test passed: M N K =  1390   537   832
Test passed: M N K =  1654    17  1280
M N K =  1024  1024   256, Elapsed time =   0.002767 s, Result = 00028000, Performance =   1.94 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003574 s, Result = 00050000, Performance =   3.00 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004760 s, Result = 00078000, Performance =   3.38 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005000 s, Result = 000a0000, Performance =   4.29 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005731 s, Result = 000c8000, Performance =   4.68 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005823 s, Result = 000f0000, Performance =   5.53 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006776 s, Result = 00118000, Performance =   5.55 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007464 s, Result = 00140000, Performance =   5.75 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007799 s, Result = 00168000, Performance =   6.20 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008070 s, Result = 00190000, Performance =   6.65 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008695 s, Result = 001b8000, Performance =   6.79 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009210 s, Result = 001e0000, Performance =   7.00 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009037 s, Result = 00208000, Performance =   7.72 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011178 s, Result = 00230000, Performance =   6.72 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011104 s, Result = 00258000, Performance =   7.25 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010968 s, Result = 00280000, Performance =   7.83 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011807 s, Result = 002a8000, Performance =   7.73 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013310 s, Result = 002d0000, Performance =   7.26 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012333 s, Result = 002f8000, Performance =   8.27 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013537 s, Result = 00320000, Performance =   7.93 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013614 s, Result = 00348000, Performance =   8.28 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013321 s, Result = 00370000, Performance =   8.87 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014638 s, Result = 00398000, Performance =   8.44 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.014555 s, Result = 003c0000, Performance =   8.85 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015818 s, Result = 003e8000, Performance =   8.49 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.015962 s, Result = 00410000, Performance =   8.74 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016253 s, Result = 00438000, Performance =   8.92 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.016769 s, Result = 00460000, Performance =   8.96 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.017001 s, Result = 00488000, Performance =   9.16 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.017722 s, Result = 004b0000, Performance =   9.09 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.017482 s, Result = 004d8000, Performance =   9.52 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.018106 s, Result = 00500000, Performance =   9.49 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.018194 s, Result = 00528000, Performance =   9.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.018411 s, Result = 00550000, Performance =   9.91 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.018958 s, Result = 00578000, Performance =   9.91 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.019545 s, Result = 005a0000, Performance =   9.89 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.019694 s, Result = 005c8000, Performance =  10.09 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020113 s, Result = 005f0000, Performance =  10.14 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.020837 s, Result = 00618000, Performance =  10.05 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021038 s, Result = 00640000, Performance =  10.21 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.021706 s, Result = 00668000, Performance =  10.14 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.021295 s, Result = 00690000, Performance =  10.59 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.022285 s, Result = 006b8000, Performance =  10.36 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.022544 s, Result = 006e0000, Performance =  10.48 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.023163 s, Result = 00708000, Performance =  10.43 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.023848 s, Result = 00730000, Performance =  10.36 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.024199 s, Result = 00758000, Performance =  10.43 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.025652 s, Result = 00780000, Performance =  10.05 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.024927 s, Result = 007a8000, Performance =  10.55 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.025245 s, Result = 007d0000, Performance =  10.63 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.025580 s, Result = 007f8000, Performance =  10.70 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.026572 s, Result = 00820000, Performance =  10.51 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.026869 s, Result = 00848000, Performance =  10.59 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.026997 s, Result = 00870000, Performance =  10.74 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.027287 s, Result = 00898000, Performance =  10.82 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.027595 s, Result = 008c0000, Performance =  10.89 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.028662 s, Result = 008e8000, Performance =  10.68 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.028943 s, Result = 00910000, Performance =  10.76 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.029480 s, Result = 00938000, Performance =  10.74 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.029849 s, Result = 00960000, Performance =  10.79 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.030053 s, Result = 00988000, Performance =  10.90 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.030313 s, Result = 009b0000, Performance =  10.98 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.030597 s, Result = 009d8000, Performance =  11.05 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.031758 s, Result = 00a00000, Performance =  10.82 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1619   890  1984
Test passed: M N K =  1701   502  1792
Test passed: M N K =   188   675   384
Test passed: M N K =   292  1049  1920
Test passed: M N K =  1866    84  1856
M N K =  1024  1024   256, Elapsed time =   0.002408 s, Result = 0a0c8000, Performance =   2.23 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002949 s, Result = 0a0f0000, Performance =   3.64 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003566 s, Result = 0a118000, Performance =   4.52 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004012 s, Result = 0a140000, Performance =   5.35 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004378 s, Result = 0a168000, Performance =   6.13 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004787 s, Result = 0a190000, Performance =   6.73 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005306 s, Result = 0a1b8000, Performance =   7.08 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006062 s, Result = 0a1e0000, Performance =   7.09 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006013 s, Result = 0a208000, Performance =   8.04 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006418 s, Result = 0a230000, Performance =   8.37 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006876 s, Result = 0a258000, Performance =   8.59 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007340 s, Result = 0a280000, Performance =   8.78 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007979 s, Result = 0a2a8000, Performance =   8.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008198 s, Result = 0a2d0000, Performance =   9.17 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009008 s, Result = 0a2f8000, Performance =   8.94 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009398 s, Result = 0a320000, Performance =   9.14 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009798 s, Result = 0a348000, Performance =   9.31 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010307 s, Result = 0a370000, Performance =   9.38 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010724 s, Result = 0a398000, Performance =   9.51 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011204 s, Result = 0a3c0000, Performance =   9.58 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011514 s, Result = 0a3e8000, Performance =   9.79 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.012156 s, Result = 0a410000, Performance =   9.72 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012566 s, Result = 0a438000, Performance =   9.83 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013117 s, Result = 0a460000, Performance =   9.82 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013361 s, Result = 0a488000, Performance =  10.05 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013706 s, Result = 0a4b0000, Performance =  10.18 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014423 s, Result = 0a4d8000, Performance =  10.05 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014713 s, Result = 0a500000, Performance =  10.22 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.014974 s, Result = 0a528000, Performance =  10.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015452 s, Result = 0a550000, Performance =  10.42 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.016114 s, Result = 0a578000, Performance =  10.33 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.017552 s, Result = 0a5a0000, Performance =   9.79 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.016795 s, Result = 0a5c8000, Performance =  10.55 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.017201 s, Result = 0a5f0000, Performance =  10.61 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017756 s, Result = 0a618000, Performance =  10.58 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018360 s, Result = 0a640000, Performance =  10.53 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.018465 s, Result = 0a668000, Performance =  10.76 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.019322 s, Result = 0a690000, Performance =  10.56 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019330 s, Result = 0a6b8000, Performance =  10.83 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021072 s, Result = 0a6e0000, Performance =  10.19 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.020540 s, Result = 0a708000, Performance =  10.72 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.020576 s, Result = 0a730000, Performance =  10.96 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.021192 s, Result = 0a758000, Performance =  10.89 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.021874 s, Result = 0a780000, Performance =  10.80 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.022054 s, Result = 0a7a8000, Performance =  10.95 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.022626 s, Result = 0a7d0000, Performance =  10.92 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.023216 s, Result = 0a7f8000, Performance =  10.87 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.024546 s, Result = 0a820000, Performance =  10.50 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.023938 s, Result = 0a848000, Performance =  10.99 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.024121 s, Result = 0a870000, Performance =  11.13 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.025039 s, Result = 0a898000, Performance =  10.94 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.025077 s, Result = 0a8c0000, Performance =  11.13 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.025776 s, Result = 0a8e8000, Performance =  11.04 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.026078 s, Result = 0a910000, Performance =  11.12 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.026363 s, Result = 0a938000, Performance =  11.20 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.027323 s, Result = 0a960000, Performance =  11.00 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.027803 s, Result = 0a988000, Performance =  11.01 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.027402 s, Result = 0a9b0000, Performance =  11.36 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.028302 s, Result = 0a9d8000, Performance =  11.19 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.028790 s, Result = 0aa00000, Performance =  11.19 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.028771 s, Result = 0aa28000, Performance =  11.38 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.029470 s, Result = 0aa50000, Performance =  11.29 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.029925 s, Result = 0aa78000, Performance =  11.30 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.030602 s, Result = 0aaa0000, Performance =  11.23 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   753  1255   512
Test passed: M N K =  1042  1984   448
Test passed: M N K =   380  1753   256
Test passed: M N K =   462   563   256
Test passed: M N K =   243  1331  1920
M N K =  1024  1024   256, Elapsed time =   0.000438 s, Result = 00028000, Performance =  12.25 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000911 s, Result = 00050000, Performance =  11.78 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001596 s, Result = 00078000, Performance =  10.09 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001801 s, Result = 000a0000, Performance =  11.92 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002295 s, Result = 000c8000, Performance =  11.70 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002626 s, Result = 000f0000, Performance =  12.26 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003191 s, Result = 00118000, Performance =  11.78 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003831 s, Result = 00140000, Performance =  11.21 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004042 s, Result = 00168000, Performance =  11.95 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004556 s, Result = 00190000, Performance =  11.78 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005011 s, Result = 001b8000, Performance =  11.79 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005412 s, Result = 001e0000, Performance =  11.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006185 s, Result = 00208000, Performance =  11.28 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006511 s, Result = 00230000, Performance =  11.54 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.006778 s, Result = 00258000, Performance =  11.88 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007785 s, Result = 00280000, Performance =  11.03 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.007625 s, Result = 002a8000, Performance =  11.97 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008008 s, Result = 002d0000, Performance =  12.07 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008553 s, Result = 002f8000, Performance =  11.93 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009119 s, Result = 00320000, Performance =  11.77 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009616 s, Result = 00348000, Performance =  11.72 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.010232 s, Result = 00370000, Performance =  11.54 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010494 s, Result = 00398000, Performance =  11.77 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.011305 s, Result = 003c0000, Performance =  11.40 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.011675 s, Result = 003e8000, Performance =  11.50 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011941 s, Result = 00410000, Performance =  11.69 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012535 s, Result = 00438000, Performance =  11.56 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.012936 s, Result = 00460000, Performance =  11.62 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.013306 s, Result = 00488000, Performance =  11.70 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014125 s, Result = 004b0000, Performance =  11.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015254 s, Result = 004d8000, Performance =  10.91 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.015358 s, Result = 00500000, Performance =  11.19 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015187 s, Result = 00528000, Performance =  11.67 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.015959 s, Result = 00550000, Performance =  11.44 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.016144 s, Result = 00578000, Performance =  11.64 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.016595 s, Result = 005a0000, Performance =  11.65 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.016981 s, Result = 005c8000, Performance =  11.70 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.017786 s, Result = 005f0000, Performance =  11.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.018325 s, Result = 00618000, Performance =  11.43 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.019496 s, Result = 00640000, Performance =  11.01 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.019113 s, Result = 00668000, Performance =  11.52 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.019992 s, Result = 00690000, Performance =  11.28 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.020916 s, Result = 006b8000, Performance =  11.04 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.020693 s, Result = 006e0000, Performance =  11.42 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.021192 s, Result = 00708000, Performance =  11.40 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.021329 s, Result = 00730000, Performance =  11.58 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.021913 s, Result = 00758000, Performance =  11.52 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.022818 s, Result = 00780000, Performance =  11.29 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.023111 s, Result = 007a8000, Performance =  11.38 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.023361 s, Result = 007d0000, Performance =  11.49 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.024242 s, Result = 007f8000, Performance =  11.29 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.023902 s, Result = 00820000, Performance =  11.68 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.025347 s, Result = 00848000, Performance =  11.23 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.025519 s, Result = 00870000, Performance =  11.36 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.025271 s, Result = 00898000, Performance =  11.68 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.026244 s, Result = 008c0000, Performance =  11.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.026389 s, Result = 008e8000, Performance =  11.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.027196 s, Result = 00910000, Performance =  11.45 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.027203 s, Result = 00938000, Performance =  11.64 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.027688 s, Result = 00960000, Performance =  11.63 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.028666 s, Result = 00988000, Performance =  11.42 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.028593 s, Result = 009b0000, Performance =  11.64 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.029877 s, Result = 009d8000, Performance =  11.32 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.030274 s, Result = 00a00000, Performance =  11.35 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   505  1070  1088
Test passed: M N K =   611  1321   320
Test passed: M N K =   795   871   960
Test passed: M N K =   559  1426  1600
Test passed: M N K =   167   655   704
M N K =  1024  1024   256, Elapsed time =   0.004261 s, Result = d1038000, Performance =   1.26 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005640 s, Result = 61060000, Performance =   1.90 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005810 s, Result = f1088000, Performance =   2.77 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006633 s, Result = 810b0000, Performance =   3.24 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007037 s, Result = 110d8000, Performance =   3.81 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007581 s, Result = a1100000, Performance =   4.25 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008253 s, Result = 31128000, Performance =   4.55 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009289 s, Result = c1150000, Performance =   4.62 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009952 s, Result = 51178000, Performance =   4.86 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010495 s, Result = e11a0000, Performance =   5.12 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010895 s, Result = 711c8000, Performance =   5.42 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011503 s, Result = 011f0000, Performance =   5.60 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012226 s, Result = 91218000, Performance =   5.71 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012363 s, Result = 21240000, Performance =   6.08 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012573 s, Result = b1268000, Performance =   6.41 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014766 s, Result = 41290000, Performance =   5.82 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013207 s, Result = d12b8000, Performance =   6.91 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013854 s, Result = 612e0000, Performance =   6.98 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014174 s, Result = f1308000, Performance =   7.20 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014747 s, Result = 81330000, Performance =   7.28 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014992 s, Result = 11358000, Performance =   7.52 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016414 s, Result = a1380000, Performance =   7.20 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016518 s, Result = 313a8000, Performance =   7.48 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017550 s, Result = c13d0000, Performance =   7.34 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018005 s, Result = 513f8000, Performance =   7.45 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018111 s, Result = e1420000, Performance =   7.71 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018559 s, Result = 71448000, Performance =   7.81 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018891 s, Result = 01470000, Performance =   7.96 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019581 s, Result = 91498000, Performance =   7.95 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019866 s, Result = 214c0000, Performance =   8.11 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020570 s, Result = b14e8000, Performance =   8.09 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023264 s, Result = 41510000, Performance =   7.38 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021336 s, Result = d1538000, Performance =   8.30 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021769 s, Result = 61560000, Performance =   8.39 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023543 s, Result = f1588000, Performance =   7.98 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023306 s, Result = 815b0000, Performance =   8.29 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023409 s, Result = 115d8000, Performance =   8.49 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024485 s, Result = a1600000, Performance =   8.33 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024807 s, Result = 31628000, Performance =   8.44 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.026381 s, Result = c1650000, Performance =   8.14 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025225 s, Result = 51678000, Performance =   8.73 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026392 s, Result = e16a0000, Performance =   8.54 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027718 s, Result = 716c8000, Performance =   8.33 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.027626 s, Result = 016f0000, Performance =   8.55 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027617 s, Result = 91718000, Performance =   8.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.028553 s, Result = 21740000, Performance =   8.65 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.028534 s, Result = b1768000, Performance =   8.84 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.033196 s, Result = 41790000, Performance =   7.76 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.029543 s, Result = d17b8000, Performance =   8.90 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.029953 s, Result = 617e0000, Performance =   8.96 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.030060 s, Result = f1808000, Performance =   9.11 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.031958 s, Result = 81830000, Performance =   8.74 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.032358 s, Result = 11858000, Performance =   8.79 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.032186 s, Result = a1880000, Performance =   9.01 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.032315 s, Result = 318a8000, Performance =   9.14 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035754 s, Result = c18d0000, Performance =   8.41 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034267 s, Result = 518f8000, Performance =   8.93 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.034389 s, Result = e1920000, Performance =   9.05 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.035184 s, Result = 71948000, Performance =   9.00 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036130 s, Result = 01970000, Performance =   8.92 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.035747 s, Result = 91998000, Performance =   9.16 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036239 s, Result = 219c0000, Performance =   9.19 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.036864 s, Result = b19e8000, Performance =   9.18 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.042434 s, Result = 41a10000, Performance =   8.10 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   837   461  1984
Test passed: M N K =   297  1944  1664
Test passed: M N K =  1261  1162  1152
Test passed: M N K =     9   450  1152
Test passed: M N K =   743    82   256
M N K =  1024  1024   256, Elapsed time =   0.002812 s, Result = 00028000, Performance =   1.91 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004369 s, Result = 00050000, Performance =   2.46 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004938 s, Result = 00078000, Performance =   3.26 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005330 s, Result = 000a0000, Performance =   4.03 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006014 s, Result = 000c8000, Performance =   4.46 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006506 s, Result = 000f0000, Performance =   4.95 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007313 s, Result = 00118000, Performance =   5.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008166 s, Result = 00140000, Performance =   5.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008217 s, Result = 00168000, Performance =   5.88 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008815 s, Result = 00190000, Performance =   6.09 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009758 s, Result = 001b8000, Performance =   6.05 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010599 s, Result = 001e0000, Performance =   6.08 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010357 s, Result = 00208000, Performance =   6.74 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010750 s, Result = 00230000, Performance =   6.99 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010976 s, Result = 00258000, Performance =   7.34 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013751 s, Result = 00280000, Performance =   6.25 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014189 s, Result = 002a8000, Performance =   6.43 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014362 s, Result = 002d0000, Performance =   6.73 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014302 s, Result = 002f8000, Performance =   7.13 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015052 s, Result = 00320000, Performance =   7.13 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015417 s, Result = 00348000, Performance =   7.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015970 s, Result = 00370000, Performance =   7.40 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015557 s, Result = 00398000, Performance =   7.94 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017112 s, Result = 003c0000, Performance =   7.53 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016478 s, Result = 003e8000, Performance =   8.15 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017076 s, Result = 00410000, Performance =   8.17 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017292 s, Result = 00438000, Performance =   8.38 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017920 s, Result = 00460000, Performance =   8.39 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018167 s, Result = 00488000, Performance =   8.57 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019739 s, Result = 004b0000, Performance =   8.16 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019642 s, Result = 004d8000, Performance =   8.47 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021868 s, Result = 00500000, Performance =   7.86 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020594 s, Result = 00528000, Performance =   8.60 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021254 s, Result = 00550000, Performance =   8.59 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021626 s, Result = 00578000, Performance =   8.69 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021862 s, Result = 005a0000, Performance =   8.84 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022900 s, Result = 005c8000, Performance =   8.67 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022819 s, Result = 005f0000, Performance =   8.94 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.023882 s, Result = 00618000, Performance =   8.77 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.024830 s, Result = 00640000, Performance =   8.65 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.024204 s, Result = 00668000, Performance =   9.09 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.024456 s, Result = 00690000, Performance =   9.22 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.026862 s, Result = 006b8000, Performance =   8.59 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.026489 s, Result = 006e0000, Performance =   8.92 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.026188 s, Result = 00708000, Performance =   9.23 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.026706 s, Result = 00730000, Performance =   9.25 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.028464 s, Result = 00758000, Performance =   8.86 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.031442 s, Result = 00780000, Performance =   8.20 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.028135 s, Result = 007a8000, Performance =   9.35 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.029062 s, Result = 007d0000, Performance =   9.24 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.030203 s, Result = 007f8000, Performance =   9.07 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030500 s, Result = 00820000, Performance =   9.15 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.030201 s, Result = 00848000, Performance =   9.42 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031424 s, Result = 00870000, Performance =   9.23 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.032624 s, Result = 00898000, Performance =   9.05 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.033873 s, Result = 008c0000, Performance =   8.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.032085 s, Result = 008e8000, Performance =   9.54 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.033676 s, Result = 00910000, Performance =   9.25 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.034228 s, Result = 00938000, Performance =   9.25 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.034829 s, Result = 00960000, Performance =   9.25 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.033935 s, Result = 00988000, Performance =   9.65 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.035530 s, Result = 009b0000, Performance =   9.37 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.035786 s, Result = 009d8000, Performance =   9.45 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.040744 s, Result = 00a00000, Performance =   8.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   557  1133   832
Test passed: M N K =   524   801  1856
Test passed: M N K =   949   223   576
Test passed: M N K =   949   402   448
Test passed: M N K =   261    25   768
M N K =  1024  1024   256, Elapsed time =   0.002802 s, Result = 0a0c8000, Performance =   1.92 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003083 s, Result = 0a0f0000, Performance =   3.48 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003944 s, Result = 0a118000, Performance =   4.08 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004364 s, Result = 0a140000, Performance =   4.92 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004768 s, Result = 0a168000, Performance =   5.63 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005287 s, Result = 0a190000, Performance =   6.09 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005763 s, Result = 0a1b8000, Performance =   6.52 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006661 s, Result = 0a1e0000, Performance =   6.45 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007317 s, Result = 0a208000, Performance =   6.60 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008084 s, Result = 0a230000, Performance =   6.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008374 s, Result = 0a258000, Performance =   7.05 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008976 s, Result = 0a280000, Performance =   7.18 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009403 s, Result = 0a2a8000, Performance =   7.42 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009760 s, Result = 0a2d0000, Performance =   7.70 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009968 s, Result = 0a2f8000, Performance =   8.08 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012128 s, Result = 0a320000, Performance =   7.08 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011126 s, Result = 0a348000, Performance =   8.20 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011368 s, Result = 0a370000, Performance =   8.50 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012085 s, Result = 0a398000, Performance =   8.44 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012486 s, Result = 0a3c0000, Performance =   8.60 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012828 s, Result = 0a3e8000, Performance =   8.79 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013773 s, Result = 0a410000, Performance =   8.58 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014129 s, Result = 0a438000, Performance =   8.74 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015419 s, Result = 0a460000, Performance =   8.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015132 s, Result = 0a488000, Performance =   8.87 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.015471 s, Result = 0a4b0000, Performance =   9.02 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016161 s, Result = 0a4d8000, Performance =   8.97 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.016730 s, Result = 0a500000, Performance =   8.99 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.016757 s, Result = 0a528000, Performance =   9.29 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018318 s, Result = 0a550000, Performance =   8.79 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.018164 s, Result = 0a578000, Performance =   9.16 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020985 s, Result = 0a5a0000, Performance =   8.19 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019407 s, Result = 0a5c8000, Performance =   9.13 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019673 s, Result = 0a5f0000, Performance =   9.28 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.019750 s, Result = 0a618000, Performance =   9.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022237 s, Result = 0a640000, Performance =   8.69 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.021449 s, Result = 0a668000, Performance =   9.26 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022562 s, Result = 0a690000, Performance =   9.04 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.022233 s, Result = 0a6b8000, Performance =   9.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.023929 s, Result = 0a6e0000, Performance =   8.97 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.023038 s, Result = 0a708000, Performance =   9.55 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023780 s, Result = 0a730000, Performance =   9.48 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.024201 s, Result = 0a758000, Performance =   9.54 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.025952 s, Result = 0a780000, Performance =   9.10 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.025036 s, Result = 0a7a8000, Performance =   9.65 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.027260 s, Result = 0a7d0000, Performance =   9.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026809 s, Result = 0a7f8000, Performance =   9.41 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030369 s, Result = 0a820000, Performance =   8.49 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.027445 s, Result = 0a848000, Performance =   9.59 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.028932 s, Result = 0a870000, Performance =   9.28 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.028144 s, Result = 0a898000, Performance =   9.73 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030323 s, Result = 0a8c0000, Performance =   9.21 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.029643 s, Result = 0a8e8000, Performance =   9.60 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031307 s, Result = 0a910000, Performance =   9.26 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.030957 s, Result = 0a938000, Performance =   9.54 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.032253 s, Result = 0a960000, Performance =   9.32 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.032711 s, Result = 0a988000, Performance =   9.36 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.032432 s, Result = 0a9b0000, Performance =   9.60 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.033497 s, Result = 0a9d8000, Performance =   9.46 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.033071 s, Result = 0aa00000, Performance =   9.74 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.033113 s, Result = 0aa28000, Performance =   9.89 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.035153 s, Result = 0aa50000, Performance =   9.47 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.034965 s, Result = 0aa78000, Performance =   9.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.039310 s, Result = 0aaa0000, Performance =   8.74 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   499  1789  1728
Test passed: M N K =  1562   712  1984
Test passed: M N K =   378  1704  1920
Test passed: M N K =  1446  1897   576
Test passed: M N K =   678  1337   640
M N K =  1024  1024   256, Elapsed time =   0.000445 s, Result = 00028000, Performance =  12.07 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000777 s, Result = 00050000, Performance =  13.81 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001584 s, Result = 00078000, Performance =  10.17 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002163 s, Result = 000a0000, Performance =   9.93 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002445 s, Result = 000c8000, Performance =  10.98 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002916 s, Result = 000f0000, Performance =  11.05 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003369 s, Result = 00118000, Performance =  11.15 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004363 s, Result = 00140000, Performance =   9.84 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004554 s, Result = 00168000, Performance =  10.61 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005344 s, Result = 00190000, Performance =  10.05 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005769 s, Result = 001b8000, Performance =  10.24 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006563 s, Result = 001e0000, Performance =   9.82 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006968 s, Result = 00208000, Performance =  10.02 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007271 s, Result = 00230000, Performance =  10.34 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007511 s, Result = 00258000, Performance =  10.72 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010025 s, Result = 00280000, Performance =   8.57 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008347 s, Result = 002a8000, Performance =  10.93 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008947 s, Result = 002d0000, Performance =  10.80 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009080 s, Result = 002f8000, Performance =  11.23 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009812 s, Result = 00320000, Performance =  10.94 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009932 s, Result = 00348000, Performance =  11.35 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011025 s, Result = 00370000, Performance =  10.71 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010885 s, Result = 00398000, Performance =  11.34 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012561 s, Result = 003c0000, Performance =  10.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.012186 s, Result = 003e8000, Performance =  11.01 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013065 s, Result = 00410000, Performance =  10.68 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012867 s, Result = 00438000, Performance =  11.27 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013533 s, Result = 00460000, Performance =  11.11 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.013956 s, Result = 00488000, Performance =  11.16 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014452 s, Result = 004b0000, Performance =  11.14 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015350 s, Result = 004d8000, Performance =  10.84 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019235 s, Result = 00500000, Performance =   8.93 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015754 s, Result = 00528000, Performance =  11.25 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016796 s, Result = 00550000, Performance =  10.87 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017726 s, Result = 00578000, Performance =  10.60 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.017979 s, Result = 005a0000, Performance =  10.75 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.017939 s, Result = 005c8000, Performance =  11.07 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.018896 s, Result = 005f0000, Performance =  10.80 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019274 s, Result = 00618000, Performance =  10.86 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021715 s, Result = 00640000, Performance =   9.89 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.020324 s, Result = 00668000, Performance =  10.83 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.021116 s, Result = 00690000, Performance =  10.68 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.021234 s, Result = 006b8000, Performance =  10.87 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.022637 s, Result = 006e0000, Performance =  10.44 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.022484 s, Result = 00708000, Performance =  10.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.022990 s, Result = 00730000, Performance =  10.74 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.023243 s, Result = 00758000, Performance =  10.86 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.029780 s, Result = 00780000, Performance =   8.65 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.024358 s, Result = 007a8000, Performance =  10.80 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.024828 s, Result = 007d0000, Performance =  10.81 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.025438 s, Result = 007f8000, Performance =  10.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.026063 s, Result = 00820000, Performance =  10.71 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.026026 s, Result = 00848000, Performance =  10.93 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.026799 s, Result = 00870000, Performance =  10.82 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.026846 s, Result = 00898000, Performance =  11.00 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029899 s, Result = 008c0000, Performance =  10.06 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.028455 s, Result = 008e8000, Performance =  10.75 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.028899 s, Result = 00910000, Performance =  10.77 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.028964 s, Result = 00938000, Performance =  10.94 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.029751 s, Result = 00960000, Performance =  10.83 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.030576 s, Result = 00988000, Performance =  10.71 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.031153 s, Result = 009b0000, Performance =  10.68 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.031255 s, Result = 009d8000, Performance =  10.82 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.039203 s, Result = 00a00000, Performance =   8.76 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   598   596   448
Test passed: M N K =   879  1123  1856
Test passed: M N K =  1020  1247   320
Test passed: M N K =  1539  1600   448
Test passed: M N K =  1957  1358   832
M N K =  1024  1024   256, Elapsed time =   0.004221 s, Result = d1038000, Performance =   1.27 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005217 s, Result = 61060000, Performance =   2.06 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005621 s, Result = f1088000, Performance =   2.87 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006076 s, Result = 810b0000, Performance =   3.53 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006906 s, Result = 110d8000, Performance =   3.89 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007611 s, Result = a1100000, Performance =   4.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008597 s, Result = 31128000, Performance =   4.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008961 s, Result = c1150000, Performance =   4.79 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009694 s, Result = 51178000, Performance =   4.98 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010679 s, Result = e11a0000, Performance =   5.03 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011371 s, Result = 711c8000, Performance =   5.19 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012402 s, Result = 011f0000, Performance =   5.19 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012298 s, Result = 91218000, Performance =   5.68 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012946 s, Result = 21240000, Performance =   5.81 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014230 s, Result = b1268000, Performance =   5.66 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015652 s, Result = 41290000, Performance =   5.49 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015382 s, Result = d12b8000, Performance =   5.93 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015914 s, Result = 612e0000, Performance =   6.07 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016319 s, Result = f1308000, Performance =   6.25 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017617 s, Result = 81330000, Performance =   6.10 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018985 s, Result = 11358000, Performance =   5.94 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019094 s, Result = a1380000, Performance =   6.19 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019738 s, Result = 313a8000, Performance =   6.26 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019697 s, Result = c13d0000, Performance =   6.54 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021377 s, Result = 513f8000, Performance =   6.28 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021817 s, Result = e1420000, Performance =   6.40 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022187 s, Result = 71448000, Performance =   6.53 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023137 s, Result = 01470000, Performance =   6.50 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024163 s, Result = 91498000, Performance =   6.44 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023650 s, Result = 214c0000, Performance =   6.81 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024697 s, Result = b14e8000, Performance =   6.74 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026383 s, Result = 41510000, Performance =   6.51 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026175 s, Result = d1538000, Performance =   6.77 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028032 s, Result = 61560000, Performance =   6.51 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028565 s, Result = f1588000, Performance =   6.58 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028733 s, Result = 815b0000, Performance =   6.73 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029843 s, Result = 115d8000, Performance =   6.66 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030057 s, Result = a1600000, Performance =   6.79 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030711 s, Result = 31628000, Performance =   6.82 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030310 s, Result = c1650000, Performance =   7.09 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032371 s, Result = 51678000, Performance =   6.80 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032974 s, Result = e16a0000, Performance =   6.84 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033466 s, Result = 716c8000, Performance =   6.90 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033631 s, Result = 016f0000, Performance =   7.02 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034744 s, Result = 91718000, Performance =   6.95 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035449 s, Result = 21740000, Performance =   6.97 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035953 s, Result = b1768000, Performance =   7.02 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037515 s, Result = 41790000, Performance =   6.87 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037088 s, Result = d17b8000, Performance =   7.09 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.038016 s, Result = 617e0000, Performance =   7.06 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038949 s, Result = f1808000, Performance =   7.03 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038859 s, Result = 81830000, Performance =   7.18 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039921 s, Result = 11858000, Performance =   7.13 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.041340 s, Result = a1880000, Performance =   7.01 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041920 s, Result = 318a8000, Performance =   7.04 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040644 s, Result = c18d0000, Performance =   7.40 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042847 s, Result = 518f8000, Performance =   7.14 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043912 s, Result = e1920000, Performance =   7.09 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044137 s, Result = 71948000, Performance =   7.18 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042640 s, Result = 01970000, Performance =   7.55 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045078 s, Result = 91998000, Performance =   7.27 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.045932 s, Result = 219c0000, Performance =   7.25 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046143 s, Result = b19e8000, Performance =   7.33 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.048128 s, Result = 41a10000, Performance =   7.14 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1830   309  1536
Test passed: M N K =  1645  1122   256
Test passed: M N K =   372   908  1920
Test passed: M N K =   601  1301   576
Test passed: M N K =  1536  1591  1920
M N K =  1024  1024   256, Elapsed time =   0.002824 s, Result = 00028000, Performance =   1.90 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004403 s, Result = 00050000, Performance =   2.44 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004656 s, Result = 00078000, Performance =   3.46 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005764 s, Result = 000a0000, Performance =   3.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005913 s, Result = 000c8000, Performance =   4.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006741 s, Result = 000f0000, Performance =   4.78 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007681 s, Result = 00118000, Performance =   4.89 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008765 s, Result = 00140000, Performance =   4.90 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008762 s, Result = 00168000, Performance =   5.51 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009299 s, Result = 00190000, Performance =   5.77 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010199 s, Result = 001b8000, Performance =   5.79 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010932 s, Result = 001e0000, Performance =   5.89 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012173 s, Result = 00208000, Performance =   5.73 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012159 s, Result = 00230000, Performance =   6.18 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012968 s, Result = 00258000, Performance =   6.21 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014622 s, Result = 00280000, Performance =   5.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014872 s, Result = 002a8000, Performance =   6.14 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015051 s, Result = 002d0000, Performance =   6.42 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016088 s, Result = 002f8000, Performance =   6.34 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016532 s, Result = 00320000, Performance =   6.50 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016671 s, Result = 00348000, Performance =   6.76 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018579 s, Result = 00370000, Performance =   6.36 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018168 s, Result = 00398000, Performance =   6.80 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018689 s, Result = 003c0000, Performance =   6.89 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020110 s, Result = 003e8000, Performance =   6.67 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021055 s, Result = 00410000, Performance =   6.63 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021549 s, Result = 00438000, Performance =   6.73 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021632 s, Result = 00460000, Performance =   6.95 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022541 s, Result = 00488000, Performance =   6.91 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023069 s, Result = 004b0000, Performance =   6.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025046 s, Result = 004d8000, Performance =   6.64 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025236 s, Result = 00500000, Performance =   6.81 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025187 s, Result = 00528000, Performance =   7.03 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026313 s, Result = 00550000, Performance =   6.94 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027670 s, Result = 00578000, Performance =   6.79 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027736 s, Result = 005a0000, Performance =   6.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028563 s, Result = 005c8000, Performance =   6.95 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028995 s, Result = 005f0000, Performance =   7.04 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030127 s, Result = 00618000, Performance =   6.95 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029009 s, Result = 00640000, Performance =   7.40 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030843 s, Result = 00668000, Performance =   7.14 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031257 s, Result = 00690000, Performance =   7.21 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032440 s, Result = 006b8000, Performance =   7.12 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.032836 s, Result = 006e0000, Performance =   7.19 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032754 s, Result = 00708000, Performance =   7.38 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033858 s, Result = 00730000, Performance =   7.29 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034870 s, Result = 00758000, Performance =   7.24 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.036331 s, Result = 00780000, Performance =   7.09 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034978 s, Result = 007a8000, Performance =   7.52 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.036559 s, Result = 007d0000, Performance =   7.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037763 s, Result = 007f8000, Performance =   7.25 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037522 s, Result = 00820000, Performance =   7.44 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038840 s, Result = 00848000, Performance =   7.33 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.039494 s, Result = 00870000, Performance =   7.34 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040592 s, Result = 00898000, Performance =   7.27 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.039619 s, Result = 008c0000, Performance =   7.59 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042075 s, Result = 008e8000, Performance =   7.27 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.042444 s, Result = 00910000, Performance =   7.34 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043299 s, Result = 00938000, Performance =   7.32 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042542 s, Result = 00960000, Performance =   7.57 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044161 s, Result = 00988000, Performance =   7.42 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.044816 s, Result = 009b0000, Performance =   7.43 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.045140 s, Result = 009d8000, Performance =   7.49 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.046377 s, Result = 00a00000, Performance =   7.41 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1558   197    64
Test passed: M N K =   936  1942  1600
Test passed: M N K =  1903   151   512
Test passed: M N K =   763   744  1664
Test passed: M N K =   964  1537  1856
M N K =  1024  1024   256, Elapsed time =   0.002429 s, Result = 0a0c8000, Performance =   2.21 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002960 s, Result = 0a0f0000, Performance =   3.63 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003925 s, Result = 0a118000, Performance =   4.10 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004177 s, Result = 0a140000, Performance =   5.14 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004707 s, Result = 0a168000, Performance =   5.70 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005302 s, Result = 0a190000, Performance =   6.08 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005956 s, Result = 0a1b8000, Performance =   6.31 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006692 s, Result = 0a1e0000, Performance =   6.42 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006982 s, Result = 0a208000, Performance =   6.92 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007933 s, Result = 0a230000, Performance =   6.77 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008916 s, Result = 0a258000, Performance =   6.62 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009576 s, Result = 0a280000, Performance =   6.73 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009961 s, Result = 0a2a8000, Performance =   7.01 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010137 s, Result = 0a2d0000, Performance =   7.41 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011296 s, Result = 0a2f8000, Performance =   7.13 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012718 s, Result = 0a320000, Performance =   6.75 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013076 s, Result = 0a348000, Performance =   6.98 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013825 s, Result = 0a370000, Performance =   6.99 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014816 s, Result = 0a398000, Performance =   6.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015601 s, Result = 0a3c0000, Performance =   6.88 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015927 s, Result = 0a3e8000, Performance =   7.08 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016930 s, Result = 0a410000, Performance =   6.98 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016436 s, Result = 0a438000, Performance =   7.51 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017176 s, Result = 0a460000, Performance =   7.50 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018671 s, Result = 0a488000, Performance =   7.19 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019535 s, Result = 0a4b0000, Performance =   7.15 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020417 s, Result = 0a4d8000, Performance =   7.10 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020630 s, Result = 0a500000, Performance =   7.29 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021762 s, Result = 0a528000, Performance =   7.15 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020915 s, Result = 0a550000, Performance =   7.70 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022486 s, Result = 0a578000, Performance =   7.40 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023615 s, Result = 0a5a0000, Performance =   7.28 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023078 s, Result = 0a5c8000, Performance =   7.68 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.024511 s, Result = 0a5f0000, Performance =   7.45 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025554 s, Result = 0a618000, Performance =   7.35 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025899 s, Result = 0a640000, Performance =   7.46 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026920 s, Result = 0a668000, Performance =   7.38 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027692 s, Result = 0a690000, Performance =   7.37 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028549 s, Result = 0a6b8000, Performance =   7.33 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.027910 s, Result = 0a6e0000, Performance =   7.69 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029608 s, Result = 0a708000, Performance =   7.43 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030328 s, Result = 0a730000, Performance =   7.43 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.031318 s, Result = 0a758000, Performance =   7.37 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031928 s, Result = 0a780000, Performance =   7.40 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031356 s, Result = 0a7a8000, Performance =   7.70 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032909 s, Result = 0a7d0000, Performance =   7.50 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033622 s, Result = 0a7f8000, Performance =   7.50 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035236 s, Result = 0a820000, Performance =   7.31 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034898 s, Result = 0a848000, Performance =   7.54 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.035518 s, Result = 0a870000, Performance =   7.56 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.036798 s, Result = 0a898000, Performance =   7.44 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037069 s, Result = 0a8c0000, Performance =   7.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038157 s, Result = 0a8e8000, Performance =   7.46 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.038539 s, Result = 0a910000, Performance =   7.52 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.038903 s, Result = 0a938000, Performance =   7.59 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.037944 s, Result = 0a960000, Performance =   7.92 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.040812 s, Result = 0a988000, Performance =   7.50 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.041454 s, Result = 0a9b0000, Performance =   7.51 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.042334 s, Result = 0a9d8000, Performance =   7.48 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.042290 s, Result = 0aa00000, Performance =   7.62 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.043159 s, Result = 0aa28000, Performance =   7.59 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.043761 s, Result = 0aa50000, Performance =   7.61 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.044114 s, Result = 0aa78000, Performance =   7.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.046232 s, Result = 0aaa0000, Performance =   7.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   241  1492   192
Test passed: M N K =   867   974   704
Test passed: M N K =  1589  1060  1600
Test passed: M N K =  1640  1572  1088
Test passed: M N K =  1558   370  1088
M N K =  1024  1024   256, Elapsed time =   0.000469 s, Result = 00028000, Performance =  11.45 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000969 s, Result = 00050000, Performance =  11.08 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001523 s, Result = 00078000, Performance =  10.57 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001974 s, Result = 000a0000, Performance =  10.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002612 s, Result = 000c8000, Performance =  10.28 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003072 s, Result = 000f0000, Performance =  10.49 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003517 s, Result = 00118000, Performance =  10.68 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004259 s, Result = 00140000, Performance =  10.09 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004775 s, Result = 00168000, Performance =  10.12 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005618 s, Result = 00190000, Performance =   9.56 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006579 s, Result = 001b8000, Performance =   8.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007332 s, Result = 001e0000, Performance =   8.79 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007469 s, Result = 00208000, Performance =   9.34 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008470 s, Result = 00230000, Performance =   8.87 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009275 s, Result = 00258000, Performance =   8.68 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010462 s, Result = 00280000, Performance =   8.21 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010621 s, Result = 002a8000, Performance =   8.59 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011164 s, Result = 002d0000, Performance =   8.66 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012423 s, Result = 002f8000, Performance =   8.21 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013036 s, Result = 00320000, Performance =   8.24 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013756 s, Result = 00348000, Performance =   8.20 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013334 s, Result = 00370000, Performance =   8.86 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015376 s, Result = 00398000, Performance =   8.03 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015205 s, Result = 003c0000, Performance =   8.47 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015962 s, Result = 003e8000, Performance =   8.41 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016481 s, Result = 00410000, Performance =   8.47 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017445 s, Result = 00438000, Performance =   8.31 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018217 s, Result = 00460000, Performance =   8.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019066 s, Result = 00488000, Performance =   8.17 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019057 s, Result = 004b0000, Performance =   8.45 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020421 s, Result = 004d8000, Performance =   8.15 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020598 s, Result = 00500000, Performance =   8.34 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021552 s, Result = 00528000, Performance =   8.22 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022283 s, Result = 00550000, Performance =   8.19 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022429 s, Result = 00578000, Performance =   8.38 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024005 s, Result = 005a0000, Performance =   8.05 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024388 s, Result = 005c8000, Performance =   8.14 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023853 s, Result = 005f0000, Performance =   8.55 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024346 s, Result = 00618000, Performance =   8.60 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.024542 s, Result = 00640000, Performance =   8.75 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027125 s, Result = 00668000, Performance =   8.11 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027150 s, Result = 00690000, Performance =   8.31 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028105 s, Result = 006b8000, Performance =   8.21 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028929 s, Result = 006e0000, Performance =   8.17 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.030063 s, Result = 00708000, Performance =   8.04 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029402 s, Result = 00730000, Performance =   8.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.031325 s, Result = 00758000, Performance =   8.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.031703 s, Result = 00780000, Performance =   8.13 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.032582 s, Result = 007a8000, Performance =   8.07 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032639 s, Result = 007d0000, Performance =   8.22 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032208 s, Result = 007f8000, Performance =   8.50 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.034191 s, Result = 00820000, Performance =   8.17 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035507 s, Result = 00848000, Performance =   8.01 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.034608 s, Result = 00870000, Performance =   8.38 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036295 s, Result = 00898000, Performance =   8.14 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035180 s, Result = 008c0000, Performance =   8.55 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.037846 s, Result = 008e8000, Performance =   8.09 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.037966 s, Result = 00910000, Performance =   8.20 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038653 s, Result = 00938000, Performance =   8.19 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.039043 s, Result = 00960000, Performance =   8.25 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.040706 s, Result = 00988000, Performance =   8.05 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.041065 s, Result = 009b0000, Performance =   8.11 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.041761 s, Result = 009d8000, Performance =   8.10 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.042290 s, Result = 00a00000, Performance =   8.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   411   603   384
Test passed: M N K =   564   462  1216
Test passed: M N K =  1609  1457   576
Test passed: M N K =   237  1776   192
Test passed: M N K =   272   893  1152
M N K =  1024  1024   256, Elapsed time =   0.003716 s, Result = 5902e000, Performance =   1.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004710 s, Result = 3104c000, Performance =   2.28 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005021 s, Result = 0906a000, Performance =   3.21 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005543 s, Result = e1088000, Performance =   3.87 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005773 s, Result = b90a6000, Performance =   4.65 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006162 s, Result = 910c4000, Performance =   5.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006510 s, Result = 690e2000, Performance =   5.77 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007427 s, Result = 41100000, Performance =   5.78 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007727 s, Result = 1911e000, Performance =   6.25 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007865 s, Result = f113c000, Performance =   6.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007705 s, Result = c915a000, Performance =   7.67 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008305 s, Result = a1178000, Performance =   7.76 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008479 s, Result = 79196000, Performance =   8.23 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009781 s, Result = 511b4000, Performance =   7.68 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010002 s, Result = 291d2000, Performance =   8.05 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010348 s, Result = 011f0000, Performance =   8.30 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010224 s, Result = d920e000, Performance =   8.93 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010675 s, Result = b122c000, Performance =   9.05 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010725 s, Result = 8924a000, Performance =   9.51 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010990 s, Result = 61268000, Performance =   9.77 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011221 s, Result = 39286000, Performance =  10.05 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011646 s, Result = 112a4000, Performance =  10.14 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012905 s, Result = e92c2000, Performance =   9.57 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012749 s, Result = c12e0000, Performance =  10.11 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013004 s, Result = 992fe000, Performance =  10.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013311 s, Result = 7131c000, Performance =  10.49 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014313 s, Result = 4933a000, Performance =  10.13 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013573 s, Result = 21358000, Performance =  11.08 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015390 s, Result = f9376000, Performance =  10.12 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014665 s, Result = d1394000, Performance =  10.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015409 s, Result = a93b2000, Performance =  10.80 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016248 s, Result = 813d0000, Performance =  10.57 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.016775 s, Result = 593ee000, Performance =  10.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016518 s, Result = 3140c000, Performance =  11.05 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.016775 s, Result = 0942a000, Performance =  11.20 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.016644 s, Result = e1448000, Performance =  11.61 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.017354 s, Result = b9466000, Performance =  11.45 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.017244 s, Result = 91484000, Performance =  11.83 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017884 s, Result = 694a2000, Performance =  11.71 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.018508 s, Result = 414c0000, Performance =  11.60 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.019027 s, Result = 194de000, Performance =  11.57 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.019282 s, Result = f14fc000, Performance =  11.69 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.019994 s, Result = c951a000, Performance =  11.55 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.019339 s, Result = a1538000, Performance =  12.21 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.020375 s, Result = 79556000, Performance =  11.86 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.020484 s, Result = 51574000, Performance =  12.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020769 s, Result = 29592000, Performance =  12.15 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020983 s, Result = 015b0000, Performance =  12.28 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.021865 s, Result = d95ce000, Performance =  12.03 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.022002 s, Result = b15ec000, Performance =  12.20 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.022639 s, Result = 8960a000, Performance =  12.09 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.022761 s, Result = 61628000, Performance =  12.27 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.023508 s, Result = 39646000, Performance =  12.10 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.023886 s, Result = 11664000, Performance =  12.14 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.024004 s, Result = e9682000, Performance =  12.30 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.024215 s, Result = c16a0000, Performance =  12.42 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.024671 s, Result = 996be000, Performance =  12.40 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.025077 s, Result = 716dc000, Performance =  12.42 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.025167 s, Result = 496fa000, Performance =  12.59 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.026171 s, Result = 21718000, Performance =  12.31 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025968 s, Result = f9736000, Performance =  12.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.026070 s, Result = d1754000, Performance =  12.77 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026684 s, Result = a9772000, Performance =  12.68 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.028461 s, Result = 81790000, Performance =  12.07 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1200  1421   128
Test passed: M N K =   924  1236    64
Test passed: M N K =   477   945    64
Test passed: M N K =  1777   385  1024
Test passed: M N K =  1008   852   448
M N K =  1024  1024   256, Elapsed time =   0.002325 s, Result = 0001e000, Performance =   2.31 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003030 s, Result = 0003c000, Performance =   3.54 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004190 s, Result = 0005a000, Performance =   3.84 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004985 s, Result = 00078000, Performance =   4.31 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004853 s, Result = 00096000, Performance =   5.53 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005174 s, Result = 000b4000, Performance =   6.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005703 s, Result = 000d2000, Performance =   6.59 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006602 s, Result = 000f0000, Performance =   6.51 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006286 s, Result = 0010e000, Performance =   7.69 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007027 s, Result = 0012c000, Performance =   7.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007023 s, Result = 0014a000, Performance =   8.41 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007378 s, Result = 00168000, Performance =   8.73 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008217 s, Result = 00186000, Performance =   8.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008484 s, Result = 001a4000, Performance =   8.86 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008782 s, Result = 001c2000, Performance =   9.17 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009271 s, Result = 001e0000, Performance =   9.27 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009527 s, Result = 001fe000, Performance =   9.58 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010907 s, Result = 0021c000, Performance =   8.86 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010972 s, Result = 0023a000, Performance =   9.30 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010797 s, Result = 00258000, Performance =   9.95 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011626 s, Result = 00276000, Performance =   9.70 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011589 s, Result = 00294000, Performance =  10.19 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012320 s, Result = 002b2000, Performance =  10.02 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012415 s, Result = 002d0000, Performance =  10.38 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013267 s, Result = 002ee000, Performance =  10.12 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013078 s, Result = 0030c000, Performance =  10.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.013375 s, Result = 0032a000, Performance =  10.84 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013416 s, Result = 00348000, Performance =  11.20 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.014236 s, Result = 00366000, Performance =  10.94 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.013921 s, Result = 00384000, Performance =  11.57 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.014647 s, Result = 003a2000, Performance =  11.36 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014677 s, Result = 003c0000, Performance =  11.71 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014797 s, Result = 003de000, Performance =  11.97 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.015156 s, Result = 003fc000, Performance =  12.04 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015593 s, Result = 0041a000, Performance =  12.05 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015751 s, Result = 00438000, Performance =  12.27 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.016568 s, Result = 00456000, Performance =  11.99 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016896 s, Result = 00474000, Performance =  12.07 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017511 s, Result = 00492000, Performance =  11.96 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017810 s, Result = 004b0000, Performance =  12.06 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017839 s, Result = 004ce000, Performance =  12.34 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018024 s, Result = 004ec000, Performance =  12.51 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018561 s, Result = 0050a000, Performance =  12.44 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018999 s, Result = 00528000, Performance =  12.43 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.019029 s, Result = 00546000, Performance =  12.70 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019634 s, Result = 00564000, Performance =  12.58 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019830 s, Result = 00582000, Performance =  12.72 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.019864 s, Result = 005a0000, Performance =  12.97 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020658 s, Result = 005be000, Performance =  12.73 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020824 s, Result = 005dc000, Performance =  12.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021481 s, Result = 005fa000, Performance =  12.75 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021678 s, Result = 00618000, Performance =  12.88 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022289 s, Result = 00636000, Performance =  12.77 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022403 s, Result = 00654000, Performance =  12.94 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022463 s, Result = 00672000, Performance =  13.15 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.022230 s, Result = 00690000, Performance =  13.52 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023382 s, Result = 006ae000, Performance =  13.09 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.023442 s, Result = 006cc000, Performance =  13.28 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024278 s, Result = 006ea000, Performance =  13.05 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.025095 s, Result = 00708000, Performance =  12.84 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024759 s, Result = 00726000, Performance =  13.23 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024699 s, Result = 00744000, Performance =  13.48 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.025552 s, Result = 00762000, Performance =  13.24 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025964 s, Result = 00780000, Performance =  13.23 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   113  1660  1472
Test passed: M N K =  1489  1396  1408
Test passed: M N K =  1890  1530  1088
Test passed: M N K =   592   404   448
Test passed: M N K =  1300   808  1856
M N K =  1024  1024   256, Elapsed time =   0.002099 s, Result = 0a0be000, Performance =   2.56 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003063 s, Result = 0a0dc000, Performance =   3.51 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003467 s, Result = 0a0fa000, Performance =   4.65 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004004 s, Result = 0a118000, Performance =   5.36 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004203 s, Result = 0a136000, Performance =   6.39 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004428 s, Result = 0a154000, Performance =   7.27 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004809 s, Result = 0a172000, Performance =   7.82 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005349 s, Result = 0a190000, Performance =   8.03 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005197 s, Result = 0a1ae000, Performance =   9.30 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005652 s, Result = 0a1cc000, Performance =   9.50 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006105 s, Result = 0a1ea000, Performance =   9.67 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006325 s, Result = 0a208000, Performance =  10.19 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006591 s, Result = 0a226000, Performance =  10.59 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006976 s, Result = 0a244000, Performance =  10.77 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007292 s, Result = 0a262000, Performance =  11.04 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008033 s, Result = 0a280000, Performance =  10.69 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008244 s, Result = 0a29e000, Performance =  11.07 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008424 s, Result = 0a2bc000, Performance =  11.47 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009623 s, Result = 0a2da000, Performance =  10.60 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009516 s, Result = 0a2f8000, Performance =  11.28 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009604 s, Result = 0a316000, Performance =  11.74 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009949 s, Result = 0a334000, Performance =  11.87 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010200 s, Result = 0a352000, Performance =  12.11 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010461 s, Result = 0a370000, Performance =  12.32 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.011668 s, Result = 0a38e000, Performance =  11.50 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011445 s, Result = 0a3ac000, Performance =  12.20 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.011669 s, Result = 0a3ca000, Performance =  12.42 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.012062 s, Result = 0a3e8000, Performance =  12.46 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012567 s, Result = 0a406000, Performance =  12.39 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012631 s, Result = 0a424000, Performance =  12.75 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013180 s, Result = 0a442000, Performance =  12.63 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013305 s, Result = 0a460000, Performance =  12.91 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014618 s, Result = 0a47e000, Performance =  12.12 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.015056 s, Result = 0a49c000, Performance =  12.12 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.014686 s, Result = 0a4ba000, Performance =  12.79 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.014838 s, Result = 0a4d8000, Performance =  13.03 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.016595 s, Result = 0a4f6000, Performance =  11.97 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016364 s, Result = 0a514000, Performance =  12.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016905 s, Result = 0a532000, Performance =  12.39 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017112 s, Result = 0a550000, Performance =  12.55 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.016984 s, Result = 0a56e000, Performance =  12.96 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017175 s, Result = 0a58c000, Performance =  13.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018368 s, Result = 0a5aa000, Performance =  12.57 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018570 s, Result = 0a5c8000, Performance =  12.72 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018720 s, Result = 0a5e6000, Performance =  12.91 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.018722 s, Result = 0a604000, Performance =  13.19 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020037 s, Result = 0a622000, Performance =  12.59 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020286 s, Result = 0a640000, Performance =  12.70 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020554 s, Result = 0a65e000, Performance =  12.80 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020117 s, Result = 0a67c000, Performance =  13.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.020741 s, Result = 0a69a000, Performance =  13.20 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021678 s, Result = 0a6b8000, Performance =  12.88 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021549 s, Result = 0a6d6000, Performance =  13.20 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.021994 s, Result = 0a6f4000, Performance =  13.18 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022015 s, Result = 0a712000, Performance =  13.41 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.022185 s, Result = 0a730000, Performance =  13.55 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023170 s, Result = 0a74e000, Performance =  13.21 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.023322 s, Result = 0a76c000, Performance =  13.35 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.023619 s, Result = 0a78a000, Performance =  13.41 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024477 s, Result = 0a7a8000, Performance =  13.16 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024905 s, Result = 0a7c6000, Performance =  13.15 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024759 s, Result = 0a7e4000, Performance =  13.44 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.025581 s, Result = 0a802000, Performance =  13.22 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025815 s, Result = 0a820000, Performance =  13.31 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   140  1212  1984
Test passed: M N K =  2004   182  1408
Test passed: M N K =  1423   130  1344
Test passed: M N K =  1339   582  1088
Test passed: M N K =   958   205   512
M N K =  1024  1024   256, Elapsed time =   0.000270 s, Result = 0001e000, Performance =  19.85 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000669 s, Result = 0003c000, Performance =  16.04 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001208 s, Result = 0005a000, Performance =  13.34 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001571 s, Result = 00078000, Performance =  13.67 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.001955 s, Result = 00096000, Performance =  13.73 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002369 s, Result = 000b4000, Performance =  13.60 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002702 s, Result = 000d2000, Performance =  13.91 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003208 s, Result = 000f0000, Performance =  13.39 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003856 s, Result = 0010e000, Performance =  12.53 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004123 s, Result = 0012c000, Performance =  13.02 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.004531 s, Result = 0014a000, Performance =  13.03 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005216 s, Result = 00168000, Performance =  12.35 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.005473 s, Result = 00186000, Performance =  12.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006359 s, Result = 001a4000, Performance =  11.82 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.006592 s, Result = 001c2000, Performance =  12.22 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.006604 s, Result = 001e0000, Performance =  13.01 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.007524 s, Result = 001fe000, Performance =  12.13 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.007937 s, Result = 0021c000, Performance =  12.18 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008042 s, Result = 0023a000, Performance =  12.68 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.008842 s, Result = 00258000, Performance =  12.14 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009300 s, Result = 00276000, Performance =  12.12 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009402 s, Result = 00294000, Performance =  12.56 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.009806 s, Result = 002b2000, Performance =  12.59 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010563 s, Result = 002d0000, Performance =  12.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010347 s, Result = 002ee000, Performance =  12.97 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011728 s, Result = 0030c000, Performance =  11.90 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.011863 s, Result = 0032a000, Performance =  12.22 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011877 s, Result = 00348000, Performance =  12.66 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012463 s, Result = 00366000, Performance =  12.49 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012909 s, Result = 00384000, Performance =  12.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013315 s, Result = 003a2000, Performance =  12.50 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013819 s, Result = 003c0000, Performance =  12.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.013869 s, Result = 003de000, Performance =  12.77 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.013646 s, Result = 003fc000, Performance =  13.38 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015100 s, Result = 0041a000, Performance =  12.44 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015123 s, Result = 00438000, Performance =  12.78 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015759 s, Result = 00456000, Performance =  12.60 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016044 s, Result = 00474000, Performance =  12.72 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016910 s, Result = 00492000, Performance =  12.38 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.016678 s, Result = 004b0000, Performance =  12.88 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017253 s, Result = 004ce000, Performance =  12.76 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018275 s, Result = 004ec000, Performance =  12.34 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018861 s, Result = 0050a000, Performance =  12.24 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018746 s, Result = 00528000, Performance =  12.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018885 s, Result = 00546000, Performance =  12.79 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019414 s, Result = 00564000, Performance =  12.72 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.018885 s, Result = 00582000, Performance =  13.36 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020578 s, Result = 005a0000, Performance =  12.52 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020702 s, Result = 005be000, Performance =  12.71 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020409 s, Result = 005dc000, Performance =  13.15 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021277 s, Result = 005fa000, Performance =  12.87 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.022133 s, Result = 00618000, Performance =  12.61 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022459 s, Result = 00636000, Performance =  12.67 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022338 s, Result = 00654000, Performance =  12.98 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.023077 s, Result = 00672000, Performance =  12.80 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.023361 s, Result = 00690000, Performance =  12.87 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.024416 s, Result = 006ae000, Performance =  12.53 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024304 s, Result = 006cc000, Performance =  12.81 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.025413 s, Result = 006ea000, Performance =  12.46 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024751 s, Result = 00708000, Performance =  13.01 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025552 s, Result = 00726000, Performance =  12.82 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.025527 s, Result = 00744000, Performance =  13.04 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026103 s, Result = 00762000, Performance =  12.96 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.026912 s, Result = 00780000, Performance =  12.77 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1777   368  1408
Test passed: M N K =   398    20   320
Test passed: M N K =   368  1717   384
Test passed: M N K =  1221   934   384
Test passed: M N K =  1288  1308   576
M N K =  1024  1024   256, Elapsed time =   0.003748 s, Result = 5902e000, Performance =   1.43 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004680 s, Result = 3104c000, Performance =   2.29 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005138 s, Result = 0906a000, Performance =   3.13 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005537 s, Result = e1088000, Performance =   3.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006008 s, Result = b90a6000, Performance =   4.47 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006959 s, Result = 910c4000, Performance =   4.63 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007062 s, Result = 690e2000, Performance =   5.32 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008006 s, Result = 41100000, Performance =   5.36 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008114 s, Result = 1911e000, Performance =   5.95 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008646 s, Result = f113c000, Performance =   6.21 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009194 s, Result = c915a000, Performance =   6.42 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010451 s, Result = a1178000, Performance =   6.16 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010415 s, Result = 79196000, Performance =   6.70 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010642 s, Result = 511b4000, Performance =   7.06 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010721 s, Result = 291d2000, Performance =   7.51 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011468 s, Result = 011f0000, Performance =   7.49 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010955 s, Result = d920e000, Performance =   8.33 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011442 s, Result = b122c000, Performance =   8.45 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014526 s, Result = 8924a000, Performance =   7.02 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013368 s, Result = 61268000, Performance =   8.03 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014453 s, Result = 39286000, Performance =   7.80 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014843 s, Result = 112a4000, Performance =   7.96 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014978 s, Result = e92c2000, Performance =   8.24 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015100 s, Result = c12e0000, Performance =   8.53 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016595 s, Result = 992fe000, Performance =   8.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016041 s, Result = 7131c000, Performance =   8.70 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016186 s, Result = 4933a000, Performance =   8.96 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.016541 s, Result = 21358000, Performance =   9.09 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.016760 s, Result = f9376000, Performance =   9.29 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018259 s, Result = d1394000, Performance =   8.82 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.018448 s, Result = a93b2000, Performance =   9.02 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019201 s, Result = 813d0000, Performance =   8.95 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019670 s, Result = 593ee000, Performance =   9.01 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019378 s, Result = 3140c000, Performance =   9.42 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.020464 s, Result = 0942a000, Performance =   9.18 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.019907 s, Result = e1448000, Performance =   9.71 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.021363 s, Result = b9466000, Performance =   9.30 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020626 s, Result = 91484000, Performance =   9.89 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.022446 s, Result = 694a2000, Performance =   9.33 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.022661 s, Result = 414c0000, Performance =   9.48 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.022701 s, Result = 194de000, Performance =   9.70 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.022174 s, Result = f14fc000, Performance =  10.17 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.024330 s, Result = c951a000, Performance =   9.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.023826 s, Result = a1538000, Performance =   9.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.024251 s, Result = 79556000, Performance =   9.96 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.024252 s, Result = 51574000, Performance =  10.18 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026363 s, Result = 29592000, Performance =   9.57 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.026855 s, Result = 015b0000, Performance =   9.60 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.026464 s, Result = d95ce000, Performance =   9.94 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.026735 s, Result = b15ec000, Performance =  10.04 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.028053 s, Result = 8960a000, Performance =   9.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.028373 s, Result = 61628000, Performance =   9.84 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.028416 s, Result = 39646000, Performance =  10.01 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.028523 s, Result = 11664000, Performance =  10.16 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.029533 s, Result = e9682000, Performance =  10.00 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029849 s, Result = c16a0000, Performance =  10.07 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.029633 s, Result = 996be000, Performance =  10.33 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030527 s, Result = 716dc000, Performance =  10.20 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.031522 s, Result = 496fa000, Performance =  10.05 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.031822 s, Result = 21718000, Performance =  10.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031219 s, Result = f9736000, Performance =  10.49 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.032640 s, Result = d1754000, Performance =  10.20 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.032775 s, Result = a9772000, Performance =  10.32 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.034187 s, Result = 81790000, Performance =  10.05 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   449   977  1344
Test passed: M N K =    47  1657   448
Test passed: M N K =  2019  1685    64
Test passed: M N K =  1758  1682  1792
Test passed: M N K =  1775   170    64
M N K =  1024  1024   256, Elapsed time =   0.002372 s, Result = 0001e000, Performance =   2.26 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003843 s, Result = 0003c000, Performance =   2.79 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004389 s, Result = 0005a000, Performance =   3.67 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005109 s, Result = 00078000, Performance =   4.20 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005285 s, Result = 00096000, Performance =   5.08 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005797 s, Result = 000b4000, Performance =   5.56 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006758 s, Result = 000d2000, Performance =   5.56 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007488 s, Result = 000f0000, Performance =   5.74 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007580 s, Result = 0010e000, Performance =   6.37 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008090 s, Result = 0012c000, Performance =   6.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008445 s, Result = 0014a000, Performance =   6.99 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009028 s, Result = 00168000, Performance =   7.14 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009009 s, Result = 00186000, Performance =   7.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009603 s, Result = 001a4000, Performance =   7.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009680 s, Result = 001c2000, Performance =   8.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010638 s, Result = 001e0000, Performance =   8.07 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010500 s, Result = 001fe000, Performance =   8.69 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011180 s, Result = 0021c000, Performance =   8.64 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011432 s, Result = 0023a000, Performance =   8.92 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011807 s, Result = 00258000, Performance =   9.09 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012311 s, Result = 00276000, Performance =   9.16 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.012671 s, Result = 00294000, Performance =   9.32 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.013046 s, Result = 002b2000, Performance =   9.46 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013935 s, Result = 002d0000, Performance =   9.25 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013989 s, Result = 002ee000, Performance =   9.59 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.014437 s, Result = 0030c000, Performance =   9.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014849 s, Result = 0032a000, Performance =   9.76 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.015293 s, Result = 00348000, Performance =   9.83 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015500 s, Result = 00366000, Performance =  10.04 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.016130 s, Result = 00384000, Performance =   9.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.016455 s, Result = 003a2000, Performance =  10.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.017600 s, Result = 003c0000, Performance =   9.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.017533 s, Result = 003de000, Performance =  10.10 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.017700 s, Result = 003fc000, Performance =  10.31 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.018302 s, Result = 0041a000, Performance =  10.27 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018724 s, Result = 00438000, Performance =  10.32 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.018726 s, Result = 00456000, Performance =  10.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.019224 s, Result = 00474000, Performance =  10.61 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019865 s, Result = 00492000, Performance =  10.54 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.020748 s, Result = 004b0000, Performance =  10.35 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.020483 s, Result = 004ce000, Performance =  10.75 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.021098 s, Result = 004ec000, Performance =  10.69 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.021403 s, Result = 0050a000, Performance =  10.79 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.021970 s, Result = 00528000, Performance =  10.75 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.026344 s, Result = 00546000, Performance =   9.17 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025127 s, Result = 00564000, Performance =   9.83 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026057 s, Result = 00582000, Performance =   9.68 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.025888 s, Result = 005a0000, Performance =   9.95 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.026386 s, Result = 005be000, Performance =   9.97 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.026069 s, Result = 005dc000, Performance =  10.30 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026840 s, Result = 005fa000, Performance =  10.20 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.026784 s, Result = 00618000, Performance =  10.42 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.027817 s, Result = 00636000, Performance =  10.23 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.027821 s, Result = 00654000, Performance =  10.42 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.028870 s, Result = 00672000, Performance =  10.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.028517 s, Result = 00690000, Performance =  10.54 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.029062 s, Result = 006ae000, Performance =  10.53 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.029304 s, Result = 006cc000, Performance =  10.63 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.030072 s, Result = 006ea000, Performance =  10.53 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.030365 s, Result = 00708000, Performance =  10.61 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031010 s, Result = 00726000, Performance =  10.56 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.030942 s, Result = 00744000, Performance =  10.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.032159 s, Result = 00762000, Performance =  10.52 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.032634 s, Result = 00780000, Performance =  10.53 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   619   698  1024
Test passed: M N K =  1339  1936   960
Test passed: M N K =  1077   567   640
Test passed: M N K =  1004   903  1088
Test passed: M N K =   671   235   960
M N K =  1024  1024   256, Elapsed time =   0.002124 s, Result = 0a0be000, Performance =   2.53 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003279 s, Result = 0a0dc000, Performance =   3.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003902 s, Result = 0a0fa000, Performance =   4.13 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004223 s, Result = 0a118000, Performance =   5.09 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004541 s, Result = 0a136000, Performance =   5.91 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004871 s, Result = 0a154000, Performance =   6.61 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005170 s, Result = 0a172000, Performance =   7.27 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005993 s, Result = 0a190000, Performance =   7.17 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006252 s, Result = 0a1ae000, Performance =   7.73 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006749 s, Result = 0a1cc000, Performance =   7.95 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007144 s, Result = 0a1ea000, Performance =   8.27 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007670 s, Result = 0a208000, Performance =   8.40 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007967 s, Result = 0a226000, Performance =   8.76 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008213 s, Result = 0a244000, Performance =   9.15 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008644 s, Result = 0a262000, Performance =   9.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009472 s, Result = 0a280000, Performance =   9.07 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009541 s, Result = 0a29e000, Performance =   9.57 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009993 s, Result = 0a2bc000, Performance =   9.67 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010350 s, Result = 0a2da000, Performance =   9.86 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010751 s, Result = 0a2f8000, Performance =   9.99 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011023 s, Result = 0a316000, Performance =  10.23 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011726 s, Result = 0a334000, Performance =  10.07 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012257 s, Result = 0a352000, Performance =  10.07 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013435 s, Result = 0a370000, Performance =   9.59 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.012950 s, Result = 0a38e000, Performance =  10.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013265 s, Result = 0a3ac000, Performance =  10.52 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014066 s, Result = 0a3ca000, Performance =  10.31 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.015471 s, Result = 0a3e8000, Performance =   9.72 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.014833 s, Result = 0a406000, Performance =  10.50 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014955 s, Result = 0a424000, Performance =  10.77 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015950 s, Result = 0a442000, Performance =  10.43 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016651 s, Result = 0a460000, Performance =  10.32 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019682 s, Result = 0a47e000, Performance =   9.00 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.018413 s, Result = 0a49c000, Performance =   9.91 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.019283 s, Result = 0a4ba000, Performance =   9.74 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018769 s, Result = 0a4d8000, Performance =  10.30 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.020965 s, Result = 0a4f6000, Performance =   9.47 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020575 s, Result = 0a514000, Performance =   9.92 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019983 s, Result = 0a532000, Performance =  10.48 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021191 s, Result = 0a550000, Performance =  10.13 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.021950 s, Result = 0a56e000, Performance =  10.03 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.022233 s, Result = 0a58c000, Performance =  10.14 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.022602 s, Result = 0a5aa000, Performance =  10.21 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.023056 s, Result = 0a5c8000, Performance =  10.25 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.023977 s, Result = 0a5e6000, Performance =  10.08 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.024124 s, Result = 0a604000, Performance =  10.24 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.024101 s, Result = 0a622000, Performance =  10.47 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.024893 s, Result = 0a640000, Performance =  10.35 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.024666 s, Result = 0a65e000, Performance =  10.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.026124 s, Result = 0a67c000, Performance =  10.28 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026611 s, Result = 0a69a000, Performance =  10.29 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.025763 s, Result = 0a6b8000, Performance =  10.84 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.026640 s, Result = 0a6d6000, Performance =  10.68 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.028361 s, Result = 0a6f4000, Performance =  10.22 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.028539 s, Result = 0a712000, Performance =  10.35 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.028191 s, Result = 0a730000, Performance =  10.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.028956 s, Result = 0a74e000, Performance =  10.57 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030078 s, Result = 0a76c000, Performance =  10.35 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.030296 s, Result = 0a78a000, Performance =  10.46 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.029686 s, Result = 0a7a8000, Performance =  10.85 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.030931 s, Result = 0a7c6000, Performance =  10.59 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.031097 s, Result = 0a7e4000, Performance =  10.70 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.031701 s, Result = 0a802000, Performance =  10.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.032192 s, Result = 0a820000, Performance =  10.67 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   300  1058   576
Test passed: M N K =  1251  1482   896
Test passed: M N K =   875  1589  1984
Test passed: M N K =   527   890  1152
Test passed: M N K =  1917  1476   512
M N K =  1024  1024   256, Elapsed time =   0.000276 s, Result = 0001e000, Performance =  19.46 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000753 s, Result = 0003c000, Performance =  14.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001284 s, Result = 0005a000, Performance =  12.54 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001679 s, Result = 00078000, Performance =  12.79 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002059 s, Result = 00096000, Performance =  13.04 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002519 s, Result = 000b4000, Performance =  12.79 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002873 s, Result = 000d2000, Performance =  13.08 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003718 s, Result = 000f0000, Performance =  11.55 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003883 s, Result = 0010e000, Performance =  12.44 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004759 s, Result = 0012c000, Performance =  11.28 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.004677 s, Result = 0014a000, Performance =  12.63 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005682 s, Result = 00168000, Performance =  11.34 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.005951 s, Result = 00186000, Performance =  11.73 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006563 s, Result = 001a4000, Performance =  11.45 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.006432 s, Result = 001c2000, Performance =  12.52 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007551 s, Result = 001e0000, Performance =  11.38 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.006977 s, Result = 001fe000, Performance =  13.08 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.007524 s, Result = 0021c000, Performance =  12.84 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.007654 s, Result = 0023a000, Performance =  13.33 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.007970 s, Result = 00258000, Performance =  13.47 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.008354 s, Result = 00276000, Performance =  13.50 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.008975 s, Result = 00294000, Performance =  13.16 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.009631 s, Result = 002b2000, Performance =  12.82 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010765 s, Result = 002d0000, Performance =  11.97 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.009883 s, Result = 002ee000, Performance =  13.58 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.010342 s, Result = 0030c000, Performance =  13.50 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.010765 s, Result = 0032a000, Performance =  13.47 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011656 s, Result = 00348000, Performance =  12.90 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.011500 s, Result = 00366000, Performance =  13.54 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012175 s, Result = 00384000, Performance =  13.23 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012692 s, Result = 003a2000, Performance =  13.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014983 s, Result = 003c0000, Performance =  11.47 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.013007 s, Result = 003de000, Performance =  13.62 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.013720 s, Result = 003fc000, Performance =  13.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.013644 s, Result = 0041a000, Performance =  13.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015001 s, Result = 00438000, Performance =  12.88 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015650 s, Result = 00456000, Performance =  12.69 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.015931 s, Result = 00474000, Performance =  12.81 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016125 s, Result = 00492000, Performance =  12.99 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.018042 s, Result = 004b0000, Performance =  11.90 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017486 s, Result = 004ce000, Performance =  12.59 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018348 s, Result = 004ec000, Performance =  12.29 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.017954 s, Result = 0050a000, Performance =  12.86 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018789 s, Result = 00528000, Performance =  12.57 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.019053 s, Result = 00546000, Performance =  12.68 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019492 s, Result = 00564000, Performance =  12.67 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019318 s, Result = 00582000, Performance =  13.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.022798 s, Result = 005a0000, Performance =  11.30 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020078 s, Result = 005be000, Performance =  13.10 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.021203 s, Result = 005dc000, Performance =  12.66 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.020871 s, Result = 005fa000, Performance =  13.12 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021445 s, Result = 00618000, Performance =  13.02 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021416 s, Result = 00636000, Performance =  13.29 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022798 s, Result = 00654000, Performance =  12.72 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022824 s, Result = 00672000, Performance =  12.94 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.024698 s, Result = 00690000, Performance =  12.17 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023413 s, Result = 006ae000, Performance =  13.07 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024691 s, Result = 006cc000, Performance =  12.61 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024689 s, Result = 006ea000, Performance =  12.83 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024584 s, Result = 00708000, Performance =  13.10 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025377 s, Result = 00726000, Performance =  12.91 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.025831 s, Result = 00744000, Performance =  12.89 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026270 s, Result = 00762000, Performance =  12.88 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.030360 s, Result = 00780000, Performance =  11.32 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   201  1637  1728
Test passed: M N K =   100   918  2048
Test passed: M N K =   832  1084   768
Test passed: M N K =  1566   236  1984
Test passed: M N K =  1865   245  1664
M N K =  1024  1024   256, Elapsed time =   0.003724 s, Result = 5902e000, Performance =   1.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004287 s, Result = 3104c000, Performance =   2.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005390 s, Result = 0906a000, Performance =   2.99 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005658 s, Result = e1088000, Performance =   3.80 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006104 s, Result = b90a6000, Performance =   4.40 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006591 s, Result = 910c4000, Performance =   4.89 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007138 s, Result = 690e2000, Performance =   5.27 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007946 s, Result = 41100000, Performance =   5.41 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009173 s, Result = 1911e000, Performance =   5.27 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009582 s, Result = f113c000, Performance =   5.60 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010183 s, Result = c915a000, Performance =   5.80 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010837 s, Result = a1178000, Performance =   5.94 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011761 s, Result = 79196000, Performance =   5.93 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011802 s, Result = 511b4000, Performance =   6.37 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012461 s, Result = 291d2000, Performance =   6.46 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012989 s, Result = 011f0000, Performance =   6.61 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013404 s, Result = d920e000, Performance =   6.81 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014234 s, Result = b122c000, Performance =   6.79 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014615 s, Result = 8924a000, Performance =   6.98 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014942 s, Result = 61268000, Performance =   7.19 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015483 s, Result = 39286000, Performance =   7.28 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016335 s, Result = 112a4000, Performance =   7.23 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017014 s, Result = e92c2000, Performance =   7.26 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016829 s, Result = c12e0000, Performance =   7.66 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017344 s, Result = 992fe000, Performance =   7.74 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018035 s, Result = 7131c000, Performance =   7.74 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019178 s, Result = 4933a000, Performance =   7.56 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018784 s, Result = 21358000, Performance =   8.00 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019687 s, Result = f9376000, Performance =   7.91 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020299 s, Result = d1394000, Performance =   7.93 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021512 s, Result = a93b2000, Performance =   7.74 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021053 s, Result = 813d0000, Performance =   8.16 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021928 s, Result = 593ee000, Performance =   8.08 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022189 s, Result = 3140c000, Performance =   8.23 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023580 s, Result = 0942a000, Performance =   7.97 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023651 s, Result = e1448000, Performance =   8.17 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023639 s, Result = b9466000, Performance =   8.40 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024733 s, Result = 91484000, Performance =   8.25 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025529 s, Result = 694a2000, Performance =   8.20 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025613 s, Result = 414c0000, Performance =   8.38 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026003 s, Result = 194de000, Performance =   8.47 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026476 s, Result = f14fc000, Performance =   8.52 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027187 s, Result = c951a000, Performance =   8.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028123 s, Result = a1538000, Performance =   8.40 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028433 s, Result = 79556000, Performance =   8.50 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.028877 s, Result = 51574000, Performance =   8.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029713 s, Result = 29592000, Performance =   8.49 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030054 s, Result = 015b0000, Performance =   8.57 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030541 s, Result = d95ce000, Performance =   8.61 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031220 s, Result = b15ec000, Performance =   8.60 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031173 s, Result = 8960a000, Performance =   8.78 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032424 s, Result = 61628000, Performance =   8.61 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.032612 s, Result = 39646000, Performance =   8.73 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.032553 s, Result = 11664000, Performance =   8.91 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033829 s, Result = e9682000, Performance =   8.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034437 s, Result = c16a0000, Performance =   8.73 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034829 s, Result = 996be000, Performance =   8.79 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.035790 s, Result = 716dc000, Performance =   8.70 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036870 s, Result = 496fa000, Performance =   8.59 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036873 s, Result = 21718000, Performance =   8.74 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.037480 s, Result = f9736000, Performance =   8.74 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.037345 s, Result = d1754000, Performance =   8.91 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.038842 s, Result = a9772000, Performance =   8.71 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038368 s, Result = 81790000, Performance =   8.96 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1022   969    64
Test passed: M N K =  1787  2032  1472
Test passed: M N K =  1440  2010  1792
Test passed: M N K =  1009   678  1984
Test passed: M N K =  1963   254   512
M N K =  1024  1024   256, Elapsed time =   0.002373 s, Result = 0001e000, Performance =   2.26 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003684 s, Result = 0003c000, Performance =   2.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004200 s, Result = 0005a000, Performance =   3.84 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004661 s, Result = 00078000, Performance =   4.61 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006134 s, Result = 00096000, Performance =   4.38 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006972 s, Result = 000b4000, Performance =   4.62 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006788 s, Result = 000d2000, Performance =   5.54 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006879 s, Result = 000f0000, Performance =   6.24 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007292 s, Result = 0010e000, Performance =   6.63 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008231 s, Result = 0012c000, Performance =   6.52 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009482 s, Result = 0014a000, Performance =   6.23 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009789 s, Result = 00168000, Performance =   6.58 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010065 s, Result = 00186000, Performance =   6.93 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010583 s, Result = 001a4000, Performance =   7.10 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011193 s, Result = 001c2000, Performance =   7.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011567 s, Result = 001e0000, Performance =   7.43 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011908 s, Result = 001fe000, Performance =   7.66 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012483 s, Result = 0021c000, Performance =   7.74 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013340 s, Result = 0023a000, Performance =   7.65 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014240 s, Result = 00258000, Performance =   7.54 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014278 s, Result = 00276000, Performance =   7.90 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014801 s, Result = 00294000, Performance =   7.98 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015015 s, Result = 002b2000, Performance =   8.22 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015651 s, Result = 002d0000, Performance =   8.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015605 s, Result = 002ee000, Performance =   8.60 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016517 s, Result = 0030c000, Performance =   8.45 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017415 s, Result = 0032a000, Performance =   8.32 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017905 s, Result = 00348000, Performance =   8.40 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019154 s, Result = 00366000, Performance =   8.13 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019022 s, Result = 00384000, Performance =   8.47 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019242 s, Result = 003a2000, Performance =   8.65 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019848 s, Result = 003c0000, Performance =   8.66 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021003 s, Result = 003de000, Performance =   8.44 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021312 s, Result = 003fc000, Performance =   8.56 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022115 s, Result = 0041a000, Performance =   8.50 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022320 s, Result = 00438000, Performance =   8.66 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022635 s, Result = 00456000, Performance =   8.78 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024006 s, Result = 00474000, Performance =   8.50 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024063 s, Result = 00492000, Performance =   8.70 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.024339 s, Result = 004b0000, Performance =   8.82 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025371 s, Result = 004ce000, Performance =   8.68 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.025868 s, Result = 004ec000, Performance =   8.72 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.026310 s, Result = 0050a000, Performance =   8.77 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.026359 s, Result = 00528000, Performance =   8.96 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027432 s, Result = 00546000, Performance =   8.81 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.027959 s, Result = 00564000, Performance =   8.83 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.028325 s, Result = 00582000, Performance =   8.91 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.027907 s, Result = 005a0000, Performance =   9.23 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030085 s, Result = 005be000, Performance =   8.74 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.030229 s, Result = 005dc000, Performance =   8.88 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031307 s, Result = 005fa000, Performance =   8.75 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030949 s, Result = 00618000, Performance =   9.02 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.032130 s, Result = 00636000, Performance =   8.86 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031918 s, Result = 00654000, Performance =   9.08 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033807 s, Result = 00672000, Performance =   8.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.032563 s, Result = 00690000, Performance =   9.23 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.032618 s, Result = 006ae000, Performance =   9.38 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.034062 s, Result = 006cc000, Performance =   9.14 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.035549 s, Result = 006ea000, Performance =   8.91 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.034782 s, Result = 00708000, Performance =   9.26 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.035804 s, Result = 00726000, Performance =   9.15 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036264 s, Result = 00744000, Performance =   9.18 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.035999 s, Result = 00762000, Performance =   9.40 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.035867 s, Result = 00780000, Performance =   9.58 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   688   841   192
Test passed: M N K =   609  1293  1536
Test passed: M N K =  1823  1174  1408
Test passed: M N K =  1629  1228  1536
Test passed: M N K =   635   927   384
M N K =  1024  1024   256, Elapsed time =   0.002116 s, Result = 0a0be000, Performance =   2.54 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003288 s, Result = 0a0dc000, Performance =   3.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003773 s, Result = 0a0fa000, Performance =   4.27 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004172 s, Result = 0a118000, Performance =   5.15 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004620 s, Result = 0a136000, Performance =   5.81 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005064 s, Result = 0a154000, Performance =   6.36 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005374 s, Result = 0a172000, Performance =   6.99 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005816 s, Result = 0a190000, Performance =   7.38 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006214 s, Result = 0a1ae000, Performance =   7.78 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007036 s, Result = 0a1cc000, Performance =   7.63 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007555 s, Result = 0a1ea000, Performance =   7.82 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007957 s, Result = 0a208000, Performance =   8.10 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008542 s, Result = 0a226000, Performance =   8.17 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009146 s, Result = 0a244000, Performance =   8.22 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009686 s, Result = 0a262000, Performance =   8.31 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010200 s, Result = 0a280000, Performance =   8.42 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010636 s, Result = 0a29e000, Performance =   8.58 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011223 s, Result = 0a2bc000, Performance =   8.61 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012346 s, Result = 0a2da000, Performance =   8.26 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012714 s, Result = 0a2f8000, Performance =   8.45 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012586 s, Result = 0a316000, Performance =   8.96 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013675 s, Result = 0a334000, Performance =   8.64 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014529 s, Result = 0a352000, Performance =   8.50 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.014746 s, Result = 0a370000, Performance =   8.74 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014699 s, Result = 0a38e000, Performance =   9.13 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016623 s, Result = 0a3ac000, Performance =   8.40 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016411 s, Result = 0a3ca000, Performance =   8.83 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.016471 s, Result = 0a3e8000, Performance =   9.13 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.016690 s, Result = 0a406000, Performance =   9.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.017407 s, Result = 0a424000, Performance =   9.25 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019132 s, Result = 0a442000, Performance =   8.70 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.018961 s, Result = 0a460000, Performance =   9.06 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020139 s, Result = 0a47e000, Performance =   8.80 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019778 s, Result = 0a49c000, Performance =   9.23 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.020915 s, Result = 0a4ba000, Performance =   8.98 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021582 s, Result = 0a4d8000, Performance =   8.96 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022053 s, Result = 0a4f6000, Performance =   9.01 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022072 s, Result = 0a514000, Performance =   9.24 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.023315 s, Result = 0a532000, Performance =   8.98 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.023909 s, Result = 0a550000, Performance =   8.98 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.024104 s, Result = 0a56e000, Performance =   9.13 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023904 s, Result = 0a58c000, Performance =   9.43 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.024771 s, Result = 0a5aa000, Performance =   9.32 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.026023 s, Result = 0a5c8000, Performance =   9.08 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.025551 s, Result = 0a5e6000, Performance =   9.46 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025792 s, Result = 0a604000, Performance =   9.57 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026889 s, Result = 0a622000, Performance =   9.38 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.027318 s, Result = 0a640000, Performance =   9.43 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.028479 s, Result = 0a65e000, Performance =   9.24 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.028735 s, Result = 0a67c000, Performance =   9.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.029390 s, Result = 0a69a000, Performance =   9.32 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030231 s, Result = 0a6b8000, Performance =   9.23 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.031281 s, Result = 0a6d6000, Performance =   9.10 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031690 s, Result = 0a6f4000, Performance =   9.15 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.031930 s, Result = 0a712000, Performance =   9.25 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.030198 s, Result = 0a730000, Performance =   9.96 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.033046 s, Result = 0a74e000, Performance =   9.26 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.031636 s, Result = 0a76c000, Performance =   9.84 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.033819 s, Result = 0a78a000, Performance =   9.37 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.032976 s, Result = 0a7a8000, Performance =   9.77 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.035971 s, Result = 0a7c6000, Performance =   9.10 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.035881 s, Result = 0a7e4000, Performance =   9.28 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.036196 s, Result = 0a802000, Performance =   9.34 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.035715 s, Result = 0a820000, Performance =   9.62 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   210   221   832
Test passed: M N K =   141  1838  1792
Test passed: M N K =    24  1707   576
Test passed: M N K =   566   215   384
Test passed: M N K =   795   743  1280
M N K =  1024  1024   256, Elapsed time =   0.000297 s, Result = 0001e000, Performance =  18.09 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000833 s, Result = 0003c000, Performance =  12.88 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001263 s, Result = 0005a000, Performance =  12.75 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001628 s, Result = 00078000, Performance =  13.19 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002073 s, Result = 00096000, Performance =  12.95 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002483 s, Result = 000b4000, Performance =  12.98 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002949 s, Result = 000d2000, Performance =  12.74 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003284 s, Result = 000f0000, Performance =  13.08 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004087 s, Result = 0010e000, Performance =  11.82 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004898 s, Result = 0012c000, Performance =  10.96 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005579 s, Result = 0014a000, Performance =  10.59 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006165 s, Result = 00168000, Performance =  10.45 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006446 s, Result = 00186000, Performance =  10.83 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006959 s, Result = 001a4000, Performance =  10.80 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007653 s, Result = 001c2000, Performance =  10.52 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008100 s, Result = 001e0000, Performance =  10.60 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008785 s, Result = 001fe000, Performance =  10.39 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009346 s, Result = 0021c000, Performance =  10.34 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010128 s, Result = 0023a000, Performance =  10.07 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010401 s, Result = 00258000, Performance =  10.32 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.010931 s, Result = 00276000, Performance =  10.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011501 s, Result = 00294000, Performance =  10.27 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012520 s, Result = 002b2000, Performance =   9.86 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012465 s, Result = 002d0000, Performance =  10.34 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013178 s, Result = 002ee000, Performance =  10.18 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013719 s, Result = 0030c000, Performance =  10.17 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014745 s, Result = 0032a000, Performance =   9.83 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014850 s, Result = 00348000, Performance =  10.12 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.014961 s, Result = 00366000, Performance =  10.41 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015722 s, Result = 00384000, Performance =  10.24 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015907 s, Result = 003a2000, Performance =  10.46 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016842 s, Result = 003c0000, Performance =  10.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015604 s, Result = 003de000, Performance =  11.35 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016794 s, Result = 003fc000, Performance =  10.87 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.018246 s, Result = 0041a000, Performance =  10.30 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.019051 s, Result = 00438000, Performance =  10.15 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.017499 s, Result = 00456000, Performance =  11.35 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.019118 s, Result = 00474000, Performance =  10.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019921 s, Result = 00492000, Performance =  10.51 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.019909 s, Result = 004b0000, Performance =  10.79 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.020976 s, Result = 004ce000, Performance =  10.49 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.021948 s, Result = 004ec000, Performance =  10.27 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.022872 s, Result = 0050a000, Performance =  10.09 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.023119 s, Result = 00528000, Performance =  10.22 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.023220 s, Result = 00546000, Performance =  10.40 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.022816 s, Result = 00564000, Performance =  10.82 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.023102 s, Result = 00582000, Performance =  10.92 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.023121 s, Result = 005a0000, Performance =  11.15 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.025767 s, Result = 005be000, Performance =  10.21 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.025887 s, Result = 005dc000, Performance =  10.37 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026456 s, Result = 005fa000, Performance =  10.35 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.026721 s, Result = 00618000, Performance =  10.45 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.026706 s, Result = 00636000, Performance =  10.65 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.027980 s, Result = 00654000, Performance =  10.36 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.029425 s, Result = 00672000, Performance =  10.03 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.028925 s, Result = 00690000, Performance =  10.39 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.030324 s, Result = 006ae000, Performance =  10.09 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030162 s, Result = 006cc000, Performance =  10.32 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.031177 s, Result = 006ea000, Performance =  10.16 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.030878 s, Result = 00708000, Performance =  10.43 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031446 s, Result = 00726000, Performance =  10.41 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.032610 s, Result = 00744000, Performance =  10.21 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.033100 s, Result = 00762000, Performance =  10.22 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.033119 s, Result = 00780000, Performance =  10.37 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1565    10   960
Test passed: M N K =  1417   684   256
Test passed: M N K =  1154    33   832
Test passed: M N K =  1193   633  1728
Test passed: M N K =  1603    15   384
M N K =  1024  1024   256, Elapsed time =   0.006265 s, Result = f5042000, Performance =   0.86 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006836 s, Result = a9074000, Performance =   1.57 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007280 s, Result = 5d0a6000, Performance =   2.21 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007996 s, Result = 110d8000, Performance =   2.69 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008895 s, Result = c510a000, Performance =   3.02 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009408 s, Result = 7913c000, Performance =   3.42 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009723 s, Result = 2d16e000, Performance =   3.86 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010908 s, Result = e11a0000, Performance =   3.94 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011478 s, Result = 951d2000, Performance =   4.21 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011813 s, Result = 49204000, Performance =   4.54 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012943 s, Result = fd236000, Performance =   4.56 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013227 s, Result = b1268000, Performance =   4.87 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013880 s, Result = 6529a000, Performance =   5.03 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014238 s, Result = 192cc000, Performance =   5.28 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014646 s, Result = cd2fe000, Performance =   5.50 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015248 s, Result = 81330000, Performance =   5.63 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015686 s, Result = 35362000, Performance =   5.82 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016293 s, Result = e9394000, Performance =   5.93 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016960 s, Result = 9d3c6000, Performance =   6.01 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017595 s, Result = 513f8000, Performance =   6.10 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018094 s, Result = 0542a000, Performance =   6.23 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018677 s, Result = b945c000, Performance =   6.32 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019397 s, Result = 6d48e000, Performance =   6.37 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020740 s, Result = 214c0000, Performance =   6.21 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020486 s, Result = d54f2000, Performance =   6.55 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020945 s, Result = 89524000, Performance =   6.66 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021361 s, Result = 3d556000, Performance =   6.79 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022133 s, Result = f1588000, Performance =   6.79 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022849 s, Result = a55ba000, Performance =   6.81 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023221 s, Result = 595ec000, Performance =   6.94 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024168 s, Result = 0d61e000, Performance =   6.89 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024078 s, Result = c1650000, Performance =   7.14 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024699 s, Result = 75682000, Performance =   7.17 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025394 s, Result = 296b4000, Performance =   7.19 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026082 s, Result = dd6e6000, Performance =   7.20 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026460 s, Result = 91718000, Performance =   7.30 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.027145 s, Result = 4574a000, Performance =   7.32 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027508 s, Result = f977c000, Performance =   7.42 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028570 s, Result = ad7ae000, Performance =   7.33 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029422 s, Result = 617e0000, Performance =   7.30 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029494 s, Result = 15812000, Performance =   7.46 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029976 s, Result = c9844000, Performance =   7.52 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030828 s, Result = 7d876000, Performance =   7.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031353 s, Result = 318a8000, Performance =   7.53 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031976 s, Result = e58da000, Performance =   7.56 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032149 s, Result = 9990c000, Performance =   7.68 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.032952 s, Result = 4d93e000, Performance =   7.66 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.033408 s, Result = 01970000, Performance =   7.71 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.033899 s, Result = b59a2000, Performance =   7.76 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.034730 s, Result = 699d4000, Performance =   7.73 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.035344 s, Result = 1da06000, Performance =   7.75 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037280 s, Result = d1a38000, Performance =   7.49 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.036552 s, Result = 85a6a000, Performance =   7.78 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.037362 s, Result = 39a9c000, Performance =   7.76 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.037878 s, Result = edace000, Performance =   7.80 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.038558 s, Result = a1b00000, Performance =   7.80 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.038496 s, Result = 55b32000, Performance =   7.95 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.039395 s, Result = 09b64000, Performance =   7.90 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.040139 s, Result = bdb96000, Performance =   7.89 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.040600 s, Result = 71bc8000, Performance =   7.93 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.041114 s, Result = 25bfa000, Performance =   7.97 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.041833 s, Result = d9c2c000, Performance =   7.96 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.042179 s, Result = 8dc5e000, Performance =   8.02 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.042503 s, Result = 41c90000, Performance =   8.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   235  1980  1728
Test passed: M N K =  1972  1767  1024
Test passed: M N K =  1682  1849   256
Test passed: M N K =  1865   862   896
Test passed: M N K =  1465  1475   256
M N K =  1024  1024   256, Elapsed time =   0.003623 s, Result = 00032000, Performance =   1.48 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004214 s, Result = 00064000, Performance =   2.55 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005093 s, Result = 00096000, Performance =   3.16 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005577 s, Result = 000c8000, Performance =   3.85 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006239 s, Result = 000fa000, Performance =   4.30 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006662 s, Result = 0012c000, Performance =   4.83 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007353 s, Result = 0015e000, Performance =   5.11 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008337 s, Result = 00190000, Performance =   5.15 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008600 s, Result = 001c2000, Performance =   5.62 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009852 s, Result = 001f4000, Performance =   5.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010063 s, Result = 00226000, Performance =   5.87 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010528 s, Result = 00258000, Performance =   6.12 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011280 s, Result = 0028a000, Performance =   6.19 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011618 s, Result = 002bc000, Performance =   6.47 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012223 s, Result = 002ee000, Performance =   6.59 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012557 s, Result = 00320000, Performance =   6.84 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013109 s, Result = 00352000, Performance =   6.96 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013964 s, Result = 00384000, Performance =   6.92 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015265 s, Result = 003b6000, Performance =   6.68 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015589 s, Result = 003e8000, Performance =   6.89 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015731 s, Result = 0041a000, Performance =   7.17 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016350 s, Result = 0044c000, Performance =   7.22 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016842 s, Result = 0047e000, Performance =   7.33 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017084 s, Result = 004b0000, Performance =   7.54 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017603 s, Result = 004e2000, Performance =   7.62 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018112 s, Result = 00514000, Performance =   7.71 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018905 s, Result = 00546000, Performance =   7.67 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020336 s, Result = 00578000, Performance =   7.39 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020241 s, Result = 005aa000, Performance =   7.69 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020639 s, Result = 005dc000, Performance =   7.80 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021474 s, Result = 0060e000, Performance =   7.75 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021966 s, Result = 00640000, Performance =   7.82 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022116 s, Result = 00672000, Performance =   8.01 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023923 s, Result = 006a4000, Performance =   7.63 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023589 s, Result = 006d6000, Performance =   7.97 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023751 s, Result = 00708000, Performance =   8.14 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.025674 s, Result = 0073a000, Performance =   7.74 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025181 s, Result = 0076c000, Performance =   8.10 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025679 s, Result = 0079e000, Performance =   8.15 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025999 s, Result = 007d0000, Performance =   8.26 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027711 s, Result = 00802000, Performance =   7.94 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027514 s, Result = 00834000, Performance =   8.20 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027902 s, Result = 00866000, Performance =   8.27 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028645 s, Result = 00898000, Performance =   8.25 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029841 s, Result = 008ca000, Performance =   8.10 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.031554 s, Result = 008fc000, Performance =   7.83 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.031340 s, Result = 0092e000, Performance =   8.05 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.032028 s, Result = 00960000, Performance =   8.05 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031975 s, Result = 00992000, Performance =   8.23 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032823 s, Result = 009c4000, Performance =   8.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032765 s, Result = 009f6000, Performance =   8.36 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.034143 s, Result = 00a28000, Performance =   8.18 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033842 s, Result = 00a5a000, Performance =   8.41 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.034496 s, Result = 00a8c000, Performance =   8.40 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.035136 s, Result = 00abe000, Performance =   8.40 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.036430 s, Result = 00af0000, Performance =   8.25 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035506 s, Result = 00b22000, Performance =   8.62 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.037322 s, Result = 00b54000, Performance =   8.34 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037708 s, Result = 00b86000, Performance =   8.40 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038417 s, Result = 00bb8000, Performance =   8.38 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.038070 s, Result = 00bea000, Performance =   8.60 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.039394 s, Result = 00c1c000, Performance =   8.45 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039741 s, Result = 00c4e000, Performance =   8.51 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.040462 s, Result = 00c80000, Performance =   8.49 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  2006  1766  1984
Test passed: M N K =   802  1120  1536
Test passed: M N K =   884   159  1024
Test passed: M N K =   939  1444   384
Test passed: M N K =  1891  1157    64
M N K =  1024  1024   256, Elapsed time =   0.003077 s, Result = 0a0d2000, Performance =   1.74 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003592 s, Result = 0a104000, Performance =   2.99 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004125 s, Result = 0a136000, Performance =   3.90 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004663 s, Result = 0a168000, Performance =   4.61 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004981 s, Result = 0a19a000, Performance =   5.39 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005678 s, Result = 0a1cc000, Performance =   5.67 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006454 s, Result = 0a1fe000, Performance =   5.82 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007410 s, Result = 0a230000, Performance =   5.80 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007780 s, Result = 0a262000, Performance =   6.21 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008217 s, Result = 0a294000, Performance =   6.53 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008787 s, Result = 0a2c6000, Performance =   6.72 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009364 s, Result = 0a2f8000, Performance =   6.88 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010113 s, Result = 0a32a000, Performance =   6.90 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010636 s, Result = 0a35c000, Performance =   7.07 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010999 s, Result = 0a38e000, Performance =   7.32 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011534 s, Result = 0a3c0000, Performance =   7.45 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012109 s, Result = 0a3f2000, Performance =   7.54 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012975 s, Result = 0a424000, Performance =   7.45 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013253 s, Result = 0a456000, Performance =   7.70 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013663 s, Result = 0a488000, Performance =   7.86 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014132 s, Result = 0a4ba000, Performance =   7.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015382 s, Result = 0a4ec000, Performance =   7.68 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015538 s, Result = 0a51e000, Performance =   7.95 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015980 s, Result = 0a550000, Performance =   8.06 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016433 s, Result = 0a582000, Performance =   8.17 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017013 s, Result = 0a5b4000, Performance =   8.20 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018311 s, Result = 0a5e6000, Performance =   7.92 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018343 s, Result = 0a618000, Performance =   8.20 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018921 s, Result = 0a64a000, Performance =   8.23 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019440 s, Result = 0a67c000, Performance =   8.28 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020335 s, Result = 0a6ae000, Performance =   8.18 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020375 s, Result = 0a6e0000, Performance =   8.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020999 s, Result = 0a712000, Performance =   8.44 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021532 s, Result = 0a744000, Performance =   8.48 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021967 s, Result = 0a776000, Performance =   8.55 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023495 s, Result = 0a7a8000, Performance =   8.23 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023297 s, Result = 0a7da000, Performance =   8.53 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023599 s, Result = 0a80c000, Performance =   8.65 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024321 s, Result = 0a83e000, Performance =   8.61 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025568 s, Result = 0a870000, Performance =   8.40 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025915 s, Result = 0a8a2000, Performance =   8.49 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026393 s, Result = 0a8d4000, Performance =   8.54 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.026739 s, Result = 0a906000, Performance =   8.63 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028316 s, Result = 0a938000, Performance =   8.34 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027926 s, Result = 0a96a000, Performance =   8.65 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.028256 s, Result = 0a99c000, Performance =   8.74 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030494 s, Result = 0a9ce000, Performance =   8.27 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030958 s, Result = 0aa00000, Performance =   8.32 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031093 s, Result = 0aa32000, Performance =   8.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031338 s, Result = 0aa64000, Performance =   8.57 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032191 s, Result = 0aa96000, Performance =   8.51 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032305 s, Result = 0aac8000, Performance =   8.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033727 s, Result = 0aafa000, Performance =   8.44 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033544 s, Result = 0ab2c000, Performance =   8.64 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034186 s, Result = 0ab5e000, Performance =   8.64 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034962 s, Result = 0ab90000, Performance =   8.60 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035828 s, Result = 0abc2000, Performance =   8.54 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036148 s, Result = 0abf4000, Performance =   8.61 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036962 s, Result = 0ac26000, Performance =   8.57 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.037659 s, Result = 0ac58000, Performance =   8.55 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.038281 s, Result = 0ac8a000, Performance =   8.55 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038576 s, Result = 0acbc000, Performance =   8.63 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039007 s, Result = 0acee000, Performance =   8.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.039036 s, Result = 0ad20000, Performance =   8.80 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   454   491  2048
Test passed: M N K =   125   278  1024
Test passed: M N K =   797  1425   896
Test passed: M N K =  1902  1346  1408
Test passed: M N K =  1753  1950  1984
M N K =  1024  1024   256, Elapsed time =   0.000369 s, Result = 00032000, Performance =  14.54 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000956 s, Result = 00064000, Performance =  11.23 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001498 s, Result = 00096000, Performance =  10.75 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002043 s, Result = 000c8000, Performance =  10.51 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002665 s, Result = 000fa000, Performance =  10.07 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003577 s, Result = 0012c000, Performance =   9.00 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003943 s, Result = 0015e000, Performance =   9.53 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004705 s, Result = 00190000, Performance =   9.13 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005240 s, Result = 001c2000, Performance =   9.22 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005892 s, Result = 001f4000, Performance =   9.11 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006629 s, Result = 00226000, Performance =   8.91 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007723 s, Result = 00258000, Performance =   8.34 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007971 s, Result = 0028a000, Performance =   8.76 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008641 s, Result = 002bc000, Performance =   8.70 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009491 s, Result = 002ee000, Performance =   8.48 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010052 s, Result = 00320000, Performance =   8.55 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010756 s, Result = 00352000, Performance =   8.48 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011163 s, Result = 00384000, Performance =   8.66 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011691 s, Result = 003b6000, Performance =   8.73 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012629 s, Result = 003e8000, Performance =   8.50 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013535 s, Result = 0041a000, Performance =   8.33 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013809 s, Result = 0044c000, Performance =   8.55 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014459 s, Result = 0047e000, Performance =   8.54 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.014892 s, Result = 004b0000, Performance =   8.65 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015266 s, Result = 004e2000, Performance =   8.79 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016731 s, Result = 00514000, Performance =   8.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016755 s, Result = 00546000, Performance =   8.65 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017569 s, Result = 00578000, Performance =   8.56 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018306 s, Result = 005aa000, Performance =   8.51 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019086 s, Result = 005dc000, Performance =   8.44 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019248 s, Result = 0060e000, Performance =   8.65 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019868 s, Result = 00640000, Performance =   8.65 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020412 s, Result = 00672000, Performance =   8.68 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.020997 s, Result = 006a4000, Performance =   8.69 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022047 s, Result = 006d6000, Performance =   8.52 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022799 s, Result = 00708000, Performance =   8.48 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023410 s, Result = 0073a000, Performance =   8.49 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023356 s, Result = 0076c000, Performance =   8.73 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025103 s, Result = 0079e000, Performance =   8.34 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.024878 s, Result = 007d0000, Performance =   8.63 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025176 s, Result = 00802000, Performance =   8.74 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026387 s, Result = 00834000, Performance =   8.55 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027462 s, Result = 00866000, Performance =   8.41 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.027161 s, Result = 00898000, Performance =   8.70 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028993 s, Result = 008ca000, Performance =   8.33 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029611 s, Result = 008fc000, Performance =   8.34 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029597 s, Result = 0092e000, Performance =   8.53 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030252 s, Result = 00960000, Performance =   8.52 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030974 s, Result = 00992000, Performance =   8.49 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031468 s, Result = 009c4000, Performance =   8.53 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031893 s, Result = 009f6000, Performance =   8.59 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.033020 s, Result = 00a28000, Performance =   8.45 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033407 s, Result = 00a5a000, Performance =   8.52 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033885 s, Result = 00a8c000, Performance =   8.56 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034265 s, Result = 00abe000, Performance =   8.62 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035789 s, Result = 00af0000, Performance =   8.40 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035658 s, Result = 00b22000, Performance =   8.58 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036197 s, Result = 00b54000, Performance =   8.60 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037214 s, Result = 00b86000, Performance =   8.51 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038381 s, Result = 00bb8000, Performance =   8.39 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.038345 s, Result = 00bea000, Performance =   8.54 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038366 s, Result = 00c1c000, Performance =   8.68 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.038857 s, Result = 00c4e000, Performance =   8.70 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.040721 s, Result = 00c80000, Performance =   8.44 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   742   924  1984
Test passed: M N K =  1980  1005  1472
Test passed: M N K =   706   565  1280
Test passed: M N K =  1364  1451  1792
Test passed: M N K =    12  1473   704
M N K =  1024  1024   256, Elapsed time =   0.006292 s, Result = f5042000, Performance =   0.85 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007237 s, Result = a9074000, Performance =   1.48 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007792 s, Result = 5d0a6000, Performance =   2.07 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008273 s, Result = 110d8000, Performance =   2.60 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009102 s, Result = c510a000, Performance =   2.95 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009783 s, Result = 7913c000, Performance =   3.29 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010319 s, Result = 2d16e000, Performance =   3.64 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012175 s, Result = e11a0000, Performance =   3.53 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012273 s, Result = 951d2000, Performance =   3.94 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013478 s, Result = 49204000, Performance =   3.98 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013894 s, Result = fd236000, Performance =   4.25 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014217 s, Result = b1268000, Performance =   4.53 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014850 s, Result = 6529a000, Performance =   4.70 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015561 s, Result = 192cc000, Performance =   4.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015811 s, Result = cd2fe000, Performance =   5.09 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018430 s, Result = 81330000, Performance =   4.66 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017499 s, Result = 35362000, Performance =   5.22 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018113 s, Result = e9394000, Performance =   5.34 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018449 s, Result = 9d3c6000, Performance =   5.53 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019029 s, Result = 513f8000, Performance =   5.64 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019478 s, Result = 0542a000, Performance =   5.79 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020404 s, Result = b945c000, Performance =   5.79 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020849 s, Result = 6d48e000, Performance =   5.92 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023819 s, Result = 214c0000, Performance =   5.41 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023290 s, Result = d54f2000, Performance =   5.76 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024227 s, Result = 89524000, Performance =   5.76 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024332 s, Result = 3d556000, Performance =   5.96 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025190 s, Result = f1588000, Performance =   5.97 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025949 s, Result = a55ba000, Performance =   6.00 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026651 s, Result = 595ec000, Performance =   6.04 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.027713 s, Result = 0d61e000, Performance =   6.01 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030721 s, Result = c1650000, Performance =   5.59 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.028373 s, Result = 75682000, Performance =   6.24 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029251 s, Result = 296b4000, Performance =   6.24 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030229 s, Result = dd6e6000, Performance =   6.22 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030580 s, Result = 91718000, Performance =   6.32 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031094 s, Result = 4574a000, Performance =   6.39 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.031863 s, Result = f977c000, Performance =   6.40 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032725 s, Result = ad7ae000, Performance =   6.40 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034680 s, Result = 617e0000, Performance =   6.19 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034093 s, Result = 15812000, Performance =   6.46 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034751 s, Result = c9844000, Performance =   6.49 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.036094 s, Result = 7d876000, Performance =   6.40 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036540 s, Result = 318a8000, Performance =   6.46 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036911 s, Result = e58da000, Performance =   6.55 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.037518 s, Result = 9990c000, Performance =   6.58 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037988 s, Result = 4d93e000, Performance =   6.64 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.043040 s, Result = 01970000, Performance =   5.99 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039393 s, Result = b59a2000, Performance =   6.68 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039989 s, Result = 699d4000, Performance =   6.71 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040722 s, Result = 1da06000, Performance =   6.72 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.041268 s, Result = d1a38000, Performance =   6.76 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.041978 s, Result = 85a6a000, Performance =   6.78 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.042584 s, Result = 39a9c000, Performance =   6.81 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.043328 s, Result = edace000, Performance =   6.81 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046659 s, Result = a1b00000, Performance =   6.44 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.045333 s, Result = 55b32000, Performance =   6.75 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.046035 s, Result = 09b64000, Performance =   6.76 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.046342 s, Result = bdb96000, Performance =   6.84 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.046669 s, Result = 71bc8000, Performance =   6.90 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.047245 s, Result = 25bfa000, Performance =   6.93 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.047905 s, Result = d9c2c000, Performance =   6.95 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.048251 s, Result = 8dc5e000, Performance =   7.01 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055469 s, Result = 41c90000, Performance =   6.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1275  1509   896
Test passed: M N K =  1270  1118   704
Test passed: M N K =   939  1040  1792
Test passed: M N K =   982   780   256
Test passed: M N K =   436  1053   512
M N K =  1024  1024   256, Elapsed time =   0.003634 s, Result = 00032000, Performance =   1.48 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004291 s, Result = 00064000, Performance =   2.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005961 s, Result = 00096000, Performance =   2.70 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006193 s, Result = 000c8000, Performance =   3.47 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006914 s, Result = 000fa000, Performance =   3.88 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007549 s, Result = 0012c000, Performance =   4.27 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008116 s, Result = 0015e000, Performance =   4.63 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009443 s, Result = 00190000, Performance =   4.55 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010000 s, Result = 001c2000, Performance =   4.83 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011110 s, Result = 001f4000, Performance =   4.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011386 s, Result = 00226000, Performance =   5.19 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012995 s, Result = 00258000, Performance =   4.96 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012762 s, Result = 0028a000, Performance =   5.47 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013477 s, Result = 002bc000, Performance =   5.58 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013826 s, Result = 002ee000, Performance =   5.82 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015904 s, Result = 00320000, Performance =   5.40 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014874 s, Result = 00352000, Performance =   6.14 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015523 s, Result = 00384000, Performance =   6.23 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016087 s, Result = 003b6000, Performance =   6.34 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016806 s, Result = 003e8000, Performance =   6.39 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017413 s, Result = 0041a000, Performance =   6.47 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018101 s, Result = 0044c000, Performance =   6.53 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021502 s, Result = 0047e000, Performance =   5.74 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021505 s, Result = 004b0000, Performance =   5.99 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022648 s, Result = 004e2000, Performance =   5.93 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022579 s, Result = 00514000, Performance =   6.18 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023488 s, Result = 00546000, Performance =   6.17 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024270 s, Result = 00578000, Performance =   6.19 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024832 s, Result = 005aa000, Performance =   6.27 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024689 s, Result = 005dc000, Performance =   6.52 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025614 s, Result = 0060e000, Performance =   6.50 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.028206 s, Result = 00640000, Performance =   6.09 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026896 s, Result = 00672000, Performance =   6.59 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027294 s, Result = 006a4000, Performance =   6.69 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027986 s, Result = 006d6000, Performance =   6.71 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029655 s, Result = 00708000, Performance =   6.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029982 s, Result = 0073a000, Performance =   6.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029998 s, Result = 0076c000, Performance =   6.80 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030700 s, Result = 0079e000, Performance =   6.82 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032798 s, Result = 007d0000, Performance =   6.55 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032747 s, Result = 00802000, Performance =   6.72 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032816 s, Result = 00834000, Performance =   6.87 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033449 s, Result = 00866000, Performance =   6.90 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.035420 s, Result = 00898000, Performance =   6.67 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.035152 s, Result = 008ca000, Performance =   6.87 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035379 s, Result = 008fc000, Performance =   6.98 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035895 s, Result = 0092e000, Performance =   7.03 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.040832 s, Result = 00960000, Performance =   6.31 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037877 s, Result = 00992000, Performance =   6.95 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.038438 s, Result = 009c4000, Performance =   6.98 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037924 s, Result = 009f6000, Performance =   7.22 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039823 s, Result = 00a28000, Performance =   7.01 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.040296 s, Result = 00a5a000, Performance =   7.06 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.041814 s, Result = 00a8c000, Performance =   6.93 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041322 s, Result = 00abe000, Performance =   7.15 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044407 s, Result = 00af0000, Performance =   6.77 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.043677 s, Result = 00b22000, Performance =   7.01 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.044130 s, Result = 00b54000, Performance =   7.06 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043498 s, Result = 00b86000, Performance =   7.28 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.045627 s, Result = 00bb8000, Performance =   7.06 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045482 s, Result = 00bea000, Performance =   7.20 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.047553 s, Result = 00c1c000, Performance =   7.00 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046416 s, Result = 00c4e000, Performance =   7.29 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.053954 s, Result = 00c80000, Performance =   6.37 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   348   907   704
Test passed: M N K =   921   323  1920
Test passed: M N K =  1138  1168  1920
Test passed: M N K =  1207  1806  1856
Test passed: M N K =   365  1078  1536
M N K =  1024  1024   256, Elapsed time =   0.003152 s, Result = 0a0d2000, Performance =   1.70 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003674 s, Result = 0a104000, Performance =   2.92 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004624 s, Result = 0a136000, Performance =   3.48 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005183 s, Result = 0a168000, Performance =   4.14 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006001 s, Result = 0a19a000, Performance =   4.47 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006608 s, Result = 0a1cc000, Performance =   4.88 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007312 s, Result = 0a1fe000, Performance =   5.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008580 s, Result = 0a230000, Performance =   5.01 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008954 s, Result = 0a262000, Performance =   5.40 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010251 s, Result = 0a294000, Performance =   5.24 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010895 s, Result = 0a2c6000, Performance =   5.42 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011431 s, Result = 0a2f8000, Performance =   5.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011603 s, Result = 0a32a000, Performance =   6.01 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012640 s, Result = 0a35c000, Performance =   5.95 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012649 s, Result = 0a38e000, Performance =   6.37 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014849 s, Result = 0a3c0000, Performance =   5.78 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013665 s, Result = 0a3f2000, Performance =   6.68 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014595 s, Result = 0a424000, Performance =   6.62 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014899 s, Result = 0a456000, Performance =   6.85 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016772 s, Result = 0a488000, Performance =   6.40 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016395 s, Result = 0a4ba000, Performance =   6.88 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017096 s, Result = 0a4ec000, Performance =   6.91 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018024 s, Result = 0a51e000, Performance =   6.85 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019587 s, Result = 0a550000, Performance =   6.58 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018921 s, Result = 0a582000, Performance =   7.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019961 s, Result = 0a5b4000, Performance =   6.99 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021992 s, Result = 0a5e6000, Performance =   6.59 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022249 s, Result = 0a618000, Performance =   6.76 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023727 s, Result = 0a64a000, Performance =   6.56 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023464 s, Result = 0a67c000, Performance =   6.86 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023885 s, Result = 0a6ae000, Performance =   6.97 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026913 s, Result = 0a6e0000, Performance =   6.38 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024763 s, Result = 0a712000, Performance =   7.15 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026479 s, Result = 0a744000, Performance =   6.89 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027026 s, Result = 0a776000, Performance =   6.95 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027824 s, Result = 0a7a8000, Performance =   6.95 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028496 s, Result = 0a7da000, Performance =   6.97 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028942 s, Result = 0a80c000, Performance =   7.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029625 s, Result = 0a83e000, Performance =   7.07 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032048 s, Result = 0a870000, Performance =   6.70 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030899 s, Result = 0a8a2000, Performance =   7.12 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031661 s, Result = 0a8d4000, Performance =   7.12 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032674 s, Result = 0a906000, Performance =   7.07 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033164 s, Result = 0a938000, Performance =   7.12 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033109 s, Result = 0a96a000, Performance =   7.30 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034540 s, Result = 0a99c000, Performance =   7.15 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035737 s, Result = 0a9ce000, Performance =   7.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.040216 s, Result = 0aa00000, Performance =   6.41 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.035957 s, Result = 0aa32000, Performance =   7.32 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037451 s, Result = 0aa64000, Performance =   7.17 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.038095 s, Result = 0aa96000, Performance =   7.19 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038325 s, Result = 0aac8000, Performance =   7.28 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038724 s, Result = 0aafa000, Performance =   7.35 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040415 s, Result = 0ab2c000, Performance =   7.17 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040686 s, Result = 0ab5e000, Performance =   7.26 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.043048 s, Result = 0ab90000, Performance =   6.98 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.041356 s, Result = 0abc2000, Performance =   7.40 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043247 s, Result = 0abf4000, Performance =   7.20 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043185 s, Result = 0ac26000, Performance =   7.33 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.043456 s, Result = 0ac58000, Performance =   7.41 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.043987 s, Result = 0ac8a000, Performance =   7.45 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.045747 s, Result = 0acbc000, Performance =   7.28 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.045679 s, Result = 0acee000, Performance =   7.40 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.052229 s, Result = 0ad20000, Performance =   6.58 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   188  1829  1792
Test passed: M N K =   302   365  1024
Test passed: M N K =  1993  1510  1536
Test passed: M N K =  1000  1923   832
Test passed: M N K =   636  1771  1280
M N K =  1024  1024   256, Elapsed time =   0.000406 s, Result = 00032000, Performance =  13.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000758 s, Result = 00064000, Performance =  14.17 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001461 s, Result = 00096000, Performance =  11.02 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002199 s, Result = 000c8000, Performance =   9.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002772 s, Result = 000fa000, Performance =   9.69 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003558 s, Result = 0012c000, Performance =   9.05 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004187 s, Result = 0015e000, Performance =   8.98 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005518 s, Result = 00190000, Performance =   7.78 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006087 s, Result = 001c2000, Performance =   7.94 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007302 s, Result = 001f4000, Performance =   7.35 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007752 s, Result = 00226000, Performance =   7.62 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008767 s, Result = 00258000, Performance =   7.35 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009196 s, Result = 0028a000, Performance =   7.59 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009657 s, Result = 002bc000, Performance =   7.78 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010255 s, Result = 002ee000, Performance =   7.85 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012861 s, Result = 00320000, Performance =   6.68 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010693 s, Result = 00352000, Performance =   8.54 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011811 s, Result = 00384000, Performance =   8.18 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012154 s, Result = 003b6000, Performance =   8.39 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012835 s, Result = 003e8000, Performance =   8.37 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013295 s, Result = 0041a000, Performance =   8.48 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014105 s, Result = 0044c000, Performance =   8.37 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014550 s, Result = 0047e000, Performance =   8.49 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017717 s, Result = 004b0000, Performance =   7.27 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015626 s, Result = 004e2000, Performance =   8.59 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016752 s, Result = 00514000, Performance =   8.33 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017148 s, Result = 00546000, Performance =   8.45 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018341 s, Result = 00578000, Performance =   8.20 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018927 s, Result = 005aa000, Performance =   8.23 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019211 s, Result = 005dc000, Performance =   8.38 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019395 s, Result = 0060e000, Performance =   8.58 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024773 s, Result = 00640000, Performance =   6.93 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020628 s, Result = 00672000, Performance =   8.59 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021767 s, Result = 006a4000, Performance =   8.39 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022082 s, Result = 006d6000, Performance =   8.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022684 s, Result = 00708000, Performance =   8.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023187 s, Result = 0073a000, Performance =   8.57 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024312 s, Result = 0076c000, Performance =   8.39 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025611 s, Result = 0079e000, Performance =   8.18 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.028991 s, Result = 007d0000, Performance =   7.41 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026561 s, Result = 00802000, Performance =   8.29 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027550 s, Result = 00834000, Performance =   8.18 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028210 s, Result = 00866000, Performance =   8.18 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028903 s, Result = 00898000, Performance =   8.17 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029272 s, Result = 008ca000, Performance =   8.25 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030232 s, Result = 008fc000, Performance =   8.17 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030471 s, Result = 0092e000, Performance =   8.28 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039101 s, Result = 00960000, Performance =   6.59 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031209 s, Result = 00992000, Performance =   8.43 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032619 s, Result = 009c4000, Performance =   8.23 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.033090 s, Result = 009f6000, Performance =   8.27 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.033451 s, Result = 00a28000, Performance =   8.35 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033877 s, Result = 00a5a000, Performance =   8.40 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.035692 s, Result = 00a8c000, Performance =   8.12 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.035580 s, Result = 00abe000, Performance =   8.30 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.041396 s, Result = 00af0000, Performance =   7.26 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.036796 s, Result = 00b22000, Performance =   8.32 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.037870 s, Result = 00b54000, Performance =   8.22 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037834 s, Result = 00b86000, Performance =   8.37 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038232 s, Result = 00bb8000, Performance =   8.43 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039342 s, Result = 00bea000, Performance =   8.32 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.040755 s, Result = 00c1c000, Performance =   8.17 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.040521 s, Result = 00c4e000, Performance =   8.35 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.049353 s, Result = 00c80000, Performance =   6.96 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   921  1295  1728
Test passed: M N K =  1419    26   704
Test passed: M N K =  1592   978  1280
Test passed: M N K =  1979   987   320
Test passed: M N K =  1311  2017  1856
M N K =  1024  1024   256, Elapsed time =   0.006168 s, Result = f5042000, Performance =   0.87 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007171 s, Result = a9074000, Performance =   1.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007578 s, Result = 5d0a6000, Performance =   2.13 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007931 s, Result = 110d8000, Performance =   2.71 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008642 s, Result = c510a000, Performance =   3.11 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009435 s, Result = 7913c000, Performance =   3.41 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010202 s, Result = 2d16e000, Performance =   3.68 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011495 s, Result = e11a0000, Performance =   3.74 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012349 s, Result = 951d2000, Performance =   3.91 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013876 s, Result = 49204000, Performance =   3.87 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014603 s, Result = fd236000, Performance =   4.04 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016216 s, Result = b1268000, Performance =   3.97 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016214 s, Result = 6529a000, Performance =   4.30 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017144 s, Result = 192cc000, Performance =   4.38 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018689 s, Result = cd2fe000, Performance =   4.31 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019928 s, Result = 81330000, Performance =   4.31 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018413 s, Result = 35362000, Performance =   4.96 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021209 s, Result = e9394000, Performance =   4.56 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022774 s, Result = 9d3c6000, Performance =   4.48 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022814 s, Result = 513f8000, Performance =   4.71 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023763 s, Result = 0542a000, Performance =   4.74 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025198 s, Result = b945c000, Performance =   4.69 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025589 s, Result = 6d48e000, Performance =   4.83 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027085 s, Result = 214c0000, Performance =   4.76 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027481 s, Result = d54f2000, Performance =   4.88 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027140 s, Result = 89524000, Performance =   5.14 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029550 s, Result = 3d556000, Performance =   4.91 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.030366 s, Result = f1588000, Performance =   4.95 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030932 s, Result = a55ba000, Performance =   5.03 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030608 s, Result = 595ec000, Performance =   5.26 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031723 s, Result = 0d61e000, Performance =   5.25 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034751 s, Result = c1650000, Performance =   4.94 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.034176 s, Result = 75682000, Performance =   5.18 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034961 s, Result = 296b4000, Performance =   5.22 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.037941 s, Result = dd6e6000, Performance =   4.95 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037954 s, Result = 91718000, Performance =   5.09 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037951 s, Result = 4574a000, Performance =   5.23 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039747 s, Result = f977c000, Performance =   5.13 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040420 s, Result = ad7ae000, Performance =   5.18 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040814 s, Result = 617e0000, Performance =   5.26 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041602 s, Result = 15812000, Performance =   5.29 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.042134 s, Result = c9844000, Performance =   5.35 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044118 s, Result = 7d876000, Performance =   5.23 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044223 s, Result = 318a8000, Performance =   5.34 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.044232 s, Result = e58da000, Performance =   5.46 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.044976 s, Result = 9990c000, Performance =   5.49 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046841 s, Result = 4d93e000, Performance =   5.39 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.048906 s, Result = 01970000, Performance =   5.27 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.048961 s, Result = b59a2000, Performance =   5.37 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.050330 s, Result = 699d4000, Performance =   5.33 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.050291 s, Result = 1da06000, Performance =   5.44 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.052527 s, Result = d1a38000, Performance =   5.31 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.052981 s, Result = 85a6a000, Performance =   5.37 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052870 s, Result = 39a9c000, Performance =   5.48 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.054540 s, Result = edace000, Performance =   5.41 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.055352 s, Result = a1b00000, Performance =   5.43 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.056565 s, Result = 55b32000, Performance =   5.41 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.057350 s, Result = 09b64000, Performance =   5.43 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.058954 s, Result = bdb96000, Performance =   5.37 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.058622 s, Result = 71bc8000, Performance =   5.49 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.060064 s, Result = 25bfa000, Performance =   5.45 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059544 s, Result = d9c2c000, Performance =   5.59 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.061979 s, Result = 8dc5e000, Performance =   5.46 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.062234 s, Result = 41c90000, Performance =   5.52 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   750   604  2048
Test passed: M N K =  1333  1211  1024
Test passed: M N K =  1015   496   768
Test passed: M N K =  1308   995   128
Test passed: M N K =   430   999  1728
M N K =  1024  1024   256, Elapsed time =   0.003683 s, Result = 00032000, Performance =   1.46 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005164 s, Result = 00064000, Performance =   2.08 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005763 s, Result = 00096000, Performance =   2.79 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006179 s, Result = 000c8000, Performance =   3.48 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006919 s, Result = 000fa000, Performance =   3.88 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007559 s, Result = 0012c000, Performance =   4.26 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009488 s, Result = 0015e000, Performance =   3.96 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009803 s, Result = 00190000, Performance =   4.38 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010200 s, Result = 001c2000, Performance =   4.74 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011503 s, Result = 001f4000, Performance =   4.67 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013207 s, Result = 00226000, Performance =   4.47 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013593 s, Result = 00258000, Performance =   4.74 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014009 s, Result = 0028a000, Performance =   4.98 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015062 s, Result = 002bc000, Performance =   4.99 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016439 s, Result = 002ee000, Performance =   4.90 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018433 s, Result = 00320000, Performance =   4.66 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018293 s, Result = 00352000, Performance =   4.99 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019854 s, Result = 00384000, Performance =   4.87 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020891 s, Result = 003b6000, Performance =   4.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021934 s, Result = 003e8000, Performance =   4.90 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022069 s, Result = 0041a000, Performance =   5.11 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022790 s, Result = 0044c000, Performance =   5.18 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024115 s, Result = 0047e000, Performance =   5.12 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024552 s, Result = 004b0000, Performance =   5.25 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026333 s, Result = 004e2000, Performance =   5.10 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025885 s, Result = 00514000, Performance =   5.39 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028009 s, Result = 00546000, Performance =   5.18 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027687 s, Result = 00578000, Performance =   5.43 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029598 s, Result = 005aa000, Performance =   5.26 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029688 s, Result = 005dc000, Performance =   5.43 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031440 s, Result = 0060e000, Performance =   5.29 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.031599 s, Result = 00640000, Performance =   5.44 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033109 s, Result = 00672000, Performance =   5.35 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033539 s, Result = 006a4000, Performance =   5.44 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035067 s, Result = 006d6000, Performance =   5.36 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.035010 s, Result = 00708000, Performance =   5.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036525 s, Result = 0073a000, Performance =   5.44 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036595 s, Result = 0076c000, Performance =   5.57 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036748 s, Result = 0079e000, Performance =   5.70 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038406 s, Result = 007d0000, Performance =   5.59 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040140 s, Result = 00802000, Performance =   5.48 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040920 s, Result = 00834000, Performance =   5.51 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042241 s, Result = 00866000, Performance =   5.47 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042985 s, Result = 00898000, Performance =   5.50 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043640 s, Result = 008ca000, Performance =   5.54 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043656 s, Result = 008fc000, Performance =   5.66 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.045148 s, Result = 0092e000, Performance =   5.59 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045527 s, Result = 00960000, Performance =   5.66 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.046051 s, Result = 00992000, Performance =   5.71 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047464 s, Result = 009c4000, Performance =   5.66 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048869 s, Result = 009f6000, Performance =   5.60 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.049133 s, Result = 00a28000, Performance =   5.68 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048960 s, Result = 00a5a000, Performance =   5.81 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050630 s, Result = 00a8c000, Performance =   5.73 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.052551 s, Result = 00abe000, Performance =   5.62 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052154 s, Result = 00af0000, Performance =   5.76 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.054648 s, Result = 00b22000, Performance =   5.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.054129 s, Result = 00b54000, Performance =   5.75 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055751 s, Result = 00b86000, Performance =   5.68 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055778 s, Result = 00bb8000, Performance =   5.78 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.058363 s, Result = 00bea000, Performance =   5.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.057782 s, Result = 00c1c000, Performance =   5.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.057978 s, Result = 00c4e000, Performance =   5.83 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.058904 s, Result = 00c80000, Performance =   5.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =     3  1549   384
Test passed: M N K =   814   902   384
Test passed: M N K =   888   547  1152
Test passed: M N K =  1557   386    64
Test passed: M N K =    34  1145   832
M N K =  1024  1024   256, Elapsed time =   0.003144 s, Result = 0a0d2000, Performance =   1.71 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004021 s, Result = 0a104000, Performance =   2.67 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004384 s, Result = 0a136000, Performance =   3.67 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004829 s, Result = 0a168000, Performance =   4.45 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005592 s, Result = 0a19a000, Performance =   4.80 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006348 s, Result = 0a1cc000, Performance =   5.07 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007225 s, Result = 0a1fe000, Performance =   5.20 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008632 s, Result = 0a230000, Performance =   4.98 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009361 s, Result = 0a262000, Performance =   5.16 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010654 s, Result = 0a294000, Performance =   5.04 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011900 s, Result = 0a2c6000, Performance =   4.96 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013072 s, Result = 0a2f8000, Performance =   4.93 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013280 s, Result = 0a32a000, Performance =   5.26 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014284 s, Result = 0a35c000, Performance =   5.26 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014915 s, Result = 0a38e000, Performance =   5.40 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017063 s, Result = 0a3c0000, Performance =   5.03 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017409 s, Result = 0a3f2000, Performance =   5.24 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018180 s, Result = 0a424000, Performance =   5.32 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019627 s, Result = 0a456000, Performance =   5.20 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020573 s, Result = 0a488000, Performance =   5.22 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020981 s, Result = 0a4ba000, Performance =   5.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022006 s, Result = 0a4ec000, Performance =   5.37 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023242 s, Result = 0a51e000, Performance =   5.31 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023907 s, Result = 0a550000, Performance =   5.39 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024522 s, Result = 0a582000, Performance =   5.47 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025527 s, Result = 0a5b4000, Performance =   5.47 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026874 s, Result = 0a5e6000, Performance =   5.39 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027392 s, Result = 0a618000, Performance =   5.49 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026356 s, Result = 0a64a000, Performance =   5.91 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028871 s, Result = 0a67c000, Performance =   5.58 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030136 s, Result = 0a6ae000, Performance =   5.52 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030811 s, Result = 0a6e0000, Performance =   5.58 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.031448 s, Result = 0a712000, Performance =   5.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032908 s, Result = 0a744000, Performance =   5.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033934 s, Result = 0a776000, Performance =   5.54 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033779 s, Result = 0a7a8000, Performance =   5.72 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034713 s, Result = 0a7da000, Performance =   5.72 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036552 s, Result = 0a80c000, Performance =   5.58 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036527 s, Result = 0a83e000, Performance =   5.73 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.036073 s, Result = 0a870000, Performance =   5.95 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039378 s, Result = 0a8a2000, Performance =   5.59 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040293 s, Result = 0a8d4000, Performance =   5.60 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041697 s, Result = 0a906000, Performance =   5.54 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041299 s, Result = 0a938000, Performance =   5.72 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.041963 s, Result = 0a96a000, Performance =   5.76 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043653 s, Result = 0a99c000, Performance =   5.66 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042498 s, Result = 0a9ce000, Performance =   5.94 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045525 s, Result = 0aa00000, Performance =   5.66 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.046375 s, Result = 0aa32000, Performance =   5.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.047438 s, Result = 0aa64000, Performance =   5.66 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048738 s, Result = 0aa96000, Performance =   5.62 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048787 s, Result = 0aac8000, Performance =   5.72 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050271 s, Result = 0aafa000, Performance =   5.66 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.051090 s, Result = 0ab2c000, Performance =   5.67 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051232 s, Result = 0ab5e000, Performance =   5.76 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051249 s, Result = 0ab90000, Performance =   5.87 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053746 s, Result = 0abc2000, Performance =   5.69 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.054804 s, Result = 0abf4000, Performance =   5.68 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054050 s, Result = 0ac26000, Performance =   5.86 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.054740 s, Result = 0ac58000, Performance =   5.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.057139 s, Result = 0ac8a000, Performance =   5.73 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.058032 s, Result = 0acbc000, Performance =   5.74 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.058939 s, Result = 0acee000, Performance =   5.74 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.056785 s, Result = 0ad20000, Performance =   6.05 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1483   316   704
Test passed: M N K =  1912   417   768
Test passed: M N K =  1455  1361  1216
Test passed: M N K =   168  1828   576
Test passed: M N K =  1923   302   704
M N K =  1024  1024   256, Elapsed time =   0.000404 s, Result = 00032000, Performance =  13.28 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000934 s, Result = 00064000, Performance =  11.49 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001459 s, Result = 00096000, Performance =  11.04 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002018 s, Result = 000c8000, Performance =  10.64 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002920 s, Result = 000fa000, Performance =   9.19 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003702 s, Result = 0012c000, Performance =   8.70 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004178 s, Result = 0015e000, Performance =   9.00 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005473 s, Result = 00190000, Performance =   7.85 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005935 s, Result = 001c2000, Performance =   8.14 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007355 s, Result = 001f4000, Performance =   7.30 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008626 s, Result = 00226000, Performance =   6.85 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009763 s, Result = 00258000, Performance =   6.60 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010157 s, Result = 0028a000, Performance =   6.87 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010841 s, Result = 002bc000, Performance =   6.93 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012053 s, Result = 002ee000, Performance =   6.68 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013619 s, Result = 00320000, Performance =   6.31 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014062 s, Result = 00352000, Performance =   6.49 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014675 s, Result = 00384000, Performance =   6.59 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016080 s, Result = 003b6000, Performance =   6.34 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016656 s, Result = 003e8000, Performance =   6.45 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017856 s, Result = 0041a000, Performance =   6.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018495 s, Result = 0044c000, Performance =   6.39 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020450 s, Result = 0047e000, Performance =   6.04 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020099 s, Result = 004b0000, Performance =   6.41 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021481 s, Result = 004e2000, Performance =   6.25 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022271 s, Result = 00514000, Performance =   6.27 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023828 s, Result = 00546000, Performance =   6.08 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024090 s, Result = 00578000, Performance =   6.24 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024603 s, Result = 005aa000, Performance =   6.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025334 s, Result = 005dc000, Performance =   6.36 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026571 s, Result = 0060e000, Performance =   6.26 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027277 s, Result = 00640000, Performance =   6.30 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027943 s, Result = 00672000, Performance =   6.34 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029328 s, Result = 006a4000, Performance =   6.22 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029574 s, Result = 006d6000, Performance =   6.35 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030362 s, Result = 00708000, Performance =   6.37 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.032121 s, Result = 0073a000, Performance =   6.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032337 s, Result = 0076c000, Performance =   6.31 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.034623 s, Result = 0079e000, Performance =   6.05 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034091 s, Result = 007d0000, Performance =   6.30 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034533 s, Result = 00802000, Performance =   6.37 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036191 s, Result = 00834000, Performance =   6.23 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037370 s, Result = 00866000, Performance =   6.18 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.038248 s, Result = 00898000, Performance =   6.18 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.037009 s, Result = 008ca000, Performance =   6.53 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.039453 s, Result = 008fc000, Performance =   6.26 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.041238 s, Result = 0092e000, Performance =   6.12 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042368 s, Result = 00960000, Performance =   6.08 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040315 s, Result = 00992000, Performance =   6.53 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043293 s, Result = 009c4000, Performance =   6.20 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.045071 s, Result = 009f6000, Performance =   6.07 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.044666 s, Result = 00a28000, Performance =   6.25 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.045024 s, Result = 00a5a000, Performance =   6.32 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044866 s, Result = 00a8c000, Performance =   6.46 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.048671 s, Result = 00abe000, Performance =   6.07 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.047803 s, Result = 00af0000, Performance =   6.29 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.050166 s, Result = 00b22000, Performance =   6.10 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.049908 s, Result = 00b54000, Performance =   6.24 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051444 s, Result = 00b86000, Performance =   6.16 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051949 s, Result = 00bb8000, Performance =   6.20 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052598 s, Result = 00bea000, Performance =   6.23 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053738 s, Result = 00c1c000, Performance =   6.19 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.053897 s, Result = 00c4e000, Performance =   6.28 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055119 s, Result = 00c80000, Performance =   6.23 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   263  1072   192
Test passed: M N K =  1740   776   768
Test passed: M N K =   227  1046   640
Test passed: M N K =   290  1199   704
Test passed: M N K =  1538   255  1280
M N K =  1024  1024   256, Elapsed time =   0.004768 s, Result = 5902e000, Performance =   1.13 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005424 s, Result = 3104c000, Performance =   1.98 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006213 s, Result = 0906a000, Performance =   2.59 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006663 s, Result = e1088000, Performance =   3.22 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006897 s, Result = b90a6000, Performance =   3.89 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007110 s, Result = 910c4000, Performance =   4.53 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007631 s, Result = 690e2000, Performance =   4.92 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008756 s, Result = 41100000, Performance =   4.91 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008357 s, Result = 1911e000, Performance =   5.78 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008928 s, Result = f113c000, Performance =   6.01 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009676 s, Result = c915a000, Performance =   6.10 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009499 s, Result = a1178000, Performance =   6.78 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009651 s, Result = 79196000, Performance =   7.23 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011114 s, Result = 511b4000, Performance =   6.76 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010805 s, Result = 291d2000, Performance =   7.45 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012268 s, Result = 011f0000, Performance =   7.00 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011983 s, Result = d920e000, Performance =   7.62 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011797 s, Result = b122c000, Performance =   8.19 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013502 s, Result = 8924a000, Performance =   7.55 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013697 s, Result = 61268000, Performance =   7.84 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013914 s, Result = 39286000, Performance =   8.10 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013157 s, Result = 112a4000, Performance =   8.98 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.013045 s, Result = e92c2000, Performance =   9.47 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013804 s, Result = c12e0000, Performance =   9.33 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013823 s, Result = 992fe000, Performance =   9.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.014373 s, Result = 7131c000, Performance =   9.71 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014976 s, Result = 4933a000, Performance =   9.68 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014724 s, Result = 21358000, Performance =  10.21 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015245 s, Result = f9376000, Performance =  10.21 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015877 s, Result = d1394000, Performance =  10.14 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.016142 s, Result = a93b2000, Performance =  10.31 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016117 s, Result = 813d0000, Performance =  10.66 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.017051 s, Result = 593ee000, Performance =  10.39 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.017116 s, Result = 3140c000, Performance =  10.66 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017773 s, Result = 0942a000, Performance =  10.57 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018147 s, Result = e1448000, Performance =  10.65 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.017806 s, Result = b9466000, Performance =  11.16 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.018465 s, Result = 91484000, Performance =  11.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.019273 s, Result = 694a2000, Performance =  10.86 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.019038 s, Result = 414c0000, Performance =  11.28 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.019557 s, Result = 194de000, Performance =  11.26 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.020410 s, Result = f14fc000, Performance =  11.05 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.020223 s, Result = c951a000, Performance =  11.42 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.020859 s, Result = a1538000, Performance =  11.32 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.020494 s, Result = 79556000, Performance =  11.79 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.021907 s, Result = 51574000, Performance =  11.27 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.021783 s, Result = 29592000, Performance =  11.58 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.021768 s, Result = 015b0000, Performance =  11.84 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.022588 s, Result = d95ce000, Performance =  11.65 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.023055 s, Result = b15ec000, Performance =  11.64 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.022932 s, Result = 8960a000, Performance =  11.94 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.024219 s, Result = 61628000, Performance =  11.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.023801 s, Result = 39646000, Performance =  11.96 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.024382 s, Result = 11664000, Performance =  11.89 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.024612 s, Result = e9682000, Performance =  12.00 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.025031 s, Result = c16a0000, Performance =  12.01 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.025574 s, Result = 996be000, Performance =  11.97 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.026021 s, Result = 716dc000, Performance =  11.97 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.025775 s, Result = 496fa000, Performance =  12.29 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.027420 s, Result = 21718000, Performance =  11.75 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.026870 s, Result = f9736000, Performance =  12.19 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.027237 s, Result = d1754000, Performance =  12.22 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.027787 s, Result = a9772000, Performance =  12.17 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.027887 s, Result = 81790000, Performance =  12.32 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   571  1813  1536
Test passed: M N K =   657  1963  2048
Test passed: M N K =   633   571   256
Test passed: M N K =  1709   576   128
Test passed: M N K =   296  1171  1664
M N K =  1024  1024   256, Elapsed time =   0.002766 s, Result = 0001e000, Performance =   1.94 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003353 s, Result = 0003c000, Performance =   3.20 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004525 s, Result = 0005a000, Performance =   3.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004865 s, Result = 00078000, Performance =   4.41 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005526 s, Result = 00096000, Performance =   4.86 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005719 s, Result = 000b4000, Performance =   5.63 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005898 s, Result = 000d2000, Performance =   6.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006761 s, Result = 000f0000, Performance =   6.35 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006478 s, Result = 0010e000, Performance =   7.46 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007264 s, Result = 0012c000, Performance =   7.39 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007782 s, Result = 0014a000, Performance =   7.59 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008002 s, Result = 00168000, Performance =   8.05 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009324 s, Result = 00186000, Performance =   7.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009669 s, Result = 001a4000, Performance =   7.77 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009246 s, Result = 001c2000, Performance =   8.71 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010075 s, Result = 001e0000, Performance =   8.53 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010366 s, Result = 001fe000, Performance =   8.80 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010415 s, Result = 0021c000, Performance =   9.28 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010787 s, Result = 0023a000, Performance =   9.46 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011872 s, Result = 00258000, Performance =   9.04 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011223 s, Result = 00276000, Performance =  10.05 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011248 s, Result = 00294000, Performance =  10.50 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.011756 s, Result = 002b2000, Performance =  10.50 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012224 s, Result = 002d0000, Performance =  10.54 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.012434 s, Result = 002ee000, Performance =  10.79 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.012816 s, Result = 0030c000, Performance =  10.89 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.013351 s, Result = 0032a000, Performance =  10.86 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013485 s, Result = 00348000, Performance =  11.15 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.014414 s, Result = 00366000, Performance =  10.80 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014200 s, Result = 00384000, Performance =  11.34 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.014244 s, Result = 003a2000, Performance =  11.68 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.015169 s, Result = 003c0000, Performance =  11.33 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015170 s, Result = 003de000, Performance =  11.68 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016013 s, Result = 003fc000, Performance =  11.40 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.016113 s, Result = 0041a000, Performance =  11.66 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.016298 s, Result = 00438000, Performance =  11.86 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.016283 s, Result = 00456000, Performance =  12.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.017089 s, Result = 00474000, Performance =  11.94 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017292 s, Result = 00492000, Performance =  12.11 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017865 s, Result = 004b0000, Performance =  12.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.018127 s, Result = 004ce000, Performance =  12.14 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018857 s, Result = 004ec000, Performance =  11.96 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.019085 s, Result = 0050a000, Performance =  12.10 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.019462 s, Result = 00528000, Performance =  12.14 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.020042 s, Result = 00546000, Performance =  12.05 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.020087 s, Result = 00564000, Performance =  12.29 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020648 s, Result = 00582000, Performance =  12.22 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.022034 s, Result = 005a0000, Performance =  11.70 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.021178 s, Result = 005be000, Performance =  12.42 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.021071 s, Result = 005dc000, Performance =  12.74 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021832 s, Result = 005fa000, Performance =  12.54 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.022283 s, Result = 00618000, Performance =  12.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022586 s, Result = 00636000, Performance =  12.60 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022152 s, Result = 00654000, Performance =  13.09 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.023392 s, Result = 00672000, Performance =  12.62 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.024484 s, Result = 00690000, Performance =  12.28 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023453 s, Result = 006ae000, Performance =  13.05 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024261 s, Result = 006cc000, Performance =  12.83 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.025247 s, Result = 006ea000, Performance =  12.55 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.025430 s, Result = 00708000, Performance =  12.67 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025352 s, Result = 00726000, Performance =  12.92 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.025673 s, Result = 00744000, Performance =  12.97 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026361 s, Result = 00762000, Performance =  12.83 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025453 s, Result = 00780000, Performance =  13.50 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1166   290  1216
Test passed: M N K =    50   757  1344
Test passed: M N K =  1568  1681   768
Test passed: M N K =   648  1699   320
Test passed: M N K =   453  1989   448
M N K =  1024  1024   256, Elapsed time =   0.002417 s, Result = 0a0be000, Performance =   2.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002975 s, Result = 0a0dc000, Performance =   3.61 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003282 s, Result = 0a0fa000, Performance =   4.91 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003706 s, Result = 0a118000, Performance =   5.79 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004013 s, Result = 0a136000, Performance =   6.69 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004434 s, Result = 0a154000, Performance =   7.26 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004748 s, Result = 0a172000, Performance =   7.91 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005455 s, Result = 0a190000, Performance =   7.87 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005425 s, Result = 0a1ae000, Performance =   8.91 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005817 s, Result = 0a1cc000, Performance =   9.23 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006012 s, Result = 0a1ea000, Performance =   9.82 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006359 s, Result = 0a208000, Performance =  10.13 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006635 s, Result = 0a226000, Performance =  10.52 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007075 s, Result = 0a244000, Performance =  10.62 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007835 s, Result = 0a262000, Performance =  10.28 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007765 s, Result = 0a280000, Performance =  11.06 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008040 s, Result = 0a29e000, Performance =  11.35 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008464 s, Result = 0a2bc000, Performance =  11.42 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008832 s, Result = 0a2da000, Performance =  11.55 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009045 s, Result = 0a2f8000, Performance =  11.87 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009394 s, Result = 0a316000, Performance =  12.00 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009680 s, Result = 0a334000, Performance =  12.20 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010134 s, Result = 0a352000, Performance =  12.18 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010834 s, Result = 0a370000, Performance =  11.89 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010822 s, Result = 0a38e000, Performance =  12.40 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011139 s, Result = 0a3ac000, Performance =  12.53 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.011466 s, Result = 0a3ca000, Performance =  12.64 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011769 s, Result = 0a3e8000, Performance =  12.77 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012922 s, Result = 0a406000, Performance =  12.05 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012628 s, Result = 0a424000, Performance =  12.75 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012879 s, Result = 0a442000, Performance =  12.92 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013561 s, Result = 0a460000, Performance =  12.67 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014704 s, Result = 0a47e000, Performance =  12.05 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014629 s, Result = 0a49c000, Performance =  12.48 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015070 s, Result = 0a4ba000, Performance =  12.47 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015856 s, Result = 0a4d8000, Performance =  12.19 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015779 s, Result = 0a4f6000, Performance =  12.59 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016181 s, Result = 0a514000, Performance =  12.61 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016371 s, Result = 0a532000, Performance =  12.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.016888 s, Result = 0a550000, Performance =  12.72 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017193 s, Result = 0a56e000, Performance =  12.80 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017782 s, Result = 0a58c000, Performance =  12.68 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018064 s, Result = 0a5aa000, Performance =  12.78 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018403 s, Result = 0a5c8000, Performance =  12.84 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018658 s, Result = 0a5e6000, Performance =  12.95 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019023 s, Result = 0a604000, Performance =  12.98 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019682 s, Result = 0a622000, Performance =  12.82 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020320 s, Result = 0a640000, Performance =  12.68 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020465 s, Result = 0a65e000, Performance =  12.85 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020209 s, Result = 0a67c000, Performance =  13.28 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021182 s, Result = 0a69a000, Performance =  12.93 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021503 s, Result = 0a6b8000, Performance =  12.98 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021616 s, Result = 0a6d6000, Performance =  13.16 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.021394 s, Result = 0a6f4000, Performance =  13.55 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.021935 s, Result = 0a712000, Performance =  13.46 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.022710 s, Result = 0a730000, Performance =  13.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022760 s, Result = 0a74e000, Performance =  13.45 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.023093 s, Result = 0a76c000, Performance =  13.48 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024223 s, Result = 0a78a000, Performance =  13.08 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024696 s, Result = 0a7a8000, Performance =  13.04 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024200 s, Result = 0a7c6000, Performance =  13.53 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024588 s, Result = 0a7e4000, Performance =  13.54 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.025376 s, Result = 0a802000, Performance =  13.33 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.026637 s, Result = 0a820000, Performance =  12.90 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   550  1028  1856
Test passed: M N K =     7  1713   768
Test passed: M N K =   872   481  1088
Test passed: M N K =  1808   614  1920
Test passed: M N K =   808   634   640
M N K =  1024  1024   256, Elapsed time =   0.000275 s, Result = 0001e000, Performance =  19.53 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000649 s, Result = 0003c000, Performance =  16.53 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001232 s, Result = 0005a000, Performance =  13.08 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001638 s, Result = 00078000, Performance =  13.11 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002016 s, Result = 00096000, Performance =  13.31 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002260 s, Result = 000b4000, Performance =  14.25 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002709 s, Result = 000d2000, Performance =  13.87 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003477 s, Result = 000f0000, Performance =  12.35 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003683 s, Result = 0010e000, Performance =  13.12 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004247 s, Result = 0012c000, Performance =  12.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.004712 s, Result = 0014a000, Performance =  12.53 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005070 s, Result = 00168000, Performance =  12.71 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.005453 s, Result = 00186000, Performance =  12.80 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006334 s, Result = 001a4000, Performance =  11.87 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.006679 s, Result = 001c2000, Performance =  12.06 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.006779 s, Result = 001e0000, Performance =  12.67 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.007692 s, Result = 001fe000, Performance =  11.87 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.007991 s, Result = 0021c000, Performance =  12.09 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008249 s, Result = 0023a000, Performance =  12.37 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.008422 s, Result = 00258000, Performance =  12.75 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009190 s, Result = 00276000, Performance =  12.27 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009323 s, Result = 00294000, Performance =  12.67 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010147 s, Result = 002b2000, Performance =  12.17 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010491 s, Result = 002d0000, Performance =  12.28 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010835 s, Result = 002ee000, Performance =  12.39 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011455 s, Result = 0030c000, Performance =  12.19 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.011659 s, Result = 0032a000, Performance =  12.43 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011852 s, Result = 00348000, Performance =  12.68 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012342 s, Result = 00366000, Performance =  12.61 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012540 s, Result = 00384000, Performance =  12.84 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012784 s, Result = 003a2000, Performance =  13.02 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013902 s, Result = 003c0000, Performance =  12.36 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.013984 s, Result = 003de000, Performance =  12.67 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014073 s, Result = 003fc000, Performance =  12.97 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015228 s, Result = 0041a000, Performance =  12.34 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015190 s, Result = 00438000, Performance =  12.72 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015699 s, Result = 00456000, Performance =  12.65 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016644 s, Result = 00474000, Performance =  12.26 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016545 s, Result = 00492000, Performance =  12.66 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.015848 s, Result = 004b0000, Performance =  13.55 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017568 s, Result = 004ce000, Performance =  12.53 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017286 s, Result = 004ec000, Performance =  13.04 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018124 s, Result = 0050a000, Performance =  12.74 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018060 s, Result = 00528000, Performance =  13.08 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.019380 s, Result = 00546000, Performance =  12.47 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019298 s, Result = 00564000, Performance =  12.80 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019295 s, Result = 00582000, Performance =  13.08 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020307 s, Result = 005a0000, Performance =  12.69 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020880 s, Result = 005be000, Performance =  12.60 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020961 s, Result = 005dc000, Performance =  12.81 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.020410 s, Result = 005fa000, Performance =  13.42 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.022272 s, Result = 00618000, Performance =  12.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022097 s, Result = 00636000, Performance =  12.88 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022636 s, Result = 00654000, Performance =  12.81 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022514 s, Result = 00672000, Performance =  13.12 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.023015 s, Result = 00690000, Performance =  13.06 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022989 s, Result = 006ae000, Performance =  13.31 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024284 s, Result = 006cc000, Performance =  12.82 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024856 s, Result = 006ea000, Performance =  12.74 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024233 s, Result = 00708000, Performance =  13.29 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024779 s, Result = 00726000, Performance =  13.22 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.026148 s, Result = 00744000, Performance =  12.73 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.025835 s, Result = 00762000, Performance =  13.09 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025895 s, Result = 00780000, Performance =  13.27 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   593  1531  1984
Test passed: M N K =   676   854   640
Test passed: M N K =   244  1355   576
Test passed: M N K =  1191   949  1984
Test passed: M N K =  1738  1066   896
M N K =  1024  1024   256, Elapsed time =   0.004790 s, Result = 5902e000, Performance =   1.12 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005942 s, Result = 3104c000, Performance =   1.81 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006403 s, Result = 0906a000, Performance =   2.52 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006909 s, Result = e1088000, Performance =   3.11 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008092 s, Result = b90a6000, Performance =   3.32 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007748 s, Result = 910c4000, Performance =   4.16 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008035 s, Result = 690e2000, Performance =   4.68 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009223 s, Result = 41100000, Performance =   4.66 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009472 s, Result = 1911e000, Performance =   5.10 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009798 s, Result = f113c000, Performance =   5.48 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010088 s, Result = c915a000, Performance =   5.85 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010600 s, Result = a1178000, Performance =   6.08 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010753 s, Result = 79196000, Performance =   6.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011993 s, Result = 511b4000, Performance =   6.27 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011471 s, Result = 291d2000, Performance =   7.02 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012497 s, Result = 011f0000, Performance =   6.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011889 s, Result = d920e000, Performance =   7.68 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013215 s, Result = b122c000, Performance =   7.31 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014283 s, Result = 8924a000, Performance =   7.14 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013504 s, Result = 61268000, Performance =   7.95 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013945 s, Result = 39286000, Performance =   8.08 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016330 s, Result = 112a4000, Performance =   7.23 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016307 s, Result = e92c2000, Performance =   7.57 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016500 s, Result = c12e0000, Performance =   7.81 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016629 s, Result = 992fe000, Performance =   8.07 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017660 s, Result = 7131c000, Performance =   7.90 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018100 s, Result = 4933a000, Performance =   8.01 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018493 s, Result = 21358000, Performance =   8.13 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018842 s, Result = f9376000, Performance =   8.26 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018413 s, Result = d1394000, Performance =   8.75 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.018715 s, Result = a93b2000, Performance =   8.89 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020420 s, Result = 813d0000, Performance =   8.41 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020684 s, Result = 593ee000, Performance =   8.57 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021006 s, Result = 3140c000, Performance =   8.69 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021010 s, Result = 0942a000, Performance =   8.94 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021447 s, Result = e1448000, Performance =   9.01 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.021285 s, Result = b9466000, Performance =   9.33 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022157 s, Result = 91484000, Performance =   9.21 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.022772 s, Result = 694a2000, Performance =   9.19 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.023487 s, Result = 414c0000, Performance =   9.14 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.023583 s, Result = 194de000, Performance =   9.33 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023734 s, Result = f14fc000, Performance =   9.50 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.024609 s, Result = c951a000, Performance =   9.38 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.024391 s, Result = a1538000, Performance =   9.68 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.025467 s, Result = 79556000, Performance =   9.49 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025607 s, Result = 51574000, Performance =   9.64 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.027348 s, Result = 29592000, Performance =   9.23 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.027381 s, Result = 015b0000, Performance =   9.41 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.027163 s, Result = d95ce000, Performance =   9.68 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.027136 s, Result = b15ec000, Performance =   9.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.028300 s, Result = 8960a000, Performance =   9.68 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.027902 s, Result = 61628000, Performance =  10.01 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.028735 s, Result = 39646000, Performance =   9.90 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.029493 s, Result = 11664000, Performance =   9.83 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.029928 s, Result = e9682000, Performance =   9.87 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.030076 s, Result = c16a0000, Performance =  10.00 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.030987 s, Result = 996be000, Performance =   9.88 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030811 s, Result = 716dc000, Performance =  10.11 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.032013 s, Result = 496fa000, Performance =   9.89 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.032109 s, Result = 21718000, Performance =  10.03 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.033578 s, Result = f9736000, Performance =   9.75 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.033526 s, Result = d1754000, Performance =   9.93 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.033299 s, Result = a9772000, Performance =  10.16 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.034654 s, Result = 81790000, Performance =   9.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   830   785  1344
Test passed: M N K =  1501   591   576
Test passed: M N K =  1737  1420  1280
Test passed: M N K =   739   157   960
Test passed: M N K =   444   719  1664
M N K =  1024  1024   256, Elapsed time =   0.002793 s, Result = 0001e000, Performance =   1.92 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004278 s, Result = 0003c000, Performance =   2.51 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004545 s, Result = 0005a000, Performance =   3.54 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005530 s, Result = 00078000, Performance =   3.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005917 s, Result = 00096000, Performance =   4.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006479 s, Result = 000b4000, Performance =   4.97 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006941 s, Result = 000d2000, Performance =   5.41 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008039 s, Result = 000f0000, Performance =   5.34 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007922 s, Result = 0010e000, Performance =   6.10 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008121 s, Result = 0012c000, Performance =   6.61 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008536 s, Result = 0014a000, Performance =   6.92 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008985 s, Result = 00168000, Performance =   7.17 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011166 s, Result = 00186000, Performance =   6.25 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010255 s, Result = 001a4000, Performance =   7.33 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010091 s, Result = 001c2000, Performance =   7.98 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011387 s, Result = 001e0000, Performance =   7.54 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011699 s, Result = 001fe000, Performance =   7.80 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011190 s, Result = 0021c000, Performance =   8.64 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011555 s, Result = 0023a000, Performance =   8.83 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011813 s, Result = 00258000, Performance =   9.09 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012115 s, Result = 00276000, Performance =   9.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014202 s, Result = 00294000, Performance =   8.32 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.013500 s, Result = 002b2000, Performance =   9.15 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013911 s, Result = 002d0000, Performance =   9.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014640 s, Result = 002ee000, Performance =   9.17 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.015870 s, Result = 0030c000, Performance =   8.80 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.015073 s, Result = 0032a000, Performance =   9.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014877 s, Result = 00348000, Performance =  10.10 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.017049 s, Result = 00366000, Performance =   9.13 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015932 s, Result = 00384000, Performance =  10.11 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020746 s, Result = 003a2000, Performance =   8.02 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019420 s, Result = 003c0000, Performance =   8.85 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019720 s, Result = 003de000, Performance =   8.98 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019834 s, Result = 003fc000, Performance =   9.20 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.020916 s, Result = 0041a000, Performance =   8.98 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.020648 s, Result = 00438000, Performance =   9.36 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.020996 s, Result = 00456000, Performance =   9.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.021361 s, Result = 00474000, Performance =   9.55 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.021909 s, Result = 00492000, Performance =   9.56 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021990 s, Result = 004b0000, Performance =   9.77 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.023482 s, Result = 004ce000, Performance =   9.37 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023323 s, Result = 004ec000, Performance =   9.67 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.024299 s, Result = 0050a000, Performance =   9.50 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.023532 s, Result = 00528000, Performance =  10.04 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.024108 s, Result = 00546000, Performance =  10.02 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.024339 s, Result = 00564000, Performance =  10.15 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.024854 s, Result = 00582000, Performance =  10.15 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.026190 s, Result = 005a0000, Performance =   9.84 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.025866 s, Result = 005be000, Performance =  10.17 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.025791 s, Result = 005dc000, Performance =  10.41 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026301 s, Result = 005fa000, Performance =  10.41 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.027783 s, Result = 00618000, Performance =  10.05 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.028347 s, Result = 00636000, Performance =  10.04 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.028048 s, Result = 00654000, Performance =  10.34 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.028926 s, Result = 00672000, Performance =  10.21 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029240 s, Result = 00690000, Performance =  10.28 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.029943 s, Result = 006ae000, Performance =  10.22 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.029474 s, Result = 006cc000, Performance =  10.56 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.030779 s, Result = 006ea000, Performance =  10.29 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.031131 s, Result = 00708000, Performance =  10.35 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031895 s, Result = 00726000, Performance =  10.27 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.030953 s, Result = 00744000, Performance =  10.75 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.032780 s, Result = 00762000, Performance =  10.32 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.033485 s, Result = 00780000, Performance =  10.26 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   126  1086   576
Test passed: M N K =  1006    19  2048
Test passed: M N K =  1771   580   448
Test passed: M N K =  1105  1369   128
Test passed: M N K =   542   725  1856
M N K =  1024  1024   256, Elapsed time =   0.002431 s, Result = 0a0be000, Performance =   2.21 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003162 s, Result = 0a0dc000, Performance =   3.40 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003673 s, Result = 0a0fa000, Performance =   4.38 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004066 s, Result = 0a118000, Performance =   5.28 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004398 s, Result = 0a136000, Performance =   6.10 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004870 s, Result = 0a154000, Performance =   6.61 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005284 s, Result = 0a172000, Performance =   7.11 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006531 s, Result = 0a190000, Performance =   6.58 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006269 s, Result = 0a1ae000, Performance =   7.71 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007208 s, Result = 0a1cc000, Performance =   7.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007459 s, Result = 0a1ea000, Performance =   7.92 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008017 s, Result = 0a208000, Performance =   8.04 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008199 s, Result = 0a226000, Performance =   8.51 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008411 s, Result = 0a244000, Performance =   8.94 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008588 s, Result = 0a262000, Performance =   9.38 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010701 s, Result = 0a280000, Performance =   8.03 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010278 s, Result = 0a29e000, Performance =   8.88 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010596 s, Result = 0a2bc000, Performance =   9.12 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010826 s, Result = 0a2da000, Performance =   9.42 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011522 s, Result = 0a2f8000, Performance =   9.32 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011918 s, Result = 0a316000, Performance =   9.46 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.012297 s, Result = 0a334000, Performance =   9.60 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.013335 s, Result = 0a352000, Performance =   9.26 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013898 s, Result = 0a370000, Performance =   9.27 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014162 s, Result = 0a38e000, Performance =   9.48 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.014526 s, Result = 0a3ac000, Performance =   9.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.015039 s, Result = 0a3ca000, Performance =   9.64 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.015111 s, Result = 0a3e8000, Performance =   9.95 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015666 s, Result = 0a406000, Performance =   9.94 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.016275 s, Result = 0a424000, Performance =   9.90 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.016468 s, Result = 0a442000, Performance =  10.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.017954 s, Result = 0a460000, Performance =   9.57 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.017740 s, Result = 0a47e000, Performance =   9.99 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.017637 s, Result = 0a49c000, Performance =  10.35 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.018212 s, Result = 0a4ba000, Performance =  10.32 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018362 s, Result = 0a4d8000, Performance =  10.53 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.019078 s, Result = 0a4f6000, Performance =  10.41 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020496 s, Result = 0a514000, Performance =   9.95 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.020110 s, Result = 0a532000, Performance =  10.41 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.020571 s, Result = 0a550000, Performance =  10.44 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.020714 s, Result = 0a56e000, Performance =  10.63 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.021336 s, Result = 0a58c000, Performance =  10.57 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.022280 s, Result = 0a5aa000, Performance =  10.36 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.022328 s, Result = 0a5c8000, Performance =  10.58 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.022485 s, Result = 0a5e6000, Performance =  10.74 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.023091 s, Result = 0a604000, Performance =  10.70 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.023253 s, Result = 0a622000, Performance =  10.85 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.025393 s, Result = 0a640000, Performance =  10.15 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.024690 s, Result = 0a65e000, Performance =  10.65 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.025516 s, Result = 0a67c000, Performance =  10.52 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026252 s, Result = 0a69a000, Performance =  10.43 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.026245 s, Result = 0a6b8000, Performance =  10.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.026427 s, Result = 0a6d6000, Performance =  10.77 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.027177 s, Result = 0a6f4000, Performance =  10.67 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.026806 s, Result = 0a712000, Performance =  11.02 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.028203 s, Result = 0a730000, Performance =  10.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.028205 s, Result = 0a74e000, Performance =  10.85 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.028057 s, Result = 0a76c000, Performance =  11.10 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.029230 s, Result = 0a78a000, Performance =  10.84 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.030428 s, Result = 0a7a8000, Performance =  10.59 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.030227 s, Result = 0a7c6000, Performance =  10.83 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.030610 s, Result = 0a7e4000, Performance =  10.87 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.030742 s, Result = 0a802000, Performance =  11.00 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.032946 s, Result = 0a820000, Performance =  10.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1610  1949   448
Test passed: M N K =  1680  1660   960
Test passed: M N K =   902  1355   512
Test passed: M N K =  1036   657   384
Test passed: M N K =  1543   233  1024
M N K =  1024  1024   256, Elapsed time =   0.000287 s, Result = 0001e000, Performance =  18.70 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000773 s, Result = 0003c000, Performance =  13.90 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001257 s, Result = 0005a000, Performance =  12.81 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001711 s, Result = 00078000, Performance =  12.55 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002150 s, Result = 00096000, Performance =  12.49 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002479 s, Result = 000b4000, Performance =  12.99 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002943 s, Result = 000d2000, Performance =  12.77 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003797 s, Result = 000f0000, Performance =  11.31 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003978 s, Result = 0010e000, Performance =  12.15 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004689 s, Result = 0012c000, Performance =  11.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.004899 s, Result = 0014a000, Performance =  12.05 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005714 s, Result = 00168000, Performance =  11.27 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.005589 s, Result = 00186000, Performance =  12.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.006396 s, Result = 001a4000, Performance =  11.75 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.006544 s, Result = 001c2000, Performance =  12.31 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008214 s, Result = 001e0000, Performance =  10.46 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.006678 s, Result = 001fe000, Performance =  13.67 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.007544 s, Result = 0021c000, Performance =  12.81 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008043 s, Result = 0023a000, Performance =  12.68 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.007842 s, Result = 00258000, Performance =  13.69 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.008849 s, Result = 00276000, Performance =  12.74 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.008919 s, Result = 00294000, Performance =  13.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.009130 s, Result = 002b2000, Performance =  13.52 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010918 s, Result = 002d0000, Performance =  11.80 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010252 s, Result = 002ee000, Performance =  13.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.010364 s, Result = 0030c000, Performance =  13.47 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.010538 s, Result = 0032a000, Performance =  13.76 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011086 s, Result = 00348000, Performance =  13.56 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.011426 s, Result = 00366000, Performance =  13.63 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012578 s, Result = 00384000, Performance =  12.81 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012346 s, Result = 003a2000, Performance =  13.48 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.015317 s, Result = 003c0000, Performance =  11.22 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.012868 s, Result = 003de000, Performance =  13.77 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014398 s, Result = 003fc000, Performance =  12.68 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.013880 s, Result = 0041a000, Performance =  13.54 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.014218 s, Result = 00438000, Performance =  13.59 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.014400 s, Result = 00456000, Performance =  13.79 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.015304 s, Result = 00474000, Performance =  13.33 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016370 s, Result = 00492000, Performance =  12.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017837 s, Result = 004b0000, Performance =  12.04 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017644 s, Result = 004ce000, Performance =  12.48 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017978 s, Result = 004ec000, Performance =  12.54 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.017993 s, Result = 0050a000, Performance =  12.83 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018816 s, Result = 00528000, Performance =  12.55 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018757 s, Result = 00546000, Performance =  12.88 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019531 s, Result = 00564000, Performance =  12.64 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.018960 s, Result = 00582000, Performance =  13.31 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.023520 s, Result = 005a0000, Performance =  10.96 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020605 s, Result = 005be000, Performance =  12.77 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.021041 s, Result = 005dc000, Performance =  12.76 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.020776 s, Result = 005fa000, Performance =  13.18 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021930 s, Result = 00618000, Performance =  12.73 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022087 s, Result = 00636000, Performance =  12.88 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022247 s, Result = 00654000, Performance =  13.03 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022816 s, Result = 00672000, Performance =  12.94 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.025600 s, Result = 00690000, Performance =  11.74 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023936 s, Result = 006ae000, Performance =  12.78 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024352 s, Result = 006cc000, Performance =  12.79 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024578 s, Result = 006ea000, Performance =  12.89 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024533 s, Result = 00708000, Performance =  13.13 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025995 s, Result = 00726000, Performance =  12.60 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.025822 s, Result = 00744000, Performance =  12.89 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026237 s, Result = 00762000, Performance =  12.89 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.030565 s, Result = 00780000, Performance =  11.24 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1387  1569  1408
Test passed: M N K =   578   148   640
Test passed: M N K =  1495  1414   640
Test passed: M N K =  1869   799  1152
Test passed: M N K =   913  1745   960
M N K =  1024  1024   256, Elapsed time =   0.004775 s, Result = 5902e000, Performance =   1.12 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006033 s, Result = 3104c000, Performance =   1.78 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006335 s, Result = 0906a000, Performance =   2.54 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006375 s, Result = e1088000, Performance =   3.37 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007243 s, Result = b90a6000, Performance =   3.71 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007730 s, Result = 910c4000, Performance =   4.17 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008650 s, Result = 690e2000, Performance =   4.34 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008912 s, Result = 41100000, Performance =   4.82 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009143 s, Result = 1911e000, Performance =   5.28 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010002 s, Result = f113c000, Performance =   5.37 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010587 s, Result = c915a000, Performance =   5.58 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011263 s, Result = a1178000, Performance =   5.72 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011408 s, Result = 79196000, Performance =   6.12 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011987 s, Result = 511b4000, Performance =   6.27 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013598 s, Result = 291d2000, Performance =   5.92 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013579 s, Result = 011f0000, Performance =   6.33 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013878 s, Result = d920e000, Performance =   6.58 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014309 s, Result = b122c000, Performance =   6.75 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015360 s, Result = 8924a000, Performance =   6.64 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015211 s, Result = 61268000, Performance =   7.06 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016158 s, Result = 39286000, Performance =   6.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016690 s, Result = 112a4000, Performance =   7.08 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016327 s, Result = e92c2000, Performance =   7.56 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017259 s, Result = c12e0000, Performance =   7.47 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018677 s, Result = 992fe000, Performance =   7.19 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019317 s, Result = 7131c000, Performance =   7.23 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019863 s, Result = 4933a000, Performance =   7.30 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020177 s, Result = 21358000, Performance =   7.45 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021262 s, Result = f9376000, Performance =   7.32 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021356 s, Result = d1394000, Performance =   7.54 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021759 s, Result = a93b2000, Performance =   7.65 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.022169 s, Result = 813d0000, Performance =   7.75 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021238 s, Result = 593ee000, Performance =   8.34 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023242 s, Result = 3140c000, Performance =   7.85 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024446 s, Result = 0942a000, Performance =   7.69 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023635 s, Result = e1448000, Performance =   8.18 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024203 s, Result = b9466000, Performance =   8.21 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025854 s, Result = 91484000, Performance =   7.89 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025788 s, Result = 694a2000, Performance =   8.12 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025572 s, Result = 414c0000, Performance =   8.40 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027177 s, Result = 194de000, Performance =   8.10 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027735 s, Result = f14fc000, Performance =   8.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028241 s, Result = c951a000, Performance =   8.17 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.027994 s, Result = a1538000, Performance =   8.44 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028774 s, Result = 79556000, Performance =   8.40 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030013 s, Result = 51574000, Performance =   8.23 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030188 s, Result = 29592000, Performance =   8.36 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030111 s, Result = 015b0000, Performance =   8.56 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031312 s, Result = d95ce000, Performance =   8.40 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032019 s, Result = b15ec000, Performance =   8.38 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032744 s, Result = 8960a000, Performance =   8.36 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032311 s, Result = 61628000, Performance =   8.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033635 s, Result = 39646000, Performance =   8.46 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033207 s, Result = 11664000, Performance =   8.73 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033835 s, Result = e9682000, Performance =   8.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034979 s, Result = c16a0000, Performance =   8.60 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035884 s, Result = 996be000, Performance =   8.53 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036221 s, Result = 716dc000, Performance =   8.60 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.037036 s, Result = 496fa000, Performance =   8.55 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036824 s, Result = 21718000, Performance =   8.75 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.037846 s, Result = f9736000, Performance =   8.65 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038021 s, Result = d1754000, Performance =   8.75 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039258 s, Result = a9772000, Performance =   8.62 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038787 s, Result = 81790000, Performance =   8.86 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   170   996  1088
Test passed: M N K =  1168   254  1664
Test passed: M N K =   562   816   512
Test passed: M N K =   163   246   192
Test passed: M N K =  1947   936  2048
M N K =  1024  1024   256, Elapsed time =   0.002768 s, Result = 0001e000, Performance =   1.94 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003480 s, Result = 0003c000, Performance =   3.09 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005358 s, Result = 0005a000, Performance =   3.01 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005120 s, Result = 00078000, Performance =   4.19 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005811 s, Result = 00096000, Performance =   4.62 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006601 s, Result = 000b4000, Performance =   4.88 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007596 s, Result = 000d2000, Performance =   4.95 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008285 s, Result = 000f0000, Performance =   5.18 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008072 s, Result = 0010e000, Performance =   5.99 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008403 s, Result = 0012c000, Performance =   6.39 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009080 s, Result = 0014a000, Performance =   6.50 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009512 s, Result = 00168000, Performance =   6.77 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010028 s, Result = 00186000, Performance =   6.96 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010479 s, Result = 001a4000, Performance =   7.17 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011131 s, Result = 001c2000, Performance =   7.23 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012068 s, Result = 001e0000, Performance =   7.12 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012330 s, Result = 001fe000, Performance =   7.40 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012750 s, Result = 0021c000, Performance =   7.58 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013602 s, Result = 0023a000, Performance =   7.50 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014179 s, Result = 00258000, Performance =   7.57 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014964 s, Result = 00276000, Performance =   7.53 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015590 s, Result = 00294000, Performance =   7.58 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016269 s, Result = 002b2000, Performance =   7.59 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016174 s, Result = 002d0000, Performance =   7.97 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017111 s, Result = 002ee000, Performance =   7.84 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018022 s, Result = 0030c000, Performance =   7.75 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018150 s, Result = 0032a000, Performance =   7.99 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018285 s, Result = 00348000, Performance =   8.22 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018954 s, Result = 00366000, Performance =   8.21 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019682 s, Result = 00384000, Performance =   8.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019421 s, Result = 003a2000, Performance =   8.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.019650 s, Result = 003c0000, Performance =   8.74 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020695 s, Result = 003de000, Performance =   8.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021085 s, Result = 003fc000, Performance =   8.66 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022729 s, Result = 0041a000, Performance =   8.27 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.022376 s, Result = 00438000, Performance =   8.64 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023051 s, Result = 00456000, Performance =   8.62 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022951 s, Result = 00474000, Performance =   8.89 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024953 s, Result = 00492000, Performance =   8.39 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.023779 s, Result = 004b0000, Performance =   9.03 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.025266 s, Result = 004ce000, Performance =   8.71 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026093 s, Result = 004ec000, Performance =   8.64 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027049 s, Result = 0050a000, Performance =   8.53 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.026735 s, Result = 00528000, Performance =   8.84 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027377 s, Result = 00546000, Performance =   8.82 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.027573 s, Result = 00564000, Performance =   8.96 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029034 s, Result = 00582000, Performance =   8.69 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.028428 s, Result = 005a0000, Performance =   9.06 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030066 s, Result = 005be000, Performance =   8.75 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.030461 s, Result = 005dc000, Performance =   8.81 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031378 s, Result = 005fa000, Performance =   8.73 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.031177 s, Result = 00618000, Performance =   8.95 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.031834 s, Result = 00636000, Performance =   8.94 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031751 s, Result = 00654000, Performance =   9.13 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033220 s, Result = 00672000, Performance =   8.89 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.033303 s, Result = 00690000, Performance =   9.03 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034370 s, Result = 006ae000, Performance =   8.90 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.034415 s, Result = 006cc000, Performance =   9.05 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.033968 s, Result = 006ea000, Performance =   9.33 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.035725 s, Result = 00708000, Performance =   9.02 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.036460 s, Result = 00726000, Performance =   8.98 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036785 s, Result = 00744000, Performance =   9.05 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.036687 s, Result = 00762000, Performance =   9.22 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.037406 s, Result = 00780000, Performance =   9.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   865  1019   768
Test passed: M N K =  1725  1026  1664
Test passed: M N K =   582    75   896
Test passed: M N K =   999   288   192
Test passed: M N K =  1570   825   320
M N K =  1024  1024   256, Elapsed time =   0.002419 s, Result = 0a0be000, Performance =   2.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003125 s, Result = 0a0dc000, Performance =   3.44 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003511 s, Result = 0a0fa000, Performance =   4.59 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003840 s, Result = 0a118000, Performance =   5.59 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004407 s, Result = 0a136000, Performance =   6.09 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005096 s, Result = 0a154000, Performance =   6.32 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005410 s, Result = 0a172000, Performance =   6.95 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006113 s, Result = 0a190000, Performance =   7.03 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006414 s, Result = 0a1ae000, Performance =   7.53 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007177 s, Result = 0a1cc000, Performance =   7.48 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008019 s, Result = 0a1ea000, Performance =   7.36 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008363 s, Result = 0a208000, Performance =   7.70 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008756 s, Result = 0a226000, Performance =   7.97 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009222 s, Result = 0a244000, Performance =   8.15 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009653 s, Result = 0a262000, Performance =   8.34 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010927 s, Result = 0a280000, Performance =   7.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010856 s, Result = 0a29e000, Performance =   8.41 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011311 s, Result = 0a2bc000, Performance =   8.54 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012311 s, Result = 0a2da000, Performance =   8.29 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013491 s, Result = 0a2f8000, Performance =   7.96 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013468 s, Result = 0a316000, Performance =   8.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014003 s, Result = 0a334000, Performance =   8.43 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015170 s, Result = 0a352000, Performance =   8.14 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015335 s, Result = 0a370000, Performance =   8.40 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014540 s, Result = 0a38e000, Performance =   9.23 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.015450 s, Result = 0a3ac000, Performance =   9.03 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016658 s, Result = 0a3ca000, Performance =   8.70 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017040 s, Result = 0a3e8000, Performance =   8.82 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018238 s, Result = 0a406000, Performance =   8.54 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018726 s, Result = 0a424000, Performance =   8.60 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.017528 s, Result = 0a442000, Performance =   9.50 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.018975 s, Result = 0a460000, Performance =   9.05 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020239 s, Result = 0a47e000, Performance =   8.75 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.020281 s, Result = 0a49c000, Performance =   9.00 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.020486 s, Result = 0a4ba000, Performance =   9.17 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021538 s, Result = 0a4d8000, Performance =   8.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022503 s, Result = 0a4f6000, Performance =   8.83 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022103 s, Result = 0a514000, Performance =   9.23 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.022880 s, Result = 0a532000, Performance =   9.15 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.022313 s, Result = 0a550000, Performance =   9.62 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.024250 s, Result = 0a56e000, Performance =   9.08 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.025461 s, Result = 0a58c000, Performance =   8.86 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.025951 s, Result = 0a5aa000, Performance =   8.90 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.025910 s, Result = 0a5c8000, Performance =   9.12 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.026983 s, Result = 0a5e6000, Performance =   8.95 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.027452 s, Result = 0a604000, Performance =   9.00 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.027887 s, Result = 0a622000, Performance =   9.05 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.027379 s, Result = 0a640000, Performance =   9.41 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.029139 s, Result = 0a65e000, Performance =   9.03 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.029877 s, Result = 0a67c000, Performance =   8.98 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.029588 s, Result = 0a69a000, Performance =   9.25 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030394 s, Result = 0a6b8000, Performance =   9.19 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.030898 s, Result = 0a6d6000, Performance =   9.21 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.032049 s, Result = 0a6f4000, Performance =   9.05 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.032872 s, Result = 0a712000, Performance =   8.98 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.032542 s, Result = 0a730000, Performance =   9.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.033805 s, Result = 0a74e000, Performance =   9.05 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.034391 s, Result = 0a76c000, Performance =   9.05 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.034494 s, Result = 0a78a000, Performance =   9.18 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.034725 s, Result = 0a7a8000, Performance =   9.28 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.035594 s, Result = 0a7c6000, Performance =   9.20 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036400 s, Result = 0a7e4000, Performance =   9.14 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.036551 s, Result = 0a802000, Performance =   9.25 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.035780 s, Result = 0a820000, Performance =   9.60 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   201   177  1984
Test passed: M N K =   822    46   448
Test passed: M N K =  2005   896  1408
Test passed: M N K =   830  1470   896
Test passed: M N K =  1256  1328   704
M N K =  1024  1024   256, Elapsed time =   0.000276 s, Result = 0001e000, Performance =  19.43 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000670 s, Result = 0003c000, Performance =  16.03 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001212 s, Result = 0005a000, Performance =  13.29 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001613 s, Result = 00078000, Performance =  13.31 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002094 s, Result = 00096000, Performance =  12.82 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002404 s, Result = 000b4000, Performance =  13.40 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002978 s, Result = 000d2000, Performance =  12.62 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.003646 s, Result = 000f0000, Performance =  11.78 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003954 s, Result = 0010e000, Performance =  12.22 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.004957 s, Result = 0012c000, Performance =  10.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005592 s, Result = 0014a000, Performance =  10.56 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005575 s, Result = 00168000, Performance =  11.56 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006353 s, Result = 00186000, Performance =  10.99 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007055 s, Result = 001a4000, Performance =  10.65 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007698 s, Result = 001c2000, Performance =  10.46 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008229 s, Result = 001e0000, Performance =  10.44 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008699 s, Result = 001fe000, Performance =  10.49 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009329 s, Result = 0021c000, Performance =  10.36 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010243 s, Result = 0023a000, Performance =   9.96 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010235 s, Result = 00258000, Performance =  10.49 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011240 s, Result = 00276000, Performance =  10.03 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011517 s, Result = 00294000, Performance =  10.26 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012367 s, Result = 002b2000, Performance =   9.98 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012669 s, Result = 002d0000, Performance =  10.17 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013383 s, Result = 002ee000, Performance =  10.03 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013967 s, Result = 0030c000, Performance =   9.99 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014793 s, Result = 0032a000, Performance =   9.80 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014924 s, Result = 00348000, Performance =  10.07 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015532 s, Result = 00366000, Performance =  10.02 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015712 s, Result = 00384000, Performance =  10.25 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015667 s, Result = 003a2000, Performance =  10.62 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016968 s, Result = 003c0000, Performance =  10.12 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.017106 s, Result = 003de000, Performance =  10.36 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016611 s, Result = 003fc000, Performance =  10.99 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017957 s, Result = 0041a000, Performance =  10.46 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018842 s, Result = 00438000, Performance =  10.26 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.019758 s, Result = 00456000, Performance =  10.05 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020372 s, Result = 00474000, Performance =  10.01 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.020549 s, Result = 00492000, Performance =  10.19 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021141 s, Result = 004b0000, Performance =  10.16 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.022047 s, Result = 004ce000, Performance =   9.98 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.022478 s, Result = 004ec000, Performance =  10.03 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.023543 s, Result = 0050a000, Performance =   9.81 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.023116 s, Result = 00528000, Performance =  10.22 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.023536 s, Result = 00546000, Performance =  10.26 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.024550 s, Result = 00564000, Performance =  10.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.025560 s, Result = 00582000, Performance =   9.87 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.024347 s, Result = 005a0000, Performance =  10.58 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.026206 s, Result = 005be000, Performance =  10.04 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.026658 s, Result = 005dc000, Performance =  10.07 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.026403 s, Result = 005fa000, Performance =  10.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.027801 s, Result = 00618000, Performance =  10.04 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.028515 s, Result = 00636000, Performance =   9.98 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.028776 s, Result = 00654000, Performance =  10.07 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.029218 s, Result = 00672000, Performance =  10.11 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029781 s, Result = 00690000, Performance =  10.10 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.029781 s, Result = 006ae000, Performance =  10.28 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.030240 s, Result = 006cc000, Performance =  10.30 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.029747 s, Result = 006ea000, Performance =  10.65 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.030476 s, Result = 00708000, Performance =  10.57 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.032768 s, Result = 00726000, Performance =   9.99 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.032158 s, Result = 00744000, Performance =  10.35 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.034240 s, Result = 00762000, Performance =   9.88 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.032446 s, Result = 00780000, Performance =  10.59 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1390   882   704
Test passed: M N K =   756  1175  1408
Test passed: M N K =  1453   642   512
Test passed: M N K =   502  1716  1984
Test passed: M N K =   341   256  1856
M N K =  1024  1024   256, Elapsed time =   0.003867 s, Result = 21024000, Performance =   1.39 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005045 s, Result = 41038000, Performance =   2.13 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004888 s, Result = 6104c000, Performance =   3.30 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005639 s, Result = 81060000, Performance =   3.81 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005624 s, Result = a1074000, Performance =   4.77 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006654 s, Result = c1088000, Performance =   4.84 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006243 s, Result = e109c000, Performance =   6.02 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007041 s, Result = 010b0000, Performance =   6.10 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006854 s, Result = 210c4000, Performance =   7.05 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007311 s, Result = 410d8000, Performance =   7.34 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007545 s, Result = 610ec000, Performance =   7.83 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008585 s, Result = 81100000, Performance =   7.50 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008137 s, Result = a1114000, Performance =   8.58 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009248 s, Result = c1128000, Performance =   8.13 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009073 s, Result = e113c000, Performance =   8.88 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009967 s, Result = 01150000, Performance =   8.62 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009633 s, Result = 21164000, Performance =   9.47 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010130 s, Result = 41178000, Performance =   9.54 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010204 s, Result = 6118c000, Performance =  10.00 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010162 s, Result = 811a0000, Performance =  10.57 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.010411 s, Result = a11b4000, Performance =  10.83 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.010928 s, Result = c11c8000, Performance =  10.81 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.011374 s, Result = e11dc000, Performance =  10.86 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.011077 s, Result = 011f0000, Performance =  11.63 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.012057 s, Result = 21204000, Performance =  11.13 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.012025 s, Result = 41218000, Performance =  11.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012510 s, Result = 6122c000, Performance =  11.59 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013056 s, Result = 81240000, Performance =  11.51 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.013173 s, Result = a1254000, Performance =  11.82 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.013357 s, Result = c1268000, Performance =  12.06 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.014320 s, Result = e127c000, Performance =  11.62 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014609 s, Result = 01290000, Performance =  11.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015238 s, Result = 212a4000, Performance =  11.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.015451 s, Result = 412b8000, Performance =  11.81 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015732 s, Result = 612cc000, Performance =  11.94 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015069 s, Result = 812e0000, Performance =  12.83 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015811 s, Result = a12f4000, Performance =  12.56 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.015712 s, Result = c1308000, Performance =  12.98 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.016528 s, Result = e131c000, Performance =  12.67 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.015125 s, Result = 01330000, Performance =  14.20 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017383 s, Result = 21344000, Performance =  12.66 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017714 s, Result = 41358000, Performance =  12.73 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.017745 s, Result = 6136c000, Performance =  13.01 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.017783 s, Result = 81380000, Performance =  13.28 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018715 s, Result = a1394000, Performance =  12.91 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.018859 s, Result = c13a8000, Performance =  13.09 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020041 s, Result = e13bc000, Performance =  12.59 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.018354 s, Result = 013d0000, Performance =  14.04 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.019973 s, Result = 213e4000, Performance =  13.17 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.019957 s, Result = 413f8000, Performance =  13.45 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.019609 s, Result = 6140c000, Performance =  13.96 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.019672 s, Result = 81420000, Performance =  14.19 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.019645 s, Result = a1434000, Performance =  14.48 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.020814 s, Result = c1448000, Performance =  13.93 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.020694 s, Result = e145c000, Performance =  14.27 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.020762 s, Result = 01470000, Performance =  14.48 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.021276 s, Result = 21484000, Performance =  14.38 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.022685 s, Result = 41498000, Performance =  13.73 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.021763 s, Result = 614ac000, Performance =  14.55 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.021848 s, Result = 814c0000, Performance =  14.74 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024617 s, Result = a14d4000, Performance =  13.30 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.023946 s, Result = c14e8000, Performance =  13.90 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.024027 s, Result = e14fc000, Performance =  14.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.023244 s, Result = 01510000, Performance =  14.78 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   582   762  1152
Test passed: M N K =    58   609  1792
Test passed: M N K =  1139  1522  1792
Test passed: M N K =   109   716  1280
Test passed: M N K =   953   618  1536
M N K =  1024  1024   256, Elapsed time =   0.002229 s, Result = 00014000, Performance =   2.41 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002892 s, Result = 00028000, Performance =   3.71 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003983 s, Result = 0003c000, Performance =   4.04 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004595 s, Result = 00050000, Performance =   4.67 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004940 s, Result = 00064000, Performance =   5.43 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004790 s, Result = 00078000, Performance =   6.72 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004886 s, Result = 0008c000, Performance =   7.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006324 s, Result = 000a0000, Performance =   6.79 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005461 s, Result = 000b4000, Performance =   8.85 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006868 s, Result = 000c8000, Performance =   7.82 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006194 s, Result = 000dc000, Performance =   9.53 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006694 s, Result = 000f0000, Performance =   9.62 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006840 s, Result = 00104000, Performance =  10.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007421 s, Result = 00118000, Performance =  10.13 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007585 s, Result = 0012c000, Performance =  10.62 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008321 s, Result = 00140000, Performance =  10.32 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008011 s, Result = 00154000, Performance =  11.39 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008291 s, Result = 00168000, Performance =  11.65 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009451 s, Result = 0017c000, Performance =  10.79 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009951 s, Result = 00190000, Performance =  10.79 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009913 s, Result = 001a4000, Performance =  11.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.010487 s, Result = 001b8000, Performance =  11.26 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010516 s, Result = 001cc000, Performance =  11.74 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010862 s, Result = 001e0000, Performance =  11.86 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.011588 s, Result = 001f4000, Performance =  11.58 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.010923 s, Result = 00208000, Performance =  12.78 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012656 s, Result = 0021c000, Performance =  11.45 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.012270 s, Result = 00230000, Performance =  12.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012770 s, Result = 00244000, Performance =  12.19 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012740 s, Result = 00258000, Performance =  12.64 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013169 s, Result = 0026c000, Performance =  12.64 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.012622 s, Result = 00280000, Performance =  13.61 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014052 s, Result = 00294000, Performance =  12.61 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.013371 s, Result = 002a8000, Performance =  13.65 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.014311 s, Result = 002bc000, Performance =  13.13 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.013108 s, Result = 002d0000, Performance =  14.75 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.014805 s, Result = 002e4000, Performance =  13.42 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.014625 s, Result = 002f8000, Performance =  13.95 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.014995 s, Result = 0030c000, Performance =  13.96 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.015164 s, Result = 00320000, Performance =  14.16 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.015617 s, Result = 00334000, Performance =  14.09 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.015650 s, Result = 00348000, Performance =  14.41 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.016864 s, Result = 0035c000, Performance =  13.69 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.016908 s, Result = 00370000, Performance =  13.97 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.017377 s, Result = 00384000, Performance =  13.90 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.016844 s, Result = 00398000, Performance =  14.66 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.017344 s, Result = 003ac000, Performance =  14.55 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.017563 s, Result = 003c0000, Performance =  14.67 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.017671 s, Result = 003d4000, Performance =  14.89 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.018929 s, Result = 003e8000, Performance =  14.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.018900 s, Result = 003fc000, Performance =  14.49 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.018009 s, Result = 00410000, Performance =  15.50 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.020905 s, Result = 00424000, Performance =  13.61 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.019977 s, Result = 00438000, Performance =  14.51 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.019695 s, Result = 0044c000, Performance =  14.99 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.019822 s, Result = 00460000, Performance =  15.17 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.021222 s, Result = 00474000, Performance =  14.42 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.021120 s, Result = 00488000, Performance =  14.74 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.021651 s, Result = 0049c000, Performance =  14.63 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.020251 s, Result = 004b0000, Performance =  15.91 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.021614 s, Result = 004c4000, Performance =  15.15 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.021890 s, Result = 004d8000, Performance =  15.21 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.022428 s, Result = 004ec000, Performance =  15.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.021405 s, Result = 00500000, Performance =  16.05 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    50   293  1664
Test passed: M N K =  1861  2010  1984
Test passed: M N K =   212  1958   640
Test passed: M N K =   988     4  1408
Test passed: M N K =   331  1475  1024
M N K =  1024  1024   256, Elapsed time =   0.001997 s, Result = 0a0b4000, Performance =   2.69 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002465 s, Result = 0a0c8000, Performance =   4.36 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003074 s, Result = 0a0dc000, Performance =   5.24 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003363 s, Result = 0a0f0000, Performance =   6.39 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003818 s, Result = 0a104000, Performance =   7.03 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003915 s, Result = 0a118000, Performance =   8.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004164 s, Result = 0a12c000, Performance =   9.03 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004701 s, Result = 0a140000, Performance =   9.14 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004717 s, Result = 0a154000, Performance =  10.24 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005061 s, Result = 0a168000, Performance =  10.61 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005561 s, Result = 0a17c000, Performance =  10.62 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.005908 s, Result = 0a190000, Performance =  10.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006395 s, Result = 0a1a4000, Performance =  10.91 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007003 s, Result = 0a1b8000, Performance =  10.73 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007254 s, Result = 0a1cc000, Performance =  11.10 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007531 s, Result = 0a1e0000, Performance =  11.41 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008028 s, Result = 0a1f4000, Performance =  11.37 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008243 s, Result = 0a208000, Performance =  11.72 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008887 s, Result = 0a21c000, Performance =  11.48 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.008801 s, Result = 0a230000, Performance =  12.20 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.008488 s, Result = 0a244000, Performance =  13.28 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009339 s, Result = 0a258000, Performance =  12.65 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010357 s, Result = 0a26c000, Performance =  11.92 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010513 s, Result = 0a280000, Performance =  12.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.011254 s, Result = 0a294000, Performance =  11.93 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.012000 s, Result = 0a2a8000, Performance =  11.63 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.011699 s, Result = 0a2bc000, Performance =  12.39 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.012193 s, Result = 0a2d0000, Performance =  12.33 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012775 s, Result = 0a2e4000, Performance =  12.19 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012670 s, Result = 0a2f8000, Performance =  12.71 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012987 s, Result = 0a30c000, Performance =  12.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.011828 s, Result = 0a320000, Performance =  14.53 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.011255 s, Result = 0a334000, Performance =  15.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.012455 s, Result = 0a348000, Performance =  14.66 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.012735 s, Result = 0a35c000, Performance =  14.75 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.013380 s, Result = 0a370000, Performance =  14.44 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.015329 s, Result = 0a384000, Performance =  12.96 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.015781 s, Result = 0a398000, Performance =  12.93 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.015594 s, Result = 0a3ac000, Performance =  13.43 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.014172 s, Result = 0a3c0000, Performance =  15.15 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.014829 s, Result = 0a3d4000, Performance =  14.84 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.015719 s, Result = 0a3e8000, Performance =  14.34 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.016175 s, Result = 0a3fc000, Performance =  14.27 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.016512 s, Result = 0a410000, Performance =  14.31 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.017419 s, Result = 0a424000, Performance =  13.87 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019100 s, Result = 0a438000, Performance =  12.93 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.018978 s, Result = 0a44c000, Performance =  13.30 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.016895 s, Result = 0a460000, Performance =  15.25 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.017311 s, Result = 0a474000, Performance =  15.20 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.018890 s, Result = 0a488000, Performance =  14.21 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.019050 s, Result = 0a49c000, Performance =  14.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.018413 s, Result = 0a4b0000, Performance =  15.16 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.019364 s, Result = 0a4c4000, Performance =  14.69 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.018603 s, Result = 0a4d8000, Performance =  15.58 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.019697 s, Result = 0a4ec000, Performance =  14.99 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.019339 s, Result = 0a500000, Performance =  15.55 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.020379 s, Result = 0a514000, Performance =  15.02 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.019667 s, Result = 0a528000, Performance =  15.83 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.021211 s, Result = 0a53c000, Performance =  14.93 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.021572 s, Result = 0a550000, Performance =  14.93 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.020898 s, Result = 0a564000, Performance =  15.67 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.022539 s, Result = 0a578000, Performance =  14.77 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.022496 s, Result = 0a58c000, Performance =  15.03 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.022490 s, Result = 0a5a0000, Performance =  15.28 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   402  2024  1792
Test passed: M N K =  1132   382  1344
Test passed: M N K =  1294   104   320
Test passed: M N K =  1522  1598  1472
Test passed: M N K =   611  1481  1728
M N K =  1024  1024   256, Elapsed time =   0.000245 s, Result = 00014000, Performance =  21.95 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000757 s, Result = 00028000, Performance =  14.18 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001103 s, Result = 0003c000, Performance =  14.60 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001405 s, Result = 00050000, Performance =  15.29 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.001622 s, Result = 00064000, Performance =  16.55 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.001915 s, Result = 00078000, Performance =  16.82 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002305 s, Result = 0008c000, Performance =  16.31 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.002672 s, Result = 000a0000, Performance =  16.07 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.002945 s, Result = 000b4000, Performance =  16.41 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.003418 s, Result = 000c8000, Performance =  15.71 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.004303 s, Result = 000dc000, Performance =  13.73 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.004282 s, Result = 000f0000, Performance =  15.05 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.004693 s, Result = 00104000, Performance =  14.87 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.005182 s, Result = 00118000, Performance =  14.50 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.005851 s, Result = 0012c000, Performance =  13.76 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.006354 s, Result = 00140000, Performance =  13.52 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.006906 s, Result = 00154000, Performance =  13.21 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.006461 s, Result = 00168000, Performance =  14.96 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.007059 s, Result = 0017c000, Performance =  14.45 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.008076 s, Result = 00190000, Performance =  13.30 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.007436 s, Result = 001a4000, Performance =  15.16 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.008616 s, Result = 001b8000, Performance =  13.71 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.009854 s, Result = 001cc000, Performance =  12.53 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010368 s, Result = 001e0000, Performance =  12.43 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010003 s, Result = 001f4000, Performance =  13.42 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.009566 s, Result = 00208000, Performance =  14.59 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.010506 s, Result = 0021c000, Performance =  13.80 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.010577 s, Result = 00230000, Performance =  14.21 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.010537 s, Result = 00244000, Performance =  14.78 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.013812 s, Result = 00258000, Performance =  11.66 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.014100 s, Result = 0026c000, Performance =  11.80 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014043 s, Result = 00280000, Performance =  12.23 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014532 s, Result = 00294000, Performance =  12.19 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014563 s, Result = 002a8000, Performance =  12.53 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015973 s, Result = 002bc000, Performance =  11.76 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.014397 s, Result = 002d0000, Performance =  13.42 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.017410 s, Result = 002e4000, Performance =  11.41 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.017229 s, Result = 002f8000, Performance =  11.84 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017554 s, Result = 0030c000, Performance =  11.93 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017592 s, Result = 00320000, Performance =  12.21 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.018420 s, Result = 00334000, Performance =  11.95 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018801 s, Result = 00348000, Performance =  11.99 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018783 s, Result = 0035c000, Performance =  12.29 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018900 s, Result = 00370000, Performance =  12.50 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018329 s, Result = 00384000, Performance =  13.18 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019104 s, Result = 00398000, Performance =  12.93 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020620 s, Result = 003ac000, Performance =  12.24 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020255 s, Result = 003c0000, Performance =  12.72 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020210 s, Result = 003d4000, Performance =  13.02 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.022407 s, Result = 003e8000, Performance =  11.98 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.022953 s, Result = 003fc000, Performance =  11.93 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021924 s, Result = 00410000, Performance =  12.73 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.023353 s, Result = 00424000, Performance =  12.18 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.023417 s, Result = 00438000, Performance =  12.38 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.024145 s, Result = 0044c000, Performance =  12.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.024286 s, Result = 00460000, Performance =  12.38 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.023739 s, Result = 00474000, Performance =  12.89 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.024418 s, Result = 00488000, Performance =  12.75 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024365 s, Result = 0049c000, Performance =  13.00 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.025456 s, Result = 004b0000, Performance =  12.65 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025315 s, Result = 004c4000, Performance =  12.94 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.026213 s, Result = 004d8000, Performance =  12.70 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026395 s, Result = 004ec000, Performance =  12.81 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025700 s, Result = 00500000, Performance =  13.37 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  2001  1423   960
Test passed: M N K =  1184  1116  1152
Test passed: M N K =  1452  1590  1152
Test passed: M N K =   703  1164  2048
Test passed: M N K =  1088  1475  1216
M N K =  1024  1024   256, Elapsed time =   0.003911 s, Result = 21024000, Performance =   1.37 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004296 s, Result = 41038000, Performance =   2.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005650 s, Result = 6104c000, Performance =   2.85 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005461 s, Result = 81060000, Performance =   3.93 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006148 s, Result = a1074000, Performance =   4.37 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005775 s, Result = c1088000, Performance =   5.58 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006562 s, Result = e109c000, Performance =   5.73 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007027 s, Result = 010b0000, Performance =   6.11 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007345 s, Result = 210c4000, Performance =   6.58 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007763 s, Result = 410d8000, Performance =   6.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008364 s, Result = 610ec000, Performance =   7.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008568 s, Result = 81100000, Performance =   7.52 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008856 s, Result = a1114000, Performance =   7.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009157 s, Result = c1128000, Performance =   8.21 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009343 s, Result = e113c000, Performance =   8.62 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009699 s, Result = 01150000, Performance =   8.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009426 s, Result = 21164000, Performance =   9.68 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010465 s, Result = 41178000, Performance =   9.23 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011712 s, Result = 6118c000, Performance =   8.71 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010740 s, Result = 811a0000, Performance =  10.00 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.011192 s, Result = a11b4000, Performance =  10.07 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011502 s, Result = c11c8000, Performance =  10.27 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012746 s, Result = e11dc000, Performance =   9.69 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012762 s, Result = 011f0000, Performance =  10.10 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.012625 s, Result = 21204000, Performance =  10.63 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.012578 s, Result = 41218000, Performance =  11.10 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.013509 s, Result = 6122c000, Performance =  10.73 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013947 s, Result = 81240000, Performance =  10.78 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.013495 s, Result = a1254000, Performance =  11.54 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.013201 s, Result = c1268000, Performance =  12.20 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013743 s, Result = e127c000, Performance =  12.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014850 s, Result = 01290000, Performance =  11.57 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.014837 s, Result = 212a4000, Performance =  11.94 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014787 s, Result = 412b8000, Performance =  12.34 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015173 s, Result = 612cc000, Performance =  12.38 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015167 s, Result = 812e0000, Performance =  12.74 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.018411 s, Result = a12f4000, Performance =  10.79 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.018015 s, Result = c1308000, Performance =  11.32 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017259 s, Result = e131c000, Performance =  12.13 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017373 s, Result = 01330000, Performance =  12.36 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017758 s, Result = 21344000, Performance =  12.40 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018097 s, Result = 41358000, Performance =  12.46 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018026 s, Result = 6136c000, Performance =  12.81 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018995 s, Result = 81380000, Performance =  12.44 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018586 s, Result = a1394000, Performance =  13.00 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019412 s, Result = c13a8000, Performance =  12.72 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020467 s, Result = e13bc000, Performance =  12.33 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020466 s, Result = 013d0000, Performance =  12.59 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.019521 s, Result = 213e4000, Performance =  13.48 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.019594 s, Result = 413f8000, Performance =  13.70 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021839 s, Result = 6140c000, Performance =  12.54 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.022057 s, Result = 81420000, Performance =  12.66 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021612 s, Result = a1434000, Performance =  13.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022673 s, Result = c1448000, Performance =  12.79 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.022775 s, Result = e145c000, Performance =  12.97 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.022908 s, Result = 01470000, Performance =  13.12 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022709 s, Result = 21484000, Performance =  13.48 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.022929 s, Result = 41498000, Performance =  13.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.023588 s, Result = 614ac000, Performance =  13.43 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.023424 s, Result = 814c0000, Performance =  13.75 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.023965 s, Result = a14d4000, Performance =  13.67 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024309 s, Result = c14e8000, Performance =  13.69 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.024585 s, Result = e14fc000, Performance =  13.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025924 s, Result = 01510000, Performance =  13.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   491   792   320
Test passed: M N K =  1867   606  1728
Test passed: M N K =  1724  1936  1984
Test passed: M N K =   663   872  1344
Test passed: M N K =  1269  2030  1216
M N K =  1024  1024   256, Elapsed time =   0.002252 s, Result = 00014000, Performance =   2.38 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002668 s, Result = 00028000, Performance =   4.03 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004099 s, Result = 0003c000, Performance =   3.93 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004365 s, Result = 00050000, Performance =   4.92 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004462 s, Result = 00064000, Performance =   6.02 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005397 s, Result = 00078000, Performance =   5.97 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005764 s, Result = 0008c000, Performance =   6.52 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005672 s, Result = 000a0000, Performance =   7.57 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006577 s, Result = 000b4000, Performance =   7.35 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006779 s, Result = 000c8000, Performance =   7.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007399 s, Result = 000dc000, Performance =   7.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008045 s, Result = 000f0000, Performance =   8.01 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008107 s, Result = 00104000, Performance =   8.61 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008365 s, Result = 00118000, Performance =   8.99 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008271 s, Result = 0012c000, Performance =   9.74 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010053 s, Result = 00140000, Performance =   8.54 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009339 s, Result = 00154000, Performance =   9.77 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009683 s, Result = 00168000, Performance =   9.98 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009793 s, Result = 0017c000, Performance =  10.42 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.010699 s, Result = 00190000, Performance =  10.04 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.010575 s, Result = 001a4000, Performance =  10.66 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.010403 s, Result = 001b8000, Performance =  11.35 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010585 s, Result = 001cc000, Performance =  11.67 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010884 s, Result = 001e0000, Performance =  11.84 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.011861 s, Result = 001f4000, Performance =  11.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011569 s, Result = 00208000, Performance =  12.07 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012072 s, Result = 0021c000, Performance =  12.01 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011985 s, Result = 00230000, Performance =  12.54 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012246 s, Result = 00244000, Performance =  12.71 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.013377 s, Result = 00258000, Performance =  12.04 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013122 s, Result = 0026c000, Performance =  12.68 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013753 s, Result = 00280000, Performance =  12.49 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.012996 s, Result = 00294000, Performance =  13.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.013468 s, Result = 002a8000, Performance =  13.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.013962 s, Result = 002bc000, Performance =  13.46 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.014001 s, Result = 002d0000, Performance =  13.80 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.014257 s, Result = 002e4000, Performance =  13.93 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.014610 s, Result = 002f8000, Performance =  13.96 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.014693 s, Result = 0030c000, Performance =  14.25 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.015625 s, Result = 00320000, Performance =  13.74 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.015265 s, Result = 00334000, Performance =  14.42 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.015563 s, Result = 00348000, Performance =  14.49 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.016823 s, Result = 0035c000, Performance =  13.72 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.019001 s, Result = 00370000, Performance =  12.43 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.017709 s, Result = 00384000, Performance =  13.64 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019137 s, Result = 00398000, Performance =  12.91 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019088 s, Result = 003ac000, Performance =  13.22 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.019434 s, Result = 003c0000, Performance =  13.26 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.019755 s, Result = 003d4000, Performance =  13.32 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020223 s, Result = 003e8000, Performance =  13.27 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.020557 s, Result = 003fc000, Performance =  13.32 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.020979 s, Result = 00410000, Performance =  13.31 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021237 s, Result = 00424000, Performance =  13.40 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.021401 s, Result = 00438000, Performance =  13.55 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.020700 s, Result = 0044c000, Performance =  14.26 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.021813 s, Result = 00460000, Performance =  13.78 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022320 s, Result = 00474000, Performance =  13.71 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.022740 s, Result = 00488000, Performance =  13.69 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.022225 s, Result = 0049c000, Performance =  14.25 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.022027 s, Result = 004b0000, Performance =  14.62 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.022888 s, Result = 004c4000, Performance =  14.31 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.023802 s, Result = 004d8000, Performance =  13.98 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.024679 s, Result = 004ec000, Performance =  13.70 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.024237 s, Result = 00500000, Performance =  14.18 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   484   668  1600
Test passed: M N K =  1529   922  2048
Test passed: M N K =   380   886  1280
Test passed: M N K =   401   779  1024
Test passed: M N K =   963   561   576
M N K =  1024  1024   256, Elapsed time =   0.002016 s, Result = 0a0b4000, Performance =   2.66 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002488 s, Result = 0a0c8000, Performance =   4.32 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003305 s, Result = 0a0dc000, Performance =   4.87 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003661 s, Result = 0a0f0000, Performance =   5.87 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003832 s, Result = 0a104000, Performance =   7.01 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004138 s, Result = 0a118000, Performance =   7.78 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004443 s, Result = 0a12c000, Performance =   8.46 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004820 s, Result = 0a140000, Performance =   8.91 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005488 s, Result = 0a154000, Performance =   8.80 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005792 s, Result = 0a168000, Performance =   9.27 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.005932 s, Result = 0a17c000, Performance =   9.96 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006436 s, Result = 0a190000, Performance =  10.01 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006660 s, Result = 0a1a4000, Performance =  10.48 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007126 s, Result = 0a1b8000, Performance =  10.55 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007562 s, Result = 0a1cc000, Performance =  10.65 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007883 s, Result = 0a1e0000, Performance =  10.90 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008140 s, Result = 0a1f4000, Performance =  11.21 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008323 s, Result = 0a208000, Performance =  11.61 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009047 s, Result = 0a21c000, Performance =  11.27 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.008836 s, Result = 0a230000, Performance =  12.15 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009748 s, Result = 0a244000, Performance =  11.57 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009694 s, Result = 0a258000, Performance =  12.18 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010694 s, Result = 0a26c000, Performance =  11.55 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010334 s, Result = 0a280000, Performance =  12.47 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010911 s, Result = 0a294000, Performance =  12.30 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.010981 s, Result = 0a2a8000, Performance =  12.71 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012463 s, Result = 0a2bc000, Performance =  11.63 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.012379 s, Result = 0a2d0000, Performance =  12.14 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012374 s, Result = 0a2e4000, Performance =  12.58 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.012395 s, Result = 0a2f8000, Performance =  12.99 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.012925 s, Result = 0a30c000, Performance =  12.88 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013009 s, Result = 0a320000, Performance =  13.21 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.013298 s, Result = 0a334000, Performance =  13.32 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014021 s, Result = 0a348000, Performance =  13.02 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.014448 s, Result = 0a35c000, Performance =  13.01 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015244 s, Result = 0a370000, Performance =  12.68 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.014873 s, Result = 0a384000, Performance =  13.36 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.015016 s, Result = 0a398000, Performance =  13.59 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.015727 s, Result = 0a3ac000, Performance =  13.31 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.015849 s, Result = 0a3c0000, Performance =  13.55 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.016918 s, Result = 0a3d4000, Performance =  13.01 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.016227 s, Result = 0a3e8000, Performance =  13.90 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.016933 s, Result = 0a3fc000, Performance =  13.63 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.016522 s, Result = 0a410000, Performance =  14.30 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018168 s, Result = 0a424000, Performance =  13.30 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.018276 s, Result = 0a438000, Performance =  13.51 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.017915 s, Result = 0a44c000, Performance =  14.08 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.018351 s, Result = 0a460000, Performance =  14.04 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.019952 s, Result = 0a474000, Performance =  13.19 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.018928 s, Result = 0a488000, Performance =  14.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.019808 s, Result = 0a49c000, Performance =  13.82 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.019056 s, Result = 0a4b0000, Performance =  14.65 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.020343 s, Result = 0a4c4000, Performance =  13.99 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.021043 s, Result = 0a4d8000, Performance =  13.78 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.020844 s, Result = 0a4ec000, Performance =  14.17 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.020946 s, Result = 0a500000, Performance =  14.35 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.021342 s, Result = 0a514000, Performance =  14.34 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.021578 s, Result = 0a528000, Performance =  14.43 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.021694 s, Result = 0a53c000, Performance =  14.60 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.021645 s, Result = 0a550000, Performance =  14.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.022181 s, Result = 0a564000, Performance =  14.76 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.022900 s, Result = 0a578000, Performance =  14.54 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.023406 s, Result = 0a58c000, Performance =  14.45 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.023869 s, Result = 0a5a0000, Performance =  14.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   346  1271   896
Test passed: M N K =   713  1772  1280
Test passed: M N K =   273  1826  1984
Test passed: M N K =   409  1856   832
Test passed: M N K =  1587   721   128
M N K =  1024  1024   256, Elapsed time =   0.000244 s, Result = 00014000, Performance =  22.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000552 s, Result = 00028000, Performance =  19.46 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001122 s, Result = 0003c000, Performance =  14.36 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001373 s, Result = 00050000, Performance =  15.64 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.001645 s, Result = 00064000, Performance =  16.32 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.001967 s, Result = 00078000, Performance =  16.37 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002256 s, Result = 0008c000, Performance =  16.66 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.002801 s, Result = 000a0000, Performance =  15.33 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.003003 s, Result = 000b4000, Performance =  16.09 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.003338 s, Result = 000c8000, Performance =  16.09 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.003631 s, Result = 000dc000, Performance =  16.26 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.004114 s, Result = 000f0000, Performance =  15.66 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.004769 s, Result = 00104000, Performance =  14.63 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.004886 s, Result = 00118000, Performance =  15.38 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.005172 s, Result = 0012c000, Performance =  15.57 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.005554 s, Result = 00140000, Performance =  15.47 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.005679 s, Result = 00154000, Performance =  16.07 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.005933 s, Result = 00168000, Performance =  16.29 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.006437 s, Result = 0017c000, Performance =  15.85 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.006834 s, Result = 00190000, Performance =  15.71 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.007477 s, Result = 001a4000, Performance =  15.08 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.007654 s, Result = 001b8000, Performance =  15.43 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.008206 s, Result = 001cc000, Performance =  15.05 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.008188 s, Result = 001e0000, Performance =  15.74 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.009207 s, Result = 001f4000, Performance =  14.58 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.009016 s, Result = 00208000, Performance =  15.48 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.009922 s, Result = 0021c000, Performance =  14.61 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.009919 s, Result = 00230000, Performance =  15.16 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.010595 s, Result = 00244000, Performance =  14.69 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.010197 s, Result = 00258000, Performance =  15.79 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.010765 s, Result = 0026c000, Performance =  15.46 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.010898 s, Result = 00280000, Performance =  15.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.012643 s, Result = 00294000, Performance =  14.01 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.011693 s, Result = 002a8000, Performance =  15.61 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.012654 s, Result = 002bc000, Performance =  14.85 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.012577 s, Result = 002d0000, Performance =  15.37 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.013084 s, Result = 002e4000, Performance =  15.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.012996 s, Result = 002f8000, Performance =  15.70 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.014405 s, Result = 0030c000, Performance =  14.54 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.013602 s, Result = 00320000, Performance =  15.79 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.014448 s, Result = 00334000, Performance =  15.24 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.014873 s, Result = 00348000, Performance =  15.16 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.015293 s, Result = 0035c000, Performance =  15.10 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.014960 s, Result = 00370000, Performance =  15.79 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.015983 s, Result = 00384000, Performance =  15.12 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.016444 s, Result = 00398000, Performance =  15.02 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.016789 s, Result = 003ac000, Performance =  15.03 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.016400 s, Result = 003c0000, Performance =  15.71 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.016783 s, Result = 003d4000, Performance =  15.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.016197 s, Result = 003e8000, Performance =  16.57 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.017479 s, Result = 003fc000, Performance =  15.66 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.017219 s, Result = 00410000, Performance =  16.21 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.018902 s, Result = 00424000, Performance =  15.05 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.018371 s, Result = 00438000, Performance =  15.78 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.019383 s, Result = 0044c000, Performance =  15.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.018577 s, Result = 00460000, Performance =  16.18 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.019022 s, Result = 00474000, Performance =  16.09 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.019320 s, Result = 00488000, Performance =  16.12 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.019723 s, Result = 0049c000, Performance =  16.06 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.019738 s, Result = 004b0000, Performance =  16.32 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.021098 s, Result = 004c4000, Performance =  15.52 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.020128 s, Result = 004d8000, Performance =  16.54 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.021649 s, Result = 004ec000, Performance =  15.62 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.021326 s, Result = 00500000, Performance =  16.11 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   900   457  1216
Test passed: M N K =   232   759  1920
Test passed: M N K =   120  1858   832
Test passed: M N K =  1234  1617   576
Test passed: M N K =    44  1180    64
M N K =  1024  1024   256, Elapsed time =   0.003906 s, Result = 21024000, Performance =   1.37 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005023 s, Result = 41038000, Performance =   2.14 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005643 s, Result = 6104c000, Performance =   2.85 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005201 s, Result = 81060000, Performance =   4.13 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005557 s, Result = a1074000, Performance =   4.83 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006279 s, Result = c1088000, Performance =   5.13 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007430 s, Result = e109c000, Performance =   5.06 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007249 s, Result = 010b0000, Performance =   5.93 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007710 s, Result = 210c4000, Performance =   6.27 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007863 s, Result = 410d8000, Performance =   6.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008269 s, Result = 610ec000, Performance =   7.14 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008466 s, Result = 81100000, Performance =   7.61 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008861 s, Result = a1114000, Performance =   7.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009146 s, Result = c1128000, Performance =   8.22 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009753 s, Result = e113c000, Performance =   8.26 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010392 s, Result = 01150000, Performance =   8.27 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010451 s, Result = 21164000, Performance =   8.73 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010882 s, Result = 41178000, Performance =   8.88 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011075 s, Result = 6118c000, Performance =   9.21 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012056 s, Result = 811a0000, Performance =   8.91 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012489 s, Result = a11b4000, Performance =   9.03 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.012446 s, Result = c11c8000, Performance =   9.49 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.013022 s, Result = e11dc000, Performance =   9.48 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.013745 s, Result = 011f0000, Performance =   9.37 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014148 s, Result = 21204000, Performance =   9.49 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013271 s, Result = 41218000, Performance =  10.52 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.014198 s, Result = 6122c000, Performance =  10.21 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.014365 s, Result = 81240000, Performance =  10.46 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015482 s, Result = a1254000, Performance =  10.06 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015402 s, Result = c1268000, Performance =  10.46 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015710 s, Result = e127c000, Performance =  10.59 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.015517 s, Result = 01290000, Performance =  11.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.016352 s, Result = 212a4000, Performance =  10.83 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016784 s, Result = 412b8000, Performance =  10.88 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017442 s, Result = 612cc000, Performance =  10.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.016903 s, Result = 812e0000, Performance =  11.43 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.018003 s, Result = a12f4000, Performance =  11.03 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.018322 s, Result = c1308000, Performance =  11.13 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.018109 s, Result = e131c000, Performance =  11.56 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017605 s, Result = 01330000, Performance =  12.20 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.019272 s, Result = 21344000, Performance =  11.42 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.019294 s, Result = 41358000, Performance =  11.69 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.019234 s, Result = 6136c000, Performance =  12.00 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.019806 s, Result = 81380000, Performance =  11.93 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.020497 s, Result = a1394000, Performance =  11.79 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.020415 s, Result = c13a8000, Performance =  12.10 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.020631 s, Result = e13bc000, Performance =  12.23 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.020236 s, Result = 013d0000, Performance =  12.73 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.022058 s, Result = 213e4000, Performance =  11.93 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.021317 s, Result = 413f8000, Performance =  12.59 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.022863 s, Result = 6140c000, Performance =  11.98 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021837 s, Result = 81420000, Performance =  12.78 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.022019 s, Result = a1434000, Performance =  12.92 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.023718 s, Result = c1448000, Performance =  12.22 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.024324 s, Result = e145c000, Performance =  12.14 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.024479 s, Result = 01470000, Performance =  12.28 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.024700 s, Result = 21484000, Performance =  12.39 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.025323 s, Result = 41498000, Performance =  12.30 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.025747 s, Result = 614ac000, Performance =  12.30 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.025351 s, Result = 814c0000, Performance =  12.71 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025201 s, Result = a14d4000, Performance =  12.99 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.026085 s, Result = c14e8000, Performance =  12.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.027123 s, Result = e14fc000, Performance =  12.47 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.026571 s, Result = 01510000, Performance =  12.93 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   823  1049   960
Test passed: M N K =  1529  1276  1984
Test passed: M N K =   789  1592  1024
Test passed: M N K =  1599     5  1664
Test passed: M N K =  1241  1560  1088
M N K =  1024  1024   256, Elapsed time =   0.002295 s, Result = 00014000, Performance =   2.34 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003539 s, Result = 00028000, Performance =   3.03 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003819 s, Result = 0003c000, Performance =   4.22 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004264 s, Result = 00050000, Performance =   5.04 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005602 s, Result = 00064000, Performance =   4.79 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006364 s, Result = 00078000, Performance =   5.06 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005898 s, Result = 0008c000, Performance =   6.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006010 s, Result = 000a0000, Performance =   7.15 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006760 s, Result = 000b4000, Performance =   7.15 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007149 s, Result = 000c8000, Performance =   7.51 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007427 s, Result = 000dc000, Performance =   7.95 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007736 s, Result = 000f0000, Performance =   8.33 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007465 s, Result = 00104000, Performance =   9.35 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008306 s, Result = 00118000, Performance =   9.05 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008898 s, Result = 0012c000, Performance =   9.05 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008751 s, Result = 00140000, Performance =   9.82 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009345 s, Result = 00154000, Performance =   9.77 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009659 s, Result = 00168000, Performance =  10.00 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009939 s, Result = 0017c000, Performance =  10.26 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011297 s, Result = 00190000, Performance =   9.51 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.010926 s, Result = 001a4000, Performance =  10.32 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.010918 s, Result = 001b8000, Performance =  10.82 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012551 s, Result = 001cc000, Performance =   9.84 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.012221 s, Result = 001e0000, Performance =  10.54 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.013401 s, Result = 001f4000, Performance =  10.02 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.012695 s, Result = 00208000, Performance =  11.00 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.013636 s, Result = 0021c000, Performance =  10.63 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.013301 s, Result = 00230000, Performance =  11.30 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.013963 s, Result = 00244000, Performance =  11.15 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.014071 s, Result = 00258000, Performance =  11.45 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.014752 s, Result = 0026c000, Performance =  11.28 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.014624 s, Result = 00280000, Performance =  11.75 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.015180 s, Result = 00294000, Performance =  11.67 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.015152 s, Result = 002a8000, Performance =  12.05 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.015974 s, Result = 002bc000, Performance =  11.76 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.015863 s, Result = 002d0000, Performance =  12.18 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.016527 s, Result = 002e4000, Performance =  12.02 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.016651 s, Result = 002f8000, Performance =  12.25 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.017100 s, Result = 0030c000, Performance =  12.24 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.017343 s, Result = 00320000, Performance =  12.38 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017879 s, Result = 00334000, Performance =  12.31 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.018416 s, Result = 00348000, Performance =  12.24 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.018941 s, Result = 0035c000, Performance =  12.19 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.018772 s, Result = 00370000, Performance =  12.58 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.019191 s, Result = 00384000, Performance =  12.59 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.019733 s, Result = 00398000, Performance =  12.52 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019888 s, Result = 003ac000, Performance =  12.69 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.019895 s, Result = 003c0000, Performance =  12.95 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.020658 s, Result = 003d4000, Performance =  12.73 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.021236 s, Result = 003e8000, Performance =  12.64 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021898 s, Result = 003fc000, Performance =  12.50 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021316 s, Result = 00410000, Performance =  13.10 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021465 s, Result = 00424000, Performance =  13.26 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.022892 s, Result = 00438000, Performance =  12.66 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.023478 s, Result = 0044c000, Performance =  12.58 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.022918 s, Result = 00460000, Performance =  13.12 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022213 s, Result = 00474000, Performance =  13.78 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.023808 s, Result = 00488000, Performance =  13.08 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.024325 s, Result = 0049c000, Performance =  13.02 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.023883 s, Result = 004b0000, Performance =  13.49 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.025377 s, Result = 004c4000, Performance =  12.91 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024959 s, Result = 004d8000, Performance =  13.34 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.026439 s, Result = 004ec000, Performance =  12.79 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025121 s, Result = 00500000, Performance =  13.68 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1358   743  1664
Test passed: M N K =    44  1843   832
Test passed: M N K =   482  1453  1280
Test passed: M N K =  1726   567  2048
Test passed: M N K =   732   280   960
M N K =  1024  1024   256, Elapsed time =   0.002033 s, Result = 0a0b4000, Performance =   2.64 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003208 s, Result = 0a0c8000, Performance =   3.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003438 s, Result = 0a0dc000, Performance =   4.68 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003709 s, Result = 0a0f0000, Performance =   5.79 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004094 s, Result = 0a104000, Performance =   6.56 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004290 s, Result = 0a118000, Performance =   7.51 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004448 s, Result = 0a12c000, Performance =   8.45 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004826 s, Result = 0a140000, Performance =   8.90 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005412 s, Result = 0a154000, Performance =   8.93 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005689 s, Result = 0a168000, Performance =   9.44 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006259 s, Result = 0a17c000, Performance =   9.44 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006637 s, Result = 0a190000, Performance =   9.71 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.006845 s, Result = 0a1a4000, Performance =  10.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007096 s, Result = 0a1b8000, Performance =  10.59 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.007607 s, Result = 0a1cc000, Performance =  10.59 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.007774 s, Result = 0a1e0000, Performance =  11.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008165 s, Result = 0a1f4000, Performance =  11.18 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008501 s, Result = 0a208000, Performance =  11.37 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.009157 s, Result = 0a21c000, Performance =  11.14 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009047 s, Result = 0a230000, Performance =  11.87 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.009615 s, Result = 0a244000, Performance =  11.73 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.009628 s, Result = 0a258000, Performance =  12.27 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.010059 s, Result = 0a26c000, Performance =  12.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.010539 s, Result = 0a280000, Performance =  12.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.010942 s, Result = 0a294000, Performance =  12.27 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.011061 s, Result = 0a2a8000, Performance =  12.62 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.012450 s, Result = 0a2bc000, Performance =  11.64 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.011726 s, Result = 0a2d0000, Performance =  12.82 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.012215 s, Result = 0a2e4000, Performance =  12.75 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.011946 s, Result = 0a2f8000, Performance =  13.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.013403 s, Result = 0a30c000, Performance =  12.42 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.013214 s, Result = 0a320000, Performance =  13.00 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.013224 s, Result = 0a334000, Performance =  13.40 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.014081 s, Result = 0a348000, Performance =  12.96 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.013807 s, Result = 0a35c000, Performance =  13.61 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.014586 s, Result = 0a370000, Performance =  13.25 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.014510 s, Result = 0a384000, Performance =  13.69 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.014422 s, Result = 0a398000, Performance =  14.15 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.014720 s, Result = 0a3ac000, Performance =  14.22 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.016195 s, Result = 0a3c0000, Performance =  13.26 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.017055 s, Result = 0a3d4000, Performance =  12.91 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.017353 s, Result = 0a3e8000, Performance =  12.99 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.017583 s, Result = 0a3fc000, Performance =  13.13 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.017040 s, Result = 0a410000, Performance =  13.86 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.018200 s, Result = 0a424000, Performance =  13.27 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.018431 s, Result = 0a438000, Performance =  13.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.019685 s, Result = 0a44c000, Performance =  12.82 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.019137 s, Result = 0a460000, Performance =  13.47 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.019092 s, Result = 0a474000, Performance =  13.78 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.020112 s, Result = 0a488000, Performance =  13.35 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.021016 s, Result = 0a49c000, Performance =  13.03 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.021215 s, Result = 0a4b0000, Performance =  13.16 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.021730 s, Result = 0a4c4000, Performance =  13.09 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.021807 s, Result = 0a4d8000, Performance =  13.29 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.021935 s, Result = 0a4ec000, Performance =  13.46 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.021994 s, Result = 0a500000, Performance =  13.67 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.022357 s, Result = 0a514000, Performance =  13.69 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.023642 s, Result = 0a528000, Performance =  13.17 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.023874 s, Result = 0a53c000, Performance =  13.27 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.024279 s, Result = 0a550000, Performance =  13.27 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.024430 s, Result = 0a564000, Performance =  13.41 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.024621 s, Result = 0a578000, Performance =  13.52 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.025852 s, Result = 0a58c000, Performance =  13.08 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.025157 s, Result = 0a5a0000, Performance =  13.66 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1891   953  1728
Test passed: M N K =   232    81   512
Test passed: M N K =    34  1786   320
Test passed: M N K =   107   631   768
Test passed: M N K =   198  1642   448
M N K =  1024  1024   256, Elapsed time =   0.000250 s, Result = 00014000, Performance =  21.46 TOPS
M N K =  1024  1024   512, Elapsed time =   0.000548 s, Result = 00028000, Performance =  19.61 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001022 s, Result = 0003c000, Performance =  15.76 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.001420 s, Result = 00050000, Performance =  15.13 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.001749 s, Result = 00064000, Performance =  15.35 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.002058 s, Result = 00078000, Performance =  15.65 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.002323 s, Result = 0008c000, Performance =  16.17 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.002739 s, Result = 000a0000, Performance =  15.68 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.002905 s, Result = 000b4000, Performance =  16.64 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.003314 s, Result = 000c8000, Performance =  16.20 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.003832 s, Result = 000dc000, Performance =  15.41 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.004186 s, Result = 000f0000, Performance =  15.39 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.004406 s, Result = 00104000, Performance =  15.84 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.004818 s, Result = 00118000, Performance =  15.60 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.005153 s, Result = 0012c000, Performance =  15.63 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.005622 s, Result = 00140000, Performance =  15.28 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.005765 s, Result = 00154000, Performance =  15.83 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.006246 s, Result = 00168000, Performance =  15.47 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.007036 s, Result = 0017c000, Performance =  14.50 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.007212 s, Result = 00190000, Performance =  14.89 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.007821 s, Result = 001a4000, Performance =  14.42 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.007998 s, Result = 001b8000, Performance =  14.77 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.008545 s, Result = 001cc000, Performance =  14.45 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.008330 s, Result = 001e0000, Performance =  15.47 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.009176 s, Result = 001f4000, Performance =  14.63 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.009523 s, Result = 00208000, Performance =  14.66 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.010021 s, Result = 0021c000, Performance =  14.47 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.010260 s, Result = 00230000, Performance =  14.65 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.010464 s, Result = 00244000, Performance =  14.88 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.010677 s, Result = 00258000, Performance =  15.08 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.011213 s, Result = 0026c000, Performance =  14.84 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.011428 s, Result = 00280000, Performance =  15.03 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.011698 s, Result = 00294000, Performance =  15.14 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.012541 s, Result = 002a8000, Performance =  14.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.012516 s, Result = 002bc000, Performance =  15.01 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.012055 s, Result = 002d0000, Performance =  16.03 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.013553 s, Result = 002e4000, Performance =  14.66 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.013179 s, Result = 002f8000, Performance =  15.48 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.012604 s, Result = 0030c000, Performance =  16.61 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.014295 s, Result = 00320000, Performance =  15.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.014361 s, Result = 00334000, Performance =  15.33 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.014582 s, Result = 00348000, Performance =  15.46 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.015547 s, Result = 0035c000, Performance =  14.85 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.015395 s, Result = 00370000, Performance =  15.34 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.015536 s, Result = 00384000, Performance =  15.55 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.016672 s, Result = 00398000, Performance =  14.81 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.017484 s, Result = 003ac000, Performance =  14.43 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.016217 s, Result = 003c0000, Performance =  15.89 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.018020 s, Result = 003d4000, Performance =  14.60 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.018053 s, Result = 003e8000, Performance =  14.87 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.019025 s, Result = 003fc000, Performance =  14.39 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.018032 s, Result = 00410000, Performance =  15.48 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.018786 s, Result = 00424000, Performance =  15.15 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.019511 s, Result = 00438000, Performance =  14.86 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.019379 s, Result = 0044c000, Performance =  15.24 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.019779 s, Result = 00460000, Performance =  15.20 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.021095 s, Result = 00474000, Performance =  14.51 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.019690 s, Result = 00488000, Performance =  15.81 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.021595 s, Result = 0049c000, Performance =  14.67 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.021946 s, Result = 004b0000, Performance =  14.68 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.020849 s, Result = 004c4000, Performance =  15.71 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.022037 s, Result = 004d8000, Performance =  15.10 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.023464 s, Result = 004ec000, Performance =  14.41 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.022655 s, Result = 00500000, Performance =  15.17 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   850  1065   960
Test passed: M N K =  1008   685  1728
Test passed: M N K =  1862  1488   640
Test passed: M N K =   645   458  1920
Test passed: M N K =   562  1270   128
M N K =  2048  2048   256, Elapsed time =   0.006985 s, Result = 64180000, Performance =   3.07 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008201 s, Result = 842c0000, Performance =   5.24 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008815 s, Result = a4400000, Performance =   7.31 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009404 s, Result = c4540000, Performance =   9.13 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010355 s, Result = e4680000, Performance =  10.37 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010875 s, Result = 047c0000, Performance =  11.85 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012030 s, Result = 24900000, Performance =  12.50 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012709 s, Result = 44a40000, Performance =  13.52 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017538 s, Result = 64b80000, Performance =  11.02 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014875 s, Result = 84cc0000, Performance =  14.44 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015397 s, Result = a4e00000, Performance =  15.34 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017103 s, Result = c4f40000, Performance =  15.07 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018130 s, Result = e5080000, Performance =  15.40 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019148 s, Result = 051c0000, Performance =  15.70 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.019953 s, Result = 25300000, Performance =  16.14 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022283 s, Result = 45440000, Performance =  15.42 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021235 s, Result = 65580000, Performance =  17.19 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021894 s, Result = 856c0000, Performance =  17.66 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.023084 s, Result = a5800000, Performance =  17.68 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.024811 s, Result = c5940000, Performance =  17.31 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025278 s, Result = e5a80000, Performance =  17.84 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026955 s, Result = 05bc0000, Performance =  17.53 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027431 s, Result = 25d00000, Performance =  18.01 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.028977 s, Result = 45e40000, Performance =  17.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029444 s, Result = 65f80000, Performance =  18.23 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.030682 s, Result = 860c0000, Performance =  18.20 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031826 s, Result = a6200000, Performance =  18.22 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032931 s, Result = c6340000, Performance =  18.26 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033203 s, Result = e6480000, Performance =  18.76 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.033941 s, Result = 065c0000, Performance =  18.98 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.034936 s, Result = 26700000, Performance =  19.06 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.037256 s, Result = 46840000, Performance =  18.45 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.038136 s, Result = 66980000, Performance =  18.58 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.037104 s, Result = 86ac0000, Performance =  19.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.038008 s, Result = a6c00000, Performance =  19.78 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038631 s, Result = c6d40000, Performance =  20.01 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.040407 s, Result = e6e80000, Performance =  19.66 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040766 s, Result = 06fc0000, Performance =  20.02 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.041563 s, Result = 27100000, Performance =  20.15 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.043393 s, Result = 47240000, Performance =  19.80 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.044062 s, Result = 67380000, Performance =  19.98 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.044281 s, Result = 874c0000, Performance =  20.37 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.045680 s, Result = a7600000, Performance =  20.22 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045374 s, Result = c7740000, Performance =  20.82 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.047764 s, Result = e7880000, Performance =  20.23 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.048687 s, Result = 079c0000, Performance =  20.29 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.048720 s, Result = 27b00000, Performance =  20.72 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.050564 s, Result = 47c40000, Performance =  20.39 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.050694 s, Result = 67d80000, Performance =  20.76 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.052396 s, Result = 87ec0000, Performance =  20.49 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.054042 s, Result = a8000000, Performance =  20.27 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.054555 s, Result = c8140000, Performance =  20.47 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.054189 s, Result = e8280000, Performance =  21.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.056242 s, Result = 083c0000, Performance =  20.62 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.056237 s, Result = 28500000, Performance =  21.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.056751 s, Result = 48640000, Performance =  21.19 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.059064 s, Result = 68780000, Performance =  20.72 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.059018 s, Result = 888c0000, Performance =  21.10 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.060615 s, Result = a8a00000, Performance =  20.90 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.062818 s, Result = c8b40000, Performance =  20.51 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.062913 s, Result = e8c80000, Performance =  20.82 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.063168 s, Result = 08dc0000, Performance =  21.08 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.063168 s, Result = 28f00000, Performance =  21.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.067258 s, Result = 49040000, Performance =  20.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   502  1407   256
Test passed: M N K =   739  1133   768
Test passed: M N K =   490   387  1600
Test passed: M N K =  1563   240   192
Test passed: M N K =  1057  1036  1344
M N K =  2048  2048   256, Elapsed time =   0.006438 s, Result = 00140000, Performance =   3.34 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007692 s, Result = 00280000, Performance =   5.58 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007280 s, Result = 003c0000, Performance =   8.85 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007721 s, Result = 00500000, Performance =  11.13 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008578 s, Result = 00640000, Performance =  12.52 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009430 s, Result = 00780000, Performance =  13.66 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010151 s, Result = 008c0000, Performance =  14.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011111 s, Result = 00a00000, Performance =  15.46 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015492 s, Result = 00b40000, Performance =  12.48 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012771 s, Result = 00c80000, Performance =  16.82 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014206 s, Result = 00dc0000, Performance =  16.63 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014842 s, Result = 00f00000, Performance =  17.36 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015659 s, Result = 01040000, Performance =  17.83 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017178 s, Result = 01180000, Performance =  17.50 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017953 s, Result = 012c0000, Performance =  17.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019332 s, Result = 01400000, Performance =  17.77 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019540 s, Result = 01540000, Performance =  18.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020511 s, Result = 01680000, Performance =  18.85 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021675 s, Result = 017c0000, Performance =  18.82 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022872 s, Result = 01900000, Performance =  18.78 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023420 s, Result = 01a40000, Performance =  19.26 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024550 s, Result = 01b80000, Performance =  19.24 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025042 s, Result = 01cc0000, Performance =  19.72 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026377 s, Result = 01e00000, Performance =  19.54 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.027438 s, Result = 01f40000, Performance =  19.57 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028353 s, Result = 02080000, Performance =  19.69 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029967 s, Result = 021c0000, Performance =  19.35 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.030910 s, Result = 02300000, Performance =  19.45 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031651 s, Result = 02440000, Performance =  19.68 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031443 s, Result = 02580000, Performance =  20.49 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.033341 s, Result = 026c0000, Performance =  19.97 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035573 s, Result = 02800000, Performance =  19.32 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.034927 s, Result = 02940000, Performance =  20.29 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.035250 s, Result = 02a80000, Performance =  20.71 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.036158 s, Result = 02bc0000, Performance =  20.79 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.037366 s, Result = 02d00000, Performance =  20.69 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.038457 s, Result = 02e40000, Performance =  20.66 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040056 s, Result = 02f80000, Performance =  20.37 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.039280 s, Result = 030c0000, Performance =  21.32 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040916 s, Result = 03200000, Performance =  20.99 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041586 s, Result = 03340000, Performance =  21.17 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.043423 s, Result = 03480000, Performance =  20.77 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043312 s, Result = 035c0000, Performance =  21.32 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.046227 s, Result = 03700000, Performance =  20.44 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045758 s, Result = 03840000, Performance =  21.12 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045879 s, Result = 03980000, Performance =  21.53 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.048713 s, Result = 03ac0000, Performance =  20.72 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049211 s, Result = 03c00000, Performance =  20.95 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.048989 s, Result = 03d40000, Performance =  21.48 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.049372 s, Result = 03e80000, Performance =  21.75 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.051747 s, Result = 03fc0000, Performance =  21.17 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.051026 s, Result = 04100000, Performance =  21.88 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.053267 s, Result = 04240000, Performance =  21.37 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.053181 s, Result = 04380000, Performance =  21.81 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.055720 s, Result = 044c0000, Performance =  21.20 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.055562 s, Result = 04600000, Performance =  21.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.056823 s, Result = 04740000, Performance =  21.54 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.059291 s, Result = 04880000, Performance =  21.01 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.057928 s, Result = 049c0000, Performance =  21.87 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.059721 s, Result = 04b00000, Performance =  21.58 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.060246 s, Result = 04c40000, Performance =  21.74 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.061752 s, Result = 04d80000, Performance =  21.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.063603 s, Result = 04ec0000, Performance =  21.27 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.072786 s, Result = 05000000, Performance =  18.88 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   735  1817  1792
Test passed: M N K =   987  1857   128
Test passed: M N K =  1373  1594  1024
Test passed: M N K =    67   851    64
Test passed: M N K =   602  1803  1344
M N K =  2048  2048   256, Elapsed time =   0.003699 s, Result = 283c0000, Performance =   5.81 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004400 s, Result = 28500000, Performance =   9.76 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005099 s, Result = 28640000, Performance =  12.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005746 s, Result = 28780000, Performance =  14.95 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006719 s, Result = 288c0000, Performance =  15.98 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007430 s, Result = 28a00000, Performance =  17.34 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008067 s, Result = 28b40000, Performance =  18.63 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009017 s, Result = 28c80000, Performance =  19.05 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009772 s, Result = 28dc0000, Performance =  19.78 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014605 s, Result = 28f00000, Performance =  14.70 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011833 s, Result = 29040000, Performance =  19.96 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013017 s, Result = 29180000, Performance =  19.80 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013999 s, Result = 292c0000, Performance =  19.94 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014849 s, Result = 29400000, Performance =  20.25 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015860 s, Result = 29540000, Performance =  20.31 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017295 s, Result = 29680000, Performance =  19.87 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016699 s, Result = 297c0000, Performance =  21.86 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018368 s, Result = 29900000, Performance =  21.04 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019313 s, Result = 29a40000, Performance =  21.13 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020554 s, Result = 29b80000, Performance =  20.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021419 s, Result = 29cc0000, Performance =  21.05 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022378 s, Result = 29e00000, Performance =  21.11 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022874 s, Result = 29f40000, Performance =  21.59 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024453 s, Result = 2a080000, Performance =  21.08 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025398 s, Result = 2a1c0000, Performance =  21.14 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026343 s, Result = 2a300000, Performance =  21.20 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027567 s, Result = 2a440000, Performance =  21.03 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028911 s, Result = 2a580000, Performance =  20.80 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.029143 s, Result = 2a6c0000, Performance =  21.37 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.030468 s, Result = 2a800000, Performance =  21.14 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.032069 s, Result = 2a940000, Performance =  20.76 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.033194 s, Result = 2aa80000, Performance =  20.70 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.032817 s, Result = 2abc0000, Performance =  21.59 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.033113 s, Result = 2ad00000, Performance =  22.05 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.034373 s, Result = 2ae40000, Performance =  21.87 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035164 s, Result = 2af80000, Performance =  21.99 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.037406 s, Result = 2b0c0000, Performance =  21.24 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036992 s, Result = 2b200000, Performance =  22.06 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.038680 s, Result = 2b340000, Performance =  21.65 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040589 s, Result = 2b480000, Performance =  21.16 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.040243 s, Result = 2b5c0000, Performance =  21.88 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.040951 s, Result = 2b700000, Performance =  22.03 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.041697 s, Result = 2b840000, Performance =  22.15 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.043790 s, Result = 2b980000, Performance =  21.58 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.043431 s, Result = 2bac0000, Performance =  22.25 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.044708 s, Result = 2bc00000, Performance =  22.10 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.045913 s, Result = 2bd40000, Performance =  21.98 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046403 s, Result = 2be80000, Performance =  22.21 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.046720 s, Result = 2bfc0000, Performance =  22.52 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047146 s, Result = 2c100000, Performance =  22.77 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.048873 s, Result = 2c240000, Performance =  22.41 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.049328 s, Result = 2c380000, Performance =  22.64 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.050165 s, Result = 2c4c0000, Performance =  22.69 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.051770 s, Result = 2c600000, Performance =  22.40 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.051769 s, Result = 2c740000, Performance =  22.82 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.053474 s, Result = 2c880000, Performance =  22.49 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054732 s, Result = 2c9c0000, Performance =  22.36 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.055763 s, Result = 2cb00000, Performance =  22.34 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055862 s, Result = 2cc40000, Performance =  22.68 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.057184 s, Result = 2cd80000, Performance =  22.53 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.058271 s, Result = 2cec0000, Performance =  22.48 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.059856 s, Result = 2d000000, Performance =  22.24 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.062147 s, Result = 2d140000, Performance =  21.77 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.062213 s, Result = 2d280000, Performance =  22.09 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   181    66  1600
Test passed: M N K =    99   225  1344
Test passed: M N K =  1685  1942   256
Test passed: M N K =   367  1731  1472
Test passed: M N K =  1160   958  1344
M N K =  2048  2048   256, Elapsed time =   0.000572 s, Result = 00140000, Performance =  37.56 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001071 s, Result = 00280000, Performance =  40.11 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001604 s, Result = 003c0000, Performance =  40.15 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002157 s, Result = 00500000, Performance =  39.82 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002922 s, Result = 00640000, Performance =  36.75 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003726 s, Result = 00780000, Performance =  34.58 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005644 s, Result = 008c0000, Performance =  26.63 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005525 s, Result = 00a00000, Performance =  31.10 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006054 s, Result = 00b40000, Performance =  31.92 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007447 s, Result = 00c80000, Performance =  28.84 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008455 s, Result = 00dc0000, Performance =  27.94 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009365 s, Result = 00f00000, Performance =  27.52 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010293 s, Result = 01040000, Performance =  27.12 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011336 s, Result = 01180000, Performance =  26.52 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013558 s, Result = 012c0000, Performance =  23.76 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013782 s, Result = 01400000, Performance =  24.93 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013612 s, Result = 01540000, Performance =  26.82 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014619 s, Result = 01680000, Performance =  26.44 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015852 s, Result = 017c0000, Performance =  25.74 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016618 s, Result = 01900000, Performance =  25.85 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017742 s, Result = 01a40000, Performance =  25.42 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018800 s, Result = 01b80000, Performance =  25.13 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019711 s, Result = 01cc0000, Performance =  25.06 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020503 s, Result = 01e00000, Performance =  25.14 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.021183 s, Result = 01f40000, Performance =  25.34 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022929 s, Result = 02080000, Performance =  24.35 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023964 s, Result = 021c0000, Performance =  24.20 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024263 s, Result = 02300000, Performance =  24.78 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.026149 s, Result = 02440000, Performance =  23.82 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026842 s, Result = 02580000, Performance =  24.00 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.027733 s, Result = 026c0000, Performance =  24.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030407 s, Result = 02800000, Performance =  22.60 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.029258 s, Result = 02940000, Performance =  24.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030697 s, Result = 02a80000, Performance =  23.79 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.031141 s, Result = 02bc0000, Performance =  24.14 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.033167 s, Result = 02d00000, Performance =  23.31 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.033605 s, Result = 02e40000, Performance =  23.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.034473 s, Result = 02f80000, Performance =  23.67 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.035759 s, Result = 030c0000, Performance =  23.42 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.037173 s, Result = 03200000, Performance =  23.11 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.036807 s, Result = 03340000, Performance =  23.92 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.038671 s, Result = 03480000, Performance =  23.32 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040070 s, Result = 035c0000, Performance =  23.05 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.040263 s, Result = 03700000, Performance =  23.47 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.040713 s, Result = 03840000, Performance =  23.74 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.041877 s, Result = 03980000, Performance =  23.59 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.042769 s, Result = 03ac0000, Performance =  23.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.044650 s, Result = 03c00000, Performance =  23.09 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.044663 s, Result = 03d40000, Performance =  23.56 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.044386 s, Result = 03e80000, Performance =  24.19 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.046381 s, Result = 03fc0000, Performance =  23.61 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.046695 s, Result = 04100000, Performance =  23.91 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048151 s, Result = 04240000, Performance =  23.64 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.050430 s, Result = 04380000, Performance =  22.99 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050534 s, Result = 044c0000, Performance =  23.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050953 s, Result = 04600000, Performance =  23.60 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.052608 s, Result = 04740000, Performance =  23.27 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052939 s, Result = 04880000, Performance =  23.53 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.053386 s, Result = 049c0000, Performance =  23.73 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.053669 s, Result = 04b00000, Performance =  24.01 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.054935 s, Result = 04c40000, Performance =  23.85 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057066 s, Result = 04d80000, Performance =  23.33 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.056291 s, Result = 04ec0000, Performance =  24.03 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.061700 s, Result = 05000000, Performance =  22.28 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   543  1093   832
Test passed: M N K =  1172  1536   768
Test passed: M N K =  1017    76  1920
Test passed: M N K =  1650   644  1536
Test passed: M N K =   769  1058   768
M N K =  2048  2048   256, Elapsed time =   0.007276 s, Result = 64180000, Performance =   2.95 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008098 s, Result = 842c0000, Performance =   5.30 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008748 s, Result = a4400000, Performance =   7.36 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009493 s, Result = c4540000, Performance =   9.05 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010172 s, Result = e4680000, Performance =  10.56 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010787 s, Result = 047c0000, Performance =  11.94 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011854 s, Result = 24900000, Performance =  12.68 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012246 s, Result = 44a40000, Performance =  14.03 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017069 s, Result = 64b80000, Performance =  11.32 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013589 s, Result = 84cc0000, Performance =  15.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014650 s, Result = a4e00000, Performance =  16.12 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015801 s, Result = c4f40000, Performance =  16.31 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016893 s, Result = e5080000, Performance =  16.53 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017817 s, Result = 051c0000, Performance =  16.87 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.019391 s, Result = 25300000, Performance =  16.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021553 s, Result = 45440000, Performance =  15.94 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021038 s, Result = 65580000, Performance =  17.35 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021979 s, Result = 856c0000, Performance =  17.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022708 s, Result = a5800000, Performance =  17.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.024238 s, Result = c5940000, Performance =  17.72 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024314 s, Result = e5a80000, Performance =  18.55 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025538 s, Result = 05bc0000, Performance =  18.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.026832 s, Result = 25d00000, Performance =  18.41 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027625 s, Result = 45e40000, Performance =  18.66 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.028863 s, Result = 65f80000, Performance =  18.60 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.029549 s, Result = 860c0000, Performance =  18.90 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.030176 s, Result = a6200000, Performance =  19.21 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.031248 s, Result = c6340000, Performance =  19.24 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.032330 s, Result = e6480000, Performance =  19.26 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032749 s, Result = 065c0000, Performance =  19.67 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.033741 s, Result = 26700000, Performance =  19.73 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038802 s, Result = 46840000, Performance =  17.71 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.035329 s, Result = 66980000, Performance =  20.06 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036529 s, Result = 86ac0000, Performance =  19.99 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.036647 s, Result = a6c00000, Performance =  20.51 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038034 s, Result = c6d40000, Performance =  20.33 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.038380 s, Result = e6e80000, Performance =  20.70 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.039626 s, Result = 06fc0000, Performance =  20.59 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040604 s, Result = 27100000, Performance =  20.63 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.042099 s, Result = 47240000, Performance =  20.40 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.042849 s, Result = 67380000, Performance =  20.55 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042803 s, Result = 874c0000, Performance =  21.07 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.044297 s, Result = a7600000, Performance =  20.85 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045164 s, Result = c7740000, Performance =  20.92 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045742 s, Result = e7880000, Performance =  21.13 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.046453 s, Result = 079c0000, Performance =  21.27 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.047187 s, Result = 27b00000, Performance =  21.39 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.054070 s, Result = 47c40000, Performance =  19.06 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.049189 s, Result = 67d80000, Performance =  21.39 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.050063 s, Result = 87ec0000, Performance =  21.45 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.051299 s, Result = a8000000, Performance =  21.35 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.052732 s, Result = c8140000, Performance =  21.18 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.052261 s, Result = e8280000, Performance =  21.78 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.053550 s, Result = 083c0000, Performance =  21.66 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.056382 s, Result = 28500000, Performance =  20.95 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.056459 s, Result = 48640000, Performance =  21.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.056361 s, Result = 68780000, Performance =  21.72 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.056731 s, Result = 888c0000, Performance =  21.96 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.058559 s, Result = a8a00000, Performance =  21.64 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.059830 s, Result = c8b40000, Performance =  21.54 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.059285 s, Result = e8c80000, Performance =  22.10 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.060678 s, Result = 08dc0000, Performance =  21.94 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.061793 s, Result = 28f00000, Performance =  21.89 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.079004 s, Result = 49040000, Performance =  17.40 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1050  1670   256
Test passed: M N K =   726   764   576
Test passed: M N K =  1098   812   512
Test passed: M N K =   658  1291  1792
Test passed: M N K =  1257  1926   704
M N K =  2048  2048   256, Elapsed time =   0.005818 s, Result = 00140000, Performance =   3.69 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007377 s, Result = 00280000, Performance =   5.82 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007543 s, Result = 003c0000, Performance =   8.54 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008271 s, Result = 00500000, Performance =  10.39 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009285 s, Result = 00640000, Performance =  11.56 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009356 s, Result = 00780000, Performance =  13.77 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010649 s, Result = 008c0000, Performance =  14.12 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010881 s, Result = 00a00000, Performance =  15.79 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011820 s, Result = 00b40000, Performance =  16.35 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012765 s, Result = 00c80000, Performance =  16.82 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013544 s, Result = 00dc0000, Performance =  17.44 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013799 s, Result = 00f00000, Performance =  18.67 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015598 s, Result = 01040000, Performance =  17.90 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015777 s, Result = 01180000, Performance =  19.06 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017550 s, Result = 012c0000, Performance =  18.35 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019291 s, Result = 01400000, Performance =  17.81 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019581 s, Result = 01540000, Performance =  18.64 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020226 s, Result = 01680000, Performance =  19.11 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021524 s, Result = 017c0000, Performance =  18.96 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022102 s, Result = 01900000, Performance =  19.43 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022851 s, Result = 01a40000, Performance =  19.74 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024500 s, Result = 01b80000, Performance =  19.28 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025024 s, Result = 01cc0000, Performance =  19.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026159 s, Result = 01e00000, Performance =  19.70 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026513 s, Result = 01f40000, Performance =  20.25 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.027685 s, Result = 02080000, Performance =  20.17 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.028537 s, Result = 021c0000, Performance =  20.32 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.029816 s, Result = 02300000, Performance =  20.17 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.030841 s, Result = 02440000, Performance =  20.19 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.030983 s, Result = 02580000, Performance =  20.79 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.032404 s, Result = 026c0000, Performance =  20.54 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043851 s, Result = 02800000, Performance =  15.67 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.033947 s, Result = 02940000, Performance =  20.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.034397 s, Result = 02a80000, Performance =  21.23 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.035059 s, Result = 02bc0000, Performance =  21.44 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035731 s, Result = 02d00000, Performance =  21.64 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.036914 s, Result = 02e40000, Performance =  21.52 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.037447 s, Result = 02f80000, Performance =  21.79 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.038708 s, Result = 030c0000, Performance =  21.64 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040309 s, Result = 03200000, Performance =  21.31 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.040345 s, Result = 03340000, Performance =  21.82 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.041117 s, Result = 03480000, Performance =  21.94 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.042441 s, Result = 035c0000, Performance =  21.76 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.042602 s, Result = 03700000, Performance =  22.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.044902 s, Result = 03840000, Performance =  21.52 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.044677 s, Result = 03980000, Performance =  22.11 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.045503 s, Result = 03ac0000, Performance =  22.18 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.052940 s, Result = 03c00000, Performance =  19.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047809 s, Result = 03d40000, Performance =  22.01 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.048000 s, Result = 03e80000, Performance =  22.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.049544 s, Result = 03fc0000, Performance =  22.11 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.050583 s, Result = 04100000, Performance =  22.08 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.051210 s, Result = 04240000, Performance =  22.23 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.051362 s, Result = 04380000, Performance =  22.58 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.052802 s, Result = 044c0000, Performance =  22.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.054274 s, Result = 04600000, Performance =  22.16 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.055525 s, Result = 04740000, Performance =  22.05 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.055997 s, Result = 04880000, Performance =  22.24 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.056973 s, Result = 049c0000, Performance =  22.24 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.059767 s, Result = 04b00000, Performance =  21.56 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.057849 s, Result = 04c40000, Performance =  22.64 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057940 s, Result = 04d80000, Performance =  22.98 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.059040 s, Result = 04ec0000, Performance =  22.92 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.080604 s, Result = 05000000, Performance =  17.05 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   943  1680  1664
Test passed: M N K =  1490  1216   832
Test passed: M N K =  1082   944  1088
Test passed: M N K =  1928   223  1984
Test passed: M N K =  1285   768   192
M N K =  2048  2048   256, Elapsed time =   0.003706 s, Result = 283c0000, Performance =   5.79 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004341 s, Result = 28500000, Performance =   9.89 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005136 s, Result = 28640000, Performance =  12.54 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005716 s, Result = 28780000, Performance =  15.03 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006511 s, Result = 288c0000, Performance =  16.49 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007344 s, Result = 28a00000, Performance =  17.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008117 s, Result = 28b40000, Performance =  18.52 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008728 s, Result = 28c80000, Performance =  19.68 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017526 s, Result = 28dc0000, Performance =  11.03 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010293 s, Result = 28f00000, Performance =  20.86 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011221 s, Result = 29040000, Performance =  21.05 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011922 s, Result = 29180000, Performance =  21.61 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013422 s, Result = 292c0000, Performance =  20.80 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014396 s, Result = 29400000, Performance =  20.88 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015629 s, Result = 29540000, Performance =  20.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017558 s, Result = 29680000, Performance =  19.57 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017056 s, Result = 297c0000, Performance =  21.40 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018003 s, Result = 29900000, Performance =  21.47 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019547 s, Result = 29a40000, Performance =  20.87 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019667 s, Result = 29b80000, Performance =  21.84 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020606 s, Result = 29cc0000, Performance =  21.89 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021613 s, Result = 29e00000, Performance =  21.86 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022630 s, Result = 29f40000, Performance =  21.83 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024076 s, Result = 2a080000, Performance =  21.41 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024268 s, Result = 2a1c0000, Performance =  22.12 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.025839 s, Result = 2a300000, Performance =  21.61 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.026052 s, Result = 2a440000, Performance =  22.26 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027538 s, Result = 2a580000, Performance =  21.84 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.028741 s, Result = 2a6c0000, Performance =  21.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029127 s, Result = 2a800000, Performance =  22.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030396 s, Result = 2a940000, Performance =  21.90 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.040559 s, Result = 2aa80000, Performance =  16.94 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.031991 s, Result = 2abc0000, Performance =  22.15 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032661 s, Result = 2ad00000, Performance =  22.36 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.033011 s, Result = 2ae40000, Performance =  22.77 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034184 s, Result = 2af80000, Performance =  22.62 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035375 s, Result = 2b0c0000, Performance =  22.46 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036071 s, Result = 2b200000, Performance =  22.62 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037818 s, Result = 2b340000, Performance =  22.15 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.039256 s, Result = 2b480000, Performance =  21.88 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.039075 s, Result = 2b5c0000, Performance =  22.53 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.040155 s, Result = 2b700000, Performance =  22.46 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.041357 s, Result = 2b840000, Performance =  22.33 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.041849 s, Result = 2b980000, Performance =  22.58 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.042826 s, Result = 2bac0000, Performance =  22.57 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.043350 s, Result = 2bc00000, Performance =  22.79 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.044279 s, Result = 2bd40000, Performance =  22.79 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.050744 s, Result = 2be80000, Performance =  20.31 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.046241 s, Result = 2bfc0000, Performance =  22.76 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047874 s, Result = 2c100000, Performance =  22.43 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047961 s, Result = 2c240000, Performance =  22.84 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.049218 s, Result = 2c380000, Performance =  22.69 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.049701 s, Result = 2c4c0000, Performance =  22.90 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.051097 s, Result = 2c600000, Performance =  22.69 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050356 s, Result = 2c740000, Performance =  23.46 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.053843 s, Result = 2c880000, Performance =  22.34 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.053140 s, Result = 2c9c0000, Performance =  23.03 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.054175 s, Result = 2cb00000, Performance =  22.99 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055572 s, Result = 2cc40000, Performance =  22.80 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056292 s, Result = 2cd80000, Performance =  22.89 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.057482 s, Result = 2cec0000, Performance =  22.79 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057625 s, Result = 2d000000, Performance =  23.11 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.058505 s, Result = 2d140000, Performance =  23.12 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.077801 s, Result = 2d280000, Performance =  17.67 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   608  1170  2048
Test passed: M N K =    20   673  1472
Test passed: M N K =  2031   283   640
Test passed: M N K =   266  1709  1536
Test passed: M N K =    44    24   512
M N K =  2048  2048   256, Elapsed time =   0.000603 s, Result = 00140000, Performance =  35.62 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001156 s, Result = 00280000, Performance =  37.17 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001924 s, Result = 003c0000, Performance =  33.48 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002565 s, Result = 00500000, Performance =  33.49 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003886 s, Result = 00640000, Performance =  27.63 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004272 s, Result = 00780000, Performance =  30.16 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005410 s, Result = 008c0000, Performance =  27.78 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005638 s, Result = 00a00000, Performance =  30.47 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006969 s, Result = 00b40000, Performance =  27.73 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008840 s, Result = 00c80000, Performance =  24.29 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008843 s, Result = 00dc0000, Performance =  26.71 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008940 s, Result = 00f00000, Performance =  28.83 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010395 s, Result = 01040000, Performance =  26.86 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011057 s, Result = 01180000, Performance =  27.19 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012404 s, Result = 012c0000, Performance =  25.97 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014929 s, Result = 01400000, Performance =  23.02 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013605 s, Result = 01540000, Performance =  26.83 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014902 s, Result = 01680000, Performance =  25.94 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016902 s, Result = 017c0000, Performance =  24.14 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017019 s, Result = 01900000, Performance =  25.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017509 s, Result = 01a40000, Performance =  25.76 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018465 s, Result = 01b80000, Performance =  25.59 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019285 s, Result = 01cc0000, Performance =  25.61 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021080 s, Result = 01e00000, Performance =  24.45 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.021477 s, Result = 01f40000, Performance =  25.00 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022594 s, Result = 02080000, Performance =  24.71 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023062 s, Result = 021c0000, Performance =  25.14 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024584 s, Result = 02300000, Performance =  24.46 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025180 s, Result = 02440000, Performance =  24.73 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026250 s, Result = 02580000, Performance =  24.54 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026696 s, Result = 026c0000, Performance =  24.94 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.041937 s, Result = 02800000, Performance =  16.39 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.028765 s, Result = 02940000, Performance =  24.64 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.029429 s, Result = 02a80000, Performance =  24.81 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.029987 s, Result = 02bc0000, Performance =  25.06 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031829 s, Result = 02d00000, Performance =  24.29 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032361 s, Result = 02e40000, Performance =  24.55 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.032985 s, Result = 02f80000, Performance =  24.74 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.033460 s, Result = 030c0000, Performance =  25.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036336 s, Result = 03200000, Performance =  23.64 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.036103 s, Result = 03340000, Performance =  24.39 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.036923 s, Result = 03480000, Performance =  24.43 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.037768 s, Result = 035c0000, Performance =  24.45 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.038855 s, Result = 03700000, Performance =  24.32 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.039534 s, Result = 03840000, Performance =  24.44 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.040467 s, Result = 03980000, Performance =  24.41 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.041289 s, Result = 03ac0000, Performance =  24.45 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.047957 s, Result = 03c00000, Performance =  21.49 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.043468 s, Result = 03d40000, Performance =  24.21 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.042870 s, Result = 03e80000, Performance =  25.05 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.043918 s, Result = 03fc0000, Performance =  24.94 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045680 s, Result = 04100000, Performance =  24.45 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.046197 s, Result = 04240000, Performance =  24.64 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.046809 s, Result = 04380000, Performance =  24.77 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.047828 s, Result = 044c0000, Performance =  24.70 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050696 s, Result = 04600000, Performance =  23.72 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.049413 s, Result = 04740000, Performance =  24.77 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.051183 s, Result = 04880000, Performance =  24.33 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.051719 s, Result = 049c0000, Performance =  24.50 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052785 s, Result = 04b00000, Performance =  24.41 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053047 s, Result = 04c40000, Performance =  24.69 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.053203 s, Result = 04d80000, Performance =  25.03 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.054081 s, Result = 04ec0000, Performance =  25.02 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.077885 s, Result = 05000000, Performance =  17.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =     1   950   128
Test passed: M N K =  1173   442  1472
Test passed: M N K =   116    58  1984
Test passed: M N K =   725  1121   704
Test passed: M N K =   827  1871  1984
M N K =  2048  2048   256, Elapsed time =   0.007379 s, Result = 64180000, Performance =   2.91 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008055 s, Result = 842c0000, Performance =   5.33 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008483 s, Result = a4400000, Performance =   7.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009353 s, Result = c4540000, Performance =   9.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010214 s, Result = e4680000, Performance =  10.51 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014410 s, Result = 047c0000, Performance =   8.94 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011596 s, Result = 24900000, Performance =  12.96 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012556 s, Result = 44a40000, Performance =  13.68 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013362 s, Result = 64b80000, Performance =  14.46 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014481 s, Result = 84cc0000, Performance =  14.83 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015072 s, Result = a4e00000, Performance =  15.67 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016061 s, Result = c4f40000, Performance =  16.04 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.017164 s, Result = e5080000, Performance =  16.27 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018038 s, Result = 051c0000, Performance =  16.67 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.019318 s, Result = 25300000, Performance =  16.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022086 s, Result = 45440000, Performance =  15.56 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021658 s, Result = 65580000, Performance =  16.86 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022809 s, Result = 856c0000, Performance =  16.95 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.024055 s, Result = a5800000, Performance =  16.96 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.025677 s, Result = c5940000, Performance =  16.73 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.026095 s, Result = e5a80000, Performance =  17.28 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.027540 s, Result = 05bc0000, Performance =  17.16 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027987 s, Result = 25d00000, Performance =  17.65 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.029331 s, Result = 45e40000, Performance =  17.57 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030595 s, Result = 65f80000, Performance =  17.55 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031774 s, Result = 860c0000, Performance =  17.57 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.032307 s, Result = a6200000, Performance =  17.95 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.034205 s, Result = c6340000, Performance =  17.58 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.034393 s, Result = e6480000, Performance =  18.11 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.035320 s, Result = 065c0000, Performance =  18.24 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035992 s, Result = 26700000, Performance =  18.50 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.045790 s, Result = 46840000, Performance =  15.01 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.038591 s, Result = 66980000, Performance =  18.36 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.039342 s, Result = 86ac0000, Performance =  18.56 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.040210 s, Result = a6c00000, Performance =  18.69 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.041996 s, Result = c6d40000, Performance =  18.41 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.042457 s, Result = e6e80000, Performance =  18.71 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.043465 s, Result = 06fc0000, Performance =  18.77 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.043809 s, Result = 27100000, Performance =  19.12 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.044986 s, Result = 47240000, Performance =  19.09 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.045985 s, Result = 67380000, Performance =  19.15 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.047071 s, Result = 874c0000, Performance =  19.16 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.048475 s, Result = a7600000, Performance =  19.05 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.050085 s, Result = c7740000, Performance =  18.87 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.049451 s, Result = e7880000, Performance =  19.54 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.050844 s, Result = 079c0000, Performance =  19.43 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.051599 s, Result = 27b00000, Performance =  19.56 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.057826 s, Result = 47c40000, Performance =  17.83 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.053775 s, Result = 67d80000, Performance =  19.57 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.054544 s, Result = 87ec0000, Performance =  19.69 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.055610 s, Result = a8000000, Performance =  19.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.057618 s, Result = c8140000, Performance =  19.38 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.057729 s, Result = e8280000, Performance =  19.72 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.061568 s, Result = 083c0000, Performance =  18.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.060840 s, Result = 28500000, Performance =  19.41 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.061400 s, Result = 48640000, Performance =  19.59 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.061700 s, Result = 68780000, Performance =  19.84 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.063542 s, Result = 888c0000, Performance =  19.60 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.064407 s, Result = a8a00000, Performance =  19.67 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.066133 s, Result = c8b40000, Performance =  19.48 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.065653 s, Result = e8c80000, Performance =  19.95 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.066060 s, Result = 08dc0000, Performance =  20.16 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.066386 s, Result = 28f00000, Performance =  20.38 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.081981 s, Result = 49040000, Performance =  16.76 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1371  1809  1344
Test passed: M N K =  1746   980  1216
Test passed: M N K =   281   431   576
Test passed: M N K =  1951  1241    64
Test passed: M N K =  1003   398  1024
M N K =  2048  2048   256, Elapsed time =   0.006319 s, Result = 00140000, Performance =   3.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007038 s, Result = 00280000, Performance =   6.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007297 s, Result = 003c0000, Performance =   8.83 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008003 s, Result = 00500000, Performance =  10.73 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008965 s, Result = 00640000, Performance =  11.98 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009389 s, Result = 00780000, Performance =  13.72 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010514 s, Result = 008c0000, Performance =  14.30 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010902 s, Result = 00a00000, Performance =  15.76 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016239 s, Result = 00b40000, Performance =  11.90 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013268 s, Result = 00c80000, Performance =  16.19 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013847 s, Result = 00dc0000, Performance =  17.06 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014246 s, Result = 00f00000, Performance =  18.09 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015595 s, Result = 01040000, Performance =  17.90 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016847 s, Result = 01180000, Performance =  17.85 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017604 s, Result = 012c0000, Performance =  18.30 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019817 s, Result = 01400000, Performance =  17.34 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021139 s, Result = 01540000, Performance =  17.27 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021810 s, Result = 01680000, Performance =  17.72 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022813 s, Result = 017c0000, Performance =  17.89 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023870 s, Result = 01900000, Performance =  17.99 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025348 s, Result = 01a40000, Performance =  17.79 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026201 s, Result = 01b80000, Performance =  18.03 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.026452 s, Result = 01cc0000, Performance =  18.67 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027634 s, Result = 01e00000, Performance =  18.65 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029063 s, Result = 01f40000, Performance =  18.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.029942 s, Result = 02080000, Performance =  18.65 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031039 s, Result = 021c0000, Performance =  18.68 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032251 s, Result = 02300000, Performance =  18.64 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033130 s, Result = 02440000, Performance =  18.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.033880 s, Result = 02580000, Performance =  19.02 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.034268 s, Result = 026c0000, Performance =  19.43 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043376 s, Result = 02800000, Performance =  15.84 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037082 s, Result = 02940000, Performance =  19.11 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.037244 s, Result = 02a80000, Performance =  19.60 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.038077 s, Result = 02bc0000, Performance =  19.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.039434 s, Result = 02d00000, Performance =  19.60 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.040851 s, Result = 02e40000, Performance =  19.45 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.041422 s, Result = 02f80000, Performance =  19.70 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.042698 s, Result = 030c0000, Performance =  19.61 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.043171 s, Result = 03200000, Performance =  19.90 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.044427 s, Result = 03340000, Performance =  19.82 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.045398 s, Result = 03480000, Performance =  19.87 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.046664 s, Result = 035c0000, Performance =  19.79 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.047993 s, Result = 03700000, Performance =  19.69 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.048113 s, Result = 03840000, Performance =  20.09 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.049271 s, Result = 03980000, Performance =  20.05 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.050008 s, Result = 03ac0000, Performance =  20.18 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.056219 s, Result = 03c00000, Performance =  18.34 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.052456 s, Result = 03d40000, Performance =  20.06 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.053294 s, Result = 03e80000, Performance =  20.15 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.053936 s, Result = 03fc0000, Performance =  20.31 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.056363 s, Result = 04100000, Performance =  19.81 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.056498 s, Result = 04240000, Performance =  20.15 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.057486 s, Result = 04380000, Performance =  20.17 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.058280 s, Result = 044c0000, Performance =  20.27 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.058803 s, Result = 04600000, Performance =  20.45 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.059885 s, Result = 04740000, Performance =  20.44 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.062207 s, Result = 04880000, Performance =  20.02 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.061814 s, Result = 049c0000, Performance =  20.50 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.063877 s, Result = 04b00000, Performance =  20.17 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.066062 s, Result = 04c40000, Performance =  19.83 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.065326 s, Result = 04d80000, Performance =  20.38 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.064890 s, Result = 04ec0000, Performance =  20.85 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.080521 s, Result = 05000000, Performance =  17.07 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  2017    22  1152
Test passed: M N K =  1204   742   576
Test passed: M N K =   444  1786   768
Test passed: M N K =   351  1622  2048
Test passed: M N K =  1949  1838   192
M N K =  2048  2048   256, Elapsed time =   0.003819 s, Result = 283c0000, Performance =   5.62 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004346 s, Result = 28500000, Performance =   9.88 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004907 s, Result = 28640000, Performance =  13.13 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005560 s, Result = 28780000, Performance =  15.45 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006481 s, Result = 288c0000, Performance =  16.57 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007200 s, Result = 28a00000, Performance =  17.90 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008079 s, Result = 28b40000, Performance =  18.61 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008886 s, Result = 28c80000, Performance =  19.33 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014683 s, Result = 28dc0000, Performance =  13.16 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010864 s, Result = 28f00000, Performance =  19.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011867 s, Result = 29040000, Performance =  19.91 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013241 s, Result = 29180000, Performance =  19.46 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013584 s, Result = 292c0000, Performance =  20.55 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014557 s, Result = 29400000, Performance =  20.65 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015665 s, Result = 29540000, Performance =  20.56 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018662 s, Result = 29680000, Performance =  18.41 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018661 s, Result = 297c0000, Performance =  19.56 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019723 s, Result = 29900000, Performance =  19.60 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020952 s, Result = 29a40000, Performance =  19.47 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022494 s, Result = 29b80000, Performance =  19.09 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023762 s, Result = 29cc0000, Performance =  18.98 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024628 s, Result = 29e00000, Performance =  19.18 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025264 s, Result = 29f40000, Performance =  19.55 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026598 s, Result = 2a080000, Performance =  19.38 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.027676 s, Result = 2a1c0000, Performance =  19.40 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028772 s, Result = 2a300000, Performance =  19.41 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029522 s, Result = 2a440000, Performance =  19.64 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.031366 s, Result = 2a580000, Performance =  19.17 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031808 s, Result = 2a6c0000, Performance =  19.58 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032406 s, Result = 2a800000, Performance =  19.88 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.033141 s, Result = 2a940000, Performance =  20.09 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.042172 s, Result = 2aa80000, Performance =  16.29 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.036076 s, Result = 2abc0000, Performance =  19.64 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036425 s, Result = 2ad00000, Performance =  20.04 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.037643 s, Result = 2ae40000, Performance =  19.97 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.039168 s, Result = 2af80000, Performance =  19.74 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.039181 s, Result = 2b0c0000, Performance =  20.28 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040299 s, Result = 2b200000, Performance =  20.25 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.041484 s, Result = 2b340000, Performance =  20.19 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.042936 s, Result = 2b480000, Performance =  20.01 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.043554 s, Result = 2b5c0000, Performance =  20.22 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.044667 s, Result = 2b700000, Performance =  20.19 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.046011 s, Result = 2b840000, Performance =  20.07 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.047680 s, Result = 2b980000, Performance =  19.82 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.047746 s, Result = 2bac0000, Performance =  20.24 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.048336 s, Result = 2bc00000, Performance =  20.44 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.049221 s, Result = 2bd40000, Performance =  20.51 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.056239 s, Result = 2be80000, Performance =  18.33 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.050903 s, Result = 2bfc0000, Performance =  20.67 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.052207 s, Result = 2c100000, Performance =  20.57 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.053654 s, Result = 2c240000, Performance =  20.41 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.055321 s, Result = 2c380000, Performance =  20.19 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.055746 s, Result = 2c4c0000, Performance =  20.42 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.057124 s, Result = 2c600000, Performance =  20.30 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.057340 s, Result = 2c740000, Performance =  20.60 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.059485 s, Result = 2c880000, Performance =  20.22 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.060193 s, Result = 2c9c0000, Performance =  20.34 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.060605 s, Result = 2cb00000, Performance =  20.55 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.061381 s, Result = 2cc40000, Performance =  20.64 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.063769 s, Result = 2cd80000, Performance =  20.21 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.063859 s, Result = 2cec0000, Performance =  20.51 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.064279 s, Result = 2d000000, Performance =  20.71 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.064151 s, Result = 2d140000, Performance =  21.09 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.080863 s, Result = 2d280000, Performance =  17.00 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1534  1578   960
Test passed: M N K =  1053    83  1280
Test passed: M N K =  1793  2025  2048
Test passed: M N K =   139   470   896
Test passed: M N K =   326   279  1344
M N K =  2048  2048   256, Elapsed time =   0.000608 s, Result = 00140000, Performance =  35.29 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001120 s, Result = 00280000, Performance =  38.34 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001661 s, Result = 003c0000, Performance =  38.79 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003477 s, Result = 00500000, Performance =  24.71 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003584 s, Result = 00640000, Performance =  29.96 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004202 s, Result = 00780000, Performance =  30.66 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005572 s, Result = 008c0000, Performance =  26.98 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006514 s, Result = 00a00000, Performance =  26.37 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007966 s, Result = 00b40000, Performance =  24.26 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009297 s, Result = 00c80000, Performance =  23.10 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010176 s, Result = 00dc0000, Performance =  23.21 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011097 s, Result = 00f00000, Performance =  23.22 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011527 s, Result = 01040000, Performance =  24.22 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012778 s, Result = 01180000, Performance =  23.53 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014497 s, Result = 012c0000, Performance =  22.22 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016786 s, Result = 01400000, Performance =  20.47 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016343 s, Result = 01540000, Performance =  22.34 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017570 s, Result = 01680000, Performance =  22.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018663 s, Result = 017c0000, Performance =  21.86 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020443 s, Result = 01900000, Performance =  21.01 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021099 s, Result = 01a40000, Performance =  21.37 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022262 s, Result = 01b80000, Performance =  21.22 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.023491 s, Result = 01cc0000, Performance =  21.03 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024250 s, Result = 01e00000, Performance =  21.25 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025247 s, Result = 01f40000, Performance =  21.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026664 s, Result = 02080000, Performance =  20.94 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027179 s, Result = 021c0000, Performance =  21.33 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.029312 s, Result = 02300000, Performance =  20.51 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.029524 s, Result = 02440000, Performance =  21.09 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.030445 s, Result = 02580000, Performance =  21.16 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030594 s, Result = 026c0000, Performance =  21.76 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039918 s, Result = 02800000, Performance =  17.22 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.033072 s, Result = 02940000, Performance =  21.43 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.034011 s, Result = 02a80000, Performance =  21.47 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.034469 s, Result = 02bc0000, Performance =  21.81 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.036639 s, Result = 02d00000, Performance =  21.10 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.037191 s, Result = 02e40000, Performance =  21.36 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.039031 s, Result = 02f80000, Performance =  20.91 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.039188 s, Result = 030c0000, Performance =  21.37 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040074 s, Result = 03200000, Performance =  21.44 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041395 s, Result = 03340000, Performance =  21.27 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042566 s, Result = 03480000, Performance =  21.19 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.044101 s, Result = 035c0000, Performance =  20.94 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045119 s, Result = 03700000, Performance =  20.94 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045274 s, Result = 03840000, Performance =  21.34 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045648 s, Result = 03980000, Performance =  21.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046556 s, Result = 03ac0000, Performance =  21.68 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.053238 s, Result = 03c00000, Performance =  19.36 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.048319 s, Result = 03d40000, Performance =  21.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.049854 s, Result = 03e80000, Performance =  21.54 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.051519 s, Result = 03fc0000, Performance =  21.26 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.053325 s, Result = 04100000, Performance =  20.94 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.053599 s, Result = 04240000, Performance =  21.23 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.054158 s, Result = 04380000, Performance =  21.41 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.055069 s, Result = 044c0000, Performance =  21.45 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.056469 s, Result = 04600000, Performance =  21.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.057362 s, Result = 04740000, Performance =  21.34 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.057621 s, Result = 04880000, Performance =  21.62 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.059092 s, Result = 049c0000, Performance =  21.44 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.060803 s, Result = 04b00000, Performance =  21.19 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.060846 s, Result = 04c40000, Performance =  21.53 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.060784 s, Result = 04d80000, Performance =  21.90 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.062411 s, Result = 04ec0000, Performance =  21.68 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.076916 s, Result = 05000000, Performance =  17.87 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   174   899  2048
Test passed: M N K =  1604   846  1472
Test passed: M N K =   789  1101  1088
Test passed: M N K =  1820   670  1984
Test passed: M N K =  1703  1884   768
M N K =  2048  2048   256, Elapsed time =   0.006078 s, Result = 34130000, Performance =   3.53 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007081 s, Result = e4220000, Performance =   6.07 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007337 s, Result = 94310000, Performance =   8.78 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007860 s, Result = 44400000, Performance =  10.93 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008555 s, Result = f44f0000, Performance =  12.55 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009225 s, Result = a45e0000, Performance =  13.97 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010132 s, Result = 546d0000, Performance =  14.84 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011166 s, Result = 047c0000, Performance =  15.39 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.019570 s, Result = b48b0000, Performance =   9.88 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012503 s, Result = 649a0000, Performance =  17.18 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013578 s, Result = 14a90000, Performance =  17.40 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014344 s, Result = c4b80000, Performance =  17.97 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015441 s, Result = 74c70000, Performance =  18.08 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016485 s, Result = 24d60000, Performance =  18.24 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016761 s, Result = d4e50000, Performance =  19.22 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018382 s, Result = 84f40000, Performance =  18.69 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018014 s, Result = 35030000, Performance =  20.27 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019524 s, Result = e5120000, Performance =  19.80 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019361 s, Result = 95210000, Performance =  21.07 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020237 s, Result = 45300000, Performance =  21.22 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020837 s, Result = f53f0000, Performance =  21.64 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021472 s, Result = a54e0000, Performance =  22.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022740 s, Result = 555d0000, Performance =  21.72 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.023203 s, Result = 056c0000, Performance =  22.21 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024296 s, Result = b57b0000, Performance =  22.10 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024405 s, Result = 658a0000, Performance =  22.88 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025011 s, Result = 15990000, Performance =  23.18 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.026068 s, Result = c5a80000, Performance =  23.07 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027683 s, Result = 75b70000, Performance =  22.50 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.027866 s, Result = 25c60000, Performance =  23.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028697 s, Result = d5d50000, Performance =  23.20 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029665 s, Result = 85e40000, Performance =  23.17 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030524 s, Result = 35f30000, Performance =  23.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.029589 s, Result = e6020000, Performance =  24.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.031641 s, Result = 96110000, Performance =  23.75 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031569 s, Result = 46200000, Performance =  24.49 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032857 s, Result = f62f0000, Performance =  24.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033523 s, Result = a63e0000, Performance =  24.34 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.033739 s, Result = 564d0000, Performance =  24.82 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.035226 s, Result = 065c0000, Performance =  24.38 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.034373 s, Result = b66b0000, Performance =  25.62 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.035372 s, Result = 667a0000, Performance =  25.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.035810 s, Result = 16890000, Performance =  25.79 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.038225 s, Result = c6980000, Performance =  24.72 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.037346 s, Result = 76a70000, Performance =  25.88 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.038500 s, Result = 26b60000, Performance =  25.66 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.039881 s, Result = d6c50000, Performance =  25.31 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041146 s, Result = 86d40000, Performance =  25.05 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039961 s, Result = 36e30000, Performance =  26.33 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.041154 s, Result = e6f20000, Performance =  26.09 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.041822 s, Result = 97010000, Performance =  26.19 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.042688 s, Result = 47100000, Performance =  26.16 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.042496 s, Result = f71f0000, Performance =  26.78 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.044813 s, Result = a72e0000, Performance =  25.88 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.045381 s, Result = 573d0000, Performance =  26.03 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045109 s, Result = 074c0000, Performance =  26.66 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.045314 s, Result = b75b0000, Performance =  27.01 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.048910 s, Result = 676a0000, Performance =  25.47 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.049245 s, Result = 17790000, Performance =  25.73 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.049294 s, Result = c7880000, Performance =  26.14 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.048807 s, Result = 77970000, Performance =  26.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.049506 s, Result = 27a60000, Performance =  26.89 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.052484 s, Result = d7b50000, Performance =  25.78 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.058125 s, Result = 87c40000, Performance =  23.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1221    96  1536
Test passed: M N K =    54  1754   640
Test passed: M N K =   414  1174  2048
Test passed: M N K =  1896   870  1152
Test passed: M N K =  1430   701  2048
M N K =  2048  2048   256, Elapsed time =   0.006045 s, Result = 000f0000, Performance =   3.55 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005993 s, Result = 001e0000, Performance =   7.17 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005944 s, Result = 002d0000, Performance =  10.84 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006291 s, Result = 003c0000, Performance =  13.65 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007027 s, Result = 004b0000, Performance =  15.28 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007469 s, Result = 005a0000, Performance =  17.25 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008474 s, Result = 00690000, Performance =  17.74 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009507 s, Result = 00780000, Performance =  18.07 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013376 s, Result = 00870000, Performance =  14.45 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010859 s, Result = 00960000, Performance =  19.78 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011382 s, Result = 00a50000, Performance =  20.75 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012519 s, Result = 00b40000, Performance =  20.58 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013310 s, Result = 00c30000, Performance =  20.98 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013876 s, Result = 00d20000, Performance =  21.67 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015154 s, Result = 00e10000, Performance =  21.26 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016579 s, Result = 00f00000, Performance =  20.73 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016311 s, Result = 00ff0000, Performance =  22.38 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017512 s, Result = 010e0000, Performance =  22.07 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018070 s, Result = 011d0000, Performance =  22.58 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018849 s, Result = 012c0000, Performance =  22.79 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019308 s, Result = 013b0000, Performance =  23.36 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019331 s, Result = 014a0000, Performance =  24.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020621 s, Result = 01590000, Performance =  23.95 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021025 s, Result = 01680000, Performance =  24.51 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022031 s, Result = 01770000, Performance =  24.37 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022621 s, Result = 01860000, Performance =  24.68 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023486 s, Result = 01950000, Performance =  24.69 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024196 s, Result = 01a40000, Performance =  24.85 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025054 s, Result = 01b30000, Performance =  24.86 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025666 s, Result = 01c20000, Performance =  25.10 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.025829 s, Result = 01d10000, Performance =  25.77 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026908 s, Result = 01e00000, Performance =  25.54 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.028037 s, Result = 01ef0000, Performance =  25.28 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027699 s, Result = 01fe0000, Performance =  26.36 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028946 s, Result = 020d0000, Performance =  25.97 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.029309 s, Result = 021c0000, Performance =  26.38 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029559 s, Result = 022b0000, Performance =  26.88 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.030853 s, Result = 023a0000, Performance =  26.45 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.031834 s, Result = 02490000, Performance =  26.31 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032424 s, Result = 02580000, Performance =  26.49 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.032456 s, Result = 02670000, Performance =  27.13 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.033303 s, Result = 02760000, Performance =  27.08 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.034200 s, Result = 02850000, Performance =  27.00 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034605 s, Result = 02940000, Performance =  27.30 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.035442 s, Result = 02a30000, Performance =  27.27 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.036311 s, Result = 02b20000, Performance =  27.20 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.036364 s, Result = 02c10000, Performance =  27.76 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.039595 s, Result = 02d00000, Performance =  26.03 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.038954 s, Result = 02df0000, Performance =  27.01 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.039594 s, Result = 02ee0000, Performance =  27.12 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.039782 s, Result = 02fd0000, Performance =  27.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040904 s, Result = 030c0000, Performance =  27.30 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.042820 s, Result = 031b0000, Performance =  26.58 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.041680 s, Result = 032a0000, Performance =  27.82 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.042048 s, Result = 03390000, Performance =  28.09 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.043527 s, Result = 03480000, Performance =  27.63 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.044669 s, Result = 03570000, Performance =  27.40 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044966 s, Result = 03660000, Performance =  27.70 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.047367 s, Result = 03750000, Performance =  26.75 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.046012 s, Result = 03840000, Performance =  28.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.047128 s, Result = 03930000, Performance =  27.80 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.048479 s, Result = 03a20000, Performance =  27.46 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.049078 s, Result = 03b10000, Performance =  27.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053259 s, Result = 03c00000, Performance =  25.81 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   284  1030  1408
Test passed: M N K =   143  1824  1024
Test passed: M N K =    67  1045   640
Test passed: M N K =  1221  1090  1408
Test passed: M N K =   436  1039  1216
M N K =  2048  2048   256, Elapsed time =   0.003309 s, Result = 28370000, Performance =   6.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004249 s, Result = 28460000, Performance =  10.11 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004729 s, Result = 28550000, Performance =  13.62 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005076 s, Result = 28640000, Performance =  16.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005683 s, Result = 28730000, Performance =  18.89 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006429 s, Result = 28820000, Performance =  20.04 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007055 s, Result = 28910000, Performance =  21.31 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007926 s, Result = 28a00000, Performance =  21.68 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008341 s, Result = 28af0000, Performance =  23.17 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013501 s, Result = 28be0000, Performance =  15.91 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010349 s, Result = 28cd0000, Performance =  22.83 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011405 s, Result = 28dc0000, Performance =  22.60 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012181 s, Result = 28eb0000, Performance =  22.92 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013133 s, Result = 28fa0000, Performance =  22.89 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013877 s, Result = 29090000, Performance =  23.21 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015088 s, Result = 29180000, Performance =  22.77 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014377 s, Result = 29270000, Performance =  25.39 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015320 s, Result = 29360000, Performance =  25.23 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016121 s, Result = 29450000, Performance =  25.31 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016494 s, Result = 29540000, Performance =  26.04 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017809 s, Result = 29630000, Performance =  25.32 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017503 s, Result = 29720000, Performance =  26.99 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020133 s, Result = 29810000, Performance =  24.53 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019918 s, Result = 29900000, Performance =  25.88 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020429 s, Result = 299f0000, Performance =  26.28 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020815 s, Result = 29ae0000, Performance =  26.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021138 s, Result = 29bd0000, Performance =  27.43 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022461 s, Result = 29cc0000, Performance =  26.77 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023987 s, Result = 29db0000, Performance =  25.96 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023992 s, Result = 29ea0000, Performance =  26.85 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024257 s, Result = 29f90000, Performance =  27.44 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.027290 s, Result = 2a080000, Performance =  25.18 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025375 s, Result = 2a170000, Performance =  27.93 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026928 s, Result = 2a260000, Performance =  27.11 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.027124 s, Result = 2a350000, Performance =  27.71 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.028379 s, Result = 2a440000, Performance =  27.24 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029049 s, Result = 2a530000, Performance =  27.35 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.031116 s, Result = 2a620000, Performance =  26.23 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.031641 s, Result = 2a710000, Performance =  26.47 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.030961 s, Result = 2a800000, Performance =  27.74 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031723 s, Result = 2a8f0000, Performance =  27.75 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.032658 s, Result = 2a9e0000, Performance =  27.62 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.033416 s, Result = 2aad0000, Performance =  27.63 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034538 s, Result = 2abc0000, Performance =  27.36 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.034766 s, Result = 2acb0000, Performance =  27.80 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.035200 s, Result = 2ada0000, Performance =  28.06 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.036171 s, Result = 2ae90000, Performance =  27.90 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.039582 s, Result = 2af80000, Performance =  26.04 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.036573 s, Result = 2b070000, Performance =  28.77 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.037524 s, Result = 2b160000, Performance =  28.61 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.041399 s, Result = 2b250000, Performance =  26.46 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.038779 s, Result = 2b340000, Performance =  28.80 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.042487 s, Result = 2b430000, Performance =  26.79 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.040721 s, Result = 2b520000, Performance =  28.48 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.042590 s, Result = 2b610000, Performance =  27.73 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.042530 s, Result = 2b700000, Performance =  28.28 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.045847 s, Result = 2b7f0000, Performance =  26.70 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.045597 s, Result = 2b8e0000, Performance =  27.32 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.045227 s, Result = 2b9d0000, Performance =  28.01 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.044904 s, Result = 2bac0000, Performance =  28.69 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.044508 s, Result = 2bbb0000, Performance =  29.43 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.047158 s, Result = 2bca0000, Performance =  28.23 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.046795 s, Result = 2bd90000, Performance =  28.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053427 s, Result = 2be80000, Performance =  25.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   401  1602    64
Test passed: M N K =   722  1285  1984
Test passed: M N K =  1080   693   896
Test passed: M N K =  1376  1332   896
Test passed: M N K =   485   250  1280
M N K =  2048  2048   256, Elapsed time =   0.000547 s, Result = 000f0000, Performance =  39.24 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000932 s, Result = 001e0000, Performance =  46.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001380 s, Result = 002d0000, Performance =  46.68 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001867 s, Result = 003c0000, Performance =  46.02 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002427 s, Result = 004b0000, Performance =  44.24 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003159 s, Result = 005a0000, Performance =  40.78 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003982 s, Result = 00690000, Performance =  37.75 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004818 s, Result = 00780000, Performance =  35.66 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005417 s, Result = 00870000, Performance =  35.68 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007802 s, Result = 00960000, Performance =  27.52 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007048 s, Result = 00a50000, Performance =  33.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007951 s, Result = 00b40000, Performance =  32.41 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008985 s, Result = 00c30000, Performance =  31.07 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009967 s, Result = 00d20000, Performance =  30.16 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010877 s, Result = 00e10000, Performance =  29.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012206 s, Result = 00f00000, Performance =  28.15 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011452 s, Result = 00ff0000, Performance =  31.88 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012383 s, Result = 010e0000, Performance =  31.22 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013227 s, Result = 011d0000, Performance =  30.85 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013416 s, Result = 012c0000, Performance =  32.01 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014687 s, Result = 013b0000, Performance =  30.70 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014670 s, Result = 014a0000, Performance =  32.20 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.015470 s, Result = 01590000, Performance =  31.93 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016033 s, Result = 01680000, Performance =  32.15 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017343 s, Result = 01770000, Performance =  30.96 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.018621 s, Result = 01860000, Performance =  29.98 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018401 s, Result = 01950000, Performance =  31.51 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020454 s, Result = 01a40000, Performance =  29.40 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.020226 s, Result = 01b30000, Performance =  30.79 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020734 s, Result = 01c20000, Performance =  31.07 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.020804 s, Result = 01d10000, Performance =  32.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.023261 s, Result = 01e00000, Performance =  29.54 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023248 s, Result = 01ef0000, Performance =  30.48 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.023301 s, Result = 01fe0000, Performance =  31.34 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.025140 s, Result = 020d0000, Performance =  29.90 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025870 s, Result = 021c0000, Performance =  29.88 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025567 s, Result = 022b0000, Performance =  31.08 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027742 s, Result = 023a0000, Performance =  29.42 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.027917 s, Result = 02490000, Performance =  30.00 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.029052 s, Result = 02580000, Performance =  29.57 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.029555 s, Result = 02670000, Performance =  29.79 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.030015 s, Result = 02760000, Performance =  30.05 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.031068 s, Result = 02850000, Performance =  29.72 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031356 s, Result = 02940000, Performance =  30.13 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031453 s, Result = 02a30000, Performance =  30.72 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.033095 s, Result = 02b20000, Performance =  29.85 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031561 s, Result = 02c10000, Performance =  31.98 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.035725 s, Result = 02d00000, Performance =  28.85 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034113 s, Result = 02df0000, Performance =  30.85 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034794 s, Result = 02ee0000, Performance =  30.86 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035531 s, Result = 02fd0000, Performance =  30.82 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035807 s, Result = 030c0000, Performance =  31.19 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.036771 s, Result = 031b0000, Performance =  30.95 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.036919 s, Result = 032a0000, Performance =  31.41 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.040422 s, Result = 03390000, Performance =  29.22 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.040286 s, Result = 03480000, Performance =  29.85 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.040340 s, Result = 03570000, Performance =  30.34 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039921 s, Result = 03660000, Performance =  31.20 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.041549 s, Result = 03750000, Performance =  30.49 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041414 s, Result = 03840000, Performance =  31.11 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041271 s, Result = 03930000, Performance =  31.74 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.043291 s, Result = 03a20000, Performance =  30.76 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.044144 s, Result = 03b10000, Performance =  30.65 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.048014 s, Result = 03c00000, Performance =  28.62 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   252  1170   896
Test passed: M N K =  1570  1077  1600
Test passed: M N K =   607   595    64
Test passed: M N K =  1002  1195   384
Test passed: M N K =   496  1435   128
M N K =  2048  2048   256, Elapsed time =   0.006007 s, Result = 34130000, Performance =   3.57 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007045 s, Result = e4220000, Performance =   6.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007197 s, Result = 94310000, Performance =   8.95 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007933 s, Result = 44400000, Performance =  10.83 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008622 s, Result = f44f0000, Performance =  12.45 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009402 s, Result = a45e0000, Performance =  13.70 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010147 s, Result = 546d0000, Performance =  14.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011227 s, Result = 047c0000, Performance =  15.30 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015562 s, Result = b48b0000, Performance =  12.42 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012551 s, Result = 649a0000, Performance =  17.11 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013169 s, Result = 14a90000, Performance =  17.94 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014070 s, Result = c4b80000, Performance =  18.32 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015008 s, Result = 74c70000, Performance =  18.60 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015576 s, Result = 24d60000, Performance =  19.30 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016494 s, Result = d4e50000, Performance =  19.53 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019194 s, Result = 84f40000, Performance =  17.90 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018314 s, Result = 35030000, Performance =  19.93 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018912 s, Result = e5120000, Performance =  20.44 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019224 s, Result = 95210000, Performance =  21.22 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019848 s, Result = 45300000, Performance =  21.64 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020302 s, Result = f53f0000, Performance =  22.21 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021117 s, Result = a54e0000, Performance =  22.37 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022164 s, Result = 555d0000, Performance =  22.28 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022905 s, Result = 056c0000, Performance =  22.50 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022960 s, Result = b57b0000, Performance =  23.38 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024170 s, Result = 658a0000, Performance =  23.10 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.024714 s, Result = 15990000, Performance =  23.46 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025521 s, Result = c5a80000, Performance =  23.56 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025964 s, Result = 75b70000, Performance =  23.99 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026650 s, Result = 25c60000, Performance =  24.17 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.027483 s, Result = d5d50000, Performance =  24.22 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.036754 s, Result = 85e40000, Performance =  18.70 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.029201 s, Result = 35f30000, Performance =  24.27 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.029400 s, Result = e6020000, Performance =  24.84 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.029583 s, Result = 96110000, Performance =  25.41 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.030231 s, Result = 46200000, Performance =  25.57 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.031066 s, Result = f62f0000, Performance =  25.58 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.031568 s, Result = a63e0000, Performance =  25.85 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.032328 s, Result = 564d0000, Performance =  25.91 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034611 s, Result = 065c0000, Performance =  24.82 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.033402 s, Result = b66b0000, Performance =  26.36 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.034194 s, Result = 667a0000, Performance =  26.38 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.035357 s, Result = 16890000, Performance =  26.12 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.035504 s, Result = c6980000, Performance =  26.61 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.036952 s, Result = 76a70000, Performance =  26.15 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.038202 s, Result = 26b60000, Performance =  25.86 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.038107 s, Result = d6c50000, Performance =  26.49 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.048018 s, Result = 86d40000, Performance =  21.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039266 s, Result = 36e30000, Performance =  26.80 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.040717 s, Result = e6f20000, Performance =  26.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.042934 s, Result = 97010000, Performance =  25.51 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.041980 s, Result = 47100000, Performance =  26.60 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.042178 s, Result = f71f0000, Performance =  26.98 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.043846 s, Result = a72e0000, Performance =  26.45 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.043472 s, Result = 573d0000, Performance =  27.17 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045834 s, Result = 074c0000, Performance =  26.24 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.046039 s, Result = b75b0000, Performance =  26.59 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.046386 s, Result = 676a0000, Performance =  26.85 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.047086 s, Result = 17790000, Performance =  26.91 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.047275 s, Result = c7880000, Performance =  27.26 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.049284 s, Result = 77970000, Performance =  26.58 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.048953 s, Result = 27a60000, Performance =  27.20 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.050428 s, Result = d7b50000, Performance =  26.83 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.065765 s, Result = 87c40000, Performance =  20.90 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   144   743  1408
Test passed: M N K =   862   972   256
Test passed: M N K =   859   521   960
Test passed: M N K =  1447  1257   896
Test passed: M N K =  1582  1567  1600
M N K =  2048  2048   256, Elapsed time =   0.004618 s, Result = 000f0000, Performance =   4.65 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006249 s, Result = 001e0000, Performance =   6.87 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006151 s, Result = 002d0000, Performance =  10.47 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006553 s, Result = 003c0000, Performance =  13.11 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007721 s, Result = 004b0000, Performance =  13.91 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007961 s, Result = 005a0000, Performance =  16.19 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008736 s, Result = 00690000, Performance =  17.21 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009714 s, Result = 00780000, Performance =  17.69 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010275 s, Result = 00870000, Performance =  18.81 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010912 s, Result = 00960000, Performance =  19.68 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011119 s, Result = 00a50000, Performance =  21.25 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012373 s, Result = 00b40000, Performance =  20.83 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012929 s, Result = 00c30000, Performance =  21.59 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013792 s, Result = 00d20000, Performance =  21.80 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014206 s, Result = 00e10000, Performance =  22.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018090 s, Result = 00f00000, Performance =  18.99 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016549 s, Result = 00ff0000, Performance =  22.06 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.016993 s, Result = 010e0000, Performance =  22.75 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.017274 s, Result = 011d0000, Performance =  23.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018173 s, Result = 012c0000, Performance =  23.63 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018748 s, Result = 013b0000, Performance =  24.05 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019226 s, Result = 014a0000, Performance =  24.57 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019794 s, Result = 01590000, Performance =  24.95 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022006 s, Result = 01680000, Performance =  23.42 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.021707 s, Result = 01770000, Performance =  24.73 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022202 s, Result = 01860000, Performance =  25.15 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023053 s, Result = 01950000, Performance =  25.15 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024006 s, Result = 01a40000, Performance =  25.05 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025270 s, Result = 01b30000, Performance =  24.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025079 s, Result = 01c20000, Performance =  25.69 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.025306 s, Result = 01d10000, Performance =  26.31 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035092 s, Result = 01e00000, Performance =  19.58 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.026457 s, Result = 01ef0000, Performance =  26.79 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027112 s, Result = 01fe0000, Performance =  26.93 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.027728 s, Result = 020d0000, Performance =  27.11 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.028268 s, Result = 021c0000, Performance =  27.35 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029306 s, Result = 022b0000, Performance =  27.11 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.029660 s, Result = 023a0000, Performance =  27.51 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.031156 s, Result = 02490000, Performance =  26.88 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032880 s, Result = 02580000, Performance =  26.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.032975 s, Result = 02670000, Performance =  26.70 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.033124 s, Result = 02760000, Performance =  27.23 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.033516 s, Result = 02850000, Performance =  27.55 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034154 s, Result = 02940000, Performance =  27.67 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.034908 s, Result = 02a30000, Performance =  27.68 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.035424 s, Result = 02b20000, Performance =  27.89 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.036490 s, Result = 02c10000, Performance =  27.66 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046856 s, Result = 02d00000, Performance =  22.00 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.037213 s, Result = 02df0000, Performance =  28.28 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.037761 s, Result = 02ee0000, Performance =  28.43 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.040629 s, Result = 02fd0000, Performance =  26.96 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040271 s, Result = 030c0000, Performance =  27.73 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.040752 s, Result = 031b0000, Performance =  27.93 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.041647 s, Result = 032a0000, Performance =  27.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.043139 s, Result = 03390000, Performance =  27.38 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.043515 s, Result = 03480000, Performance =  27.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.042913 s, Result = 03570000, Performance =  28.52 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044540 s, Result = 03660000, Performance =  27.96 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.044247 s, Result = 03750000, Performance =  28.63 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.045193 s, Result = 03840000, Performance =  28.51 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.046374 s, Result = 03930000, Performance =  28.25 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.046430 s, Result = 03a20000, Performance =  28.68 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.048658 s, Result = 03b10000, Performance =  27.80 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.066011 s, Result = 03c00000, Performance =  20.82 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   500  1596  1664
Test passed: M N K =   639  1081  1408
Test passed: M N K =  1692  1966   256
Test passed: M N K =  1233   181  1600
Test passed: M N K =   483  1436   128
M N K =  2048  2048   256, Elapsed time =   0.003370 s, Result = 28370000, Performance =   6.37 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004254 s, Result = 28460000, Performance =  10.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004815 s, Result = 28550000, Performance =  13.38 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005156 s, Result = 28640000, Performance =  16.66 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006124 s, Result = 28730000, Performance =  17.53 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006469 s, Result = 28820000, Performance =  19.92 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007222 s, Result = 28910000, Performance =  20.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008311 s, Result = 28a00000, Performance =  20.67 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008598 s, Result = 28af0000, Performance =  22.48 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013587 s, Result = 28be0000, Performance =  15.81 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010050 s, Result = 28cd0000, Performance =  23.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011151 s, Result = 28dc0000, Performance =  23.11 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012060 s, Result = 28eb0000, Performance =  23.15 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012771 s, Result = 28fa0000, Performance =  23.54 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013234 s, Result = 29090000, Performance =  24.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016369 s, Result = 29180000, Performance =  20.99 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014342 s, Result = 29270000, Performance =  25.46 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015336 s, Result = 29360000, Performance =  25.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015967 s, Result = 29450000, Performance =  25.55 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016513 s, Result = 29540000, Performance =  26.01 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.016899 s, Result = 29630000, Performance =  26.69 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017665 s, Result = 29720000, Performance =  26.74 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019015 s, Result = 29810000, Performance =  25.98 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019863 s, Result = 29900000, Performance =  25.95 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020047 s, Result = 299f0000, Performance =  26.78 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020566 s, Result = 29ae0000, Performance =  27.15 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021394 s, Result = 29bd0000, Performance =  27.10 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022188 s, Result = 29cc0000, Performance =  27.10 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023351 s, Result = 29db0000, Performance =  26.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023986 s, Result = 29ea0000, Performance =  26.86 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.023965 s, Result = 29f90000, Performance =  27.78 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.033839 s, Result = 2a080000, Performance =  20.31 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025880 s, Result = 2a170000, Performance =  27.38 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026579 s, Result = 2a260000, Performance =  27.47 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.027143 s, Result = 2a350000, Performance =  27.69 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.027843 s, Result = 2a440000, Performance =  27.77 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029019 s, Result = 2a530000, Performance =  27.38 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.029168 s, Result = 2a620000, Performance =  27.98 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.029983 s, Result = 2a710000, Performance =  27.93 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.031900 s, Result = 2a800000, Performance =  26.93 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031042 s, Result = 2a8f0000, Performance =  28.36 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.031427 s, Result = 2a9e0000, Performance =  28.70 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032952 s, Result = 2aad0000, Performance =  28.02 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.033414 s, Result = 2abc0000, Performance =  28.28 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.033474 s, Result = 2acb0000, Performance =  28.87 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.034792 s, Result = 2ada0000, Performance =  28.39 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.036209 s, Result = 2ae90000, Performance =  27.87 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.045565 s, Result = 2af80000, Performance =  22.62 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.037377 s, Result = 2b070000, Performance =  28.15 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.036926 s, Result = 2b160000, Performance =  29.08 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.038752 s, Result = 2b250000, Performance =  28.26 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040580 s, Result = 2b340000, Performance =  27.52 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.039032 s, Result = 2b430000, Performance =  29.16 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.041027 s, Result = 2b520000, Performance =  28.27 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.039965 s, Result = 2b610000, Performance =  29.55 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.044783 s, Result = 2b700000, Performance =  26.85 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.041452 s, Result = 2b7f0000, Performance =  29.53 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044489 s, Result = 2b8e0000, Performance =  28.00 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042460 s, Result = 2b9d0000, Performance =  29.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.045773 s, Result = 2bac0000, Performance =  28.15 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.045482 s, Result = 2bbb0000, Performance =  28.80 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.045833 s, Result = 2bca0000, Performance =  29.05 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.045733 s, Result = 2bd90000, Performance =  29.58 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.066270 s, Result = 2be80000, Performance =  20.74 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1552  1180   384
Test passed: M N K =   694   372  1280
Test passed: M N K =   195  1728  1152
Test passed: M N K =  1332  1459  1856
Test passed: M N K =  1933   253  1024
M N K =  2048  2048   256, Elapsed time =   0.000470 s, Result = 000f0000, Performance =  45.72 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001016 s, Result = 001e0000, Performance =  42.26 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001521 s, Result = 002d0000, Performance =  42.35 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002055 s, Result = 003c0000, Performance =  41.81 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003059 s, Result = 004b0000, Performance =  35.10 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003331 s, Result = 005a0000, Performance =  38.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004455 s, Result = 00690000, Performance =  33.75 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005233 s, Result = 00780000, Performance =  32.83 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006154 s, Result = 00870000, Performance =  31.41 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008706 s, Result = 00960000, Performance =  24.67 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007711 s, Result = 00a50000, Performance =  30.63 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008772 s, Result = 00b40000, Performance =  29.38 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009565 s, Result = 00c30000, Performance =  29.19 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010655 s, Result = 00d20000, Performance =  28.22 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010773 s, Result = 00e10000, Performance =  29.90 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014536 s, Result = 00f00000, Performance =  23.64 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011624 s, Result = 00ff0000, Performance =  31.41 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012676 s, Result = 010e0000, Performance =  30.49 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012839 s, Result = 011d0000, Performance =  31.78 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014076 s, Result = 012c0000, Performance =  30.51 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014529 s, Result = 013b0000, Performance =  31.04 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015008 s, Result = 014a0000, Performance =  31.48 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.015853 s, Result = 01590000, Performance =  31.16 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017294 s, Result = 01680000, Performance =  29.80 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017257 s, Result = 01770000, Performance =  31.11 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017887 s, Result = 01860000, Performance =  31.21 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018678 s, Result = 01950000, Performance =  31.04 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.019902 s, Result = 01a40000, Performance =  30.21 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019941 s, Result = 01b30000, Performance =  31.23 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020636 s, Result = 01c20000, Performance =  31.22 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021329 s, Result = 01d10000, Performance =  31.21 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030054 s, Result = 01e00000, Performance =  22.87 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.022523 s, Result = 01ef0000, Performance =  31.46 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.023728 s, Result = 01fe0000, Performance =  30.77 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.023819 s, Result = 020d0000, Performance =  31.55 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025146 s, Result = 021c0000, Performance =  30.74 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025592 s, Result = 022b0000, Performance =  31.05 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027318 s, Result = 023a0000, Performance =  29.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026068 s, Result = 02490000, Performance =  32.13 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.029474 s, Result = 02580000, Performance =  29.14 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.027885 s, Result = 02670000, Performance =  31.58 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029632 s, Result = 02760000, Performance =  30.44 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029395 s, Result = 02850000, Performance =  31.41 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030351 s, Result = 02940000, Performance =  31.13 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031059 s, Result = 02a30000, Performance =  31.11 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031036 s, Result = 02b20000, Performance =  31.83 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032139 s, Result = 02c10000, Performance =  31.40 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043036 s, Result = 02d00000, Performance =  23.95 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.032992 s, Result = 02df0000, Performance =  31.90 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034556 s, Result = 02ee0000, Performance =  31.07 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035061 s, Result = 02fd0000, Performance =  31.24 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.036307 s, Result = 030c0000, Performance =  30.76 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.036617 s, Result = 031b0000, Performance =  31.08 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.036697 s, Result = 032a0000, Performance =  31.60 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.036916 s, Result = 03390000, Performance =  31.99 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.040300 s, Result = 03480000, Performance =  29.84 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.039166 s, Result = 03570000, Performance =  31.25 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039438 s, Result = 03660000, Performance =  31.58 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.041157 s, Result = 03750000, Performance =  30.79 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041056 s, Result = 03840000, Performance =  31.38 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041416 s, Result = 03930000, Performance =  31.63 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042806 s, Result = 03a20000, Performance =  31.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042126 s, Result = 03b10000, Performance =  32.12 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.062812 s, Result = 03c00000, Performance =  21.88 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   133   835   960
Test passed: M N K =  1070  1778   320
Test passed: M N K =  1762  1215  2048
Test passed: M N K =  1481   724   256
Test passed: M N K =   731   586   832
M N K =  2048  2048   256, Elapsed time =   0.006022 s, Result = 34130000, Performance =   3.57 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006960 s, Result = e4220000, Performance =   6.17 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007268 s, Result = 94310000, Performance =   8.86 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008129 s, Result = 44400000, Performance =  10.57 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008785 s, Result = f44f0000, Performance =  12.22 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009282 s, Result = a45e0000, Performance =  13.88 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010008 s, Result = 546d0000, Performance =  15.02 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011176 s, Result = 047c0000, Performance =  15.37 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015868 s, Result = b48b0000, Performance =  12.18 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012799 s, Result = 649a0000, Performance =  16.78 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013575 s, Result = 14a90000, Performance =  17.40 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014872 s, Result = c4b80000, Performance =  17.33 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015607 s, Result = 74c70000, Performance =  17.89 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016530 s, Result = 24d60000, Performance =  18.19 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017430 s, Result = d4e50000, Performance =  18.48 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019607 s, Result = 84f40000, Performance =  17.52 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021453 s, Result = 35030000, Performance =  17.02 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020734 s, Result = e5120000, Performance =  18.64 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021792 s, Result = 95210000, Performance =  18.72 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022730 s, Result = 45300000, Performance =  18.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023586 s, Result = f53f0000, Performance =  19.12 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024002 s, Result = a54e0000, Performance =  19.68 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025027 s, Result = 555d0000, Performance =  19.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.025479 s, Result = 056c0000, Performance =  20.23 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026859 s, Result = b57b0000, Performance =  19.99 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.027689 s, Result = 658a0000, Performance =  20.16 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.028665 s, Result = 15990000, Performance =  20.23 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.029723 s, Result = c5a80000, Performance =  20.23 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.030483 s, Result = 75b70000, Performance =  20.43 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031288 s, Result = 25c60000, Performance =  20.59 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.032077 s, Result = d5d50000, Performance =  20.75 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035201 s, Result = 85e40000, Performance =  19.52 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.033934 s, Result = 35f30000, Performance =  20.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.034058 s, Result = e6020000, Performance =  21.44 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.035075 s, Result = 96110000, Performance =  21.43 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.036503 s, Result = 46200000, Performance =  21.18 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.037322 s, Result = f62f0000, Performance =  21.29 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.037855 s, Result = a63e0000, Performance =  21.56 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.038856 s, Result = 564d0000, Performance =  21.55 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.038058 s, Result = 065c0000, Performance =  22.57 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.040491 s, Result = b66b0000, Performance =  21.74 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.040400 s, Result = 667a0000, Performance =  22.33 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043091 s, Result = 16890000, Performance =  21.43 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.043848 s, Result = c6980000, Performance =  21.55 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.044024 s, Result = 76a70000, Performance =  21.95 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.044911 s, Result = 26b60000, Performance =  22.00 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.045363 s, Result = d6c50000, Performance =  22.25 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049593 s, Result = 86d40000, Performance =  20.79 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047383 s, Result = 36e30000, Performance =  22.21 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047943 s, Result = e6f20000, Performance =  22.40 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.049111 s, Result = 97010000, Performance =  22.30 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.050408 s, Result = 47100000, Performance =  22.15 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.051534 s, Result = f71f0000, Performance =  22.09 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.052435 s, Result = a72e0000, Performance =  22.12 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.053611 s, Result = 573d0000, Performance =  22.03 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.052136 s, Result = 074c0000, Performance =  23.07 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.055714 s, Result = b75b0000, Performance =  21.97 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.056075 s, Result = 676a0000, Performance =  22.21 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.057124 s, Result = 17790000, Performance =  22.18 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.057925 s, Result = c7880000, Performance =  22.24 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.058004 s, Result = 77970000, Performance =  22.58 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.061134 s, Result = 27a60000, Performance =  21.78 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.059888 s, Result = d7b50000, Performance =  22.59 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.064436 s, Result = 87c40000, Performance =  21.33 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1626  1370  1216
Test passed: M N K =   447  1487  1024
Test passed: M N K =   502  1431  1280
Test passed: M N K =   248   567  1088
Test passed: M N K =  1256  1436  1024
M N K =  2048  2048   256, Elapsed time =   0.005115 s, Result = 000f0000, Performance =   4.20 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005933 s, Result = 001e0000, Performance =   7.24 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006133 s, Result = 002d0000, Performance =  10.51 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006408 s, Result = 003c0000, Performance =  13.41 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007645 s, Result = 004b0000, Performance =  14.04 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007915 s, Result = 005a0000, Performance =  16.28 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008763 s, Result = 00690000, Performance =  17.16 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009449 s, Result = 00780000, Performance =  18.18 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010508 s, Result = 00870000, Performance =  18.39 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011258 s, Result = 00960000, Performance =  19.08 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012192 s, Result = 00a50000, Performance =  19.37 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013125 s, Result = 00b40000, Performance =  19.63 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013888 s, Result = 00c30000, Performance =  20.10 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014933 s, Result = 00d20000, Performance =  20.13 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015968 s, Result = 00e10000, Performance =  20.17 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017888 s, Result = 00f00000, Performance =  19.21 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019003 s, Result = 00ff0000, Performance =  19.21 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019454 s, Result = 010e0000, Performance =  19.87 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020562 s, Result = 011d0000, Performance =  19.84 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021339 s, Result = 012c0000, Performance =  20.13 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022084 s, Result = 013b0000, Performance =  20.42 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022781 s, Result = 014a0000, Performance =  20.74 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.024086 s, Result = 01590000, Performance =  20.51 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024004 s, Result = 01680000, Performance =  21.47 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025796 s, Result = 01770000, Performance =  20.81 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026343 s, Result = 01860000, Performance =  21.20 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027367 s, Result = 01950000, Performance =  21.19 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028265 s, Result = 01a40000, Performance =  21.27 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.029278 s, Result = 01b30000, Performance =  21.27 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029552 s, Result = 01c20000, Performance =  21.80 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030433 s, Result = 01d10000, Performance =  21.87 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.034415 s, Result = 01e00000, Performance =  19.97 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.032439 s, Result = 01ef0000, Performance =  21.85 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.033138 s, Result = 01fe0000, Performance =  22.03 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.033983 s, Result = 020d0000, Performance =  22.12 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035199 s, Result = 021c0000, Performance =  21.96 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035988 s, Result = 022b0000, Performance =  22.08 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036493 s, Result = 023a0000, Performance =  22.36 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037349 s, Result = 02490000, Performance =  22.42 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036664 s, Result = 02580000, Performance =  23.43 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.039450 s, Result = 02670000, Performance =  22.32 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039947 s, Result = 02760000, Performance =  22.58 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.041726 s, Result = 02850000, Performance =  22.13 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.042194 s, Result = 02940000, Performance =  22.39 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.043053 s, Result = 02a30000, Performance =  22.45 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042860 s, Result = 02b20000, Performance =  23.05 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.044344 s, Result = 02c10000, Performance =  22.76 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.047930 s, Result = 02d00000, Performance =  21.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.046001 s, Result = 02df0000, Performance =  22.88 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.046915 s, Result = 02ee0000, Performance =  22.89 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.048222 s, Result = 02fd0000, Performance =  22.71 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048876 s, Result = 030c0000, Performance =  22.85 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.050190 s, Result = 031b0000, Performance =  22.68 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.050777 s, Result = 032a0000, Performance =  22.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.052124 s, Result = 03390000, Performance =  22.66 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.049713 s, Result = 03480000, Performance =  24.19 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054125 s, Result = 03570000, Performance =  22.62 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.054686 s, Result = 03660000, Performance =  22.78 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055852 s, Result = 03750000, Performance =  22.69 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056501 s, Result = 03840000, Performance =  22.80 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.056387 s, Result = 03930000, Performance =  23.23 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057564 s, Result = 03a20000, Performance =  23.13 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.058354 s, Result = 03b10000, Performance =  23.18 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.063048 s, Result = 03c00000, Performance =  21.80 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   390  1741  1984
Test passed: M N K =  1419  1174   192
Test passed: M N K =  1508  1445   576
Test passed: M N K =  1179  1171    64
Test passed: M N K =  1775  1805   768
M N K =  2048  2048   256, Elapsed time =   0.003481 s, Result = 28370000, Performance =   6.17 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004225 s, Result = 28460000, Performance =  10.17 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004716 s, Result = 28550000, Performance =  13.66 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005081 s, Result = 28640000, Performance =  16.91 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005868 s, Result = 28730000, Performance =  18.30 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006400 s, Result = 28820000, Performance =  20.13 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007119 s, Result = 28910000, Performance =  21.12 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008232 s, Result = 28a00000, Performance =  20.87 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013038 s, Result = 28af0000, Performance =  14.82 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009608 s, Result = 28be0000, Performance =  22.35 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010633 s, Result = 28cd0000, Performance =  22.22 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012325 s, Result = 28dc0000, Performance =  20.91 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012824 s, Result = 28eb0000, Performance =  21.77 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013815 s, Result = 28fa0000, Performance =  21.76 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015069 s, Result = 29090000, Performance =  21.38 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016857 s, Result = 29180000, Performance =  20.38 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017586 s, Result = 29270000, Performance =  20.76 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018392 s, Result = 29360000, Performance =  21.02 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019325 s, Result = 29450000, Performance =  21.11 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020398 s, Result = 29540000, Performance =  21.06 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021354 s, Result = 29630000, Performance =  21.12 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021634 s, Result = 29720000, Performance =  21.84 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022823 s, Result = 29810000, Performance =  21.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022586 s, Result = 29900000, Performance =  22.82 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024818 s, Result = 299f0000, Performance =  21.63 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.025048 s, Result = 29ae0000, Performance =  22.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.026512 s, Result = 29bd0000, Performance =  21.87 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027350 s, Result = 29cc0000, Performance =  21.99 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.028451 s, Result = 29db0000, Performance =  21.89 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.028506 s, Result = 29ea0000, Performance =  22.60 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.029526 s, Result = 29f90000, Performance =  22.55 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.033263 s, Result = 2a080000, Performance =  20.66 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.031123 s, Result = 2a170000, Performance =  22.77 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032193 s, Result = 2a260000, Performance =  22.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.032710 s, Result = 2a350000, Performance =  22.98 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034993 s, Result = 2a440000, Performance =  22.09 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.034961 s, Result = 2a530000, Performance =  22.73 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.035663 s, Result = 2a620000, Performance =  22.88 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.036419 s, Result = 2a710000, Performance =  23.00 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036142 s, Result = 2a800000, Performance =  23.77 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.038188 s, Result = 2a8f0000, Performance =  23.06 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039438 s, Result = 2a9e0000, Performance =  22.87 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040633 s, Result = 2aad0000, Performance =  22.73 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.041643 s, Result = 2abc0000, Performance =  22.69 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.041726 s, Result = 2acb0000, Performance =  23.16 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042807 s, Result = 2ada0000, Performance =  23.08 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.043563 s, Result = 2ae90000, Performance =  23.17 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.047263 s, Result = 2af80000, Performance =  21.81 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.045512 s, Result = 2b070000, Performance =  23.12 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.046038 s, Result = 2b160000, Performance =  23.32 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047387 s, Result = 2b250000, Performance =  23.11 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048630 s, Result = 2b340000, Performance =  22.96 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.049720 s, Result = 2b430000, Performance =  22.89 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.050694 s, Result = 2b520000, Performance =  22.88 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.051503 s, Result = 2b610000, Performance =  22.93 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.049638 s, Result = 2b700000, Performance =  24.23 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.053358 s, Result = 2b7f0000, Performance =  22.94 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.056781 s, Result = 2b8e0000, Performance =  21.94 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.054987 s, Result = 2b9d0000, Performance =  23.04 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056010 s, Result = 2bac0000, Performance =  23.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.056226 s, Result = 2bbb0000, Performance =  23.30 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057118 s, Result = 2bca0000, Performance =  23.31 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057591 s, Result = 2bd90000, Performance =  23.49 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.063676 s, Result = 2be80000, Performance =  21.58 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    68   269  1600
Test passed: M N K =   925  1252   960
Test passed: M N K =  1757   254   192
Test passed: M N K =  1922  1693   576
Test passed: M N K =  1391   678   960
M N K =  2048  2048   256, Elapsed time =   0.000490 s, Result = 000f0000, Performance =  43.84 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001151 s, Result = 001e0000, Performance =  37.30 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002022 s, Result = 002d0000, Performance =  31.86 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002881 s, Result = 003c0000, Performance =  29.82 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002843 s, Result = 004b0000, Performance =  37.76 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003619 s, Result = 005a0000, Performance =  35.60 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004878 s, Result = 00690000, Performance =  30.82 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005777 s, Result = 00780000, Performance =  29.74 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006547 s, Result = 00870000, Performance =  29.52 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009110 s, Result = 00960000, Performance =  23.57 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008859 s, Result = 00a50000, Performance =  26.66 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010014 s, Result = 00b40000, Performance =  25.73 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010938 s, Result = 00c30000, Performance =  25.52 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011875 s, Result = 00d20000, Performance =  25.32 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013113 s, Result = 00e10000, Performance =  24.57 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015263 s, Result = 00f00000, Performance =  22.51 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015134 s, Result = 00ff0000, Performance =  24.12 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015997 s, Result = 010e0000, Performance =  24.16 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.017290 s, Result = 011d0000, Performance =  23.60 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018707 s, Result = 012c0000, Performance =  22.96 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018984 s, Result = 013b0000, Performance =  23.76 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019146 s, Result = 014a0000, Performance =  24.68 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020611 s, Result = 01590000, Performance =  23.96 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021394 s, Result = 01680000, Performance =  24.09 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.021986 s, Result = 01770000, Performance =  24.42 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.023107 s, Result = 01860000, Performance =  24.16 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.024606 s, Result = 01950000, Performance =  23.56 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025506 s, Result = 01a40000, Performance =  23.57 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.026012 s, Result = 01b30000, Performance =  23.94 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026347 s, Result = 01c20000, Performance =  24.45 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.027275 s, Result = 01d10000, Performance =  24.41 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029847 s, Result = 01e00000, Performance =  23.02 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.029268 s, Result = 01ef0000, Performance =  24.21 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.029608 s, Result = 01fe0000, Performance =  24.66 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.031114 s, Result = 020d0000, Performance =  24.16 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.032537 s, Result = 021c0000, Performance =  23.76 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.033300 s, Result = 022b0000, Performance =  23.86 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033845 s, Result = 023a0000, Performance =  24.11 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.034850 s, Result = 02490000, Performance =  24.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034156 s, Result = 02580000, Performance =  25.15 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.036644 s, Result = 02670000, Performance =  24.03 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.037062 s, Result = 02760000, Performance =  24.34 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.038569 s, Result = 02850000, Performance =  23.94 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.039528 s, Result = 02940000, Performance =  23.90 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.039792 s, Result = 02a30000, Performance =  24.29 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.040356 s, Result = 02b20000, Performance =  24.48 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.040873 s, Result = 02c10000, Performance =  24.69 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.044935 s, Result = 02d00000, Performance =  22.94 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.042679 s, Result = 02df0000, Performance =  24.66 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043489 s, Result = 02ee0000, Performance =  24.69 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.045583 s, Result = 02fd0000, Performance =  24.03 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.046970 s, Result = 030c0000, Performance =  23.77 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.047105 s, Result = 031b0000, Performance =  24.16 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.047911 s, Result = 032a0000, Performance =  24.20 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.049109 s, Result = 03390000, Performance =  24.05 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047458 s, Result = 03480000, Performance =  25.34 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.050434 s, Result = 03570000, Performance =  24.27 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.051214 s, Result = 03660000, Performance =  24.32 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052157 s, Result = 03750000, Performance =  24.29 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.053068 s, Result = 03840000, Performance =  24.28 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053870 s, Result = 03930000, Performance =  24.32 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.053949 s, Result = 03a20000, Performance =  24.68 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.055021 s, Result = 03b10000, Performance =  24.59 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.060138 s, Result = 03c00000, Performance =  22.85 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1176  1161  1792
Test passed: M N K =  1424  1426   192
Test passed: M N K =   861  1762   704
Test passed: M N K =   511  1948   832
Test passed: M N K =    62  1914   512
M N K =  2048  2048   256, Elapsed time =   0.004963 s, Result = d4108000, Performance =   4.33 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005691 s, Result = a41d0000, Performance =   7.55 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005948 s, Result = 74298000, Performance =  10.83 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006647 s, Result = 44360000, Performance =  12.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007316 s, Result = 14428000, Performance =  14.68 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008089 s, Result = e44f0000, Performance =  15.93 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008747 s, Result = b45b8000, Performance =  17.19 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009713 s, Result = 84680000, Performance =  17.69 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009973 s, Result = 54748000, Performance =  19.38 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013604 s, Result = 24810000, Performance =  15.79 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012141 s, Result = f48d8000, Performance =  19.46 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012236 s, Result = c49a0000, Performance =  21.06 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013586 s, Result = 94a68000, Performance =  20.55 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014329 s, Result = 64b30000, Performance =  20.98 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014965 s, Result = 34bf8000, Performance =  21.53 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014576 s, Result = 04cc0000, Performance =  23.57 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016569 s, Result = d4d88000, Performance =  22.03 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.016816 s, Result = a4e50000, Performance =  22.99 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016745 s, Result = 74f18000, Performance =  24.37 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017307 s, Result = 44fe0000, Performance =  24.82 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018094 s, Result = 150a8000, Performance =  24.92 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018995 s, Result = e5170000, Performance =  24.87 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018909 s, Result = b5238000, Performance =  26.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020974 s, Result = 85300000, Performance =  24.57 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020406 s, Result = 553c8000, Performance =  26.31 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021003 s, Result = 25490000, Performance =  26.58 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021881 s, Result = f5558000, Performance =  26.50 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023522 s, Result = c5620000, Performance =  25.56 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023312 s, Result = 956e8000, Performance =  26.71 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023654 s, Result = 657b0000, Performance =  27.24 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024186 s, Result = 35878000, Performance =  27.53 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.025825 s, Result = 05940000, Performance =  26.61 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.026147 s, Result = d5a08000, Performance =  27.10 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026100 s, Result = a5ad0000, Performance =  27.98 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.026368 s, Result = 75b98000, Performance =  28.51 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.027486 s, Result = 45c60000, Performance =  28.13 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.027594 s, Result = 15d28000, Performance =  28.79 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027234 s, Result = e5df0000, Performance =  29.96 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.028004 s, Result = b5eb8000, Performance =  29.91 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.029617 s, Result = 85f80000, Performance =  29.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031597 s, Result = 56048000, Performance =  27.87 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.030136 s, Result = 26110000, Performance =  29.93 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032441 s, Result = f61d8000, Performance =  28.46 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031249 s, Result = c62a0000, Performance =  30.24 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031683 s, Result = 96368000, Performance =  30.50 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.033103 s, Result = 66430000, Performance =  29.84 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.033273 s, Result = 364f8000, Performance =  30.33 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.035848 s, Result = 065c0000, Performance =  28.75 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034178 s, Result = d6688000, Performance =  30.79 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034380 s, Result = a6750000, Performance =  31.23 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035519 s, Result = 76818000, Performance =  30.83 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.036203 s, Result = 468e0000, Performance =  30.85 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.037083 s, Result = 169a8000, Performance =  30.69 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.037024 s, Result = e6a70000, Performance =  31.32 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.037913 s, Result = b6b38000, Performance =  31.15 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.039413 s, Result = 86c00000, Performance =  30.51 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038690 s, Result = 56cc8000, Performance =  31.64 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.040524 s, Result = 26d90000, Performance =  30.74 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042666 s, Result = f6e58000, Performance =  29.70 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.040937 s, Result = c6f20000, Performance =  31.48 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.042477 s, Result = 96fe8000, Performance =  30.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042470 s, Result = 670b0000, Performance =  31.35 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.043244 s, Result = 37178000, Performance =  31.29 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.047086 s, Result = 07240000, Performance =  29.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   654   449  1984
Test passed: M N K =   316  1703   128
Test passed: M N K =  1301  1198   192
Test passed: M N K =   232  1712   128
Test passed: M N K =   847  1333  1216
M N K =  2048  2048   256, Elapsed time =   0.004580 s, Result = 000c8000, Performance =   4.69 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004705 s, Result = 00190000, Performance =   9.13 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004528 s, Result = 00258000, Performance =  14.23 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004736 s, Result = 00320000, Performance =  18.14 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005129 s, Result = 003e8000, Performance =  20.94 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006121 s, Result = 004b0000, Performance =  21.05 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006759 s, Result = 00578000, Performance =  22.24 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007325 s, Result = 00640000, Performance =  23.45 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010091 s, Result = 00708000, Performance =  19.15 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008170 s, Result = 007d0000, Performance =  26.29 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009062 s, Result = 00898000, Performance =  26.07 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009902 s, Result = 00960000, Performance =  26.02 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010774 s, Result = 00a28000, Performance =  25.91 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011484 s, Result = 00af0000, Performance =  26.18 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012471 s, Result = 00bb8000, Performance =  25.83 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011897 s, Result = 00c80000, Performance =  28.88 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013383 s, Result = 00d48000, Performance =  27.28 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013892 s, Result = 00e10000, Performance =  27.83 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014762 s, Result = 00ed8000, Performance =  27.64 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016086 s, Result = 00fa0000, Performance =  26.70 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015073 s, Result = 01068000, Performance =  29.92 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017008 s, Result = 01130000, Performance =  27.78 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.017593 s, Result = 011f8000, Performance =  28.07 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.018644 s, Result = 012c0000, Performance =  27.64 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018812 s, Result = 01388000, Performance =  28.54 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019790 s, Result = 01450000, Performance =  28.21 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.020323 s, Result = 01518000, Performance =  28.53 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020792 s, Result = 015e0000, Performance =  28.92 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.020660 s, Result = 016a8000, Performance =  30.14 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.022691 s, Result = 01770000, Performance =  28.39 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022328 s, Result = 01838000, Performance =  29.82 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022815 s, Result = 01900000, Performance =  30.12 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023882 s, Result = 019c8000, Performance =  29.67 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024200 s, Result = 01a90000, Performance =  30.17 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.025100 s, Result = 01b58000, Performance =  29.95 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.026064 s, Result = 01c20000, Performance =  29.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.024758 s, Result = 01ce8000, Performance =  32.09 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.025868 s, Result = 01db0000, Performance =  31.55 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.027985 s, Result = 01e78000, Performance =  29.93 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.026952 s, Result = 01f40000, Performance =  31.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028198 s, Result = 02008000, Performance =  31.22 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.027490 s, Result = 020d0000, Performance =  32.81 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029372 s, Result = 02198000, Performance =  31.44 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.028756 s, Result = 02260000, Performance =  32.86 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.029402 s, Result = 02328000, Performance =  32.87 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031788 s, Result = 023f0000, Performance =  31.08 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032265 s, Result = 024b8000, Performance =  31.28 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.034115 s, Result = 02580000, Performance =  30.21 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.032862 s, Result = 02648000, Performance =  32.02 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.033555 s, Result = 02710000, Performance =  32.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.034737 s, Result = 027d8000, Performance =  31.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.033736 s, Result = 028a0000, Performance =  33.10 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.034839 s, Result = 02968000, Performance =  32.67 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.034987 s, Result = 02a30000, Performance =  33.14 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.036563 s, Result = 02af8000, Performance =  32.30 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.037284 s, Result = 02bc0000, Performance =  32.26 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038844 s, Result = 02c88000, Performance =  31.51 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.037964 s, Result = 02d50000, Performance =  32.81 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042502 s, Result = 02e18000, Performance =  29.81 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.038759 s, Result = 02ee0000, Performance =  33.24 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.039609 s, Result = 02fa8000, Performance =  33.07 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.040002 s, Result = 03070000, Performance =  33.28 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042358 s, Result = 03138000, Performance =  31.94 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.043718 s, Result = 03200000, Performance =  31.44 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   750   854  1344
Test passed: M N K =   276  1930  1088
Test passed: M N K =   956  1441  1792
Test passed: M N K =  1955  1603   704
Test passed: M N K =   695  1646  1536
M N K =  2048  2048   256, Elapsed time =   0.003218 s, Result = 28348000, Performance =   6.67 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004052 s, Result = 28410000, Performance =  10.60 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004621 s, Result = 284d8000, Performance =  13.94 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005075 s, Result = 285a0000, Performance =  16.93 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005421 s, Result = 28668000, Performance =  19.81 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006122 s, Result = 28730000, Performance =  21.05 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006760 s, Result = 287f8000, Performance =  22.24 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007484 s, Result = 288c0000, Performance =  22.95 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007756 s, Result = 28988000, Performance =  24.92 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011263 s, Result = 28a50000, Performance =  19.07 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009422 s, Result = 28b18000, Performance =  25.07 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010345 s, Result = 28be0000, Performance =  24.91 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010869 s, Result = 28ca8000, Performance =  25.68 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011991 s, Result = 28d70000, Performance =  25.07 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012482 s, Result = 28e38000, Performance =  25.81 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012384 s, Result = 28f00000, Performance =  27.75 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012858 s, Result = 28fc8000, Performance =  28.39 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013037 s, Result = 29090000, Performance =  29.65 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013902 s, Result = 29158000, Performance =  29.35 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014277 s, Result = 29220000, Performance =  30.08 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015566 s, Result = 292e8000, Performance =  28.97 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015501 s, Result = 293b0000, Performance =  30.48 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.017111 s, Result = 29478000, Performance =  28.87 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.018808 s, Result = 29540000, Performance =  27.40 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018770 s, Result = 29608000, Performance =  28.60 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019384 s, Result = 296d0000, Performance =  28.80 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018861 s, Result = 29798000, Performance =  30.74 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020329 s, Result = 29860000, Performance =  29.58 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021382 s, Result = 29928000, Performance =  29.13 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020727 s, Result = 299f0000, Performance =  31.08 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022509 s, Result = 29ab8000, Performance =  29.58 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.023198 s, Result = 29b80000, Performance =  29.62 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.022433 s, Result = 29c48000, Performance =  31.59 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024047 s, Result = 29d10000, Performance =  30.36 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024799 s, Result = 29dd8000, Performance =  30.31 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024338 s, Result = 29ea0000, Performance =  31.76 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.024262 s, Result = 29f68000, Performance =  32.75 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026361 s, Result = 2a030000, Performance =  30.96 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025961 s, Result = 2a0f8000, Performance =  32.26 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.027500 s, Result = 2a1c0000, Performance =  31.24 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.029118 s, Result = 2a288000, Performance =  30.24 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029510 s, Result = 2a350000, Performance =  30.56 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.030523 s, Result = 2a418000, Performance =  30.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030513 s, Result = 2a4e0000, Performance =  30.97 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031572 s, Result = 2a5a8000, Performance =  30.61 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.030342 s, Result = 2a670000, Performance =  32.56 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031645 s, Result = 2a738000, Performance =  31.89 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.033320 s, Result = 2a800000, Performance =  30.94 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034662 s, Result = 2a8c8000, Performance =  30.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.035094 s, Result = 2a990000, Performance =  30.60 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.033371 s, Result = 2aa58000, Performance =  32.82 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.033786 s, Result = 2ab20000, Performance =  33.05 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035445 s, Result = 2abe8000, Performance =  32.11 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.035210 s, Result = 2acb0000, Performance =  32.94 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.037225 s, Result = 2ad78000, Performance =  31.73 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.038576 s, Result = 2ae40000, Performance =  31.17 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.037103 s, Result = 2af08000, Performance =  32.99 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039744 s, Result = 2afd0000, Performance =  31.34 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.039532 s, Result = 2b098000, Performance =  32.05 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.038927 s, Result = 2b160000, Performance =  33.10 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.040985 s, Result = 2b228000, Performance =  31.96 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.039847 s, Result = 2b2f0000, Performance =  33.41 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.041115 s, Result = 2b3b8000, Performance =  32.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.043880 s, Result = 2b480000, Performance =  31.32 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1610  1374   256
Test passed: M N K =    89  2025   640
Test passed: M N K =   765   955   704
Test passed: M N K =  1118   864   640
Test passed: M N K =   237  1247   320
M N K =  2048  2048   256, Elapsed time =   0.000530 s, Result = 000c8000, Performance =  40.48 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001001 s, Result = 00190000, Performance =  42.92 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001529 s, Result = 00258000, Performance =  42.13 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001776 s, Result = 00320000, Performance =  48.36 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002362 s, Result = 003e8000, Performance =  45.46 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002724 s, Result = 004b0000, Performance =  47.31 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003406 s, Result = 00578000, Performance =  44.14 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004187 s, Result = 00640000, Performance =  41.03 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004784 s, Result = 00708000, Performance =  40.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007109 s, Result = 007d0000, Performance =  30.21 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006126 s, Result = 00898000, Performance =  38.56 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007050 s, Result = 00960000, Performance =  36.55 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007907 s, Result = 00a28000, Performance =  35.31 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.008782 s, Result = 00af0000, Performance =  34.24 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009614 s, Result = 00bb8000, Performance =  33.51 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.009734 s, Result = 00c80000, Performance =  35.30 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010025 s, Result = 00d48000, Performance =  36.42 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010481 s, Result = 00e10000, Performance =  36.88 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010944 s, Result = 00ed8000, Performance =  37.28 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011615 s, Result = 00fa0000, Performance =  36.98 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011905 s, Result = 01068000, Performance =  37.88 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.012643 s, Result = 01130000, Performance =  37.37 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014643 s, Result = 011f8000, Performance =  33.73 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014415 s, Result = 012c0000, Performance =  35.75 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015212 s, Result = 01388000, Performance =  35.29 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015290 s, Result = 01450000, Performance =  36.52 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016873 s, Result = 01518000, Performance =  34.36 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017180 s, Result = 015e0000, Performance =  35.00 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018293 s, Result = 016a8000, Performance =  34.04 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018932 s, Result = 01770000, Performance =  34.03 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018720 s, Result = 01838000, Performance =  35.56 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.019776 s, Result = 01900000, Performance =  34.75 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020406 s, Result = 019c8000, Performance =  34.73 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.022145 s, Result = 01a90000, Performance =  32.97 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021380 s, Result = 01b58000, Performance =  35.16 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.022517 s, Result = 01c20000, Performance =  34.33 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.024128 s, Result = 01ce8000, Performance =  32.93 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023232 s, Result = 01db0000, Performance =  35.13 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025563 s, Result = 01e78000, Performance =  32.76 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.024452 s, Result = 01f40000, Performance =  35.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.025390 s, Result = 02008000, Performance =  34.68 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.024787 s, Result = 020d0000, Performance =  36.39 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.028013 s, Result = 02198000, Performance =  32.96 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.027274 s, Result = 02260000, Performance =  34.64 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.028443 s, Result = 02328000, Performance =  33.98 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.028443 s, Result = 023f0000, Performance =  34.73 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.029645 s, Result = 024b8000, Performance =  34.05 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.030793 s, Result = 02580000, Performance =  33.48 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.031901 s, Result = 02648000, Performance =  32.99 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.030061 s, Result = 02710000, Performance =  35.72 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.032160 s, Result = 027d8000, Performance =  34.06 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.033437 s, Result = 028a0000, Performance =  33.40 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.031583 s, Result = 02968000, Performance =  36.04 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.032389 s, Result = 02a30000, Performance =  35.80 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.032614 s, Result = 02af8000, Performance =  36.21 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.034793 s, Result = 02bc0000, Performance =  34.56 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.034582 s, Result = 02c88000, Performance =  35.40 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.037406 s, Result = 02d50000, Performance =  33.30 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.037387 s, Result = 02e18000, Performance =  33.89 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035174 s, Result = 02ee0000, Performance =  36.63 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.035509 s, Result = 02fa8000, Performance =  36.89 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.038762 s, Result = 03070000, Performance =  34.35 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.036754 s, Result = 03138000, Performance =  36.81 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.040051 s, Result = 03200000, Performance =  34.32 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   328  1162   704
Test passed: M N K =  1084  1263   256
Test passed: M N K =   334  1042  1088
Test passed: M N K =  1072  1105   896
Test passed: M N K =   805   163  1408
M N K =  2048  2048   256, Elapsed time =   0.005094 s, Result = d4108000, Performance =   4.22 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005345 s, Result = a41d0000, Performance =   8.04 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006210 s, Result = 74298000, Performance =  10.37 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006746 s, Result = 44360000, Performance =  12.73 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007369 s, Result = 14428000, Performance =  14.57 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008334 s, Result = e44f0000, Performance =  15.46 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009121 s, Result = b45b8000, Performance =  16.48 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010419 s, Result = 84680000, Performance =  16.49 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011387 s, Result = 54748000, Performance =  16.97 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012209 s, Result = 24810000, Performance =  17.59 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012390 s, Result = f48d8000, Performance =  19.06 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013066 s, Result = c49a0000, Performance =  19.72 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014127 s, Result = 94a68000, Performance =  19.76 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014623 s, Result = 64b30000, Performance =  20.56 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014616 s, Result = 34bf8000, Performance =  22.04 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017254 s, Result = 04cc0000, Performance =  19.91 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016374 s, Result = d4d88000, Performance =  22.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017811 s, Result = a4e50000, Performance =  21.70 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.017002 s, Result = 74f18000, Performance =  24.00 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017491 s, Result = 44fe0000, Performance =  24.56 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017671 s, Result = 150a8000, Performance =  25.52 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019430 s, Result = e5170000, Performance =  24.32 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019255 s, Result = b5238000, Performance =  25.65 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022312 s, Result = 85300000, Performance =  23.10 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020351 s, Result = 553c8000, Performance =  26.38 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021626 s, Result = 25490000, Performance =  25.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022779 s, Result = f5558000, Performance =  25.45 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023257 s, Result = c5620000, Performance =  25.85 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023923 s, Result = 956e8000, Performance =  26.03 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023663 s, Result = 657b0000, Performance =  27.23 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024737 s, Result = 35878000, Performance =  26.91 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030665 s, Result = 05940000, Performance =  22.41 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025724 s, Result = d5a08000, Performance =  27.55 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026572 s, Result = a5ad0000, Performance =  27.48 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.026492 s, Result = 75b98000, Performance =  28.37 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.027502 s, Result = 45c60000, Performance =  28.11 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.027362 s, Result = 15d28000, Performance =  29.04 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.028142 s, Result = e5df0000, Performance =  29.00 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.028901 s, Result = b5eb8000, Performance =  28.98 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032455 s, Result = 85f80000, Performance =  26.47 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.029735 s, Result = 56048000, Performance =  29.61 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.030813 s, Result = 26110000, Performance =  29.27 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.031121 s, Result = f61d8000, Performance =  29.67 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031762 s, Result = c62a0000, Performance =  29.75 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.033028 s, Result = 96368000, Performance =  29.26 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.032943 s, Result = 66430000, Performance =  29.99 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.033844 s, Result = 364f8000, Performance =  29.82 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043836 s, Result = 065c0000, Performance =  23.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034850 s, Result = d6688000, Performance =  30.19 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.036581 s, Result = a6750000, Performance =  29.35 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.036838 s, Result = 76818000, Performance =  29.73 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.037249 s, Result = 468e0000, Performance =  29.98 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.036937 s, Result = 169a8000, Performance =  30.81 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.038539 s, Result = e6a70000, Performance =  30.09 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.038368 s, Result = b6b38000, Performance =  30.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.043660 s, Result = 86c00000, Performance =  27.54 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.040296 s, Result = 56cc8000, Performance =  30.38 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.041726 s, Result = 26d90000, Performance =  29.85 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.041855 s, Result = f6e58000, Performance =  30.27 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.042831 s, Result = c6f20000, Performance =  30.08 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.043218 s, Result = 96fe8000, Performance =  30.31 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.045171 s, Result = 670b0000, Performance =  29.48 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.044545 s, Result = 37178000, Performance =  30.37 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.056358 s, Result = 07240000, Performance =  24.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1829  1284  1280
Test passed: M N K =   311  1961  1280
Test passed: M N K =   942  1009   704
Test passed: M N K =   390   242  1664
Test passed: M N K =   960   909  1536
M N K =  2048  2048   256, Elapsed time =   0.003222 s, Result = 000c8000, Performance =   6.66 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004699 s, Result = 00190000, Performance =   9.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004416 s, Result = 00258000, Performance =  14.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004863 s, Result = 00320000, Performance =  17.66 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005717 s, Result = 003e8000, Performance =  18.78 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006296 s, Result = 004b0000, Performance =  20.47 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006928 s, Result = 00578000, Performance =  21.70 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007933 s, Result = 00640000, Performance =  21.66 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008802 s, Result = 00708000, Performance =  21.96 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012502 s, Result = 007d0000, Performance =  17.18 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010161 s, Result = 00898000, Performance =  23.25 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011171 s, Result = 00960000, Performance =  23.07 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012109 s, Result = 00a28000, Performance =  23.06 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012753 s, Result = 00af0000, Performance =  23.57 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012828 s, Result = 00bb8000, Performance =  25.11 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016137 s, Result = 00c80000, Performance =  21.29 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014252 s, Result = 00d48000, Performance =  25.62 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014828 s, Result = 00e10000, Performance =  26.07 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015313 s, Result = 00ed8000, Performance =  26.64 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015545 s, Result = 00fa0000, Performance =  27.63 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.016287 s, Result = 01068000, Performance =  27.69 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016932 s, Result = 01130000, Performance =  27.90 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.017503 s, Result = 011f8000, Performance =  28.22 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020168 s, Result = 012c0000, Performance =  25.56 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018635 s, Result = 01388000, Performance =  28.81 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019415 s, Result = 01450000, Performance =  28.76 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019874 s, Result = 01518000, Performance =  29.18 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020574 s, Result = 015e0000, Performance =  29.23 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021450 s, Result = 016a8000, Performance =  29.03 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.022429 s, Result = 01770000, Performance =  28.72 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022237 s, Result = 01838000, Performance =  29.94 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028999 s, Result = 01900000, Performance =  23.70 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023996 s, Result = 019c8000, Performance =  29.53 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024301 s, Result = 01a90000, Performance =  30.05 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024919 s, Result = 01b58000, Performance =  30.16 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024834 s, Result = 01c20000, Performance =  31.13 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025620 s, Result = 01ce8000, Performance =  31.01 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026700 s, Result = 01db0000, Performance =  30.56 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.027122 s, Result = 01e78000, Performance =  30.88 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.030892 s, Result = 01f40000, Performance =  27.81 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028218 s, Result = 02008000, Performance =  31.20 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029431 s, Result = 020d0000, Performance =  30.65 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029971 s, Result = 02198000, Performance =  30.81 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030212 s, Result = 02260000, Performance =  31.28 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.030703 s, Result = 02328000, Performance =  31.47 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.032158 s, Result = 023f0000, Performance =  30.72 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031899 s, Result = 024b8000, Performance =  31.64 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.042194 s, Result = 02580000, Performance =  24.43 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.033149 s, Result = 02648000, Performance =  31.74 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.035579 s, Result = 02710000, Performance =  30.18 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.034948 s, Result = 027d8000, Performance =  31.34 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.034526 s, Result = 028a0000, Performance =  32.34 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035289 s, Result = 02968000, Performance =  32.25 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.037505 s, Result = 02a30000, Performance =  30.92 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.036958 s, Result = 02af8000, Performance =  31.96 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.042469 s, Result = 02bc0000, Performance =  28.32 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038047 s, Result = 02c88000, Performance =  32.17 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039853 s, Result = 02d50000, Performance =  31.25 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.040360 s, Result = 02e18000, Performance =  31.39 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.040580 s, Result = 02ee0000, Performance =  31.75 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041137 s, Result = 02fa8000, Performance =  31.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042450 s, Result = 03070000, Performance =  31.37 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.041982 s, Result = 03138000, Performance =  32.23 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.055554 s, Result = 03200000, Performance =  24.74 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   853  1006  1600
Test passed: M N K =   828   670  1536
Test passed: M N K =  1561   273  1792
Test passed: M N K =  1000   293  1088
Test passed: M N K =  1023   686   512
M N K =  2048  2048   256, Elapsed time =   0.003324 s, Result = 28348000, Performance =   6.46 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003973 s, Result = 28410000, Performance =  10.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004648 s, Result = 284d8000, Performance =  13.86 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005084 s, Result = 285a0000, Performance =  16.90 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005702 s, Result = 28668000, Performance =  18.83 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006488 s, Result = 28730000, Performance =  19.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007062 s, Result = 287f8000, Performance =  21.29 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008300 s, Result = 288c0000, Performance =  20.70 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008778 s, Result = 28988000, Performance =  22.02 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012778 s, Result = 28a50000, Performance =  16.81 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010334 s, Result = 28b18000, Performance =  22.86 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011367 s, Result = 28be0000, Performance =  22.67 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012030 s, Result = 28ca8000, Performance =  23.21 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012820 s, Result = 28d70000, Performance =  23.45 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012739 s, Result = 28e38000, Performance =  25.29 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016164 s, Result = 28f00000, Performance =  21.26 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013387 s, Result = 28fc8000, Performance =  27.27 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014285 s, Result = 29090000, Performance =  27.06 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014700 s, Result = 29158000, Performance =  27.76 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015541 s, Result = 29220000, Performance =  27.64 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015506 s, Result = 292e8000, Performance =  29.08 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016539 s, Result = 293b0000, Performance =  28.56 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016801 s, Result = 29478000, Performance =  29.40 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019310 s, Result = 29540000, Performance =  26.69 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018285 s, Result = 29608000, Performance =  29.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019457 s, Result = 296d0000, Performance =  28.70 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019501 s, Result = 29798000, Performance =  29.73 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020125 s, Result = 29860000, Performance =  29.88 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021208 s, Result = 29928000, Performance =  29.37 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.021572 s, Result = 299f0000, Performance =  29.86 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021843 s, Result = 29ab8000, Performance =  30.48 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028871 s, Result = 29b80000, Performance =  23.80 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023143 s, Result = 29c48000, Performance =  30.62 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024262 s, Result = 29d10000, Performance =  30.09 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024857 s, Result = 29dd8000, Performance =  30.24 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025199 s, Result = 29ea0000, Performance =  30.68 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025770 s, Result = 29f68000, Performance =  30.83 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026916 s, Result = 2a030000, Performance =  30.32 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026861 s, Result = 2a0f8000, Performance =  31.18 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.030950 s, Result = 2a1c0000, Performance =  27.75 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028073 s, Result = 2a288000, Performance =  31.36 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029699 s, Result = 2a350000, Performance =  30.37 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029099 s, Result = 2a418000, Performance =  31.73 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030428 s, Result = 2a4e0000, Performance =  31.05 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031652 s, Result = 2a5a8000, Performance =  30.53 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031612 s, Result = 2a670000, Performance =  31.25 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031939 s, Result = 2a738000, Performance =  31.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043333 s, Result = 2a800000, Performance =  23.79 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.033698 s, Result = 2a8c8000, Performance =  31.23 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034401 s, Result = 2a990000, Performance =  31.21 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.034907 s, Result = 2aa58000, Performance =  31.38 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035290 s, Result = 2ab20000, Performance =  31.64 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035823 s, Result = 2abe8000, Performance =  31.77 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.036934 s, Result = 2acb0000, Performance =  31.40 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.037566 s, Result = 2ad78000, Performance =  31.44 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.041908 s, Result = 2ae40000, Performance =  28.70 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038311 s, Result = 2af08000, Performance =  31.95 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039340 s, Result = 2afd0000, Performance =  31.66 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.039390 s, Result = 2b098000, Performance =  32.17 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.040677 s, Result = 2b160000, Performance =  31.68 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.040911 s, Result = 2b228000, Performance =  32.02 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042251 s, Result = 2b2f0000, Performance =  31.51 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.041783 s, Result = 2b3b8000, Performance =  32.38 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.054467 s, Result = 2b480000, Performance =  25.23 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   371  1865   128
Test passed: M N K =  1903    78   384
Test passed: M N K =  1506   984   832
Test passed: M N K =   917   879  1472
Test passed: M N K =   119  1034   512
M N K =  2048  2048   256, Elapsed time =   0.000603 s, Result = 000c8000, Performance =  35.60 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001028 s, Result = 00190000, Performance =  41.80 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001712 s, Result = 00258000, Performance =  37.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002247 s, Result = 00320000, Performance =  38.23 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002593 s, Result = 003e8000, Performance =  41.40 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003445 s, Result = 004b0000, Performance =  37.40 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004112 s, Result = 00578000, Performance =  36.55 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005405 s, Result = 00640000, Performance =  31.79 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006002 s, Result = 00708000, Performance =  32.20 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009014 s, Result = 007d0000, Performance =  23.82 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007885 s, Result = 00898000, Performance =  29.96 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008902 s, Result = 00960000, Performance =  28.95 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009688 s, Result = 00a28000, Performance =  28.82 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010500 s, Result = 00af0000, Performance =  28.63 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010410 s, Result = 00bb8000, Performance =  30.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013610 s, Result = 00c80000, Performance =  25.25 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011138 s, Result = 00d48000, Performance =  32.78 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011884 s, Result = 00e10000, Performance =  32.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012220 s, Result = 00ed8000, Performance =  33.39 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012509 s, Result = 00fa0000, Performance =  34.33 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012819 s, Result = 01068000, Performance =  35.18 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014158 s, Result = 01130000, Performance =  33.37 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014330 s, Result = 011f8000, Performance =  34.47 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016707 s, Result = 012c0000, Performance =  30.85 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015575 s, Result = 01388000, Performance =  34.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016472 s, Result = 01450000, Performance =  33.90 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016693 s, Result = 01518000, Performance =  34.73 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017635 s, Result = 015e0000, Performance =  34.10 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017981 s, Result = 016a8000, Performance =  34.63 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018847 s, Result = 01770000, Performance =  34.18 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018921 s, Result = 01838000, Performance =  35.18 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.024740 s, Result = 01900000, Performance =  27.78 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020882 s, Result = 019c8000, Performance =  33.94 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021472 s, Result = 01a90000, Performance =  34.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021842 s, Result = 01b58000, Performance =  34.41 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.022490 s, Result = 01c20000, Performance =  34.38 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.022953 s, Result = 01ce8000, Performance =  34.62 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023768 s, Result = 01db0000, Performance =  34.33 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.024071 s, Result = 01e78000, Performance =  34.79 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.028114 s, Result = 01f40000, Performance =  30.55 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.025512 s, Result = 02008000, Performance =  34.51 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.026374 s, Result = 020d0000, Performance =  34.20 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026701 s, Result = 02198000, Performance =  34.58 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.027254 s, Result = 02260000, Performance =  34.67 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.028380 s, Result = 02328000, Performance =  34.05 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.028649 s, Result = 023f0000, Performance =  34.48 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.029283 s, Result = 024b8000, Performance =  34.47 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.040404 s, Result = 02580000, Performance =  25.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.030643 s, Result = 02648000, Performance =  34.34 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.031028 s, Result = 02710000, Performance =  34.61 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031956 s, Result = 027d8000, Performance =  34.27 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.032570 s, Result = 028a0000, Performance =  34.29 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032618 s, Result = 02968000, Performance =  34.89 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.033470 s, Result = 02a30000, Performance =  34.65 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.034076 s, Result = 02af8000, Performance =  34.66 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.039548 s, Result = 02bc0000, Performance =  30.41 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.035474 s, Result = 02c88000, Performance =  34.51 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.036938 s, Result = 02d50000, Performance =  33.72 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.036723 s, Result = 02e18000, Performance =  34.50 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.037255 s, Result = 02ee0000, Performance =  34.59 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.037931 s, Result = 02fa8000, Performance =  34.54 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.038655 s, Result = 03070000, Performance =  34.44 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.038817 s, Result = 03138000, Performance =  34.85 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053051 s, Result = 03200000, Performance =  25.91 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   984  1817  1856
Test passed: M N K =  1623  1533  1856
Test passed: M N K =  1400    41  2048
Test passed: M N K =   764   473   384
Test passed: M N K =   570  1338   640
M N K =  2048  2048   256, Elapsed time =   0.004518 s, Result = d4108000, Performance =   4.75 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005693 s, Result = a41d0000, Performance =   7.54 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006123 s, Result = 74298000, Performance =  10.52 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006876 s, Result = 44360000, Performance =  12.49 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007475 s, Result = 14428000, Performance =  14.37 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008340 s, Result = e44f0000, Performance =  15.45 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009253 s, Result = b45b8000, Performance =  16.25 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009986 s, Result = 84680000, Performance =  17.20 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010802 s, Result = 54748000, Performance =  17.89 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012047 s, Result = 24810000, Performance =  17.83 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012852 s, Result = f48d8000, Performance =  18.38 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013528 s, Result = c49a0000, Performance =  19.05 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014740 s, Result = 94a68000, Performance =  18.94 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015682 s, Result = 64b30000, Performance =  19.17 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016335 s, Result = 34bf8000, Performance =  19.72 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017123 s, Result = 04cc0000, Performance =  20.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019243 s, Result = d4d88000, Performance =  18.97 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019938 s, Result = a4e50000, Performance =  19.39 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020475 s, Result = 74f18000, Performance =  19.93 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021680 s, Result = 44fe0000, Performance =  19.81 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022611 s, Result = 150a8000, Performance =  19.94 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022901 s, Result = e5170000, Performance =  20.63 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.024762 s, Result = b5238000, Performance =  19.95 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.023964 s, Result = 85300000, Performance =  21.51 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025895 s, Result = 553c8000, Performance =  20.73 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026499 s, Result = 25490000, Performance =  21.07 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027607 s, Result = f5558000, Performance =  21.00 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027887 s, Result = c5620000, Performance =  21.56 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.029057 s, Result = 956e8000, Performance =  21.43 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029657 s, Result = 657b0000, Performance =  21.72 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.031130 s, Result = 35878000, Performance =  21.39 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030972 s, Result = 05940000, Performance =  22.19 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.032983 s, Result = d5a08000, Performance =  21.49 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.033583 s, Result = a5ad0000, Performance =  21.74 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.034283 s, Result = 75b98000, Performance =  21.92 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034503 s, Result = 45c60000, Performance =  22.41 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035621 s, Result = 15d28000, Performance =  22.31 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036581 s, Result = e5df0000, Performance =  22.31 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037752 s, Result = b5eb8000, Performance =  22.18 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.037006 s, Result = 85f80000, Performance =  23.21 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.039082 s, Result = 56048000, Performance =  22.53 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039624 s, Result = 26110000, Performance =  22.76 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040646 s, Result = f61d8000, Performance =  22.72 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.040771 s, Result = c62a0000, Performance =  23.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.042090 s, Result = 96368000, Performance =  22.96 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042879 s, Result = 66430000, Performance =  23.04 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.043585 s, Result = 364f8000, Performance =  23.16 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043487 s, Result = 065c0000, Performance =  23.70 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.045113 s, Result = d6688000, Performance =  23.33 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.046356 s, Result = a6750000, Performance =  23.16 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047138 s, Result = 76818000, Performance =  23.23 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.047427 s, Result = 468e0000, Performance =  23.55 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048911 s, Result = 169a8000, Performance =  23.27 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049481 s, Result = e6a70000, Performance =  23.44 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.051074 s, Result = b6b38000, Performance =  23.13 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.049948 s, Result = 86c00000, Performance =  24.08 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.052189 s, Result = 56cc8000, Performance =  23.45 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052845 s, Result = 26d90000, Performance =  23.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055463 s, Result = f6e58000, Performance =  22.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.053914 s, Result = c6f20000, Performance =  23.90 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.054770 s, Result = 96fe8000, Performance =  23.92 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.056058 s, Result = 670b0000, Performance =  23.75 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057295 s, Result = 37178000, Performance =  23.61 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.056428 s, Result = 07240000, Performance =  24.36 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   544  1500   512
Test passed: M N K =  1659  1601  1920
Test passed: M N K =  1552  1554   384
Test passed: M N K =   849  1913  1024
Test passed: M N K =  1191  1066   256
M N K =  2048  2048   256, Elapsed time =   0.003864 s, Result = 000c8000, Performance =   5.56 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004546 s, Result = 00190000, Performance =   9.45 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004638 s, Result = 00258000, Performance =  13.89 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004919 s, Result = 00320000, Performance =  17.46 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005433 s, Result = 003e8000, Performance =  19.76 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006439 s, Result = 004b0000, Performance =  20.01 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006869 s, Result = 00578000, Performance =  21.89 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007920 s, Result = 00640000, Performance =  21.69 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008573 s, Result = 00708000, Performance =  22.54 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012843 s, Result = 007d0000, Performance =  16.72 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011038 s, Result = 00898000, Performance =  21.40 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012054 s, Result = 00960000, Performance =  21.38 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012780 s, Result = 00a28000, Performance =  21.84 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013533 s, Result = 00af0000, Performance =  22.22 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014612 s, Result = 00bb8000, Performance =  22.05 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015373 s, Result = 00c80000, Performance =  22.35 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017037 s, Result = 00d48000, Performance =  21.43 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018960 s, Result = 00e10000, Performance =  20.39 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019066 s, Result = 00ed8000, Performance =  21.40 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019659 s, Result = 00fa0000, Performance =  21.85 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020736 s, Result = 01068000, Performance =  21.75 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021337 s, Result = 01130000, Performance =  22.14 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022126 s, Result = 011f8000, Performance =  22.32 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022346 s, Result = 012c0000, Performance =  23.06 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023316 s, Result = 01388000, Performance =  23.03 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024491 s, Result = 01450000, Performance =  22.80 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025713 s, Result = 01518000, Performance =  22.55 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025892 s, Result = 015e0000, Performance =  23.22 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027507 s, Result = 016a8000, Performance =  22.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.028103 s, Result = 01770000, Performance =  22.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028708 s, Result = 01838000, Performance =  23.19 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029317 s, Result = 01900000, Performance =  23.44 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030524 s, Result = 019c8000, Performance =  23.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030711 s, Result = 01a90000, Performance =  23.77 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.032050 s, Result = 01b58000, Performance =  23.45 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.032239 s, Result = 01c20000, Performance =  23.98 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.033174 s, Result = 01ce8000, Performance =  23.95 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033909 s, Result = 01db0000, Performance =  24.07 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.035310 s, Result = 01e78000, Performance =  23.72 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034681 s, Result = 01f40000, Performance =  24.77 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.037393 s, Result = 02008000, Performance =  23.55 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.037727 s, Result = 020d0000, Performance =  23.91 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.039038 s, Result = 02198000, Performance =  23.65 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.038912 s, Result = 02260000, Performance =  24.28 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.040344 s, Result = 02328000, Performance =  23.95 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.040776 s, Result = 023f0000, Performance =  24.23 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.042050 s, Result = 024b8000, Performance =  24.00 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041352 s, Result = 02580000, Performance =  24.93 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.043551 s, Result = 02648000, Performance =  24.16 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.044298 s, Result = 02710000, Performance =  24.24 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.045259 s, Result = 027d8000, Performance =  24.20 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045535 s, Result = 028a0000, Performance =  24.52 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.047382 s, Result = 02968000, Performance =  24.02 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.047928 s, Result = 02a30000, Performance =  24.20 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.049223 s, Result = 02af8000, Performance =  24.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.048446 s, Result = 02bc0000, Performance =  24.82 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.050501 s, Result = 02c88000, Performance =  24.24 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052866 s, Result = 02d50000, Performance =  23.56 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052592 s, Result = 02e18000, Performance =  24.09 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.051916 s, Result = 02ee0000, Performance =  24.82 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053749 s, Result = 02fa8000, Performance =  24.37 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.054537 s, Result = 03070000, Performance =  24.41 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.055671 s, Result = 03138000, Performance =  24.30 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053991 s, Result = 03200000, Performance =  25.46 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   231   332   768
Test passed: M N K =   247  1789   640
Test passed: M N K =  1653  1446  1024
Test passed: M N K =    61  1878  1856
Test passed: M N K =   954   358   192
M N K =  2048  2048   256, Elapsed time =   0.003013 s, Result = 28348000, Performance =   7.13 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003856 s, Result = 28410000, Performance =  11.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004510 s, Result = 284d8000, Performance =  14.28 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005054 s, Result = 285a0000, Performance =  17.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005603 s, Result = 28668000, Performance =  19.16 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006178 s, Result = 28730000, Performance =  20.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009298 s, Result = 287f8000, Performance =  16.17 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007792 s, Result = 288c0000, Performance =  22.05 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008543 s, Result = 28988000, Performance =  22.62 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009836 s, Result = 28a50000, Performance =  21.83 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010768 s, Result = 28b18000, Performance =  21.94 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011796 s, Result = 28be0000, Performance =  21.85 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012210 s, Result = 28ca8000, Performance =  22.86 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013650 s, Result = 28d70000, Performance =  22.03 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014623 s, Result = 28e38000, Performance =  22.03 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015442 s, Result = 28f00000, Performance =  22.25 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016364 s, Result = 28fc8000, Performance =  22.31 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017145 s, Result = 29090000, Performance =  22.55 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018756 s, Result = 29158000, Performance =  21.75 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019229 s, Result = 29220000, Performance =  22.34 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020181 s, Result = 292e8000, Performance =  22.35 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020538 s, Result = 293b0000, Performance =  23.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021641 s, Result = 29478000, Performance =  22.82 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022101 s, Result = 29540000, Performance =  23.32 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023090 s, Result = 29608000, Performance =  23.25 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.023946 s, Result = 296d0000, Performance =  23.32 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025023 s, Result = 29798000, Performance =  23.17 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025344 s, Result = 29860000, Performance =  23.73 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.026759 s, Result = 29928000, Performance =  23.27 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.027734 s, Result = 299f0000, Performance =  23.23 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028323 s, Result = 29ab8000, Performance =  23.50 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028180 s, Result = 29b80000, Performance =  24.39 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.029884 s, Result = 29c48000, Performance =  23.71 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030658 s, Result = 29d10000, Performance =  23.82 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.032081 s, Result = 29dd8000, Performance =  23.43 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.032218 s, Result = 29ea0000, Performance =  24.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.033147 s, Result = 29f68000, Performance =  23.97 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.034029 s, Result = 2a030000, Performance =  23.98 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.034791 s, Result = 2a0f8000, Performance =  24.07 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034590 s, Result = 2a1c0000, Performance =  24.83 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.036451 s, Result = 2a288000, Performance =  24.16 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.037170 s, Result = 2a350000, Performance =  24.27 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.038404 s, Result = 2a418000, Performance =  24.04 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.038738 s, Result = 2a4e0000, Performance =  24.39 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.039756 s, Result = 2a5a8000, Performance =  24.31 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.040221 s, Result = 2a670000, Performance =  24.56 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.041284 s, Result = 2a738000, Performance =  24.45 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041099 s, Result = 2a800000, Performance =  25.08 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.042597 s, Result = 2a8c8000, Performance =  24.70 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043481 s, Result = 2a990000, Performance =  24.69 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.045008 s, Result = 2aa58000, Performance =  24.33 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045186 s, Result = 2ab20000, Performance =  24.71 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.046239 s, Result = 2abe8000, Performance =  24.61 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.047417 s, Result = 2acb0000, Performance =  24.46 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.048965 s, Result = 2ad78000, Performance =  24.12 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047967 s, Result = 2ae40000, Performance =  25.07 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.049947 s, Result = 2af08000, Performance =  24.51 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.051009 s, Result = 2afd0000, Performance =  24.42 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052116 s, Result = 2b098000, Performance =  24.31 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052065 s, Result = 2b160000, Performance =  24.75 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.052986 s, Result = 2b228000, Performance =  24.72 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.054018 s, Result = 2b2f0000, Performance =  24.65 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.054852 s, Result = 2b3b8000, Performance =  24.66 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053834 s, Result = 2b480000, Performance =  25.53 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   901  1452   512
Test passed: M N K =    74   572   128
Test passed: M N K =   997  1197  1280
Test passed: M N K =  1745   936  1344
Test passed: M N K =  1296  1347   640
M N K =  2048  2048   256, Elapsed time =   0.000627 s, Result = 000c8000, Performance =  34.23 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001214 s, Result = 00190000, Performance =  35.39 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001649 s, Result = 00258000, Performance =  39.06 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002387 s, Result = 00320000, Performance =  35.98 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002690 s, Result = 003e8000, Performance =  39.92 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003378 s, Result = 004b0000, Performance =  38.14 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003930 s, Result = 00578000, Performance =  38.25 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005253 s, Result = 00640000, Performance =  32.71 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006045 s, Result = 00708000, Performance =  31.97 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011965 s, Result = 007d0000, Performance =  17.95 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008701 s, Result = 00898000, Performance =  27.15 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009520 s, Result = 00960000, Performance =  27.07 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010268 s, Result = 00a28000, Performance =  27.19 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011651 s, Result = 00af0000, Performance =  25.81 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012288 s, Result = 00bb8000, Performance =  26.21 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013258 s, Result = 00c80000, Performance =  25.92 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014342 s, Result = 00d48000, Performance =  25.45 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015070 s, Result = 00e10000, Performance =  25.65 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016045 s, Result = 00ed8000, Performance =  25.43 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016993 s, Result = 00fa0000, Performance =  25.27 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017806 s, Result = 01068000, Performance =  25.33 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018110 s, Result = 01130000, Performance =  26.09 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019560 s, Result = 011f8000, Performance =  25.25 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019235 s, Result = 012c0000, Performance =  26.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020908 s, Result = 01388000, Performance =  25.68 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021805 s, Result = 01450000, Performance =  25.61 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023112 s, Result = 01518000, Performance =  25.09 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023272 s, Result = 015e0000, Performance =  25.84 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.024221 s, Result = 016a8000, Performance =  25.71 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.024429 s, Result = 01770000, Performance =  26.37 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026074 s, Result = 01838000, Performance =  25.53 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026299 s, Result = 01900000, Performance =  26.13 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.027313 s, Result = 019c8000, Performance =  25.95 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.028158 s, Result = 01a90000, Performance =  25.93 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.029089 s, Result = 01b58000, Performance =  25.84 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.029582 s, Result = 01c20000, Performance =  26.13 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.030618 s, Result = 01ce8000, Performance =  25.95 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.032040 s, Result = 01db0000, Performance =  25.47 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.032528 s, Result = 01e78000, Performance =  25.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032658 s, Result = 01f40000, Performance =  26.30 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.034340 s, Result = 02008000, Performance =  25.64 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.035119 s, Result = 020d0000, Performance =  25.68 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.036630 s, Result = 02198000, Performance =  25.21 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.036092 s, Result = 02260000, Performance =  26.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.037567 s, Result = 02328000, Performance =  25.72 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.038498 s, Result = 023f0000, Performance =  25.66 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.038903 s, Result = 024b8000, Performance =  25.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.039164 s, Result = 02580000, Performance =  26.32 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.040352 s, Result = 02648000, Performance =  26.08 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.041635 s, Result = 02710000, Performance =  25.79 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.042710 s, Result = 027d8000, Performance =  25.64 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.043104 s, Result = 028a0000, Performance =  25.91 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.043636 s, Result = 02968000, Performance =  26.08 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.044541 s, Result = 02a30000, Performance =  26.04 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.046682 s, Result = 02af8000, Performance =  25.30 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045248 s, Result = 02bc0000, Performance =  26.58 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.047298 s, Result = 02c88000, Performance =  25.88 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.048034 s, Result = 02d50000, Performance =  25.93 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.049639 s, Result = 02e18000, Performance =  25.52 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048814 s, Result = 02ee0000, Performance =  26.40 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.051049 s, Result = 02fa8000, Performance =  25.66 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.051447 s, Result = 03070000, Performance =  25.88 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.052078 s, Result = 03138000, Performance =  25.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.051571 s, Result = 03200000, Performance =  26.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   371   205   384
Test passed: M N K =   952   234   896
Test passed: M N K =  1876   814   256
Test passed: M N K =   714  1344  1664
Test passed: M N K =  1748  1896   512
M N K =  2048  2048   256, Elapsed time =   0.007759 s, Result = 34130000, Performance =   2.77 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008394 s, Result = e4220000, Performance =   5.12 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008537 s, Result = 94310000, Performance =   7.55 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009288 s, Result = 44400000, Performance =   9.25 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009877 s, Result = f44f0000, Performance =  10.87 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014115 s, Result = a45e0000, Performance =   9.13 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011266 s, Result = 546d0000, Performance =  13.34 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011811 s, Result = 047c0000, Performance =  14.55 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012906 s, Result = b48b0000, Performance =  14.98 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013355 s, Result = 649a0000, Performance =  16.08 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014243 s, Result = 14a90000, Performance =  16.59 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015036 s, Result = c4b80000, Performance =  17.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015941 s, Result = 74c70000, Performance =  17.51 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016497 s, Result = 24d60000, Performance =  18.22 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017220 s, Result = d4e50000, Performance =  18.71 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019328 s, Result = 84f40000, Performance =  17.78 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018998 s, Result = 35030000, Performance =  19.22 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020028 s, Result = e5120000, Performance =  19.30 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020256 s, Result = 95210000, Performance =  20.14 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020705 s, Result = 45300000, Performance =  20.74 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021743 s, Result = f53f0000, Performance =  20.74 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022397 s, Result = a54e0000, Performance =  21.09 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.023076 s, Result = 555d0000, Performance =  21.40 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024318 s, Result = 056c0000, Performance =  21.19 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024797 s, Result = b57b0000, Performance =  21.65 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.025316 s, Result = 658a0000, Performance =  22.05 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025718 s, Result = 15990000, Performance =  22.55 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027144 s, Result = c5a80000, Performance =  22.15 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027693 s, Result = 75b70000, Performance =  22.49 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.028107 s, Result = 25c60000, Performance =  22.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028647 s, Result = d5d50000, Performance =  23.24 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.031942 s, Result = 85e40000, Performance =  21.51 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030778 s, Result = 35f30000, Performance =  23.03 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030455 s, Result = e6020000, Performance =  23.97 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.031343 s, Result = 96110000, Performance =  23.98 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031901 s, Result = 46200000, Performance =  24.23 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032943 s, Result = f62f0000, Performance =  24.12 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033679 s, Result = a63e0000, Performance =  24.23 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.034304 s, Result = 564d0000, Performance =  24.41 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.035753 s, Result = 065c0000, Performance =  24.03 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.035457 s, Result = b66b0000, Performance =  24.83 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.036292 s, Result = 667a0000, Performance =  24.85 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.037179 s, Result = 16890000, Performance =  24.84 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.037238 s, Result = c6980000, Performance =  25.37 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.038871 s, Result = 76a70000, Performance =  24.86 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.038546 s, Result = 26b60000, Performance =  25.63 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.039204 s, Result = d6c50000, Performance =  25.75 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041757 s, Result = 86d40000, Performance =  24.69 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.041189 s, Result = 36e30000, Performance =  25.55 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.042188 s, Result = e6f20000, Performance =  25.45 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.042317 s, Result = 97010000, Performance =  25.88 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.043401 s, Result = 47100000, Performance =  25.73 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.044254 s, Result = f71f0000, Performance =  25.72 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.043829 s, Result = a72e0000, Performance =  26.46 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.045482 s, Result = 573d0000, Performance =  25.97 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045236 s, Result = 074c0000, Performance =  26.59 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.046098 s, Result = b75b0000, Performance =  26.55 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.047566 s, Result = 676a0000, Performance =  26.19 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.047836 s, Result = 17790000, Performance =  26.49 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048002 s, Result = c7880000, Performance =  26.84 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.048674 s, Result = 77970000, Performance =  26.91 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.048755 s, Result = 27a60000, Performance =  27.31 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.052583 s, Result = d7b50000, Performance =  25.73 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.053187 s, Result = 87c40000, Performance =  25.84 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1027   890   256
Test passed: M N K =   190  1540  1664
Test passed: M N K =    93  1846   128
Test passed: M N K =  1863  1510  1600
Test passed: M N K =  1569  1659  1024
M N K =  2048  2048   256, Elapsed time =   0.006704 s, Result = 000f0000, Performance =   3.20 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007041 s, Result = 001e0000, Performance =   6.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007108 s, Result = 002d0000, Performance =   9.06 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007406 s, Result = 003c0000, Performance =  11.60 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008365 s, Result = 004b0000, Performance =  12.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008508 s, Result = 005a0000, Performance =  15.14 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008990 s, Result = 00690000, Performance =  16.72 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009412 s, Result = 00780000, Performance =  18.25 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010370 s, Result = 00870000, Performance =  18.64 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015014 s, Result = 00960000, Performance =  14.30 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011790 s, Result = 00a50000, Performance =  20.04 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012513 s, Result = 00b40000, Performance =  20.60 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013532 s, Result = 00c30000, Performance =  20.63 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014067 s, Result = 00d20000, Performance =  21.37 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015505 s, Result = 00e10000, Performance =  20.78 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016819 s, Result = 00f00000, Performance =  20.43 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016826 s, Result = 00ff0000, Performance =  21.70 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018732 s, Result = 010e0000, Performance =  20.64 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018858 s, Result = 011d0000, Performance =  21.64 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019578 s, Result = 012c0000, Performance =  21.94 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019629 s, Result = 013b0000, Performance =  22.98 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020673 s, Result = 014a0000, Performance =  22.85 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021872 s, Result = 01590000, Performance =  22.58 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021948 s, Result = 01680000, Performance =  23.48 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023108 s, Result = 01770000, Performance =  23.23 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022997 s, Result = 01860000, Performance =  24.28 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025158 s, Result = 01950000, Performance =  23.05 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025165 s, Result = 01a40000, Performance =  23.89 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.026447 s, Result = 01b30000, Performance =  23.55 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026423 s, Result = 01c20000, Performance =  24.38 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026857 s, Result = 01d10000, Performance =  24.79 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028822 s, Result = 01e00000, Performance =  23.84 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.028232 s, Result = 01ef0000, Performance =  25.10 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.028317 s, Result = 01fe0000, Performance =  25.78 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.029884 s, Result = 020d0000, Performance =  25.15 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.029827 s, Result = 021c0000, Performance =  25.92 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032459 s, Result = 022b0000, Performance =  24.48 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.030192 s, Result = 023a0000, Performance =  27.03 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.031954 s, Result = 02490000, Performance =  26.21 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032334 s, Result = 02580000, Performance =  26.57 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.033217 s, Result = 02670000, Performance =  26.51 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.033858 s, Result = 02760000, Performance =  26.64 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.034706 s, Result = 02850000, Performance =  26.61 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.036800 s, Result = 02940000, Performance =  25.68 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.035845 s, Result = 02a30000, Performance =  26.96 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.036546 s, Result = 02b20000, Performance =  27.03 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.037117 s, Result = 02c10000, Performance =  27.19 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.038948 s, Result = 02d00000, Performance =  26.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039160 s, Result = 02df0000, Performance =  26.87 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.040740 s, Result = 02ee0000, Performance =  26.36 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.041207 s, Result = 02fd0000, Performance =  26.58 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.041295 s, Result = 030c0000, Performance =  27.04 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.041957 s, Result = 031b0000, Performance =  27.13 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.041654 s, Result = 032a0000, Performance =  27.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.042666 s, Result = 03390000, Performance =  27.68 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.044057 s, Result = 03480000, Performance =  27.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.043470 s, Result = 03570000, Performance =  28.16 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044782 s, Result = 03660000, Performance =  27.81 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.046238 s, Result = 03750000, Performance =  27.40 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.046320 s, Result = 03840000, Performance =  27.82 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.048182 s, Result = 03930000, Performance =  27.19 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.048175 s, Result = 03a20000, Performance =  27.64 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.051598 s, Result = 03b10000, Performance =  26.22 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.054183 s, Result = 03c00000, Performance =  25.37 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   999   725   768
Test passed: M N K =  1194   217  2048
Test passed: M N K =  1210  1252  1088
Test passed: M N K =   218   668  1216
Test passed: M N K =  1733  1486    64
M N K =  2048  2048   256, Elapsed time =   0.003688 s, Result = 28370000, Performance =   5.82 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004255 s, Result = 28460000, Performance =  10.09 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004746 s, Result = 28550000, Performance =  13.57 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005221 s, Result = 28640000, Performance =  16.45 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005930 s, Result = 28730000, Performance =  18.11 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006647 s, Result = 28820000, Performance =  19.38 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007026 s, Result = 28910000, Performance =  21.40 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007809 s, Result = 28a00000, Performance =  22.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013250 s, Result = 28af0000, Performance =  14.59 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009644 s, Result = 28be0000, Performance =  22.27 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010006 s, Result = 28cd0000, Performance =  23.61 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011042 s, Result = 28dc0000, Performance =  23.34 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011832 s, Result = 28eb0000, Performance =  23.59 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012739 s, Result = 28fa0000, Performance =  23.60 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013444 s, Result = 29090000, Performance =  23.96 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015222 s, Result = 29180000, Performance =  22.57 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014607 s, Result = 29270000, Performance =  24.99 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015915 s, Result = 29360000, Performance =  24.29 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016469 s, Result = 29450000, Performance =  24.78 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016869 s, Result = 29540000, Performance =  25.46 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018173 s, Result = 29630000, Performance =  24.82 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018292 s, Result = 29720000, Performance =  25.83 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019102 s, Result = 29810000, Performance =  25.86 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020255 s, Result = 29900000, Performance =  25.45 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.019897 s, Result = 299f0000, Performance =  26.98 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022068 s, Result = 29ae0000, Performance =  25.30 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021921 s, Result = 29bd0000, Performance =  26.45 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023315 s, Result = 29cc0000, Performance =  25.79 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023940 s, Result = 29db0000, Performance =  26.01 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.024260 s, Result = 29ea0000, Performance =  26.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024889 s, Result = 29f90000, Performance =  26.75 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026873 s, Result = 2a080000, Performance =  25.57 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025958 s, Result = 2a170000, Performance =  27.30 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026404 s, Result = 2a260000, Performance =  27.65 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028109 s, Result = 2a350000, Performance =  26.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.030258 s, Result = 2a440000, Performance =  25.55 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.030570 s, Result = 2a530000, Performance =  25.99 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.030179 s, Result = 2a620000, Performance =  27.04 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.030408 s, Result = 2a710000, Performance =  27.54 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.031479 s, Result = 2a800000, Performance =  27.29 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.033240 s, Result = 2a8f0000, Performance =  26.49 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.032602 s, Result = 2a9e0000, Performance =  27.66 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.034024 s, Result = 2aad0000, Performance =  27.14 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.033443 s, Result = 2abc0000, Performance =  28.25 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.034588 s, Result = 2acb0000, Performance =  27.94 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.034609 s, Result = 2ada0000, Performance =  28.54 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.036239 s, Result = 2ae90000, Performance =  27.85 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.036917 s, Result = 2af80000, Performance =  27.92 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.038515 s, Result = 2b070000, Performance =  27.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.038524 s, Result = 2b160000, Performance =  27.87 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.039253 s, Result = 2b250000, Performance =  27.90 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040087 s, Result = 2b340000, Performance =  27.86 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.043404 s, Result = 2b430000, Performance =  26.22 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.041797 s, Result = 2b520000, Performance =  27.74 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.041737 s, Result = 2b610000, Performance =  28.30 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.043134 s, Result = 2b700000, Performance =  27.88 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.042570 s, Result = 2b7f0000, Performance =  28.75 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.043862 s, Result = 2b8e0000, Performance =  28.40 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.045305 s, Result = 2b9d0000, Performance =  27.97 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.045182 s, Result = 2bac0000, Performance =  28.52 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.045491 s, Result = 2bbb0000, Performance =  28.80 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.046727 s, Result = 2bca0000, Performance =  28.49 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.047117 s, Result = 2bd90000, Performance =  28.71 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.049871 s, Result = 2be80000, Performance =  27.56 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   485   190   768
Test passed: M N K =   908  1551   256
Test passed: M N K =  1038  1824  1792
Test passed: M N K =  1198   478  1600
Test passed: M N K =   315  1291   576
M N K =  2048  2048   256, Elapsed time =   0.000535 s, Result = 000f0000, Performance =  40.15 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000942 s, Result = 001e0000, Performance =  45.60 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001442 s, Result = 002d0000, Performance =  44.69 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001901 s, Result = 003c0000, Performance =  45.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002443 s, Result = 004b0000, Performance =  43.96 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002959 s, Result = 005a0000, Performance =  43.55 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003734 s, Result = 00690000, Performance =  40.25 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004348 s, Result = 00780000, Performance =  39.51 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004965 s, Result = 00870000, Performance =  38.92 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007348 s, Result = 00960000, Performance =  29.22 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006573 s, Result = 00a50000, Performance =  35.94 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007524 s, Result = 00b40000, Performance =  34.25 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008253 s, Result = 00c30000, Performance =  33.83 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009285 s, Result = 00d20000, Performance =  32.38 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009960 s, Result = 00e10000, Performance =  32.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011596 s, Result = 00f00000, Performance =  29.63 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011695 s, Result = 00ff0000, Performance =  31.22 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011739 s, Result = 010e0000, Performance =  32.93 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013171 s, Result = 011d0000, Performance =  30.98 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013880 s, Result = 012c0000, Performance =  30.94 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013941 s, Result = 013b0000, Performance =  32.35 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014871 s, Result = 014a0000, Performance =  31.77 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016199 s, Result = 01590000, Performance =  30.49 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017322 s, Result = 01680000, Performance =  29.75 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017501 s, Result = 01770000, Performance =  30.68 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.018547 s, Result = 01860000, Performance =  30.10 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019446 s, Result = 01950000, Performance =  29.82 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020083 s, Result = 01a40000, Performance =  29.94 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021748 s, Result = 01b30000, Performance =  28.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.022245 s, Result = 01c20000, Performance =  28.96 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021929 s, Result = 01d10000, Performance =  30.36 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022695 s, Result = 01e00000, Performance =  30.28 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.022313 s, Result = 01ef0000, Performance =  31.76 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.025822 s, Result = 01fe0000, Performance =  28.28 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.025252 s, Result = 020d0000, Performance =  29.77 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025989 s, Result = 021c0000, Performance =  29.75 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.026844 s, Result = 022b0000, Performance =  29.60 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027715 s, Result = 023a0000, Performance =  29.44 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.028252 s, Result = 02490000, Performance =  29.64 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.028160 s, Result = 02580000, Performance =  30.50 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028341 s, Result = 02670000, Performance =  31.07 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029860 s, Result = 02760000, Performance =  30.21 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.030931 s, Result = 02850000, Performance =  29.85 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031546 s, Result = 02940000, Performance =  29.95 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031535 s, Result = 02a30000, Performance =  30.64 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031965 s, Result = 02b20000, Performance =  30.90 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032020 s, Result = 02c10000, Performance =  31.52 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.034297 s, Result = 02d00000, Performance =  30.06 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034156 s, Result = 02df0000, Performance =  30.81 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.035170 s, Result = 02ee0000, Performance =  30.53 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035956 s, Result = 02fd0000, Performance =  30.46 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.036803 s, Result = 030c0000, Performance =  30.34 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.036865 s, Result = 031b0000, Performance =  30.87 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.037484 s, Result = 032a0000, Performance =  30.94 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.038648 s, Result = 03390000, Performance =  30.56 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.038225 s, Result = 03480000, Performance =  31.46 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.039063 s, Result = 03570000, Performance =  31.34 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039017 s, Result = 03660000, Performance =  31.92 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042318 s, Result = 03750000, Performance =  29.94 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.040668 s, Result = 03840000, Performance =  31.68 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.040949 s, Result = 03930000, Performance =  31.99 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.041698 s, Result = 03a20000, Performance =  31.93 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042439 s, Result = 03b10000, Performance =  31.88 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.047260 s, Result = 03c00000, Performance =  29.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1193  2042   256
Test passed: M N K =  1824  1137  1920
Test passed: M N K =  1734   129   256
Test passed: M N K =   444  1397  2048
Test passed: M N K =   518   645  1024
M N K =  2048  2048   256, Elapsed time =   0.007953 s, Result = 34130000, Performance =   2.70 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008349 s, Result = e4220000, Performance =   5.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008622 s, Result = 94310000, Performance =   7.47 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009377 s, Result = 44400000, Performance =   9.16 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009905 s, Result = f44f0000, Performance =  10.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010373 s, Result = a45e0000, Performance =  12.42 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011294 s, Result = 546d0000, Performance =  13.31 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011855 s, Result = 047c0000, Performance =  14.49 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016360 s, Result = b48b0000, Performance =  11.81 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013484 s, Result = 649a0000, Performance =  15.93 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013937 s, Result = 14a90000, Performance =  16.95 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014918 s, Result = c4b80000, Performance =  17.27 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015627 s, Result = 74c70000, Performance =  17.86 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016868 s, Result = 24d60000, Performance =  17.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016896 s, Result = d4e50000, Performance =  19.07 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.020301 s, Result = 84f40000, Performance =  16.93 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018668 s, Result = 35030000, Performance =  19.56 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019252 s, Result = e5120000, Performance =  20.08 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020126 s, Result = 95210000, Performance =  20.27 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020773 s, Result = 45300000, Performance =  20.68 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021089 s, Result = f53f0000, Performance =  21.38 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022521 s, Result = a54e0000, Performance =  20.98 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022749 s, Result = 555d0000, Performance =  21.71 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024059 s, Result = 056c0000, Performance =  21.42 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024096 s, Result = b57b0000, Performance =  22.28 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024517 s, Result = 658a0000, Performance =  22.77 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025549 s, Result = 15990000, Performance =  22.69 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.026270 s, Result = c5a80000, Performance =  22.89 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027234 s, Result = 75b70000, Performance =  22.87 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.027542 s, Result = 25c60000, Performance =  23.39 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028370 s, Result = d5d50000, Performance =  23.47 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.037893 s, Result = 85e40000, Performance =  18.14 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.029754 s, Result = 35f30000, Performance =  23.82 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030162 s, Result = e6020000, Performance =  24.21 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.030333 s, Result = 96110000, Performance =  24.78 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031611 s, Result = 46200000, Performance =  24.46 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032349 s, Result = f62f0000, Performance =  24.56 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033715 s, Result = a63e0000, Performance =  24.20 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.033556 s, Result = 564d0000, Performance =  24.96 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.035060 s, Result = 065c0000, Performance =  24.50 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.035149 s, Result = b66b0000, Performance =  25.05 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.035519 s, Result = 667a0000, Performance =  25.39 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.036911 s, Result = 16890000, Performance =  25.02 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.037017 s, Result = c6980000, Performance =  25.53 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.037409 s, Result = 76a70000, Performance =  25.83 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.038663 s, Result = 26b60000, Performance =  25.55 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.038607 s, Result = d6c50000, Performance =  26.14 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049391 s, Result = 86d40000, Performance =  20.87 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039885 s, Result = 36e30000, Performance =  26.38 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.041515 s, Result = e6f20000, Performance =  25.86 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.041914 s, Result = 97010000, Performance =  26.13 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.042132 s, Result = 47100000, Performance =  26.50 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.043274 s, Result = f71f0000, Performance =  26.30 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.044045 s, Result = a72e0000, Performance =  26.33 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.043856 s, Result = 573d0000, Performance =  26.93 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047257 s, Result = 074c0000, Performance =  25.45 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.046026 s, Result = b75b0000, Performance =  26.60 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.046147 s, Result = 676a0000, Performance =  26.99 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.047192 s, Result = 17790000, Performance =  26.85 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048855 s, Result = c7880000, Performance =  26.37 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.048341 s, Result = 77970000, Performance =  27.10 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.050990 s, Result = 27a60000, Performance =  26.11 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.049731 s, Result = d7b50000, Performance =  27.20 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.069059 s, Result = 87c40000, Performance =  19.90 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   781  1267   512
Test passed: M N K =  1808   808   640
Test passed: M N K =  1506  1665  1920
Test passed: M N K =  1604  1096  2048
Test passed: M N K =   849  1940   384
M N K =  2048  2048   256, Elapsed time =   0.006322 s, Result = 000f0000, Performance =   3.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007076 s, Result = 001e0000, Performance =   6.07 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007653 s, Result = 002d0000, Performance =   8.42 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007867 s, Result = 003c0000, Performance =  10.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008292 s, Result = 004b0000, Performance =  12.95 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008573 s, Result = 005a0000, Performance =  15.03 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009611 s, Result = 00690000, Performance =  15.64 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010130 s, Result = 00780000, Performance =  16.96 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010572 s, Result = 00870000, Performance =  18.28 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011247 s, Result = 00960000, Performance =  19.09 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012163 s, Result = 00a50000, Performance =  19.42 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012615 s, Result = 00b40000, Performance =  20.43 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013510 s, Result = 00c30000, Performance =  20.66 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014227 s, Result = 00d20000, Performance =  21.13 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014968 s, Result = 00e10000, Performance =  21.52 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018727 s, Result = 00f00000, Performance =  18.35 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016978 s, Result = 00ff0000, Performance =  21.50 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017658 s, Result = 010e0000, Performance =  21.89 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018241 s, Result = 011d0000, Performance =  22.37 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018883 s, Result = 012c0000, Performance =  22.75 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019344 s, Result = 013b0000, Performance =  23.31 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020079 s, Result = 014a0000, Performance =  23.53 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020869 s, Result = 01590000, Performance =  23.67 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022306 s, Result = 01680000, Performance =  23.11 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022219 s, Result = 01770000, Performance =  24.16 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022778 s, Result = 01860000, Performance =  24.51 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023719 s, Result = 01950000, Performance =  24.45 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024410 s, Result = 01a40000, Performance =  24.63 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025216 s, Result = 01b30000, Performance =  24.70 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026421 s, Result = 01c20000, Performance =  24.38 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026216 s, Result = 01d10000, Performance =  25.39 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035553 s, Result = 01e00000, Performance =  19.33 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.027867 s, Result = 01ef0000, Performance =  25.43 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027688 s, Result = 01fe0000, Performance =  26.37 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028631 s, Result = 020d0000, Performance =  26.25 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.029231 s, Result = 021c0000, Performance =  26.45 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029958 s, Result = 022b0000, Performance =  26.52 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.030656 s, Result = 023a0000, Performance =  26.62 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.031432 s, Result = 02490000, Performance =  26.65 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.033255 s, Result = 02580000, Performance =  25.83 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.032282 s, Result = 02670000, Performance =  27.27 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.034055 s, Result = 02760000, Performance =  26.48 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.033928 s, Result = 02850000, Performance =  27.22 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034897 s, Result = 02940000, Performance =  27.08 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.035320 s, Result = 02a30000, Performance =  27.36 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.036151 s, Result = 02b20000, Performance =  27.33 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.037402 s, Result = 02c10000, Performance =  26.99 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046845 s, Result = 02d00000, Performance =  22.00 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.037988 s, Result = 02df0000, Performance =  27.70 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.038885 s, Result = 02ee0000, Performance =  27.61 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.040149 s, Result = 02fd0000, Performance =  27.28 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040561 s, Result = 030c0000, Performance =  27.53 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.041354 s, Result = 031b0000, Performance =  27.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.042059 s, Result = 032a0000, Performance =  27.57 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.042216 s, Result = 03390000, Performance =  27.98 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.044382 s, Result = 03480000, Performance =  27.10 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.043453 s, Result = 03570000, Performance =  28.17 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044050 s, Result = 03660000, Performance =  28.28 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.045401 s, Result = 03750000, Performance =  27.91 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.045781 s, Result = 03840000, Performance =  28.14 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.047012 s, Result = 03930000, Performance =  27.86 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.046617 s, Result = 03a20000, Performance =  28.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.048234 s, Result = 03b10000, Performance =  28.05 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.064764 s, Result = 03c00000, Performance =  21.22 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   948   547  1728
Test passed: M N K =   118    15  1856
Test passed: M N K =  1711   949   640
Test passed: M N K =  2015   885  1344
Test passed: M N K =   825  1649  1408
M N K =  2048  2048   256, Elapsed time =   0.003618 s, Result = 28370000, Performance =   5.94 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004086 s, Result = 28460000, Performance =  10.51 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004951 s, Result = 28550000, Performance =  13.01 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005191 s, Result = 28640000, Performance =  16.55 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005994 s, Result = 28730000, Performance =  17.91 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006291 s, Result = 28820000, Performance =  20.48 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007186 s, Result = 28910000, Performance =  20.92 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008150 s, Result = 28a00000, Performance =  21.08 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008286 s, Result = 28af0000, Performance =  23.33 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013020 s, Result = 28be0000, Performance =  16.49 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010169 s, Result = 28cd0000, Performance =  23.23 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010942 s, Result = 28dc0000, Performance =  23.55 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011963 s, Result = 28eb0000, Performance =  23.34 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012723 s, Result = 28fa0000, Performance =  23.63 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013612 s, Result = 29090000, Performance =  23.66 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016764 s, Result = 29180000, Performance =  20.50 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014846 s, Result = 29270000, Performance =  24.59 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015370 s, Result = 29360000, Performance =  25.15 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015928 s, Result = 29450000, Performance =  25.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016969 s, Result = 29540000, Performance =  25.31 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017634 s, Result = 29630000, Performance =  25.57 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018350 s, Result = 29720000, Performance =  25.75 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018868 s, Result = 29810000, Performance =  26.18 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020485 s, Result = 29900000, Performance =  25.16 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020365 s, Result = 299f0000, Performance =  26.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021180 s, Result = 29ae0000, Performance =  26.36 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022345 s, Result = 29bd0000, Performance =  25.95 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022868 s, Result = 29cc0000, Performance =  26.29 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023629 s, Result = 29db0000, Performance =  26.36 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.024321 s, Result = 29ea0000, Performance =  26.49 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024352 s, Result = 29f90000, Performance =  27.34 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.031353 s, Result = 2a080000, Performance =  21.92 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.026117 s, Result = 2a170000, Performance =  27.13 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026416 s, Result = 2a260000, Performance =  27.64 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.027645 s, Result = 2a350000, Performance =  27.19 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.028503 s, Result = 2a440000, Performance =  27.12 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029172 s, Result = 2a530000, Performance =  27.24 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.029049 s, Result = 2a620000, Performance =  28.09 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.029859 s, Result = 2a710000, Performance =  28.05 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.031561 s, Result = 2a800000, Performance =  27.22 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031401 s, Result = 2a8f0000, Performance =  28.04 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.032299 s, Result = 2a9e0000, Performance =  27.92 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032776 s, Result = 2aad0000, Performance =  28.17 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.033691 s, Result = 2abc0000, Performance =  28.05 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.034227 s, Result = 2acb0000, Performance =  28.23 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.034977 s, Result = 2ada0000, Performance =  28.24 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.035095 s, Result = 2ae90000, Performance =  28.76 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046020 s, Result = 2af80000, Performance =  22.40 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.036443 s, Result = 2b070000, Performance =  28.87 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.038128 s, Result = 2b160000, Performance =  28.16 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.038377 s, Result = 2b250000, Performance =  28.54 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.039587 s, Result = 2b340000, Performance =  28.21 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.041882 s, Result = 2b430000, Performance =  27.18 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.040858 s, Result = 2b520000, Performance =  28.38 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.040826 s, Result = 2b610000, Performance =  28.93 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.046180 s, Result = 2b700000, Performance =  26.04 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.041442 s, Result = 2b7f0000, Performance =  29.54 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.043311 s, Result = 2b8e0000, Performance =  28.76 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.044882 s, Result = 2b9d0000, Performance =  28.23 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.044179 s, Result = 2bac0000, Performance =  29.17 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.045585 s, Result = 2bbb0000, Performance =  28.74 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.045572 s, Result = 2bca0000, Performance =  29.22 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.045745 s, Result = 2bd90000, Performance =  29.58 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.064047 s, Result = 2be80000, Performance =  21.46 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   665   902  1024
Test passed: M N K =   910    64   256
Test passed: M N K =   527  1411   640
Test passed: M N K =   991   691   832
Test passed: M N K =    14  1198  1024
M N K =  2048  2048   256, Elapsed time =   0.000546 s, Result = 000f0000, Performance =  39.30 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001252 s, Result = 001e0000, Performance =  34.30 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001588 s, Result = 002d0000, Performance =  40.56 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001858 s, Result = 003c0000, Performance =  46.24 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002888 s, Result = 004b0000, Performance =  37.18 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003179 s, Result = 005a0000, Performance =  40.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004131 s, Result = 00690000, Performance =  36.39 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004624 s, Result = 00780000, Performance =  37.15 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005228 s, Result = 00870000, Performance =  36.97 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011350 s, Result = 00960000, Performance =  18.92 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007092 s, Result = 00a50000, Performance =  33.31 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007916 s, Result = 00b40000, Performance =  32.56 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009019 s, Result = 00c30000, Performance =  30.96 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009714 s, Result = 00d20000, Performance =  30.95 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010450 s, Result = 00e10000, Performance =  30.83 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014511 s, Result = 00f00000, Performance =  23.68 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011553 s, Result = 00ff0000, Performance =  31.60 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012212 s, Result = 010e0000, Performance =  31.65 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012949 s, Result = 011d0000, Performance =  31.51 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013876 s, Result = 012c0000, Performance =  30.95 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014113 s, Result = 013b0000, Performance =  31.95 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015001 s, Result = 014a0000, Performance =  31.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.015740 s, Result = 01590000, Performance =  31.38 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017059 s, Result = 01680000, Performance =  30.21 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.016687 s, Result = 01770000, Performance =  32.17 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017870 s, Result = 01860000, Performance =  31.24 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018422 s, Result = 01950000, Performance =  31.47 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.019447 s, Result = 01a40000, Performance =  30.92 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019670 s, Result = 01b30000, Performance =  31.66 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020533 s, Result = 01c20000, Performance =  31.38 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.020880 s, Result = 01d10000, Performance =  31.88 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029287 s, Result = 01e00000, Performance =  23.46 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.022321 s, Result = 01ef0000, Performance =  31.75 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.022914 s, Result = 01fe0000, Performance =  31.86 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024197 s, Result = 020d0000, Performance =  31.06 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024747 s, Result = 021c0000, Performance =  31.24 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.024887 s, Result = 022b0000, Performance =  31.93 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026290 s, Result = 023a0000, Performance =  31.04 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026613 s, Result = 02490000, Performance =  31.47 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.029056 s, Result = 02580000, Performance =  29.56 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028351 s, Result = 02670000, Performance =  31.06 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.028686 s, Result = 02760000, Performance =  31.44 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029541 s, Result = 02850000, Performance =  31.26 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030453 s, Result = 02940000, Performance =  31.03 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031285 s, Result = 02a30000, Performance =  30.89 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031552 s, Result = 02b20000, Performance =  31.31 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032228 s, Result = 02c10000, Performance =  31.32 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043061 s, Result = 02d00000, Performance =  23.94 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.032750 s, Result = 02df0000, Performance =  32.13 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.033945 s, Result = 02ee0000, Performance =  31.63 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035076 s, Result = 02fd0000, Performance =  31.22 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035911 s, Result = 030c0000, Performance =  31.10 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035870 s, Result = 031b0000, Performance =  31.73 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.037132 s, Result = 032a0000, Performance =  31.23 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.037204 s, Result = 03390000, Performance =  31.75 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.040410 s, Result = 03480000, Performance =  29.76 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038175 s, Result = 03570000, Performance =  32.06 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039839 s, Result = 03660000, Performance =  31.26 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.040168 s, Result = 03750000, Performance =  31.54 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041623 s, Result = 03840000, Performance =  30.96 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041483 s, Result = 03930000, Performance =  31.58 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042016 s, Result = 03a20000, Performance =  31.69 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042387 s, Result = 03b10000, Performance =  31.92 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.062212 s, Result = 03c00000, Performance =  22.09 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   123  1487  1216
Test passed: M N K =   345   814   192
Test passed: M N K =  1796    81    64
Test passed: M N K =  1600   944   512
Test passed: M N K =  1543  1245    64
M N K =  2048  2048   256, Elapsed time =   0.007889 s, Result = 34130000, Performance =   2.72 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008427 s, Result = e4220000, Performance =   5.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008830 s, Result = 94310000, Performance =   7.30 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009322 s, Result = 44400000, Performance =   9.21 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010001 s, Result = f44f0000, Performance =  10.74 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010488 s, Result = a45e0000, Performance =  12.29 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010961 s, Result = 546d0000, Performance =  13.71 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011771 s, Result = 047c0000, Performance =  14.59 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016680 s, Result = b48b0000, Performance =  11.59 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013504 s, Result = 649a0000, Performance =  15.90 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014579 s, Result = 14a90000, Performance =  16.20 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015537 s, Result = c4b80000, Performance =  16.59 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016393 s, Result = 74c70000, Performance =  17.03 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017466 s, Result = 24d60000, Performance =  17.21 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018635 s, Result = d4e50000, Performance =  17.29 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021274 s, Result = 84f40000, Performance =  16.15 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021023 s, Result = 35030000, Performance =  17.37 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021814 s, Result = e5120000, Performance =  17.72 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022345 s, Result = 95210000, Performance =  18.26 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023779 s, Result = 45300000, Performance =  18.06 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024025 s, Result = f53f0000, Performance =  18.77 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024735 s, Result = a54e0000, Performance =  19.10 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025950 s, Result = 555d0000, Performance =  19.03 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026038 s, Result = 056c0000, Performance =  19.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.027870 s, Result = b57b0000, Performance =  19.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028711 s, Result = 658a0000, Performance =  19.45 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029807 s, Result = 15990000, Performance =  19.45 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.030977 s, Result = c5a80000, Performance =  19.41 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.030761 s, Result = 75b70000, Performance =  20.25 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031803 s, Result = 25c60000, Performance =  20.26 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.032763 s, Result = d5d50000, Performance =  20.32 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.036541 s, Result = 85e40000, Performance =  18.81 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.034471 s, Result = 35f30000, Performance =  20.56 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.034962 s, Result = e6020000, Performance =  20.88 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.036270 s, Result = 96110000, Performance =  20.72 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.036929 s, Result = 46200000, Performance =  20.93 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.038410 s, Result = f62f0000, Performance =  20.69 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.038511 s, Result = a63e0000, Performance =  21.19 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040017 s, Result = 564d0000, Performance =  20.93 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.038665 s, Result = 065c0000, Performance =  22.22 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041783 s, Result = b66b0000, Performance =  21.07 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042279 s, Result = 667a0000, Performance =  21.33 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043985 s, Result = 16890000, Performance =  20.99 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.044597 s, Result = c6980000, Performance =  21.19 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045427 s, Result = 76a70000, Performance =  21.27 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045643 s, Result = 26b60000, Performance =  21.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046548 s, Result = d6c50000, Performance =  21.68 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.050762 s, Result = 86d40000, Performance =  20.31 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.048364 s, Result = 36e30000, Performance =  21.76 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.049346 s, Result = e6f20000, Performance =  21.76 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.050424 s, Result = 97010000, Performance =  21.72 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.052157 s, Result = 47100000, Performance =  21.41 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.052371 s, Result = f71f0000, Performance =  21.73 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.053495 s, Result = a72e0000, Performance =  21.68 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.054154 s, Result = 573d0000, Performance =  21.81 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.052484 s, Result = 074c0000, Performance =  22.91 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.055880 s, Result = b75b0000, Performance =  21.91 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.056577 s, Result = 676a0000, Performance =  22.02 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.058154 s, Result = 17790000, Performance =  21.79 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.058726 s, Result = c7880000, Performance =  21.94 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.059338 s, Result = 77970000, Performance =  22.08 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.062407 s, Result = 27a60000, Performance =  21.33 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.060290 s, Result = d7b50000, Performance =  22.44 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.065916 s, Result = 87c40000, Performance =  20.85 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   852   319  1408
Test passed: M N K =   556  1672   832
Test passed: M N K =  1952   415   320
Test passed: M N K =    27   190  1920
Test passed: M N K =  1907  1598  1664
M N K =  2048  2048   256, Elapsed time =   0.005824 s, Result = 000f0000, Performance =   3.69 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007126 s, Result = 001e0000, Performance =   6.03 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007309 s, Result = 002d0000, Performance =   8.81 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007905 s, Result = 003c0000, Performance =  10.87 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008309 s, Result = 004b0000, Performance =  12.92 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008981 s, Result = 005a0000, Performance =  14.35 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009182 s, Result = 00690000, Performance =  16.37 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009950 s, Result = 00780000, Performance =  17.27 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010721 s, Result = 00870000, Performance =  18.03 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011326 s, Result = 00960000, Performance =  18.96 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012235 s, Result = 00a50000, Performance =  19.31 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013439 s, Result = 00b40000, Performance =  19.18 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014080 s, Result = 00c30000, Performance =  19.83 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015178 s, Result = 00d20000, Performance =  19.81 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016531 s, Result = 00e10000, Performance =  19.49 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018215 s, Result = 00f00000, Performance =  18.86 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019279 s, Result = 00ff0000, Performance =  18.94 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020121 s, Result = 010e0000, Performance =  19.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021125 s, Result = 011d0000, Performance =  19.31 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022176 s, Result = 012c0000, Performance =  19.37 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022964 s, Result = 013b0000, Performance =  19.64 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023694 s, Result = 014a0000, Performance =  19.94 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.024018 s, Result = 01590000, Performance =  20.56 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024252 s, Result = 01680000, Performance =  21.25 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025928 s, Result = 01770000, Performance =  20.71 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026742 s, Result = 01860000, Performance =  20.88 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027740 s, Result = 01950000, Performance =  20.90 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028407 s, Result = 01a40000, Performance =  21.17 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.029340 s, Result = 01b30000, Performance =  21.23 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029651 s, Result = 01c20000, Performance =  21.73 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.031005 s, Result = 01d10000, Performance =  21.47 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035295 s, Result = 01e00000, Performance =  19.47 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.033160 s, Result = 01ef0000, Performance =  21.37 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032712 s, Result = 01fe0000, Performance =  22.32 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.034493 s, Result = 020d0000, Performance =  21.79 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034956 s, Result = 021c0000, Performance =  22.12 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035959 s, Result = 022b0000, Performance =  22.10 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036793 s, Result = 023a0000, Performance =  22.18 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037869 s, Result = 02490000, Performance =  22.12 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.037016 s, Result = 02580000, Performance =  23.21 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.039781 s, Result = 02670000, Performance =  22.13 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.040409 s, Result = 02760000, Performance =  22.32 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.041807 s, Result = 02850000, Performance =  22.09 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.042973 s, Result = 02940000, Performance =  21.99 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.042977 s, Result = 02a30000, Performance =  22.49 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.043459 s, Result = 02b20000, Performance =  22.73 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.044083 s, Result = 02c10000, Performance =  22.90 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.048217 s, Result = 02d00000, Performance =  21.38 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.046071 s, Result = 02df0000, Performance =  22.84 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047377 s, Result = 02ee0000, Performance =  22.66 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.048383 s, Result = 02fd0000, Performance =  22.64 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.049773 s, Result = 030c0000, Performance =  22.44 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.050280 s, Result = 031b0000, Performance =  22.64 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.051359 s, Result = 032a0000, Performance =  22.58 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.052479 s, Result = 03390000, Performance =  22.51 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050423 s, Result = 03480000, Performance =  23.85 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054349 s, Result = 03570000, Performance =  22.52 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.054430 s, Result = 03660000, Performance =  22.88 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055440 s, Result = 03750000, Performance =  22.85 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056721 s, Result = 03840000, Performance =  22.72 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.057270 s, Result = 03930000, Performance =  22.87 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057770 s, Result = 03a20000, Performance =  23.05 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057762 s, Result = 03b10000, Performance =  23.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.064486 s, Result = 03c00000, Performance =  21.31 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1654  1580  2048
Test passed: M N K =  1973  1111   256
Test passed: M N K =  1729  1638  1984
Test passed: M N K =   231   742  1344
Test passed: M N K =    28   229  1024
M N K =  2048  2048   256, Elapsed time =   0.003602 s, Result = 28370000, Performance =   5.96 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004262 s, Result = 28460000, Performance =  10.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004660 s, Result = 28550000, Performance =  13.82 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005269 s, Result = 28640000, Performance =  16.30 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006087 s, Result = 28730000, Performance =  17.64 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006410 s, Result = 28820000, Performance =  20.10 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007037 s, Result = 28910000, Performance =  21.36 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007788 s, Result = 28a00000, Performance =  22.06 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008808 s, Result = 28af0000, Performance =  21.94 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013024 s, Result = 28be0000, Performance =  16.49 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010422 s, Result = 28cd0000, Performance =  22.67 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011424 s, Result = 28dc0000, Performance =  22.56 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012784 s, Result = 28eb0000, Performance =  21.84 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013774 s, Result = 28fa0000, Performance =  21.83 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014650 s, Result = 29090000, Performance =  21.99 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016744 s, Result = 29180000, Performance =  20.52 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017424 s, Result = 29270000, Performance =  20.95 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018376 s, Result = 29360000, Performance =  21.04 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019483 s, Result = 29450000, Performance =  20.94 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020582 s, Result = 29540000, Performance =  20.87 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021318 s, Result = 29630000, Performance =  21.15 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021821 s, Result = 29720000, Performance =  21.65 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022780 s, Result = 29810000, Performance =  21.68 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022569 s, Result = 29900000, Performance =  22.84 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024302 s, Result = 299f0000, Performance =  22.09 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024545 s, Result = 29ae0000, Performance =  22.75 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.026599 s, Result = 29bd0000, Performance =  21.80 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027869 s, Result = 29cc0000, Performance =  21.58 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.028186 s, Result = 29db0000, Performance =  22.09 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.028572 s, Result = 29ea0000, Performance =  22.55 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.029741 s, Result = 29f90000, Performance =  22.38 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.032885 s, Result = 2a080000, Performance =  20.90 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.032258 s, Result = 2a170000, Performance =  21.97 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.031744 s, Result = 2a260000, Performance =  23.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.032327 s, Result = 2a350000, Performance =  23.25 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034121 s, Result = 2a440000, Performance =  22.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.034344 s, Result = 2a530000, Performance =  23.14 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.035625 s, Result = 2a620000, Performance =  22.91 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.036492 s, Result = 2a710000, Performance =  22.95 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036473 s, Result = 2a800000, Performance =  23.55 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.038673 s, Result = 2a8f0000, Performance =  22.77 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039363 s, Result = 2a9e0000, Performance =  22.91 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040864 s, Result = 2aad0000, Performance =  22.60 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.042191 s, Result = 2abc0000, Performance =  22.40 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.042112 s, Result = 2acb0000, Performance =  22.95 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042025 s, Result = 2ada0000, Performance =  23.51 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.042565 s, Result = 2ae90000, Performance =  23.71 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.047816 s, Result = 2af80000, Performance =  21.56 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.045315 s, Result = 2b070000, Performance =  23.22 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.046071 s, Result = 2b160000, Performance =  23.31 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047166 s, Result = 2b250000, Performance =  23.22 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048548 s, Result = 2b340000, Performance =  23.00 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.052130 s, Result = 2b430000, Performance =  21.83 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.050554 s, Result = 2b520000, Performance =  22.94 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.051338 s, Result = 2b610000, Performance =  23.01 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.049591 s, Result = 2b700000, Performance =  24.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.053300 s, Result = 2b7f0000, Performance =  22.97 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.053315 s, Result = 2b8e0000, Performance =  23.36 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055090 s, Result = 2b9d0000, Performance =  23.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056024 s, Result = 2bac0000, Performance =  23.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.056180 s, Result = 2bbb0000, Performance =  23.32 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.056677 s, Result = 2bca0000, Performance =  23.49 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057242 s, Result = 2bd90000, Performance =  23.64 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.062572 s, Result = 2be80000, Performance =  21.96 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1489   462  1856
Test passed: M N K =  1849   343  1344
Test passed: M N K =   861   784  1024
Test passed: M N K =  1005   142  1984
Test passed: M N K =  1779  1109  1664
M N K =  2048  2048   256, Elapsed time =   0.000530 s, Result = 000f0000, Performance =  40.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001076 s, Result = 001e0000, Performance =  39.91 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001597 s, Result = 002d0000, Performance =  40.34 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002447 s, Result = 003c0000, Performance =  35.10 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002721 s, Result = 004b0000, Performance =  39.46 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003792 s, Result = 005a0000, Performance =  33.98 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003998 s, Result = 00690000, Performance =  37.60 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005408 s, Result = 00780000, Performance =  31.76 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006440 s, Result = 00870000, Performance =  30.01 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008786 s, Result = 00960000, Performance =  24.44 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008090 s, Result = 00a50000, Performance =  29.20 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009256 s, Result = 00b40000, Performance =  27.84 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010096 s, Result = 00c30000, Performance =  27.65 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011418 s, Result = 00d20000, Performance =  26.33 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012926 s, Result = 00e10000, Performance =  24.92 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014854 s, Result = 00f00000, Performance =  23.13 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014804 s, Result = 00ff0000, Performance =  24.66 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015919 s, Result = 010e0000, Performance =  24.28 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016969 s, Result = 011d0000, Performance =  24.04 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018130 s, Result = 012c0000, Performance =  23.69 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018688 s, Result = 013b0000, Performance =  24.13 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019459 s, Result = 014a0000, Performance =  24.28 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020173 s, Result = 01590000, Performance =  24.48 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020236 s, Result = 01680000, Performance =  25.47 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.021806 s, Result = 01770000, Performance =  24.62 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022669 s, Result = 01860000, Performance =  24.63 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023823 s, Result = 01950000, Performance =  24.34 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024869 s, Result = 01a40000, Performance =  24.18 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025415 s, Result = 01b30000, Performance =  24.50 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025615 s, Result = 01c20000, Performance =  25.15 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026605 s, Result = 01d10000, Performance =  25.02 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029639 s, Result = 01e00000, Performance =  23.19 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.028915 s, Result = 01ef0000, Performance =  24.51 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.029621 s, Result = 01fe0000, Performance =  24.65 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.030378 s, Result = 020d0000, Performance =  24.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031560 s, Result = 021c0000, Performance =  24.50 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.032560 s, Result = 022b0000, Performance =  24.40 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.033377 s, Result = 023a0000, Performance =  24.45 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.034082 s, Result = 02490000, Performance =  24.57 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.033849 s, Result = 02580000, Performance =  25.38 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.035775 s, Result = 02670000, Performance =  24.61 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.037054 s, Result = 02760000, Performance =  24.34 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.037751 s, Result = 02850000, Performance =  24.46 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.039377 s, Result = 02940000, Performance =  24.00 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.039173 s, Result = 02a30000, Performance =  24.67 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.039861 s, Result = 02b20000, Performance =  24.78 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.041042 s, Result = 02c10000, Performance =  24.59 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.044314 s, Result = 02d00000, Performance =  23.26 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.041993 s, Result = 02df0000, Performance =  25.06 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043211 s, Result = 02ee0000, Performance =  24.85 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.044640 s, Result = 02fd0000, Performance =  24.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045963 s, Result = 030c0000, Performance =  24.30 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.046453 s, Result = 031b0000, Performance =  24.50 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.046986 s, Result = 032a0000, Performance =  24.68 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.048458 s, Result = 03390000, Performance =  24.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047184 s, Result = 03480000, Performance =  25.49 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.049675 s, Result = 03570000, Performance =  24.64 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.050757 s, Result = 03660000, Performance =  24.54 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052271 s, Result = 03750000, Performance =  24.24 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.053229 s, Result = 03840000, Performance =  24.21 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053480 s, Result = 03930000, Performance =  24.49 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.054074 s, Result = 03a20000, Performance =  24.62 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.054314 s, Result = 03b10000, Performance =  24.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.059360 s, Result = 03c00000, Performance =  23.15 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1486   641  1920
Test passed: M N K =   147   385  1600
Test passed: M N K =   100   891   576
Test passed: M N K =  1676  1686  1728
Test passed: M N K =   704  1308  1728
M N K =  2048  2048   256, Elapsed time =   0.006570 s, Result = 440e0000, Performance =   3.27 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007285 s, Result = 84180000, Performance =   5.90 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007498 s, Result = c4220000, Performance =   8.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007863 s, Result = 042c0000, Performance =  10.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008284 s, Result = 44360000, Performance =  12.96 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008744 s, Result = 84400000, Performance =  14.74 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009650 s, Result = c44a0000, Performance =  15.58 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010000 s, Result = 04540000, Performance =  17.18 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014787 s, Result = 445e0000, Performance =  13.07 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011245 s, Result = 84680000, Performance =  19.10 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011960 s, Result = c4720000, Performance =  19.75 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012820 s, Result = 047c0000, Performance =  20.10 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013105 s, Result = 44860000, Performance =  21.30 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013462 s, Result = 84900000, Performance =  22.33 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014506 s, Result = c49a0000, Performance =  22.21 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015308 s, Result = 04a40000, Performance =  22.45 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015614 s, Result = 44ae0000, Performance =  23.38 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.016268 s, Result = 84b80000, Performance =  23.76 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016852 s, Result = c4c20000, Performance =  24.21 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016896 s, Result = 04cc0000, Performance =  25.42 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017597 s, Result = 44d60000, Performance =  25.63 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017912 s, Result = 84e00000, Performance =  26.38 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018099 s, Result = c4ea0000, Performance =  27.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019109 s, Result = 04f40000, Performance =  26.97 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020090 s, Result = 44fe0000, Performance =  26.72 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020503 s, Result = 85080000, Performance =  27.23 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.020562 s, Result = c5120000, Performance =  28.20 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.021592 s, Result = 051c0000, Performance =  27.85 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.022118 s, Result = 45260000, Performance =  28.16 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023202 s, Result = 85300000, Performance =  27.77 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022973 s, Result = c53a0000, Performance =  28.98 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.024344 s, Result = 05440000, Performance =  28.23 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023382 s, Result = 454e0000, Performance =  30.31 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024091 s, Result = 85580000, Performance =  30.31 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024550 s, Result = c5620000, Performance =  30.62 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024587 s, Result = 056c0000, Performance =  31.44 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025129 s, Result = 45760000, Performance =  31.62 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.025605 s, Result = 85800000, Performance =  31.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025912 s, Result = c58a0000, Performance =  32.32 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.026382 s, Result = 05940000, Performance =  32.56 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.026750 s, Result = 459e0000, Performance =  32.91 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.027570 s, Result = 85a80000, Performance =  32.72 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029064 s, Result = c5b20000, Performance =  31.77 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.029074 s, Result = 05bc0000, Performance =  32.50 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.029011 s, Result = 45c60000, Performance =  33.31 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.029216 s, Result = 85d00000, Performance =  33.81 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.030089 s, Result = c5da0000, Performance =  33.54 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.030801 s, Result = 05e40000, Performance =  33.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.032299 s, Result = 45ee0000, Performance =  32.58 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.031986 s, Result = 85f80000, Performance =  33.57 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031945 s, Result = c6020000, Performance =  34.28 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.032129 s, Result = 060c0000, Performance =  34.76 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032694 s, Result = 46160000, Performance =  34.81 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.033282 s, Result = 86200000, Performance =  34.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.034943 s, Result = c62a0000, Performance =  33.80 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.034636 s, Result = 06340000, Performance =  34.72 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.037686 s, Result = 463e0000, Performance =  32.48 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.035329 s, Result = 86480000, Performance =  35.26 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.036637 s, Result = c6520000, Performance =  34.58 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.036589 s, Result = 065c0000, Performance =  35.21 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.037599 s, Result = 46660000, Performance =  34.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.037840 s, Result = 86700000, Performance =  35.19 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.039033 s, Result = c67a0000, Performance =  34.66 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.040052 s, Result = 06840000, Performance =  34.32 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   454  1332   256
Test passed: M N K =   650  1844   640
Test passed: M N K =  1373  1516   640
Test passed: M N K =  1766  1465   192
Test passed: M N K =  1961  1212  1728
M N K =  2048  2048   256, Elapsed time =   0.005792 s, Result = 000a0000, Performance =   3.71 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005689 s, Result = 00140000, Performance =   7.55 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005619 s, Result = 001e0000, Performance =  11.47 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006351 s, Result = 00280000, Performance =  13.53 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006355 s, Result = 00320000, Performance =  16.90 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007148 s, Result = 003c0000, Performance =  18.03 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007714 s, Result = 00460000, Performance =  19.49 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008070 s, Result = 00500000, Performance =  21.29 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008771 s, Result = 005a0000, Performance =  22.04 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013262 s, Result = 00640000, Performance =  16.19 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009840 s, Result = 006e0000, Performance =  24.01 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010781 s, Result = 00780000, Performance =  23.90 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011261 s, Result = 00820000, Performance =  24.79 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011782 s, Result = 008c0000, Performance =  25.52 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011905 s, Result = 00960000, Performance =  27.06 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013297 s, Result = 00a00000, Performance =  25.84 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013083 s, Result = 00aa0000, Performance =  27.90 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012899 s, Result = 00b40000, Performance =  29.97 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013634 s, Result = 00be0000, Performance =  29.93 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015441 s, Result = 00c80000, Performance =  27.82 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014674 s, Result = 00d20000, Performance =  30.73 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015923 s, Result = 00dc0000, Performance =  29.67 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016117 s, Result = 00e60000, Performance =  30.65 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016710 s, Result = 00f00000, Performance =  30.84 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018011 s, Result = 00fa0000, Performance =  29.81 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017358 s, Result = 01040000, Performance =  32.17 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018722 s, Result = 010e0000, Performance =  30.97 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018546 s, Result = 01180000, Performance =  32.42 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019807 s, Result = 01220000, Performance =  31.44 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019753 s, Result = 012c0000, Performance =  32.61 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021120 s, Result = 01360000, Performance =  31.52 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022061 s, Result = 01400000, Performance =  31.15 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021032 s, Result = 014a0000, Performance =  33.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021186 s, Result = 01540000, Performance =  34.46 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.022613 s, Result = 015e0000, Performance =  33.24 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.022195 s, Result = 01680000, Performance =  34.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.022849 s, Result = 01720000, Performance =  34.77 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023490 s, Result = 017c0000, Performance =  34.74 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023834 s, Result = 01860000, Performance =  35.14 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.023777 s, Result = 01900000, Performance =  36.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.024939 s, Result = 019a0000, Performance =  35.30 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.025365 s, Result = 01a40000, Performance =  35.56 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026231 s, Result = 01ae0000, Performance =  35.20 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.026099 s, Result = 01b80000, Performance =  36.20 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.026339 s, Result = 01c20000, Performance =  36.69 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.027329 s, Result = 01cc0000, Performance =  36.15 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.028216 s, Result = 01d60000, Performance =  35.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.029116 s, Result = 01e00000, Performance =  35.40 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.029309 s, Result = 01ea0000, Performance =  35.90 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.029763 s, Result = 01f40000, Performance =  36.08 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.030019 s, Result = 01fe0000, Performance =  36.48 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.030154 s, Result = 02080000, Performance =  37.03 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.030668 s, Result = 02120000, Performance =  37.11 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.031382 s, Result = 021c0000, Performance =  36.95 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.033929 s, Result = 02260000, Performance =  34.81 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.032724 s, Result = 02300000, Performance =  36.75 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.033664 s, Result = 023a0000, Performance =  36.36 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.033515 s, Result = 02440000, Performance =  37.16 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.034544 s, Result = 024e0000, Performance =  36.68 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.034791 s, Result = 02580000, Performance =  37.04 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.037896 s, Result = 02620000, Performance =  34.57 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035454 s, Result = 026c0000, Performance =  37.55 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.037144 s, Result = 02760000, Performance =  36.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.037494 s, Result = 02800000, Performance =  36.66 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1747  1497   832
Test passed: M N K =  1331  1365  1536
Test passed: M N K =   472  1804   256
Test passed: M N K =   493  1568   128
Test passed: M N K =   877  1168   320
M N K =  2048  2048   256, Elapsed time =   0.003576 s, Result = 28320000, Performance =   6.01 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003962 s, Result = 283c0000, Performance =  10.84 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004356 s, Result = 28460000, Performance =  14.79 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004773 s, Result = 28500000, Performance =  18.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005214 s, Result = 285a0000, Performance =  20.59 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005636 s, Result = 28640000, Performance =  22.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006156 s, Result = 286e0000, Performance =  24.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006757 s, Result = 28780000, Performance =  25.43 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007152 s, Result = 28820000, Performance =  27.02 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011763 s, Result = 288c0000, Performance =  18.26 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008551 s, Result = 28960000, Performance =  27.63 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009195 s, Result = 28a00000, Performance =  28.03 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009784 s, Result = 28aa0000, Performance =  28.53 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010346 s, Result = 28b40000, Performance =  29.06 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010954 s, Result = 28be0000, Performance =  29.41 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012053 s, Result = 28c80000, Performance =  28.51 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011229 s, Result = 28d20000, Performance =  32.51 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011522 s, Result = 28dc0000, Performance =  33.55 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012345 s, Result = 28e60000, Performance =  33.05 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012931 s, Result = 28f00000, Performance =  33.21 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012986 s, Result = 28fa0000, Performance =  34.73 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014364 s, Result = 29040000, Performance =  32.89 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.013857 s, Result = 290e0000, Performance =  35.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.015700 s, Result = 29180000, Performance =  32.83 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014852 s, Result = 29220000, Performance =  36.15 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016567 s, Result = 292c0000, Performance =  33.70 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017020 s, Result = 29360000, Performance =  34.07 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017365 s, Result = 29400000, Performance =  34.63 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018041 s, Result = 294a0000, Performance =  34.52 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018805 s, Result = 29540000, Performance =  34.26 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019118 s, Result = 295e0000, Performance =  34.82 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.019961 s, Result = 29680000, Performance =  34.43 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020320 s, Result = 29720000, Performance =  34.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021063 s, Result = 297c0000, Performance =  34.67 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021051 s, Result = 29860000, Performance =  35.70 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.021134 s, Result = 29900000, Performance =  36.58 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021238 s, Result = 299a0000, Performance =  37.41 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022419 s, Result = 29a40000, Performance =  36.40 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.022720 s, Result = 29ae0000, Performance =  36.86 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022940 s, Result = 29b80000, Performance =  37.45 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.023677 s, Result = 29c20000, Performance =  37.19 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.024176 s, Result = 29cc0000, Performance =  37.31 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.024866 s, Result = 29d60000, Performance =  37.14 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.024856 s, Result = 29e00000, Performance =  38.01 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.025607 s, Result = 29ea0000, Performance =  37.74 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.026413 s, Result = 29f40000, Performance =  37.40 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.027743 s, Result = 29fe0000, Performance =  36.38 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028415 s, Result = 2a080000, Performance =  36.28 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.027194 s, Result = 2a120000, Performance =  38.70 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.027413 s, Result = 2a1c0000, Performance =  39.17 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.028790 s, Result = 2a260000, Performance =  38.04 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.028952 s, Result = 2a300000, Performance =  38.57 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.029488 s, Result = 2a3a0000, Performance =  38.60 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.029538 s, Result = 2a440000, Performance =  39.26 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.030531 s, Result = 2a4e0000, Performance =  38.69 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.031193 s, Result = 2a580000, Performance =  38.55 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.030198 s, Result = 2a620000, Performance =  40.53 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.032563 s, Result = 2a6c0000, Performance =  38.25 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.032662 s, Result = 2a760000, Performance =  38.79 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.032327 s, Result = 2a800000, Performance =  39.86 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.032776 s, Result = 2a8a0000, Performance =  39.97 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035232 s, Result = 2a940000, Performance =  37.79 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.034505 s, Result = 2a9e0000, Performance =  39.21 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.036743 s, Result = 2aa80000, Performance =  37.41 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   107  2020   960
Test passed: M N K =   470   347  1152
Test passed: M N K =   691   874  1152
Test passed: M N K =  1968  1698  1984
Test passed: M N K =   999  1751   192
M N K =  2048  2048   256, Elapsed time =   0.000451 s, Result = 000a0000, Performance =  47.61 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000815 s, Result = 00140000, Performance =  52.69 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001202 s, Result = 001e0000, Performance =  53.61 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001598 s, Result = 00280000, Performance =  53.76 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002023 s, Result = 00320000, Performance =  53.08 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002600 s, Result = 003c0000, Performance =  49.56 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003006 s, Result = 00460000, Performance =  50.02 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003674 s, Result = 00500000, Performance =  46.76 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004050 s, Result = 005a0000, Performance =  47.72 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006339 s, Result = 00640000, Performance =  33.88 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005285 s, Result = 006e0000, Performance =  44.70 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.006169 s, Result = 00780000, Performance =  41.77 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006679 s, Result = 00820000, Performance =  41.80 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007456 s, Result = 008c0000, Performance =  40.32 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.007894 s, Result = 00960000, Performance =  40.81 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.009321 s, Result = 00a00000, Performance =  36.86 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.007977 s, Result = 00aa0000, Performance =  45.77 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.008527 s, Result = 00b40000, Performance =  45.33 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.009114 s, Result = 00be0000, Performance =  44.77 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010276 s, Result = 00c80000, Performance =  41.79 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010438 s, Result = 00d20000, Performance =  43.20 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.010426 s, Result = 00dc0000, Performance =  45.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.011301 s, Result = 00e60000, Performance =  43.71 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012267 s, Result = 00f00000, Performance =  42.02 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012415 s, Result = 00fa0000, Performance =  43.24 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013113 s, Result = 01040000, Performance =  42.58 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.013646 s, Result = 010e0000, Performance =  42.49 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.013597 s, Result = 01180000, Performance =  44.22 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014726 s, Result = 01220000, Performance =  42.29 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.014484 s, Result = 012c0000, Performance =  44.48 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015641 s, Result = 01360000, Performance =  42.56 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016941 s, Result = 01400000, Performance =  40.56 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016378 s, Result = 014a0000, Performance =  43.27 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017182 s, Result = 01540000, Performance =  42.49 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017586 s, Result = 015e0000, Performance =  42.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017555 s, Result = 01680000, Performance =  44.04 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018506 s, Result = 01720000, Performance =  42.94 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.020245 s, Result = 017c0000, Performance =  40.31 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019904 s, Result = 01860000, Performance =  42.08 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.019949 s, Result = 01900000, Performance =  43.06 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.020858 s, Result = 019a0000, Performance =  42.21 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.021463 s, Result = 01a40000, Performance =  42.02 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.021557 s, Result = 01ae0000, Performance =  42.84 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.022040 s, Result = 01b80000, Performance =  42.87 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.022433 s, Result = 01c20000, Performance =  43.08 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.022821 s, Result = 01cc0000, Performance =  43.29 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.023013 s, Result = 01d60000, Performance =  43.86 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.025592 s, Result = 01e00000, Performance =  40.28 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024293 s, Result = 01ea0000, Performance =  43.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.025260 s, Result = 01f40000, Performance =  42.51 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026297 s, Result = 01fe0000, Performance =  41.65 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.025362 s, Result = 02080000, Performance =  44.03 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.025664 s, Result = 02120000, Performance =  44.35 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.026548 s, Result = 021c0000, Performance =  43.68 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.027160 s, Result = 02260000, Performance =  43.49 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.027269 s, Result = 02300000, Performance =  44.10 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.027698 s, Result = 023a0000, Performance =  44.19 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.029105 s, Result = 02440000, Performance =  42.79 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.029854 s, Result = 024e0000, Performance =  42.44 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028813 s, Result = 02580000, Performance =  44.72 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029818 s, Result = 02620000, Performance =  43.93 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.030242 s, Result = 026c0000, Performance =  44.03 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.030240 s, Result = 02760000, Performance =  44.74 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.032014 s, Result = 02800000, Performance =  42.93 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1807   317  1856
Test passed: M N K =  1977  1932  1280
Test passed: M N K =  1789  1684   640
Test passed: M N K =   596   342   704
Test passed: M N K =  1029  1373   384
M N K =  2048  2048   256, Elapsed time =   0.006833 s, Result = 440e0000, Performance =   3.14 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007250 s, Result = 84180000, Performance =   5.92 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007462 s, Result = c4220000, Performance =   8.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007757 s, Result = 042c0000, Performance =  11.07 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008255 s, Result = 44360000, Performance =  13.01 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008873 s, Result = 84400000, Performance =  14.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009414 s, Result = c44a0000, Performance =  15.97 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010234 s, Result = 04540000, Performance =  16.79 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014575 s, Result = 445e0000, Performance =  13.26 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011519 s, Result = 84680000, Performance =  18.64 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011951 s, Result = c4720000, Performance =  19.77 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012750 s, Result = 047c0000, Performance =  20.21 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013285 s, Result = 44860000, Performance =  21.01 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013496 s, Result = 84900000, Performance =  22.28 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013836 s, Result = c49a0000, Performance =  23.28 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016382 s, Result = 04a40000, Performance =  20.97 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015103 s, Result = 44ae0000, Performance =  24.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015615 s, Result = 84b80000, Performance =  24.76 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016109 s, Result = c4c20000, Performance =  25.33 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017108 s, Result = 04cc0000, Performance =  25.10 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017324 s, Result = 44d60000, Performance =  26.03 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017658 s, Result = 84e00000, Performance =  26.76 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018321 s, Result = c4ea0000, Performance =  26.96 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019239 s, Result = 04f40000, Performance =  26.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.019061 s, Result = 44fe0000, Performance =  28.17 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019519 s, Result = 85080000, Performance =  28.60 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.020217 s, Result = c5120000, Performance =  28.68 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.021279 s, Result = 051c0000, Performance =  28.26 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.020783 s, Result = 45260000, Performance =  29.97 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.021440 s, Result = 85300000, Performance =  30.05 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022690 s, Result = c53a0000, Performance =  29.34 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.027332 s, Result = 05440000, Performance =  25.14 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023460 s, Result = 454e0000, Performance =  30.21 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.023540 s, Result = 85580000, Performance =  31.02 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.023536 s, Result = c5620000, Performance =  31.94 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.023449 s, Result = 056c0000, Performance =  32.97 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.024283 s, Result = 45760000, Performance =  32.72 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.024598 s, Result = 85800000, Performance =  33.17 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025317 s, Result = c58a0000, Performance =  33.08 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.027242 s, Result = 05940000, Performance =  31.53 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.025936 s, Result = 459e0000, Performance =  33.95 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.026461 s, Result = 85a80000, Performance =  34.09 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026746 s, Result = c5b20000, Performance =  34.53 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.027559 s, Result = 05bc0000, Performance =  34.29 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.028535 s, Result = 45c60000, Performance =  33.87 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.029119 s, Result = 85d00000, Performance =  33.92 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.029673 s, Result = c5da0000, Performance =  34.01 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.036305 s, Result = 05e40000, Performance =  28.39 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.030332 s, Result = 45ee0000, Performance =  34.69 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.030828 s, Result = 85f80000, Performance =  34.83 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031070 s, Result = c6020000, Performance =  35.25 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.032081 s, Result = 060c0000, Performance =  34.81 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032464 s, Result = 46160000, Performance =  35.06 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.032672 s, Result = 86200000, Performance =  35.49 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.033324 s, Result = c62a0000, Performance =  35.44 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.035265 s, Result = 06340000, Performance =  34.10 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.033804 s, Result = 463e0000, Performance =  36.21 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.035401 s, Result = 86480000, Performance =  35.18 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.037546 s, Result = c6520000, Performance =  33.75 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035509 s, Result = 065c0000, Performance =  36.29 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.035896 s, Result = 46660000, Performance =  36.49 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.037709 s, Result = 86700000, Performance =  35.31 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.037084 s, Result = c67a0000, Performance =  36.48 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.046761 s, Result = 06840000, Performance =  29.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1603   582   192
Test passed: M N K =  1528    80   384
Test passed: M N K =   700  1578  1856
Test passed: M N K =  2041    71  1024
Test passed: M N K =  2029   712  1088
M N K =  2048  2048   256, Elapsed time =   0.004788 s, Result = 000a0000, Performance =   4.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006067 s, Result = 00140000, Performance =   7.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006060 s, Result = 001e0000, Performance =  10.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006322 s, Result = 00280000, Performance =  13.59 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006895 s, Result = 00320000, Performance =  15.57 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007372 s, Result = 003c0000, Performance =  17.48 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007744 s, Result = 00460000, Performance =  19.41 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008520 s, Result = 00500000, Performance =  20.16 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008886 s, Result = 005a0000, Performance =  21.75 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013469 s, Result = 00640000, Performance =  15.94 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010181 s, Result = 006e0000, Performance =  23.20 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010566 s, Result = 00780000, Performance =  24.39 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011028 s, Result = 00820000, Performance =  25.32 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011645 s, Result = 008c0000, Performance =  25.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011807 s, Result = 00960000, Performance =  27.28 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014798 s, Result = 00a00000, Performance =  23.22 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013620 s, Result = 00aa0000, Performance =  26.80 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013412 s, Result = 00b40000, Performance =  28.82 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014016 s, Result = 00be0000, Performance =  29.11 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014933 s, Result = 00c80000, Performance =  28.76 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014698 s, Result = 00d20000, Performance =  30.68 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015676 s, Result = 00dc0000, Performance =  30.14 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016361 s, Result = 00e60000, Performance =  30.19 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017124 s, Result = 00f00000, Performance =  30.10 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017076 s, Result = 00fa0000, Performance =  31.44 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017323 s, Result = 01040000, Performance =  32.23 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018040 s, Result = 010e0000, Performance =  32.14 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018223 s, Result = 01180000, Performance =  33.00 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019220 s, Result = 01220000, Performance =  32.40 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019707 s, Result = 012c0000, Performance =  32.69 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019989 s, Result = 01360000, Performance =  33.30 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.025093 s, Result = 01400000, Performance =  27.39 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021047 s, Result = 014a0000, Performance =  33.67 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021284 s, Result = 01540000, Performance =  34.31 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021653 s, Result = 015e0000, Performance =  34.71 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.022241 s, Result = 01680000, Performance =  34.76 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.022481 s, Result = 01720000, Performance =  35.34 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022732 s, Result = 017c0000, Performance =  35.90 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023226 s, Result = 01860000, Performance =  36.06 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.025165 s, Result = 01900000, Performance =  34.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.024561 s, Result = 019a0000, Performance =  35.85 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.024937 s, Result = 01a40000, Performance =  36.17 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.025112 s, Result = 01ae0000, Performance =  36.77 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.025724 s, Result = 01b80000, Performance =  36.73 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.026464 s, Result = 01c20000, Performance =  36.52 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.026917 s, Result = 01cc0000, Performance =  36.70 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.027032 s, Result = 01d60000, Performance =  37.34 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.035265 s, Result = 01e00000, Performance =  29.23 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.028689 s, Result = 01ea0000, Performance =  36.68 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.028761 s, Result = 01f40000, Performance =  37.33 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.029278 s, Result = 01fe0000, Performance =  37.41 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.029528 s, Result = 02080000, Performance =  37.82 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.029931 s, Result = 02120000, Performance =  38.03 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.031196 s, Result = 021c0000, Performance =  37.17 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.031100 s, Result = 02260000, Performance =  37.98 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.033576 s, Result = 02300000, Performance =  35.82 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.032245 s, Result = 023a0000, Performance =  37.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.032936 s, Result = 02440000, Performance =  37.82 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.032976 s, Result = 024e0000, Performance =  38.42 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035605 s, Result = 02580000, Performance =  36.19 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.034678 s, Result = 02620000, Performance =  37.78 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035012 s, Result = 026c0000, Performance =  38.03 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.035073 s, Result = 02760000, Performance =  38.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.045282 s, Result = 02800000, Performance =  30.35 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1407   961  1408
Test passed: M N K =  1541  1359  1984
Test passed: M N K =  1635   567   512
Test passed: M N K =  1388   788   704
Test passed: M N K =  2008   108  1024
M N K =  2048  2048   256, Elapsed time =   0.003251 s, Result = 28320000, Performance =   6.60 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004013 s, Result = 283c0000, Performance =  10.70 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004464 s, Result = 28460000, Performance =  14.43 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004710 s, Result = 28500000, Performance =  18.24 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005261 s, Result = 285a0000, Performance =  20.41 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005674 s, Result = 28640000, Performance =  22.71 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006144 s, Result = 286e0000, Performance =  24.47 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006823 s, Result = 28780000, Performance =  25.18 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007317 s, Result = 28820000, Performance =  26.41 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011898 s, Result = 288c0000, Performance =  18.05 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008345 s, Result = 28960000, Performance =  28.31 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009301 s, Result = 28a00000, Performance =  27.71 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009487 s, Result = 28aa0000, Performance =  29.43 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010281 s, Result = 28b40000, Performance =  29.24 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010547 s, Result = 28be0000, Performance =  30.54 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012969 s, Result = 28c80000, Performance =  26.49 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011543 s, Result = 28d20000, Performance =  31.63 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011778 s, Result = 28dc0000, Performance =  32.82 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.011965 s, Result = 28e60000, Performance =  34.10 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012900 s, Result = 28f00000, Performance =  33.30 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013393 s, Result = 28fa0000, Performance =  33.67 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013985 s, Result = 29040000, Performance =  33.78 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014252 s, Result = 290e0000, Performance =  34.66 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.015380 s, Result = 29180000, Performance =  33.51 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015574 s, Result = 29220000, Performance =  34.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015848 s, Result = 292c0000, Performance =  35.23 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016161 s, Result = 29360000, Performance =  35.88 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.016715 s, Result = 29400000, Performance =  35.97 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017334 s, Result = 294a0000, Performance =  35.93 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.017841 s, Result = 29540000, Performance =  36.11 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018242 s, Result = 295e0000, Performance =  36.49 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.023089 s, Result = 29680000, Performance =  29.76 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019312 s, Result = 29720000, Performance =  36.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.019782 s, Result = 297c0000, Performance =  36.91 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.019956 s, Result = 29860000, Performance =  37.66 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.020614 s, Result = 29900000, Performance =  37.50 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021374 s, Result = 299a0000, Performance =  37.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022015 s, Result = 29a40000, Performance =  37.07 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.021839 s, Result = 29ae0000, Performance =  38.35 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.023445 s, Result = 29b80000, Performance =  36.64 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.022559 s, Result = 29c20000, Performance =  39.03 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.023799 s, Result = 29cc0000, Performance =  37.90 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.024513 s, Result = 29d60000, Performance =  37.67 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.025325 s, Result = 29e00000, Performance =  37.31 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.025132 s, Result = 29ea0000, Performance =  38.45 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.025354 s, Result = 29f40000, Performance =  38.96 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.026247 s, Result = 29fe0000, Performance =  38.45 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.033031 s, Result = 2a080000, Performance =  31.21 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.027445 s, Result = 2a120000, Performance =  38.34 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.027048 s, Result = 2a1c0000, Performance =  39.70 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.028250 s, Result = 2a260000, Performance =  38.77 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.028999 s, Result = 2a300000, Performance =  38.51 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.029295 s, Result = 2a3a0000, Performance =  38.85 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.029532 s, Result = 2a440000, Performance =  39.27 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.030499 s, Result = 2a4e0000, Performance =  38.73 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.032133 s, Result = 2a580000, Performance =  37.43 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.031138 s, Result = 2a620000, Performance =  39.31 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.031596 s, Result = 2a6c0000, Performance =  39.42 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.034777 s, Result = 2a760000, Performance =  36.43 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.033116 s, Result = 2a800000, Performance =  38.91 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.032841 s, Result = 2a8a0000, Performance =  39.89 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.033239 s, Result = 2a940000, Performance =  40.06 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.033685 s, Result = 2a9e0000, Performance =  40.16 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.044956 s, Result = 2aa80000, Performance =  30.57 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1196   181  1088
Test passed: M N K =  1389    82    64
Test passed: M N K =  1454   130  1984
Test passed: M N K =  1432  1791   384
Test passed: M N K =  1007   916  2048
M N K =  2048  2048   256, Elapsed time =   0.000480 s, Result = 000a0000, Performance =  44.78 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000950 s, Result = 00140000, Performance =  45.20 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001292 s, Result = 001e0000, Performance =  49.88 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001631 s, Result = 00280000, Performance =  52.67 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002326 s, Result = 00320000, Performance =  46.17 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002705 s, Result = 003c0000, Performance =  47.64 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003249 s, Result = 00460000, Performance =  46.26 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004161 s, Result = 00500000, Performance =  41.28 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004581 s, Result = 005a0000, Performance =  42.19 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007047 s, Result = 00640000, Performance =  30.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005846 s, Result = 006e0000, Performance =  40.40 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.006608 s, Result = 00780000, Performance =  39.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007229 s, Result = 00820000, Performance =  38.62 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007966 s, Result = 008c0000, Performance =  37.74 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008086 s, Result = 00960000, Performance =  39.84 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011033 s, Result = 00a00000, Performance =  31.14 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008184 s, Result = 00aa0000, Performance =  44.61 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009138 s, Result = 00b40000, Performance =  42.30 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.009457 s, Result = 00be0000, Performance =  43.14 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.009597 s, Result = 00c80000, Performance =  44.75 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010152 s, Result = 00d20000, Performance =  44.42 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.010677 s, Result = 00dc0000, Performance =  44.25 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.011178 s, Result = 00e60000, Performance =  44.19 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012569 s, Result = 00f00000, Performance =  41.01 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.011890 s, Result = 00fa0000, Performance =  45.15 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013358 s, Result = 01040000, Performance =  41.80 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.013551 s, Result = 010e0000, Performance =  42.79 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014521 s, Result = 01180000, Performance =  41.41 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014145 s, Result = 01220000, Performance =  44.03 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.014474 s, Result = 012c0000, Performance =  44.51 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015803 s, Result = 01360000, Performance =  42.13 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.021182 s, Result = 01400000, Performance =  32.44 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016530 s, Result = 014a0000, Performance =  42.87 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.016629 s, Result = 01540000, Performance =  43.91 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.016939 s, Result = 015e0000, Performance =  44.37 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017415 s, Result = 01680000, Performance =  44.39 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.017682 s, Result = 01720000, Performance =  44.94 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018495 s, Result = 017c0000, Performance =  44.12 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019497 s, Result = 01860000, Performance =  42.96 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.021659 s, Result = 01900000, Performance =  39.66 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.020025 s, Result = 019a0000, Performance =  43.97 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020828 s, Result = 01a40000, Performance =  43.31 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.021511 s, Result = 01ae0000, Performance =  42.93 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.021657 s, Result = 01b80000, Performance =  43.63 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.022437 s, Result = 01c20000, Performance =  43.07 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.022684 s, Result = 01cc0000, Performance =  43.55 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022971 s, Result = 01d60000, Performance =  43.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.032037 s, Result = 01e00000, Performance =  32.18 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024758 s, Result = 01ea0000, Performance =  42.50 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.024452 s, Result = 01f40000, Performance =  43.91 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.024855 s, Result = 01fe0000, Performance =  44.06 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.025401 s, Result = 02080000, Performance =  43.96 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.025439 s, Result = 02120000, Performance =  44.74 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.026588 s, Result = 021c0000, Performance =  43.61 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.026728 s, Result = 02260000, Performance =  44.19 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.029860 s, Result = 02300000, Performance =  40.27 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.027307 s, Result = 023a0000, Performance =  44.83 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.028556 s, Result = 02440000, Performance =  43.62 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.028229 s, Result = 024e0000, Performance =  44.88 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028580 s, Result = 02580000, Performance =  45.08 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029884 s, Result = 02620000, Performance =  43.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.030521 s, Result = 026c0000, Performance =  43.62 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.030239 s, Result = 02760000, Performance =  44.74 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.040514 s, Result = 02800000, Performance =  33.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1867   188  1984
Test passed: M N K =  1737  2002    64
Test passed: M N K =   139   636   320
Test passed: M N K =  1280  1387  1408
Test passed: M N K =   678  1378   192
M N K =  2048  2048   256, Elapsed time =   0.006567 s, Result = 440e0000, Performance =   3.27 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007386 s, Result = 84180000, Performance =   5.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007356 s, Result = c4220000, Performance =   8.76 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007867 s, Result = 042c0000, Performance =  10.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008262 s, Result = 44360000, Performance =  13.00 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008782 s, Result = 84400000, Performance =  14.67 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009504 s, Result = c44a0000, Performance =  15.82 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010073 s, Result = 04540000, Performance =  17.06 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014766 s, Result = 445e0000, Performance =  13.09 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011602 s, Result = 84680000, Performance =  18.51 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012274 s, Result = c4720000, Performance =  19.25 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012889 s, Result = 047c0000, Performance =  19.99 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013771 s, Result = 44860000, Performance =  20.27 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014258 s, Result = 84900000, Performance =  21.09 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015180 s, Result = c49a0000, Performance =  21.22 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015843 s, Result = 04a40000, Performance =  21.69 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017196 s, Result = 44ae0000, Performance =  21.23 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017789 s, Result = 84b80000, Performance =  21.73 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018413 s, Result = c4c20000, Performance =  22.16 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019277 s, Result = 04cc0000, Performance =  22.28 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019529 s, Result = 44d60000, Performance =  23.09 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020172 s, Result = 84e00000, Performance =  23.42 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021213 s, Result = c4ea0000, Performance =  23.28 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020926 s, Result = 04f40000, Performance =  24.63 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022001 s, Result = 44fe0000, Performance =  24.40 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022086 s, Result = 85080000, Performance =  25.28 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023721 s, Result = c5120000, Performance =  24.44 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023635 s, Result = 051c0000, Performance =  25.44 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.024846 s, Result = 45260000, Performance =  25.07 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025183 s, Result = 85300000, Performance =  25.58 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026178 s, Result = c53a0000, Performance =  25.43 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026634 s, Result = 05440000, Performance =  25.80 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.027776 s, Result = 454e0000, Performance =  25.51 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027099 s, Result = 85580000, Performance =  26.94 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.027526 s, Result = c5620000, Performance =  27.31 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.028108 s, Result = 056c0000, Performance =  27.50 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029094 s, Result = 45760000, Performance =  27.31 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.029511 s, Result = 85800000, Performance =  27.65 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.030459 s, Result = c58a0000, Performance =  27.50 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.029907 s, Result = 05940000, Performance =  28.72 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031299 s, Result = 459e0000, Performance =  28.13 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.032530 s, Result = 85a80000, Performance =  27.73 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032873 s, Result = c5b20000, Performance =  28.09 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.033551 s, Result = 05bc0000, Performance =  28.16 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.034717 s, Result = 45c60000, Performance =  27.84 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.035135 s, Result = 85d00000, Performance =  28.12 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.035998 s, Result = c5da0000, Performance =  28.04 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.036408 s, Result = 05e40000, Performance =  28.31 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.036878 s, Result = 45ee0000, Performance =  28.53 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.037796 s, Result = 85f80000, Performance =  28.41 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.038816 s, Result = c6020000, Performance =  28.22 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.039137 s, Result = 060c0000, Performance =  28.53 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.039677 s, Result = 46160000, Performance =  28.69 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.040691 s, Result = 86200000, Performance =  28.50 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.041786 s, Result = c62a0000, Performance =  28.27 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.040562 s, Result = 06340000, Performance =  29.65 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.042558 s, Result = 463e0000, Performance =  28.76 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.043647 s, Result = 86480000, Performance =  28.54 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.044389 s, Result = c6520000, Performance =  28.54 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.044370 s, Result = 065c0000, Performance =  29.04 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.045155 s, Result = 46660000, Performance =  29.01 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.045253 s, Result = 86700000, Performance =  29.42 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.045987 s, Result = c67a0000, Performance =  29.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.047388 s, Result = 06840000, Performance =  29.00 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1203  1368    64
Test passed: M N K =  1799   814  1984
Test passed: M N K =  1664    80  1344
Test passed: M N K =  1130  1672   320
Test passed: M N K =  1342  1841  1472
M N K =  2048  2048   256, Elapsed time =   0.005184 s, Result = 000a0000, Performance =   4.14 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005794 s, Result = 00140000, Performance =   7.41 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006263 s, Result = 001e0000, Performance =  10.29 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006592 s, Result = 00280000, Performance =  13.03 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006829 s, Result = 00320000, Performance =  15.72 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007300 s, Result = 003c0000, Performance =  17.65 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007956 s, Result = 00460000, Performance =  18.89 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008408 s, Result = 00500000, Performance =  20.43 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008848 s, Result = 005a0000, Performance =  21.84 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013507 s, Result = 00640000, Performance =  15.90 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010533 s, Result = 006e0000, Performance =  22.43 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011554 s, Result = 00780000, Performance =  22.30 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011954 s, Result = 00820000, Performance =  23.35 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012469 s, Result = 008c0000, Performance =  24.11 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013576 s, Result = 00960000, Performance =  23.73 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014723 s, Result = 00a00000, Performance =  23.34 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015778 s, Result = 00aa0000, Performance =  23.14 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015979 s, Result = 00b40000, Performance =  24.19 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016573 s, Result = 00be0000, Performance =  24.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017290 s, Result = 00c80000, Performance =  24.84 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017613 s, Result = 00d20000, Performance =  25.60 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018485 s, Result = 00dc0000, Performance =  25.56 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019245 s, Result = 00e60000, Performance =  25.66 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019313 s, Result = 00f00000, Performance =  26.69 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020572 s, Result = 00fa0000, Performance =  26.10 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020920 s, Result = 01040000, Performance =  26.69 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022086 s, Result = 010e0000, Performance =  26.25 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022173 s, Result = 01180000, Performance =  27.12 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.022916 s, Result = 01220000, Performance =  27.18 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023423 s, Result = 012c0000, Performance =  27.50 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024375 s, Result = 01360000, Performance =  27.31 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.024853 s, Result = 01400000, Performance =  27.65 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025507 s, Result = 014a0000, Performance =  27.78 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.025388 s, Result = 01540000, Performance =  28.76 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.026217 s, Result = 015e0000, Performance =  28.67 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.026826 s, Result = 01680000, Performance =  28.82 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.027647 s, Result = 01720000, Performance =  28.74 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027972 s, Result = 017c0000, Performance =  29.17 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.028757 s, Result = 01860000, Performance =  29.12 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.028600 s, Result = 01900000, Performance =  30.03 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.030506 s, Result = 019a0000, Performance =  28.86 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.030999 s, Result = 01a40000, Performance =  29.10 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032261 s, Result = 01ae0000, Performance =  28.62 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031825 s, Result = 01b80000, Performance =  29.69 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.032933 s, Result = 01c20000, Performance =  29.34 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.033543 s, Result = 01cc0000, Performance =  29.45 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.034293 s, Result = 01d60000, Performance =  29.43 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.034817 s, Result = 01e00000, Performance =  29.61 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.035859 s, Result = 01ea0000, Performance =  29.34 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.036041 s, Result = 01f40000, Performance =  29.79 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.036949 s, Result = 01fe0000, Performance =  29.64 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.037407 s, Result = 02080000, Performance =  29.85 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.038503 s, Result = 02120000, Performance =  29.56 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.039280 s, Result = 021c0000, Performance =  29.52 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.039964 s, Result = 02260000, Performance =  29.55 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.038647 s, Result = 02300000, Performance =  31.12 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.040865 s, Result = 023a0000, Performance =  29.95 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.041560 s, Result = 02440000, Performance =  29.97 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042487 s, Result = 024e0000, Performance =  29.82 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.042714 s, Result = 02580000, Performance =  30.17 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.043467 s, Result = 02620000, Performance =  30.14 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.044105 s, Result = 026c0000, Performance =  30.19 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.044594 s, Result = 02760000, Performance =  30.34 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.045178 s, Result = 02800000, Performance =  30.42 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1646   234  1728
Test passed: M N K =   934   217  1856
Test passed: M N K =  1308  1112  2048
Test passed: M N K =   717  1617   192
Test passed: M N K =  2034  1357   384
M N K =  2048  2048   256, Elapsed time =   0.003302 s, Result = 28320000, Performance =   6.50 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004002 s, Result = 283c0000, Performance =  10.73 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004379 s, Result = 28460000, Performance =  14.71 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004866 s, Result = 28500000, Performance =  17.65 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005140 s, Result = 285a0000, Performance =  20.89 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005473 s, Result = 28640000, Performance =  23.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006164 s, Result = 286e0000, Performance =  24.39 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006845 s, Result = 28780000, Performance =  25.10 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007213 s, Result = 28820000, Performance =  26.79 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012293 s, Result = 288c0000, Performance =  17.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008983 s, Result = 28960000, Performance =  26.30 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009589 s, Result = 28a00000, Performance =  26.87 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010244 s, Result = 28aa0000, Performance =  27.25 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010948 s, Result = 28b40000, Performance =  27.46 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011654 s, Result = 28be0000, Performance =  27.64 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012693 s, Result = 28c80000, Performance =  27.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013310 s, Result = 28d20000, Performance =  27.43 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014227 s, Result = 28dc0000, Performance =  27.17 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015008 s, Result = 28e60000, Performance =  27.19 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015987 s, Result = 28f00000, Performance =  26.87 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015784 s, Result = 28fa0000, Performance =  28.57 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016630 s, Result = 29040000, Performance =  28.41 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016873 s, Result = 290e0000, Performance =  29.27 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017369 s, Result = 29180000, Performance =  29.67 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018707 s, Result = 29220000, Performance =  28.70 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019150 s, Result = 292c0000, Performance =  29.16 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019917 s, Result = 29360000, Performance =  29.11 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020808 s, Result = 29400000, Performance =  28.90 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021619 s, Result = 294a0000, Performance =  28.81 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.021591 s, Result = 29540000, Performance =  29.84 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022444 s, Result = 295e0000, Performance =  29.66 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.023331 s, Result = 29680000, Performance =  29.45 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023945 s, Result = 29720000, Performance =  29.60 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024179 s, Result = 297c0000, Performance =  30.20 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024751 s, Result = 29860000, Performance =  30.37 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025324 s, Result = 29900000, Performance =  30.53 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025831 s, Result = 299a0000, Performance =  30.76 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026948 s, Result = 29a40000, Performance =  30.28 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.027464 s, Result = 29ae0000, Performance =  30.50 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.027278 s, Result = 29b80000, Performance =  31.49 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028549 s, Result = 29c20000, Performance =  30.84 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029943 s, Result = 29cc0000, Performance =  30.12 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.030451 s, Result = 29d60000, Performance =  30.32 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030763 s, Result = 29e00000, Performance =  30.71 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.030721 s, Result = 29ea0000, Performance =  31.46 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.032058 s, Result = 29f40000, Performance =  30.81 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032500 s, Result = 29fe0000, Performance =  31.06 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.033307 s, Result = 2a080000, Performance =  30.95 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.033949 s, Result = 2a120000, Performance =  31.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.036528 s, Result = 2a1c0000, Performance =  29.39 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035351 s, Result = 2a260000, Performance =  30.98 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035731 s, Result = 2a300000, Performance =  31.25 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.037035 s, Result = 2a3a0000, Performance =  30.73 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.037127 s, Result = 2a440000, Performance =  31.23 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.038241 s, Result = 2a4e0000, Performance =  30.89 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.037274 s, Result = 2a580000, Performance =  32.26 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.039369 s, Result = 2a620000, Performance =  31.09 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.040334 s, Result = 2a6c0000, Performance =  30.88 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.040630 s, Result = 2a760000, Performance =  31.18 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041257 s, Result = 2a800000, Performance =  31.23 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041654 s, Result = 2a8a0000, Performance =  31.45 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042533 s, Result = 2a940000, Performance =  31.30 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042855 s, Result = 2a9e0000, Performance =  31.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.043324 s, Result = 2aa80000, Performance =  31.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   483    67   256
Test passed: M N K =   332  1808   512
Test passed: M N K =   270  1236  1408
Test passed: M N K =    44  1725   576
Test passed: M N K =   199    47  1216
M N K =  2048  2048   256, Elapsed time =   0.000448 s, Result = 000a0000, Performance =  47.89 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000884 s, Result = 00140000, Performance =  48.56 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001424 s, Result = 001e0000, Performance =  45.23 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001957 s, Result = 00280000, Performance =  43.90 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002342 s, Result = 00320000, Performance =  45.85 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002989 s, Result = 003c0000, Performance =  43.10 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003498 s, Result = 00460000, Performance =  42.98 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005355 s, Result = 00500000, Performance =  32.08 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004789 s, Result = 005a0000, Performance =  40.36 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005681 s, Result = 00640000, Performance =  37.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006516 s, Result = 006e0000, Performance =  36.25 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007495 s, Result = 00780000, Performance =  34.38 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007975 s, Result = 00820000, Performance =  35.01 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.008875 s, Result = 008c0000, Performance =  33.88 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009911 s, Result = 00960000, Performance =  32.50 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010639 s, Result = 00a00000, Performance =  32.30 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010838 s, Result = 00aa0000, Performance =  33.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011519 s, Result = 00b40000, Performance =  33.56 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012705 s, Result = 00be0000, Performance =  32.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013241 s, Result = 00c80000, Performance =  32.44 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013615 s, Result = 00d20000, Performance =  33.12 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014230 s, Result = 00dc0000, Performance =  33.20 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014953 s, Result = 00e60000, Performance =  33.03 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014988 s, Result = 00f00000, Performance =  34.39 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.016141 s, Result = 00fa0000, Performance =  33.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017014 s, Result = 01040000, Performance =  32.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017756 s, Result = 010e0000, Performance =  32.65 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018249 s, Result = 01180000, Performance =  32.95 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018542 s, Result = 01220000, Performance =  33.59 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018858 s, Result = 012c0000, Performance =  34.16 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019945 s, Result = 01360000, Performance =  33.38 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.020095 s, Result = 01400000, Performance =  34.20 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021145 s, Result = 014a0000, Performance =  33.52 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021441 s, Result = 01540000, Performance =  34.05 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.022764 s, Result = 015e0000, Performance =  33.02 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.023337 s, Result = 01680000, Performance =  33.13 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.023666 s, Result = 01720000, Performance =  33.57 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.024627 s, Result = 017c0000, Performance =  33.14 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025760 s, Result = 01860000, Performance =  32.51 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.025012 s, Result = 01900000, Performance =  34.34 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.026569 s, Result = 019a0000, Performance =  33.14 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.027052 s, Result = 01a40000, Performance =  33.34 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.028012 s, Result = 01ae0000, Performance =  32.97 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.028093 s, Result = 01b80000, Performance =  33.63 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.028655 s, Result = 01c20000, Performance =  33.72 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.029586 s, Result = 01cc0000, Performance =  33.39 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.030117 s, Result = 01d60000, Performance =  33.51 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.031262 s, Result = 01e00000, Performance =  32.97 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.031583 s, Result = 01ea0000, Performance =  33.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.031887 s, Result = 01f40000, Performance =  33.67 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.032923 s, Result = 01fe0000, Performance =  33.27 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.033205 s, Result = 02080000, Performance =  33.63 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.033956 s, Result = 02120000, Performance =  33.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.034828 s, Result = 021c0000, Performance =  33.30 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.035948 s, Result = 02260000, Performance =  32.86 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.034827 s, Result = 02300000, Performance =  34.53 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.036562 s, Result = 023a0000, Performance =  33.48 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.037268 s, Result = 02440000, Performance =  33.42 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.038151 s, Result = 024e0000, Performance =  33.21 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.037849 s, Result = 02580000, Performance =  34.04 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.039058 s, Result = 02620000, Performance =  33.54 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.039556 s, Result = 026c0000, Performance =  33.66 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.040042 s, Result = 02760000, Performance =  33.79 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.040804 s, Result = 02800000, Performance =  33.68 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   883  1515  1024
Test passed: M N K =  1190  1364  1088
Test passed: M N K =  1330  1644   832
Test passed: M N K =  1375    19  1280
Test passed: M N K =   198   679   384
M N K =  2048  2048   256, Elapsed time =   0.004983 s, Result = 640b8000, Performance =   4.31 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006400 s, Result = c4130000, Performance =   6.71 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006324 s, Result = 241a8000, Performance =  10.19 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006816 s, Result = 84220000, Performance =  12.60 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007107 s, Result = e4298000, Performance =  15.11 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007804 s, Result = 44310000, Performance =  16.51 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008247 s, Result = a4388000, Performance =  18.23 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008423 s, Result = 04400000, Performance =  20.40 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014332 s, Result = 64478000, Performance =  13.49 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009421 s, Result = c44f0000, Performance =  22.79 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009820 s, Result = 24568000, Performance =  24.06 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010638 s, Result = 845e0000, Performance =  24.22 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010854 s, Result = e4658000, Performance =  25.72 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011551 s, Result = 446d0000, Performance =  26.03 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012160 s, Result = a4748000, Performance =  26.49 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012347 s, Result = 047c0000, Performance =  27.83 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013726 s, Result = 64838000, Performance =  26.60 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013101 s, Result = c48b0000, Performance =  29.51 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013709 s, Result = 24928000, Performance =  29.76 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014687 s, Result = 849a0000, Performance =  29.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015177 s, Result = e4a18000, Performance =  29.71 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015047 s, Result = 44a90000, Performance =  31.40 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016068 s, Result = a4b08000, Performance =  30.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016883 s, Result = 04b80000, Performance =  30.53 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015899 s, Result = 64bf8000, Performance =  33.77 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017068 s, Result = c4c70000, Performance =  32.71 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016924 s, Result = 24ce8000, Performance =  34.26 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017618 s, Result = 84d60000, Performance =  34.13 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017567 s, Result = e4dd8000, Performance =  35.45 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019150 s, Result = 44e50000, Performance =  33.64 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019197 s, Result = a4ec8000, Performance =  34.68 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.020516 s, Result = 04f40000, Performance =  33.50 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019525 s, Result = 64fb8000, Performance =  36.30 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020142 s, Result = c5030000, Performance =  36.25 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.019733 s, Result = 250a8000, Performance =  38.09 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.020648 s, Result = 85120000, Performance =  37.44 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.020660 s, Result = e5198000, Performance =  38.46 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.021416 s, Result = 45210000, Performance =  38.10 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.021521 s, Result = a5288000, Performance =  38.92 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022984 s, Result = 05300000, Performance =  37.37 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.022079 s, Result = 65378000, Performance =  39.88 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.023140 s, Result = c53f0000, Performance =  38.98 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.023732 s, Result = 25468000, Performance =  38.91 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.023683 s, Result = 854e0000, Performance =  39.90 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.024260 s, Result = e5558000, Performance =  39.83 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.024197 s, Result = 455d0000, Performance =  40.83 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.025576 s, Result = a5648000, Performance =  39.46 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.025845 s, Result = 056c0000, Performance =  39.88 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.026386 s, Result = 65738000, Performance =  39.88 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.026031 s, Result = c57b0000, Performance =  41.25 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026365 s, Result = 25828000, Performance =  41.54 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026581 s, Result = 858a0000, Performance =  42.01 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.028241 s, Result = e5918000, Performance =  40.30 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.028022 s, Result = 45990000, Performance =  41.38 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.029461 s, Result = a5a08000, Performance =  40.09 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.028577 s, Result = 05a80000, Performance =  42.08 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.029232 s, Result = 65af8000, Performance =  41.87 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.030051 s, Result = c5b70000, Performance =  41.45 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.030570 s, Result = 25be8000, Performance =  41.45 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.030212 s, Result = 85c60000, Performance =  42.65 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.031740 s, Result = e5cd8000, Performance =  41.27 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.030965 s, Result = 45d50000, Performance =  43.00 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.031839 s, Result = a5dc8000, Performance =  42.49 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034881 s, Result = 05e40000, Performance =  39.40 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    45   117  1408
Test passed: M N K =   344  1855   320
Test passed: M N K =  1467   815  1152
Test passed: M N K =  1514   889  1152
Test passed: M N K =  1549  1260   576
M N K =  2048  2048   256, Elapsed time =   0.003405 s, Result = 00078000, Performance =   6.31 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004322 s, Result = 000f0000, Performance =   9.94 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004317 s, Result = 00168000, Performance =  14.92 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004546 s, Result = 001e0000, Performance =  18.90 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004875 s, Result = 00258000, Performance =  22.03 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005421 s, Result = 002d0000, Performance =  23.77 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005657 s, Result = 00348000, Performance =  26.57 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006629 s, Result = 003c0000, Performance =  25.92 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006220 s, Result = 00438000, Performance =  31.07 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006953 s, Result = 004b0000, Performance =  30.88 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007807 s, Result = 00528000, Performance =  30.26 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008211 s, Result = 005a0000, Performance =  31.39 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008777 s, Result = 00618000, Performance =  31.81 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009259 s, Result = 00690000, Performance =  32.47 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009748 s, Result = 00708000, Performance =  33.04 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.009438 s, Result = 00780000, Performance =  36.41 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010281 s, Result = 007f8000, Performance =  35.51 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010210 s, Result = 00870000, Performance =  37.86 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010739 s, Result = 008e8000, Performance =  38.00 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010815 s, Result = 00960000, Performance =  39.71 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011753 s, Result = 009d8000, Performance =  38.37 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.012148 s, Result = 00a50000, Performance =  38.89 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012923 s, Result = 00ac8000, Performance =  38.22 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014081 s, Result = 00b40000, Performance =  36.60 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.013660 s, Result = 00bb8000, Performance =  39.30 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.014269 s, Result = 00c30000, Performance =  39.13 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014560 s, Result = 00ca8000, Performance =  39.82 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.015393 s, Result = 00d20000, Performance =  39.06 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015397 s, Result = 00d98000, Performance =  40.45 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016000 s, Result = 00e10000, Performance =  40.27 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016177 s, Result = 00e88000, Performance =  41.15 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016607 s, Result = 00f00000, Performance =  41.38 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017387 s, Result = 00f78000, Performance =  40.76 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017647 s, Result = 00ff0000, Performance =  41.38 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017572 s, Result = 01068000, Performance =  42.77 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017942 s, Result = 010e0000, Performance =  43.09 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018229 s, Result = 01158000, Performance =  43.59 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.019076 s, Result = 011d0000, Performance =  42.78 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019085 s, Result = 01248000, Performance =  43.88 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.020197 s, Result = 012c0000, Performance =  42.53 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019817 s, Result = 01338000, Performance =  44.43 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020211 s, Result = 013b0000, Performance =  44.63 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.021372 s, Result = 01428000, Performance =  43.21 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.021634 s, Result = 014a0000, Performance =  43.68 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021521 s, Result = 01518000, Performance =  44.90 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.022322 s, Result = 01590000, Performance =  44.26 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022663 s, Result = 01608000, Performance =  44.54 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.023965 s, Result = 01680000, Performance =  43.01 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024396 s, Result = 016f8000, Performance =  43.13 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023729 s, Result = 01770000, Performance =  45.25 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.024644 s, Result = 017e8000, Performance =  44.44 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.025241 s, Result = 01860000, Performance =  44.24 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.025748 s, Result = 018d8000, Performance =  44.20 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025947 s, Result = 01950000, Performance =  44.69 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025903 s, Result = 019c8000, Performance =  45.60 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.027644 s, Result = 01a40000, Performance =  43.50 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026944 s, Result = 01ab8000, Performance =  45.43 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.027331 s, Result = 01b30000, Performance =  45.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.029785 s, Result = 01ba8000, Performance =  42.54 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028273 s, Result = 01c20000, Performance =  45.57 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.028468 s, Result = 01c98000, Performance =  46.02 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.029231 s, Result = 01d10000, Performance =  45.55 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.030159 s, Result = 01d88000, Performance =  44.86 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.030930 s, Result = 01e00000, Performance =  44.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1100   137  1728
Test passed: M N K =    72   702  1600
Test passed: M N K =   221  1982  1920
Test passed: M N K =  1863  1989   256
Test passed: M N K =    76  1994  1664
M N K =  2048  2048   256, Elapsed time =   0.002868 s, Result = 282f8000, Performance =   7.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003671 s, Result = 28370000, Performance =  11.70 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004117 s, Result = 283e8000, Performance =  15.65 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004441 s, Result = 28460000, Performance =  19.34 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004849 s, Result = 284d8000, Performance =  22.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005274 s, Result = 28550000, Performance =  24.43 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005643 s, Result = 285c8000, Performance =  26.64 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006210 s, Result = 28640000, Performance =  27.67 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006424 s, Result = 286b8000, Performance =  30.09 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009339 s, Result = 28730000, Performance =  22.99 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007199 s, Result = 287a8000, Performance =  32.81 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008049 s, Result = 28820000, Performance =  32.02 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008252 s, Result = 28898000, Performance =  33.83 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009008 s, Result = 28910000, Performance =  33.38 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009567 s, Result = 28988000, Performance =  33.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.009845 s, Result = 28a00000, Performance =  34.90 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009401 s, Result = 28a78000, Performance =  38.83 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010026 s, Result = 28af0000, Performance =  38.55 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.011412 s, Result = 28b68000, Performance =  35.75 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010783 s, Result = 28be0000, Performance =  39.83 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010768 s, Result = 28c58000, Performance =  41.88 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.012002 s, Result = 28cd0000, Performance =  39.36 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012450 s, Result = 28d48000, Performance =  39.67 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012453 s, Result = 28dc0000, Performance =  41.39 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012747 s, Result = 28e38000, Performance =  42.12 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013943 s, Result = 28eb0000, Performance =  40.04 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014097 s, Result = 28f28000, Performance =  41.13 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014053 s, Result = 28fa0000, Performance =  42.79 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015005 s, Result = 29018000, Performance =  41.50 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015657 s, Result = 29090000, Performance =  41.15 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016227 s, Result = 29108000, Performance =  41.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016552 s, Result = 29180000, Performance =  41.52 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016992 s, Result = 291f8000, Performance =  41.71 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017070 s, Result = 29270000, Performance =  42.77 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017294 s, Result = 292e8000, Performance =  43.46 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017499 s, Result = 29360000, Performance =  44.18 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018460 s, Result = 293d8000, Performance =  43.04 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018030 s, Result = 29450000, Performance =  45.26 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019100 s, Result = 294c8000, Performance =  43.85 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.019768 s, Result = 29540000, Performance =  43.45 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.020204 s, Result = 295b8000, Performance =  43.58 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020546 s, Result = 29630000, Performance =  43.90 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.021286 s, Result = 296a8000, Performance =  43.38 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.021297 s, Result = 29720000, Performance =  44.37 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021818 s, Result = 29798000, Performance =  44.29 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.021896 s, Result = 29810000, Performance =  45.11 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022451 s, Result = 29888000, Performance =  44.96 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.024483 s, Result = 29900000, Performance =  42.10 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.023007 s, Result = 29978000, Performance =  45.74 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.024370 s, Result = 299f0000, Performance =  44.06 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.024997 s, Result = 29a68000, Performance =  43.81 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.024157 s, Result = 29ae0000, Performance =  46.23 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.025467 s, Result = 29b58000, Performance =  44.69 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025632 s, Result = 29bd0000, Performance =  45.24 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.026100 s, Result = 29c48000, Performance =  45.25 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.027155 s, Result = 29cc0000, Performance =  44.29 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.027185 s, Result = 29d38000, Performance =  45.03 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.027454 s, Result = 29db0000, Performance =  45.37 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.028165 s, Result = 29e28000, Performance =  44.99 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028021 s, Result = 29ea0000, Performance =  45.98 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029557 s, Result = 29f18000, Performance =  44.32 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.028452 s, Result = 29f90000, Performance =  46.80 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.028736 s, Result = 2a008000, Performance =  47.08 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.031412 s, Result = 2a080000, Performance =  43.75 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1005   246  1472
Test passed: M N K =  1976   697   256
Test passed: M N K =   408   785   576
Test passed: M N K =   107  1156  1728
Test passed: M N K =  1549   425  1536
M N K =  2048  2048   256, Elapsed time =   0.000437 s, Result = 00078000, Performance =  49.10 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000803 s, Result = 000f0000, Performance =  53.46 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001167 s, Result = 00168000, Performance =  55.20 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001433 s, Result = 001e0000, Performance =  59.95 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001873 s, Result = 00258000, Performance =  57.34 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002258 s, Result = 002d0000, Performance =  57.06 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002695 s, Result = 00348000, Performance =  55.78 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003139 s, Result = 003c0000, Performance =  54.73 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003431 s, Result = 00438000, Performance =  56.33 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005484 s, Result = 004b0000, Performance =  39.16 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.004215 s, Result = 00528000, Performance =  56.05 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.004979 s, Result = 005a0000, Performance =  51.75 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.005754 s, Result = 00618000, Performance =  48.52 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.006530 s, Result = 00690000, Performance =  46.04 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.006922 s, Result = 00708000, Performance =  46.54 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.006396 s, Result = 00780000, Performance =  53.72 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.006505 s, Result = 007f8000, Performance =  56.12 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.007013 s, Result = 00870000, Performance =  55.12 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.007293 s, Result = 008e8000, Performance =  55.95 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.007758 s, Result = 00960000, Performance =  55.36 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.008394 s, Result = 009d8000, Performance =  53.72 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.008543 s, Result = 00a50000, Performance =  55.30 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.008834 s, Result = 00ac8000, Performance =  55.91 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.010586 s, Result = 00b40000, Performance =  48.69 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.010453 s, Result = 00bb8000, Performance =  51.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.011108 s, Result = 00c30000, Performance =  50.27 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.011438 s, Result = 00ca8000, Performance =  50.69 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.011886 s, Result = 00d20000, Performance =  50.59 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.012268 s, Result = 00d98000, Performance =  50.77 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012395 s, Result = 00e10000, Performance =  51.98 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.013099 s, Result = 00e88000, Performance =  50.82 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.012752 s, Result = 00f00000, Performance =  53.89 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.013505 s, Result = 00f78000, Performance =  52.47 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.013658 s, Result = 00ff0000, Performance =  53.46 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.014979 s, Result = 01068000, Performance =  50.18 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.014303 s, Result = 010e0000, Performance =  54.05 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.015627 s, Result = 01158000, Performance =  50.84 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.015875 s, Result = 011d0000, Performance =  51.40 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.017173 s, Result = 01248000, Performance =  48.77 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.017140 s, Result = 012c0000, Performance =  50.12 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.017106 s, Result = 01338000, Performance =  51.47 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017873 s, Result = 013b0000, Performance =  50.46 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.017935 s, Result = 01428000, Performance =  51.49 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.018615 s, Result = 014a0000, Performance =  50.76 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.018083 s, Result = 01518000, Performance =  53.44 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.019574 s, Result = 01590000, Performance =  50.47 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.020184 s, Result = 01608000, Performance =  50.01 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.021190 s, Result = 01680000, Performance =  48.64 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020968 s, Result = 016f8000, Performance =  50.18 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.021610 s, Result = 01770000, Performance =  49.69 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.020701 s, Result = 017e8000, Performance =  52.91 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.021654 s, Result = 01860000, Performance =  51.57 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.022644 s, Result = 018d8000, Performance =  50.26 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022857 s, Result = 01950000, Performance =  50.74 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.023599 s, Result = 019c8000, Performance =  50.05 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.024674 s, Result = 01a40000, Performance =  48.74 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023034 s, Result = 01ab8000, Performance =  53.14 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.024518 s, Result = 01b30000, Performance =  50.80 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.024382 s, Result = 01ba8000, Performance =  51.97 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024211 s, Result = 01c20000, Performance =  53.22 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.024442 s, Result = 01c98000, Performance =  53.60 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.025125 s, Result = 01d10000, Performance =  52.99 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.025663 s, Result = 01d88000, Performance =  52.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.027616 s, Result = 01e00000, Performance =  49.77 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   876  1902   384
Test passed: M N K =   279   788  1984
Test passed: M N K =  1693   690  1152
Test passed: M N K =   947  1025   256
Test passed: M N K =  1399  1030   512
M N K =  2048  2048   256, Elapsed time =   0.005815 s, Result = 640b8000, Performance =   3.69 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006213 s, Result = c4130000, Performance =   6.91 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006194 s, Result = 241a8000, Performance =  10.40 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006652 s, Result = 84220000, Performance =  12.91 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007395 s, Result = e4298000, Performance =  14.52 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007975 s, Result = 44310000, Performance =  16.16 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008582 s, Result = a4388000, Performance =  17.52 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009090 s, Result = 04400000, Performance =  18.90 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011487 s, Result = 64478000, Performance =  16.83 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010107 s, Result = c44f0000, Performance =  21.25 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010512 s, Result = 24568000, Performance =  22.47 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010772 s, Result = 845e0000, Performance =  23.92 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011312 s, Result = e4658000, Performance =  24.68 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012106 s, Result = 446d0000, Performance =  24.83 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012656 s, Result = a4748000, Performance =  25.45 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013153 s, Result = 047c0000, Performance =  26.12 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013950 s, Result = 64838000, Performance =  26.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015520 s, Result = c48b0000, Performance =  24.91 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014500 s, Result = 24928000, Performance =  28.14 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014732 s, Result = 849a0000, Performance =  29.15 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015704 s, Result = e4a18000, Performance =  28.72 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014561 s, Result = 44a90000, Performance =  32.45 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.015707 s, Result = a4b08000, Performance =  31.45 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016264 s, Result = 04b80000, Performance =  31.69 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.016633 s, Result = 64bf8000, Performance =  32.28 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016476 s, Result = c4c70000, Performance =  33.89 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017463 s, Result = 24ce8000, Performance =  33.20 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017422 s, Result = 84d60000, Performance =  34.51 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018226 s, Result = e4dd8000, Performance =  34.17 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018879 s, Result = 44e50000, Performance =  34.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018593 s, Result = a4ec8000, Performance =  35.80 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.021410 s, Result = 04f40000, Performance =  32.10 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019501 s, Result = 64fb8000, Performance =  36.34 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.019801 s, Result = c5030000, Performance =  36.87 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.019744 s, Result = 250a8000, Performance =  38.07 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.019865 s, Result = 85120000, Performance =  38.92 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.020705 s, Result = e5198000, Performance =  38.38 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.020927 s, Result = 45210000, Performance =  39.00 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.021324 s, Result = a5288000, Performance =  39.28 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.023297 s, Result = 05300000, Performance =  36.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.022303 s, Result = 65378000, Performance =  39.48 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.022564 s, Result = c53f0000, Performance =  39.97 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.022564 s, Result = 25468000, Performance =  40.92 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.023167 s, Result = 854e0000, Performance =  40.79 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.024115 s, Result = e5558000, Performance =  40.07 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.024148 s, Result = 455d0000, Performance =  40.91 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.024930 s, Result = a5648000, Performance =  40.49 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028825 s, Result = 056c0000, Performance =  35.76 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024938 s, Result = 65738000, Performance =  42.19 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.025959 s, Result = c57b0000, Performance =  41.36 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026666 s, Result = 25828000, Performance =  41.07 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026342 s, Result = 858a0000, Performance =  42.39 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.027245 s, Result = e5918000, Performance =  41.78 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.027656 s, Result = 45990000, Performance =  41.93 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.027577 s, Result = a5a08000, Performance =  42.83 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.030636 s, Result = 05a80000, Performance =  39.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.028269 s, Result = 65af8000, Performance =  43.30 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.029265 s, Result = c5b70000, Performance =  42.56 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.030357 s, Result = 25be8000, Performance =  41.74 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.029579 s, Result = 85c60000, Performance =  43.56 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.030676 s, Result = e5cd8000, Performance =  42.70 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.031164 s, Result = 45d50000, Performance =  42.72 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.030813 s, Result = a5dc8000, Performance =  43.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.036877 s, Result = 05e40000, Performance =  37.27 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   118  1882  1600
Test passed: M N K =  1600   154  2048
Test passed: M N K =  1674  1038   576
Test passed: M N K =   855   241   192
Test passed: M N K =  1637  1105   832
M N K =  2048  2048   256, Elapsed time =   0.003395 s, Result = 00078000, Performance =   6.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004548 s, Result = 000f0000, Performance =   9.44 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004420 s, Result = 00168000, Performance =  14.58 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004708 s, Result = 001e0000, Performance =  18.25 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005106 s, Result = 00258000, Performance =  21.03 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005491 s, Result = 002d0000, Performance =  23.47 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006223 s, Result = 00348000, Performance =  24.16 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006779 s, Result = 003c0000, Performance =  25.34 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007316 s, Result = 00438000, Performance =  26.42 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010790 s, Result = 004b0000, Performance =  19.90 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008390 s, Result = 00528000, Performance =  28.16 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008948 s, Result = 005a0000, Performance =  28.80 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009343 s, Result = 00618000, Performance =  29.88 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010189 s, Result = 00690000, Performance =  29.51 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010051 s, Result = 00708000, Performance =  32.05 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012376 s, Result = 00780000, Performance =  27.76 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010863 s, Result = 007f8000, Performance =  33.61 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011196 s, Result = 00870000, Performance =  34.52 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.011210 s, Result = 008e8000, Performance =  36.40 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011861 s, Result = 00960000, Performance =  36.21 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012545 s, Result = 009d8000, Performance =  35.95 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013111 s, Result = 00a50000, Performance =  36.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012782 s, Result = 00ac8000, Performance =  38.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014362 s, Result = 00b40000, Performance =  35.89 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.013761 s, Result = 00bb8000, Performance =  39.01 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.014316 s, Result = 00c30000, Performance =  39.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014521 s, Result = 00ca8000, Performance =  39.93 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.015727 s, Result = 00d20000, Performance =  38.23 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015370 s, Result = 00d98000, Performance =  40.52 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016430 s, Result = 00e10000, Performance =  39.21 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016428 s, Result = 00e88000, Performance =  40.52 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.019579 s, Result = 00f00000, Performance =  35.10 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017325 s, Result = 00f78000, Performance =  40.90 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017393 s, Result = 00ff0000, Performance =  41.98 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017905 s, Result = 01068000, Performance =  41.98 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017575 s, Result = 010e0000, Performance =  43.99 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018161 s, Result = 01158000, Performance =  43.75 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018939 s, Result = 011d0000, Performance =  43.09 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019380 s, Result = 01248000, Performance =  43.22 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.021164 s, Result = 012c0000, Performance =  40.59 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019917 s, Result = 01338000, Performance =  44.21 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020592 s, Result = 013b0000, Performance =  43.80 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.020867 s, Result = 01428000, Performance =  44.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.021069 s, Result = 014a0000, Performance =  44.85 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021653 s, Result = 01518000, Performance =  44.63 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.022130 s, Result = 01590000, Performance =  44.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022445 s, Result = 01608000, Performance =  44.97 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.027150 s, Result = 01680000, Performance =  37.97 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.022948 s, Result = 016f8000, Performance =  45.85 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023854 s, Result = 01770000, Performance =  45.01 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.025709 s, Result = 017e8000, Performance =  42.60 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.024386 s, Result = 01860000, Performance =  45.79 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.024783 s, Result = 018d8000, Performance =  45.92 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025530 s, Result = 01950000, Performance =  45.42 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025706 s, Result = 019c8000, Performance =  45.95 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.028731 s, Result = 01a40000, Performance =  41.86 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026532 s, Result = 01ab8000, Performance =  46.14 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.027340 s, Result = 01b30000, Performance =  45.56 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.027730 s, Result = 01ba8000, Performance =  45.69 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028001 s, Result = 01c20000, Performance =  46.02 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029352 s, Result = 01c98000, Performance =  44.63 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.029490 s, Result = 01d10000, Performance =  45.15 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.028961 s, Result = 01d88000, Performance =  46.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034910 s, Result = 01e00000, Performance =  39.37 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1931  1485   320
Test passed: M N K =   762   804   128
Test passed: M N K =   467   453  1216
Test passed: M N K =  1984    45   256
Test passed: M N K =  1015  1469  1984
M N K =  2048  2048   256, Elapsed time =   0.003200 s, Result = 282f8000, Performance =   6.71 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003657 s, Result = 28370000, Performance =  11.75 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004172 s, Result = 283e8000, Performance =  15.44 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004490 s, Result = 28460000, Performance =  19.13 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004960 s, Result = 284d8000, Performance =  21.65 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005323 s, Result = 28550000, Performance =  24.21 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005823 s, Result = 285c8000, Performance =  25.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006528 s, Result = 28640000, Performance =  26.32 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006833 s, Result = 286b8000, Performance =  28.29 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010271 s, Result = 28730000, Performance =  20.91 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007724 s, Result = 287a8000, Performance =  30.58 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008348 s, Result = 28820000, Performance =  30.87 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008760 s, Result = 28898000, Performance =  31.87 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009506 s, Result = 28910000, Performance =  31.63 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009441 s, Result = 28988000, Performance =  34.12 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010757 s, Result = 28a00000, Performance =  31.94 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009946 s, Result = 28a78000, Performance =  36.71 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010770 s, Result = 28af0000, Performance =  35.89 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010746 s, Result = 28b68000, Performance =  37.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011091 s, Result = 28be0000, Performance =  38.73 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011441 s, Result = 28c58000, Performance =  39.42 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011854 s, Result = 28cd0000, Performance =  39.86 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012312 s, Result = 28d48000, Performance =  40.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.013622 s, Result = 28dc0000, Performance =  37.83 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012945 s, Result = 28e38000, Performance =  41.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013851 s, Result = 28eb0000, Performance =  40.31 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.013937 s, Result = 28f28000, Performance =  41.60 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014488 s, Result = 28fa0000, Performance =  41.50 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015006 s, Result = 29018000, Performance =  41.50 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015564 s, Result = 29090000, Performance =  41.39 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015584 s, Result = 29108000, Performance =  42.72 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018796 s, Result = 29180000, Performance =  36.56 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016635 s, Result = 291f8000, Performance =  42.60 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017026 s, Result = 29270000, Performance =  42.88 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017625 s, Result = 292e8000, Performance =  42.64 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017763 s, Result = 29360000, Performance =  43.52 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.017985 s, Result = 293d8000, Performance =  44.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018695 s, Result = 29450000, Performance =  43.65 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.018575 s, Result = 294c8000, Performance =  45.09 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.021262 s, Result = 29540000, Performance =  40.40 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019557 s, Result = 295b8000, Performance =  45.02 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020430 s, Result = 29630000, Performance =  44.15 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.020493 s, Result = 296a8000, Performance =  45.06 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.020757 s, Result = 29720000, Performance =  45.52 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021376 s, Result = 29798000, Performance =  45.21 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.021761 s, Result = 29810000, Performance =  45.40 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022409 s, Result = 29888000, Performance =  45.04 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.027224 s, Result = 29900000, Performance =  37.86 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.022668 s, Result = 29978000, Performance =  46.42 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023574 s, Result = 299f0000, Performance =  45.55 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.023875 s, Result = 29a68000, Performance =  45.87 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.023901 s, Result = 29ae0000, Performance =  46.72 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.024569 s, Result = 29b58000, Performance =  46.33 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025636 s, Result = 29bd0000, Performance =  45.24 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025785 s, Result = 29c48000, Performance =  45.81 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.028669 s, Result = 29cc0000, Performance =  41.95 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026807 s, Result = 29d38000, Performance =  45.66 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.026867 s, Result = 29db0000, Performance =  46.36 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.027044 s, Result = 29e28000, Performance =  46.85 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.027672 s, Result = 29ea0000, Performance =  46.56 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029458 s, Result = 29f18000, Performance =  44.47 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.029016 s, Result = 29f90000, Performance =  45.89 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.029311 s, Result = 2a008000, Performance =  46.16 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034832 s, Result = 2a080000, Performance =  39.46 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1028   897   704
Test passed: M N K =  1066  1905  1536
Test passed: M N K =   889   728   192
Test passed: M N K =   730   456  1408
Test passed: M N K =  1789  1128  1984
M N K =  2048  2048   256, Elapsed time =   0.000458 s, Result = 00078000, Performance =  46.90 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000804 s, Result = 000f0000, Performance =  53.43 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001288 s, Result = 00168000, Performance =  50.01 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001441 s, Result = 001e0000, Performance =  59.60 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001999 s, Result = 00258000, Performance =  53.72 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002530 s, Result = 002d0000, Performance =  50.93 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003019 s, Result = 00348000, Performance =  49.78 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003701 s, Result = 003c0000, Performance =  46.42 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004307 s, Result = 00438000, Performance =  44.87 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006569 s, Result = 004b0000, Performance =  32.69 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005357 s, Result = 00528000, Performance =  44.10 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.005879 s, Result = 005a0000, Performance =  43.83 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006544 s, Result = 00618000, Performance =  42.66 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007162 s, Result = 00690000, Performance =  41.98 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.006937 s, Result = 00708000, Performance =  46.44 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008305 s, Result = 00780000, Performance =  41.37 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.007281 s, Result = 007f8000, Performance =  50.14 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.007920 s, Result = 00870000, Performance =  48.80 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.007881 s, Result = 008e8000, Performance =  51.78 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.008169 s, Result = 00960000, Performance =  52.58 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.008605 s, Result = 009d8000, Performance =  52.41 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.009093 s, Result = 00a50000, Performance =  51.96 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.009736 s, Result = 00ac8000, Performance =  50.73 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.010886 s, Result = 00b40000, Performance =  47.34 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.009996 s, Result = 00bb8000, Performance =  53.71 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.011158 s, Result = 00c30000, Performance =  50.04 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.011322 s, Result = 00ca8000, Performance =  51.21 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.011430 s, Result = 00d20000, Performance =  52.61 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.011847 s, Result = 00d98000, Performance =  52.57 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012325 s, Result = 00e10000, Performance =  52.27 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.012665 s, Result = 00e88000, Performance =  52.56 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.015387 s, Result = 00f00000, Performance =  44.66 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.013607 s, Result = 00f78000, Performance =  52.08 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.014220 s, Result = 00ff0000, Performance =  51.35 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.014507 s, Result = 01068000, Performance =  51.81 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.014534 s, Result = 010e0000, Performance =  53.19 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.014939 s, Result = 01158000, Performance =  53.19 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.015840 s, Result = 011d0000, Performance =  51.52 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.015617 s, Result = 01248000, Performance =  53.63 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.018276 s, Result = 012c0000, Performance =  47.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.016684 s, Result = 01338000, Performance =  52.77 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017368 s, Result = 013b0000, Performance =  51.93 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.017553 s, Result = 01428000, Performance =  52.61 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.017964 s, Result = 014a0000, Performance =  52.60 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.019233 s, Result = 01518000, Performance =  50.24 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.018839 s, Result = 01590000, Performance =  52.44 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.019178 s, Result = 01608000, Performance =  52.63 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.023807 s, Result = 01680000, Performance =  43.30 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020040 s, Result = 016f8000, Performance =  52.51 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.020648 s, Result = 01770000, Performance =  52.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.021254 s, Result = 017e8000, Performance =  51.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.021207 s, Result = 01860000, Performance =  52.66 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.021707 s, Result = 018d8000, Performance =  52.43 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022415 s, Result = 01950000, Performance =  51.74 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.022946 s, Result = 019c8000, Performance =  51.47 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.025459 s, Result = 01a40000, Performance =  47.24 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023575 s, Result = 01ab8000, Performance =  51.92 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.023818 s, Result = 01b30000, Performance =  52.29 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.024073 s, Result = 01ba8000, Performance =  52.63 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024230 s, Result = 01c20000, Performance =  53.18 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.024698 s, Result = 01c98000, Performance =  53.04 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.025749 s, Result = 01d10000, Performance =  51.71 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.025209 s, Result = 01d88000, Performance =  53.67 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.031612 s, Result = 01e00000, Performance =  43.48 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   709  1139  1600
Test passed: M N K =  1478  1373  1024
Test passed: M N K =  1582  1524   768
Test passed: M N K =   693   346  1536
Test passed: M N K =  1892    24  1280
M N K =  2048  2048   256, Elapsed time =   0.004831 s, Result = 640b8000, Performance =   4.44 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005597 s, Result = c4130000, Performance =   7.67 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006201 s, Result = 241a8000, Performance =  10.39 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006940 s, Result = 84220000, Performance =  12.38 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007144 s, Result = e4298000, Performance =  15.03 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007919 s, Result = 44310000, Performance =  16.27 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008487 s, Result = a4388000, Performance =  17.71 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009165 s, Result = 04400000, Performance =  18.75 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012224 s, Result = 64478000, Performance =  15.81 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010448 s, Result = c44f0000, Performance =  20.55 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010916 s, Result = 24568000, Performance =  21.64 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011319 s, Result = 845e0000, Performance =  22.77 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011763 s, Result = e4658000, Performance =  23.73 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012776 s, Result = 446d0000, Performance =  23.53 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012983 s, Result = a4748000, Performance =  24.81 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013511 s, Result = 047c0000, Performance =  25.43 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015731 s, Result = 64838000, Performance =  23.21 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015335 s, Result = c48b0000, Performance =  25.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015769 s, Result = 24928000, Performance =  25.88 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016077 s, Result = 849a0000, Performance =  26.72 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017049 s, Result = e4a18000, Performance =  26.45 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016577 s, Result = 44a90000, Performance =  28.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018020 s, Result = a4b08000, Performance =  27.41 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017474 s, Result = 04b80000, Performance =  29.50 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018458 s, Result = 64bf8000, Performance =  29.09 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.018656 s, Result = c4c70000, Performance =  29.93 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019296 s, Result = 24ce8000, Performance =  30.05 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020187 s, Result = 84d60000, Performance =  29.79 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.020947 s, Result = e4dd8000, Performance =  29.73 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020881 s, Result = 44e50000, Performance =  30.85 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021864 s, Result = a4ec8000, Performance =  30.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.021414 s, Result = 04f40000, Performance =  32.09 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021995 s, Result = 64fb8000, Performance =  32.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.022159 s, Result = c5030000, Performance =  32.95 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.023622 s, Result = 250a8000, Performance =  31.82 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.023053 s, Result = 85120000, Performance =  33.54 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.023911 s, Result = e5198000, Performance =  33.23 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023997 s, Result = 45210000, Performance =  34.01 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.024965 s, Result = a5288000, Performance =  33.55 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.024801 s, Result = 05300000, Performance =  34.64 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.026206 s, Result = 65378000, Performance =  33.60 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.026418 s, Result = c53f0000, Performance =  34.14 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026905 s, Result = 25468000, Performance =  34.32 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.027059 s, Result = 854e0000, Performance =  34.92 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.027917 s, Result = e5558000, Performance =  34.62 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.028314 s, Result = 455d0000, Performance =  34.89 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.029100 s, Result = a5648000, Performance =  34.69 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028358 s, Result = 056c0000, Performance =  36.35 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.029734 s, Result = 65738000, Performance =  35.39 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.030918 s, Result = c57b0000, Performance =  34.73 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031337 s, Result = 25828000, Performance =  34.95 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.031433 s, Result = 858a0000, Performance =  35.53 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032603 s, Result = e5918000, Performance =  34.91 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.033183 s, Result = 45990000, Performance =  34.95 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.033033 s, Result = a5a08000, Performance =  35.76 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.032707 s, Result = 05a80000, Performance =  36.77 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.034096 s, Result = 65af8000, Performance =  35.90 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.036243 s, Result = c5b70000, Performance =  34.37 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.035864 s, Result = 25be8000, Performance =  35.33 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035268 s, Result = 85c60000, Performance =  36.53 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.036978 s, Result = e5cd8000, Performance =  35.43 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.037214 s, Result = 45d50000, Performance =  35.78 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.037722 s, Result = a5dc8000, Performance =  35.87 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.036979 s, Result = 05e40000, Performance =  37.17 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   580    23   704
Test passed: M N K =   100  1271   768
Test passed: M N K =   938  1938   512
Test passed: M N K =   544   371   448
Test passed: M N K =    50   797  1664
M N K =  2048  2048   256, Elapsed time =   0.003583 s, Result = 00078000, Performance =   5.99 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004524 s, Result = 000f0000, Performance =   9.49 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004432 s, Result = 00168000, Performance =  14.54 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004623 s, Result = 001e0000, Performance =  18.58 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004916 s, Result = 00258000, Performance =  21.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005592 s, Result = 002d0000, Performance =  23.04 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006115 s, Result = 00348000, Performance =  24.58 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009227 s, Result = 003c0000, Performance =  18.62 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007855 s, Result = 00438000, Performance =  24.61 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008815 s, Result = 004b0000, Performance =  24.36 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009016 s, Result = 00528000, Performance =  26.20 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009514 s, Result = 005a0000, Performance =  27.08 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010382 s, Result = 00618000, Performance =  26.89 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011394 s, Result = 00690000, Performance =  26.39 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011917 s, Result = 00708000, Performance =  27.03 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012541 s, Result = 00780000, Performance =  27.40 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013236 s, Result = 007f8000, Performance =  27.58 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013125 s, Result = 00870000, Performance =  29.45 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013614 s, Result = 008e8000, Performance =  29.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014978 s, Result = 00960000, Performance =  28.68 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014602 s, Result = 009d8000, Performance =  30.88 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015429 s, Result = 00a50000, Performance =  30.62 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016592 s, Result = 00ac8000, Performance =  29.77 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016580 s, Result = 00b40000, Performance =  31.09 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.016499 s, Result = 00bb8000, Performance =  32.54 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016867 s, Result = 00c30000, Performance =  33.10 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017655 s, Result = 00ca8000, Performance =  32.84 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018386 s, Result = 00d20000, Performance =  32.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018807 s, Result = 00d98000, Performance =  33.11 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019046 s, Result = 00e10000, Performance =  33.83 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.020146 s, Result = 00e88000, Performance =  33.04 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.019676 s, Result = 00f00000, Performance =  34.92 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020874 s, Result = 00f78000, Performance =  33.95 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020790 s, Result = 00ff0000, Performance =  35.12 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021568 s, Result = 01068000, Performance =  34.85 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.021394 s, Result = 010e0000, Performance =  36.14 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.022602 s, Result = 01158000, Performance =  35.15 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022930 s, Result = 011d0000, Performance =  35.59 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023859 s, Result = 01248000, Performance =  35.10 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.023518 s, Result = 012c0000, Performance =  36.52 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.024833 s, Result = 01338000, Performance =  35.46 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.025140 s, Result = 013b0000, Performance =  35.88 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026111 s, Result = 01428000, Performance =  35.36 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.025981 s, Result = 014a0000, Performance =  36.37 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.026639 s, Result = 01518000, Performance =  36.28 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.026802 s, Result = 01590000, Performance =  36.86 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.027768 s, Result = 01608000, Performance =  36.35 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.027545 s, Result = 01680000, Performance =  37.42 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.028861 s, Result = 016f8000, Performance =  36.46 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.029366 s, Result = 01770000, Performance =  36.56 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.029888 s, Result = 017e8000, Performance =  36.64 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.029879 s, Result = 01860000, Performance =  37.37 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.031059 s, Result = 018d8000, Performance =  36.65 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.031624 s, Result = 01950000, Performance =  36.67 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.031976 s, Result = 019c8000, Performance =  36.94 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.031452 s, Result = 01a40000, Performance =  38.24 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.033122 s, Result = 01ab8000, Performance =  36.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.033606 s, Result = 01b30000, Performance =  37.06 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.034405 s, Result = 01ba8000, Performance =  36.83 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.034011 s, Result = 01c20000, Performance =  37.88 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.036497 s, Result = 01c98000, Performance =  35.89 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035711 s, Result = 01d10000, Performance =  37.28 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.036338 s, Result = 01d88000, Performance =  37.23 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.035300 s, Result = 01e00000, Performance =  38.93 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   209   811   256
Test passed: M N K =  2018   388  1216
Test passed: M N K =  1002   879   512
Test passed: M N K =   715   636   640
Test passed: M N K =   501  1803   448
M N K =  2048  2048   256, Elapsed time =   0.003117 s, Result = 282f8000, Performance =   6.89 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003749 s, Result = 28370000, Performance =  11.46 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004160 s, Result = 283e8000, Performance =  15.49 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004605 s, Result = 28460000, Performance =  18.65 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004849 s, Result = 284d8000, Performance =  22.14 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005243 s, Result = 28550000, Performance =  24.58 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008178 s, Result = 285c8000, Performance =  18.38 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006347 s, Result = 28640000, Performance =  27.07 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006689 s, Result = 286b8000, Performance =  28.89 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007430 s, Result = 28730000, Performance =  28.90 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008048 s, Result = 287a8000, Performance =  29.35 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008752 s, Result = 28820000, Performance =  29.44 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008852 s, Result = 28898000, Performance =  31.54 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009660 s, Result = 28910000, Performance =  31.12 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010141 s, Result = 28988000, Performance =  31.76 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010839 s, Result = 28a00000, Performance =  31.70 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011446 s, Result = 28a78000, Performance =  31.89 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011855 s, Result = 28af0000, Performance =  32.61 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012861 s, Result = 28b68000, Performance =  31.73 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013072 s, Result = 28be0000, Performance =  32.86 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013522 s, Result = 28c58000, Performance =  33.35 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013662 s, Result = 28cd0000, Performance =  34.58 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014773 s, Result = 28d48000, Performance =  33.43 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014442 s, Result = 28dc0000, Performance =  35.69 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015630 s, Result = 28e38000, Performance =  34.35 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016170 s, Result = 28eb0000, Performance =  34.53 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016689 s, Result = 28f28000, Performance =  34.74 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017004 s, Result = 28fa0000, Performance =  35.36 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017857 s, Result = 29018000, Performance =  34.88 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018368 s, Result = 29090000, Performance =  35.07 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019038 s, Result = 29108000, Performance =  34.97 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018791 s, Result = 29180000, Performance =  36.57 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020120 s, Result = 291f8000, Performance =  35.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020276 s, Result = 29270000, Performance =  36.01 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.020949 s, Result = 292e8000, Performance =  35.88 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.020892 s, Result = 29360000, Performance =  37.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021886 s, Result = 293d8000, Performance =  36.30 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022211 s, Result = 29450000, Performance =  36.74 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023424 s, Result = 294c8000, Performance =  35.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022880 s, Result = 29540000, Performance =  37.54 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.023947 s, Result = 295b8000, Performance =  36.77 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.024547 s, Result = 29630000, Performance =  36.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.025330 s, Result = 296a8000, Performance =  36.46 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.025220 s, Result = 29720000, Performance =  37.47 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.026320 s, Result = 29798000, Performance =  36.72 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.027020 s, Result = 29810000, Performance =  36.56 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.027405 s, Result = 29888000, Performance =  36.83 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.026737 s, Result = 29900000, Performance =  38.55 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.028046 s, Result = 29978000, Performance =  37.52 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.028832 s, Result = 299f0000, Performance =  37.24 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.029676 s, Result = 29a68000, Performance =  36.91 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.029555 s, Result = 29ae0000, Performance =  37.78 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.030634 s, Result = 29b58000, Performance =  37.15 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.030955 s, Result = 29bd0000, Performance =  37.46 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.031495 s, Result = 29c48000, Performance =  37.50 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.031299 s, Result = 29cc0000, Performance =  38.42 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.032765 s, Result = 29d38000, Performance =  37.36 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.032937 s, Result = 29db0000, Performance =  37.82 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.033698 s, Result = 29e28000, Performance =  37.60 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.033417 s, Result = 29ea0000, Performance =  38.56 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.034775 s, Result = 29f18000, Performance =  37.67 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035018 s, Result = 29f90000, Performance =  38.02 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.035643 s, Result = 2a008000, Performance =  37.96 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034834 s, Result = 2a080000, Performance =  39.46 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1449    79  1216
Test passed: M N K =   463  1497  2048
Test passed: M N K =   199  1230    64
Test passed: M N K =  1035  1706   448
Test passed: M N K =   547   265  1088
M N K =  2048  2048   256, Elapsed time =   0.000458 s, Result = 00078000, Performance =  46.87 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000874 s, Result = 000f0000, Performance =  49.15 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001312 s, Result = 00168000, Performance =  49.10 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001639 s, Result = 001e0000, Performance =  52.41 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001889 s, Result = 00258000, Performance =  56.83 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002473 s, Result = 002d0000, Performance =  52.10 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002958 s, Result = 00348000, Performance =  50.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003646 s, Result = 003c0000, Performance =  47.13 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004139 s, Result = 00438000, Performance =  46.69 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011084 s, Result = 004b0000, Performance =  19.37 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005540 s, Result = 00528000, Performance =  42.64 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.006127 s, Result = 005a0000, Performance =  42.06 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006333 s, Result = 00618000, Performance =  44.08 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007410 s, Result = 00690000, Performance =  40.57 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008037 s, Result = 00708000, Performance =  40.08 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008512 s, Result = 00780000, Performance =  40.36 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008931 s, Result = 007f8000, Performance =  40.88 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009504 s, Result = 00870000, Performance =  40.67 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.011436 s, Result = 008e8000, Performance =  35.68 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010579 s, Result = 00960000, Performance =  40.60 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011076 s, Result = 009d8000, Performance =  40.72 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011292 s, Result = 00a50000, Performance =  41.84 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012137 s, Result = 00ac8000, Performance =  40.69 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012400 s, Result = 00b40000, Performance =  41.56 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012764 s, Result = 00bb8000, Performance =  42.06 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013461 s, Result = 00c30000, Performance =  41.48 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014273 s, Result = 00ca8000, Performance =  40.62 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014277 s, Result = 00d20000, Performance =  42.12 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014660 s, Result = 00d98000, Performance =  42.48 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015249 s, Result = 00e10000, Performance =  42.25 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016131 s, Result = 00e88000, Performance =  41.27 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016158 s, Result = 00f00000, Performance =  42.53 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017086 s, Result = 00f78000, Performance =  41.48 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017301 s, Result = 00ff0000, Performance =  42.20 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.018369 s, Result = 01068000, Performance =  40.92 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.018314 s, Result = 010e0000, Performance =  42.21 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.019048 s, Result = 01158000, Performance =  41.71 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.020037 s, Result = 011d0000, Performance =  40.73 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.020098 s, Result = 01248000, Performance =  41.67 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.020145 s, Result = 012c0000, Performance =  42.64 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.021584 s, Result = 01338000, Performance =  40.79 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.021767 s, Result = 013b0000, Performance =  41.44 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.022918 s, Result = 01428000, Performance =  40.29 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.022853 s, Result = 014a0000, Performance =  41.35 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.022822 s, Result = 01518000, Performance =  42.34 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.023988 s, Result = 01590000, Performance =  41.18 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.024622 s, Result = 01608000, Performance =  40.99 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.023930 s, Result = 01680000, Performance =  43.08 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.025482 s, Result = 016f8000, Performance =  41.29 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.026013 s, Result = 01770000, Performance =  41.28 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026857 s, Result = 017e8000, Performance =  40.78 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026756 s, Result = 01860000, Performance =  41.74 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.027487 s, Result = 018d8000, Performance =  41.41 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.028518 s, Result = 01950000, Performance =  40.66 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.029394 s, Result = 019c8000, Performance =  40.18 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.028560 s, Result = 01a40000, Performance =  42.11 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.030116 s, Result = 01ab8000, Performance =  40.64 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.030362 s, Result = 01b30000, Performance =  41.02 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.031417 s, Result = 01ba8000, Performance =  40.33 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.030722 s, Result = 01c20000, Performance =  41.94 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.032168 s, Result = 01c98000, Performance =  40.72 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.032397 s, Result = 01d10000, Performance =  41.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.033131 s, Result = 01d88000, Performance =  40.84 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.031838 s, Result = 01e00000, Performance =  43.17 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   120   583  1728
Test passed: M N K =   451    67  1536
Test passed: M N K =   957  1717  1472
Test passed: M N K =  2010   914   512
Test passed: M N K =  1323   548   128
M N K =  2048  2048   256, Elapsed time =   0.007921 s, Result = d4108000, Performance =   2.71 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008651 s, Result = a41d0000, Performance =   4.96 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008648 s, Result = 74298000, Performance =   7.45 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008943 s, Result = 44360000, Performance =   9.61 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009607 s, Result = 14428000, Performance =  11.18 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010241 s, Result = e44f0000, Performance =  12.58 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010879 s, Result = b45b8000, Performance =  13.82 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011820 s, Result = 84680000, Performance =  14.54 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015814 s, Result = 54748000, Performance =  12.22 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012753 s, Result = 24810000, Performance =  16.84 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013598 s, Result = f48d8000, Performance =  17.37 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014623 s, Result = c49a0000, Performance =  17.62 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015410 s, Result = 94a68000, Performance =  18.12 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016431 s, Result = 64b30000, Performance =  18.30 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016775 s, Result = 34bf8000, Performance =  19.20 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018124 s, Result = 04cc0000, Performance =  18.96 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017151 s, Result = d4d88000, Performance =  21.29 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018829 s, Result = a4e50000, Performance =  20.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018361 s, Result = 74f18000, Performance =  22.22 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018821 s, Result = 44fe0000, Performance =  22.82 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019338 s, Result = 150a8000, Performance =  23.32 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020604 s, Result = e5170000, Performance =  22.93 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021196 s, Result = b5238000, Performance =  23.30 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021437 s, Result = 85300000, Performance =  24.04 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022588 s, Result = 553c8000, Performance =  23.77 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022871 s, Result = 25490000, Performance =  24.41 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.023704 s, Result = f5558000, Performance =  24.46 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024013 s, Result = c5620000, Performance =  25.04 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.024263 s, Result = 956e8000, Performance =  25.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025056 s, Result = 657b0000, Performance =  25.71 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.025266 s, Result = 35878000, Performance =  26.35 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026295 s, Result = 05940000, Performance =  26.13 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.026910 s, Result = d5a08000, Performance =  26.33 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.026945 s, Result = a5ad0000, Performance =  27.10 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028175 s, Result = 75b98000, Performance =  26.68 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.027784 s, Result = 45c60000, Performance =  27.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.029070 s, Result = 15d28000, Performance =  27.33 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.029722 s, Result = e5df0000, Performance =  27.46 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.030471 s, Result = b5eb8000, Performance =  27.49 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.030455 s, Result = 85f80000, Performance =  28.21 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.031478 s, Result = 56048000, Performance =  27.97 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.031976 s, Result = 26110000, Performance =  28.21 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.032857 s, Result = f61d8000, Performance =  28.10 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.032777 s, Result = c62a0000, Performance =  28.83 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.033405 s, Result = 96368000, Performance =  28.93 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.034130 s, Result = 66430000, Performance =  28.94 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.034633 s, Result = 364f8000, Performance =  29.14 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.036282 s, Result = 065c0000, Performance =  28.41 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.036778 s, Result = d6688000, Performance =  28.61 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.036749 s, Result = a6750000, Performance =  29.22 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.038054 s, Result = 76818000, Performance =  28.78 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.037541 s, Result = 468e0000, Performance =  29.75 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.041130 s, Result = 169a8000, Performance =  27.67 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.039822 s, Result = e6a70000, Performance =  29.12 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.040345 s, Result = b6b38000, Performance =  29.28 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.040551 s, Result = 86c00000, Performance =  29.66 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.041443 s, Result = 56cc8000, Performance =  29.54 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.041957 s, Result = 26d90000, Performance =  29.69 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.042946 s, Result = f6e58000, Performance =  29.50 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.042371 s, Result = c6f20000, Performance =  30.41 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.043081 s, Result = 96fe8000, Performance =  30.41 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.044303 s, Result = 670b0000, Performance =  30.05 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.044758 s, Result = 37178000, Performance =  30.23 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.046251 s, Result = 07240000, Performance =  29.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1605   115  1536
Test passed: M N K =  1413  1835   192
Test passed: M N K =   355   768  1664
Test passed: M N K =  1157   411   704
Test passed: M N K =  1825   792  1344
M N K =  2048  2048   256, Elapsed time =   0.006605 s, Result = 000c8000, Performance =   3.25 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006994 s, Result = 00190000, Performance =   6.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007075 s, Result = 00258000, Performance =   9.11 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007378 s, Result = 00320000, Performance =  11.64 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007606 s, Result = 003e8000, Performance =  14.12 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008272 s, Result = 004b0000, Performance =  15.58 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008867 s, Result = 00578000, Performance =  16.95 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009755 s, Result = 00640000, Performance =  17.61 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013606 s, Result = 00708000, Performance =  14.21 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010864 s, Result = 007d0000, Performance =  19.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011224 s, Result = 00898000, Performance =  21.05 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012139 s, Result = 00960000, Performance =  21.23 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012945 s, Result = 00a28000, Performance =  21.57 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013298 s, Result = 00af0000, Performance =  22.61 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014047 s, Result = 00bb8000, Performance =  22.93 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015285 s, Result = 00c80000, Performance =  22.48 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015666 s, Result = 00d48000, Performance =  23.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.016669 s, Result = 00e10000, Performance =  23.19 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016452 s, Result = 00ed8000, Performance =  24.80 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017893 s, Result = 00fa0000, Performance =  24.00 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017615 s, Result = 01068000, Performance =  25.60 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018231 s, Result = 01130000, Performance =  25.91 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018880 s, Result = 011f8000, Performance =  26.16 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020086 s, Result = 012c0000, Performance =  25.66 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020240 s, Result = 01388000, Performance =  26.52 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020478 s, Result = 01450000, Performance =  27.27 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021670 s, Result = 01518000, Performance =  26.76 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.021559 s, Result = 015e0000, Performance =  27.89 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.022813 s, Result = 016a8000, Performance =  27.30 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.022693 s, Result = 01770000, Performance =  28.39 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.023569 s, Result = 01838000, Performance =  28.25 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.024160 s, Result = 01900000, Performance =  28.44 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.024974 s, Result = 019c8000, Performance =  28.38 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024639 s, Result = 01a90000, Performance =  29.63 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.025449 s, Result = 01b58000, Performance =  29.53 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.026298 s, Result = 01c20000, Performance =  29.40 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.026716 s, Result = 01ce8000, Performance =  29.74 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.026914 s, Result = 01db0000, Performance =  30.32 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.027938 s, Result = 01e78000, Performance =  29.98 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.028968 s, Result = 01f40000, Performance =  29.65 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028752 s, Result = 02008000, Performance =  30.62 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029133 s, Result = 020d0000, Performance =  30.96 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.030117 s, Result = 02198000, Performance =  30.66 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030330 s, Result = 02260000, Performance =  31.15 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.031285 s, Result = 02328000, Performance =  30.89 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.032287 s, Result = 023f0000, Performance =  30.60 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.032396 s, Result = 024b8000, Performance =  31.16 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.033398 s, Result = 02580000, Performance =  30.86 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034027 s, Result = 02648000, Performance =  30.92 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034296 s, Result = 02710000, Performance =  31.31 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.035169 s, Result = 027d8000, Performance =  31.14 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035755 s, Result = 028a0000, Performance =  31.23 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.036778 s, Result = 02968000, Performance =  30.95 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.038206 s, Result = 02a30000, Performance =  30.35 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.038168 s, Result = 02af8000, Performance =  30.95 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.038485 s, Result = 02bc0000, Performance =  31.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.039855 s, Result = 02c88000, Performance =  30.71 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.040126 s, Result = 02d50000, Performance =  31.04 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.041775 s, Result = 02e18000, Performance =  30.33 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041378 s, Result = 02ee0000, Performance =  31.14 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.041840 s, Result = 02fa8000, Performance =  31.31 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.042628 s, Result = 03070000, Performance =  31.23 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.043774 s, Result = 03138000, Performance =  30.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.043174 s, Result = 03200000, Performance =  31.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1448  1146    64
Test passed: M N K =  1635  1829  1472
Test passed: M N K =  1871  2012  1984
Test passed: M N K =   613   429   832
Test passed: M N K =  1093   931   704
M N K =  2048  2048   256, Elapsed time =   0.003616 s, Result = 28348000, Performance =   5.94 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004076 s, Result = 28410000, Performance =  10.54 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004648 s, Result = 284d8000, Performance =  13.86 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005138 s, Result = 285a0000, Performance =  16.72 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005777 s, Result = 28668000, Performance =  18.59 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006224 s, Result = 28730000, Performance =  20.70 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006829 s, Result = 287f8000, Performance =  22.01 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007890 s, Result = 288c0000, Performance =  21.78 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008174 s, Result = 28988000, Performance =  23.65 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012807 s, Result = 28a50000, Performance =  16.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009584 s, Result = 28b18000, Performance =  24.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010483 s, Result = 28be0000, Performance =  24.58 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011356 s, Result = 28ca8000, Performance =  24.58 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012014 s, Result = 28d70000, Performance =  25.02 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013117 s, Result = 28e38000, Performance =  24.56 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014140 s, Result = 28f00000, Performance =  24.30 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013368 s, Result = 28fc8000, Performance =  27.31 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013811 s, Result = 29090000, Performance =  27.99 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014230 s, Result = 29158000, Performance =  28.67 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016015 s, Result = 29220000, Performance =  26.82 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015664 s, Result = 292e8000, Performance =  28.79 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016270 s, Result = 293b0000, Performance =  29.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.017078 s, Result = 29478000, Performance =  28.92 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017886 s, Result = 29540000, Performance =  28.82 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017978 s, Result = 29608000, Performance =  29.86 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019617 s, Result = 296d0000, Performance =  28.46 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.019243 s, Result = 29798000, Performance =  30.13 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.019766 s, Result = 29860000, Performance =  30.42 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.020890 s, Result = 29928000, Performance =  29.81 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020949 s, Result = 299f0000, Performance =  30.75 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021735 s, Result = 29ab8000, Performance =  30.63 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022831 s, Result = 29b80000, Performance =  30.10 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023157 s, Result = 29c48000, Performance =  30.60 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.022932 s, Result = 29d10000, Performance =  31.84 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024597 s, Result = 29dd8000, Performance =  30.56 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024719 s, Result = 29ea0000, Performance =  31.27 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025275 s, Result = 29f68000, Performance =  31.44 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.025674 s, Result = 2a030000, Performance =  31.78 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026350 s, Result = 2a0f8000, Performance =  31.78 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.027135 s, Result = 2a1c0000, Performance =  31.66 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.027412 s, Result = 2a288000, Performance =  32.12 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.028637 s, Result = 2a350000, Performance =  31.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029139 s, Result = 2a418000, Performance =  31.69 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.029624 s, Result = 2a4e0000, Performance =  31.90 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.029890 s, Result = 2a5a8000, Performance =  32.33 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031173 s, Result = 2a670000, Performance =  31.69 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031425 s, Result = 2a738000, Performance =  32.12 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.032233 s, Result = 2a800000, Performance =  31.98 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.032600 s, Result = 2a8c8000, Performance =  32.28 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.032517 s, Result = 2a990000, Performance =  33.02 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.034656 s, Result = 2aa58000, Performance =  31.60 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.033859 s, Result = 2ab20000, Performance =  32.98 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035983 s, Result = 2abe8000, Performance =  31.63 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.035901 s, Result = 2acb0000, Performance =  32.30 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.036398 s, Result = 2ad78000, Performance =  32.45 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.036724 s, Result = 2ae40000, Performance =  32.75 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.037078 s, Result = 2af08000, Performance =  33.01 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.038177 s, Result = 2afd0000, Performance =  32.63 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.039617 s, Result = 2b098000, Performance =  31.98 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.039290 s, Result = 2b160000, Performance =  32.79 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.040705 s, Result = 2b228000, Performance =  32.18 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.039846 s, Result = 2b2f0000, Performance =  33.41 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.041723 s, Result = 2b3b8000, Performance =  32.43 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.043490 s, Result = 2b480000, Performance =  31.60 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1710   954   192
Test passed: M N K =    66  1269   448
Test passed: M N K =  1546   331   512
Test passed: M N K =    69   418   384
Test passed: M N K =  2038    80   512
M N K =  2048  2048   256, Elapsed time =   0.000577 s, Result = 000c8000, Performance =  37.25 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000960 s, Result = 00190000, Performance =  44.74 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001465 s, Result = 00258000, Performance =  43.98 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001923 s, Result = 00320000, Performance =  44.67 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002296 s, Result = 003e8000, Performance =  46.77 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003091 s, Result = 004b0000, Performance =  41.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003618 s, Result = 00578000, Performance =  41.55 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004362 s, Result = 00640000, Performance =  39.39 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004757 s, Result = 00708000, Performance =  40.63 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007184 s, Result = 007d0000, Performance =  29.89 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006366 s, Result = 00898000, Performance =  37.11 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007140 s, Result = 00960000, Performance =  36.09 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007984 s, Result = 00a28000, Performance =  34.97 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.008809 s, Result = 00af0000, Performance =  34.13 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009650 s, Result = 00bb8000, Performance =  33.38 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010252 s, Result = 00c80000, Performance =  33.51 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010135 s, Result = 00d48000, Performance =  36.02 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011381 s, Result = 00e10000, Performance =  33.96 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012334 s, Result = 00ed8000, Performance =  33.08 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011723 s, Result = 00fa0000, Performance =  36.64 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011943 s, Result = 01068000, Performance =  37.76 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013927 s, Result = 01130000, Performance =  33.92 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014602 s, Result = 011f8000, Performance =  33.83 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014620 s, Result = 012c0000, Performance =  35.25 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014423 s, Result = 01388000, Performance =  37.22 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015408 s, Result = 01450000, Performance =  36.24 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016398 s, Result = 01518000, Performance =  35.36 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.016312 s, Result = 015e0000, Performance =  36.86 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017228 s, Result = 016a8000, Performance =  36.15 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.017505 s, Result = 01770000, Performance =  36.80 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018187 s, Result = 01838000, Performance =  36.60 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018380 s, Result = 01900000, Performance =  37.39 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019359 s, Result = 019c8000, Performance =  36.61 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020146 s, Result = 01a90000, Performance =  36.24 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.020743 s, Result = 01b58000, Performance =  36.23 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.021026 s, Result = 01c20000, Performance =  36.77 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.023001 s, Result = 01ce8000, Performance =  34.55 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.022615 s, Result = 01db0000, Performance =  36.08 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023682 s, Result = 01e78000, Performance =  35.37 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.023583 s, Result = 01f40000, Performance =  36.42 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.025054 s, Result = 02008000, Performance =  35.14 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.024747 s, Result = 020d0000, Performance =  36.45 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.025967 s, Result = 02198000, Performance =  35.56 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.026293 s, Result = 02260000, Performance =  35.94 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.026692 s, Result = 02328000, Performance =  36.21 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.027052 s, Result = 023f0000, Performance =  36.52 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.028170 s, Result = 024b8000, Performance =  35.83 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028469 s, Result = 02580000, Performance =  36.21 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.029261 s, Result = 02648000, Performance =  35.96 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.029504 s, Result = 02710000, Performance =  36.39 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.030526 s, Result = 027d8000, Performance =  35.88 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.030480 s, Result = 028a0000, Performance =  36.64 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032687 s, Result = 02968000, Performance =  34.82 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.031540 s, Result = 02a30000, Performance =  36.77 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.032509 s, Result = 02af8000, Performance =  36.33 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.033282 s, Result = 02bc0000, Performance =  36.13 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.033789 s, Result = 02c88000, Performance =  36.23 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.035488 s, Result = 02d50000, Performance =  35.10 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.034896 s, Result = 02e18000, Performance =  36.31 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035575 s, Result = 02ee0000, Performance =  36.22 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.035402 s, Result = 02fa8000, Performance =  37.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.037455 s, Result = 03070000, Performance =  35.55 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.037672 s, Result = 03138000, Performance =  35.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.037657 s, Result = 03200000, Performance =  36.50 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1772  1562  1792
Test passed: M N K =   639  1205  1216
Test passed: M N K =   369   227  1920
Test passed: M N K =   339  1313   448
Test passed: M N K =   593  1795   512
M N K =  2048  2048   256, Elapsed time =   0.007749 s, Result = d4108000, Performance =   2.77 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008458 s, Result = a41d0000, Performance =   5.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008637 s, Result = 74298000, Performance =   7.46 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009146 s, Result = 44360000, Performance =   9.39 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009675 s, Result = 14428000, Performance =  11.10 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010206 s, Result = e44f0000, Performance =  12.62 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011155 s, Result = b45b8000, Performance =  13.48 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012189 s, Result = 84680000, Performance =  14.09 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016765 s, Result = 54748000, Performance =  11.53 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013870 s, Result = 24810000, Performance =  15.48 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014317 s, Result = f48d8000, Performance =  16.50 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014732 s, Result = c49a0000, Performance =  17.49 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015879 s, Result = 94a68000, Performance =  17.58 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016663 s, Result = 64b30000, Performance =  18.04 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016778 s, Result = 34bf8000, Performance =  19.20 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.020420 s, Result = 04cc0000, Performance =  16.83 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017668 s, Result = d4d88000, Performance =  20.66 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018664 s, Result = a4e50000, Performance =  20.71 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018958 s, Result = 74f18000, Performance =  21.52 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019370 s, Result = 44fe0000, Performance =  22.17 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019860 s, Result = 150a8000, Performance =  22.71 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020422 s, Result = e5170000, Performance =  23.13 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021034 s, Result = b5238000, Performance =  23.48 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.023190 s, Result = 85300000, Performance =  22.22 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.022534 s, Result = 553c8000, Performance =  23.82 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.023533 s, Result = 25490000, Performance =  23.73 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.024091 s, Result = f5558000, Performance =  24.07 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.024661 s, Result = c5620000, Performance =  24.38 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025426 s, Result = 956e8000, Performance =  24.49 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025849 s, Result = 657b0000, Performance =  24.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.026182 s, Result = 35878000, Performance =  25.43 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.032234 s, Result = 05940000, Performance =  21.32 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.027629 s, Result = d5a08000, Performance =  25.65 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027683 s, Result = a5ad0000, Performance =  26.38 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028678 s, Result = 75b98000, Performance =  26.21 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.029090 s, Result = 45c60000, Performance =  26.58 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.030063 s, Result = 15d28000, Performance =  26.43 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.030301 s, Result = e5df0000, Performance =  26.93 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.030965 s, Result = b5eb8000, Performance =  27.05 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034662 s, Result = 85f80000, Performance =  24.78 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.032280 s, Result = 56048000, Performance =  27.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.032935 s, Result = 26110000, Performance =  27.39 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.033616 s, Result = f61d8000, Performance =  27.47 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034284 s, Result = c62a0000, Performance =  27.56 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.035494 s, Result = 96368000, Performance =  27.23 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.035515 s, Result = 66430000, Performance =  27.81 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.035965 s, Result = 364f8000, Performance =  28.06 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046021 s, Result = 065c0000, Performance =  22.40 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.037032 s, Result = d6688000, Performance =  28.41 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.038235 s, Result = a6750000, Performance =  28.08 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.038772 s, Result = 76818000, Performance =  28.25 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.038900 s, Result = 468e0000, Performance =  28.71 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.040158 s, Result = 169a8000, Performance =  28.34 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.040560 s, Result = e6a70000, Performance =  28.59 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.041411 s, Result = b6b38000, Performance =  28.52 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045392 s, Result = 86c00000, Performance =  26.49 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.042295 s, Result = 56cc8000, Performance =  28.94 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.043517 s, Result = 26d90000, Performance =  28.62 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.043531 s, Result = f6e58000, Performance =  29.11 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.044539 s, Result = c6f20000, Performance =  28.93 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.045194 s, Result = 96fe8000, Performance =  28.99 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.046093 s, Result = 670b0000, Performance =  28.89 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.045340 s, Result = 37178000, Performance =  29.84 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.057751 s, Result = 07240000, Performance =  23.80 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   393   325  1536
Test passed: M N K =  1001  1476  1472
Test passed: M N K =   355  1570   192
Test passed: M N K =   339   229   640
Test passed: M N K =   504   975   832
M N K =  2048  2048   256, Elapsed time =   0.006253 s, Result = 000c8000, Performance =   3.43 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007223 s, Result = 00190000, Performance =   5.95 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007380 s, Result = 00258000, Performance =   8.73 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007848 s, Result = 00320000, Performance =  10.94 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008332 s, Result = 003e8000, Performance =  12.89 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008754 s, Result = 004b0000, Performance =  14.72 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009394 s, Result = 00578000, Performance =  16.00 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010520 s, Result = 00640000, Performance =  16.33 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014928 s, Result = 00708000, Performance =  12.95 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011923 s, Result = 007d0000, Performance =  18.01 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012585 s, Result = 00898000, Performance =  18.77 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013266 s, Result = 00960000, Performance =  19.43 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014459 s, Result = 00a28000, Performance =  19.31 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014763 s, Result = 00af0000, Performance =  20.37 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014698 s, Result = 00bb8000, Performance =  21.92 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017618 s, Result = 00c80000, Performance =  19.50 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016007 s, Result = 00d48000, Performance =  22.81 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017185 s, Result = 00e10000, Performance =  22.49 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016911 s, Result = 00ed8000, Performance =  24.13 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017716 s, Result = 00fa0000, Performance =  24.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017956 s, Result = 01068000, Performance =  25.12 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018931 s, Result = 01130000, Performance =  24.96 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019414 s, Result = 011f8000, Performance =  25.44 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021665 s, Result = 012c0000, Performance =  23.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020519 s, Result = 01388000, Performance =  26.16 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021586 s, Result = 01450000, Performance =  25.87 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021723 s, Result = 01518000, Performance =  26.69 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022408 s, Result = 015e0000, Performance =  26.83 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023332 s, Result = 016a8000, Performance =  26.69 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.023944 s, Result = 01770000, Performance =  26.91 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.024193 s, Result = 01838000, Performance =  27.52 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030688 s, Result = 01900000, Performance =  22.39 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.025094 s, Result = 019c8000, Performance =  28.24 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.025707 s, Result = 01a90000, Performance =  28.40 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.025933 s, Result = 01b58000, Performance =  28.98 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.026801 s, Result = 01c20000, Performance =  28.85 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.027204 s, Result = 01ce8000, Performance =  29.21 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.028823 s, Result = 01db0000, Performance =  28.31 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.028850 s, Result = 01e78000, Performance =  29.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032367 s, Result = 01f40000, Performance =  26.54 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.029928 s, Result = 02008000, Performance =  29.42 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.031086 s, Result = 020d0000, Performance =  29.01 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.031683 s, Result = 02198000, Performance =  29.15 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.031579 s, Result = 02260000, Performance =  29.92 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.032399 s, Result = 02328000, Performance =  29.83 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.033080 s, Result = 023f0000, Performance =  29.86 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.033056 s, Result = 024b8000, Performance =  30.53 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043456 s, Result = 02580000, Performance =  23.72 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.034755 s, Result = 02648000, Performance =  30.28 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.035890 s, Result = 02710000, Performance =  29.92 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.036036 s, Result = 027d8000, Performance =  30.39 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.036325 s, Result = 028a0000, Performance =  30.74 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.037395 s, Result = 02968000, Performance =  30.44 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.038655 s, Result = 02a30000, Performance =  30.00 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.038986 s, Result = 02af8000, Performance =  30.30 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.043576 s, Result = 02bc0000, Performance =  27.60 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.039946 s, Result = 02c88000, Performance =  30.64 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.041122 s, Result = 02d50000, Performance =  30.29 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.041241 s, Result = 02e18000, Performance =  30.72 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.041437 s, Result = 02ee0000, Performance =  31.09 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.042967 s, Result = 02fa8000, Performance =  30.49 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.043683 s, Result = 03070000, Performance =  30.48 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.043932 s, Result = 03138000, Performance =  30.80 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.056681 s, Result = 03200000, Performance =  24.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   901   368  1088
Test passed: M N K =   448  1258  1728
Test passed: M N K =  1808  1378    64
Test passed: M N K =  1298   480  1664
Test passed: M N K =   319  1402  1920
M N K =  2048  2048   256, Elapsed time =   0.003632 s, Result = 28348000, Performance =   5.91 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004119 s, Result = 28410000, Performance =  10.43 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004638 s, Result = 284d8000, Performance =  13.89 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004970 s, Result = 285a0000, Performance =  17.29 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005749 s, Result = 28668000, Performance =  18.68 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006188 s, Result = 28730000, Performance =  20.82 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007066 s, Result = 287f8000, Performance =  21.27 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008322 s, Result = 288c0000, Performance =  20.64 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009027 s, Result = 28988000, Performance =  21.41 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013614 s, Result = 28a50000, Performance =  15.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010742 s, Result = 28b18000, Performance =  21.99 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011351 s, Result = 28be0000, Performance =  22.70 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012130 s, Result = 28ca8000, Performance =  23.01 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012953 s, Result = 28d70000, Performance =  23.21 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013167 s, Result = 28e38000, Performance =  24.46 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016652 s, Result = 28f00000, Performance =  20.63 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013737 s, Result = 28fc8000, Performance =  26.58 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014542 s, Result = 29090000, Performance =  26.58 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014780 s, Result = 29158000, Performance =  27.61 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015233 s, Result = 29220000, Performance =  28.19 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015737 s, Result = 292e8000, Performance =  28.66 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016928 s, Result = 293b0000, Performance =  27.91 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.017460 s, Result = 29478000, Performance =  28.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019302 s, Result = 29540000, Performance =  26.70 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018784 s, Result = 29608000, Performance =  28.58 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019674 s, Result = 296d0000, Performance =  28.38 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.020519 s, Result = 29798000, Performance =  28.26 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020534 s, Result = 29860000, Performance =  29.28 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021295 s, Result = 29928000, Performance =  29.25 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.022298 s, Result = 299f0000, Performance =  28.89 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.022650 s, Result = 29ab8000, Performance =  29.39 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028641 s, Result = 29b80000, Performance =  23.99 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023963 s, Result = 29c48000, Performance =  29.57 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.024346 s, Result = 29d10000, Performance =  29.99 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024835 s, Result = 29dd8000, Performance =  30.26 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.025062 s, Result = 29ea0000, Performance =  30.85 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.026096 s, Result = 29f68000, Performance =  30.45 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.027026 s, Result = 2a030000, Performance =  30.19 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026897 s, Result = 2a0f8000, Performance =  31.14 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.031065 s, Result = 2a1c0000, Performance =  27.65 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.028095 s, Result = 2a288000, Performance =  31.34 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.029177 s, Result = 2a350000, Performance =  30.91 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.029595 s, Result = 2a418000, Performance =  31.20 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.030188 s, Result = 2a4e0000, Performance =  31.30 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.030951 s, Result = 2a5a8000, Performance =  31.22 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.031385 s, Result = 2a670000, Performance =  31.48 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.031419 s, Result = 2a738000, Performance =  32.12 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043117 s, Result = 2a800000, Performance =  23.91 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.033467 s, Result = 2a8c8000, Performance =  31.44 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.034431 s, Result = 2a990000, Performance =  31.19 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.034913 s, Result = 2aa58000, Performance =  31.37 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.035407 s, Result = 2ab20000, Performance =  31.54 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.035257 s, Result = 2abe8000, Performance =  32.28 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.036737 s, Result = 2acb0000, Performance =  31.57 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.036886 s, Result = 2ad78000, Performance =  32.02 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.041985 s, Result = 2ae40000, Performance =  28.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.038370 s, Result = 2af08000, Performance =  31.90 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.039235 s, Result = 2afd0000, Performance =  31.75 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.039592 s, Result = 2b098000, Performance =  32.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.040280 s, Result = 2b160000, Performance =  31.99 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.040908 s, Result = 2b228000, Performance =  32.02 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.041997 s, Result = 2b2f0000, Performance =  31.70 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.042294 s, Result = 2b3b8000, Performance =  31.99 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.056267 s, Result = 2b480000, Performance =  24.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   433   236   960
Test passed: M N K =  1745  1383  1152
Test passed: M N K =  2040  1530  1344
Test passed: M N K =  1571   567   704
Test passed: M N K =  1436  1317   320
M N K =  2048  2048   256, Elapsed time =   0.000521 s, Result = 000c8000, Performance =  41.21 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001019 s, Result = 00190000, Performance =  42.16 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001631 s, Result = 00258000, Performance =  39.51 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002020 s, Result = 00320000, Performance =  42.53 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002397 s, Result = 003e8000, Performance =  44.79 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003038 s, Result = 004b0000, Performance =  42.41 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004007 s, Result = 00578000, Performance =  37.51 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005322 s, Result = 00640000, Performance =  32.28 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006017 s, Result = 00708000, Performance =  32.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008795 s, Result = 007d0000, Performance =  24.42 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007888 s, Result = 00898000, Performance =  29.95 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008838 s, Result = 00960000, Performance =  29.16 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009847 s, Result = 00a28000, Performance =  28.35 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010429 s, Result = 00af0000, Performance =  28.83 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010327 s, Result = 00bb8000, Performance =  31.19 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014094 s, Result = 00c80000, Performance =  24.38 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010528 s, Result = 00d48000, Performance =  34.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011529 s, Result = 00e10000, Performance =  33.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013213 s, Result = 00ed8000, Performance =  30.88 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012306 s, Result = 00fa0000, Performance =  34.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013094 s, Result = 01068000, Performance =  34.44 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013613 s, Result = 01130000, Performance =  34.71 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.013858 s, Result = 011f8000, Performance =  35.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016960 s, Result = 012c0000, Performance =  30.39 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015505 s, Result = 01388000, Performance =  34.63 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.016727 s, Result = 01450000, Performance =  33.38 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016540 s, Result = 01518000, Performance =  35.06 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017613 s, Result = 015e0000, Performance =  34.14 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018150 s, Result = 016a8000, Performance =  34.31 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.018635 s, Result = 01770000, Performance =  34.57 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018830 s, Result = 01838000, Performance =  35.35 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.026500 s, Result = 01900000, Performance =  25.93 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019911 s, Result = 019c8000, Performance =  35.59 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020875 s, Result = 01a90000, Performance =  34.98 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.021649 s, Result = 01b58000, Performance =  34.72 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.021943 s, Result = 01c20000, Performance =  35.23 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.022690 s, Result = 01ce8000, Performance =  35.02 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023929 s, Result = 01db0000, Performance =  34.10 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.023998 s, Result = 01e78000, Performance =  34.90 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.027829 s, Result = 01f40000, Performance =  30.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.024931 s, Result = 02008000, Performance =  35.32 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.025960 s, Result = 020d0000, Performance =  34.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026497 s, Result = 02198000, Performance =  34.85 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.027297 s, Result = 02260000, Performance =  34.61 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.027797 s, Result = 02328000, Performance =  34.76 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.028103 s, Result = 023f0000, Performance =  35.15 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.028535 s, Result = 024b8000, Performance =  35.37 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041087 s, Result = 02580000, Performance =  25.09 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.029861 s, Result = 02648000, Performance =  35.24 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.030854 s, Result = 02710000, Performance =  34.80 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031381 s, Result = 027d8000, Performance =  34.90 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.031878 s, Result = 028a0000, Performance =  35.03 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032477 s, Result = 02968000, Performance =  35.04 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.033887 s, Result = 02a30000, Performance =  34.22 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.033779 s, Result = 02af8000, Performance =  34.97 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.039090 s, Result = 02bc0000, Performance =  30.76 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.034771 s, Result = 02c88000, Performance =  35.20 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.036596 s, Result = 02d50000, Performance =  34.03 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.036802 s, Result = 02e18000, Performance =  34.43 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.036860 s, Result = 02ee0000, Performance =  34.96 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.037715 s, Result = 02fa8000, Performance =  34.73 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.038970 s, Result = 03070000, Performance =  34.17 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.038559 s, Result = 03138000, Performance =  35.09 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.054087 s, Result = 03200000, Performance =  25.41 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   260    67   320
Test passed: M N K =  1854   893   640
Test passed: M N K =    41    14  1792
Test passed: M N K =  1086  1487   768
Test passed: M N K =  1911  1312    64
M N K =  2048  2048   256, Elapsed time =   0.008137 s, Result = d4108000, Performance =   2.64 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008398 s, Result = a41d0000, Performance =   5.11 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008642 s, Result = 74298000, Performance =   7.46 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009299 s, Result = 44360000, Performance =   9.24 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009668 s, Result = 14428000, Performance =  11.11 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010238 s, Result = e44f0000, Performance =  12.59 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014422 s, Result = b45b8000, Performance =  10.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012056 s, Result = 84680000, Performance =  14.25 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012815 s, Result = 54748000, Performance =  15.08 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013720 s, Result = 24810000, Performance =  15.65 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015097 s, Result = f48d8000, Performance =  15.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015485 s, Result = c49a0000, Performance =  16.64 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016477 s, Result = 94a68000, Performance =  16.94 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017541 s, Result = 64b30000, Performance =  17.14 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018718 s, Result = 34bf8000, Performance =  17.21 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019537 s, Result = 04cc0000, Performance =  17.59 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.020580 s, Result = d4d88000, Performance =  17.74 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021558 s, Result = a4e50000, Performance =  17.93 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022746 s, Result = 74f18000, Performance =  17.94 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023109 s, Result = 44fe0000, Performance =  18.59 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024464 s, Result = 150a8000, Performance =  18.43 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024508 s, Result = e5170000, Performance =  19.28 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.026163 s, Result = b5238000, Performance =  18.88 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026118 s, Result = 85300000, Performance =  19.73 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.027093 s, Result = 553c8000, Performance =  19.82 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028256 s, Result = 25490000, Performance =  19.76 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029230 s, Result = f5558000, Performance =  19.84 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.029756 s, Result = c5620000, Performance =  20.21 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031072 s, Result = 956e8000, Performance =  20.04 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031066 s, Result = 657b0000, Performance =  20.74 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.032598 s, Result = 35878000, Performance =  20.42 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.032699 s, Result = 05940000, Performance =  21.02 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.034412 s, Result = d5a08000, Performance =  20.59 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.033929 s, Result = a5ad0000, Performance =  21.52 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.035899 s, Result = 75b98000, Performance =  20.94 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035761 s, Result = 45c60000, Performance =  21.62 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.036883 s, Result = 15d28000, Performance =  21.54 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.037950 s, Result = e5df0000, Performance =  21.50 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.039554 s, Result = b5eb8000, Performance =  21.17 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.038789 s, Result = 85f80000, Performance =  22.15 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.040919 s, Result = 56048000, Performance =  21.52 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.041198 s, Result = 26110000, Performance =  21.89 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.042408 s, Result = f61d8000, Performance =  21.77 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.042626 s, Result = c62a0000, Performance =  22.17 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.043993 s, Result = 96368000, Performance =  21.97 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.044650 s, Result = 66430000, Performance =  22.12 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.045751 s, Result = 364f8000, Performance =  22.06 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.045631 s, Result = 065c0000, Performance =  22.59 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.046960 s, Result = d6688000, Performance =  22.41 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047876 s, Result = a6750000, Performance =  22.43 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.049113 s, Result = 76818000, Performance =  22.30 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048746 s, Result = 468e0000, Performance =  22.91 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.050836 s, Result = 169a8000, Performance =  22.39 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.051507 s, Result = e6a70000, Performance =  22.51 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.052786 s, Result = b6b38000, Performance =  22.38 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.054014 s, Result = 86c00000, Performance =  22.26 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054250 s, Result = 56cc8000, Performance =  22.56 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.054921 s, Result = 26d90000, Performance =  22.68 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.056072 s, Result = f6e58000, Performance =  22.60 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056064 s, Result = c6f20000, Performance =  22.98 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.057330 s, Result = 96fe8000, Performance =  22.85 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.057691 s, Result = 670b0000, Performance =  23.08 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.059013 s, Result = 37178000, Performance =  22.93 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.057931 s, Result = 07240000, Performance =  23.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   532   345   896
Test passed: M N K =  1316  1783  1408
Test passed: M N K =    32  1755  1408
Test passed: M N K =  2023   510  1216
Test passed: M N K =  1932  1936  1600
M N K =  2048  2048   256, Elapsed time =   0.005731 s, Result = 000c8000, Performance =   3.75 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006879 s, Result = 00190000, Performance =   6.24 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007144 s, Result = 00258000, Performance =   9.02 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007978 s, Result = 00320000, Performance =  10.77 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008265 s, Result = 003e8000, Performance =  12.99 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008645 s, Result = 004b0000, Performance =  14.90 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009351 s, Result = 00578000, Performance =  16.08 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010090 s, Result = 00640000, Performance =  17.03 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010722 s, Result = 00708000, Performance =  18.03 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016114 s, Result = 007d0000, Performance =  13.33 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012934 s, Result = 00898000, Performance =  18.26 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013896 s, Result = 00960000, Performance =  18.54 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014549 s, Result = 00a28000, Performance =  19.19 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015606 s, Result = 00af0000, Performance =  19.26 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016839 s, Result = 00bb8000, Performance =  19.13 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017557 s, Result = 00c80000, Performance =  19.57 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019148 s, Result = 00d48000, Performance =  19.07 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019543 s, Result = 00e10000, Performance =  19.78 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021204 s, Result = 00ed8000, Performance =  19.24 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021533 s, Result = 00fa0000, Performance =  19.95 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022608 s, Result = 01068000, Performance =  19.95 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022801 s, Result = 01130000, Performance =  20.72 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.024284 s, Result = 011f8000, Performance =  20.34 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.023946 s, Result = 012c0000, Performance =  21.52 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.025649 s, Result = 01388000, Performance =  20.93 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026296 s, Result = 01450000, Performance =  21.23 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027634 s, Result = 01518000, Performance =  20.98 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028043 s, Result = 015e0000, Performance =  21.44 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.028842 s, Result = 016a8000, Performance =  21.59 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029531 s, Result = 01770000, Performance =  21.82 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030407 s, Result = 01838000, Performance =  21.89 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030538 s, Result = 01900000, Performance =  22.50 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.031947 s, Result = 019c8000, Performance =  22.18 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032454 s, Result = 01a90000, Performance =  22.50 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.033295 s, Result = 01b58000, Performance =  22.57 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.033384 s, Result = 01c20000, Performance =  23.16 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035103 s, Result = 01ce8000, Performance =  22.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.035310 s, Result = 01db0000, Performance =  23.11 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037029 s, Result = 01e78000, Performance =  22.62 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036606 s, Result = 01f40000, Performance =  23.47 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.038427 s, Result = 02008000, Performance =  22.91 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039040 s, Result = 020d0000, Performance =  23.10 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040682 s, Result = 02198000, Performance =  22.70 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.040639 s, Result = 02260000, Performance =  23.25 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.041479 s, Result = 02328000, Performance =  23.30 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042156 s, Result = 023f0000, Performance =  23.43 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.043169 s, Result = 024b8000, Performance =  23.38 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043147 s, Result = 02580000, Performance =  23.89 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.045242 s, Result = 02648000, Performance =  23.26 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.045546 s, Result = 02710000, Performance =  23.57 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.046729 s, Result = 027d8000, Performance =  23.44 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.047121 s, Result = 028a0000, Performance =  23.70 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.050956 s, Result = 02968000, Performance =  22.34 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049411 s, Result = 02a30000, Performance =  23.47 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050735 s, Result = 02af8000, Performance =  23.28 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.049719 s, Result = 02bc0000, Performance =  24.19 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.051891 s, Result = 02c88000, Performance =  23.59 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052898 s, Result = 02d50000, Performance =  23.55 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.054373 s, Result = 02e18000, Performance =  23.30 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.053641 s, Result = 02ee0000, Performance =  24.02 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.055202 s, Result = 02fa8000, Performance =  23.73 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.056201 s, Result = 03070000, Performance =  23.69 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.056797 s, Result = 03138000, Performance =  23.82 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.055730 s, Result = 03200000, Performance =  24.66 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1157  1198   384
Test passed: M N K =   512    44   960
Test passed: M N K =     4   639  1728
Test passed: M N K =  1865   875  1856
Test passed: M N K =   876   142  1664
M N K =  2048  2048   256, Elapsed time =   0.003620 s, Result = 28348000, Performance =   5.93 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004098 s, Result = 28410000, Performance =  10.48 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004626 s, Result = 284d8000, Performance =  13.93 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004993 s, Result = 285a0000, Performance =  17.21 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005600 s, Result = 28668000, Performance =  19.17 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006271 s, Result = 28730000, Performance =  20.55 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007124 s, Result = 287f8000, Performance =  21.10 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008123 s, Result = 288c0000, Performance =  21.15 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008807 s, Result = 28988000, Performance =  21.95 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014101 s, Result = 28a50000, Performance =  15.23 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011177 s, Result = 28b18000, Performance =  21.14 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012176 s, Result = 28be0000, Performance =  21.16 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012976 s, Result = 28ca8000, Performance =  21.51 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014222 s, Result = 28d70000, Performance =  21.14 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014991 s, Result = 28e38000, Performance =  21.49 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015872 s, Result = 28f00000, Performance =  21.65 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016108 s, Result = 28fc8000, Performance =  22.66 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017437 s, Result = 29090000, Performance =  22.17 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018583 s, Result = 29158000, Performance =  21.96 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018920 s, Result = 29220000, Performance =  22.70 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019856 s, Result = 292e8000, Performance =  22.71 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020510 s, Result = 293b0000, Performance =  23.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022128 s, Result = 29478000, Performance =  22.32 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021304 s, Result = 29540000, Performance =  24.19 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023091 s, Result = 29608000, Performance =  23.25 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024164 s, Result = 296d0000, Performance =  23.11 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025446 s, Result = 29798000, Performance =  22.79 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.025885 s, Result = 29860000, Performance =  23.23 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025953 s, Result = 29928000, Performance =  24.00 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.027557 s, Result = 299f0000, Performance =  23.38 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028911 s, Result = 29ab8000, Performance =  23.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.027690 s, Result = 29b80000, Performance =  24.82 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030138 s, Result = 29c48000, Performance =  23.51 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.030023 s, Result = 29d10000, Performance =  24.32 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.031662 s, Result = 29dd8000, Performance =  23.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.031888 s, Result = 29ea0000, Performance =  24.24 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.033252 s, Result = 29f68000, Performance =  23.90 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.034194 s, Result = 2a030000, Performance =  23.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.035201 s, Result = 2a0f8000, Performance =  23.79 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.034411 s, Result = 2a1c0000, Performance =  24.96 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.036628 s, Result = 2a288000, Performance =  24.04 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.037321 s, Result = 2a350000, Performance =  24.17 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.038697 s, Result = 2a418000, Performance =  23.86 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.038290 s, Result = 2a4e0000, Performance =  24.68 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.039869 s, Result = 2a5a8000, Performance =  24.24 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.040656 s, Result = 2a670000, Performance =  24.30 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.041535 s, Result = 2a738000, Performance =  24.30 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041962 s, Result = 2a800000, Performance =  24.56 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.042905 s, Result = 2a8c8000, Performance =  24.53 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043581 s, Result = 2a990000, Performance =  24.64 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.045142 s, Result = 2aa58000, Performance =  24.26 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045139 s, Result = 2ab20000, Performance =  24.74 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.046694 s, Result = 2abe8000, Performance =  24.37 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.047672 s, Result = 2acb0000, Performance =  24.33 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.048621 s, Result = 2ad78000, Performance =  24.29 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047534 s, Result = 2ae40000, Performance =  25.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.050117 s, Result = 2af08000, Performance =  24.42 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.050607 s, Result = 2afd0000, Performance =  24.61 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052295 s, Result = 2b098000, Performance =  24.23 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.051927 s, Result = 2b160000, Performance =  24.81 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.052495 s, Result = 2b228000, Performance =  24.95 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.053197 s, Result = 2b2f0000, Performance =  25.03 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.054286 s, Result = 2b3b8000, Performance =  24.92 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.054153 s, Result = 2b480000, Performance =  25.38 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   981  1110  1024
Test passed: M N K =  1886  1764   832
Test passed: M N K =   394   578   256
Test passed: M N K =  1509  1256  1664
Test passed: M N K =  2016   209   832
M N K =  2048  2048   256, Elapsed time =   0.000579 s, Result = 000c8000, Performance =  37.09 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001020 s, Result = 00190000, Performance =  42.10 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001544 s, Result = 00258000, Performance =  41.74 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.002130 s, Result = 00320000, Performance =  40.33 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002961 s, Result = 003e8000, Performance =  36.27 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003257 s, Result = 004b0000, Performance =  39.56 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003846 s, Result = 00578000, Performance =  39.09 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005194 s, Result = 00640000, Performance =  33.07 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009367 s, Result = 00708000, Performance =  20.63 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007366 s, Result = 007d0000, Performance =  29.16 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008398 s, Result = 00898000, Performance =  28.13 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009526 s, Result = 00960000, Performance =  27.05 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009960 s, Result = 00a28000, Performance =  28.03 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011210 s, Result = 00af0000, Performance =  26.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012548 s, Result = 00bb8000, Performance =  25.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012990 s, Result = 00c80000, Performance =  26.45 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013950 s, Result = 00d48000, Performance =  26.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014747 s, Result = 00e10000, Performance =  26.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016114 s, Result = 00ed8000, Performance =  25.32 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016589 s, Result = 00fa0000, Performance =  25.89 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017648 s, Result = 01068000, Performance =  25.55 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017795 s, Result = 01130000, Performance =  26.55 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019222 s, Result = 011f8000, Performance =  25.70 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019076 s, Result = 012c0000, Performance =  27.02 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020777 s, Result = 01388000, Performance =  25.84 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.021185 s, Result = 01450000, Performance =  26.36 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022537 s, Result = 01518000, Performance =  25.73 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022798 s, Result = 015e0000, Performance =  26.38 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.023928 s, Result = 016a8000, Performance =  26.03 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.024585 s, Result = 01770000, Performance =  26.21 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.025706 s, Result = 01838000, Performance =  25.90 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.025010 s, Result = 01900000, Performance =  27.48 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.026932 s, Result = 019c8000, Performance =  26.31 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.027839 s, Result = 01a90000, Performance =  26.23 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.029278 s, Result = 01b58000, Performance =  25.67 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.028999 s, Result = 01c20000, Performance =  26.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.030707 s, Result = 01ce8000, Performance =  25.88 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.031493 s, Result = 01db0000, Performance =  25.91 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.033061 s, Result = 01e78000, Performance =  25.33 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032515 s, Result = 01f40000, Performance =  26.42 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.033851 s, Result = 02008000, Performance =  26.01 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.034718 s, Result = 020d0000, Performance =  25.98 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.036107 s, Result = 02198000, Performance =  25.57 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.035531 s, Result = 02260000, Performance =  26.59 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.037073 s, Result = 02328000, Performance =  26.07 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.037884 s, Result = 023f0000, Performance =  26.08 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.039006 s, Result = 024b8000, Performance =  25.88 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.038739 s, Result = 02580000, Performance =  26.61 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039915 s, Result = 02648000, Performance =  26.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.041050 s, Result = 02710000, Performance =  26.16 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.041811 s, Result = 027d8000, Performance =  26.19 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.042276 s, Result = 028a0000, Performance =  26.41 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.043414 s, Result = 02968000, Performance =  26.22 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.044405 s, Result = 02a30000, Performance =  26.11 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.045351 s, Result = 02af8000, Performance =  26.04 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.045054 s, Result = 02bc0000, Performance =  26.69 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.047147 s, Result = 02c88000, Performance =  25.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.047878 s, Result = 02d50000, Performance =  26.01 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.048833 s, Result = 02e18000, Performance =  25.95 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048307 s, Result = 02ee0000, Performance =  26.67 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.050219 s, Result = 02fa8000, Performance =  26.09 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.050803 s, Result = 03070000, Performance =  26.21 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.051773 s, Result = 03138000, Performance =  26.13 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.051219 s, Result = 03200000, Performance =  26.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   508    79   384
Test passed: M N K =   714    97   512
Test passed: M N K =   547   977  1216
Test passed: M N K =   863    57   768
Test passed: M N K =  2012   137   128
M N K =  2048  2048   256, Elapsed time =   0.007673 s, Result = 640b8000, Performance =   2.80 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007988 s, Result = c4130000, Performance =   5.38 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007537 s, Result = 241a8000, Performance =   8.55 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007993 s, Result = 84220000, Performance =  10.75 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008349 s, Result = e4298000, Performance =  12.86 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008916 s, Result = 44310000, Performance =  14.45 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009185 s, Result = a4388000, Performance =  16.37 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013386 s, Result = 04400000, Performance =  12.83 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010134 s, Result = 64478000, Performance =  19.07 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010719 s, Result = c44f0000, Performance =  20.03 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011194 s, Result = 24568000, Performance =  21.10 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011755 s, Result = 845e0000, Performance =  21.92 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012229 s, Result = e4658000, Performance =  22.83 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012789 s, Result = 446d0000, Performance =  23.51 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012998 s, Result = a4748000, Performance =  24.78 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013352 s, Result = 047c0000, Performance =  25.73 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014275 s, Result = 64838000, Performance =  25.57 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014522 s, Result = c48b0000, Performance =  26.62 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015322 s, Result = 24928000, Performance =  26.63 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015287 s, Result = 849a0000, Performance =  28.09 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015598 s, Result = e4a18000, Performance =  28.91 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016068 s, Result = 44a90000, Performance =  29.40 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016510 s, Result = a4b08000, Performance =  29.92 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016521 s, Result = 04b80000, Performance =  31.20 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017341 s, Result = 64bf8000, Performance =  30.96 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017737 s, Result = c4c70000, Performance =  31.48 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018193 s, Result = 24ce8000, Performance =  31.87 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.019471 s, Result = 84d60000, Performance =  30.88 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018781 s, Result = e4dd8000, Performance =  33.16 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019010 s, Result = 44e50000, Performance =  33.89 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019608 s, Result = a4ec8000, Performance =  33.95 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.021742 s, Result = 04f40000, Performance =  31.61 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.020713 s, Result = 64fb8000, Performance =  34.21 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020197 s, Result = c5030000, Performance =  36.15 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.020504 s, Result = 250a8000, Performance =  36.66 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.020586 s, Result = 85120000, Performance =  37.55 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021244 s, Result = e5198000, Performance =  37.40 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.021821 s, Result = 45210000, Performance =  37.40 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.022653 s, Result = a5288000, Performance =  36.97 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022949 s, Result = 05300000, Performance =  37.43 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.022982 s, Result = 65378000, Performance =  38.31 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.023193 s, Result = c53f0000, Performance =  38.89 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.023937 s, Result = 25468000, Performance =  38.58 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.024030 s, Result = 854e0000, Performance =  39.32 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.024518 s, Result = e5558000, Performance =  39.42 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.025128 s, Result = 455d0000, Performance =  39.31 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.025778 s, Result = a5648000, Performance =  39.15 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.026563 s, Result = 056c0000, Performance =  38.81 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.027216 s, Result = 65738000, Performance =  38.66 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.027189 s, Result = c57b0000, Performance =  39.49 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.027600 s, Result = 25828000, Performance =  39.68 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.027568 s, Result = 858a0000, Performance =  40.51 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.028419 s, Result = e5918000, Performance =  40.05 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.028957 s, Result = 45990000, Performance =  40.05 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.029258 s, Result = a5a08000, Performance =  40.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.030099 s, Result = 05a80000, Performance =  39.95 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.030195 s, Result = 65af8000, Performance =  40.54 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.031067 s, Result = c5b70000, Performance =  40.09 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.030900 s, Result = 25be8000, Performance =  41.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.031171 s, Result = 85c60000, Performance =  41.34 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.034997 s, Result = e5cd8000, Performance =  37.43 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.032159 s, Result = 45d50000, Performance =  41.40 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.033501 s, Result = a5dc8000, Performance =  40.38 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034253 s, Result = 05e40000, Performance =  40.13 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   761  1985   320
Test passed: M N K =   578    44  1152
Test passed: M N K =  1671  1908   704
Test passed: M N K =   111  1404  1216
Test passed: M N K =  1595  1953  1600
M N K =  2048  2048   256, Elapsed time =   0.004417 s, Result = 00078000, Performance =   4.86 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006068 s, Result = 000f0000, Performance =   7.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006839 s, Result = 00168000, Performance =   9.42 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006531 s, Result = 001e0000, Performance =  13.15 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006918 s, Result = 00258000, Performance =  15.52 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007310 s, Result = 002d0000, Performance =  17.63 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007670 s, Result = 00348000, Performance =  19.60 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008232 s, Result = 003c0000, Performance =  20.87 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008049 s, Result = 00438000, Performance =  24.01 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012561 s, Result = 004b0000, Performance =  17.10 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009274 s, Result = 00528000, Performance =  25.47 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009817 s, Result = 005a0000, Performance =  26.25 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010154 s, Result = 00618000, Performance =  27.50 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010900 s, Result = 00690000, Performance =  27.58 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010980 s, Result = 00708000, Performance =  29.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011588 s, Result = 00780000, Performance =  29.65 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012053 s, Result = 007f8000, Performance =  30.29 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011857 s, Result = 00870000, Performance =  32.60 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012631 s, Result = 008e8000, Performance =  32.30 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012960 s, Result = 00960000, Performance =  33.14 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012925 s, Result = 009d8000, Performance =  34.89 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013174 s, Result = 00a50000, Performance =  35.86 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014338 s, Result = 00ac8000, Performance =  34.45 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014123 s, Result = 00b40000, Performance =  36.49 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014769 s, Result = 00bb8000, Performance =  36.35 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015524 s, Result = 00c30000, Performance =  35.97 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.015692 s, Result = 00ca8000, Performance =  36.95 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.015967 s, Result = 00d20000, Performance =  37.66 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.016293 s, Result = 00d98000, Performance =  38.22 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016511 s, Result = 00e10000, Performance =  39.02 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016925 s, Result = 00e88000, Performance =  39.33 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018214 s, Result = 00f00000, Performance =  37.73 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.018471 s, Result = 00f78000, Performance =  38.37 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.018257 s, Result = 00ff0000, Performance =  39.99 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.018641 s, Result = 01068000, Performance =  40.32 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.018483 s, Result = 010e0000, Performance =  41.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.019529 s, Result = 01158000, Performance =  40.69 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.019689 s, Result = 011d0000, Performance =  41.45 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.020399 s, Result = 01248000, Performance =  41.06 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.020764 s, Result = 012c0000, Performance =  41.37 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.021074 s, Result = 01338000, Performance =  41.78 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.021359 s, Result = 013b0000, Performance =  42.23 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.022213 s, Result = 01428000, Performance =  41.57 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.021977 s, Result = 014a0000, Performance =  43.00 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.022989 s, Result = 01518000, Performance =  42.04 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.023301 s, Result = 01590000, Performance =  42.39 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.023634 s, Result = 01608000, Performance =  42.71 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.024019 s, Result = 01680000, Performance =  42.92 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024999 s, Result = 016f8000, Performance =  42.09 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.024884 s, Result = 01770000, Performance =  43.15 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.027261 s, Result = 017e8000, Performance =  40.17 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026003 s, Result = 01860000, Performance =  42.94 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.026470 s, Result = 018d8000, Performance =  43.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.027393 s, Result = 01950000, Performance =  42.33 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.028207 s, Result = 019c8000, Performance =  41.87 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.027574 s, Result = 01a40000, Performance =  43.61 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.029039 s, Result = 01ab8000, Performance =  42.15 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.029703 s, Result = 01b30000, Performance =  41.93 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.029562 s, Result = 01ba8000, Performance =  42.86 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.029565 s, Result = 01c20000, Performance =  43.58 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.030534 s, Result = 01c98000, Performance =  42.90 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.030328 s, Result = 01d10000, Performance =  43.90 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.031942 s, Result = 01d88000, Performance =  42.35 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.032499 s, Result = 01e00000, Performance =  42.29 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    66   658    64
Test passed: M N K =   462   419   448
Test passed: M N K =  1340  1249  1728
Test passed: M N K =   376  1861  1600
Test passed: M N K =  1853   600   192
M N K =  2048  2048   256, Elapsed time =   0.003444 s, Result = 282f8000, Performance =   6.23 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003921 s, Result = 28370000, Performance =  10.95 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004190 s, Result = 283e8000, Performance =  15.38 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004552 s, Result = 28460000, Performance =  18.87 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004791 s, Result = 284d8000, Performance =  22.41 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005227 s, Result = 28550000, Performance =  24.65 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005639 s, Result = 285c8000, Performance =  26.66 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006113 s, Result = 28640000, Performance =  28.11 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006503 s, Result = 286b8000, Performance =  29.72 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007029 s, Result = 28730000, Performance =  30.55 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007384 s, Result = 287a8000, Performance =  31.99 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008362 s, Result = 28820000, Performance =  30.82 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008381 s, Result = 28898000, Performance =  33.31 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009187 s, Result = 28910000, Performance =  32.73 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009664 s, Result = 28988000, Performance =  33.33 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.009900 s, Result = 28a00000, Performance =  34.71 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009566 s, Result = 28a78000, Performance =  38.16 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009937 s, Result = 28af0000, Performance =  38.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010564 s, Result = 28b68000, Performance =  38.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010940 s, Result = 28be0000, Performance =  39.26 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011339 s, Result = 28c58000, Performance =  39.77 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011503 s, Result = 28cd0000, Performance =  41.07 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012583 s, Result = 28d48000, Performance =  39.25 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012455 s, Result = 28dc0000, Performance =  41.38 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.013542 s, Result = 28e38000, Performance =  39.65 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013188 s, Result = 28eb0000, Performance =  42.34 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014485 s, Result = 28f28000, Performance =  40.03 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.013911 s, Result = 28fa0000, Performance =  43.22 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014725 s, Result = 29018000, Performance =  42.29 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015466 s, Result = 29090000, Performance =  41.65 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015714 s, Result = 29108000, Performance =  42.36 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.017043 s, Result = 29180000, Performance =  40.32 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016542 s, Result = 291f8000, Performance =  42.84 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.016950 s, Result = 29270000, Performance =  43.08 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.016939 s, Result = 292e8000, Performance =  44.37 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017464 s, Result = 29360000, Performance =  44.27 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.017603 s, Result = 293d8000, Performance =  45.14 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018260 s, Result = 29450000, Performance =  44.69 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.018846 s, Result = 294c8000, Performance =  44.44 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.019211 s, Result = 29540000, Performance =  44.71 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019973 s, Result = 295b8000, Performance =  44.08 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.019680 s, Result = 29630000, Performance =  45.83 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.020967 s, Result = 296a8000, Performance =  44.04 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.020859 s, Result = 29720000, Performance =  45.30 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021883 s, Result = 29798000, Performance =  44.16 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.021316 s, Result = 29810000, Performance =  46.34 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.021897 s, Result = 29888000, Performance =  46.09 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.022852 s, Result = 29900000, Performance =  45.11 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.023207 s, Result = 29978000, Performance =  45.34 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023487 s, Result = 299f0000, Performance =  45.72 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.023613 s, Result = 29a68000, Performance =  46.38 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.023872 s, Result = 29ae0000, Performance =  46.78 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.025106 s, Result = 29b58000, Performance =  45.33 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025829 s, Result = 29bd0000, Performance =  44.90 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025885 s, Result = 29c48000, Performance =  45.63 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.026181 s, Result = 29cc0000, Performance =  45.93 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026559 s, Result = 29d38000, Performance =  46.09 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.028190 s, Result = 29db0000, Performance =  44.18 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.028565 s, Result = 29e28000, Performance =  44.36 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.027643 s, Result = 29ea0000, Performance =  46.61 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.028396 s, Result = 29f18000, Performance =  46.13 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.028708 s, Result = 29f90000, Performance =  46.38 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.029541 s, Result = 2a008000, Performance =  45.80 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.030502 s, Result = 2a080000, Performance =  45.06 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   273  1815  1280
Test passed: M N K =  1563  1127  1856
Test passed: M N K =   680   863   640
Test passed: M N K =  1439   201  1600
Test passed: M N K =  1630  1449   320
M N K =  2048  2048   256, Elapsed time =   0.000419 s, Result = 00078000, Performance =  51.20 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000818 s, Result = 000f0000, Performance =  52.51 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001166 s, Result = 00168000, Performance =  55.23 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001511 s, Result = 001e0000, Performance =  56.86 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001889 s, Result = 00258000, Performance =  56.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002202 s, Result = 002d0000, Performance =  58.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002688 s, Result = 00348000, Performance =  55.92 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003238 s, Result = 003c0000, Performance =  53.06 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003418 s, Result = 00438000, Performance =  56.55 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005385 s, Result = 004b0000, Performance =  39.88 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.004571 s, Result = 00528000, Performance =  51.68 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.005279 s, Result = 005a0000, Performance =  48.82 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.005877 s, Result = 00618000, Performance =  47.50 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.006279 s, Result = 00690000, Performance =  47.88 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.007133 s, Result = 00708000, Performance =  45.16 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.007156 s, Result = 00780000, Performance =  48.02 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.006582 s, Result = 007f8000, Performance =  55.46 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.007423 s, Result = 00870000, Performance =  52.07 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.008205 s, Result = 008e8000, Performance =  49.73 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.008331 s, Result = 00960000, Performance =  51.55 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.008420 s, Result = 009d8000, Performance =  53.56 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.008873 s, Result = 00a50000, Performance =  53.25 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.009513 s, Result = 00ac8000, Performance =  51.92 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.009613 s, Result = 00b40000, Performance =  53.62 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.010187 s, Result = 00bb8000, Performance =  52.70 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.010349 s, Result = 00c30000, Performance =  53.95 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.011262 s, Result = 00ca8000, Performance =  51.49 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.010666 s, Result = 00d20000, Performance =  56.38 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.012321 s, Result = 00d98000, Performance =  50.55 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012650 s, Result = 00e10000, Performance =  50.93 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.012318 s, Result = 00e88000, Performance =  54.04 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.013068 s, Result = 00f00000, Performance =  52.59 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.012810 s, Result = 00f78000, Performance =  55.32 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.014261 s, Result = 00ff0000, Performance =  51.20 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.015027 s, Result = 01068000, Performance =  50.02 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.014135 s, Result = 010e0000, Performance =  54.69 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.014674 s, Result = 01158000, Performance =  54.15 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.014912 s, Result = 011d0000, Performance =  54.72 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.015765 s, Result = 01248000, Performance =  53.12 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.016539 s, Result = 012c0000, Performance =  51.94 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.016677 s, Result = 01338000, Performance =  52.79 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017256 s, Result = 013b0000, Performance =  52.27 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.017455 s, Result = 01428000, Performance =  52.90 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.017422 s, Result = 014a0000, Performance =  54.24 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.018459 s, Result = 01518000, Performance =  52.35 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.018643 s, Result = 01590000, Performance =  52.99 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.019698 s, Result = 01608000, Performance =  51.24 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.019235 s, Result = 01680000, Performance =  53.59 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020707 s, Result = 016f8000, Performance =  50.82 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.020463 s, Result = 01770000, Performance =  52.47 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.020719 s, Result = 017e8000, Performance =  52.86 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.020908 s, Result = 01860000, Performance =  53.41 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.022122 s, Result = 018d8000, Performance =  51.45 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022034 s, Result = 01950000, Performance =  52.63 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.022791 s, Result = 019c8000, Performance =  51.82 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.022533 s, Result = 01a40000, Performance =  53.37 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023658 s, Result = 01ab8000, Performance =  51.74 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.025083 s, Result = 01b30000, Performance =  49.66 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.025024 s, Result = 01ba8000, Performance =  50.63 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024944 s, Result = 01c20000, Performance =  51.65 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.025575 s, Result = 01c98000, Performance =  51.22 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.026209 s, Result = 01d10000, Performance =  50.80 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.026211 s, Result = 01d88000, Performance =  51.62 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.027679 s, Result = 01e00000, Performance =  49.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1975  1513    64
Test passed: M N K =  1562  1500  2048
Test passed: M N K =  1489  2020   768
Test passed: M N K =  1940  1406  1216
Test passed: M N K =  1463  1483   128
M N K =  2048  2048   256, Elapsed time =   0.007447 s, Result = 640b8000, Performance =   2.88 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007620 s, Result = c4130000, Performance =   5.64 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007499 s, Result = 241a8000, Performance =   8.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007860 s, Result = 84220000, Performance =  10.93 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008251 s, Result = e4298000, Performance =  13.01 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008826 s, Result = 44310000, Performance =  14.60 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009507 s, Result = a4388000, Performance =  15.81 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009808 s, Result = 04400000, Performance =  17.52 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014672 s, Result = 64478000, Performance =  13.17 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011100 s, Result = c44f0000, Performance =  19.35 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011520 s, Result = 24568000, Performance =  20.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012304 s, Result = 845e0000, Performance =  20.95 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012424 s, Result = e4658000, Performance =  22.47 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012920 s, Result = 446d0000, Performance =  23.27 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013287 s, Result = a4748000, Performance =  24.24 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014526 s, Result = 047c0000, Performance =  23.65 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014024 s, Result = 64838000, Performance =  26.03 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014742 s, Result = c48b0000, Performance =  26.22 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014580 s, Result = 24928000, Performance =  27.99 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015058 s, Result = 849a0000, Performance =  28.52 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015562 s, Result = e4a18000, Performance =  28.98 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015991 s, Result = 44a90000, Performance =  29.54 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016548 s, Result = a4b08000, Performance =  29.85 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017333 s, Result = 04b80000, Performance =  29.73 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017013 s, Result = 64bf8000, Performance =  31.56 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.018432 s, Result = c4c70000, Performance =  30.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017600 s, Result = 24ce8000, Performance =  32.94 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018726 s, Result = 84d60000, Performance =  32.11 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.018532 s, Result = e4dd8000, Performance =  33.61 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.019452 s, Result = 44e50000, Performance =  33.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.019189 s, Result = a4ec8000, Performance =  34.69 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022591 s, Result = 04f40000, Performance =  30.42 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021025 s, Result = 64fb8000, Performance =  33.71 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.020245 s, Result = c5030000, Performance =  36.06 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.020448 s, Result = 250a8000, Performance =  36.76 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.020461 s, Result = 85120000, Performance =  37.78 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021453 s, Result = e5198000, Performance =  37.04 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.021615 s, Result = 45210000, Performance =  37.75 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.022511 s, Result = a5288000, Performance =  37.21 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.024080 s, Result = 05300000, Performance =  35.67 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.022759 s, Result = 65378000, Performance =  38.69 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.023520 s, Result = c53f0000, Performance =  38.35 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.023484 s, Result = 25468000, Performance =  39.32 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.023340 s, Result = 854e0000, Performance =  40.48 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.024517 s, Result = e5558000, Performance =  39.42 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.024971 s, Result = 455d0000, Performance =  39.56 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.025671 s, Result = a5648000, Performance =  39.32 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.029491 s, Result = 056c0000, Performance =  34.95 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.025963 s, Result = 65738000, Performance =  40.53 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.026684 s, Result = c57b0000, Performance =  40.24 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.027217 s, Result = 25828000, Performance =  40.24 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026956 s, Result = 858a0000, Performance =  41.43 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.027701 s, Result = e5918000, Performance =  41.09 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.028258 s, Result = 45990000, Performance =  41.04 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.028926 s, Result = a5a08000, Performance =  40.83 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.031465 s, Result = 05a80000, Performance =  38.22 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.029223 s, Result = 65af8000, Performance =  41.89 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.030285 s, Result = c5b70000, Performance =  41.13 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.030739 s, Result = 25be8000, Performance =  41.22 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.031300 s, Result = 85c60000, Performance =  41.17 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.031766 s, Result = e5cd8000, Performance =  41.24 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.031625 s, Result = 45d50000, Performance =  42.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.031889 s, Result = a5dc8000, Performance =  42.43 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.037307 s, Result = 05e40000, Performance =  36.84 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1325  1452  1216
Test passed: M N K =  1093  1759   640
Test passed: M N K =  2005  1184  1984
Test passed: M N K =  1184  1376   896
Test passed: M N K =  1862   802  1728
M N K =  2048  2048   256, Elapsed time =   0.005221 s, Result = 00078000, Performance =   4.11 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005807 s, Result = 000f0000, Performance =   7.40 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006174 s, Result = 00168000, Performance =  10.43 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006517 s, Result = 001e0000, Performance =  13.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007151 s, Result = 00258000, Performance =  15.02 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007733 s, Result = 002d0000, Performance =  16.66 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007952 s, Result = 00348000, Performance =  18.90 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008527 s, Result = 003c0000, Performance =  20.15 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009152 s, Result = 00438000, Performance =  21.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013222 s, Result = 004b0000, Performance =  16.24 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010244 s, Result = 00528000, Performance =  23.06 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010872 s, Result = 005a0000, Performance =  23.70 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011209 s, Result = 00618000, Performance =  24.91 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011398 s, Result = 00690000, Performance =  26.38 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011568 s, Result = 00708000, Performance =  27.85 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013067 s, Result = 00780000, Performance =  26.30 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012118 s, Result = 007f8000, Performance =  30.13 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013190 s, Result = 00870000, Performance =  29.31 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013148 s, Result = 008e8000, Performance =  31.03 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012798 s, Result = 00960000, Performance =  33.56 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013641 s, Result = 009d8000, Performance =  33.06 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013804 s, Result = 00a50000, Performance =  34.23 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014217 s, Result = 00ac8000, Performance =  34.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.015791 s, Result = 00b40000, Performance =  32.64 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015183 s, Result = 00bb8000, Performance =  35.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015487 s, Result = 00c30000, Performance =  36.05 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016249 s, Result = 00ca8000, Performance =  35.68 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.016179 s, Result = 00d20000, Performance =  37.17 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017274 s, Result = 00d98000, Performance =  36.05 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016944 s, Result = 00e10000, Performance =  38.02 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018062 s, Result = 00e88000, Performance =  36.86 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.020335 s, Result = 00f00000, Performance =  33.79 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.018133 s, Result = 00f78000, Performance =  39.08 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.019164 s, Result = 00ff0000, Performance =  38.10 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.018687 s, Result = 01068000, Performance =  40.22 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.018589 s, Result = 010e0000, Performance =  41.59 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.019201 s, Result = 01158000, Performance =  41.38 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.020314 s, Result = 011d0000, Performance =  40.17 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.020751 s, Result = 01248000, Performance =  40.36 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022844 s, Result = 012c0000, Performance =  37.60 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.021289 s, Result = 01338000, Performance =  41.36 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.021538 s, Result = 013b0000, Performance =  41.88 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.022095 s, Result = 01428000, Performance =  41.79 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.022281 s, Result = 014a0000, Performance =  42.41 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.022847 s, Result = 01518000, Performance =  42.30 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.023481 s, Result = 01590000, Performance =  42.07 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.023585 s, Result = 01608000, Performance =  42.79 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028286 s, Result = 01680000, Performance =  36.44 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.024304 s, Result = 016f8000, Performance =  43.30 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.025171 s, Result = 01770000, Performance =  42.66 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.025396 s, Result = 017e8000, Performance =  43.13 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.025841 s, Result = 01860000, Performance =  43.21 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.026391 s, Result = 018d8000, Performance =  43.13 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.026849 s, Result = 01950000, Performance =  43.19 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.026991 s, Result = 019c8000, Performance =  43.76 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.030073 s, Result = 01a40000, Performance =  39.99 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.027758 s, Result = 01ab8000, Performance =  44.10 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.028533 s, Result = 01b30000, Performance =  43.65 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.028732 s, Result = 01ba8000, Performance =  44.10 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.028955 s, Result = 01c20000, Performance =  44.50 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.029658 s, Result = 01c98000, Performance =  44.17 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.030922 s, Result = 01d10000, Performance =  43.06 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.030315 s, Result = 01d88000, Performance =  44.63 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.036434 s, Result = 01e00000, Performance =  37.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1406  1587   640
Test passed: M N K =   913   571  1152
Test passed: M N K =   256  1070  1920
Test passed: M N K =   165   837  1024
Test passed: M N K =   611   876  1152
M N K =  2048  2048   256, Elapsed time =   0.003223 s, Result = 282f8000, Performance =   6.66 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003892 s, Result = 28370000, Performance =  11.04 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004187 s, Result = 283e8000, Performance =  15.39 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004466 s, Result = 28460000, Performance =  19.23 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004839 s, Result = 284d8000, Performance =  22.19 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005252 s, Result = 28550000, Performance =  24.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005803 s, Result = 285c8000, Performance =  25.91 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006583 s, Result = 28640000, Performance =  26.10 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006782 s, Result = 286b8000, Performance =  28.50 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011671 s, Result = 28730000, Performance =  18.40 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007831 s, Result = 287a8000, Performance =  30.16 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008337 s, Result = 28820000, Performance =  30.91 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009016 s, Result = 28898000, Performance =  30.97 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009602 s, Result = 28910000, Performance =  31.31 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009223 s, Result = 28988000, Performance =  34.93 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011059 s, Result = 28a00000, Performance =  31.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009982 s, Result = 28a78000, Performance =  36.57 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010840 s, Result = 28af0000, Performance =  35.66 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010764 s, Result = 28b68000, Performance =  37.91 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011002 s, Result = 28be0000, Performance =  39.04 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011502 s, Result = 28c58000, Performance =  39.21 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011793 s, Result = 28cd0000, Performance =  40.06 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012246 s, Result = 28d48000, Performance =  40.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.013554 s, Result = 28dc0000, Performance =  38.02 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012709 s, Result = 28e38000, Performance =  42.24 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013868 s, Result = 28eb0000, Performance =  40.26 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014030 s, Result = 28f28000, Performance =  41.33 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014204 s, Result = 28fa0000, Performance =  42.33 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014969 s, Result = 29018000, Performance =  41.60 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.014914 s, Result = 29090000, Performance =  43.20 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015074 s, Result = 29108000, Performance =  44.16 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018817 s, Result = 29180000, Performance =  36.52 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016096 s, Result = 291f8000, Performance =  44.03 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.016803 s, Result = 29270000, Performance =  43.45 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017208 s, Result = 292e8000, Performance =  43.68 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.016966 s, Result = 29360000, Performance =  45.57 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.017858 s, Result = 293d8000, Performance =  44.49 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018191 s, Result = 29450000, Performance =  44.86 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.018575 s, Result = 294c8000, Performance =  45.09 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.020370 s, Result = 29540000, Performance =  42.17 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019460 s, Result = 295b8000, Performance =  45.24 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020268 s, Result = 29630000, Performance =  44.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.020636 s, Result = 296a8000, Performance =  44.75 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.020705 s, Result = 29720000, Performance =  45.64 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021342 s, Result = 29798000, Performance =  45.28 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.021497 s, Result = 29810000, Performance =  45.95 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.021908 s, Result = 29888000, Performance =  46.07 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.026840 s, Result = 29900000, Performance =  38.40 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.022549 s, Result = 29978000, Performance =  46.67 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.022900 s, Result = 299f0000, Performance =  46.89 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.024062 s, Result = 29a68000, Performance =  45.52 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.023649 s, Result = 29ae0000, Performance =  47.22 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.024979 s, Result = 29b58000, Performance =  45.56 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025316 s, Result = 29bd0000, Performance =  45.81 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025694 s, Result = 29c48000, Performance =  45.97 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.027929 s, Result = 29cc0000, Performance =  43.06 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026145 s, Result = 29d38000, Performance =  46.82 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.026687 s, Result = 29db0000, Performance =  46.67 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.026851 s, Result = 29e28000, Performance =  47.19 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.027217 s, Result = 29ea0000, Performance =  47.34 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.027936 s, Result = 29f18000, Performance =  46.89 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.028030 s, Result = 29f90000, Performance =  47.50 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.028737 s, Result = 2a008000, Performance =  47.08 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.035621 s, Result = 2a080000, Performance =  38.58 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   160  1981   704
Test passed: M N K =  1195  1974   256
Test passed: M N K =   818    10  1216
Test passed: M N K =   484  1293  1984
Test passed: M N K =   428   411  1664
M N K =  2048  2048   256, Elapsed time =   0.000418 s, Result = 00078000, Performance =  51.36 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000870 s, Result = 000f0000, Performance =  49.37 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001276 s, Result = 00168000, Performance =  50.48 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001592 s, Result = 001e0000, Performance =  53.97 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001980 s, Result = 00258000, Performance =  54.23 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002468 s, Result = 002d0000, Performance =  52.21 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003035 s, Result = 00348000, Performance =  49.54 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003812 s, Result = 003c0000, Performance =  45.07 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004191 s, Result = 00438000, Performance =  46.11 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006469 s, Result = 004b0000, Performance =  33.19 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005310 s, Result = 00528000, Performance =  44.49 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.005892 s, Result = 005a0000, Performance =  43.74 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006539 s, Result = 00618000, Performance =  42.70 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007078 s, Result = 00690000, Performance =  42.48 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.007033 s, Result = 00708000, Performance =  45.80 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008356 s, Result = 00780000, Performance =  41.12 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.007077 s, Result = 007f8000, Performance =  51.58 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.007791 s, Result = 00870000, Performance =  49.62 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.007826 s, Result = 008e8000, Performance =  52.13 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.008204 s, Result = 00960000, Performance =  52.35 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.008576 s, Result = 009d8000, Performance =  52.58 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.009173 s, Result = 00a50000, Performance =  51.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.009405 s, Result = 00ac8000, Performance =  52.52 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.010911 s, Result = 00b40000, Performance =  47.24 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.010069 s, Result = 00bb8000, Performance =  53.32 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.010927 s, Result = 00c30000, Performance =  51.10 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.010912 s, Result = 00ca8000, Performance =  53.14 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.011073 s, Result = 00d20000, Performance =  54.30 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.012022 s, Result = 00d98000, Performance =  51.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012158 s, Result = 00e10000, Performance =  52.99 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.012413 s, Result = 00e88000, Performance =  53.63 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.014818 s, Result = 00f00000, Performance =  46.38 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.013641 s, Result = 00f78000, Performance =  51.95 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.013853 s, Result = 00ff0000, Performance =  52.71 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.014414 s, Result = 01068000, Performance =  52.14 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.014361 s, Result = 010e0000, Performance =  53.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.015043 s, Result = 01158000, Performance =  52.82 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.015916 s, Result = 011d0000, Performance =  51.27 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.015946 s, Result = 01248000, Performance =  52.52 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.018464 s, Result = 012c0000, Performance =  46.52 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.016623 s, Result = 01338000, Performance =  52.97 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017419 s, Result = 013b0000, Performance =  51.78 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.017264 s, Result = 01428000, Performance =  53.49 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.018187 s, Result = 014a0000, Performance =  51.95 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.017979 s, Result = 01518000, Performance =  53.75 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.018934 s, Result = 01590000, Performance =  52.17 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.018877 s, Result = 01608000, Performance =  53.47 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.024106 s, Result = 01680000, Performance =  42.76 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020023 s, Result = 016f8000, Performance =  52.55 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.020457 s, Result = 01770000, Performance =  52.49 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.020961 s, Result = 017e8000, Performance =  52.25 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.021255 s, Result = 01860000, Performance =  52.54 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.021672 s, Result = 018d8000, Performance =  52.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022699 s, Result = 01950000, Performance =  51.09 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.022546 s, Result = 019c8000, Performance =  52.39 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.025413 s, Result = 01a40000, Performance =  47.32 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023569 s, Result = 01ab8000, Performance =  51.93 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.024221 s, Result = 01b30000, Performance =  51.42 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.023950 s, Result = 01ba8000, Performance =  52.90 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.023847 s, Result = 01c20000, Performance =  54.03 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.024950 s, Result = 01c98000, Performance =  52.50 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.025353 s, Result = 01d10000, Performance =  52.52 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.025613 s, Result = 01d88000, Performance =  52.82 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.031634 s, Result = 01e00000, Performance =  43.45 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   466   999   576
Test passed: M N K =  1480  1164   576
Test passed: M N K =  1979  1189   768
Test passed: M N K =    97  1611   512
Test passed: M N K =   933  1578  1920
M N K =  2048  2048   256, Elapsed time =   0.007518 s, Result = 640b8000, Performance =   2.86 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007948 s, Result = c4130000, Performance =   5.40 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007660 s, Result = 241a8000, Performance =   8.41 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007927 s, Result = 84220000, Performance =  10.84 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008418 s, Result = e4298000, Performance =  12.75 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008776 s, Result = 44310000, Performance =  14.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009217 s, Result = a4388000, Performance =  16.31 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009656 s, Result = 04400000, Performance =  17.79 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013953 s, Result = 64478000, Performance =  13.85 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010960 s, Result = c44f0000, Performance =  19.59 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011613 s, Result = 24568000, Performance =  20.34 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011933 s, Result = 845e0000, Performance =  21.60 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012523 s, Result = e4658000, Performance =  22.29 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013321 s, Result = 446d0000, Performance =  22.57 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013509 s, Result = a4748000, Performance =  23.85 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014525 s, Result = 047c0000, Performance =  23.65 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015381 s, Result = 64838000, Performance =  23.74 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015515 s, Result = c48b0000, Performance =  24.91 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016705 s, Result = 24928000, Performance =  24.42 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.016792 s, Result = 849a0000, Performance =  25.58 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.017667 s, Result = e4a18000, Performance =  25.53 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.017857 s, Result = 44a90000, Performance =  26.46 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018509 s, Result = a4b08000, Performance =  26.69 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.018323 s, Result = 04b80000, Performance =  28.13 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.019102 s, Result = 64bf8000, Performance =  28.10 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020229 s, Result = c4c70000, Performance =  27.60 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.020932 s, Result = 24ce8000, Performance =  27.70 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.020762 s, Result = 84d60000, Performance =  28.96 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.021732 s, Result = e4dd8000, Performance =  28.66 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.021909 s, Result = 44e50000, Performance =  29.40 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.023363 s, Result = a4ec8000, Performance =  28.49 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.022363 s, Result = 04f40000, Performance =  30.73 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023815 s, Result = 64fb8000, Performance =  29.76 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.023330 s, Result = c5030000, Performance =  31.30 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.024344 s, Result = 250a8000, Performance =  30.88 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.024190 s, Result = 85120000, Performance =  31.96 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.025114 s, Result = e5198000, Performance =  31.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.025391 s, Result = 45210000, Performance =  32.14 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.026250 s, Result = a5288000, Performance =  31.91 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.025887 s, Result = 05300000, Performance =  33.18 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.027056 s, Result = 65378000, Performance =  32.54 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.027659 s, Result = c53f0000, Performance =  32.61 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.028225 s, Result = 25468000, Performance =  32.72 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.028272 s, Result = 854e0000, Performance =  33.42 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.028766 s, Result = e5558000, Performance =  33.59 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.029293 s, Result = 455d0000, Performance =  33.72 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.029999 s, Result = a5648000, Performance =  33.64 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.029681 s, Result = 056c0000, Performance =  34.73 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.030918 s, Result = 65738000, Performance =  34.03 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.031238 s, Result = c57b0000, Performance =  34.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.032981 s, Result = 25828000, Performance =  33.21 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.032351 s, Result = 858a0000, Performance =  34.52 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.033258 s, Result = e5918000, Performance =  34.22 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.033766 s, Result = 45990000, Performance =  34.34 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.034793 s, Result = a5a08000, Performance =  33.95 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.034047 s, Result = 05a80000, Performance =  35.32 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.035335 s, Result = 65af8000, Performance =  34.64 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.036299 s, Result = c5b70000, Performance =  34.31 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.037214 s, Result = 25be8000, Performance =  34.05 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.039464 s, Result = 85c60000, Performance =  32.65 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.037451 s, Result = e5cd8000, Performance =  34.98 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.038290 s, Result = 45d50000, Performance =  34.77 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.038812 s, Result = a5dc8000, Performance =  34.86 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.038237 s, Result = 05e40000, Performance =  35.94 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   374   417   896
Test passed: M N K =   665   788  1728
Test passed: M N K =  1554  1982  1472
Test passed: M N K =  1270  1409   832
Test passed: M N K =  1440   941  2048
M N K =  2048  2048   256, Elapsed time =   0.005314 s, Result = 00078000, Performance =   4.04 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006114 s, Result = 000f0000, Performance =   7.02 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006468 s, Result = 00168000, Performance =   9.96 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006731 s, Result = 001e0000, Performance =  12.76 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006898 s, Result = 00258000, Performance =  15.57 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007493 s, Result = 002d0000, Performance =  17.20 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008010 s, Result = 00348000, Performance =  18.77 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009119 s, Result = 003c0000, Performance =  18.84 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013367 s, Result = 00438000, Performance =  14.46 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009648 s, Result = 004b0000, Performance =  22.26 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010362 s, Result = 00528000, Performance =  22.80 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011218 s, Result = 005a0000, Performance =  22.97 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011012 s, Result = 00618000, Performance =  25.35 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012230 s, Result = 00690000, Performance =  24.58 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012729 s, Result = 00708000, Performance =  25.31 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013361 s, Result = 00780000, Performance =  25.72 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013835 s, Result = 007f8000, Performance =  26.39 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.014332 s, Result = 00870000, Performance =  26.97 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014878 s, Result = 008e8000, Performance =  27.42 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015134 s, Result = 00960000, Performance =  28.38 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015750 s, Result = 009d8000, Performance =  28.63 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016340 s, Result = 00a50000, Performance =  28.91 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016451 s, Result = 00ac8000, Performance =  30.02 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016644 s, Result = 00b40000, Performance =  30.97 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.017607 s, Result = 00bb8000, Performance =  30.49 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.017899 s, Result = 00c30000, Performance =  31.19 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.018924 s, Result = 00ca8000, Performance =  30.64 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018866 s, Result = 00d20000, Performance =  31.87 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019923 s, Result = 00d98000, Performance =  31.26 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020003 s, Result = 00e10000, Performance =  32.21 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.020878 s, Result = 00e88000, Performance =  31.89 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.020643 s, Result = 00f00000, Performance =  33.29 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.021821 s, Result = 00f78000, Performance =  32.48 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.021737 s, Result = 00ff0000, Performance =  33.59 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.022696 s, Result = 01068000, Performance =  33.12 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.022655 s, Result = 010e0000, Performance =  34.12 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.023499 s, Result = 01158000, Performance =  33.81 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.023937 s, Result = 011d0000, Performance =  34.09 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.025066 s, Result = 01248000, Performance =  33.41 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.024769 s, Result = 012c0000, Performance =  34.68 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.025572 s, Result = 01338000, Performance =  34.43 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.026530 s, Result = 013b0000, Performance =  34.00 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.026944 s, Result = 01428000, Performance =  34.27 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.026954 s, Result = 014a0000, Performance =  35.06 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.027696 s, Result = 01518000, Performance =  34.89 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.027956 s, Result = 01590000, Performance =  35.34 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.028890 s, Result = 01608000, Performance =  34.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.028626 s, Result = 01680000, Performance =  36.01 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.029237 s, Result = 016f8000, Performance =  35.99 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.030279 s, Result = 01770000, Performance =  35.46 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.030917 s, Result = 017e8000, Performance =  35.42 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.030929 s, Result = 01860000, Performance =  36.11 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.032103 s, Result = 018d8000, Performance =  35.45 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.032739 s, Result = 01950000, Performance =  35.42 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.033381 s, Result = 019c8000, Performance =  35.38 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.032946 s, Result = 01a40000, Performance =  36.50 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.034131 s, Result = 01ab8000, Performance =  35.86 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.034589 s, Result = 01b30000, Performance =  36.01 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.035477 s, Result = 01ba8000, Performance =  35.71 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.035000 s, Result = 01c20000, Performance =  36.81 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.035893 s, Result = 01c98000, Performance =  36.50 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.036617 s, Result = 01d10000, Performance =  36.36 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.037443 s, Result = 01d88000, Performance =  36.13 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.036052 s, Result = 01e00000, Performance =  38.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   775  1530  1088
Test passed: M N K =   382  1849   704
Test passed: M N K =   951   593  1344
Test passed: M N K =   953  1049   704
Test passed: M N K =   231  1448   256
M N K =  2048  2048   256, Elapsed time =   0.003446 s, Result = 282f8000, Performance =   6.23 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004035 s, Result = 28370000, Performance =  10.64 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004322 s, Result = 283e8000, Performance =  14.90 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004662 s, Result = 28460000, Performance =  18.42 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005018 s, Result = 284d8000, Performance =  21.40 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005397 s, Result = 28550000, Performance =  23.87 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005735 s, Result = 285c8000, Performance =  26.21 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006483 s, Result = 28640000, Performance =  26.50 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006758 s, Result = 286b8000, Performance =  28.60 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011405 s, Result = 28730000, Performance =  18.83 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008164 s, Result = 287a8000, Performance =  28.93 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008796 s, Result = 28820000, Performance =  29.30 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009172 s, Result = 28898000, Performance =  30.44 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009771 s, Result = 28910000, Performance =  30.77 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010583 s, Result = 28988000, Performance =  30.44 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011145 s, Result = 28a00000, Performance =  30.83 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011752 s, Result = 28a78000, Performance =  31.06 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011963 s, Result = 28af0000, Performance =  32.31 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012993 s, Result = 28b68000, Performance =  31.40 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013110 s, Result = 28be0000, Performance =  32.76 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013477 s, Result = 28c58000, Performance =  33.46 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013659 s, Result = 28cd0000, Performance =  34.59 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014679 s, Result = 28d48000, Performance =  33.65 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.013981 s, Result = 28dc0000, Performance =  36.86 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014774 s, Result = 28e38000, Performance =  36.34 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015450 s, Result = 28eb0000, Performance =  36.14 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016888 s, Result = 28f28000, Performance =  34.33 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.017329 s, Result = 28fa0000, Performance =  34.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.017986 s, Result = 29018000, Performance =  34.62 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.017972 s, Result = 29090000, Performance =  35.85 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.018156 s, Result = 29108000, Performance =  36.67 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.018694 s, Result = 29180000, Performance =  36.76 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.019455 s, Result = 291f8000, Performance =  36.43 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.019849 s, Result = 29270000, Performance =  36.78 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.020870 s, Result = 292e8000, Performance =  36.01 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.019984 s, Result = 29360000, Performance =  38.68 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.021736 s, Result = 293d8000, Performance =  36.55 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.021881 s, Result = 29450000, Performance =  37.30 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.022623 s, Result = 294c8000, Performance =  37.02 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.022316 s, Result = 29540000, Performance =  38.49 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.023197 s, Result = 295b8000, Performance =  37.96 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.023493 s, Result = 29630000, Performance =  38.39 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.024762 s, Result = 296a8000, Performance =  37.29 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.024294 s, Result = 29720000, Performance =  38.89 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.025826 s, Result = 29798000, Performance =  37.42 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.026322 s, Result = 29810000, Performance =  37.53 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.026673 s, Result = 29888000, Performance =  37.84 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.027008 s, Result = 29900000, Performance =  38.17 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.027705 s, Result = 29978000, Performance =  37.98 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.028685 s, Result = 299f0000, Performance =  37.43 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.031591 s, Result = 29a68000, Performance =  34.67 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.028855 s, Result = 29ae0000, Performance =  38.70 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.030737 s, Result = 29b58000, Performance =  37.03 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.031228 s, Result = 29bd0000, Performance =  37.13 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.031423 s, Result = 29c48000, Performance =  37.59 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.031205 s, Result = 29cc0000, Performance =  38.54 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.032070 s, Result = 29d38000, Performance =  38.17 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.032613 s, Result = 29db0000, Performance =  38.19 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.033500 s, Result = 29e28000, Performance =  37.82 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.033151 s, Result = 29ea0000, Performance =  38.87 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.034597 s, Result = 29f18000, Performance =  37.86 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.035086 s, Result = 29f90000, Performance =  37.95 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.035667 s, Result = 2a008000, Performance =  37.93 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.034617 s, Result = 2a080000, Performance =  39.70 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1454  1466   960
Test passed: M N K =  1442  1015   960
Test passed: M N K =  2034  1000   960
Test passed: M N K =   587  1569   320
Test passed: M N K =  1936  1019  1088
M N K =  2048  2048   256, Elapsed time =   0.000426 s, Result = 00078000, Performance =  50.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000808 s, Result = 000f0000, Performance =  53.13 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001254 s, Result = 00168000, Performance =  51.37 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001547 s, Result = 001e0000, Performance =  55.54 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002013 s, Result = 00258000, Performance =  53.33 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002541 s, Result = 002d0000, Performance =  50.71 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.003002 s, Result = 00348000, Performance =  50.08 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003579 s, Result = 003c0000, Performance =  48.01 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.004081 s, Result = 00438000, Performance =  47.36 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006622 s, Result = 004b0000, Performance =  32.43 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.005655 s, Result = 00528000, Performance =  41.77 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.006191 s, Result = 005a0000, Performance =  41.62 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006558 s, Result = 00618000, Performance =  42.57 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007036 s, Result = 00690000, Performance =  42.73 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.007864 s, Result = 00708000, Performance =  40.96 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008371 s, Result = 00780000, Performance =  41.05 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008741 s, Result = 007f8000, Performance =  41.77 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009363 s, Result = 00870000, Performance =  41.28 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010328 s, Result = 008e8000, Performance =  39.51 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010598 s, Result = 00960000, Performance =  40.52 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010957 s, Result = 009d8000, Performance =  41.16 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011446 s, Result = 00a50000, Performance =  41.28 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.011830 s, Result = 00ac8000, Performance =  41.75 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.011959 s, Result = 00b40000, Performance =  43.10 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.012735 s, Result = 00bb8000, Performance =  42.16 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013762 s, Result = 00c30000, Performance =  40.57 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014325 s, Result = 00ca8000, Performance =  40.48 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014421 s, Result = 00d20000, Performance =  41.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015150 s, Result = 00d98000, Performance =  41.11 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015403 s, Result = 00e10000, Performance =  41.82 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016114 s, Result = 00e88000, Performance =  41.31 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.015484 s, Result = 00f00000, Performance =  44.38 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017084 s, Result = 00f78000, Performance =  41.48 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017839 s, Result = 00ff0000, Performance =  40.93 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.018282 s, Result = 01068000, Performance =  41.11 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.018243 s, Result = 010e0000, Performance =  42.38 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.019259 s, Result = 01158000, Performance =  41.26 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.019241 s, Result = 011d0000, Performance =  42.41 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.020668 s, Result = 01248000, Performance =  40.52 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.020372 s, Result = 012c0000, Performance =  42.17 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.020879 s, Result = 01338000, Performance =  42.17 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.022060 s, Result = 013b0000, Performance =  40.89 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.022307 s, Result = 01428000, Performance =  41.40 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.022152 s, Result = 014a0000, Performance =  42.66 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.023842 s, Result = 01518000, Performance =  40.53 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.023789 s, Result = 01590000, Performance =  41.53 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.024170 s, Result = 01608000, Performance =  41.76 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.022654 s, Result = 01680000, Performance =  45.50 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.025031 s, Result = 016f8000, Performance =  42.04 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.025696 s, Result = 01770000, Performance =  41.79 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026289 s, Result = 017e8000, Performance =  41.66 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.026430 s, Result = 01860000, Performance =  42.25 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.027558 s, Result = 018d8000, Performance =  41.30 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.028336 s, Result = 01950000, Performance =  40.92 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.029035 s, Result = 019c8000, Performance =  40.68 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.028494 s, Result = 01a40000, Performance =  42.20 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.029696 s, Result = 01ab8000, Performance =  41.22 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.030624 s, Result = 01b30000, Performance =  40.67 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.030876 s, Result = 01ba8000, Performance =  41.04 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.030522 s, Result = 01c20000, Performance =  42.22 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.031467 s, Result = 01c98000, Performance =  41.63 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.032004 s, Result = 01d10000, Performance =  41.60 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.032636 s, Result = 01d88000, Performance =  41.45 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.031955 s, Result = 01e00000, Performance =  43.01 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1289  1366  1664
Test passed: M N K =   530  1754  1344
Test passed: M N K =  1648   220  1536
Test passed: M N K =    38  1894   576
Test passed: M N K =  1176   284  1088
M N K =  2048  2048   256, Elapsed time =   0.005444 s, Result = 84090000, Performance =   3.94 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006031 s, Result = 040e0000, Performance =   7.12 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006444 s, Result = 84130000, Performance =  10.00 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006761 s, Result = 04180000, Performance =  12.71 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008206 s, Result = 841d0000, Performance =  13.08 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007917 s, Result = 04220000, Performance =  16.27 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008193 s, Result = 84270000, Performance =  18.35 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008716 s, Result = 042c0000, Performance =  19.71 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010558 s, Result = 84310000, Performance =  18.31 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008791 s, Result = 04360000, Performance =  24.43 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009690 s, Result = 843b0000, Performance =  24.38 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009973 s, Result = 04400000, Performance =  25.84 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010118 s, Result = 84450000, Performance =  27.59 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009902 s, Result = 044a0000, Performance =  30.36 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010694 s, Result = 844f0000, Performance =  30.12 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010878 s, Result = 04540000, Performance =  31.59 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012075 s, Result = 84590000, Performance =  30.23 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012649 s, Result = 045e0000, Performance =  30.56 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012602 s, Result = 84630000, Performance =  32.38 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012997 s, Result = 04680000, Performance =  33.05 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013040 s, Result = 846d0000, Performance =  34.58 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013404 s, Result = 04720000, Performance =  35.25 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014352 s, Result = 84770000, Performance =  34.41 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014519 s, Result = 047c0000, Performance =  35.50 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014678 s, Result = 84810000, Performance =  36.58 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.014581 s, Result = 04860000, Performance =  38.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.015320 s, Result = 848b0000, Performance =  37.85 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.016014 s, Result = 04900000, Performance =  37.55 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015500 s, Result = 84950000, Performance =  40.18 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016969 s, Result = 049a0000, Performance =  37.97 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.016015 s, Result = 849f0000, Performance =  41.57 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016432 s, Result = 04a40000, Performance =  41.82 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017435 s, Result = 84a90000, Performance =  40.65 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.017579 s, Result = 04ae0000, Performance =  41.53 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017374 s, Result = 84b30000, Performance =  43.26 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.016606 s, Result = 04b80000, Performance =  46.56 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018203 s, Result = 84bd0000, Performance =  43.65 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.017610 s, Result = 04c20000, Performance =  46.34 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.018508 s, Result = 84c70000, Performance =  45.25 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.018742 s, Result = 04cc0000, Performance =  45.83 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.019165 s, Result = 84d10000, Performance =  45.94 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.019801 s, Result = 04d60000, Performance =  45.55 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.019866 s, Result = 84db0000, Performance =  46.48 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.019616 s, Result = 04e00000, Performance =  48.17 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.020761 s, Result = 84e50000, Performance =  46.55 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.020753 s, Result = 04ea0000, Performance =  47.60 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.021614 s, Result = 84ef0000, Performance =  46.70 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.021176 s, Result = 04f40000, Performance =  48.68 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.022363 s, Result = 84f90000, Performance =  47.05 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023443 s, Result = 04fe0000, Performance =  45.80 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.022680 s, Result = 85030000, Performance =  48.29 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.023334 s, Result = 05080000, Performance =  47.86 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.024905 s, Result = 850d0000, Performance =  45.70 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.024052 s, Result = 05120000, Performance =  48.21 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.024795 s, Result = 85170000, Performance =  47.64 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.026198 s, Result = 051c0000, Performance =  45.90 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.025902 s, Result = 85210000, Performance =  47.26 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.025760 s, Result = 05260000, Performance =  48.35 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.027479 s, Result = 852b0000, Performance =  46.11 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.027507 s, Result = 05300000, Performance =  46.84 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.028119 s, Result = 85350000, Performance =  46.59 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.028346 s, Result = 053a0000, Performance =  46.97 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.028533 s, Result = 853f0000, Performance =  47.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.030313 s, Result = 05440000, Performance =  45.34 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   166   641   320
Test passed: M N K =  1079   978   320
Test passed: M N K =  1994   185  1664
Test passed: M N K =   428  1598   128
Test passed: M N K =  1984   842   320
M N K =  2048  2048   256, Elapsed time =   0.003032 s, Result = 00050000, Performance =   7.08 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004417 s, Result = 000a0000, Performance =   9.72 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004569 s, Result = 000f0000, Performance =  14.10 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004992 s, Result = 00140000, Performance =  17.21 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005128 s, Result = 00190000, Performance =  20.94 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005648 s, Result = 001e0000, Performance =  22.81 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007964 s, Result = 00230000, Performance =  18.87 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006979 s, Result = 00280000, Performance =  24.62 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006174 s, Result = 002d0000, Performance =  31.31 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006726 s, Result = 00320000, Performance =  31.93 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007186 s, Result = 00370000, Performance =  32.87 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007659 s, Result = 003c0000, Performance =  33.65 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007536 s, Result = 00410000, Performance =  37.05 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.008011 s, Result = 00460000, Performance =  37.53 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008034 s, Result = 004b0000, Performance =  40.10 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008305 s, Result = 00500000, Performance =  41.37 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008957 s, Result = 00550000, Performance =  40.76 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009675 s, Result = 005a0000, Performance =  39.95 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.009981 s, Result = 005f0000, Performance =  40.88 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.009721 s, Result = 00640000, Performance =  44.18 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010452 s, Result = 00690000, Performance =  43.15 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.010729 s, Result = 006e0000, Performance =  44.03 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.010913 s, Result = 00730000, Performance =  45.26 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.011405 s, Result = 00780000, Performance =  45.19 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.011595 s, Result = 007d0000, Performance =  46.30 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.012032 s, Result = 00820000, Performance =  46.41 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.012351 s, Result = 00870000, Performance =  46.95 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.013200 s, Result = 008c0000, Performance =  45.55 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.012953 s, Result = 00910000, Performance =  48.08 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.013771 s, Result = 00960000, Performance =  46.78 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.013481 s, Result = 009b0000, Performance =  49.38 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.014773 s, Result = 00a00000, Performance =  46.52 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.014463 s, Result = 00a50000, Performance =  49.00 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.015041 s, Result = 00aa0000, Performance =  48.54 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.015341 s, Result = 00af0000, Performance =  49.00 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.015708 s, Result = 00b40000, Performance =  49.22 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.016320 s, Result = 00b90000, Performance =  48.69 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.017028 s, Result = 00be0000, Performance =  47.92 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.016393 s, Result = 00c30000, Performance =  51.09 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.017656 s, Result = 00c80000, Performance =  48.65 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.017088 s, Result = 00cd0000, Performance =  51.53 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017812 s, Result = 00d20000, Performance =  50.64 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.018343 s, Result = 00d70000, Performance =  50.34 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.018516 s, Result = 00dc0000, Performance =  51.03 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.019569 s, Result = 00e10000, Performance =  49.38 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.020024 s, Result = 00e60000, Performance =  49.33 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.020022 s, Result = 00eb0000, Performance =  50.41 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.020521 s, Result = 00f00000, Performance =  50.23 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.021484 s, Result = 00f50000, Performance =  48.98 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.021128 s, Result = 00fa0000, Performance =  50.82 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.021618 s, Result = 00ff0000, Performance =  50.66 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.022873 s, Result = 01040000, Performance =  48.82 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.022367 s, Result = 01090000, Performance =  50.89 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022932 s, Result = 010e0000, Performance =  50.57 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.023258 s, Result = 01130000, Performance =  50.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.022868 s, Result = 01180000, Performance =  52.59 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.024871 s, Result = 011d0000, Performance =  49.22 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.024027 s, Result = 01220000, Performance =  51.84 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.024923 s, Result = 01270000, Performance =  50.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.025979 s, Result = 012c0000, Performance =  49.60 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.027431 s, Result = 01310000, Performance =  47.75 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.026713 s, Result = 01360000, Performance =  49.84 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.026623 s, Result = 013b0000, Performance =  50.82 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.027205 s, Result = 01400000, Performance =  50.52 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1374   386  1472
Test passed: M N K =  1003     1   832
Test passed: M N K =  1980   329   832
Test passed: M N K =  1471   471  2048
Test passed: M N K =  1417  1978   768
M N K =  2048  2048   256, Elapsed time =   0.002870 s, Result = 282d0000, Performance =   7.48 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003634 s, Result = 28320000, Performance =  11.82 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003865 s, Result = 28370000, Performance =  16.67 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004055 s, Result = 283c0000, Performance =  21.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004412 s, Result = 28410000, Performance =  24.34 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004683 s, Result = 28460000, Performance =  27.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004962 s, Result = 284b0000, Performance =  30.29 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005374 s, Result = 28500000, Performance =  31.97 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005289 s, Result = 28550000, Performance =  36.54 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010609 s, Result = 285a0000, Performance =  20.24 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006229 s, Result = 285f0000, Performance =  37.92 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.006652 s, Result = 28640000, Performance =  38.74 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007038 s, Result = 28690000, Performance =  39.66 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007379 s, Result = 286e0000, Performance =  40.74 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008178 s, Result = 28730000, Performance =  39.39 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.007662 s, Result = 28780000, Performance =  44.84 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008030 s, Result = 287d0000, Performance =  45.47 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.008344 s, Result = 28820000, Performance =  46.33 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.008612 s, Result = 28870000, Performance =  47.38 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.008877 s, Result = 288c0000, Performance =  48.38 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.009332 s, Result = 28910000, Performance =  48.32 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.009544 s, Result = 28960000, Performance =  49.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.010095 s, Result = 289b0000, Performance =  48.93 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.010304 s, Result = 28a00000, Performance =  50.02 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.011062 s, Result = 28a50000, Performance =  48.53 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.010840 s, Result = 28aa0000, Performance =  51.51 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.011378 s, Result = 28af0000, Performance =  50.96 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.011540 s, Result = 28b40000, Performance =  52.10 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.012208 s, Result = 28b90000, Performance =  51.01 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012135 s, Result = 28be0000, Performance =  53.09 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.012499 s, Result = 28c30000, Performance =  53.26 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.013199 s, Result = 28c80000, Performance =  52.06 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.013164 s, Result = 28cd0000, Performance =  53.83 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.013547 s, Result = 28d20000, Performance =  53.90 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.013976 s, Result = 28d70000, Performance =  53.78 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.013897 s, Result = 28dc0000, Performance =  55.63 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.014544 s, Result = 28e10000, Performance =  54.63 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.014749 s, Result = 28e60000, Performance =  55.33 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.015012 s, Result = 28eb0000, Performance =  55.79 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.016192 s, Result = 28f00000, Performance =  53.05 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.015730 s, Result = 28f50000, Performance =  55.97 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.016372 s, Result = 28fa0000, Performance =  55.09 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.016768 s, Result = 28ff0000, Performance =  55.07 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.017007 s, Result = 29040000, Performance =  55.56 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.017914 s, Result = 29090000, Performance =  53.94 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.018760 s, Result = 290e0000, Performance =  52.66 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.019000 s, Result = 29130000, Performance =  53.12 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.019624 s, Result = 29180000, Performance =  52.53 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.019513 s, Result = 291d0000, Performance =  53.93 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.019465 s, Result = 29220000, Performance =  55.16 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.020475 s, Result = 29270000, Performance =  53.49 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.020499 s, Result = 292c0000, Performance =  54.48 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.020917 s, Result = 29310000, Performance =  54.41 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022025 s, Result = 29360000, Performance =  52.65 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.021467 s, Result = 293b0000, Performance =  55.02 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.023199 s, Result = 29400000, Performance =  51.84 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.022960 s, Result = 29450000, Performance =  53.31 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.022984 s, Result = 294a0000, Performance =  54.19 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.024169 s, Result = 294f0000, Performance =  52.42 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024688 s, Result = 29540000, Performance =  52.19 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.025528 s, Result = 29590000, Performance =  51.31 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.024857 s, Result = 295e0000, Performance =  53.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.026254 s, Result = 29630000, Performance =  51.53 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.026610 s, Result = 29680000, Performance =  51.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1422   700    64
Test passed: M N K =  1898  1744  1792
Test passed: M N K =  1667  1383  1728
Test passed: M N K =  1736  1070  1792
Test passed: M N K =  1672  1518   128
M N K =  2048  2048   256, Elapsed time =   0.000400 s, Result = 00050000, Performance =  53.75 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000709 s, Result = 000a0000, Performance =  60.58 TOPS
M N K =  2048  2048   768, Elapsed time =   0.000973 s, Result = 000f0000, Performance =  66.20 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001317 s, Result = 00140000, Performance =  65.25 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001574 s, Result = 00190000, Performance =  68.20 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.001901 s, Result = 001e0000, Performance =  67.78 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002178 s, Result = 00230000, Performance =  69.01 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.002625 s, Result = 00280000, Performance =  65.45 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.002670 s, Result = 002d0000, Performance =  72.38 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.004542 s, Result = 00320000, Performance =  47.28 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.003357 s, Result = 00370000, Performance =  70.38 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.004013 s, Result = 003c0000, Performance =  64.21 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.004472 s, Result = 00410000, Performance =  62.43 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.004897 s, Result = 00460000, Performance =  61.39 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.005270 s, Result = 004b0000, Performance =  61.12 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.005286 s, Result = 00500000, Performance =  65.01 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.005225 s, Result = 00550000, Performance =  69.88 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.005627 s, Result = 005a0000, Performance =  68.69 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.005996 s, Result = 005f0000, Performance =  68.05 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.006108 s, Result = 00640000, Performance =  70.32 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.006613 s, Result = 00690000, Performance =  68.20 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.006790 s, Result = 006e0000, Performance =  69.58 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.007173 s, Result = 00730000, Performance =  68.86 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.007295 s, Result = 00780000, Performance =  70.65 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.007991 s, Result = 007d0000, Performance =  67.18 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.008172 s, Result = 00820000, Performance =  68.32 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.008585 s, Result = 00870000, Performance =  67.53 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.008771 s, Result = 008c0000, Performance =  68.55 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.009219 s, Result = 00910000, Performance =  67.55 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.009456 s, Result = 00960000, Performance =  68.13 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.009586 s, Result = 009b0000, Performance =  69.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.009855 s, Result = 00a00000, Performance =  69.73 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.010511 s, Result = 00a50000, Performance =  67.42 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.011395 s, Result = 00aa0000, Performance =  64.08 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.010703 s, Result = 00af0000, Performance =  70.22 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.011610 s, Result = 00b40000, Performance =  66.59 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.011913 s, Result = 00b90000, Performance =  66.70 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.011790 s, Result = 00be0000, Performance =  69.21 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.012617 s, Result = 00c30000, Performance =  66.38 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.012960 s, Result = 00c80000, Performance =  66.28 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.013398 s, Result = 00cd0000, Performance =  65.72 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.014174 s, Result = 00d20000, Performance =  63.63 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.014153 s, Result = 00d70000, Performance =  65.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.014242 s, Result = 00dc0000, Performance =  66.35 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.014981 s, Result = 00e10000, Performance =  64.51 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.015163 s, Result = 00e60000, Performance =  65.15 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.016137 s, Result = 00eb0000, Performance =  62.55 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.016925 s, Result = 00f00000, Performance =  60.90 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.016481 s, Result = 00f50000, Performance =  63.85 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.017082 s, Result = 00fa0000, Performance =  62.86 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.017352 s, Result = 00ff0000, Performance =  63.12 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.018065 s, Result = 01040000, Performance =  61.81 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.018399 s, Result = 01090000, Performance =  61.86 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.018632 s, Result = 010e0000, Performance =  62.24 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.019771 s, Result = 01130000, Performance =  59.74 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.020378 s, Result = 01180000, Performance =  59.01 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.019868 s, Result = 011d0000, Performance =  61.61 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.020140 s, Result = 01220000, Performance =  61.84 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.020764 s, Result = 01270000, Performance =  61.02 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.021682 s, Result = 012c0000, Performance =  59.43 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.021101 s, Result = 01310000, Performance =  62.08 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.022248 s, Result = 01360000, Performance =  59.84 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.022401 s, Result = 013b0000, Performance =  60.40 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.023202 s, Result = 01400000, Performance =  59.24 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   397  1707   832
Test passed: M N K =   372  1118   960
Test passed: M N K =   858  1798   832
Test passed: M N K =    81   484  1216
Test passed: M N K =   931     5  1536
M N K =  2048  2048   256, Elapsed time =   0.005608 s, Result = 84090000, Performance =   3.83 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006562 s, Result = 040e0000, Performance =   6.55 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006583 s, Result = 84130000, Performance =   9.79 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007211 s, Result = 04180000, Performance =  11.91 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007595 s, Result = 841d0000, Performance =  14.14 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007438 s, Result = 04220000, Performance =  17.32 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008429 s, Result = 84270000, Performance =  17.83 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008956 s, Result = 042c0000, Performance =  19.18 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009003 s, Result = 84310000, Performance =  21.47 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012692 s, Result = 04360000, Performance =  16.92 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010358 s, Result = 843b0000, Performance =  22.81 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010973 s, Result = 04400000, Performance =  23.48 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011269 s, Result = 84450000, Performance =  24.77 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011182 s, Result = 044a0000, Performance =  26.89 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011606 s, Result = 844f0000, Performance =  27.75 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011823 s, Result = 04540000, Performance =  29.06 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012762 s, Result = 84590000, Performance =  28.61 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012568 s, Result = 045e0000, Performance =  30.76 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012411 s, Result = 84630000, Performance =  32.88 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012999 s, Result = 04680000, Performance =  33.04 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.013721 s, Result = 846d0000, Performance =  32.87 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014187 s, Result = 04720000, Performance =  33.30 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.012940 s, Result = 84770000, Performance =  38.17 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014500 s, Result = 047c0000, Performance =  35.55 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014575 s, Result = 84810000, Performance =  36.83 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015198 s, Result = 04860000, Performance =  36.74 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014872 s, Result = 848b0000, Performance =  38.99 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.014331 s, Result = 04900000, Performance =  41.96 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.014856 s, Result = 84950000, Performance =  41.92 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015091 s, Result = 049a0000, Performance =  42.69 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015392 s, Result = 849f0000, Performance =  43.25 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.016972 s, Result = 04a40000, Performance =  40.49 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.016597 s, Result = 84a90000, Performance =  42.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.016852 s, Result = 04ae0000, Performance =  43.33 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.016231 s, Result = 84b30000, Performance =  46.31 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.016636 s, Result = 04b80000, Performance =  46.47 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.016780 s, Result = 84bd0000, Performance =  47.35 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.017281 s, Result = 04c20000, Performance =  47.22 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.017930 s, Result = 84c70000, Performance =  46.71 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.018399 s, Result = 04cc0000, Performance =  46.69 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.017756 s, Result = 84d10000, Performance =  49.59 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.018197 s, Result = 04d60000, Performance =  49.57 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.018375 s, Result = 84db0000, Performance =  50.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.019248 s, Result = 04e00000, Performance =  49.09 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.019672 s, Result = 84e50000, Performance =  49.12 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.019577 s, Result = 04ea0000, Performance =  50.46 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.019876 s, Result = 84ef0000, Performance =  50.78 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.021790 s, Result = 04f40000, Performance =  47.31 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020791 s, Result = 84f90000, Performance =  50.61 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.020792 s, Result = 04fe0000, Performance =  51.64 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.021455 s, Result = 85030000, Performance =  51.05 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.021191 s, Result = 05080000, Performance =  52.70 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.021395 s, Result = 850d0000, Performance =  53.20 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.023241 s, Result = 05120000, Performance =  49.90 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.023195 s, Result = 85170000, Performance =  50.92 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.023849 s, Result = 051c0000, Performance =  50.43 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023526 s, Result = 85210000, Performance =  52.03 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.023954 s, Result = 05260000, Performance =  52.00 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.023896 s, Result = 852b0000, Performance =  53.02 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024260 s, Result = 05300000, Performance =  53.11 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.025302 s, Result = 85350000, Performance =  51.77 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.025565 s, Result = 053a0000, Performance =  52.08 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.026237 s, Result = 853f0000, Performance =  51.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.027349 s, Result = 05440000, Performance =  50.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1824  1288   128
Test passed: M N K =   758  1561   704
Test passed: M N K =   828    49  1088
Test passed: M N K =  1542  1425   704
Test passed: M N K =  1041  1613   704
M N K =  2048  2048   256, Elapsed time =   0.003780 s, Result = 00050000, Performance =   5.68 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004534 s, Result = 000a0000, Performance =   9.47 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004700 s, Result = 000f0000, Performance =  13.71 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005058 s, Result = 00140000, Performance =  16.98 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005371 s, Result = 00190000, Performance =  19.99 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006231 s, Result = 001e0000, Performance =  20.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006317 s, Result = 00230000, Performance =  23.80 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007709 s, Result = 00280000, Performance =  22.29 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007562 s, Result = 002d0000, Performance =  25.56 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013144 s, Result = 00320000, Performance =  16.34 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008131 s, Result = 00370000, Performance =  29.05 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008829 s, Result = 003c0000, Performance =  29.19 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009395 s, Result = 00410000, Performance =  29.71 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010348 s, Result = 00460000, Performance =  29.05 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009757 s, Result = 004b0000, Performance =  33.02 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011477 s, Result = 00500000, Performance =  29.94 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010254 s, Result = 00550000, Performance =  35.60 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.010975 s, Result = 005a0000, Performance =  35.22 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010131 s, Result = 005f0000, Performance =  40.28 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010344 s, Result = 00640000, Performance =  41.52 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.011106 s, Result = 00690000, Performance =  40.61 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.010984 s, Result = 006e0000, Performance =  43.01 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.010436 s, Result = 00730000, Performance =  47.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.012767 s, Result = 00780000, Performance =  40.37 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.011685 s, Result = 007d0000, Performance =  45.94 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.013081 s, Result = 00820000, Performance =  42.69 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.012100 s, Result = 00870000, Performance =  47.92 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.012461 s, Result = 008c0000, Performance =  48.25 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.013086 s, Result = 00910000, Performance =  47.59 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.013701 s, Result = 00960000, Performance =  47.02 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.013479 s, Result = 009b0000, Performance =  49.39 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.015410 s, Result = 00a00000, Performance =  44.60 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.014363 s, Result = 00a50000, Performance =  49.34 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.014181 s, Result = 00aa0000, Performance =  51.49 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.014736 s, Result = 00af0000, Performance =  51.01 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.015200 s, Result = 00b40000, Performance =  50.86 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.015400 s, Result = 00b90000, Performance =  51.60 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.015782 s, Result = 00be0000, Performance =  51.71 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.015430 s, Result = 00c30000, Performance =  54.28 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.016799 s, Result = 00c80000, Performance =  51.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.016477 s, Result = 00cd0000, Performance =  53.44 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017102 s, Result = 00d20000, Performance =  52.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.016824 s, Result = 00d70000, Performance =  54.89 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.017273 s, Result = 00dc0000, Performance =  54.70 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.017401 s, Result = 00e10000, Performance =  55.54 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.017905 s, Result = 00e60000, Performance =  55.17 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.018167 s, Result = 00eb0000, Performance =  55.56 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.020404 s, Result = 00f00000, Performance =  50.52 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.018968 s, Result = 00f50000, Performance =  55.48 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.019294 s, Result = 00fa0000, Performance =  55.65 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.019630 s, Result = 00ff0000, Performance =  55.79 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.019746 s, Result = 01040000, Performance =  56.55 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.020064 s, Result = 01090000, Performance =  56.73 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.020974 s, Result = 010e0000, Performance =  55.29 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.021328 s, Result = 01130000, Performance =  55.38 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.022426 s, Result = 01180000, Performance =  53.63 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.021873 s, Result = 011d0000, Performance =  55.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.021768 s, Result = 01220000, Performance =  57.22 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.023421 s, Result = 01270000, Performance =  54.10 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.022859 s, Result = 012c0000, Performance =  56.37 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.023556 s, Result = 01310000, Performance =  55.61 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.024353 s, Result = 01360000, Performance =  54.67 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.023689 s, Result = 013b0000, Performance =  57.11 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.025969 s, Result = 01400000, Performance =  52.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   445   508   768
Test passed: M N K =  1824   642  1792
Test passed: M N K =    25   481   384
Test passed: M N K =  1427  1830  1856
Test passed: M N K =   948  1345   192
M N K =  2048  2048   256, Elapsed time =   0.003059 s, Result = 282d0000, Performance =   7.02 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003462 s, Result = 28320000, Performance =  12.41 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003866 s, Result = 28370000, Performance =  16.66 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004116 s, Result = 283c0000, Performance =  20.87 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004411 s, Result = 28410000, Performance =  24.34 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004922 s, Result = 28460000, Performance =  26.18 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005136 s, Result = 284b0000, Performance =  29.27 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005555 s, Result = 28500000, Performance =  30.93 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005838 s, Result = 28550000, Performance =  33.11 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009082 s, Result = 285a0000, Performance =  23.65 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006538 s, Result = 285f0000, Performance =  36.13 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007055 s, Result = 28640000, Performance =  36.53 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007410 s, Result = 28690000, Performance =  37.68 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007824 s, Result = 286e0000, Performance =  38.43 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.007835 s, Result = 28730000, Performance =  41.11 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008423 s, Result = 28780000, Performance =  40.79 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.008211 s, Result = 287d0000, Performance =  44.46 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.008503 s, Result = 28820000, Performance =  45.46 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.008929 s, Result = 28870000, Performance =  45.69 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.008875 s, Result = 288c0000, Performance =  48.39 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.009382 s, Result = 28910000, Performance =  48.07 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.009743 s, Result = 28960000, Performance =  48.49 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.009883 s, Result = 289b0000, Performance =  49.98 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.010755 s, Result = 28a00000, Performance =  47.92 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.010620 s, Result = 28a50000, Performance =  50.55 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.011052 s, Result = 28aa0000, Performance =  50.52 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.010937 s, Result = 28af0000, Performance =  53.02 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.011638 s, Result = 28b40000, Performance =  51.66 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.011642 s, Result = 28b90000, Performance =  53.49 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.012453 s, Result = 28be0000, Performance =  51.73 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.012585 s, Result = 28c30000, Performance =  52.90 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.013893 s, Result = 28c80000, Performance =  49.46 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.012933 s, Result = 28cd0000, Performance =  54.79 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.013700 s, Result = 28d20000, Performance =  53.30 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.013551 s, Result = 28d70000, Performance =  55.47 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.013806 s, Result = 28dc0000, Performance =  56.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.014363 s, Result = 28e10000, Performance =  55.32 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.014654 s, Result = 28e60000, Performance =  55.69 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.014540 s, Result = 28eb0000, Performance =  57.60 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.015942 s, Result = 28f00000, Performance =  53.88 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.015642 s, Result = 28f50000, Performance =  56.29 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.016007 s, Result = 28fa0000, Performance =  56.35 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.016170 s, Result = 28ff0000, Performance =  57.11 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.016414 s, Result = 29040000, Performance =  57.57 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.016953 s, Result = 29090000, Performance =  57.00 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.017548 s, Result = 290e0000, Performance =  56.29 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.017599 s, Result = 29130000, Performance =  57.35 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.019321 s, Result = 29180000, Performance =  53.35 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.017940 s, Result = 291d0000, Performance =  58.65 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.019107 s, Result = 29220000, Performance =  56.20 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.019083 s, Result = 29270000, Performance =  57.39 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.019064 s, Result = 292c0000, Performance =  58.57 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.019334 s, Result = 29310000, Performance =  58.87 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.020212 s, Result = 29360000, Performance =  57.37 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.020650 s, Result = 293b0000, Performance =  57.20 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.021999 s, Result = 29400000, Performance =  54.66 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.021532 s, Result = 29450000, Performance =  56.85 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.021171 s, Result = 294a0000, Performance =  58.83 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.021532 s, Result = 294f0000, Performance =  58.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.021925 s, Result = 29540000, Performance =  58.77 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.022386 s, Result = 29590000, Performance =  58.52 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.022916 s, Result = 295e0000, Performance =  58.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.022991 s, Result = 29630000, Performance =  58.85 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.025041 s, Result = 29680000, Performance =  54.88 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   538   449   896
Test passed: M N K =  1724  1232  1088
Test passed: M N K =  1062  1268  1472
Test passed: M N K =   889  1546   256
Test passed: M N K =   126    61   896
M N K =  2048  2048   256, Elapsed time =   0.000386 s, Result = 00050000, Performance =  55.57 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000693 s, Result = 000a0000, Performance =  62.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.001025 s, Result = 000f0000, Performance =  62.87 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001366 s, Result = 00140000, Performance =  62.90 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001691 s, Result = 00190000, Performance =  63.49 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002083 s, Result = 001e0000, Performance =  61.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002403 s, Result = 00230000, Performance =  62.56 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.002824 s, Result = 00280000, Performance =  60.84 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003190 s, Result = 002d0000, Performance =  60.59 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005153 s, Result = 00320000, Performance =  41.68 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.003864 s, Result = 00370000, Performance =  61.13 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.004410 s, Result = 003c0000, Performance =  58.43 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.004906 s, Result = 00410000, Performance =  56.91 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.005352 s, Result = 00460000, Performance =  56.17 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.005271 s, Result = 004b0000, Performance =  61.11 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.005965 s, Result = 00500000, Performance =  57.60 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.005401 s, Result = 00550000, Performance =  67.60 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.006044 s, Result = 005a0000, Performance =  63.95 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.005865 s, Result = 005f0000, Performance =  69.57 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.006162 s, Result = 00640000, Performance =  69.70 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.006346 s, Result = 00690000, Performance =  71.06 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.006903 s, Result = 006e0000, Performance =  68.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.006986 s, Result = 00730000, Performance =  70.70 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.007863 s, Result = 00780000, Performance =  65.54 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.007612 s, Result = 007d0000, Performance =  70.53 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.008155 s, Result = 00820000, Performance =  68.47 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.008416 s, Result = 00870000, Performance =  68.89 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.008581 s, Result = 008c0000, Performance =  70.07 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.009303 s, Result = 00910000, Performance =  66.94 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.009241 s, Result = 00960000, Performance =  69.72 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.009462 s, Result = 009b0000, Performance =  70.35 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.010786 s, Result = 00a00000, Performance =  63.71 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.010135 s, Result = 00a50000, Performance =  69.92 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.010416 s, Result = 00aa0000, Performance =  70.10 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.010987 s, Result = 00af0000, Performance =  68.41 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.010954 s, Result = 00b40000, Performance =  70.58 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.011226 s, Result = 00b90000, Performance =  70.78 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.011519 s, Result = 00be0000, Performance =  70.84 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.012434 s, Result = 00c30000, Performance =  67.35 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.013433 s, Result = 00c80000, Performance =  63.95 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.012856 s, Result = 00cd0000, Performance =  68.49 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.012978 s, Result = 00d20000, Performance =  69.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.013410 s, Result = 00d70000, Performance =  68.86 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.013457 s, Result = 00dc0000, Performance =  70.22 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.013911 s, Result = 00e10000, Performance =  69.47 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.014740 s, Result = 00e60000, Performance =  67.02 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.014656 s, Result = 00eb0000, Performance =  68.87 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.015987 s, Result = 00f00000, Performance =  64.48 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.015224 s, Result = 00f50000, Performance =  69.12 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.016049 s, Result = 00fa0000, Performance =  66.90 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.016011 s, Result = 00ff0000, Performance =  68.40 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.016160 s, Result = 01040000, Performance =  69.10 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.016453 s, Result = 01090000, Performance =  69.18 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.016842 s, Result = 010e0000, Performance =  68.85 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.017384 s, Result = 01130000, Performance =  67.94 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.018841 s, Result = 01180000, Performance =  63.83 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.018153 s, Result = 011d0000, Performance =  67.43 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.018613 s, Result = 01220000, Performance =  66.92 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.018394 s, Result = 01270000, Performance =  68.88 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.019545 s, Result = 012c0000, Performance =  65.92 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.019801 s, Result = 01310000, Performance =  66.16 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.019722 s, Result = 01360000, Performance =  67.51 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.020321 s, Result = 013b0000, Performance =  66.58 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.021587 s, Result = 01400000, Performance =  63.67 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1103  1846   704
Test passed: M N K =    73   489  1152
Test passed: M N K =   196  1812  1088
Test passed: M N K =   201   993   576
Test passed: M N K =   416   534  1024
M N K =  2048  2048   256, Elapsed time =   0.005589 s, Result = 84090000, Performance =   3.84 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006294 s, Result = 040e0000, Performance =   6.82 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006386 s, Result = 84130000, Performance =  10.09 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006518 s, Result = 04180000, Performance =  13.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007145 s, Result = 841d0000, Performance =  15.03 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007945 s, Result = 04220000, Performance =  16.22 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008685 s, Result = 84270000, Performance =  17.31 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008985 s, Result = 042c0000, Performance =  19.12 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008503 s, Result = 84310000, Performance =  22.73 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012068 s, Result = 04360000, Performance =  17.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010212 s, Result = 843b0000, Performance =  23.13 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009983 s, Result = 04400000, Performance =  25.81 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010310 s, Result = 84450000, Performance =  27.08 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011272 s, Result = 044a0000, Performance =  26.67 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011373 s, Result = 844f0000, Performance =  28.32 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011505 s, Result = 04540000, Performance =  29.87 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013698 s, Result = 84590000, Performance =  26.65 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013653 s, Result = 045e0000, Performance =  28.31 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013533 s, Result = 84630000, Performance =  30.15 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013447 s, Result = 04680000, Performance =  31.94 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014492 s, Result = 846d0000, Performance =  31.12 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.014179 s, Result = 04720000, Performance =  33.32 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.014983 s, Result = 84770000, Performance =  32.97 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.014554 s, Result = 047c0000, Performance =  35.41 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.015122 s, Result = 84810000, Performance =  35.50 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015641 s, Result = 04860000, Performance =  35.70 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.016468 s, Result = 848b0000, Performance =  35.21 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.015438 s, Result = 04900000, Performance =  38.95 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.016725 s, Result = 84950000, Performance =  37.23 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.016810 s, Result = 049a0000, Performance =  38.33 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.017348 s, Result = 849f0000, Performance =  38.37 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.017100 s, Result = 04a40000, Performance =  40.19 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.017788 s, Result = 84a90000, Performance =  39.84 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.018012 s, Result = 04ae0000, Performance =  40.54 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.017889 s, Result = 84b30000, Performance =  42.02 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.017898 s, Result = 04b80000, Performance =  43.19 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.018393 s, Result = 84bd0000, Performance =  43.20 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.018906 s, Result = 04c20000, Performance =  43.16 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.019520 s, Result = 84c70000, Performance =  42.91 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.019215 s, Result = 04cc0000, Performance =  44.70 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.020130 s, Result = 84d10000, Performance =  43.74 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.020303 s, Result = 04d60000, Performance =  44.42 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.020893 s, Result = 84db0000, Performance =  44.20 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.020617 s, Result = 04e00000, Performance =  45.83 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.021629 s, Result = 84e50000, Performance =  44.68 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.021825 s, Result = 04ea0000, Performance =  45.26 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.022400 s, Result = 84ef0000, Performance =  45.06 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.021949 s, Result = 04f40000, Performance =  46.96 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.022703 s, Result = 84f90000, Performance =  46.35 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.023189 s, Result = 04fe0000, Performance =  46.30 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.026285 s, Result = 85030000, Performance =  41.67 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.024204 s, Result = 05080000, Performance =  46.14 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.024781 s, Result = 850d0000, Performance =  45.93 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.025367 s, Result = 05120000, Performance =  45.71 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.025926 s, Result = 85170000, Performance =  45.56 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.025590 s, Result = 051c0000, Performance =  47.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.026514 s, Result = 85210000, Performance =  46.17 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.027084 s, Result = 05260000, Performance =  45.99 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.027481 s, Result = 852b0000, Performance =  46.10 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.027095 s, Result = 05300000, Performance =  47.55 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.028062 s, Result = 85350000, Performance =  46.68 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.028233 s, Result = 053a0000, Performance =  47.16 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.028464 s, Result = 853f0000, Performance =  47.53 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.027804 s, Result = 05440000, Performance =  49.43 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1542  1348  2048
Test passed: M N K =   205  1605   640
Test passed: M N K =  1131  1317  1728
Test passed: M N K =  1148   759  1664
Test passed: M N K =   854  1127  1920
M N K =  2048  2048   256, Elapsed time =   0.003803 s, Result = 00050000, Performance =   5.65 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004450 s, Result = 000a0000, Performance =   9.65 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004635 s, Result = 000f0000, Performance =  13.90 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004896 s, Result = 00140000, Performance =  17.55 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005255 s, Result = 00190000, Performance =  20.43 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006316 s, Result = 001e0000, Performance =  20.40 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007416 s, Result = 00230000, Performance =  20.27 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007945 s, Result = 00280000, Performance =  21.62 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007984 s, Result = 002d0000, Performance =  24.21 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011317 s, Result = 00320000, Performance =  18.98 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.009509 s, Result = 00370000, Performance =  24.84 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009463 s, Result = 003c0000, Performance =  27.23 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.009704 s, Result = 00410000, Performance =  28.77 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010692 s, Result = 00460000, Performance =  28.12 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009968 s, Result = 004b0000, Performance =  32.32 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011443 s, Result = 00500000, Performance =  30.03 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011005 s, Result = 00550000, Performance =  33.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012646 s, Result = 005a0000, Performance =  30.57 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012041 s, Result = 005f0000, Performance =  33.89 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.012368 s, Result = 00640000, Performance =  34.73 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012589 s, Result = 00690000, Performance =  35.82 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013189 s, Result = 006e0000, Performance =  35.82 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.013660 s, Result = 00730000, Performance =  36.16 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.013478 s, Result = 00780000, Performance =  38.24 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014747 s, Result = 007d0000, Performance =  36.41 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.014386 s, Result = 00820000, Performance =  38.81 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.014904 s, Result = 00870000, Performance =  38.90 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.015295 s, Result = 008c0000, Performance =  39.31 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.015518 s, Result = 00910000, Performance =  40.13 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.015413 s, Result = 00960000, Performance =  41.80 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.015334 s, Result = 009b0000, Performance =  43.42 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.015793 s, Result = 00a00000, Performance =  43.51 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.015852 s, Result = 00a50000, Performance =  44.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.016688 s, Result = 00aa0000, Performance =  43.75 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.016453 s, Result = 00af0000, Performance =  45.68 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.016807 s, Result = 00b40000, Performance =  46.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.017410 s, Result = 00b90000, Performance =  45.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.017204 s, Result = 00be0000, Performance =  47.43 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.017896 s, Result = 00c30000, Performance =  46.80 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.017906 s, Result = 00c80000, Performance =  47.97 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.018764 s, Result = 00cd0000, Performance =  46.92 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.018456 s, Result = 00d20000, Performance =  48.87 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.019003 s, Result = 00d70000, Performance =  48.59 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.019395 s, Result = 00dc0000, Performance =  48.72 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.020233 s, Result = 00e10000, Performance =  47.76 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.020181 s, Result = 00e60000, Performance =  48.95 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.021066 s, Result = 00eb0000, Performance =  47.91 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.020044 s, Result = 00f00000, Performance =  51.43 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.021436 s, Result = 00f50000, Performance =  49.09 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.022107 s, Result = 00fa0000, Performance =  48.57 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.022627 s, Result = 00ff0000, Performance =  48.40 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.022555 s, Result = 01040000, Performance =  49.51 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.023634 s, Result = 01090000, Performance =  48.16 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.023590 s, Result = 010e0000, Performance =  49.16 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.024024 s, Result = 01130000, Performance =  49.16 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.024133 s, Result = 01180000, Performance =  49.83 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.024477 s, Result = 011d0000, Performance =  50.01 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.025314 s, Result = 01220000, Performance =  49.20 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.025518 s, Result = 01270000, Performance =  49.65 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.025673 s, Result = 012c0000, Performance =  50.19 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.027091 s, Result = 01310000, Performance =  48.35 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.026519 s, Result = 01360000, Performance =  50.21 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.027108 s, Result = 013b0000, Performance =  49.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.026067 s, Result = 01400000, Performance =  52.73 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1067   942  1728
Test passed: M N K =   574  1130  2048
Test passed: M N K =  1116   349   512
Test passed: M N K =  1681    81  1600
Test passed: M N K =   212  1150  1344
M N K =  2048  2048   256, Elapsed time =   0.002957 s, Result = 282d0000, Performance =   7.26 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003513 s, Result = 28320000, Performance =  12.23 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003865 s, Result = 28370000, Performance =  16.67 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004238 s, Result = 283c0000, Performance =  20.27 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004456 s, Result = 28410000, Performance =  24.10 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004831 s, Result = 28460000, Performance =  26.67 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005211 s, Result = 284b0000, Performance =  28.85 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005571 s, Result = 28500000, Performance =  30.84 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005802 s, Result = 28550000, Performance =  33.31 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009039 s, Result = 285a0000, Performance =  23.76 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006809 s, Result = 285f0000, Performance =  34.69 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007167 s, Result = 28640000, Performance =  35.96 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007349 s, Result = 28690000, Performance =  37.99 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007839 s, Result = 286e0000, Performance =  38.35 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008395 s, Result = 28730000, Performance =  38.37 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008715 s, Result = 28780000, Performance =  39.42 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009004 s, Result = 287d0000, Performance =  40.55 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009481 s, Result = 28820000, Performance =  40.77 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.009987 s, Result = 28870000, Performance =  40.86 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.010305 s, Result = 288c0000, Performance =  41.68 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010470 s, Result = 28910000, Performance =  43.07 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.010900 s, Result = 28960000, Performance =  43.34 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.011431 s, Result = 289b0000, Performance =  43.21 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.011516 s, Result = 28a00000, Performance =  44.75 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.011785 s, Result = 28a50000, Performance =  45.56 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.012448 s, Result = 28aa0000, Performance =  44.85 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.012741 s, Result = 28af0000, Performance =  45.51 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.012847 s, Result = 28b40000, Performance =  46.81 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.013354 s, Result = 28b90000, Performance =  46.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.013731 s, Result = 28be0000, Performance =  46.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.014173 s, Result = 28c30000, Performance =  46.97 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.014151 s, Result = 28c80000, Performance =  48.56 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.014916 s, Result = 28cd0000, Performance =  47.51 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.014706 s, Result = 28d20000, Performance =  49.65 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.015629 s, Result = 28d70000, Performance =  48.09 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.015592 s, Result = 28dc0000, Performance =  49.58 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.016197 s, Result = 28e10000, Performance =  49.06 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.016538 s, Result = 28e60000, Performance =  49.34 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.017079 s, Result = 28eb0000, Performance =  49.04 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.017030 s, Result = 28f00000, Performance =  50.44 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.017549 s, Result = 28f50000, Performance =  50.17 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.017942 s, Result = 28fa0000, Performance =  50.27 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.018450 s, Result = 28ff0000, Performance =  50.05 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.018453 s, Result = 29040000, Performance =  51.21 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.019046 s, Result = 29090000, Performance =  50.74 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.019763 s, Result = 290e0000, Performance =  49.98 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.020278 s, Result = 29130000, Performance =  49.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.019224 s, Result = 29180000, Performance =  53.62 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.020722 s, Result = 291d0000, Performance =  50.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.021126 s, Result = 29220000, Performance =  50.83 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.021592 s, Result = 29270000, Performance =  50.72 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.021862 s, Result = 292c0000, Performance =  51.08 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.022602 s, Result = 29310000, Performance =  50.36 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.022831 s, Result = 29360000, Performance =  50.79 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.023542 s, Result = 293b0000, Performance =  50.17 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.023069 s, Result = 29400000, Performance =  52.13 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.023888 s, Result = 29450000, Performance =  51.24 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.024314 s, Result = 294a0000, Performance =  51.23 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.024796 s, Result = 294f0000, Performance =  51.10 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.024818 s, Result = 29540000, Performance =  51.92 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.026909 s, Result = 29590000, Performance =  48.68 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.025691 s, Result = 295e0000, Performance =  51.83 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.026189 s, Result = 29630000, Performance =  51.66 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.025658 s, Result = 29680000, Performance =  53.56 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   838  2000    64
Test passed: M N K =  1318   822  1088
Test passed: M N K =   140   619  1856
Test passed: M N K =   331  1904  1600
Test passed: M N K =  1975   215  1856
M N K =  2048  2048   256, Elapsed time =   0.000374 s, Result = 00050000, Performance =  57.45 TOPS
M N K =  2048  2048   512, Elapsed time =   0.000700 s, Result = 000a0000, Performance =  61.33 TOPS
M N K =  2048  2048   768, Elapsed time =   0.000996 s, Result = 000f0000, Performance =  64.71 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.001318 s, Result = 00140000, Performance =  65.16 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.001674 s, Result = 00190000, Performance =  64.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002083 s, Result = 001e0000, Performance =  61.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002416 s, Result = 00230000, Performance =  62.21 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.002877 s, Result = 00280000, Performance =  59.72 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003127 s, Result = 002d0000, Performance =  61.80 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005329 s, Result = 00320000, Performance =  40.30 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.004111 s, Result = 00370000, Performance =  57.47 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.004609 s, Result = 003c0000, Performance =  55.91 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.004837 s, Result = 00410000, Performance =  57.72 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.005340 s, Result = 00460000, Performance =  56.30 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.005884 s, Result = 004b0000, Performance =  54.75 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.006255 s, Result = 00500000, Performance =  54.93 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.006292 s, Result = 00550000, Performance =  58.02 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.006781 s, Result = 005a0000, Performance =  57.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.007270 s, Result = 005f0000, Performance =  56.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.007691 s, Result = 00640000, Performance =  55.84 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.007907 s, Result = 00690000, Performance =  57.04 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.008139 s, Result = 006e0000, Performance =  58.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.008562 s, Result = 00730000, Performance =  57.69 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.008651 s, Result = 00780000, Performance =  59.58 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.009115 s, Result = 007d0000, Performance =  58.90 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.009365 s, Result = 00820000, Performance =  59.62 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.010010 s, Result = 00870000, Performance =  57.92 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.009968 s, Result = 008c0000, Performance =  60.32 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.010739 s, Result = 00910000, Performance =  57.99 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.010802 s, Result = 00960000, Performance =  59.64 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.011468 s, Result = 009b0000, Performance =  58.05 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.011239 s, Result = 00a00000, Performance =  61.15 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.011944 s, Result = 00a50000, Performance =  59.33 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.012201 s, Result = 00aa0000, Performance =  59.84 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.012762 s, Result = 00af0000, Performance =  58.90 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.012605 s, Result = 00b40000, Performance =  61.33 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.013719 s, Result = 00b90000, Performance =  57.92 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.013788 s, Result = 00be0000, Performance =  59.19 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.014588 s, Result = 00c30000, Performance =  57.41 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.013729 s, Result = 00c80000, Performance =  62.57 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.013817 s, Result = 00cd0000, Performance =  63.73 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.015074 s, Result = 00d20000, Performance =  59.83 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.015407 s, Result = 00d70000, Performance =  59.94 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.015090 s, Result = 00dc0000, Performance =  62.62 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.015830 s, Result = 00e10000, Performance =  61.05 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.016627 s, Result = 00e60000, Performance =  59.41 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.017015 s, Result = 00eb0000, Performance =  59.32 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.016774 s, Result = 00f00000, Performance =  61.45 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.017730 s, Result = 00f50000, Performance =  59.35 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.018221 s, Result = 00fa0000, Performance =  58.93 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.018297 s, Result = 00ff0000, Performance =  59.86 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.018321 s, Result = 01040000, Performance =  60.95 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.019289 s, Result = 01090000, Performance =  59.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.019598 s, Result = 010e0000, Performance =  59.17 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.020085 s, Result = 01130000, Performance =  58.81 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.019779 s, Result = 01180000, Performance =  60.80 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.020763 s, Result = 011d0000, Performance =  58.95 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.021360 s, Result = 01220000, Performance =  58.31 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.022093 s, Result = 01270000, Performance =  57.35 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.021543 s, Result = 012c0000, Performance =  59.81 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.022229 s, Result = 01310000, Performance =  58.93 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.022692 s, Result = 01360000, Performance =  58.68 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.023142 s, Result = 013b0000, Performance =  58.46 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.022829 s, Result = 01400000, Performance =  60.20 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1616  1048    64
Test passed: M N K =   913  1966    64
Test passed: M N K =  1679   981  1792
Test passed: M N K =  1986  1735  1728
Test passed: M N K =  1122  1057   896
M N K =  4096  4096   256, Elapsed time =   0.010310 s, Result = 90600000, Performance =   8.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010642 s, Result = 10b00000, Performance =  16.14 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011742 s, Result = 91000000, Performance =  21.95 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012633 s, Result = 11500000, Performance =  27.20 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014144 s, Result = 91a00000, Performance =  30.37 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013976 s, Result = 11f00000, Performance =  36.88 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014683 s, Result = 92400000, Performance =  40.95 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015452 s, Result = 12900000, Performance =  44.47 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016218 s, Result = 92e00000, Performance =  47.67 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017019 s, Result = 13300000, Performance =  50.47 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017869 s, Result = 93800000, Performance =  52.88 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.018702 s, Result = 13d00000, Performance =  55.12 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.019709 s, Result = 94200000, Performance =  56.66 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020782 s, Result = 14700000, Performance =  57.87 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021849 s, Result = 94c00000, Performance =  58.97 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.023492 s, Result = 15100000, Performance =  58.50 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023780 s, Result = 95600000, Performance =  61.41 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024693 s, Result = 15b00000, Performance =  62.62 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025225 s, Result = 96000000, Performance =  64.70 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026090 s, Result = 16500000, Performance =  65.85 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.026960 s, Result = 96a00000, Performance =  66.91 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.027619 s, Result = 16f00000, Performance =  68.42 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.028514 s, Result = 97400000, Performance =  69.29 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.029798 s, Result = 17900000, Performance =  69.18 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.030413 s, Result = 97e00000, Performance =  70.61 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.031305 s, Result = 18300000, Performance =  71.34 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.033232 s, Result = 98800000, Performance =  69.79 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.034142 s, Result = 18d00000, Performance =  70.45 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.034560 s, Result = 99200000, Performance =  72.08 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.035439 s, Result = 19700000, Performance =  72.72 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.036280 s, Result = 99c00000, Performance =  73.40 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.037997 s, Result = 1a100000, Performance =  72.34 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.037892 s, Result = 9a600000, Performance =  74.81 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.039029 s, Result = 1ab00000, Performance =  74.83 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.039694 s, Result = 9b000000, Performance =  75.74 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.041068 s, Result = 1b500000, Performance =  75.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.042265 s, Result = 9ba00000, Performance =  75.20 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.042955 s, Result = 1bf00000, Performance =  75.99 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.044026 s, Result = 9c400000, Performance =  76.09 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.044391 s, Result = 1c900000, Performance =  77.40 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.045307 s, Result = 9ce00000, Performance =  77.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.046494 s, Result = 1d300000, Performance =  77.60 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.047606 s, Result = 9d800000, Performance =  77.59 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.048430 s, Result = 1dd00000, Performance =  78.04 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.048892 s, Result = 9e200000, Performance =  79.06 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.050207 s, Result = 1e700000, Performance =  78.70 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.051987 s, Result = 9ec00000, Performance =  77.66 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.052595 s, Result = 1f100000, Performance =  78.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.053680 s, Result = 9f600000, Performance =  78.41 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.055041 s, Result = 1fb00000, Performance =  78.03 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.055411 s, Result = a0000000, Performance =  79.06 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.056892 s, Result = 20500000, Performance =  78.51 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.058663 s, Result = a0a00000, Performance =  77.61 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.059284 s, Result = 20f00000, Performance =  78.24 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.061219 s, Result = a1400000, Performance =  77.17 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.062161 s, Result = 21900000, Performance =  77.39 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.063712 s, Result = a1e00000, Performance =  76.85 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.064981 s, Result = 22300000, Performance =  76.67 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.066284 s, Result = a2800000, Performance =  76.46 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.067497 s, Result = 22d00000, Performance =  76.36 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.068324 s, Result = a3200000, Performance =  76.69 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.070071 s, Result = 23700000, Performance =  76.01 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.072727 s, Result = a3c00000, Performance =  74.41 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.074831 s, Result = 24100000, Performance =  73.47 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    51   359  1792
Test passed: M N K =   794   284  1600
Test passed: M N K =    45    43   704
Test passed: M N K =  1083   507    64
Test passed: M N K =   484    75   832
M N K =  4096  4096   256, Elapsed time =   0.013939 s, Result = 00500000, Performance =   6.16 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012909 s, Result = 00a00000, Performance =  13.31 TOPS
M N K =  4096  4096   768, Elapsed time =   0.014115 s, Result = 00f00000, Performance =  18.26 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.014144 s, Result = 01400000, Performance =  24.29 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014862 s, Result = 01900000, Performance =  28.90 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015269 s, Result = 01e00000, Performance =  33.75 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.016300 s, Result = 02300000, Performance =  36.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016345 s, Result = 02800000, Performance =  42.04 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.018542 s, Result = 02d00000, Performance =  41.70 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017907 s, Result = 03200000, Performance =  47.97 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017984 s, Result = 03700000, Performance =  52.54 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019094 s, Result = 03c00000, Performance =  53.99 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020031 s, Result = 04100000, Performance =  55.75 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020487 s, Result = 04600000, Performance =  58.70 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021091 s, Result = 04b00000, Performance =  61.09 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022040 s, Result = 05000000, Performance =  62.36 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022472 s, Result = 05500000, Performance =  64.98 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.023439 s, Result = 05a00000, Performance =  65.97 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.024226 s, Result = 05f00000, Performance =  67.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.025309 s, Result = 06400000, Performance =  67.88 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.026008 s, Result = 06900000, Performance =  69.36 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.026924 s, Result = 06e00000, Performance =  70.19 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.027365 s, Result = 07300000, Performance =  72.20 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.028552 s, Result = 07800000, Performance =  72.20 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.029392 s, Result = 07d00000, Performance =  73.06 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.030281 s, Result = 08200000, Performance =  73.76 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.031199 s, Result = 08700000, Performance =  74.34 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.032333 s, Result = 08c00000, Performance =  74.39 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.032878 s, Result = 09100000, Performance =  75.77 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.033240 s, Result = 09600000, Performance =  77.53 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.034422 s, Result = 09b00000, Performance =  77.36 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.036424 s, Result = 0a000000, Performance =  75.47 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.036056 s, Result = 0a500000, Performance =  78.62 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.037283 s, Result = 0aa00000, Performance =  78.34 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.037541 s, Result = 0af00000, Performance =  80.08 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.039238 s, Result = 0b400000, Performance =  78.81 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.039236 s, Result = 0b900000, Performance =  81.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.040450 s, Result = 0be00000, Performance =  80.70 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.041124 s, Result = 0c300000, Performance =  81.46 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.042504 s, Result = 0c800000, Performance =  80.84 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.043361 s, Result = 0cd00000, Performance =  81.22 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.043532 s, Result = 0d200000, Performance =  82.88 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.045346 s, Result = 0d700000, Performance =  81.45 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.045730 s, Result = 0dc00000, Performance =  82.65 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.046588 s, Result = 0e100000, Performance =  82.97 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.047792 s, Result = 0e600000, Performance =  82.68 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.048387 s, Result = 0eb00000, Performance =  83.44 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.050182 s, Result = 0f000000, Performance =  82.16 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.049875 s, Result = 0f500000, Performance =  84.39 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.050511 s, Result = 0fa00000, Performance =  85.03 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.052050 s, Result = 0ff00000, Performance =  84.17 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.052630 s, Result = 10400000, Performance =  84.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.053481 s, Result = 10900000, Performance =  85.13 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.054770 s, Result = 10e00000, Performance =  84.69 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.055450 s, Result = 11300000, Performance =  85.20 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.057052 s, Result = 11800000, Performance =  84.31 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.057678 s, Result = 11d00000, Performance =  84.89 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.059602 s, Result = 12200000, Performance =  83.59 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.060371 s, Result = 12700000, Performance =  83.95 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.061535 s, Result = 12c00000, Performance =  83.76 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.061542 s, Result = 13100000, Performance =  85.14 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.063231 s, Result = 13600000, Performance =  84.23 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.064908 s, Result = 13b00000, Performance =  83.37 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.067227 s, Result = 14000000, Performance =  81.78 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1285  1914  1088
Test passed: M N K =  1120   418   576
Test passed: M N K =   899   245   448
Test passed: M N K =   560  1712   704
Test passed: M N K =   920  1344   320
M N K =  4096  4096   256, Elapsed time =   0.006315 s, Result = a0f00000, Performance =  13.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006605 s, Result = a1400000, Performance =  26.01 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007577 s, Result = a1900000, Performance =  34.01 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008155 s, Result = a1e00000, Performance =  42.13 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008819 s, Result = a2300000, Performance =  48.70 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009672 s, Result = a2800000, Performance =  53.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010210 s, Result = a2d00000, Performance =  58.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011130 s, Result = a3200000, Performance =  61.74 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011733 s, Result = a3700000, Performance =  65.89 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012495 s, Result = a3c00000, Performance =  68.75 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013666 s, Result = a4100000, Performance =  69.14 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014020 s, Result = a4600000, Performance =  73.52 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015044 s, Result = a4b00000, Performance =  74.23 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015959 s, Result = a5000000, Performance =  75.35 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016699 s, Result = a5500000, Performance =  77.16 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020670 s, Result = a5a00000, Performance =  66.49 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018567 s, Result = a5f00000, Performance =  78.65 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019767 s, Result = a6400000, Performance =  78.22 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020644 s, Result = a6900000, Performance =  79.06 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021509 s, Result = a6e00000, Performance =  79.87 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022264 s, Result = a7300000, Performance =  81.02 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023159 s, Result = a7800000, Performance =  81.60 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.024331 s, Result = a7d00000, Performance =  81.20 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.036933 s, Result = a8200000, Performance =  55.82 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026051 s, Result = a8700000, Performance =  82.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.027072 s, Result = a8c00000, Performance =  82.50 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027732 s, Result = a9100000, Performance =  83.63 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.028963 s, Result = a9600000, Performance =  83.04 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029661 s, Result = a9b00000, Performance =  83.99 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030414 s, Result = aa000000, Performance =  84.73 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.031139 s, Result = aa500000, Performance =  85.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.033259 s, Result = aaa00000, Performance =  82.65 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.032920 s, Result = aaf00000, Performance =  86.11 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034063 s, Result = ab400000, Performance =  85.74 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.034559 s, Result = ab900000, Performance =  87.00 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.035754 s, Result = abe00000, Performance =  86.49 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036506 s, Result = ac300000, Performance =  87.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037385 s, Result = ac800000, Performance =  87.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.038420 s, Result = acd00000, Performance =  87.20 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039875 s, Result = ad200000, Performance =  86.17 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.040215 s, Result = ad700000, Performance =  87.58 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.041159 s, Result = adc00000, Performance =  87.65 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.042066 s, Result = ae100000, Performance =  87.81 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.042873 s, Result = ae600000, Performance =  88.16 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.044074 s, Result = aeb00000, Performance =  87.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.044664 s, Result = af000000, Performance =  88.47 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.044809 s, Result = af500000, Performance =  90.10 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.046970 s, Result = afa00000, Performance =  87.78 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.047559 s, Result = aff00000, Performance =  88.50 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.048620 s, Result = b0400000, Performance =  88.34 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.049367 s, Result = b0900000, Performance =  88.74 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050683 s, Result = b0e00000, Performance =  88.13 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.051823 s, Result = b1300000, Performance =  87.85 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052720 s, Result = b1800000, Performance =  87.98 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.054296 s, Result = b1d00000, Performance =  87.01 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.055253 s, Result = b2200000, Performance =  87.06 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.056021 s, Result = b2700000, Performance =  87.40 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.057492 s, Result = b2c00000, Performance =  86.66 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.058589 s, Result = b3100000, Performance =  86.50 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.059479 s, Result = b3600000, Performance =  86.65 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.061372 s, Result = b3b00000, Performance =  85.38 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.062005 s, Result = b4000000, Performance =  85.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.063608 s, Result = b4500000, Performance =  85.08 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.066868 s, Result = b4a00000, Performance =  82.22 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1179  1455  1856
Test passed: M N K =   195  1517   640
Test passed: M N K =  1216  1873   384
Test passed: M N K =   244   580  1472
Test passed: M N K =  1138   485  1280
M N K =  4096  4096   256, Elapsed time =   0.001103 s, Result = 00500000, Performance =  77.90 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001765 s, Result = 00a00000, Performance =  97.34 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002573 s, Result = 00f00000, Performance = 100.15 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003364 s, Result = 01400000, Performance = 102.15 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004125 s, Result = 01900000, Performance = 104.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005221 s, Result = 01e00000, Performance =  98.72 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005850 s, Result = 02300000, Performance = 102.79 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006611 s, Result = 02800000, Performance = 103.95 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007177 s, Result = 02d00000, Performance = 107.71 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008087 s, Result = 03200000, Performance = 106.22 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009289 s, Result = 03700000, Performance = 101.73 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010043 s, Result = 03c00000, Performance = 102.63 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011154 s, Result = 04100000, Performance = 100.11 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011741 s, Result = 04600000, Performance = 102.43 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012861 s, Result = 04b00000, Performance = 100.18 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014864 s, Result = 05000000, Performance =  92.47 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015302 s, Result = 05500000, Performance =  95.43 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.015438 s, Result = 05a00000, Performance = 100.15 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.016481 s, Result = 05f00000, Performance =  99.03 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017323 s, Result = 06400000, Performance =  99.17 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018420 s, Result = 06900000, Performance =  97.93 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019283 s, Result = 06e00000, Performance =  98.00 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020328 s, Result = 07300000, Performance =  97.19 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021442 s, Result = 07800000, Performance =  96.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.021703 s, Result = 07d00000, Performance =  98.95 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022802 s, Result = 08200000, Performance =  97.95 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023711 s, Result = 08700000, Performance =  97.81 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024765 s, Result = 08c00000, Performance =  97.12 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.025537 s, Result = 09100000, Performance =  97.55 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026225 s, Result = 09600000, Performance =  98.26 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026824 s, Result = 09b00000, Performance =  99.27 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.029139 s, Result = 0a000000, Performance =  94.33 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.028533 s, Result = 0a500000, Performance =  99.35 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.029597 s, Result = 0aa00000, Performance =  98.68 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030456 s, Result = 0af00000, Performance =  98.72 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.031268 s, Result = 0b400000, Performance =  98.90 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.032241 s, Result = 0b900000, Performance =  98.58 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.033103 s, Result = 0be00000, Performance =  98.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.033991 s, Result = 0c300000, Performance =  98.56 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034847 s, Result = 0c800000, Performance =  98.60 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035601 s, Result = 0cd00000, Performance =  98.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036290 s, Result = 0d200000, Performance =  99.42 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036993 s, Result = 0d700000, Performance =  99.85 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.038151 s, Result = 0dc00000, Performance =  99.07 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038824 s, Result = 0e100000, Performance =  99.57 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.039586 s, Result = 0e600000, Performance =  99.82 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.040070 s, Result = 0eb00000, Performance = 100.76 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.041953 s, Result = 0f000000, Performance =  98.28 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041931 s, Result = 0f500000, Performance = 100.38 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.042842 s, Result = 0fa00000, Performance = 100.25 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.043718 s, Result = 0ff00000, Performance = 100.21 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.044698 s, Result = 10400000, Performance =  99.93 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.045436 s, Result = 10900000, Performance = 100.20 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.046884 s, Result = 10e00000, Performance =  98.94 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.047569 s, Result = 11300000, Performance =  99.32 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.048735 s, Result = 11800000, Performance =  98.70 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.049394 s, Result = 11d00000, Performance =  99.13 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.050889 s, Result = 12200000, Performance =  97.90 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.052132 s, Result = 12700000, Performance =  97.22 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.052465 s, Result = 12c00000, Performance =  98.24 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.053799 s, Result = 13100000, Performance =  97.40 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.054983 s, Result = 13600000, Performance =  96.86 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055498 s, Result = 13b00000, Performance =  97.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057967 s, Result = 14000000, Performance =  94.84 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1230   695   256
Test passed: M N K =   691  1450  1920
Test passed: M N K =  1750  1515   448
Test passed: M N K =  1062  1918  1856
Test passed: M N K =  1844  1563  1600
M N K =  4096  4096   256, Elapsed time =   0.010080 s, Result = 90600000, Performance =   8.52 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011003 s, Result = 10b00000, Performance =  15.61 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011532 s, Result = 91000000, Performance =  22.35 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.014085 s, Result = 11500000, Performance =  24.40 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012775 s, Result = 91a00000, Performance =  33.62 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013826 s, Result = 11f00000, Performance =  37.28 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014841 s, Result = 92400000, Performance =  40.52 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015380 s, Result = 12900000, Performance =  44.68 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016411 s, Result = 92e00000, Performance =  47.11 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017131 s, Result = 13300000, Performance =  50.14 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018325 s, Result = 93800000, Performance =  51.56 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019183 s, Result = 13d00000, Performance =  53.73 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020241 s, Result = 94200000, Performance =  55.17 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.028897 s, Result = 14700000, Performance =  41.62 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.022201 s, Result = 94c00000, Performance =  58.04 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.024415 s, Result = 15100000, Performance =  56.29 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023745 s, Result = 95600000, Performance =  61.50 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024801 s, Result = 15b00000, Performance =  62.34 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025604 s, Result = 96000000, Performance =  63.74 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026439 s, Result = 16500000, Performance =  64.98 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.027313 s, Result = 96a00000, Performance =  66.04 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.028504 s, Result = 16f00000, Performance =  66.30 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.029245 s, Result = 97400000, Performance =  67.56 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.030787 s, Result = 17900000, Performance =  66.96 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.031110 s, Result = 97e00000, Performance =  69.03 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.032172 s, Result = 18300000, Performance =  69.42 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.033049 s, Result = 98800000, Performance =  70.18 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.034079 s, Result = 18d00000, Performance =  70.58 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.034814 s, Result = 99200000, Performance =  71.55 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.035433 s, Result = 19700000, Performance =  72.73 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.036058 s, Result = 99c00000, Performance =  73.85 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.041425 s, Result = 1a100000, Performance =  66.36 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.037645 s, Result = 9a600000, Performance =  75.30 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.038927 s, Result = 1ab00000, Performance =  75.03 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.039608 s, Result = 9b000000, Performance =  75.91 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.040792 s, Result = 1b500000, Performance =  75.81 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.041631 s, Result = 9ba00000, Performance =  76.34 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.042796 s, Result = 1bf00000, Performance =  76.27 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.043270 s, Result = 9c400000, Performance =  77.42 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.045862 s, Result = 1c900000, Performance =  74.92 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.045063 s, Result = 9ce00000, Performance =  78.15 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.046185 s, Result = 1d300000, Performance =  78.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.046746 s, Result = 9d800000, Performance =  79.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.047603 s, Result = 1dd00000, Performance =  79.40 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.048834 s, Result = 9e200000, Performance =  79.16 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.049401 s, Result = 1e700000, Performance =  79.99 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.050323 s, Result = 9ec00000, Performance =  80.23 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.056685 s, Result = 1f100000, Performance =  72.74 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.051860 s, Result = 9f600000, Performance =  81.16 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.052966 s, Result = 1fb00000, Performance =  81.09 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.054068 s, Result = a0000000, Performance =  81.02 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.055229 s, Result = 20500000, Performance =  80.88 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.056464 s, Result = a0a00000, Performance =  80.63 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.057448 s, Result = 20f00000, Performance =  80.74 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.058408 s, Result = a1400000, Performance =  80.89 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.060854 s, Result = 21900000, Performance =  79.05 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.060316 s, Result = a1e00000, Performance =  81.18 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.061742 s, Result = 22300000, Performance =  80.69 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.062999 s, Result = a2800000, Performance =  80.45 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.063904 s, Result = 22d00000, Performance =  80.65 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.065395 s, Result = a3200000, Performance =  80.13 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.066123 s, Result = 23700000, Performance =  80.54 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.067374 s, Result = a3c00000, Performance =  80.32 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.079147 s, Result = 24100000, Performance =  69.46 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1843   561  1408
Test passed: M N K =  1724  1841  1984
Test passed: M N K =  1064   170  1920
Test passed: M N K =  1492    15  1152
Test passed: M N K =  1368   772   640
M N K =  4096  4096   256, Elapsed time =   0.013301 s, Result = 00500000, Performance =   6.46 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012432 s, Result = 00a00000, Performance =  13.82 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013697 s, Result = 00f00000, Performance =  18.81 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.014325 s, Result = 01400000, Performance =  23.99 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014722 s, Result = 01900000, Performance =  29.17 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015437 s, Result = 01e00000, Performance =  33.39 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015805 s, Result = 02300000, Performance =  38.05 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016442 s, Result = 02800000, Performance =  41.80 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.017554 s, Result = 02d00000, Performance =  44.04 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017705 s, Result = 03200000, Performance =  48.52 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018821 s, Result = 03700000, Performance =  50.20 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019082 s, Result = 03c00000, Performance =  54.02 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020567 s, Result = 04100000, Performance =  54.30 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.023215 s, Result = 04600000, Performance =  51.80 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021681 s, Result = 04b00000, Performance =  59.43 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.023208 s, Result = 05000000, Performance =  59.22 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023459 s, Result = 05500000, Performance =  62.25 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024074 s, Result = 05a00000, Performance =  64.23 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025032 s, Result = 05f00000, Performance =  65.20 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.025743 s, Result = 06400000, Performance =  66.74 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.026786 s, Result = 06900000, Performance =  67.34 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.027376 s, Result = 06e00000, Performance =  69.03 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.033407 s, Result = 07300000, Performance =  59.14 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.029609 s, Result = 07800000, Performance =  69.63 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.030336 s, Result = 07d00000, Performance =  70.79 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.031321 s, Result = 08200000, Performance =  71.31 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.032092 s, Result = 08700000, Performance =  72.27 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.033206 s, Result = 08c00000, Performance =  72.43 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.034165 s, Result = 09100000, Performance =  72.91 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.034114 s, Result = 09600000, Performance =  75.54 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.035693 s, Result = 09b00000, Performance =  74.60 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.039783 s, Result = 0a000000, Performance =  69.09 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.037032 s, Result = 0a500000, Performance =  76.55 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.038019 s, Result = 0aa00000, Performance =  76.82 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.038555 s, Result = 0af00000, Performance =  77.98 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.040627 s, Result = 0b400000, Performance =  76.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.041187 s, Result = 0b900000, Performance =  77.17 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.041483 s, Result = 0be00000, Performance =  78.69 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.042912 s, Result = 0c300000, Performance =  78.07 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.044203 s, Result = 0c800000, Performance =  77.73 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.043741 s, Result = 0cd00000, Performance =  80.52 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.045270 s, Result = 0d200000, Performance =  79.69 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.045752 s, Result = 0d700000, Performance =  80.73 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.047354 s, Result = 0dc00000, Performance =  79.82 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.046903 s, Result = 0e100000, Performance =  82.41 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.048061 s, Result = 0e600000, Performance =  82.21 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.048429 s, Result = 0eb00000, Performance =  83.36 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.054652 s, Result = 0f000000, Performance =  75.44 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.050573 s, Result = 0f500000, Performance =  83.23 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.051541 s, Result = 0fa00000, Performance =  83.33 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.052869 s, Result = 0ff00000, Performance =  82.86 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.054175 s, Result = 10400000, Performance =  82.45 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.054685 s, Result = 10900000, Performance =  83.25 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.055331 s, Result = 10e00000, Performance =  83.83 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.056721 s, Result = 11300000, Performance =  83.29 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.058651 s, Result = 11800000, Performance =  82.02 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.057989 s, Result = 11d00000, Performance =  84.43 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.059140 s, Result = 12200000, Performance =  84.24 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.059539 s, Result = 12700000, Performance =  85.12 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.060940 s, Result = 12c00000, Performance =  84.57 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.061389 s, Result = 13100000, Performance =  85.36 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.063126 s, Result = 13600000, Performance =  84.37 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.064433 s, Result = 13b00000, Performance =  83.99 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.074912 s, Result = 14000000, Performance =  73.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1212  1412   256
Test passed: M N K =   111   216   832
Test passed: M N K =   473    35   448
Test passed: M N K =   335  1556  1664
Test passed: M N K =   802   216  1216
M N K =  4096  4096   256, Elapsed time =   0.006173 s, Result = a0f00000, Performance =  13.91 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006606 s, Result = a1400000, Performance =  26.01 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007420 s, Result = a1900000, Performance =  34.73 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008425 s, Result = a1e00000, Performance =  40.78 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008605 s, Result = a2300000, Performance =  49.91 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009581 s, Result = a2800000, Performance =  53.79 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010586 s, Result = a2d00000, Performance =  56.80 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.012144 s, Result = a3200000, Performance =  56.59 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012246 s, Result = a3700000, Performance =  63.13 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012903 s, Result = a3c00000, Performance =  66.57 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013615 s, Result = a4100000, Performance =  69.40 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014969 s, Result = a4600000, Performance =  68.86 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015693 s, Result = a4b00000, Performance =  71.16 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017100 s, Result = a5000000, Performance =  70.33 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017472 s, Result = a5500000, Performance =  73.75 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.019787 s, Result = a5a00000, Performance =  69.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019262 s, Result = a5f00000, Performance =  75.81 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020311 s, Result = a6400000, Performance =  76.13 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.021273 s, Result = a6900000, Performance =  76.72 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.022232 s, Result = a6e00000, Performance =  77.28 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022932 s, Result = a7300000, Performance =  78.66 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023679 s, Result = a7800000, Performance =  79.81 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.024936 s, Result = a7d00000, Performance =  79.23 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.026126 s, Result = a8200000, Performance =  78.91 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026447 s, Result = a8700000, Performance =  81.20 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.027530 s, Result = a8c00000, Performance =  81.13 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.028524 s, Result = a9100000, Performance =  81.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.029683 s, Result = a9600000, Performance =  81.03 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.030292 s, Result = a9b00000, Performance =  82.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.031003 s, Result = aa000000, Performance =  83.12 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.031272 s, Result = aa500000, Performance =  85.15 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.036506 s, Result = aaa00000, Performance =  75.30 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.032878 s, Result = aaf00000, Performance =  86.22 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034320 s, Result = ab400000, Performance =  85.10 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035239 s, Result = ab900000, Performance =  85.32 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.036133 s, Result = abe00000, Performance =  85.58 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036773 s, Result = ac300000, Performance =  86.43 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037980 s, Result = ac800000, Performance =  85.95 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.038268 s, Result = acd00000, Performance =  87.54 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.040713 s, Result = ad200000, Performance =  84.39 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.040706 s, Result = ad700000, Performance =  86.52 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.041539 s, Result = adc00000, Performance =  86.85 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.041695 s, Result = ae100000, Performance =  88.59 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.043707 s, Result = ae600000, Performance =  86.47 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.043302 s, Result = aeb00000, Performance =  89.27 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.045290 s, Result = af000000, Performance =  87.25 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.045056 s, Result = af500000, Performance =  89.61 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.051427 s, Result = afa00000, Performance =  80.18 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.046997 s, Result = aff00000, Performance =  89.56 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.048534 s, Result = b0400000, Performance =  88.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.049519 s, Result = b0900000, Performance =  88.47 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050369 s, Result = b0e00000, Performance =  88.68 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.050950 s, Result = b1300000, Performance =  89.36 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052239 s, Result = b1800000, Performance =  88.79 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.053162 s, Result = b1d00000, Performance =  88.87 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.055685 s, Result = b2200000, Performance =  86.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.054418 s, Result = b2700000, Performance =  89.98 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.055705 s, Result = b2c00000, Performance =  89.44 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.057157 s, Result = b3100000, Performance =  88.67 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.058426 s, Result = b3600000, Performance =  88.21 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.058741 s, Result = b3b00000, Performance =  89.20 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.060263 s, Result = b4000000, Performance =  88.38 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.060961 s, Result = b4500000, Performance =  88.77 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.071240 s, Result = b4a00000, Performance =  77.17 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   501  1617   704
Test passed: M N K =  1134   180  1024
Test passed: M N K =  1980   777   448
Test passed: M N K =  1969   481  1216
Test passed: M N K =   461  1598   256
M N K =  4096  4096   256, Elapsed time =   0.001083 s, Result = 00500000, Performance =  79.29 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002003 s, Result = 00a00000, Performance =  85.76 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002799 s, Result = 00f00000, Performance =  92.07 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003563 s, Result = 01400000, Performance =  96.42 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005292 s, Result = 01900000, Performance =  81.15 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005733 s, Result = 01e00000, Performance =  89.89 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007014 s, Result = 02300000, Performance =  85.73 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008940 s, Result = 02800000, Performance =  76.87 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008845 s, Result = 02d00000, Performance =  87.40 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009960 s, Result = 03200000, Performance =  86.24 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010629 s, Result = 03700000, Performance =  88.90 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011517 s, Result = 03c00000, Performance =  89.50 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.012434 s, Result = 04100000, Performance =  89.81 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012982 s, Result = 04600000, Performance =  92.63 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014295 s, Result = 04b00000, Performance =  90.13 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016109 s, Result = 05000000, Performance =  85.32 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015924 s, Result = 05500000, Performance =  91.70 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016330 s, Result = 05a00000, Performance =  94.68 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017595 s, Result = 05f00000, Performance =  92.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018611 s, Result = 06400000, Performance =  92.31 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019436 s, Result = 06900000, Performance =  92.81 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019846 s, Result = 06e00000, Performance =  95.22 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020892 s, Result = 07300000, Performance =  94.57 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022222 s, Result = 07800000, Performance =  92.77 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023066 s, Result = 07d00000, Performance =  93.10 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023627 s, Result = 08200000, Performance =  94.53 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024867 s, Result = 08700000, Performance =  93.27 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.025523 s, Result = 08c00000, Performance =  94.24 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026267 s, Result = 09100000, Performance =  94.84 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.027017 s, Result = 09600000, Performance =  95.38 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.027973 s, Result = 09b00000, Performance =  95.20 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.033126 s, Result = 0a000000, Performance =  82.98 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029793 s, Result = 0a500000, Performance =  95.15 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.031115 s, Result = 0aa00000, Performance =  93.86 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.031263 s, Result = 0af00000, Performance =  96.17 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.032941 s, Result = 0b400000, Performance =  93.88 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.032876 s, Result = 0b900000, Performance =  96.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.034577 s, Result = 0be00000, Performance =  94.40 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.034671 s, Result = 0c300000, Performance =  96.62 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.037151 s, Result = 0c800000, Performance =  92.49 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.036030 s, Result = 0cd00000, Performance =  97.75 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.037112 s, Result = 0d200000, Performance =  97.21 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.037791 s, Result = 0d700000, Performance =  97.74 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.038930 s, Result = 0dc00000, Performance =  97.09 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.039774 s, Result = 0e100000, Performance =  97.19 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.040077 s, Result = 0e600000, Performance =  98.59 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.042030 s, Result = 0eb00000, Performance =  96.06 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047175 s, Result = 0f000000, Performance =  87.40 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.042964 s, Result = 0f500000, Performance =  97.97 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.044073 s, Result = 0fa00000, Performance =  97.45 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.044599 s, Result = 0ff00000, Performance =  98.23 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.046788 s, Result = 10400000, Performance =  95.47 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.046551 s, Result = 10900000, Performance =  97.80 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.047286 s, Result = 10e00000, Performance =  98.10 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.048026 s, Result = 11300000, Performance =  98.37 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.050522 s, Result = 11800000, Performance =  95.21 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.050017 s, Result = 11d00000, Performance =  97.89 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.051351 s, Result = 12200000, Performance =  97.02 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.052278 s, Result = 12700000, Performance =  96.94 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.051921 s, Result = 12c00000, Performance =  99.27 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.053329 s, Result = 13100000, Performance =  98.26 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.054455 s, Result = 13600000, Performance =  97.80 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055168 s, Result = 13b00000, Performance =  98.09 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.067623 s, Result = 14000000, Performance =  81.30 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   772   534  1344
Test passed: M N K =  1370  1731   192
Test passed: M N K =   359  1997   128
Test passed: M N K =  1358  1659   640
Test passed: M N K =  1464   963  1472
M N K =  4096  4096   256, Elapsed time =   0.010199 s, Result = 90600000, Performance =   8.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011333 s, Result = 10b00000, Performance =  15.16 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011579 s, Result = 91000000, Performance =  22.26 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012722 s, Result = 11500000, Performance =  27.01 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013190 s, Result = 91a00000, Performance =  32.56 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013949 s, Result = 11f00000, Performance =  36.95 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014774 s, Result = 92400000, Performance =  40.70 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015437 s, Result = 12900000, Performance =  44.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016570 s, Result = 92e00000, Performance =  46.66 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017930 s, Result = 13300000, Performance =  47.91 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018724 s, Result = 93800000, Performance =  50.46 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019714 s, Result = 13d00000, Performance =  52.29 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020684 s, Result = 94200000, Performance =  53.99 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021839 s, Result = 14700000, Performance =  55.07 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.023049 s, Result = 94c00000, Performance =  55.90 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.025530 s, Result = 15100000, Performance =  53.83 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.025376 s, Result = 95600000, Performance =  57.55 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.026321 s, Result = 15b00000, Performance =  58.74 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.027250 s, Result = 96000000, Performance =  59.89 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.028896 s, Result = 16500000, Performance =  59.45 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.029753 s, Result = 96a00000, Performance =  60.63 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.030490 s, Result = 16f00000, Performance =  61.98 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.031303 s, Result = 97400000, Performance =  63.12 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.032346 s, Result = 17900000, Performance =  63.74 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.033529 s, Result = 97e00000, Performance =  64.05 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.034155 s, Result = 18300000, Performance =  65.39 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.035607 s, Result = 98800000, Performance =  65.14 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.036893 s, Result = 18d00000, Performance =  65.19 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.037135 s, Result = 99200000, Performance =  67.08 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.038151 s, Result = 19700000, Performance =  67.55 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.038854 s, Result = 99c00000, Performance =  68.54 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.042932 s, Result = 1a100000, Performance =  64.03 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.040993 s, Result = 9a600000, Performance =  69.15 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.041831 s, Result = 1ab00000, Performance =  69.82 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.043100 s, Result = 9b000000, Performance =  69.76 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.044130 s, Result = 1b500000, Performance =  70.07 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.045086 s, Result = 9ba00000, Performance =  70.49 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.045480 s, Result = 1bf00000, Performance =  71.77 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.046960 s, Result = 9c400000, Performance =  71.34 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.047639 s, Result = 1c900000, Performance =  72.13 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.048786 s, Result = 9ce00000, Performance =  72.19 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.049671 s, Result = 1d300000, Performance =  72.63 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.050698 s, Result = 9d800000, Performance =  72.86 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.052323 s, Result = 1dd00000, Performance =  72.24 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.052484 s, Result = 9e200000, Performance =  73.65 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.053089 s, Result = 1e700000, Performance =  74.43 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.054133 s, Result = 9ec00000, Performance =  74.58 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.058786 s, Result = 1f100000, Performance =  70.14 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.056159 s, Result = 9f600000, Performance =  74.95 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.057164 s, Result = 1fb00000, Performance =  75.13 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.058220 s, Result = a0000000, Performance =  75.25 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.059660 s, Result = 20500000, Performance =  74.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.060296 s, Result = a0a00000, Performance =  75.51 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.061492 s, Result = 20f00000, Performance =  75.43 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.062409 s, Result = a1400000, Performance =  75.70 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.063709 s, Result = 21900000, Performance =  75.51 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.064590 s, Result = a1e00000, Performance =  75.81 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.065733 s, Result = 22300000, Performance =  75.79 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.066703 s, Result = a2800000, Performance =  75.98 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.068116 s, Result = 22d00000, Performance =  75.66 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.068797 s, Result = a3200000, Performance =  76.16 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.069428 s, Result = 23700000, Performance =  76.71 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.070417 s, Result = a3c00000, Performance =  76.85 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.078507 s, Result = 24100000, Performance =  70.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   470  1865  1408
Test passed: M N K =  1683   866  1408
Test passed: M N K =  1534  1696  1664
Test passed: M N K =  1855   340  1600
Test passed: M N K =  1269  1212   576
M N K =  4096  4096   256, Elapsed time =   0.013456 s, Result = 00500000, Performance =   6.38 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012825 s, Result = 00a00000, Performance =  13.40 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013581 s, Result = 00f00000, Performance =  18.97 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.014284 s, Result = 01400000, Performance =  24.06 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014656 s, Result = 01900000, Performance =  29.31 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015181 s, Result = 01e00000, Performance =  33.95 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015794 s, Result = 02300000, Performance =  38.07 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016431 s, Result = 02800000, Performance =  41.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.017359 s, Result = 02d00000, Performance =  44.54 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.018069 s, Result = 03200000, Performance =  47.54 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018456 s, Result = 03700000, Performance =  51.20 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019852 s, Result = 03c00000, Performance =  51.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020508 s, Result = 04100000, Performance =  54.45 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021591 s, Result = 04600000, Performance =  55.70 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.022824 s, Result = 04b00000, Performance =  56.45 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.024076 s, Result = 05000000, Performance =  57.09 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.024358 s, Result = 05500000, Performance =  59.95 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024935 s, Result = 05a00000, Performance =  62.01 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.026747 s, Result = 05f00000, Performance =  61.02 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.027574 s, Result = 06400000, Performance =  62.30 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.028421 s, Result = 06900000, Performance =  63.47 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.029674 s, Result = 06e00000, Performance =  63.68 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.030188 s, Result = 07300000, Performance =  65.45 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.031160 s, Result = 07800000, Performance =  66.16 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.032167 s, Result = 07d00000, Performance =  66.76 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.033419 s, Result = 08200000, Performance =  66.83 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.034450 s, Result = 08700000, Performance =  67.32 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.035181 s, Result = 08c00000, Performance =  68.37 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.036560 s, Result = 09100000, Performance =  68.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.037191 s, Result = 09600000, Performance =  69.29 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.038185 s, Result = 09b00000, Performance =  69.74 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.041186 s, Result = 0a000000, Performance =  66.74 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.040398 s, Result = 0a500000, Performance =  70.17 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.040614 s, Result = 0aa00000, Performance =  71.91 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.041967 s, Result = 0af00000, Performance =  71.64 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.042915 s, Result = 0b400000, Performance =  72.06 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.044127 s, Result = 0b900000, Performance =  72.03 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.044860 s, Result = 0be00000, Performance =  72.76 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.045709 s, Result = 0c300000, Performance =  73.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.047421 s, Result = 0c800000, Performance =  72.46 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.047477 s, Result = 0cd00000, Performance =  74.18 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.048583 s, Result = 0d200000, Performance =  74.26 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.050004 s, Result = 0d700000, Performance =  73.87 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.050320 s, Result = 0dc00000, Performance =  75.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.051967 s, Result = 0e100000, Performance =  74.38 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.052228 s, Result = 0e600000, Performance =  75.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.053380 s, Result = 0eb00000, Performance =  75.63 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.057389 s, Result = 0f000000, Performance =  71.85 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.055624 s, Result = 0f500000, Performance =  75.67 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.056194 s, Result = 0fa00000, Performance =  76.43 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.056798 s, Result = 0ff00000, Performance =  77.13 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.059015 s, Result = 10400000, Performance =  75.69 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.059482 s, Result = 10900000, Performance =  76.54 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.059618 s, Result = 10e00000, Performance =  77.80 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.060680 s, Result = 11300000, Performance =  77.86 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.061862 s, Result = 11800000, Performance =  77.76 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.062967 s, Result = 11d00000, Performance =  77.76 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.065437 s, Result = 12200000, Performance =  76.14 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.064758 s, Result = 12700000, Performance =  78.26 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.066554 s, Result = 12c00000, Performance =  77.44 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.066839 s, Result = 13100000, Performance =  78.40 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.067177 s, Result = 13600000, Performance =  79.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.067275 s, Result = 13b00000, Performance =  80.44 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.077612 s, Result = 14000000, Performance =  70.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1761  2046  1920
Test passed: M N K =  1647  1670  1024
Test passed: M N K =   529   750   256
Test passed: M N K =  1785  1588   832
Test passed: M N K =   377  1544  2048
M N K =  4096  4096   256, Elapsed time =   0.005918 s, Result = a0f00000, Performance =  14.52 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006790 s, Result = a1400000, Performance =  25.30 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007858 s, Result = a1900000, Performance =  32.79 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008185 s, Result = a1e00000, Performance =  41.98 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008943 s, Result = a2300000, Performance =  48.03 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009632 s, Result = a2800000, Performance =  53.51 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010620 s, Result = a2d00000, Performance =  56.62 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011573 s, Result = a3200000, Performance =  59.38 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012434 s, Result = a3700000, Performance =  62.18 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013086 s, Result = a3c00000, Performance =  65.64 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013750 s, Result = a4100000, Performance =  68.72 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014768 s, Result = a4600000, Performance =  69.80 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018866 s, Result = a4b00000, Performance =  59.19 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017193 s, Result = a5000000, Performance =  69.95 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018743 s, Result = a5500000, Performance =  68.75 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020357 s, Result = a5a00000, Performance =  67.51 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020738 s, Result = a5f00000, Performance =  70.42 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021288 s, Result = a6400000, Performance =  72.63 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022635 s, Result = a6900000, Performance =  72.10 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024270 s, Result = a6e00000, Performance =  70.79 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024688 s, Result = a7300000, Performance =  73.07 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.034110 s, Result = a7800000, Performance =  55.40 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.026509 s, Result = a7d00000, Performance =  74.53 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.027778 s, Result = a8200000, Performance =  74.22 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.028496 s, Result = a8700000, Performance =  75.36 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.029806 s, Result = a8c00000, Performance =  74.93 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.030584 s, Result = a9100000, Performance =  75.83 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.031933 s, Result = a9600000, Performance =  75.32 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.032701 s, Result = a9b00000, Performance =  76.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.033827 s, Result = aa000000, Performance =  76.18 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.034595 s, Result = aa500000, Performance =  76.97 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.037986 s, Result = aaa00000, Performance =  72.36 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.036252 s, Result = aaf00000, Performance =  78.19 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.037459 s, Result = ab400000, Performance =  77.97 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.038337 s, Result = ab900000, Performance =  78.42 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.040160 s, Result = abe00000, Performance =  77.00 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.040061 s, Result = ac300000, Performance =  79.34 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.040936 s, Result = ac800000, Performance =  79.74 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.042441 s, Result = acd00000, Performance =  78.93 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.043555 s, Result = ad200000, Performance =  78.89 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.044334 s, Result = ad700000, Performance =  79.44 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.045210 s, Result = adc00000, Performance =  79.80 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.046247 s, Result = ae100000, Performance =  79.87 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.047695 s, Result = ae600000, Performance =  79.24 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.047648 s, Result = aeb00000, Performance =  81.12 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.048403 s, Result = af000000, Performance =  81.63 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.049705 s, Result = af500000, Performance =  81.22 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.054062 s, Result = afa00000, Performance =  76.27 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.051372 s, Result = aff00000, Performance =  81.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.052789 s, Result = b0400000, Performance =  81.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.052967 s, Result = b0900000, Performance =  82.71 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.055328 s, Result = b0e00000, Performance =  80.73 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.055338 s, Result = b1300000, Performance =  82.27 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.056646 s, Result = b1800000, Performance =  81.89 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.057812 s, Result = b1d00000, Performance =  81.72 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.058605 s, Result = b2200000, Performance =  82.08 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.059333 s, Result = b2700000, Performance =  82.52 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.060293 s, Result = b2c00000, Performance =  82.63 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.060963 s, Result = b3100000, Performance =  83.13 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.062793 s, Result = b3600000, Performance =  82.08 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.063776 s, Result = b3b00000, Performance =  82.16 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.064337 s, Result = b4000000, Performance =  82.78 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.065806 s, Result = b4500000, Performance =  82.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.073425 s, Result = b4a00000, Performance =  74.87 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1493   807   512
Test passed: M N K =   187   170  2048
Test passed: M N K =   234   590  1536
Test passed: M N K =  1885   343  1344
Test passed: M N K =  1435   431  1216
M N K =  4096  4096   256, Elapsed time =   0.001117 s, Result = 00500000, Performance =  76.87 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002128 s, Result = 00a00000, Performance =  80.74 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003366 s, Result = 00f00000, Performance =  76.55 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004545 s, Result = 01400000, Performance =  75.59 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005173 s, Result = 01900000, Performance =  83.03 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.006404 s, Result = 01e00000, Performance =  80.47 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007161 s, Result = 02300000, Performance =  83.97 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009490 s, Result = 02800000, Performance =  72.42 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009348 s, Result = 02d00000, Performance =  82.70 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010196 s, Result = 03200000, Performance =  84.25 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.011715 s, Result = 03700000, Performance =  80.66 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012710 s, Result = 03c00000, Performance =  81.10 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013814 s, Result = 04100000, Performance =  80.84 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014824 s, Result = 04600000, Performance =  81.12 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015808 s, Result = 04b00000, Performance =  81.51 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017279 s, Result = 05000000, Performance =  79.54 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017625 s, Result = 05500000, Performance =  82.85 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019102 s, Result = 05a00000, Performance =  80.94 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020054 s, Result = 05f00000, Performance =  81.39 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020683 s, Result = 06400000, Performance =  83.06 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021866 s, Result = 06900000, Performance =  82.50 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023149 s, Result = 06e00000, Performance =  81.64 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023836 s, Result = 07300000, Performance =  82.89 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024614 s, Result = 07800000, Performance =  83.76 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.025798 s, Result = 07d00000, Performance =  83.24 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.027331 s, Result = 08200000, Performance =  81.72 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027961 s, Result = 08700000, Performance =  82.95 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.029213 s, Result = 08c00000, Performance =  82.33 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029377 s, Result = 09100000, Performance =  84.80 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030521 s, Result = 09600000, Performance =  84.43 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.031456 s, Result = 09b00000, Performance =  84.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.035174 s, Result = 0a000000, Performance =  78.15 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.033553 s, Result = 0a500000, Performance =  84.48 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034851 s, Result = 0aa00000, Performance =  83.80 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035564 s, Result = 0af00000, Performance =  84.54 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.036941 s, Result = 0b400000, Performance =  83.71 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.037497 s, Result = 0b900000, Performance =  84.76 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.038425 s, Result = 0be00000, Performance =  84.95 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.039537 s, Result = 0c300000, Performance =  84.73 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.040732 s, Result = 0c800000, Performance =  84.36 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.041127 s, Result = 0cd00000, Performance =  85.63 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.042340 s, Result = 0d200000, Performance =  85.21 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.043366 s, Result = 0d700000, Performance =  85.17 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.044068 s, Result = 0dc00000, Performance =  85.77 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.045230 s, Result = 0e100000, Performance =  85.46 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.046393 s, Result = 0e600000, Performance =  85.17 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.046008 s, Result = 0eb00000, Performance =  87.75 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.051751 s, Result = 0f000000, Performance =  79.67 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.049014 s, Result = 0f500000, Performance =  85.88 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.049919 s, Result = 0fa00000, Performance =  86.04 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.050497 s, Result = 0ff00000, Performance =  86.75 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.052019 s, Result = 10400000, Performance =  85.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.052340 s, Result = 10900000, Performance =  86.98 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052950 s, Result = 10e00000, Performance =  87.60 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.054864 s, Result = 11300000, Performance =  86.11 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.056061 s, Result = 11800000, Performance =  85.81 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.056443 s, Result = 11d00000, Performance =  86.75 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.057332 s, Result = 12200000, Performance =  86.90 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.057967 s, Result = 12700000, Performance =  87.43 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.059652 s, Result = 12c00000, Performance =  86.40 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.059557 s, Result = 13100000, Performance =  87.98 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.060332 s, Result = 13600000, Performance =  88.27 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.062035 s, Result = 13b00000, Performance =  87.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.069561 s, Result = 14000000, Performance =  79.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1194   627  1856
Test passed: M N K =   398   271    64
Test passed: M N K =   847  1613  2048
Test passed: M N K =  1965   466  1600
Test passed: M N K =   259   552   768
M N K =  4096  4096   256, Elapsed time =   0.009235 s, Result = d04c0000, Performance =   9.30 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009526 s, Result = 90880000, Performance =  18.03 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010424 s, Result = 50c40000, Performance =  24.72 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010923 s, Result = 11000000, Performance =  31.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011875 s, Result = d13c0000, Performance =  36.17 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012802 s, Result = 91780000, Performance =  40.26 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013362 s, Result = 51b40000, Performance =  45.00 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014750 s, Result = 11f00000, Performance =  46.59 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014701 s, Result = d22c0000, Performance =  52.59 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015858 s, Result = 92680000, Performance =  54.17 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016634 s, Result = 52a40000, Performance =  56.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017734 s, Result = 12e00000, Performance =  58.13 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018520 s, Result = d31c0000, Performance =  60.30 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019036 s, Result = 93580000, Performance =  63.18 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.020383 s, Result = 53940000, Performance =  63.21 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.021211 s, Result = 13d00000, Performance =  64.79 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.021264 s, Result = d40c0000, Performance =  68.67 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021850 s, Result = 94480000, Performance =  70.76 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022367 s, Result = 54840000, Performance =  72.97 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.023101 s, Result = 14c00000, Performance =  74.37 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.023528 s, Result = d4fc0000, Performance =  76.67 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.024300 s, Result = 95380000, Performance =  77.77 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.025140 s, Result = 55740000, Performance =  78.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.025971 s, Result = 15b00000, Performance =  79.38 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026571 s, Result = d5ec0000, Performance =  80.82 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.027153 s, Result = 96280000, Performance =  82.25 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027793 s, Result = 56640000, Performance =  83.45 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.028408 s, Result = 16a00000, Performance =  84.66 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029255 s, Result = d6dc0000, Performance =  85.15 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.029592 s, Result = 97180000, Performance =  87.08 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.030687 s, Result = 57540000, Performance =  86.78 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.032172 s, Result = 17900000, Performance =  85.44 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.032301 s, Result = d7cc0000, Performance =  87.76 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.032613 s, Result = 98080000, Performance =  89.55 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.033440 s, Result = 58440000, Performance =  89.91 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.034289 s, Result = 18800000, Performance =  90.19 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.035220 s, Result = d8bc0000, Performance =  90.24 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035664 s, Result = 98f80000, Performance =  91.53 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.037118 s, Result = 59340000, Performance =  90.25 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.037221 s, Result = 19700000, Performance =  92.31 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037940 s, Result = d9ac0000, Performance =  92.83 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038791 s, Result = 99e80000, Performance =  93.00 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039980 s, Result = 5a240000, Performance =  92.39 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.040661 s, Result = 1a600000, Performance =  92.95 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.040903 s, Result = da9c0000, Performance =  94.50 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041889 s, Result = 9ad80000, Performance =  94.33 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.043066 s, Result = 5b140000, Performance =  93.75 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.044914 s, Result = 1b500000, Performance =  91.80 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.044611 s, Result = db8c0000, Performance =  94.35 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.045512 s, Result = 9bc80000, Performance =  94.37 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.046772 s, Result = 5c040000, Performance =  93.66 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.047935 s, Result = 1c400000, Performance =  93.18 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.048577 s, Result = dc7c0000, Performance =  93.72 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.049486 s, Result = 9cb80000, Performance =  93.74 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.051022 s, Result = 5cf40000, Performance =  92.60 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.051389 s, Result = 1d300000, Performance =  93.61 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.052619 s, Result = dd6c0000, Performance =  93.05 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.053342 s, Result = 9da80000, Performance =  93.40 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.055142 s, Result = 5de40000, Performance =  91.91 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.055503 s, Result = 1e200000, Performance =  92.86 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.056622 s, Result = de5c0000, Performance =  92.54 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.056858 s, Result = 9e980000, Performance =  93.67 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.058989 s, Result = 5ed40000, Performance =  91.74 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.061748 s, Result = 1f100000, Performance =  89.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1977   748   384
Test passed: M N K =  1198  1128  1472
Test passed: M N K =  1853  1135  1728
Test passed: M N K =  1946  1128   256
Test passed: M N K =   354   936  1152
M N K =  4096  4096   256, Elapsed time =   0.013380 s, Result = 003c0000, Performance =   6.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011313 s, Result = 00780000, Performance =  15.19 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012713 s, Result = 00b40000, Performance =  20.27 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012827 s, Result = 00f00000, Performance =  26.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013141 s, Result = 012c0000, Performance =  32.68 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.017271 s, Result = 01680000, Performance =  29.84 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013903 s, Result = 01a40000, Performance =  43.25 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014605 s, Result = 01e00000, Performance =  47.05 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015066 s, Result = 021c0000, Performance =  51.31 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015435 s, Result = 02580000, Performance =  55.65 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015197 s, Result = 02940000, Performance =  62.18 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015787 s, Result = 02d00000, Performance =  65.30 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.016694 s, Result = 030c0000, Performance =  66.89 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016744 s, Result = 03480000, Performance =  71.82 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018157 s, Result = 03840000, Performance =  70.97 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018644 s, Result = 03c00000, Performance =  73.72 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018904 s, Result = 03fc0000, Performance =  77.25 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019920 s, Result = 04380000, Performance =  77.62 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020115 s, Result = 04740000, Performance =  81.14 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020968 s, Result = 04b00000, Performance =  81.93 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021449 s, Result = 04ec0000, Performance =  84.10 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.021532 s, Result = 05280000, Performance =  87.77 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.022691 s, Result = 05640000, Performance =  87.07 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023300 s, Result = 05a00000, Performance =  88.48 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023810 s, Result = 05dc0000, Performance =  90.19 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.024258 s, Result = 06180000, Performance =  92.07 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.025049 s, Result = 06540000, Performance =  92.59 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.026092 s, Result = 06900000, Performance =  92.18 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026585 s, Result = 06cc0000, Performance =  93.70 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026969 s, Result = 07080000, Performance =  95.55 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.027628 s, Result = 07440000, Performance =  96.38 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.029339 s, Result = 07800000, Performance =  93.69 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029317 s, Result = 07bc0000, Performance =  96.69 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.029904 s, Result = 07f80000, Performance =  97.67 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030499 s, Result = 08340000, Performance =  98.57 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.031313 s, Result = 08700000, Performance =  98.76 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031817 s, Result = 08ac0000, Performance =  99.89 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032731 s, Result = 08e80000, Performance =  99.73 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.033528 s, Result = 09240000, Performance =  99.92 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034078 s, Result = 09600000, Performance = 100.83 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.034747 s, Result = 099c0000, Performance = 101.36 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.035294 s, Result = 09d80000, Performance = 102.22 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036701 s, Result = 0a140000, Performance = 100.64 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.036655 s, Result = 0a500000, Performance = 103.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.037166 s, Result = 0a8c0000, Performance = 104.01 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.037585 s, Result = 0ac80000, Performance = 105.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.038844 s, Result = 0b040000, Performance = 103.94 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040785 s, Result = 0b400000, Performance = 101.09 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.040016 s, Result = 0b7c0000, Performance = 105.18 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.040792 s, Result = 0bb80000, Performance = 105.29 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042121 s, Result = 0bf40000, Performance = 104.01 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.041941 s, Result = 0c300000, Performance = 106.50 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043963 s, Result = 0c6c0000, Performance = 103.56 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044123 s, Result = 0ca80000, Performance = 105.13 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.045562 s, Result = 0ce40000, Performance = 103.69 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046430 s, Result = 0d200000, Performance = 103.61 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046938 s, Result = 0d5c0000, Performance = 104.31 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048098 s, Result = 0d980000, Performance = 103.58 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.049323 s, Result = 0dd40000, Performance = 102.75 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049769 s, Result = 0e100000, Performance = 103.56 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.050953 s, Result = 0e4c0000, Performance = 102.84 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.051282 s, Result = 0e880000, Performance = 103.85 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.052888 s, Result = 0ec40000, Performance = 102.32 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054531 s, Result = 0f000000, Performance = 100.81 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   599   517  1984
Test passed: M N K =   857   908   128
Test passed: M N K =  1762  1533   192
Test passed: M N K =   542   318   512
Test passed: M N K =  1690  1565   128
M N K =  4096  4096   256, Elapsed time =   0.006581 s, Result = a0dc0000, Performance =  13.05 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006648 s, Result = a1180000, Performance =  25.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007277 s, Result = a1540000, Performance =  35.41 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007579 s, Result = a1900000, Performance =  45.34 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008210 s, Result = a1cc0000, Performance =  52.31 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008632 s, Result = a2080000, Performance =  59.71 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009283 s, Result = a2440000, Performance =  64.77 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014478 s, Result = a2800000, Performance =  47.46 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010509 s, Result = a2bc0000, Performance =  73.56 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010846 s, Result = a2f80000, Performance =  79.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.011857 s, Result = a3340000, Performance =  79.69 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012615 s, Result = a3700000, Performance =  81.71 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013397 s, Result = a3ac0000, Performance =  83.35 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.013987 s, Result = a3e80000, Performance =  85.98 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014591 s, Result = a4240000, Performance =  88.31 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017730 s, Result = a4600000, Performance =  77.52 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016126 s, Result = a49c0000, Performance =  90.55 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016791 s, Result = a4d80000, Performance =  92.08 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017112 s, Result = a5140000, Performance =  95.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017716 s, Result = a5500000, Performance =  96.97 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018674 s, Result = a58c0000, Performance =  96.60 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019348 s, Result = a5c80000, Performance =  97.67 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019835 s, Result = a6040000, Performance =  99.61 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021060 s, Result = a6400000, Performance =  97.89 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.021328 s, Result = a67c0000, Performance = 100.69 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021939 s, Result = a6b80000, Performance = 101.80 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022747 s, Result = a6f40000, Performance = 101.96 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023712 s, Result = a7300000, Performance = 101.43 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024245 s, Result = a76c0000, Performance = 102.75 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024507 s, Result = a7a80000, Performance = 105.15 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.025755 s, Result = a7e40000, Performance = 103.39 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027970 s, Result = a8200000, Performance =  98.28 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.026436 s, Result = a85c0000, Performance = 107.23 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.027536 s, Result = a8980000, Performance = 106.07 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028012 s, Result = a8d40000, Performance = 107.33 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.028849 s, Result = a9100000, Performance = 107.19 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029885 s, Result = a94c0000, Performance = 106.35 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.029937 s, Result = a9880000, Performance = 109.04 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.031100 s, Result = a9c40000, Performance = 107.72 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.031860 s, Result = aa000000, Performance = 107.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.032296 s, Result = aa3c0000, Performance = 109.05 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032700 s, Result = aa780000, Performance = 110.33 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.034101 s, Result = aab40000, Performance = 108.32 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.034617 s, Result = aaf00000, Performance = 109.18 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.035575 s, Result = ab2c0000, Performance = 108.66 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.035902 s, Result = ab680000, Performance = 110.06 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.036881 s, Result = aba40000, Performance = 109.47 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.038348 s, Result = abe00000, Performance = 107.52 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.038506 s, Result = ac1c0000, Performance = 109.31 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.039171 s, Result = ac580000, Performance = 109.65 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.040216 s, Result = ac940000, Performance = 108.93 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.040584 s, Result = acd00000, Performance = 110.06 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.041627 s, Result = ad0c0000, Performance = 109.37 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.042472 s, Result = ad480000, Performance = 109.21 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.043658 s, Result = ad840000, Performance = 108.22 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.044403 s, Result = adc00000, Performance = 108.33 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.044996 s, Result = adfc0000, Performance = 108.82 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.046396 s, Result = ae380000, Performance = 107.38 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.047163 s, Result = ae740000, Performance = 107.46 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.047900 s, Result = aeb00000, Performance = 107.60 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.048746 s, Result = aeec0000, Performance = 107.49 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.049462 s, Result = af280000, Performance = 107.67 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.050048 s, Result = af640000, Performance = 108.13 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.053952 s, Result = afa00000, Performance = 101.90 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   150  1774    64
Test passed: M N K =  1927  2001   448
Test passed: M N K =  1943   160  1728
Test passed: M N K =   966  1783   832
Test passed: M N K =  1599  1690   448
M N K =  4096  4096   256, Elapsed time =   0.000904 s, Result = 003c0000, Performance =  95.01 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001692 s, Result = 00780000, Performance = 101.51 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002323 s, Result = 00b40000, Performance = 110.96 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002971 s, Result = 00f00000, Performance = 115.65 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003933 s, Result = 012c0000, Performance = 109.20 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004782 s, Result = 01680000, Performance = 107.78 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.006987 s, Result = 01a40000, Performance =  86.06 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006228 s, Result = 01e00000, Performance = 110.35 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006539 s, Result = 021c0000, Performance = 118.23 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007433 s, Result = 02580000, Performance = 115.56 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008111 s, Result = 02940000, Performance = 116.49 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008783 s, Result = 02d00000, Performance = 117.36 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009265 s, Result = 030c0000, Performance = 120.53 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010459 s, Result = 03480000, Performance = 114.99 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011006 s, Result = 03840000, Performance = 117.07 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013823 s, Result = 03c00000, Performance =  99.43 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.012583 s, Result = 03fc0000, Performance = 116.06 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013131 s, Result = 04380000, Performance = 117.75 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013783 s, Result = 04740000, Performance = 118.41 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014383 s, Result = 04b00000, Performance = 119.44 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014999 s, Result = 04ec0000, Performance = 120.27 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015848 s, Result = 05280000, Performance = 119.24 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016009 s, Result = 05640000, Performance = 123.41 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017197 s, Result = 05a00000, Performance = 119.88 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017434 s, Result = 05dc0000, Performance = 123.18 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.018285 s, Result = 06180000, Performance = 122.14 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018633 s, Result = 06540000, Performance = 124.47 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019776 s, Result = 06900000, Performance = 121.62 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020358 s, Result = 06cc0000, Performance = 122.36 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020831 s, Result = 07080000, Performance = 123.71 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.021315 s, Result = 07440000, Performance = 124.93 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023087 s, Result = 07800000, Performance = 119.06 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.022668 s, Result = 07bc0000, Performance = 125.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.023252 s, Result = 07f80000, Performance = 125.61 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.024372 s, Result = 08340000, Performance = 123.36 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.024828 s, Result = 08700000, Performance = 124.55 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.025472 s, Result = 08ac0000, Performance = 124.77 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.025851 s, Result = 08e80000, Performance = 126.27 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027468 s, Result = 09240000, Performance = 121.96 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.027452 s, Result = 09600000, Performance = 125.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.027943 s, Result = 099c0000, Performance = 126.04 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.029086 s, Result = 09d80000, Performance = 124.04 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030127 s, Result = 0a140000, Performance = 122.60 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.029638 s, Result = 0a500000, Performance = 127.52 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030799 s, Result = 0a8c0000, Performance = 125.51 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.031645 s, Result = 0ac80000, Performance = 124.86 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032228 s, Result = 0b040000, Performance = 125.27 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034261 s, Result = 0b400000, Performance = 120.35 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.033132 s, Result = 0b7c0000, Performance = 127.04 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034511 s, Result = 0bb80000, Performance = 124.45 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.034477 s, Result = 0bf40000, Performance = 127.07 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.034982 s, Result = 0c300000, Performance = 127.69 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.035908 s, Result = 0c6c0000, Performance = 126.79 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037113 s, Result = 0ca80000, Performance = 124.98 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.037742 s, Result = 0ce40000, Performance = 125.18 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.039097 s, Result = 0d200000, Performance = 123.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039756 s, Result = 0d5c0000, Performance = 123.16 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.041030 s, Result = 0d980000, Performance = 121.43 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.041950 s, Result = 0dd40000, Performance = 120.81 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.041721 s, Result = 0e100000, Performance = 123.53 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042927 s, Result = 0e4c0000, Performance = 122.06 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044110 s, Result = 0e880000, Performance = 120.74 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.044858 s, Result = 0ec40000, Performance = 120.64 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046559 s, Result = 0f000000, Performance = 118.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1015  1682  1088
Test passed: M N K =   617   164   448
Test passed: M N K =  1842  1400   384
Test passed: M N K =  1003  1003  1472
Test passed: M N K =   494   665  1856
M N K =  4096  4096   256, Elapsed time =   0.009028 s, Result = d04c0000, Performance =   9.51 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009781 s, Result = 90880000, Performance =  17.56 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010048 s, Result = 50c40000, Performance =  25.65 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011191 s, Result = 11000000, Performance =  30.70 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011908 s, Result = d13c0000, Performance =  36.07 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012614 s, Result = 91780000, Performance =  40.86 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013258 s, Result = 51b40000, Performance =  45.35 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014211 s, Result = 11f00000, Performance =  48.36 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015099 s, Result = d22c0000, Performance =  51.20 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016113 s, Result = 92680000, Performance =  53.31 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017188 s, Result = 52a40000, Performance =  54.98 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017909 s, Result = 12e00000, Performance =  57.56 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018782 s, Result = d31c0000, Performance =  59.45 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019934 s, Result = 93580000, Performance =  60.33 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.024550 s, Result = 53940000, Performance =  52.48 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022559 s, Result = 13d00000, Performance =  60.92 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.021150 s, Result = d40c0000, Performance =  69.05 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021968 s, Result = 94480000, Performance =  70.38 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022635 s, Result = 54840000, Performance =  72.10 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.023569 s, Result = 14c00000, Performance =  72.89 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024148 s, Result = d4fc0000, Performance =  74.70 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.025000 s, Result = 95380000, Performance =  75.59 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.032818 s, Result = 55740000, Performance =  60.20 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.026380 s, Result = 15b00000, Performance =  78.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026518 s, Result = d5ec0000, Performance =  80.98 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.027319 s, Result = 96280000, Performance =  81.75 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027785 s, Result = 56640000, Performance =  83.47 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.028732 s, Result = 16a00000, Performance =  83.71 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029102 s, Result = d6dc0000, Performance =  85.60 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.029774 s, Result = 97180000, Performance =  86.55 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.030381 s, Result = 57540000, Performance =  87.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.035866 s, Result = 17900000, Performance =  76.64 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.031811 s, Result = d7cc0000, Performance =  89.11 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.033028 s, Result = 98080000, Performance =  88.43 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.033519 s, Result = 58440000, Performance =  89.70 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.034160 s, Result = 18800000, Performance =  90.53 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034842 s, Result = d8bc0000, Performance =  91.22 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035629 s, Result = 98f80000, Performance =  91.62 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.035999 s, Result = 59340000, Performance =  93.06 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.038829 s, Result = 19700000, Performance =  88.49 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037491 s, Result = d9ac0000, Performance =  93.94 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038389 s, Result = 99e80000, Performance =  93.98 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039434 s, Result = 5a240000, Performance =  93.67 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.039704 s, Result = 1a600000, Performance =  95.19 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.040928 s, Result = da9c0000, Performance =  94.45 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041303 s, Result = 9ad80000, Performance =  95.67 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.041866 s, Result = 5b140000, Performance =  96.43 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.049440 s, Result = 1b500000, Performance =  83.40 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.043462 s, Result = db8c0000, Performance =  96.84 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.044325 s, Result = 9bc80000, Performance =  96.90 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.045142 s, Result = 5c040000, Performance =  97.05 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.046126 s, Result = 1c400000, Performance =  96.84 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.047022 s, Result = dc7c0000, Performance =  96.82 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.047690 s, Result = 9cb80000, Performance =  97.27 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.048714 s, Result = 5cf40000, Performance =  96.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.051021 s, Result = 1d300000, Performance =  94.28 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.050181 s, Result = dd6c0000, Performance =  97.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.051395 s, Result = 9da80000, Performance =  96.94 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.052184 s, Result = 5de40000, Performance =  97.12 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.053218 s, Result = 1e200000, Performance =  96.85 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.054173 s, Result = de5c0000, Performance =  96.72 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.054835 s, Result = 9e980000, Performance =  97.12 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.056040 s, Result = 5ed40000, Performance =  96.57 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.066260 s, Result = 1f100000, Performance =  82.97 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   539  1412   704
Test passed: M N K =   989  1171  1088
Test passed: M N K =   872  1246  2048
Test passed: M N K =   157   150   768
Test passed: M N K =  1882   667   960
M N K =  4096  4096   256, Elapsed time =   0.013210 s, Result = 003c0000, Performance =   6.50 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009853 s, Result = 00780000, Performance =  17.44 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012535 s, Result = 00b40000, Performance =  20.56 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012512 s, Result = 00f00000, Performance =  27.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013438 s, Result = 012c0000, Performance =  31.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013631 s, Result = 01680000, Performance =  37.81 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015641 s, Result = 01a40000, Performance =  38.44 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014653 s, Result = 01e00000, Performance =  46.90 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015244 s, Result = 021c0000, Performance =  50.72 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015351 s, Result = 02580000, Performance =  55.96 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016064 s, Result = 02940000, Performance =  58.82 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016975 s, Result = 02d00000, Performance =  60.72 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017496 s, Result = 030c0000, Performance =  63.83 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017753 s, Result = 03480000, Performance =  67.74 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018914 s, Result = 03840000, Performance =  68.12 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020361 s, Result = 03c00000, Performance =  67.50 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020020 s, Result = 03fc0000, Performance =  72.94 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020291 s, Result = 04380000, Performance =  76.20 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020701 s, Result = 04740000, Performance =  78.84 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021290 s, Result = 04b00000, Performance =  80.69 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022345 s, Result = 04ec0000, Performance =  80.73 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022617 s, Result = 05280000, Performance =  83.56 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023712 s, Result = 05640000, Performance =  83.32 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024822 s, Result = 05a00000, Performance =  83.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024842 s, Result = 05dc0000, Performance =  86.45 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.025680 s, Result = 06180000, Performance =  86.97 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.026139 s, Result = 06540000, Performance =  88.73 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.026688 s, Result = 06900000, Performance =  90.12 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.027094 s, Result = 06cc0000, Performance =  91.94 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.028241 s, Result = 07080000, Performance =  91.25 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.028797 s, Result = 07440000, Performance =  92.47 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.033603 s, Result = 07800000, Performance =  81.80 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.030346 s, Result = 07bc0000, Performance =  93.41 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.031121 s, Result = 07f80000, Performance =  93.85 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.031346 s, Result = 08340000, Performance =  95.91 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.032614 s, Result = 08700000, Performance =  94.82 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.033089 s, Result = 08ac0000, Performance =  96.05 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.033599 s, Result = 08e80000, Performance =  97.15 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.034567 s, Result = 09240000, Performance =  96.91 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036045 s, Result = 09600000, Performance =  95.33 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035607 s, Result = 099c0000, Performance =  98.91 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036159 s, Result = 09d80000, Performance =  99.77 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036647 s, Result = 0a140000, Performance = 100.79 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037515 s, Result = 0a500000, Performance = 100.75 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038142 s, Result = 0a8c0000, Performance = 101.35 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.039187 s, Result = 0ac80000, Performance = 100.83 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039525 s, Result = 0b040000, Performance = 102.14 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.046309 s, Result = 0b400000, Performance =  89.04 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041428 s, Result = 0b7c0000, Performance = 101.60 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.041727 s, Result = 0bb80000, Performance = 102.93 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042259 s, Result = 0bf40000, Performance = 103.67 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.043596 s, Result = 0c300000, Performance = 102.46 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043505 s, Result = 0c6c0000, Performance = 104.65 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044217 s, Result = 0ca80000, Performance = 104.90 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.045404 s, Result = 0ce40000, Performance = 104.05 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.047679 s, Result = 0d200000, Performance = 100.89 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046971 s, Result = 0d5c0000, Performance = 104.24 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048140 s, Result = 0d980000, Performance = 103.49 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.048689 s, Result = 0dd40000, Performance = 104.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049234 s, Result = 0e100000, Performance = 104.68 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.049630 s, Result = 0e4c0000, Performance = 105.58 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.050106 s, Result = 0e880000, Performance = 106.29 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.051471 s, Result = 0ec40000, Performance = 105.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.059712 s, Result = 0f000000, Performance =  92.07 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   719  1486  1792
Test passed: M N K =   944  1641   256
Test passed: M N K =  1761   279  1856
Test passed: M N K =  1196  1044   832
Test passed: M N K =   175  1842  2048
M N K =  4096  4096   256, Elapsed time =   0.006311 s, Result = a0dc0000, Performance =  13.61 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006576 s, Result = a1180000, Performance =  26.12 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007314 s, Result = a1540000, Performance =  35.24 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007728 s, Result = a1900000, Performance =  44.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008248 s, Result = a1cc0000, Performance =  52.07 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009177 s, Result = a2080000, Performance =  56.16 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009692 s, Result = a2440000, Performance =  62.04 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010746 s, Result = a2800000, Performance =  63.95 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011193 s, Result = a2bc0000, Performance =  69.07 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012028 s, Result = a2f80000, Performance =  71.41 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012692 s, Result = a3340000, Performance =  74.45 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013692 s, Result = a3700000, Performance =  75.29 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014241 s, Result = a3ac0000, Performance =  78.41 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015068 s, Result = a3e80000, Performance =  79.81 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019055 s, Result = a4240000, Performance =  67.62 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018022 s, Result = a4600000, Performance =  76.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016837 s, Result = a49c0000, Performance =  86.73 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017728 s, Result = a4d80000, Performance =  87.22 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018030 s, Result = a5140000, Performance =  90.52 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018726 s, Result = a5500000, Performance =  91.74 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019055 s, Result = a58c0000, Performance =  94.67 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020140 s, Result = a5c80000, Performance =  93.83 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020730 s, Result = a6040000, Performance =  95.31 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021929 s, Result = a6400000, Performance =  94.01 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022074 s, Result = a67c0000, Performance =  97.29 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022892 s, Result = a6b80000, Performance =  97.56 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023144 s, Result = a6f40000, Performance = 100.21 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024399 s, Result = a7300000, Performance =  98.58 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024485 s, Result = a76c0000, Performance = 101.74 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025424 s, Result = a7a80000, Performance = 101.36 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.025659 s, Result = a7e40000, Performance = 103.78 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.030698 s, Result = a8200000, Performance =  89.54 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027137 s, Result = a85c0000, Performance = 104.46 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028225 s, Result = a8980000, Performance = 103.47 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028789 s, Result = a8d40000, Performance = 104.43 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.029698 s, Result = a9100000, Performance = 104.13 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029970 s, Result = a94c0000, Performance = 106.05 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031154 s, Result = a9880000, Performance = 104.78 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.031142 s, Result = a9c40000, Performance = 107.57 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.033395 s, Result = aa000000, Performance = 102.89 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.032615 s, Result = aa3c0000, Performance = 107.98 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.033816 s, Result = aa780000, Performance = 106.69 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.034223 s, Result = aab40000, Performance = 107.93 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.035201 s, Result = aaf00000, Performance = 107.37 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.035410 s, Result = ab2c0000, Performance = 109.16 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.036467 s, Result = ab680000, Performance = 108.36 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.036522 s, Result = aba40000, Performance = 110.54 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.043966 s, Result = abe00000, Performance =  93.78 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.038382 s, Result = ac1c0000, Performance = 109.66 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.039439 s, Result = ac580000, Performance = 108.90 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.039908 s, Result = ac940000, Performance = 109.77 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.040737 s, Result = acd00000, Performance = 109.65 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.041194 s, Result = ad0c0000, Performance = 110.52 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.042069 s, Result = ad480000, Performance = 110.26 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.042947 s, Result = ad840000, Performance = 110.01 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.045012 s, Result = adc00000, Performance = 106.87 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.044114 s, Result = adfc0000, Performance = 110.99 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.045364 s, Result = ae380000, Performance = 109.83 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.045803 s, Result = ae740000, Performance = 110.65 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.046967 s, Result = aeb00000, Performance = 109.74 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.047410 s, Result = aeec0000, Performance = 110.52 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.048260 s, Result = af280000, Performance = 110.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.048995 s, Result = af640000, Performance = 110.45 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057833 s, Result = afa00000, Performance =  95.06 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   589  1907  2048
Test passed: M N K =   261   519  1920
Test passed: M N K =   616   163   192
Test passed: M N K =   152   301   960
Test passed: M N K =   572  1159   768
M N K =  4096  4096   256, Elapsed time =   0.000973 s, Result = 003c0000, Performance =  88.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001924 s, Result = 00780000, Performance =  89.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002622 s, Result = 00b40000, Performance =  98.27 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003655 s, Result = 00f00000, Performance =  94.00 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004112 s, Result = 012c0000, Performance = 104.46 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004902 s, Result = 01680000, Performance = 105.15 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005710 s, Result = 01a40000, Performance = 105.31 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006685 s, Result = 01e00000, Performance = 102.80 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007389 s, Result = 021c0000, Performance = 104.63 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008323 s, Result = 02580000, Performance = 103.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009114 s, Result = 02940000, Performance = 103.68 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010192 s, Result = 02d00000, Performance = 101.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010834 s, Result = 030c0000, Performance = 103.07 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011544 s, Result = 03480000, Performance = 104.18 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012472 s, Result = 03840000, Performance = 103.31 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014303 s, Result = 03c00000, Performance =  96.09 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017217 s, Result = 03fc0000, Performance =  84.82 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014278 s, Result = 04380000, Performance = 108.29 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014566 s, Result = 04740000, Performance = 112.05 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015353 s, Result = 04b00000, Performance = 111.90 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015809 s, Result = 04ec0000, Performance = 114.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017017 s, Result = 05280000, Performance = 111.05 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.017488 s, Result = 05640000, Performance = 112.98 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018698 s, Result = 05a00000, Performance = 110.26 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.018445 s, Result = 05dc0000, Performance = 116.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019695 s, Result = 06180000, Performance = 113.40 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020176 s, Result = 06540000, Performance = 114.95 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020655 s, Result = 06900000, Performance = 116.44 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.021692 s, Result = 06cc0000, Performance = 114.84 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022219 s, Result = 07080000, Performance = 115.98 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022452 s, Result = 07440000, Performance = 118.60 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026691 s, Result = 07800000, Performance = 102.98 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.023896 s, Result = 07bc0000, Performance = 118.63 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024732 s, Result = 07f80000, Performance = 118.09 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025281 s, Result = 08340000, Performance = 118.92 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026375 s, Result = 08700000, Performance = 117.25 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026836 s, Result = 08ac0000, Performance = 118.43 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.027485 s, Result = 08e80000, Performance = 118.76 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.028132 s, Result = 09240000, Performance = 119.08 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029693 s, Result = 09600000, Performance = 115.72 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028891 s, Result = 099c0000, Performance = 121.90 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.030331 s, Result = 09d80000, Performance = 118.95 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030413 s, Result = 0a140000, Performance = 121.45 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031296 s, Result = 0a500000, Performance = 120.77 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.031736 s, Result = 0a8c0000, Performance = 121.80 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.032479 s, Result = 0ac80000, Performance = 121.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032745 s, Result = 0b040000, Performance = 123.29 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.039556 s, Result = 0b400000, Performance = 104.24 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034092 s, Result = 0b7c0000, Performance = 123.46 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.035793 s, Result = 0bb80000, Performance = 120.00 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035880 s, Result = 0bf40000, Performance = 122.10 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036939 s, Result = 0c300000, Performance = 120.92 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.037438 s, Result = 0c6c0000, Performance = 121.60 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.038273 s, Result = 0ca80000, Performance = 121.20 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039100 s, Result = 0ce40000, Performance = 120.83 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.041520 s, Result = 0d200000, Performance = 115.86 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039782 s, Result = 0d5c0000, Performance = 123.08 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.040902 s, Result = 0d980000, Performance = 121.81 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.041409 s, Result = 0dd40000, Performance = 122.39 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042152 s, Result = 0e100000, Performance = 122.27 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.043021 s, Result = 0e4c0000, Performance = 121.80 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.043649 s, Result = 0e880000, Performance = 122.01 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.043758 s, Result = 0ec40000, Performance = 123.67 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.053106 s, Result = 0f000000, Performance = 103.52 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    26  1343   320
Test passed: M N K =  1552   736  1728
Test passed: M N K =   430   396   384
Test passed: M N K =  1220  1910  1024
Test passed: M N K =   407     1  1472
M N K =  4096  4096   256, Elapsed time =   0.009183 s, Result = d04c0000, Performance =   9.35 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009783 s, Result = 90880000, Performance =  17.56 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009982 s, Result = 50c40000, Performance =  25.82 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011069 s, Result = 11000000, Performance =  31.04 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011504 s, Result = d13c0000, Performance =  37.33 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012629 s, Result = 91780000, Performance =  40.81 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015081 s, Result = 51b40000, Performance =  39.87 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014095 s, Result = 11f00000, Performance =  48.75 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015411 s, Result = d22c0000, Performance =  50.17 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016376 s, Result = 92680000, Performance =  52.46 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017225 s, Result = 52a40000, Performance =  54.86 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.018273 s, Result = 12e00000, Performance =  56.41 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018950 s, Result = d31c0000, Performance =  58.93 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020491 s, Result = 93580000, Performance =  58.69 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.026586 s, Result = 53940000, Performance =  48.46 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022643 s, Result = 13d00000, Performance =  60.70 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023201 s, Result = d40c0000, Performance =  62.94 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024205 s, Result = 94480000, Performance =  63.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025231 s, Result = 54840000, Performance =  64.68 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026372 s, Result = 14c00000, Performance =  65.14 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.026605 s, Result = d4fc0000, Performance =  67.80 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.027604 s, Result = 95380000, Performance =  68.46 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.028383 s, Result = 55740000, Performance =  69.61 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.028397 s, Result = 15b00000, Performance =  72.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.030064 s, Result = d5ec0000, Performance =  71.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.030301 s, Result = 96280000, Performance =  73.71 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.031910 s, Result = 56640000, Performance =  72.68 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.032766 s, Result = 16a00000, Performance =  73.40 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.033155 s, Result = d6dc0000, Performance =  75.13 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.033804 s, Result = 97180000, Performance =  76.23 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.034719 s, Result = 57540000, Performance =  76.70 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.036495 s, Result = 17900000, Performance =  75.32 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.036939 s, Result = d7cc0000, Performance =  76.74 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.037242 s, Result = 98080000, Performance =  78.42 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.038447 s, Result = 58440000, Performance =  78.20 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.039344 s, Result = 18800000, Performance =  78.60 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.039813 s, Result = d8bc0000, Performance =  79.83 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.040680 s, Result = 98f80000, Performance =  80.24 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.041532 s, Result = 59340000, Performance =  80.66 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.041258 s, Result = 19700000, Performance =  83.28 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.043062 s, Result = d9ac0000, Performance =  81.79 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.043461 s, Result = 99e80000, Performance =  83.01 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.044887 s, Result = 5a240000, Performance =  82.29 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.046008 s, Result = 1a600000, Performance =  82.15 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.046316 s, Result = da9c0000, Performance =  83.46 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.046844 s, Result = 9ad80000, Performance =  84.35 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.047393 s, Result = 5b140000, Performance =  85.19 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.050342 s, Result = 1b500000, Performance =  81.90 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.049587 s, Result = db8c0000, Performance =  84.88 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.050154 s, Result = 9bc80000, Performance =  85.64 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.050844 s, Result = 5c040000, Performance =  86.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.052329 s, Result = 1c400000, Performance =  85.36 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.053008 s, Result = dc7c0000, Performance =  85.89 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.054000 s, Result = 9cb80000, Performance =  85.90 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.054567 s, Result = 5cf40000, Performance =  86.58 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.054063 s, Result = 1d300000, Performance =  88.98 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.056536 s, Result = dd6c0000, Performance =  86.60 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.057296 s, Result = 9da80000, Performance =  86.95 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.058480 s, Result = 5de40000, Performance =  86.66 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.059168 s, Result = 1e200000, Performance =  87.11 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.060285 s, Result = de5c0000, Performance =  86.92 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.060336 s, Result = 9e980000, Performance =  88.27 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.061161 s, Result = 5ed40000, Performance =  88.48 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.065370 s, Result = 1f100000, Performance =  84.10 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1972  1095   512
Test passed: M N K =  1882  1474   128
Test passed: M N K =  2030  1065   960
Test passed: M N K =  1183  1946  1920
Test passed: M N K =   175   238   896
M N K =  4096  4096   256, Elapsed time =   0.006547 s, Result = a0dc0000, Performance =  13.12 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006823 s, Result = a1180000, Performance =  25.18 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007354 s, Result = a1540000, Performance =  35.04 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007746 s, Result = a1900000, Performance =  44.36 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008510 s, Result = a1cc0000, Performance =  50.47 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009034 s, Result = a2080000, Performance =  57.05 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009865 s, Result = a2440000, Performance =  60.95 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010512 s, Result = a2800000, Performance =  65.37 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011149 s, Result = a2bc0000, Performance =  69.34 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011949 s, Result = a2f80000, Performance =  71.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013021 s, Result = a3340000, Performance =  72.57 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013981 s, Result = a3700000, Performance =  73.73 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014849 s, Result = a3ac0000, Performance =  75.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015706 s, Result = a3e80000, Performance =  76.57 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016705 s, Result = a4240000, Performance =  77.13 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018098 s, Result = a4600000, Performance =  75.94 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018550 s, Result = a49c0000, Performance =  78.72 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019321 s, Result = a4d80000, Performance =  80.03 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020463 s, Result = a5140000, Performance =  79.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021117 s, Result = a5500000, Performance =  81.36 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021799 s, Result = a58c0000, Performance =  82.75 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022709 s, Result = a5c80000, Performance =  83.22 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023126 s, Result = a6040000, Performance =  85.43 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024085 s, Result = a6400000, Performance =  85.59 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024765 s, Result = a67c0000, Performance =  86.71 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.025642 s, Result = a6b80000, Performance =  87.10 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.026608 s, Result = a6f40000, Performance =  87.17 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027601 s, Result = a7300000, Performance =  87.14 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028495 s, Result = a76c0000, Performance =  87.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.029139 s, Result = a7a80000, Performance =  88.44 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029888 s, Result = a7e40000, Performance =  89.09 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031285 s, Result = a8200000, Performance =  87.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.031243 s, Result = a85c0000, Performance =  90.73 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.032005 s, Result = a8980000, Performance =  91.25 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.032464 s, Result = a8d40000, Performance =  92.61 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.034279 s, Result = a9100000, Performance =  90.21 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034877 s, Result = a94c0000, Performance =  91.13 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035069 s, Result = a9880000, Performance =  93.08 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.036870 s, Result = a9c40000, Performance =  90.86 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036717 s, Result = aa000000, Performance =  93.58 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037999 s, Result = aa3c0000, Performance =  92.68 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038638 s, Result = aa780000, Performance =  93.37 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039608 s, Result = aab40000, Performance =  93.26 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.040523 s, Result = aaf00000, Performance =  93.27 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.041424 s, Result = ab2c0000, Performance =  93.31 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041739 s, Result = ab680000, Performance =  94.67 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.042988 s, Result = aba40000, Performance =  93.92 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.045229 s, Result = abe00000, Performance =  91.16 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.044290 s, Result = ac1c0000, Performance =  95.03 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.044824 s, Result = ac580000, Performance =  95.82 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.045421 s, Result = ac940000, Performance =  96.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.047386 s, Result = acd00000, Performance =  94.26 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.047656 s, Result = ad0c0000, Performance =  95.53 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.048647 s, Result = ad480000, Performance =  95.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.049456 s, Result = ad840000, Performance =  95.53 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.049063 s, Result = adc00000, Performance =  98.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.050741 s, Result = adfc0000, Performance =  96.50 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.051540 s, Result = ae380000, Performance =  96.67 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.052763 s, Result = ae740000, Performance =  96.05 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.053604 s, Result = aeb00000, Performance =  96.15 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.053987 s, Result = aeec0000, Performance =  97.06 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.054544 s, Result = af280000, Performance =  97.64 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055116 s, Result = af640000, Performance =  98.19 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.059037 s, Result = afa00000, Performance =  93.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1523  1561  1344
Test passed: M N K =   368   405  1792
Test passed: M N K =  1216  1143   448
Test passed: M N K =   886   130   960
Test passed: M N K =   231  1800  1728
M N K =  4096  4096   256, Elapsed time =   0.000967 s, Result = 003c0000, Performance =  88.83 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001966 s, Result = 00780000, Performance =  87.40 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002872 s, Result = 00b40000, Performance =  89.72 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003913 s, Result = 00f00000, Performance =  87.82 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004639 s, Result = 012c0000, Performance =  92.59 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005447 s, Result = 01680000, Performance =  94.62 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.006064 s, Result = 01a40000, Performance =  99.16 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.007196 s, Result = 01e00000, Performance =  95.50 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007812 s, Result = 021c0000, Performance =  98.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009004 s, Result = 02580000, Performance =  95.40 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009953 s, Result = 02940000, Performance =  94.93 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011051 s, Result = 02d00000, Performance =  93.27 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011432 s, Result = 030c0000, Performance =  97.68 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012739 s, Result = 03480000, Performance =  94.40 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013585 s, Result = 03840000, Performance =  94.85 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016549 s, Result = 03c00000, Performance =  83.05 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015255 s, Result = 03fc0000, Performance =  95.73 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016234 s, Result = 04380000, Performance =  95.25 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017148 s, Result = 04740000, Performance =  95.18 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017782 s, Result = 04b00000, Performance =  96.61 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018575 s, Result = 04ec0000, Performance =  97.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019268 s, Result = 05280000, Performance =  98.08 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020267 s, Result = 05640000, Performance =  97.48 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020956 s, Result = 05a00000, Performance =  98.38 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.027205 s, Result = 05dc0000, Performance =  78.94 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022280 s, Result = 06180000, Performance = 100.24 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023314 s, Result = 06540000, Performance =  99.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024730 s, Result = 06900000, Performance =  97.26 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024659 s, Result = 06cc0000, Performance = 101.02 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025520 s, Result = 07080000, Performance = 100.98 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026377 s, Result = 07440000, Performance = 100.96 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027496 s, Result = 07800000, Performance =  99.97 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027843 s, Result = 07bc0000, Performance = 101.81 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.027917 s, Result = 07f80000, Performance = 104.62 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.029781 s, Result = 08340000, Performance = 100.95 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030580 s, Result = 08700000, Performance = 101.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.030844 s, Result = 08ac0000, Performance = 103.04 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032232 s, Result = 08e80000, Performance = 101.27 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032870 s, Result = 09240000, Performance = 101.92 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.033167 s, Result = 09600000, Performance = 103.60 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.034780 s, Result = 099c0000, Performance = 101.26 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.034574 s, Result = 09d80000, Performance = 104.35 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036513 s, Result = 0a140000, Performance = 101.16 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037520 s, Result = 0a500000, Performance = 100.74 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.037127 s, Result = 0a8c0000, Performance = 104.11 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.038412 s, Result = 0ac80000, Performance = 102.87 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.038859 s, Result = 0b040000, Performance = 103.89 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.041244 s, Result = 0b400000, Performance =  99.97 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.040165 s, Result = 0b7c0000, Performance = 104.80 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.040924 s, Result = 0bb80000, Performance = 104.95 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042384 s, Result = 0bf40000, Performance = 103.36 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.043167 s, Result = 0c300000, Performance = 103.48 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043631 s, Result = 0c6c0000, Performance = 104.34 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044813 s, Result = 0ca80000, Performance = 103.51 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046084 s, Result = 0ce40000, Performance = 102.52 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046185 s, Result = 0d200000, Performance = 104.15 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.047050 s, Result = 0d5c0000, Performance = 104.06 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048276 s, Result = 0d980000, Performance = 103.20 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.048372 s, Result = 0dd40000, Performance = 104.77 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.050324 s, Result = 0e100000, Performance = 102.41 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.050136 s, Result = 0e4c0000, Performance = 104.51 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.050296 s, Result = 0e880000, Performance = 105.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.051901 s, Result = 0ec40000, Performance = 104.27 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054419 s, Result = 0f000000, Performance = 101.02 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1652  1766   704
Test passed: M N K =   355  1397    64
Test passed: M N K =  1552  2037  1728
Test passed: M N K =  1045  1782  1152
Test passed: M N K =  1072  1640  1664
M N K =  4096  4096   256, Elapsed time =   0.007626 s, Result = 50420000, Performance =  11.26 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007703 s, Result = 90740000, Performance =  22.30 TOPS
M N K =  4096  4096   768, Elapsed time =   0.008508 s, Result = d0a60000, Performance =  30.29 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010298 s, Result = 10d80000, Performance =  33.37 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010879 s, Result = 510a0000, Performance =  39.48 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012274 s, Result = 913c0000, Performance =  41.99 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012935 s, Result = d16e0000, Performance =  46.48 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014106 s, Result = 11a00000, Performance =  48.72 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014808 s, Result = 51d20000, Performance =  52.21 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014992 s, Result = 92040000, Performance =  57.30 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014841 s, Result = d2360000, Performance =  63.67 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015990 s, Result = 12680000, Performance =  64.47 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.016533 s, Result = 529a0000, Performance =  67.54 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017845 s, Result = 92cc0000, Performance =  67.39 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018504 s, Result = d2fe0000, Performance =  69.63 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018515 s, Result = 13300000, Performance =  74.23 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019149 s, Result = 53620000, Performance =  76.26 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020224 s, Result = 93940000, Performance =  76.45 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020022 s, Result = d3c60000, Performance =  81.51 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021053 s, Result = 13f80000, Performance =  81.60 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021439 s, Result = 542a0000, Performance =  84.14 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023613 s, Result = 945c0000, Performance =  80.03 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.022302 s, Result = d48e0000, Performance =  88.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023470 s, Result = 14c00000, Performance =  87.84 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023624 s, Result = 54f20000, Performance =  90.90 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.024355 s, Result = 95240000, Performance =  91.70 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024944 s, Result = d5560000, Performance =  92.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.025669 s, Result = 15880000, Performance =  93.70 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026380 s, Result = 55ba0000, Performance =  94.43 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026471 s, Result = 95ec0000, Performance =  97.35 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.027296 s, Result = d61e0000, Performance =  97.55 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.028166 s, Result = 16500000, Performance =  97.59 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.028855 s, Result = 56820000, Performance =  98.24 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.029385 s, Result = 96b40000, Performance =  99.39 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030855 s, Result = d6e60000, Performance =  97.44 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030583 s, Result = 17180000, Performance = 101.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031908 s, Result = 574a0000, Performance =  99.61 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032885 s, Result = 977c0000, Performance =  99.26 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032977 s, Result = d7ae0000, Performance = 101.59 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034177 s, Result = 17e00000, Performance = 100.54 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.034189 s, Result = 58120000, Performance = 103.01 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.035519 s, Result = 98440000, Performance = 101.57 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036761 s, Result = d8760000, Performance = 100.48 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.036633 s, Result = 18a80000, Performance = 103.17 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038353 s, Result = 58da0000, Performance = 100.79 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.038349 s, Result = 990c0000, Performance = 103.04 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039710 s, Result = d93e0000, Performance = 101.67 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040272 s, Result = 19700000, Performance = 102.38 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041249 s, Result = 59a20000, Performance = 102.04 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.041492 s, Result = 99d40000, Performance = 103.51 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042880 s, Result = da060000, Performance = 102.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.042878 s, Result = 1a380000, Performance = 104.17 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.044472 s, Result = 5a6a0000, Performance = 102.37 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.045268 s, Result = 9a9c0000, Performance = 102.47 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046153 s, Result = dace0000, Performance = 102.37 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046955 s, Result = 1b000000, Performance = 102.45 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.047491 s, Result = 5b320000, Performance = 103.10 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048602 s, Result = 9b640000, Performance = 102.51 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050431 s, Result = db960000, Performance = 100.49 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049860 s, Result = 1bc80000, Performance = 103.37 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.050906 s, Result = 5bfa0000, Performance = 102.93 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.051874 s, Result = 9c2c0000, Performance = 102.67 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.052741 s, Result = dc5e0000, Performance = 102.61 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054189 s, Result = 1c900000, Performance = 101.45 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1415   917   384
Test passed: M N K =  1216  1474  1984
Test passed: M N K =  1955   828  1344
Test passed: M N K =   727  1463   640
Test passed: M N K =   687  1402  1728
M N K =  4096  4096   256, Elapsed time =   0.010511 s, Result = 00320000, Performance =   8.17 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007861 s, Result = 00640000, Performance =  21.85 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009536 s, Result = 00960000, Performance =  27.02 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.009338 s, Result = 00c80000, Performance =  36.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010036 s, Result = 00fa0000, Performance =  42.80 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.010077 s, Result = 012c0000, Performance =  51.14 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010202 s, Result = 015e0000, Performance =  58.94 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011526 s, Result = 01900000, Performance =  59.62 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011557 s, Result = 01c20000, Performance =  66.90 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012186 s, Result = 01f40000, Performance =  70.49 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012987 s, Result = 02260000, Performance =  72.76 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012899 s, Result = 02580000, Performance =  79.91 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014030 s, Result = 028a0000, Performance =  79.59 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014273 s, Result = 02bc0000, Performance =  84.26 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015288 s, Result = 02ee0000, Performance =  84.28 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016298 s, Result = 03200000, Performance =  84.33 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016344 s, Result = 03520000, Performance =  89.35 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016858 s, Result = 03840000, Performance =  91.72 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017552 s, Result = 03b60000, Performance =  92.99 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017795 s, Result = 03e80000, Performance =  96.54 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018900 s, Result = 041a0000, Performance =  95.44 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019322 s, Result = 044c0000, Performance =  97.80 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019802 s, Result = 047e0000, Performance =  99.77 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021382 s, Result = 04b00000, Performance =  96.42 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020828 s, Result = 04e20000, Performance = 103.11 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021799 s, Result = 05140000, Performance = 102.45 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022305 s, Result = 05460000, Performance = 103.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022602 s, Result = 05780000, Performance = 106.41 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.023931 s, Result = 05aa0000, Performance = 104.09 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.023770 s, Result = 05dc0000, Performance = 108.41 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.024924 s, Result = 060e0000, Performance = 106.84 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025742 s, Result = 06400000, Performance = 106.78 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025440 s, Result = 06720000, Performance = 111.42 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026515 s, Result = 06a40000, Performance = 110.15 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026861 s, Result = 06d60000, Performance = 111.93 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.027339 s, Result = 07080000, Performance = 113.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.028637 s, Result = 073a0000, Performance = 110.98 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028499 s, Result = 076c0000, Performance = 114.54 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.029313 s, Result = 079e0000, Performance = 114.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.031120 s, Result = 07d00000, Performance = 110.41 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030462 s, Result = 08020000, Performance = 115.62 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.031769 s, Result = 08340000, Performance = 113.56 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032380 s, Result = 08660000, Performance = 114.07 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032644 s, Result = 08980000, Performance = 115.78 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.033338 s, Result = 08ca0000, Performance = 115.95 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.033702 s, Result = 08fc0000, Performance = 117.24 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.034912 s, Result = 092e0000, Performance = 115.64 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.035713 s, Result = 09600000, Performance = 115.45 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036134 s, Result = 09920000, Performance = 116.49 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.036738 s, Result = 09c40000, Performance = 116.91 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.037342 s, Result = 09f60000, Performance = 117.32 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.037876 s, Result = 0a280000, Performance = 117.93 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.039065 s, Result = 0a5a0000, Performance = 116.54 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.039718 s, Result = 0a8c0000, Performance = 116.79 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.041156 s, Result = 0abe0000, Performance = 114.79 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.041638 s, Result = 0af00000, Performance = 115.53 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.042348 s, Result = 0b220000, Performance = 115.62 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.043420 s, Result = 0b540000, Performance = 114.74 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.044394 s, Result = 0b860000, Performance = 114.16 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.045116 s, Result = 0bb80000, Performance = 114.24 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.045482 s, Result = 0bea0000, Performance = 115.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.047005 s, Result = 0c1c0000, Performance = 113.30 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.047429 s, Result = 0c4e0000, Performance = 114.10 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.047481 s, Result = 0c800000, Performance = 115.79 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    47   466  1984
Test passed: M N K =  1422   923  1152
Test passed: M N K =    62  1513  1984
Test passed: M N K =  1196   840  1792
Test passed: M N K =  1944  1910  1984
M N K =  4096  4096   256, Elapsed time =   0.006898 s, Result = a0d20000, Performance =  12.45 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006717 s, Result = a1040000, Performance =  25.58 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007219 s, Result = a1360000, Performance =  35.70 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007313 s, Result = a1680000, Performance =  46.99 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009366 s, Result = a19a0000, Performance =  45.86 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008347 s, Result = a1cc0000, Performance =  61.75 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008939 s, Result = a1fe0000, Performance =  67.27 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009986 s, Result = a2300000, Performance =  68.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010119 s, Result = a2620000, Performance =  76.40 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010520 s, Result = a2940000, Performance =  81.65 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.011027 s, Result = a2c60000, Performance =  85.69 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011604 s, Result = a2f80000, Performance =  88.83 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.012192 s, Result = a32a0000, Performance =  91.59 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012804 s, Result = a35c0000, Performance =  93.92 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013374 s, Result = a38e0000, Performance =  96.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016620 s, Result = a3c00000, Performance =  82.69 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.014617 s, Result = a3f20000, Performance =  99.90 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.015224 s, Result = a4240000, Performance = 101.56 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.015917 s, Result = a4560000, Performance = 102.54 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.016694 s, Result = a4880000, Performance = 102.91 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017133 s, Result = a4ba0000, Performance = 105.28 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017442 s, Result = a4ec0000, Performance = 108.35 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018099 s, Result = a51e0000, Performance = 109.16 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018865 s, Result = a5500000, Performance = 109.28 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019364 s, Result = a5820000, Performance = 110.90 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019959 s, Result = a5b40000, Performance = 111.90 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020460 s, Result = a5e60000, Performance = 113.36 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021542 s, Result = a6180000, Performance = 111.65 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.021924 s, Result = a64a0000, Performance = 113.62 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022515 s, Result = a67c0000, Performance = 114.46 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022740 s, Result = a6ae0000, Performance = 117.10 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026966 s, Result = a6e00000, Performance = 101.94 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024237 s, Result = a7120000, Performance = 116.96 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024719 s, Result = a7440000, Performance = 118.15 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025761 s, Result = a7760000, Performance = 116.71 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026190 s, Result = a7a80000, Performance = 118.07 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026780 s, Result = a7da0000, Performance = 118.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.027295 s, Result = a80c0000, Performance = 119.59 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027801 s, Result = a83e0000, Performance = 120.50 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028848 s, Result = a8700000, Performance = 119.10 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.029439 s, Result = a8a20000, Performance = 119.63 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.029750 s, Result = a8d40000, Performance = 121.27 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030711 s, Result = a9060000, Performance = 120.27 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031037 s, Result = a9380000, Performance = 121.77 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.031612 s, Result = a96a0000, Performance = 122.28 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.032651 s, Result = a99c0000, Performance = 121.02 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032714 s, Result = a9ce0000, Performance = 123.41 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034479 s, Result = aa000000, Performance = 119.59 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034675 s, Result = aa320000, Performance = 121.38 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034475 s, Result = aa640000, Performance = 124.58 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035869 s, Result = aa960000, Performance = 122.13 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036066 s, Result = aac80000, Performance = 123.85 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.037201 s, Result = aafa0000, Performance = 122.38 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.038114 s, Result = ab2c0000, Performance = 121.70 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039206 s, Result = ab5e0000, Performance = 120.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.039756 s, Result = ab900000, Performance = 121.00 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.040454 s, Result = abc20000, Performance = 121.03 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.041331 s, Result = abf40000, Performance = 120.54 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.042414 s, Result = ac260000, Performance = 119.49 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042534 s, Result = ac580000, Performance = 121.17 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.043673 s, Result = ac8a0000, Performance = 119.98 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044277 s, Result = acbc0000, Performance = 120.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.045057 s, Result = acee0000, Performance = 120.11 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046657 s, Result = ad200000, Performance = 117.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1223  1120  1216
Test passed: M N K =  1785   938  1792
Test passed: M N K =  1488   454   448
Test passed: M N K =   320   925  1920
Test passed: M N K =   927  1560   384
M N K =  4096  4096   256, Elapsed time =   0.000907 s, Result = 00320000, Performance =  94.70 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001876 s, Result = 00640000, Performance =  91.55 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002582 s, Result = 00960000, Performance =  99.82 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003290 s, Result = 00c80000, Performance = 104.45 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003703 s, Result = 00fa0000, Performance = 116.00 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004558 s, Result = 012c0000, Performance = 113.08 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005267 s, Result = 015e0000, Performance = 114.17 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005651 s, Result = 01900000, Performance = 121.61 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006494 s, Result = 01c20000, Performance = 119.04 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007087 s, Result = 01f40000, Performance = 121.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.007435 s, Result = 02260000, Performance = 127.09 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008361 s, Result = 02580000, Performance = 123.28 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.008693 s, Result = 028a0000, Performance = 128.45 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.009448 s, Result = 02bc0000, Performance = 127.29 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010138 s, Result = 02ee0000, Performance = 127.10 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.015936 s, Result = 03200000, Performance =  86.24 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011077 s, Result = 03520000, Performance = 131.83 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.011755 s, Result = 03840000, Performance = 131.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012324 s, Result = 03b60000, Performance = 132.43 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.012913 s, Result = 03e80000, Performance = 133.04 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.013201 s, Result = 041a0000, Performance = 136.65 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.013975 s, Result = 044c0000, Performance = 135.23 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014476 s, Result = 047e0000, Performance = 136.48 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016574 s, Result = 04b00000, Performance = 124.39 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015690 s, Result = 04e20000, Performance = 136.87 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016526 s, Result = 05140000, Performance = 135.14 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.016947 s, Result = 05460000, Performance = 136.86 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.017543 s, Result = 05780000, Performance = 137.10 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017940 s, Result = 05aa0000, Performance = 138.86 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018245 s, Result = 05dc0000, Performance = 141.25 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.019194 s, Result = 060e0000, Performance = 138.73 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023350 s, Result = 06400000, Performance = 117.72 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.020361 s, Result = 06720000, Performance = 139.22 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020472 s, Result = 06a40000, Performance = 142.66 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.021652 s, Result = 06d60000, Performance = 138.85 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022041 s, Result = 07080000, Performance = 140.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.022580 s, Result = 073a0000, Performance = 140.76 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.023204 s, Result = 076c0000, Performance = 140.67 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.023488 s, Result = 079e0000, Performance = 142.63 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025299 s, Result = 07d00000, Performance = 135.82 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.024928 s, Result = 08020000, Performance = 141.28 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.025461 s, Result = 08340000, Performance = 141.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026439 s, Result = 08660000, Performance = 139.71 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026666 s, Result = 08980000, Performance = 141.74 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027106 s, Result = 08ca0000, Performance = 142.61 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.027597 s, Result = 08fc0000, Performance = 143.18 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028554 s, Result = 092e0000, Performance = 141.39 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.031563 s, Result = 09600000, Performance = 130.63 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029317 s, Result = 09920000, Performance = 143.57 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.030207 s, Result = 09c40000, Performance = 142.19 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030732 s, Result = 09f60000, Performance = 142.55 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.031250 s, Result = 0a280000, Performance = 142.94 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031952 s, Result = 0a5a0000, Performance = 142.49 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.033043 s, Result = 0a8c0000, Performance = 140.38 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.033972 s, Result = 0abe0000, Performance = 139.07 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.034513 s, Result = 0af00000, Performance = 139.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.035531 s, Result = 0b220000, Performance = 137.80 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.036027 s, Result = 0b540000, Performance = 138.29 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.037350 s, Result = 0b860000, Performance = 135.69 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.037365 s, Result = 0bb80000, Performance = 137.93 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.038432 s, Result = 0bea0000, Performance = 136.34 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.039110 s, Result = 0c1c0000, Performance = 136.17 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039644 s, Result = 0c4e0000, Performance = 136.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.040907 s, Result = 0c800000, Performance = 134.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1646  1041  2048
Test passed: M N K =  1586  1455  1216
Test passed: M N K =    82   550  1344
Test passed: M N K =  1692   194   256
Test passed: M N K =   825   474  1216
M N K =  4096  4096   256, Elapsed time =   0.007218 s, Result = 50420000, Performance =  11.90 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007435 s, Result = 90740000, Performance =  23.11 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009043 s, Result = d0a60000, Performance =  28.50 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.009576 s, Result = 10d80000, Performance =  35.88 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010944 s, Result = 510a0000, Performance =  39.25 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012795 s, Result = 913c0000, Performance =  40.28 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013472 s, Result = d16e0000, Performance =  44.63 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014259 s, Result = 11a00000, Performance =  48.19 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014416 s, Result = 51d20000, Performance =  53.63 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015422 s, Result = 92040000, Performance =  55.70 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016440 s, Result = d2360000, Performance =  57.48 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016869 s, Result = 12680000, Performance =  61.11 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017175 s, Result = 529a0000, Performance =  65.02 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018211 s, Result = 92cc0000, Performance =  66.04 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.023377 s, Result = d2fe0000, Performance =  55.12 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020013 s, Result = 13300000, Performance =  68.67 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019464 s, Result = 53620000, Performance =  75.03 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020361 s, Result = 93940000, Performance =  75.94 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020435 s, Result = d3c60000, Performance =  79.87 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021093 s, Result = 13f80000, Performance =  81.45 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022229 s, Result = 542a0000, Performance =  81.15 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022511 s, Result = 945c0000, Performance =  83.95 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023004 s, Result = d48e0000, Performance =  85.88 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.025186 s, Result = 14c00000, Performance =  81.86 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024433 s, Result = 54f20000, Performance =  87.89 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.025243 s, Result = 95240000, Performance =  88.47 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.025214 s, Result = d5560000, Performance =  91.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.026168 s, Result = 15880000, Performance =  91.91 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.027245 s, Result = 55ba0000, Performance =  91.43 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.027359 s, Result = 95ec0000, Performance =  94.19 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.028037 s, Result = d61e0000, Performance =  94.98 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031106 s, Result = 16500000, Performance =  88.37 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029182 s, Result = 56820000, Performance =  97.14 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.030865 s, Result = 96b40000, Performance =  94.62 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030428 s, Result = d6e60000, Performance =  98.81 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.031381 s, Result = 17180000, Performance =  98.54 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031731 s, Result = 574a0000, Performance = 100.16 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032973 s, Result = 977c0000, Performance =  99.00 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.033419 s, Result = d7ae0000, Performance = 100.24 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036645 s, Result = 17e00000, Performance =  93.76 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035049 s, Result = 58120000, Performance = 100.48 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036610 s, Result = 98440000, Performance =  98.55 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.036295 s, Result = d8760000, Performance = 101.77 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037619 s, Result = 18a80000, Performance = 100.47 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.037893 s, Result = 58da0000, Performance = 102.01 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.038635 s, Result = 990c0000, Performance = 102.27 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039371 s, Result = d93e0000, Performance = 102.54 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.044801 s, Result = 19700000, Performance =  92.03 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.040579 s, Result = 59a20000, Performance = 103.73 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.042026 s, Result = 99d40000, Performance = 102.20 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042489 s, Result = da060000, Performance = 103.11 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.043237 s, Result = 1a380000, Performance = 103.31 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043902 s, Result = 5a6a0000, Performance = 103.70 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044880 s, Result = 9a9c0000, Performance = 103.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.045735 s, Result = dace0000, Performance = 103.30 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.048570 s, Result = 1b000000, Performance =  99.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046997 s, Result = 5b320000, Performance = 104.18 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.047828 s, Result = 9b640000, Performance = 104.17 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.048546 s, Result = db960000, Performance = 104.40 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049268 s, Result = 1bc80000, Performance = 104.61 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.050194 s, Result = 5bfa0000, Performance = 104.39 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.051074 s, Result = 9c2c0000, Performance = 104.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.051310 s, Result = dc5e0000, Performance = 105.47 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057103 s, Result = 1c900000, Performance =  96.28 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   822    77  1344
Test passed: M N K =  1752  1458    64
Test passed: M N K =   450   838  1728
Test passed: M N K =  1221  1515   384
Test passed: M N K =  1350   616   960
M N K =  4096  4096   256, Elapsed time =   0.010660 s, Result = 00320000, Performance =   8.06 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008482 s, Result = 00640000, Performance =  20.26 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009059 s, Result = 00960000, Performance =  28.45 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.009765 s, Result = 00c80000, Performance =  35.19 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010017 s, Result = 00fa0000, Performance =  42.88 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.010153 s, Result = 012c0000, Performance =  50.76 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010855 s, Result = 015e0000, Performance =  55.39 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011085 s, Result = 01900000, Performance =  62.00 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012262 s, Result = 01c20000, Performance =  63.05 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013117 s, Result = 01f40000, Performance =  65.49 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013755 s, Result = 02260000, Performance =  68.70 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015007 s, Result = 02580000, Performance =  68.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015255 s, Result = 028a0000, Performance =  73.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015856 s, Result = 02bc0000, Performance =  75.85 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016437 s, Result = 02ee0000, Performance =  78.39 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017183 s, Result = 03200000, Performance =  79.99 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017390 s, Result = 03520000, Performance =  83.97 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017842 s, Result = 03840000, Performance =  86.66 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018168 s, Result = 03b60000, Performance =  89.83 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019636 s, Result = 03e80000, Performance =  87.49 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019526 s, Result = 041a0000, Performance =  92.38 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020890 s, Result = 044c0000, Performance =  90.46 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020882 s, Result = 047e0000, Performance =  94.61 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022845 s, Result = 04b00000, Performance =  90.24 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022359 s, Result = 04e20000, Performance =  96.04 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022829 s, Result = 05140000, Performance =  97.83 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023759 s, Result = 05460000, Performance =  97.62 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024825 s, Result = 05780000, Performance =  96.89 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024194 s, Result = 05aa0000, Performance = 102.96 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025741 s, Result = 05dc0000, Performance = 100.11 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.025639 s, Result = 060e0000, Performance = 103.86 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.028780 s, Result = 06400000, Performance =  95.51 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027642 s, Result = 06720000, Performance = 102.55 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.027747 s, Result = 06a40000, Performance = 105.26 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028307 s, Result = 06d60000, Performance = 106.21 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.029529 s, Result = 07080000, Performance = 104.72 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029312 s, Result = 073a0000, Performance = 108.43 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031023 s, Result = 076c0000, Performance = 105.22 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030228 s, Result = 079e0000, Performance = 110.83 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.033396 s, Result = 07d00000, Performance = 102.89 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.032288 s, Result = 08020000, Performance = 109.08 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032624 s, Result = 08340000, Performance = 110.59 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.033409 s, Result = 08660000, Performance = 110.56 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.034229 s, Result = 08980000, Performance = 110.42 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.034469 s, Result = 08ca0000, Performance = 112.14 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.035489 s, Result = 08fc0000, Performance = 111.34 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.035418 s, Result = 092e0000, Performance = 113.99 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.041226 s, Result = 09600000, Performance = 100.01 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036868 s, Result = 09920000, Performance = 114.17 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.038028 s, Result = 09c40000, Performance = 112.94 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.038441 s, Result = 09f60000, Performance = 113.96 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.039127 s, Result = 0a280000, Performance = 114.16 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.039567 s, Result = 0a5a0000, Performance = 115.06 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.040253 s, Result = 0a8c0000, Performance = 115.24 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.040716 s, Result = 0abe0000, Performance = 116.04 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.045009 s, Result = 0af00000, Performance = 106.88 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.042135 s, Result = 0b220000, Performance = 116.20 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.043218 s, Result = 0b540000, Performance = 115.28 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.044194 s, Result = 0b860000, Performance = 114.68 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.044331 s, Result = 0bb80000, Performance = 116.26 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.045164 s, Result = 0bea0000, Performance = 116.02 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.045912 s, Result = 0c1c0000, Performance = 116.00 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.046049 s, Result = 0c4e0000, Performance = 117.52 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.052595 s, Result = 0c800000, Performance = 104.53 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1490  1240  1408
Test passed: M N K =  1965  2016  1920
Test passed: M N K =  1137   324  1792
Test passed: M N K =   132   500   640
Test passed: M N K =  1332  1263  1664
M N K =  4096  4096   256, Elapsed time =   0.006557 s, Result = a0d20000, Performance =  13.10 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007107 s, Result = a1040000, Performance =  24.17 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007596 s, Result = a1360000, Performance =  33.93 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007738 s, Result = a1680000, Performance =  44.41 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008121 s, Result = a19a0000, Performance =  52.89 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008763 s, Result = a1cc0000, Performance =  58.81 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009362 s, Result = a1fe0000, Performance =  64.23 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009993 s, Result = a2300000, Performance =  68.77 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010572 s, Result = a2620000, Performance =  73.12 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011487 s, Result = a2940000, Performance =  74.78 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012028 s, Result = a2c60000, Performance =  78.56 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012833 s, Result = a2f80000, Performance =  80.33 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013438 s, Result = a32a0000, Performance =  83.10 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019328 s, Result = a35c0000, Performance =  62.22 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014517 s, Result = a38e0000, Performance =  88.76 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016485 s, Result = a3c00000, Performance =  83.37 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015680 s, Result = a3f20000, Performance =  93.13 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016478 s, Result = a4240000, Performance =  93.83 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017049 s, Result = a4560000, Performance =  95.73 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017540 s, Result = a4880000, Performance =  97.95 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017870 s, Result = a4ba0000, Performance = 100.95 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018874 s, Result = a4ec0000, Performance = 100.12 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019037 s, Result = a51e0000, Performance = 103.78 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020844 s, Result = a5500000, Performance =  98.91 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020421 s, Result = a5820000, Performance = 105.16 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020982 s, Result = a5b40000, Performance = 106.45 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021295 s, Result = a5e60000, Performance = 108.91 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022165 s, Result = a6180000, Performance = 108.51 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022990 s, Result = a64a0000, Performance = 108.36 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026328 s, Result = a67c0000, Performance =  97.88 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023918 s, Result = a6ae0000, Performance = 111.33 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027552 s, Result = a6e00000, Performance =  99.77 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025015 s, Result = a7120000, Performance = 113.32 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025964 s, Result = a7440000, Performance = 112.49 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026509 s, Result = a7760000, Performance = 113.41 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.027064 s, Result = a7a80000, Performance = 114.26 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027312 s, Result = a7da0000, Performance = 116.37 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028668 s, Result = a80c0000, Performance = 113.86 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.029225 s, Result = a83e0000, Performance = 114.63 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.031751 s, Result = a8700000, Performance = 108.22 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.029960 s, Result = a8a20000, Performance = 117.55 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.031113 s, Result = a8d40000, Performance = 115.96 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.031373 s, Result = a9060000, Performance = 117.73 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032371 s, Result = a9380000, Performance = 116.76 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.032564 s, Result = a96a0000, Performance = 118.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.033413 s, Result = a99c0000, Performance = 118.26 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.033540 s, Result = a9ce0000, Performance = 120.37 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.039585 s, Result = aa000000, Performance = 104.16 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.035096 s, Result = aa320000, Performance = 119.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.035915 s, Result = aa640000, Performance = 119.59 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.036321 s, Result = aa960000, Performance = 120.61 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036893 s, Result = aac80000, Performance = 121.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.038044 s, Result = aafa0000, Performance = 119.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.038631 s, Result = ab2c0000, Performance = 120.07 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039085 s, Result = ab5e0000, Performance = 120.88 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.042577 s, Result = ab900000, Performance = 112.98 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039902 s, Result = abc20000, Performance = 122.71 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.041325 s, Result = abf40000, Performance = 120.56 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.041514 s, Result = ac260000, Performance = 122.08 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042079 s, Result = ac580000, Performance = 122.48 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042807 s, Result = ac8a0000, Performance = 122.41 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.043803 s, Result = acbc0000, Performance = 121.58 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.043924 s, Result = acee0000, Performance = 123.21 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.051152 s, Result = ad200000, Performance = 107.47 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   537    91  2048
Test passed: M N K =   436  1887   512
Test passed: M N K =  2027  1114  1216
Test passed: M N K =   547   264  1216
Test passed: M N K =  1440  1316   832
M N K =  4096  4096   256, Elapsed time =   0.000940 s, Result = 00320000, Performance =  91.39 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001912 s, Result = 00640000, Performance =  89.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002736 s, Result = 00960000, Performance =  94.20 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003344 s, Result = 00c80000, Performance = 102.76 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004093 s, Result = 00fa0000, Performance = 104.93 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004639 s, Result = 012c0000, Performance = 111.09 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005280 s, Result = 015e0000, Performance = 113.88 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005964 s, Result = 01900000, Performance = 115.23 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006959 s, Result = 01c20000, Performance = 111.10 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007922 s, Result = 01f40000, Performance = 108.43 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008403 s, Result = 02260000, Performance = 112.44 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009361 s, Result = 02580000, Performance = 110.11 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009887 s, Result = 028a0000, Performance = 112.95 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010941 s, Result = 02bc0000, Performance = 109.92 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011020 s, Result = 02ee0000, Performance = 116.93 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012277 s, Result = 03200000, Performance = 111.95 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011991 s, Result = 03520000, Performance = 121.78 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013155 s, Result = 03840000, Performance = 117.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013559 s, Result = 03b60000, Performance = 120.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014243 s, Result = 03e80000, Performance = 120.62 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014689 s, Result = 041a0000, Performance = 122.80 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015363 s, Result = 044c0000, Performance = 123.01 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015839 s, Result = 047e0000, Performance = 124.74 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017048 s, Result = 04b00000, Performance = 120.93 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017117 s, Result = 04e20000, Performance = 125.46 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017684 s, Result = 05140000, Performance = 126.29 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018271 s, Result = 05460000, Performance = 126.94 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.018631 s, Result = 05780000, Performance = 129.09 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019410 s, Result = 05aa0000, Performance = 128.34 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020451 s, Result = 05dc0000, Performance = 126.01 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020287 s, Result = 060e0000, Performance = 131.26 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023459 s, Result = 06400000, Performance = 117.17 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021451 s, Result = 06720000, Performance = 132.15 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022430 s, Result = 06a40000, Performance = 130.21 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.023106 s, Result = 06d60000, Performance = 130.12 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023952 s, Result = 07080000, Performance = 129.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.024449 s, Result = 073a0000, Performance = 130.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024955 s, Result = 076c0000, Performance = 130.80 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.025918 s, Result = 079e0000, Performance = 129.26 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.027673 s, Result = 07d00000, Performance = 124.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.026598 s, Result = 08020000, Performance = 132.41 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.027583 s, Result = 08340000, Performance = 130.80 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.028061 s, Result = 08660000, Performance = 131.63 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.028459 s, Result = 08980000, Performance = 132.81 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.029219 s, Result = 08ca0000, Performance = 132.30 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.029457 s, Result = 08fc0000, Performance = 134.14 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.030196 s, Result = 092e0000, Performance = 133.70 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.035495 s, Result = 09600000, Performance = 116.16 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.031105 s, Result = 09920000, Performance = 135.32 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.032386 s, Result = 09c40000, Performance = 132.62 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.032525 s, Result = 09f60000, Performance = 134.69 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.033210 s, Result = 0a280000, Performance = 134.50 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.033682 s, Result = 0a5a0000, Performance = 135.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.035162 s, Result = 0a8c0000, Performance = 131.92 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.035058 s, Result = 0abe0000, Performance = 134.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.037999 s, Result = 0af00000, Performance = 126.59 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.035871 s, Result = 0b220000, Performance = 136.50 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.037429 s, Result = 0b540000, Performance = 133.11 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.037573 s, Result = 0b860000, Performance = 134.89 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.038656 s, Result = 0bb80000, Performance = 133.33 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.038818 s, Result = 0bea0000, Performance = 134.99 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.039576 s, Result = 0c1c0000, Performance = 134.57 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039859 s, Result = 0c4e0000, Performance = 135.77 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046352 s, Result = 0c800000, Performance = 118.61 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1550   553  1216
Test passed: M N K =   482   869  1280
Test passed: M N K =  1125   483   512
Test passed: M N K =    47  1726   832
Test passed: M N K =   441  1443   512
M N K =  4096  4096   256, Elapsed time =   0.007761 s, Result = 50420000, Performance =  11.07 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007801 s, Result = 90740000, Performance =  22.02 TOPS
M N K =  4096  4096   768, Elapsed time =   0.008655 s, Result = d0a60000, Performance =  29.78 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.009866 s, Result = 10d80000, Performance =  34.83 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010769 s, Result = 510a0000, Performance =  39.88 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012580 s, Result = 913c0000, Performance =  40.97 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012749 s, Result = d16e0000, Performance =  47.16 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013522 s, Result = 11a00000, Performance =  50.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014066 s, Result = 51d20000, Performance =  54.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015626 s, Result = 92040000, Performance =  54.97 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016510 s, Result = d2360000, Performance =  57.23 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017651 s, Result = 12680000, Performance =  58.40 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017542 s, Result = 529a0000, Performance =  63.66 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019282 s, Result = 92cc0000, Performance =  62.37 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019254 s, Result = d2fe0000, Performance =  66.92 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.023211 s, Result = 13300000, Performance =  59.21 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.021733 s, Result = 53620000, Performance =  67.19 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.022145 s, Result = 93940000, Performance =  69.82 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.023378 s, Result = d3c60000, Performance =  69.81 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.022936 s, Result = 13f80000, Performance =  74.91 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024465 s, Result = 542a0000, Performance =  73.73 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.025047 s, Result = 945c0000, Performance =  75.45 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.026361 s, Result = d48e0000, Performance =  74.95 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.026004 s, Result = 14c00000, Performance =  79.28 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.027393 s, Result = 54f20000, Performance =  78.39 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.028176 s, Result = 95240000, Performance =  79.27 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.028821 s, Result = d5560000, Performance =  80.47 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.029420 s, Result = 15880000, Performance =  81.75 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.030685 s, Result = 55ba0000, Performance =  81.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030875 s, Result = 95ec0000, Performance =  83.47 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.032151 s, Result = d61e0000, Performance =  82.82 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031886 s, Result = 16500000, Performance =  86.21 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.034293 s, Result = 56820000, Performance =  82.66 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034513 s, Result = 96b40000, Performance =  84.62 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035904 s, Result = d6e60000, Performance =  83.74 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.036067 s, Result = 17180000, Performance =  85.74 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.037206 s, Result = 574a0000, Performance =  85.42 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037988 s, Result = 977c0000, Performance =  85.93 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.039591 s, Result = d7ae0000, Performance =  84.62 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.038373 s, Result = 17e00000, Performance =  89.54 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.040144 s, Result = 58120000, Performance =  87.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.040921 s, Result = 98440000, Performance =  88.16 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.042017 s, Result = d8760000, Performance =  87.91 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.042244 s, Result = 18a80000, Performance =  89.47 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.043821 s, Result = 58da0000, Performance =  88.21 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.043902 s, Result = 990c0000, Performance =  90.00 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.044965 s, Result = d93e0000, Performance =  89.79 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.044854 s, Result = 19700000, Performance =  91.92 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.046137 s, Result = 59a20000, Performance =  91.23 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.047187 s, Result = 99d40000, Performance =  91.02 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.047617 s, Result = da060000, Performance =  92.00 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.048330 s, Result = 1a380000, Performance =  92.42 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.049854 s, Result = 5a6a0000, Performance =  91.32 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.050328 s, Result = 9a9c0000, Performance =  92.17 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.051502 s, Result = dace0000, Performance =  91.73 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.051218 s, Result = 1b000000, Performance =  93.92 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.052498 s, Result = 5b320000, Performance =  93.26 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.053606 s, Result = 9b640000, Performance =  92.94 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.054431 s, Result = db960000, Performance =  93.11 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.054488 s, Result = 1bc80000, Performance =  94.59 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.055763 s, Result = 5bfa0000, Performance =  93.97 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.056978 s, Result = 9c2c0000, Performance =  93.47 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.057793 s, Result = dc5e0000, Performance =  93.64 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057628 s, Result = 1c900000, Performance =  95.40 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1817  1324  1024
Test passed: M N K =  1356   784   256
Test passed: M N K =  1810    45   192
Test passed: M N K =  1860  1802   640
Test passed: M N K =   981   260  2048
M N K =  4096  4096   256, Elapsed time =   0.010059 s, Result = 00320000, Performance =   8.54 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008888 s, Result = 00640000, Performance =  19.33 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009442 s, Result = 00960000, Performance =  27.29 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.009092 s, Result = 00c80000, Performance =  37.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009672 s, Result = 00fa0000, Performance =  44.41 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.010515 s, Result = 012c0000, Performance =  49.02 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010894 s, Result = 015e0000, Performance =  55.20 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011227 s, Result = 01900000, Performance =  61.21 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012005 s, Result = 01c20000, Performance =  64.40 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013225 s, Result = 01f40000, Performance =  64.95 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013889 s, Result = 02260000, Performance =  68.03 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014651 s, Result = 02580000, Performance =  70.35 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015641 s, Result = 028a0000, Performance =  71.40 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016577 s, Result = 02bc0000, Performance =  72.55 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017285 s, Result = 02ee0000, Performance =  74.54 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017013 s, Result = 03200000, Performance =  80.78 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018684 s, Result = 03520000, Performance =  78.16 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019761 s, Result = 03840000, Performance =  78.25 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020568 s, Result = 03b60000, Performance =  79.35 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020662 s, Result = 03e80000, Performance =  83.15 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022290 s, Result = 041a0000, Performance =  80.93 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022884 s, Result = 044c0000, Performance =  82.58 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023387 s, Result = 047e0000, Performance =  84.48 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023615 s, Result = 04b00000, Performance =  87.30 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024778 s, Result = 04e20000, Performance =  86.67 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.026027 s, Result = 05140000, Performance =  85.81 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.026453 s, Result = 05460000, Performance =  87.67 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027773 s, Result = 05780000, Performance =  86.60 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028134 s, Result = 05aa0000, Performance =  88.54 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.028921 s, Result = 05dc0000, Performance =  89.11 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029760 s, Result = 060e0000, Performance =  89.48 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.029411 s, Result = 06400000, Performance =  93.46 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.031454 s, Result = 06720000, Performance =  90.12 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.031829 s, Result = 06a40000, Performance =  91.76 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.032756 s, Result = 06d60000, Performance =  91.78 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.033431 s, Result = 07080000, Performance =  92.50 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034022 s, Result = 073a0000, Performance =  93.42 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035387 s, Result = 076c0000, Performance =  92.24 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.035612 s, Result = 079e0000, Performance =  94.07 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036153 s, Result = 07d00000, Performance =  95.04 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037292 s, Result = 08020000, Performance =  94.44 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.037877 s, Result = 08340000, Performance =  95.25 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.038741 s, Result = 08660000, Performance =  95.34 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.039318 s, Result = 08980000, Performance =  96.13 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.040384 s, Result = 08ca0000, Performance =  95.72 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041311 s, Result = 08fc0000, Performance =  95.65 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.041401 s, Result = 092e0000, Performance =  97.52 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.041356 s, Result = 09600000, Performance =  99.70 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.042752 s, Result = 09920000, Performance =  98.45 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.043794 s, Result = 09c40000, Performance =  98.07 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.044616 s, Result = 09f60000, Performance =  98.19 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.045312 s, Result = 0a280000, Performance =  98.58 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.046260 s, Result = 0a5a0000, Performance =  98.41 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.047013 s, Result = 0a8c0000, Performance =  98.66 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.048160 s, Result = 0abe0000, Performance =  98.10 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.047525 s, Result = 0af00000, Performance = 101.22 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.049711 s, Result = 0b220000, Performance =  98.49 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.049803 s, Result = 0b540000, Performance = 100.04 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050849 s, Result = 0b860000, Performance =  99.67 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.050807 s, Result = 0bb80000, Performance = 101.44 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.052361 s, Result = 0bea0000, Performance = 100.07 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.052572 s, Result = 0c1c0000, Performance = 101.30 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.053394 s, Result = 0c4e0000, Performance = 101.35 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.053309 s, Result = 0c800000, Performance = 103.13 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1818  1109   832
Test passed: M N K =  1241    54   768
Test passed: M N K =   835  1692  1792
Test passed: M N K =  2014   833  1920
Test passed: M N K =  1818  1128   320
M N K =  4096  4096   256, Elapsed time =   0.007017 s, Result = a0d20000, Performance =  12.24 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007157 s, Result = a1040000, Performance =  24.00 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007345 s, Result = a1360000, Performance =  35.08 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007725 s, Result = a1680000, Performance =  44.48 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008300 s, Result = a19a0000, Performance =  51.74 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008871 s, Result = a1cc0000, Performance =  58.10 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009365 s, Result = a1fe0000, Performance =  64.21 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010211 s, Result = a2300000, Performance =  67.30 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010978 s, Result = a2620000, Performance =  70.43 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011871 s, Result = a2940000, Performance =  72.36 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012583 s, Result = a2c60000, Performance =  75.09 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013379 s, Result = a2f80000, Performance =  77.04 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014036 s, Result = a32a0000, Performance =  79.56 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015082 s, Result = a35c0000, Performance =  79.74 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017402 s, Result = a38e0000, Performance =  74.04 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016264 s, Result = a3c00000, Performance =  84.50 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017255 s, Result = a3f20000, Performance =  84.63 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018060 s, Result = a4240000, Performance =  85.61 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018762 s, Result = a4560000, Performance =  86.99 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019747 s, Result = a4880000, Performance =  87.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.020010 s, Result = a4ba0000, Performance =  90.15 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020958 s, Result = a4ec0000, Performance =  90.17 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021729 s, Result = a51e0000, Performance =  90.92 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022335 s, Result = a5500000, Performance =  92.30 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023102 s, Result = a5820000, Performance =  92.96 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023985 s, Result = a5b40000, Performance =  93.11 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024620 s, Result = a5e60000, Performance =  94.20 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.025539 s, Result = a6180000, Performance =  94.18 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026255 s, Result = a64a0000, Performance =  94.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026727 s, Result = a67c0000, Performance =  96.42 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.027609 s, Result = a6ae0000, Performance =  96.45 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027620 s, Result = a6e00000, Performance =  99.52 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029203 s, Result = a7120000, Performance =  97.07 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.029522 s, Result = a7440000, Performance =  98.93 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030470 s, Result = a7760000, Performance =  98.67 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030987 s, Result = a7a80000, Performance =  99.79 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.032193 s, Result = a7da0000, Performance =  98.73 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032697 s, Result = a80c0000, Performance =  99.83 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.033953 s, Result = a83e0000, Performance =  98.67 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034002 s, Result = a8700000, Performance = 101.05 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035149 s, Result = a8a20000, Performance = 100.20 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.035938 s, Result = a8d40000, Performance = 100.39 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.037265 s, Result = a9060000, Performance =  99.12 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037234 s, Result = a9380000, Performance = 101.51 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038040 s, Result = a96a0000, Performance = 101.62 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.038979 s, Result = a99c0000, Performance = 101.37 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039507 s, Result = a9ce0000, Performance = 102.19 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040214 s, Result = aa000000, Performance = 102.53 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041246 s, Result = aa320000, Performance = 102.05 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.041458 s, Result = aa640000, Performance = 103.60 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042546 s, Result = aa960000, Performance = 102.97 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.043433 s, Result = aac80000, Performance = 102.84 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.044246 s, Result = aafa0000, Performance = 102.90 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.045248 s, Result = ab2c0000, Performance = 102.51 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046090 s, Result = ab5e0000, Performance = 102.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.045828 s, Result = ab900000, Performance = 104.97 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046996 s, Result = abc20000, Performance = 104.18 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.047992 s, Result = abf40000, Performance = 103.81 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.048707 s, Result = ac260000, Performance = 104.05 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049185 s, Result = ac580000, Performance = 104.79 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.049653 s, Result = ac8a0000, Performance = 105.53 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.050921 s, Result = acbc0000, Performance = 104.59 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.051199 s, Result = acee0000, Performance = 105.70 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.052032 s, Result = ad200000, Performance = 105.66 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   626   964  1472
Test passed: M N K =  1572  1880  1792
Test passed: M N K =  1699  1202    64
Test passed: M N K =  1536   309   512
Test passed: M N K =   986  1981   320
M N K =  4096  4096   256, Elapsed time =   0.000941 s, Result = 00320000, Performance =  91.26 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001849 s, Result = 00640000, Performance =  92.89 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002699 s, Result = 00960000, Performance =  95.48 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003439 s, Result = 00c80000, Performance =  99.92 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004267 s, Result = 00fa0000, Performance = 100.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004837 s, Result = 012c0000, Performance = 106.56 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005490 s, Result = 015e0000, Performance = 109.52 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006440 s, Result = 01900000, Performance = 106.71 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007024 s, Result = 01c20000, Performance = 110.07 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008190 s, Result = 01f40000, Performance = 104.88 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009002 s, Result = 02260000, Performance = 104.97 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010117 s, Result = 02580000, Performance = 101.89 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010692 s, Result = 028a0000, Performance = 104.44 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011590 s, Result = 02bc0000, Performance = 103.76 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012536 s, Result = 02ee0000, Performance = 102.78 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016273 s, Result = 03200000, Performance =  84.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013787 s, Result = 03520000, Performance = 105.92 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014801 s, Result = 03840000, Performance = 104.46 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.015594 s, Result = 03b60000, Performance = 104.66 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.016135 s, Result = 03e80000, Performance = 106.48 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.016711 s, Result = 041a0000, Performance = 107.95 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017746 s, Result = 044c0000, Performance = 106.49 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018170 s, Result = 047e0000, Performance = 108.73 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018935 s, Result = 04b00000, Performance = 108.87 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019550 s, Result = 04e20000, Performance = 109.85 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020292 s, Result = 05140000, Performance = 110.06 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021327 s, Result = 05460000, Performance = 108.75 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022002 s, Result = 05780000, Performance = 109.32 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022782 s, Result = 05aa0000, Performance = 109.34 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.023707 s, Result = 05dc0000, Performance = 108.70 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.024411 s, Result = 060e0000, Performance = 109.09 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.024762 s, Result = 06400000, Performance = 111.01 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025374 s, Result = 06720000, Performance = 111.72 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026371 s, Result = 06a40000, Performance = 110.75 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.027366 s, Result = 06d60000, Performance = 109.86 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.028020 s, Result = 07080000, Performance = 110.36 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.028428 s, Result = 073a0000, Performance = 111.80 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.029910 s, Result = 076c0000, Performance = 109.13 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030166 s, Result = 079e0000, Performance = 111.06 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.030689 s, Result = 07d00000, Performance = 111.96 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.031609 s, Result = 08020000, Performance = 111.42 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032932 s, Result = 08340000, Performance = 109.55 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.033447 s, Result = 08660000, Performance = 110.43 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.033569 s, Result = 08980000, Performance = 112.59 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.034497 s, Result = 08ca0000, Performance = 112.05 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.035496 s, Result = 08fc0000, Performance = 111.32 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.036059 s, Result = 092e0000, Performance = 111.96 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.036312 s, Result = 09600000, Performance = 113.55 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.037233 s, Result = 09920000, Performance = 113.05 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.038339 s, Result = 09c40000, Performance = 112.03 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.039264 s, Result = 09f60000, Performance = 111.57 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.039932 s, Result = 0a280000, Performance = 111.86 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.040301 s, Result = 0a5a0000, Performance = 112.97 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.041284 s, Result = 0a8c0000, Performance = 112.36 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.042553 s, Result = 0abe0000, Performance = 111.03 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.042284 s, Result = 0af00000, Performance = 113.76 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.043499 s, Result = 0b220000, Performance = 112.56 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.044159 s, Result = 0b540000, Performance = 112.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.045100 s, Result = 0b860000, Performance = 112.37 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.045747 s, Result = 0bb80000, Performance = 112.66 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.046466 s, Result = 0bea0000, Performance = 112.77 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.047030 s, Result = 0c1c0000, Performance = 113.24 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.048258 s, Result = 0c4e0000, Performance = 112.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.048789 s, Result = 0c800000, Performance = 112.68 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   975  2043   512
Test passed: M N K =  1186  1032   448
Test passed: M N K =   833  1541   128
Test passed: M N K =    20  1091  1280
Test passed: M N K =   341  1677   640
M N K =  4096  4096   256, Elapsed time =   0.011044 s, Result = d04c0000, Performance =   7.78 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011786 s, Result = 90880000, Performance =  14.58 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012554 s, Result = 50c40000, Performance =  20.53 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013024 s, Result = 11000000, Performance =  26.38 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013711 s, Result = d13c0000, Performance =  31.33 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014126 s, Result = 91780000, Performance =  36.49 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015148 s, Result = 51b40000, Performance =  39.70 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015804 s, Result = 11f00000, Performance =  43.48 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016432 s, Result = d22c0000, Performance =  47.05 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017313 s, Result = 92680000, Performance =  49.62 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017894 s, Result = 52a40000, Performance =  52.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.018726 s, Result = 12e00000, Performance =  55.04 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.019321 s, Result = d31c0000, Performance =  57.80 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020068 s, Result = 93580000, Performance =  59.93 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021474 s, Result = 53940000, Performance =  60.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022473 s, Result = 13d00000, Performance =  61.16 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022793 s, Result = d40c0000, Performance =  64.07 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.023177 s, Result = 94480000, Performance =  66.71 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.024141 s, Result = 54840000, Performance =  67.61 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024377 s, Result = 14c00000, Performance =  70.48 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024998 s, Result = d4fc0000, Performance =  72.16 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.026019 s, Result = 95380000, Performance =  72.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.028726 s, Result = 55740000, Performance =  68.78 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.027112 s, Result = 15b00000, Performance =  76.04 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.028158 s, Result = d5ec0000, Performance =  76.26 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.028593 s, Result = 96280000, Performance =  78.11 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.029123 s, Result = 56640000, Performance =  79.64 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.030312 s, Result = 16a00000, Performance =  79.35 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.030663 s, Result = d6dc0000, Performance =  81.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.031124 s, Result = 97180000, Performance =  82.80 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.032065 s, Result = 57540000, Performance =  83.05 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.033483 s, Result = 17900000, Performance =  82.10 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.033573 s, Result = d7cc0000, Performance =  84.43 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034313 s, Result = 98080000, Performance =  85.12 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035317 s, Result = 58440000, Performance =  85.13 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.035780 s, Result = 18800000, Performance =  86.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036482 s, Result = d8bc0000, Performance =  87.12 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037133 s, Result = 98f80000, Performance =  87.90 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.038303 s, Result = 59340000, Performance =  87.46 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039014 s, Result = 19700000, Performance =  88.07 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.039866 s, Result = d9ac0000, Performance =  88.34 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.040461 s, Result = 99e80000, Performance =  89.17 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.041976 s, Result = 5a240000, Performance =  88.00 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.042340 s, Result = 1a600000, Performance =  89.27 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.043267 s, Result = da9c0000, Performance =  89.34 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.044209 s, Result = 9ad80000, Performance =  89.38 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.045464 s, Result = 5b140000, Performance =  88.80 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.046724 s, Result = 1b500000, Performance =  88.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.046587 s, Result = db8c0000, Performance =  90.35 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.047421 s, Result = 9bc80000, Performance =  90.57 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.049142 s, Result = 5c040000, Performance =  89.15 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050109 s, Result = 1c400000, Performance =  89.14 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.051432 s, Result = dc7c0000, Performance =  88.52 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052766 s, Result = 9cb80000, Performance =  87.91 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.053530 s, Result = 5cf40000, Performance =  88.26 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.054626 s, Result = 1d300000, Performance =  88.06 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.055455 s, Result = dd6c0000, Performance =  88.29 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.056341 s, Result = 9da80000, Performance =  88.43 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.057943 s, Result = 5de40000, Performance =  87.47 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.059062 s, Result = 1e200000, Performance =  87.26 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.060496 s, Result = de5c0000, Performance =  86.62 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.061575 s, Result = 9e980000, Performance =  86.49 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.063022 s, Result = 5ed40000, Performance =  85.87 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.066550 s, Result = 1f100000, Performance =  82.61 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    11   358  2048
Test passed: M N K =   419   358  1920
Test passed: M N K =   198  1033   128
Test passed: M N K =  1621  1265  1728
Test passed: M N K =  1746  1027   832
M N K =  4096  4096   256, Elapsed time =   0.013177 s, Result = 003c0000, Performance =   6.52 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012668 s, Result = 00780000, Performance =  13.56 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013649 s, Result = 00b40000, Performance =  18.88 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.014014 s, Result = 00f00000, Performance =  24.52 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014314 s, Result = 012c0000, Performance =  30.00 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014807 s, Result = 01680000, Performance =  34.81 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023083 s, Result = 01a40000, Performance =  26.05 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015311 s, Result = 01e00000, Performance =  44.88 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015384 s, Result = 021c0000, Performance =  50.25 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015833 s, Result = 02580000, Performance =  54.25 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016318 s, Result = 02940000, Performance =  57.91 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017052 s, Result = 02d00000, Performance =  60.45 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018053 s, Result = 030c0000, Performance =  61.86 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017828 s, Result = 03480000, Performance =  67.45 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019006 s, Result = 03840000, Performance =  67.79 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020354 s, Result = 03c00000, Performance =  67.52 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020454 s, Result = 03fc0000, Performance =  71.39 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020954 s, Result = 04380000, Performance =  73.79 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.021236 s, Result = 04740000, Performance =  76.85 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.022296 s, Result = 04b00000, Performance =  77.06 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022755 s, Result = 04ec0000, Performance =  79.27 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023297 s, Result = 05280000, Performance =  81.12 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023967 s, Result = 05640000, Performance =  82.43 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.025159 s, Result = 05a00000, Performance =  81.94 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.025376 s, Result = 05dc0000, Performance =  84.63 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.025885 s, Result = 06180000, Performance =  86.28 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.026883 s, Result = 06540000, Performance =  86.27 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027239 s, Result = 06900000, Performance =  88.30 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028128 s, Result = 06cc0000, Performance =  88.56 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.028620 s, Result = 07080000, Performance =  90.04 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029266 s, Result = 07440000, Performance =  90.99 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.030934 s, Result = 07800000, Performance =  88.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.030289 s, Result = 07bc0000, Performance =  93.59 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.031218 s, Result = 07f80000, Performance =  93.55 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.032247 s, Result = 08340000, Performance =  93.23 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.033012 s, Result = 08700000, Performance =  93.67 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.033764 s, Result = 08ac0000, Performance =  94.13 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.034163 s, Result = 08e80000, Performance =  95.55 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.034962 s, Result = 09240000, Performance =  95.82 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036320 s, Result = 09600000, Performance =  94.60 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035969 s, Result = 099c0000, Performance =  97.91 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036760 s, Result = 09d80000, Performance =  98.14 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.038084 s, Result = 0a140000, Performance =  96.99 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.038530 s, Result = 0a500000, Performance =  98.10 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.039370 s, Result = 0a8c0000, Performance =  98.18 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.039875 s, Result = 0ac80000, Performance =  99.10 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.040890 s, Result = 0b040000, Performance =  98.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.042470 s, Result = 0b400000, Performance =  97.08 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041539 s, Result = 0b7c0000, Performance = 101.33 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.042858 s, Result = 0bb80000, Performance = 100.21 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.043493 s, Result = 0bf40000, Performance = 100.73 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.044697 s, Result = 0c300000, Performance =  99.94 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.046129 s, Result = 0c6c0000, Performance =  98.69 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.046970 s, Result = 0ca80000, Performance =  98.76 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.047391 s, Result = 0ce40000, Performance =  99.69 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.047328 s, Result = 0d200000, Performance = 101.64 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.048832 s, Result = 0d5c0000, Performance = 100.27 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.049970 s, Result = 0d980000, Performance =  99.70 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050986 s, Result = 0dd40000, Performance =  99.40 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.051461 s, Result = 0e100000, Performance = 100.15 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.052590 s, Result = 0e4c0000, Performance =  99.64 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.053863 s, Result = 0e880000, Performance =  98.88 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055368 s, Result = 0ec40000, Performance =  97.74 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057053 s, Result = 0f000000, Performance =  96.36 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1558   356   320
Test passed: M N K =  1455   865   320
Test passed: M N K =  1088   356  1984
Test passed: M N K =   851  1417  1344
Test passed: M N K =   790   750  1600
M N K =  4096  4096   256, Elapsed time =   0.006235 s, Result = a0dc0000, Performance =  13.78 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006919 s, Result = a1180000, Performance =  24.83 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007577 s, Result = a1540000, Performance =  34.01 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007906 s, Result = a1900000, Performance =  43.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008558 s, Result = a1cc0000, Performance =  50.19 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009313 s, Result = a2080000, Performance =  55.34 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010027 s, Result = a2440000, Performance =  59.96 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010297 s, Result = a2800000, Performance =  66.73 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011287 s, Result = a2bc0000, Performance =  68.50 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012064 s, Result = a2f80000, Performance =  71.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012379 s, Result = a3340000, Performance =  76.33 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013418 s, Result = a3700000, Performance =  76.82 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014082 s, Result = a3ac0000, Performance =  79.30 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014743 s, Result = a3e80000, Performance =  81.57 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015469 s, Result = a4240000, Performance =  83.30 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017005 s, Result = a4600000, Performance =  80.82 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016887 s, Result = a49c0000, Performance =  86.47 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017396 s, Result = a4d80000, Performance =  88.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018137 s, Result = a5140000, Performance =  89.99 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018814 s, Result = a5500000, Performance =  91.31 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019522 s, Result = a58c0000, Performance =  92.40 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020246 s, Result = a5c80000, Performance =  93.34 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021165 s, Result = a6040000, Performance =  93.35 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021772 s, Result = a6400000, Performance =  94.69 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022255 s, Result = a67c0000, Performance =  96.50 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022532 s, Result = a6b80000, Performance =  99.12 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023664 s, Result = a6f40000, Performance =  98.01 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024564 s, Result = a7300000, Performance =  97.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024864 s, Result = a76c0000, Performance = 100.19 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025570 s, Result = a7a80000, Performance = 100.78 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026457 s, Result = a7e40000, Performance = 100.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.028107 s, Result = a8200000, Performance =  97.80 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.028096 s, Result = a85c0000, Performance = 100.89 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028567 s, Result = a8980000, Performance = 102.24 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028967 s, Result = a8d40000, Performance = 103.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030227 s, Result = a9100000, Performance = 102.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.030405 s, Result = a94c0000, Performance = 104.53 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031421 s, Result = a9880000, Performance = 103.88 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032405 s, Result = a9c40000, Performance = 103.38 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.033158 s, Result = aa000000, Performance = 103.62 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.033525 s, Result = aa3c0000, Performance = 105.05 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.034434 s, Result = aa780000, Performance = 104.77 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.035593 s, Result = aab40000, Performance = 103.78 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.036196 s, Result = aaf00000, Performance = 104.42 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.037436 s, Result = ab2c0000, Performance = 103.26 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.037813 s, Result = ab680000, Performance = 104.50 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039078 s, Result = aba40000, Performance = 103.31 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040269 s, Result = abe00000, Performance = 102.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.040597 s, Result = ac1c0000, Performance = 103.68 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.041231 s, Result = ac580000, Performance = 104.17 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042640 s, Result = ac940000, Performance = 102.74 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.043706 s, Result = acd00000, Performance = 102.20 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043915 s, Result = ad0c0000, Performance = 103.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044932 s, Result = ad480000, Performance = 103.23 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046455 s, Result = ad840000, Performance = 101.70 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.047456 s, Result = adc00000, Performance = 101.37 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.048496 s, Result = adfc0000, Performance = 100.96 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.049542 s, Result = ae380000, Performance = 100.56 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050617 s, Result = ae740000, Performance = 100.13 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.051916 s, Result = aeb00000, Performance =  99.28 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.052746 s, Result = aeec0000, Performance =  99.34 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.053680 s, Result = af280000, Performance =  99.21 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055305 s, Result = af640000, Performance =  97.85 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.058460 s, Result = afa00000, Performance =  94.04 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1954   333   704
Test passed: M N K =  2014  1936  1600
Test passed: M N K =  2015   754  1216
Test passed: M N K =   805   185    64
Test passed: M N K =   980    89  1344
M N K =  4096  4096   256, Elapsed time =   0.000953 s, Result = 003c0000, Performance =  90.12 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001680 s, Result = 00780000, Performance = 102.26 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002444 s, Result = 00b40000, Performance = 105.42 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003151 s, Result = 00f00000, Performance = 109.04 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003725 s, Result = 012c0000, Performance = 115.29 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004328 s, Result = 01680000, Performance = 119.08 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004797 s, Result = 01a40000, Performance = 125.36 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005558 s, Result = 01e00000, Performance = 123.64 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006420 s, Result = 021c0000, Performance = 120.42 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006835 s, Result = 02580000, Performance = 125.68 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.007325 s, Result = 02940000, Performance = 129.00 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008461 s, Result = 02d00000, Performance = 121.83 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009072 s, Result = 030c0000, Performance = 123.09 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.009634 s, Result = 03480000, Performance = 124.83 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010952 s, Result = 03840000, Performance = 117.65 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013029 s, Result = 03c00000, Performance = 105.49 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.014322 s, Result = 03fc0000, Performance = 101.96 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.012884 s, Result = 04380000, Performance = 120.01 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013463 s, Result = 04740000, Performance = 121.23 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014037 s, Result = 04b00000, Performance = 122.39 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014721 s, Result = 04ec0000, Performance = 122.54 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015178 s, Result = 05280000, Performance = 124.51 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015852 s, Result = 05640000, Performance = 124.64 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017255 s, Result = 05a00000, Performance = 119.48 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017269 s, Result = 05dc0000, Performance = 124.36 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017795 s, Result = 06180000, Performance = 125.50 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018334 s, Result = 06540000, Performance = 126.50 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019083 s, Result = 06900000, Performance = 126.04 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020161 s, Result = 06cc0000, Performance = 123.56 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020888 s, Result = 07080000, Performance = 123.37 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.021105 s, Result = 07440000, Performance = 126.17 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025199 s, Result = 07800000, Performance = 109.08 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.022497 s, Result = 07bc0000, Performance = 126.00 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.023241 s, Result = 07f80000, Performance = 125.66 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.023831 s, Result = 08340000, Performance = 126.16 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.024610 s, Result = 08700000, Performance = 125.66 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.025291 s, Result = 08ac0000, Performance = 125.67 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.025659 s, Result = 08e80000, Performance = 127.21 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.026503 s, Result = 09240000, Performance = 126.40 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.027521 s, Result = 09600000, Performance = 124.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028036 s, Result = 099c0000, Performance = 125.62 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.028579 s, Result = 09d80000, Performance = 126.24 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029212 s, Result = 0a140000, Performance = 126.44 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.029805 s, Result = 0a500000, Performance = 126.81 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030107 s, Result = 0a8c0000, Performance = 128.39 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.031179 s, Result = 0ac80000, Performance = 126.73 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.031361 s, Result = 0b040000, Performance = 128.74 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033460 s, Result = 0b400000, Performance = 123.23 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.033184 s, Result = 0b7c0000, Performance = 126.84 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.033564 s, Result = 0bb80000, Performance = 127.96 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.034506 s, Result = 0bf40000, Performance = 126.96 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.035065 s, Result = 0c300000, Performance = 127.39 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.035720 s, Result = 0c6c0000, Performance = 127.45 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.036597 s, Result = 0ca80000, Performance = 126.75 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.037374 s, Result = 0ce40000, Performance = 126.41 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.039023 s, Result = 0d200000, Performance = 123.27 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.040040 s, Result = 0d5c0000, Performance = 122.28 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.040616 s, Result = 0d980000, Performance = 122.67 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.042083 s, Result = 0dd40000, Performance = 120.43 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042236 s, Result = 0e100000, Performance = 122.03 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.043730 s, Result = 0e4c0000, Performance = 119.82 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044107 s, Result = 0e880000, Performance = 120.75 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.045680 s, Result = 0ec40000, Performance = 118.47 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.048076 s, Result = 0f000000, Performance = 114.35 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1223  1854   512
Test passed: M N K =   495   264   192
Test passed: M N K =   855  1327   512
Test passed: M N K =  1774   512  1216
Test passed: M N K =   342  1140    64
M N K =  4096  4096   256, Elapsed time =   0.011134 s, Result = d04c0000, Performance =   7.71 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011526 s, Result = 90880000, Performance =  14.91 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012451 s, Result = 50c40000, Performance =  20.70 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013630 s, Result = 11000000, Performance =  25.21 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014012 s, Result = d13c0000, Performance =  30.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014427 s, Result = 91780000, Performance =  35.73 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014985 s, Result = 51b40000, Performance =  40.13 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016048 s, Result = 11f00000, Performance =  42.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016592 s, Result = d22c0000, Performance =  46.59 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017945 s, Result = 92680000, Performance =  47.87 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018022 s, Result = 52a40000, Performance =  52.43 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019332 s, Result = 12e00000, Performance =  53.32 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020230 s, Result = d31c0000, Performance =  55.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020848 s, Result = 93580000, Performance =  57.68 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.023080 s, Result = 53940000, Performance =  55.83 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.024165 s, Result = 13d00000, Performance =  56.88 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022627 s, Result = d40c0000, Performance =  64.54 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.023790 s, Result = 94480000, Performance =  64.99 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.023976 s, Result = 54840000, Performance =  68.07 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024833 s, Result = 14c00000, Performance =  69.18 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.025524 s, Result = d4fc0000, Performance =  70.67 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.026341 s, Result = 95380000, Performance =  71.74 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.028997 s, Result = 55740000, Performance =  68.13 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.028241 s, Result = 15b00000, Performance =  73.00 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.028004 s, Result = d5ec0000, Performance =  76.68 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.029054 s, Result = 96280000, Performance =  76.87 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.029571 s, Result = 56640000, Performance =  78.43 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.030171 s, Result = 16a00000, Performance =  79.72 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.030761 s, Result = d6dc0000, Performance =  80.98 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.031417 s, Result = 97180000, Performance =  82.03 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.031912 s, Result = 57540000, Performance =  83.45 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.037818 s, Result = 17900000, Performance =  72.69 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.033194 s, Result = d7cc0000, Performance =  85.40 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034518 s, Result = 98080000, Performance =  84.61 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.034939 s, Result = 58440000, Performance =  86.05 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.035587 s, Result = 18800000, Performance =  86.90 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036092 s, Result = d8bc0000, Performance =  88.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037045 s, Result = 98f80000, Performance =  88.11 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.037491 s, Result = 59340000, Performance =  89.36 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039885 s, Result = 19700000, Performance =  86.15 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.038911 s, Result = d9ac0000, Performance =  90.51 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.040123 s, Result = 99e80000, Performance =  89.92 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.040929 s, Result = 5a240000, Performance =  90.25 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.041483 s, Result = 1a600000, Performance =  91.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.042140 s, Result = da9c0000, Performance =  91.73 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.043012 s, Result = 9ad80000, Performance =  91.87 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.043723 s, Result = 5b140000, Performance =  92.34 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.050544 s, Result = 1b500000, Performance =  81.58 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.045553 s, Result = db8c0000, Performance =  92.40 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.046309 s, Result = 9bc80000, Performance =  92.75 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.046847 s, Result = 5c040000, Performance =  93.51 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.048199 s, Result = 1c400000, Performance =  92.67 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.048895 s, Result = dc7c0000, Performance =  93.11 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.049651 s, Result = 9cb80000, Performance =  93.42 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.050943 s, Result = 5cf40000, Performance =  92.74 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.053059 s, Result = 1d300000, Performance =  90.66 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.052957 s, Result = dd6c0000, Performance =  92.46 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.053977 s, Result = 9da80000, Performance =  92.30 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.055209 s, Result = 5de40000, Performance =  91.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.055718 s, Result = 1e200000, Performance =  92.50 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.056913 s, Result = de5c0000, Performance =  92.07 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.057860 s, Result = 9e980000, Performance =  92.05 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.059574 s, Result = 5ed40000, Performance =  90.84 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.067275 s, Result = 1f100000, Performance =  81.72 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    73  1712  1408
Test passed: M N K =  1589   605   512
Test passed: M N K =   991  1564   320
Test passed: M N K =  1044  1425  1088
Test passed: M N K =  1706   927   384
M N K =  4096  4096   256, Elapsed time =   0.013564 s, Result = 003c0000, Performance =   6.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012786 s, Result = 00780000, Performance =  13.44 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013849 s, Result = 00b40000, Performance =  18.61 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013612 s, Result = 00f00000, Performance =  25.24 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014388 s, Result = 012c0000, Performance =  29.85 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014676 s, Result = 01680000, Performance =  35.12 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.021883 s, Result = 01a40000, Performance =  27.48 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015681 s, Result = 01e00000, Performance =  43.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015652 s, Result = 021c0000, Performance =  49.39 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016440 s, Result = 02580000, Performance =  52.25 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016942 s, Result = 02940000, Performance =  55.77 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017376 s, Result = 02d00000, Performance =  59.32 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018415 s, Result = 030c0000, Performance =  60.64 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018653 s, Result = 03480000, Performance =  64.47 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019494 s, Result = 03840000, Performance =  66.10 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.021360 s, Result = 03c00000, Performance =  64.34 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020759 s, Result = 03fc0000, Performance =  70.34 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021476 s, Result = 04380000, Performance =  71.99 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.021676 s, Result = 04740000, Performance =  75.30 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.022234 s, Result = 04b00000, Performance =  77.27 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.023672 s, Result = 04ec0000, Performance =  76.20 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023796 s, Result = 05280000, Performance =  79.42 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.024531 s, Result = 05640000, Performance =  80.54 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.025760 s, Result = 05a00000, Performance =  80.03 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026116 s, Result = 05dc0000, Performance =  82.23 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.026597 s, Result = 06180000, Performance =  83.97 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027765 s, Result = 06540000, Performance =  83.53 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027669 s, Result = 06900000, Performance =  86.93 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028667 s, Result = 06cc0000, Performance =  86.90 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.029231 s, Result = 07080000, Performance =  88.16 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029567 s, Result = 07440000, Performance =  90.06 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.034384 s, Result = 07800000, Performance =  79.94 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.030965 s, Result = 07bc0000, Performance =  91.54 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.031901 s, Result = 07f80000, Performance =  91.55 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.032525 s, Result = 08340000, Performance =  92.44 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.033554 s, Result = 08700000, Performance =  92.16 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.033907 s, Result = 08ac0000, Performance =  93.74 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.034368 s, Result = 08e80000, Performance =  94.98 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.035485 s, Result = 09240000, Performance =  94.41 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.037089 s, Result = 09600000, Performance =  92.64 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.036586 s, Result = 099c0000, Performance =  96.26 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036823 s, Result = 09d80000, Performance =  97.98 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.037889 s, Result = 0a140000, Performance =  97.49 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.038688 s, Result = 0a500000, Performance =  97.69 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.039098 s, Result = 0a8c0000, Performance =  98.87 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.039970 s, Result = 0ac80000, Performance =  98.86 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.040315 s, Result = 0b040000, Performance = 100.14 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047412 s, Result = 0b400000, Performance =  86.96 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.042413 s, Result = 0b7c0000, Performance =  99.24 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.043074 s, Result = 0bb80000, Performance =  99.71 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.043515 s, Result = 0bf40000, Performance = 100.68 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.044315 s, Result = 0c300000, Performance = 100.80 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.045410 s, Result = 0c6c0000, Performance = 100.26 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.046485 s, Result = 0ca80000, Performance =  99.79 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046709 s, Result = 0ce40000, Performance = 101.15 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.049043 s, Result = 0d200000, Performance =  98.09 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.047750 s, Result = 0d5c0000, Performance = 102.54 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048990 s, Result = 0d980000, Performance = 101.70 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050451 s, Result = 0dd40000, Performance = 100.45 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.050357 s, Result = 0e100000, Performance = 102.35 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.051464 s, Result = 0e4c0000, Performance = 101.82 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.052445 s, Result = 0e880000, Performance = 101.55 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.053378 s, Result = 0ec40000, Performance = 101.38 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.061502 s, Result = 0f000000, Performance =  89.39 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   738   385  1856
Test passed: M N K =  1692  1576  1408
Test passed: M N K =  1107   572   384
Test passed: M N K =  1561   921  1600
Test passed: M N K =  1065  1611   832
M N K =  4096  4096   256, Elapsed time =   0.006017 s, Result = a0dc0000, Performance =  14.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006682 s, Result = a1180000, Performance =  25.71 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007354 s, Result = a1540000, Performance =  35.04 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008044 s, Result = a1900000, Performance =  42.71 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008290 s, Result = a1cc0000, Performance =  51.81 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011983 s, Result = a2080000, Performance =  43.01 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009782 s, Result = a2440000, Performance =  61.47 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010372 s, Result = a2800000, Performance =  66.26 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011153 s, Result = a2bc0000, Performance =  69.32 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011508 s, Result = a2f80000, Performance =  74.64 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012631 s, Result = a3340000, Performance =  74.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013759 s, Result = a3700000, Performance =  74.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014385 s, Result = a3ac0000, Performance =  77.63 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014763 s, Result = a3e80000, Performance =  81.46 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015794 s, Result = a4240000, Performance =  81.58 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017911 s, Result = a4600000, Performance =  76.73 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017162 s, Result = a49c0000, Performance =  85.09 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017805 s, Result = a4d80000, Performance =  86.84 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018500 s, Result = a5140000, Performance =  88.22 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018905 s, Result = a5500000, Performance =  90.87 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019587 s, Result = a58c0000, Performance =  92.10 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020613 s, Result = a5c80000, Performance =  91.68 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021104 s, Result = a6040000, Performance =  93.62 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022295 s, Result = a6400000, Performance =  92.47 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022380 s, Result = a67c0000, Performance =  95.96 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023154 s, Result = a6b80000, Performance =  96.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024214 s, Result = a6f40000, Performance =  95.78 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024398 s, Result = a7300000, Performance =  98.58 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024979 s, Result = a76c0000, Performance =  99.73 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025879 s, Result = a7a80000, Performance =  99.58 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026155 s, Result = a7e40000, Performance = 101.81 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031571 s, Result = a8200000, Performance =  87.07 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027789 s, Result = a85c0000, Performance = 102.01 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028597 s, Result = a8980000, Performance = 102.13 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.029067 s, Result = a8d40000, Performance = 103.43 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030437 s, Result = a9100000, Performance = 101.60 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.030769 s, Result = a94c0000, Performance = 103.29 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031457 s, Result = a9880000, Performance = 103.77 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032402 s, Result = a9c40000, Performance = 103.39 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034237 s, Result = aa000000, Performance = 100.36 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.033246 s, Result = aa3c0000, Performance = 105.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.034196 s, Result = aa780000, Performance = 105.50 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.034755 s, Result = aab40000, Performance = 106.28 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.035547 s, Result = aaf00000, Performance = 106.33 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.036350 s, Result = ab2c0000, Performance = 106.34 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.036959 s, Result = ab680000, Performance = 106.91 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.038136 s, Result = aba40000, Performance = 105.87 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.044462 s, Result = abe00000, Performance =  92.74 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.039135 s, Result = ac1c0000, Performance = 107.55 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.040334 s, Result = ac580000, Performance = 106.48 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.040930 s, Result = ac940000, Performance = 107.03 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.042244 s, Result = acd00000, Performance = 105.74 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.042766 s, Result = ad0c0000, Performance = 106.46 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.043824 s, Result = ad480000, Performance = 105.85 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.044313 s, Result = ad840000, Performance = 106.61 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046533 s, Result = adc00000, Performance = 103.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.045737 s, Result = adfc0000, Performance = 107.05 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.047149 s, Result = ae380000, Performance = 105.67 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.048075 s, Result = ae740000, Performance = 105.42 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.048933 s, Result = aeb00000, Performance = 105.33 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.049870 s, Result = aeec0000, Performance = 105.07 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.050609 s, Result = af280000, Performance = 105.23 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.051459 s, Result = af640000, Performance = 105.16 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.060245 s, Result = afa00000, Performance =  91.25 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1522  1392  1216
Test passed: M N K =   869   697   960
Test passed: M N K =   790  1351   640
Test passed: M N K =   103   543  1472
Test passed: M N K =  1901   903  1216
M N K =  4096  4096   256, Elapsed time =   0.000892 s, Result = 003c0000, Performance =  96.32 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001768 s, Result = 00780000, Performance =  97.18 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002618 s, Result = 00b40000, Performance =  98.43 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003639 s, Result = 00f00000, Performance =  94.43 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004089 s, Result = 012c0000, Performance = 105.04 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004553 s, Result = 01680000, Performance = 113.20 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005522 s, Result = 01a40000, Performance = 108.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006409 s, Result = 01e00000, Performance = 107.22 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007218 s, Result = 021c0000, Performance = 107.11 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007797 s, Result = 02580000, Performance = 110.17 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008853 s, Result = 02940000, Performance = 106.73 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009395 s, Result = 02d00000, Performance = 109.72 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010234 s, Result = 030c0000, Performance = 109.11 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010862 s, Result = 03480000, Performance = 110.72 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011761 s, Result = 03840000, Performance = 109.56 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.015198 s, Result = 03c00000, Performance =  90.43 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013119 s, Result = 03fc0000, Performance = 111.31 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013972 s, Result = 04380000, Performance = 110.66 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014374 s, Result = 04740000, Performance = 113.54 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015097 s, Result = 04b00000, Performance = 113.79 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015651 s, Result = 04ec0000, Performance = 115.25 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.016500 s, Result = 05280000, Performance = 114.53 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.017086 s, Result = 05640000, Performance = 115.63 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018239 s, Result = 05a00000, Performance = 113.03 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.025899 s, Result = 05dc0000, Performance =  82.92 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019008 s, Result = 06180000, Performance = 117.50 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.019940 s, Result = 06540000, Performance = 116.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020400 s, Result = 06900000, Performance = 117.90 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020801 s, Result = 06cc0000, Performance = 119.76 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.021591 s, Result = 07080000, Performance = 119.35 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022329 s, Result = 07440000, Performance = 119.26 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026978 s, Result = 07800000, Performance = 101.89 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.023884 s, Result = 07bc0000, Performance = 118.68 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024114 s, Result = 07f80000, Performance = 121.12 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.024714 s, Result = 08340000, Performance = 121.65 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.025648 s, Result = 08700000, Performance = 120.57 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.025968 s, Result = 08ac0000, Performance = 122.39 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.026827 s, Result = 08e80000, Performance = 121.68 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027449 s, Result = 09240000, Performance = 122.05 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029693 s, Result = 09600000, Performance = 115.72 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028612 s, Result = 099c0000, Performance = 123.09 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.030235 s, Result = 09d80000, Performance = 119.32 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029826 s, Result = 0a140000, Performance = 123.84 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031108 s, Result = 0a500000, Performance = 121.50 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030962 s, Result = 0a8c0000, Performance = 124.85 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.032243 s, Result = 0ac80000, Performance = 122.55 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032585 s, Result = 0b040000, Performance = 123.90 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.038960 s, Result = 0b400000, Performance = 105.83 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.033794 s, Result = 0b7c0000, Performance = 124.55 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034370 s, Result = 0bb80000, Performance = 124.96 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.034914 s, Result = 0bf40000, Performance = 125.47 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.037305 s, Result = 0c300000, Performance = 119.73 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.036924 s, Result = 0c6c0000, Performance = 123.30 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037300 s, Result = 0ca80000, Performance = 124.36 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.038371 s, Result = 0ce40000, Performance = 123.13 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.040534 s, Result = 0d200000, Performance = 118.67 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039556 s, Result = 0d5c0000, Performance = 123.78 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.040615 s, Result = 0d980000, Performance = 122.67 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.040920 s, Result = 0dd40000, Performance = 123.85 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042351 s, Result = 0e100000, Performance = 121.70 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042882 s, Result = 0e4c0000, Performance = 122.19 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.043815 s, Result = 0e880000, Performance = 121.55 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.044396 s, Result = 0ec40000, Performance = 121.90 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.053407 s, Result = 0f000000, Performance = 102.94 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   995  2041  1280
Test passed: M N K =   807   849  1600
Test passed: M N K =  1017   563   896
Test passed: M N K =    23  1282  1472
Test passed: M N K =   842   349  1472
M N K =  4096  4096   256, Elapsed time =   0.011236 s, Result = d04c0000, Performance =   7.64 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011712 s, Result = 90880000, Performance =  14.67 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012513 s, Result = 50c40000, Performance =  20.60 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013212 s, Result = 11000000, Performance =  26.01 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013816 s, Result = d13c0000, Performance =  31.09 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014469 s, Result = 91780000, Performance =  35.62 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015022 s, Result = 51b40000, Performance =  40.03 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016020 s, Result = 11f00000, Performance =  42.89 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016832 s, Result = d22c0000, Performance =  45.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017575 s, Result = 92680000, Performance =  48.88 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018759 s, Result = 52a40000, Performance =  50.37 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019669 s, Result = 12e00000, Performance =  52.41 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020450 s, Result = d31c0000, Performance =  54.61 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021487 s, Result = 93580000, Performance =  55.97 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.025866 s, Result = 53940000, Performance =  49.81 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.024380 s, Result = 13d00000, Performance =  56.37 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.024720 s, Result = d40c0000, Performance =  59.07 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.025544 s, Result = 94480000, Performance =  60.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.026328 s, Result = 54840000, Performance =  61.99 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026958 s, Result = 14c00000, Performance =  63.73 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.028289 s, Result = d4fc0000, Performance =  63.77 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.028754 s, Result = 95380000, Performance =  65.72 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.029364 s, Result = 55740000, Performance =  67.28 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.029612 s, Result = 15b00000, Performance =  69.62 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.031021 s, Result = d5ec0000, Performance =  69.23 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.031309 s, Result = 96280000, Performance =  71.33 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.032396 s, Result = 56640000, Performance =  71.59 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.033405 s, Result = 16a00000, Performance =  72.00 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.034041 s, Result = d6dc0000, Performance =  73.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.034670 s, Result = 97180000, Performance =  74.33 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.035713 s, Result = 57540000, Performance =  74.56 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.037215 s, Result = 17900000, Performance =  73.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.037466 s, Result = d7cc0000, Performance =  75.66 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.037993 s, Result = 98080000, Performance =  76.87 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.039069 s, Result = 58440000, Performance =  76.95 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.039487 s, Result = 18800000, Performance =  78.31 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.040309 s, Result = d8bc0000, Performance =  78.85 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.041126 s, Result = 98f80000, Performance =  79.37 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.042273 s, Result = 59340000, Performance =  79.25 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.041980 s, Result = 19700000, Performance =  81.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.043927 s, Result = d9ac0000, Performance =  80.18 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.044512 s, Result = 99e80000, Performance =  81.05 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.045811 s, Result = 5a240000, Performance =  80.63 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.046676 s, Result = 1a600000, Performance =  80.97 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.047119 s, Result = da9c0000, Performance =  82.04 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.048140 s, Result = 9ad80000, Performance =  82.08 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.048708 s, Result = 5b140000, Performance =  82.89 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.051339 s, Result = 1b500000, Performance =  80.31 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.050688 s, Result = db8c0000, Performance =  83.04 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.051228 s, Result = 9bc80000, Performance =  83.84 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.052186 s, Result = 5c040000, Performance =  83.95 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.053090 s, Result = 1c400000, Performance =  84.14 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.054260 s, Result = dc7c0000, Performance =  83.90 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.055250 s, Result = 9cb80000, Performance =  83.96 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.055761 s, Result = 5cf40000, Performance =  84.73 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.055980 s, Result = 1d300000, Performance =  85.93 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.057547 s, Result = dd6c0000, Performance =  85.08 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.058669 s, Result = 9da80000, Performance =  84.92 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.059556 s, Result = 5de40000, Performance =  85.10 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.060954 s, Result = 1e200000, Performance =  84.55 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.061884 s, Result = de5c0000, Performance =  84.67 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.062393 s, Result = 9e980000, Performance =  85.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.063160 s, Result = 5ed40000, Performance =  85.68 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.067340 s, Result = 1f100000, Performance =  81.64 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   459   483  1728
Test passed: M N K =  1755   490    64
Test passed: M N K =   773  1098  1856
Test passed: M N K =  1573   134  1472
Test passed: M N K =  1625  1470  1664
M N K =  4096  4096   256, Elapsed time =   0.012919 s, Result = 003c0000, Performance =   6.65 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012690 s, Result = 00780000, Performance =  13.54 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013511 s, Result = 00b40000, Performance =  19.07 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013624 s, Result = 00f00000, Performance =  25.22 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014344 s, Result = 012c0000, Performance =  29.94 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015569 s, Result = 01680000, Performance =  33.10 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014704 s, Result = 01a40000, Performance =  40.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.015216 s, Result = 01e00000, Performance =  45.16 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015836 s, Result = 021c0000, Performance =  48.82 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016379 s, Result = 02580000, Performance =  52.45 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017002 s, Result = 02940000, Performance =  55.58 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017609 s, Result = 02d00000, Performance =  58.54 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018695 s, Result = 030c0000, Performance =  59.73 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019589 s, Result = 03480000, Performance =  61.39 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.020110 s, Result = 03840000, Performance =  64.07 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.027506 s, Result = 03c00000, Performance =  49.97 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022063 s, Result = 03fc0000, Performance =  66.19 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.022918 s, Result = 04380000, Performance =  67.47 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.023942 s, Result = 04740000, Performance =  68.17 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024563 s, Result = 04b00000, Performance =  69.94 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.025469 s, Result = 04ec0000, Performance =  70.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.026096 s, Result = 05280000, Performance =  72.42 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.027148 s, Result = 05640000, Performance =  72.77 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.027306 s, Result = 05a00000, Performance =  75.50 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.028911 s, Result = 05dc0000, Performance =  74.28 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.029117 s, Result = 06180000, Performance =  76.70 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.029986 s, Result = 06540000, Performance =  77.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.031170 s, Result = 06900000, Performance =  77.16 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.031576 s, Result = 06cc0000, Performance =  78.89 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.032224 s, Result = 07080000, Performance =  79.97 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.032989 s, Result = 07440000, Performance =  80.72 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.034584 s, Result = 07800000, Performance =  79.48 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.034880 s, Result = 07bc0000, Performance =  81.27 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.035618 s, Result = 07f80000, Performance =  82.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.036266 s, Result = 08340000, Performance =  82.90 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.036638 s, Result = 08700000, Performance =  84.40 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.038335 s, Result = 08ac0000, Performance =  82.91 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.038654 s, Result = 08e80000, Performance =  84.45 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.039790 s, Result = 09240000, Performance =  84.19 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039464 s, Result = 09600000, Performance =  87.07 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.040831 s, Result = 099c0000, Performance =  86.25 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.041807 s, Result = 09d80000, Performance =  86.30 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.043081 s, Result = 0a140000, Performance =  85.74 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.043689 s, Result = 0a500000, Performance =  86.51 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.044381 s, Result = 0a8c0000, Performance =  87.10 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.044659 s, Result = 0ac80000, Performance =  88.48 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.045322 s, Result = 0b040000, Performance =  89.08 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047948 s, Result = 0b400000, Performance =  85.99 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.047478 s, Result = 0b7c0000, Performance =  88.65 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.047833 s, Result = 0bb80000, Performance =  89.79 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.049245 s, Result = 0bf40000, Performance =  88.96 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050057 s, Result = 0c300000, Performance =  89.23 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.050720 s, Result = 0c6c0000, Performance =  89.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.051609 s, Result = 0ca80000, Performance =  89.88 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.052271 s, Result = 0ce40000, Performance =  90.38 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.052656 s, Result = 0d200000, Performance =  91.35 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.054069 s, Result = 0d5c0000, Performance =  90.55 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.054911 s, Result = 0d980000, Performance =  90.73 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.055974 s, Result = 0dd40000, Performance =  90.54 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.056754 s, Result = 0e100000, Performance =  90.81 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.057342 s, Result = 0e4c0000, Performance =  91.38 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.057931 s, Result = 0e880000, Performance =  91.93 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.059120 s, Result = 0ec40000, Performance =  91.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.062337 s, Result = 0f000000, Performance =  88.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1896  1754  1664
Test passed: M N K =   443   246   384
Test passed: M N K =  1926    15  1728
Test passed: M N K =   141  1927  1408
Test passed: M N K =    19  1597  1152
M N K =  4096  4096   256, Elapsed time =   0.005985 s, Result = a0dc0000, Performance =  14.35 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006897 s, Result = a1180000, Performance =  24.91 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007065 s, Result = a1540000, Performance =  36.48 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007962 s, Result = a1900000, Performance =  43.15 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008561 s, Result = a1cc0000, Performance =  50.17 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009430 s, Result = a2080000, Performance =  54.66 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009841 s, Result = a2440000, Performance =  61.10 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010675 s, Result = a2800000, Performance =  64.37 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011176 s, Result = a2bc0000, Performance =  69.17 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011990 s, Result = a2f80000, Performance =  71.64 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012963 s, Result = a3340000, Performance =  72.89 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013802 s, Result = a3700000, Performance =  74.68 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014709 s, Result = a3ac0000, Performance =  75.92 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015951 s, Result = a3e80000, Performance =  75.39 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018748 s, Result = a4240000, Performance =  68.73 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017876 s, Result = a4600000, Performance =  76.89 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019000 s, Result = a49c0000, Performance =  76.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019296 s, Result = a4d80000, Performance =  80.13 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020059 s, Result = a5140000, Performance =  81.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021653 s, Result = a5500000, Performance =  79.34 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021537 s, Result = a58c0000, Performance =  83.76 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022400 s, Result = a5c80000, Performance =  84.37 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023075 s, Result = a6040000, Performance =  85.62 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023658 s, Result = a6400000, Performance =  87.14 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.025358 s, Result = a67c0000, Performance =  84.69 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.026276 s, Result = a6b80000, Performance =  85.00 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.027028 s, Result = a6f40000, Performance =  85.81 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027618 s, Result = a7300000, Performance =  87.09 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028493 s, Result = a76c0000, Performance =  87.43 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.028723 s, Result = a7a80000, Performance =  89.72 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029610 s, Result = a7e40000, Performance =  89.93 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031871 s, Result = a8200000, Performance =  86.25 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.031585 s, Result = a85c0000, Performance =  89.75 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.032566 s, Result = a8980000, Performance =  89.68 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.033450 s, Result = a8d40000, Performance =  89.88 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.034701 s, Result = a9100000, Performance =  89.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034745 s, Result = a94c0000, Performance =  91.47 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035788 s, Result = a9880000, Performance =  91.21 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.036343 s, Result = a9c40000, Performance =  92.18 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036646 s, Result = aa000000, Performance =  93.76 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.038098 s, Result = aa3c0000, Performance =  92.44 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038868 s, Result = aa780000, Performance =  92.82 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039885 s, Result = aab40000, Performance =  92.61 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.041172 s, Result = aaf00000, Performance =  91.80 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.041214 s, Result = ab2c0000, Performance =  93.79 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.042282 s, Result = ab680000, Performance =  93.45 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.042809 s, Result = aba40000, Performance =  94.31 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.045505 s, Result = abe00000, Performance =  90.61 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.044660 s, Result = ac1c0000, Performance =  94.25 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.045634 s, Result = ac580000, Performance =  94.12 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.046259 s, Result = ac940000, Performance =  94.70 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.047353 s, Result = acd00000, Performance =  94.33 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.047658 s, Result = ad0c0000, Performance =  95.53 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.048735 s, Result = ad480000, Performance =  95.18 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.049677 s, Result = ad840000, Performance =  95.10 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.050031 s, Result = adc00000, Performance =  96.15 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.051868 s, Result = adfc0000, Performance =  94.40 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.052405 s, Result = ae380000, Performance =  95.07 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.053121 s, Result = ae740000, Performance =  95.41 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.054555 s, Result = aeb00000, Performance =  94.47 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.054314 s, Result = aeec0000, Performance =  96.47 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.055110 s, Result = af280000, Performance =  96.64 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055955 s, Result = af640000, Performance =  96.71 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.059630 s, Result = afa00000, Performance =  92.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   610   555   128
Test passed: M N K =   353  2004  1280
Test passed: M N K =  1179   513   960
Test passed: M N K =  1146   959  1472
Test passed: M N K =  1183   693  1216
M N K =  4096  4096   256, Elapsed time =   0.000941 s, Result = 003c0000, Performance =  91.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001909 s, Result = 00780000, Performance =  89.99 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002810 s, Result = 00b40000, Performance =  91.70 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003605 s, Result = 00f00000, Performance =  95.32 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004493 s, Result = 012c0000, Performance =  95.60 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005108 s, Result = 01680000, Performance = 100.89 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.006019 s, Result = 01a40000, Performance =  99.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009169 s, Result = 01e00000, Performance =  74.94 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007669 s, Result = 021c0000, Performance = 100.81 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008701 s, Result = 02580000, Performance =  98.72 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009579 s, Result = 02940000, Performance =  98.64 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010318 s, Result = 02d00000, Performance =  99.90 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011195 s, Result = 030c0000, Performance =  99.75 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012230 s, Result = 03480000, Performance =  98.33 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013279 s, Result = 03840000, Performance =  97.03 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014172 s, Result = 03c00000, Performance =  96.98 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.014959 s, Result = 03fc0000, Performance =  97.62 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.015698 s, Result = 04380000, Performance =  98.50 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.016949 s, Result = 04740000, Performance =  96.30 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017928 s, Result = 04b00000, Performance =  95.83 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018124 s, Result = 04ec0000, Performance =  99.53 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018671 s, Result = 05280000, Performance = 101.21 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019743 s, Result = 05640000, Performance = 100.07 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019893 s, Result = 05a00000, Performance = 103.63 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020748 s, Result = 05dc0000, Performance = 103.50 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021858 s, Result = 06180000, Performance = 102.18 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022778 s, Result = 06540000, Performance = 101.82 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023777 s, Result = 06900000, Performance = 101.15 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024178 s, Result = 06cc0000, Performance = 103.03 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024948 s, Result = 07080000, Performance = 103.30 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.025894 s, Result = 07440000, Performance = 102.84 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027863 s, Result = 07800000, Performance =  98.65 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027835 s, Result = 07bc0000, Performance = 101.84 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.027921 s, Result = 07f80000, Performance = 104.60 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028529 s, Result = 08340000, Performance = 105.38 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030337 s, Result = 08700000, Performance = 101.93 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031020 s, Result = 08ac0000, Performance = 102.46 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031371 s, Result = 08e80000, Performance = 104.05 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032930 s, Result = 09240000, Performance = 101.73 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.032423 s, Result = 09600000, Performance = 105.97 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.033830 s, Result = 099c0000, Performance = 104.11 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.034331 s, Result = 09d80000, Performance = 105.09 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.035257 s, Result = 0a140000, Performance = 104.76 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.036245 s, Result = 0a500000, Performance = 104.28 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.037210 s, Result = 0a8c0000, Performance = 103.88 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.037975 s, Result = 0ac80000, Performance = 104.05 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.038512 s, Result = 0b040000, Performance = 104.83 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.041151 s, Result = 0b400000, Performance = 100.19 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.039607 s, Result = 0b7c0000, Performance = 106.27 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.041065 s, Result = 0bb80000, Performance = 104.59 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.041479 s, Result = 0bf40000, Performance = 105.62 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.042421 s, Result = 0c300000, Performance = 105.30 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043221 s, Result = 0c6c0000, Performance = 105.33 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044373 s, Result = 0ca80000, Performance = 104.54 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.045003 s, Result = 0ce40000, Performance = 104.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.044942 s, Result = 0d200000, Performance = 107.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046464 s, Result = 0d5c0000, Performance = 105.38 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.047390 s, Result = 0d980000, Performance = 105.13 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.047996 s, Result = 0dd40000, Performance = 105.59 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.049530 s, Result = 0e100000, Performance = 104.06 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.048914 s, Result = 0e4c0000, Performance = 107.12 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.050424 s, Result = 0e880000, Performance = 105.62 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.050433 s, Result = 0ec40000, Performance = 107.30 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054664 s, Result = 0f000000, Performance = 100.57 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1383  1273  1920
Test passed: M N K =  1975   369  1536
Test passed: M N K =   946    72   192
Test passed: M N K =   742  1975  1984
Test passed: M N K =   377  1336   512
M N K =  4096  4096   256, Elapsed time =   0.009597 s, Result = 10380000, Performance =   8.95 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010210 s, Result = 10600000, Performance =  16.83 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010770 s, Result = 10880000, Performance =  23.93 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011533 s, Result = 10b00000, Performance =  29.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012357 s, Result = 10d80000, Performance =  34.76 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012679 s, Result = 11000000, Performance =  40.65 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014078 s, Result = 11280000, Performance =  42.71 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014665 s, Result = 11500000, Performance =  46.86 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014992 s, Result = 11780000, Performance =  51.57 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015832 s, Result = 11a00000, Performance =  54.26 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015745 s, Result = 11c80000, Performance =  60.01 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016879 s, Result = 11f00000, Performance =  61.07 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017208 s, Result = 12180000, Performance =  64.89 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.022159 s, Result = 12400000, Performance =  54.27 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018187 s, Result = 12680000, Performance =  70.85 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.019377 s, Result = 12900000, Performance =  70.93 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019646 s, Result = 12b80000, Performance =  74.33 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019688 s, Result = 12e00000, Performance =  78.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020449 s, Result = 13080000, Performance =  79.81 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020536 s, Result = 13300000, Performance =  83.66 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021199 s, Result = 13580000, Performance =  85.09 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.029630 s, Result = 13800000, Performance =  63.78 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021859 s, Result = 13a80000, Performance =  90.38 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023398 s, Result = 13d00000, Performance =  88.11 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023050 s, Result = 13f80000, Performance =  93.17 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023627 s, Result = 14200000, Performance =  94.53 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024324 s, Result = 14480000, Performance =  95.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024497 s, Result = 14700000, Performance =  98.18 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.025226 s, Result = 14980000, Performance =  98.75 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025736 s, Result = 14c00000, Performance = 100.13 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026215 s, Result = 14e80000, Performance = 101.58 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027125 s, Result = 15100000, Performance = 101.34 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027122 s, Result = 15380000, Performance = 104.52 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028226 s, Result = 15600000, Performance = 103.47 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028607 s, Result = 15880000, Performance = 105.09 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.029114 s, Result = 15b00000, Performance = 106.21 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029788 s, Result = 15d80000, Performance = 106.70 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.030315 s, Result = 16000000, Performance = 107.67 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030760 s, Result = 16280000, Performance = 108.91 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.031772 s, Result = 16500000, Performance = 108.14 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.032473 s, Result = 16780000, Performance = 108.46 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032980 s, Result = 16a00000, Performance = 109.39 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.033945 s, Result = 16c80000, Performance = 108.81 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.034180 s, Result = 16f00000, Performance = 110.58 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.034241 s, Result = 17180000, Performance = 112.89 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.035914 s, Result = 17400000, Performance = 110.02 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.035947 s, Result = 17680000, Performance = 112.31 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.038024 s, Result = 17900000, Performance = 108.44 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.037623 s, Result = 17b80000, Performance = 111.87 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.038556 s, Result = 17e00000, Performance = 111.39 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.039016 s, Result = 18080000, Performance = 112.28 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.039859 s, Result = 18300000, Performance = 112.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.040974 s, Result = 18580000, Performance = 111.11 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.042208 s, Result = 18800000, Performance = 109.90 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.043313 s, Result = 18a80000, Performance = 109.08 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.043893 s, Result = 18d00000, Performance = 109.59 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.044562 s, Result = 18f80000, Performance = 109.88 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.045515 s, Result = 19200000, Performance = 109.46 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.047151 s, Result = 19480000, Performance = 107.48 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.046833 s, Result = 19700000, Performance = 110.05 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.048336 s, Result = 19980000, Performance = 108.40 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.049253 s, Result = 19c00000, Performance = 108.13 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.050421 s, Result = 19e80000, Performance = 107.33 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.053440 s, Result = 1a100000, Performance = 102.87 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1624   911  1408
Test passed: M N K =   547   392  1792
Test passed: M N K =   646   230  1856
Test passed: M N K =  1067   186  1536
Test passed: M N K =   125   316   128
M N K =  4096  4096   256, Elapsed time =   0.013074 s, Result = 00280000, Performance =   6.57 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010965 s, Result = 00500000, Performance =  15.67 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012113 s, Result = 00780000, Performance =  21.27 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012353 s, Result = 00a00000, Performance =  27.81 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012445 s, Result = 00c80000, Performance =  34.51 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013101 s, Result = 00f00000, Performance =  39.34 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012638 s, Result = 01180000, Performance =  47.58 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013439 s, Result = 01400000, Performance =  51.13 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012833 s, Result = 01680000, Performance =  60.24 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013268 s, Result = 01900000, Performance =  64.74 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014541 s, Result = 01b80000, Performance =  64.98 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014255 s, Result = 01e00000, Performance =  72.31 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014765 s, Result = 02080000, Performance =  75.63 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015024 s, Result = 02300000, Performance =  80.05 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015696 s, Result = 02580000, Performance =  82.09 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.021636 s, Result = 02800000, Performance =  63.52 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016595 s, Result = 02a80000, Performance =  88.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016961 s, Result = 02d00000, Performance =  91.16 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017196 s, Result = 02f80000, Performance =  94.91 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017988 s, Result = 03200000, Performance =  95.51 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017975 s, Result = 03480000, Performance = 100.36 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018551 s, Result = 03700000, Performance = 101.87 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019465 s, Result = 03980000, Performance = 101.50 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020026 s, Result = 03c00000, Performance = 102.95 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019968 s, Result = 03e80000, Performance = 107.55 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020905 s, Result = 04100000, Performance = 106.84 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021331 s, Result = 04380000, Performance = 108.73 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021888 s, Result = 04600000, Performance = 109.88 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022380 s, Result = 04880000, Performance = 111.31 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022524 s, Result = 04b00000, Performance = 114.41 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022856 s, Result = 04d80000, Performance = 116.51 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023841 s, Result = 05000000, Performance = 115.30 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.023885 s, Result = 05280000, Performance = 118.68 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024639 s, Result = 05500000, Performance = 118.53 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025052 s, Result = 05780000, Performance = 120.01 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.025811 s, Result = 05a00000, Performance = 119.81 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.025953 s, Result = 05c80000, Performance = 122.46 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.026716 s, Result = 05f00000, Performance = 122.18 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027062 s, Result = 06180000, Performance = 123.79 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028183 s, Result = 06400000, Performance = 121.92 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.027923 s, Result = 06680000, Performance = 126.13 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.028680 s, Result = 06900000, Performance = 125.80 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029161 s, Result = 06b80000, Performance = 126.66 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.029800 s, Result = 06e00000, Performance = 126.83 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.029989 s, Result = 07080000, Performance = 128.90 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.030923 s, Result = 07300000, Performance = 127.78 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.031356 s, Result = 07580000, Performance = 128.76 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.032452 s, Result = 07800000, Performance = 127.06 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.032356 s, Result = 07a80000, Performance = 130.09 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.032701 s, Result = 07d00000, Performance = 131.34 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.033714 s, Result = 07f80000, Performance = 129.94 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.034024 s, Result = 08200000, Performance = 131.28 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.035094 s, Result = 08480000, Performance = 129.73 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.035735 s, Result = 08700000, Performance = 129.80 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.036152 s, Result = 08980000, Performance = 130.68 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.037489 s, Result = 08c00000, Performance = 128.31 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.038181 s, Result = 08e80000, Performance = 128.24 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.039553 s, Result = 09100000, Performance = 125.96 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.040511 s, Result = 09380000, Performance = 125.10 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.040628 s, Result = 09600000, Performance = 126.86 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.041422 s, Result = 09880000, Performance = 126.50 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.042102 s, Result = 09b00000, Performance = 126.50 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.043076 s, Result = 09d80000, Performance = 125.63 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.045093 s, Result = 0a000000, Performance = 121.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    41    70  1792
Test passed: M N K =   355   246   896
Test passed: M N K =  1155  1363  1408
Test passed: M N K =  1713   125   448
Test passed: M N K =   720  1633  1856
M N K =  4096  4096   256, Elapsed time =   0.006552 s, Result = a0c80000, Performance =  13.11 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006737 s, Result = a0f00000, Performance =  25.50 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007342 s, Result = a1180000, Performance =  35.10 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007545 s, Result = a1400000, Performance =  45.54 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007832 s, Result = a1680000, Performance =  54.84 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008298 s, Result = a1900000, Performance =  62.11 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008711 s, Result = a1b80000, Performance =  69.03 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009351 s, Result = a1e00000, Performance =  73.49 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009562 s, Result = a2080000, Performance =  80.85 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010166 s, Result = a2300000, Performance =  84.50 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010705 s, Result = a2580000, Performance =  88.27 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011005 s, Result = a2800000, Performance =  93.67 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011625 s, Result = a2a80000, Performance =  96.06 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012245 s, Result = a2d00000, Performance =  98.21 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012451 s, Result = a2f80000, Performance = 103.48 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014649 s, Result = a3200000, Performance =  93.82 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023232 s, Result = a3480000, Performance =  62.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013962 s, Result = a3700000, Performance = 110.74 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014647 s, Result = a3980000, Performance = 111.43 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015044 s, Result = a3c00000, Performance = 114.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015356 s, Result = a3e80000, Performance = 117.47 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015940 s, Result = a4100000, Performance = 118.56 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016475 s, Result = a4380000, Performance = 119.92 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017153 s, Result = a4600000, Performance = 120.18 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017501 s, Result = a4880000, Performance = 122.70 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017808 s, Result = a4b00000, Performance = 125.41 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018435 s, Result = a4d80000, Performance = 125.81 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.018960 s, Result = a5000000, Performance = 126.85 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019288 s, Result = a5280000, Performance = 129.15 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.019915 s, Result = a5500000, Performance = 129.40 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020348 s, Result = a5780000, Performance = 130.87 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021618 s, Result = a5a00000, Performance = 127.15 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021201 s, Result = a5c80000, Performance = 133.70 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.021957 s, Result = a5f00000, Performance = 133.02 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022493 s, Result = a6180000, Performance = 133.66 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022814 s, Result = a6400000, Performance = 135.55 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023377 s, Result = a6680000, Performance = 135.96 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024120 s, Result = a6900000, Performance = 135.33 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024453 s, Result = a6b80000, Performance = 137.00 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025523 s, Result = a6e00000, Performance = 134.62 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025845 s, Result = a7080000, Performance = 136.27 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.025937 s, Result = a7300000, Performance = 139.10 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.027372 s, Result = a7580000, Performance = 134.94 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.027229 s, Result = a7800000, Performance = 138.81 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.028146 s, Result = a7a80000, Performance = 137.33 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.029069 s, Result = a7d00000, Performance = 135.93 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.029195 s, Result = a7f80000, Performance = 138.29 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.032057 s, Result = a8200000, Performance = 128.62 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.030766 s, Result = a8480000, Performance = 136.81 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.031525 s, Result = a8700000, Performance = 136.24 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.032438 s, Result = a8980000, Performance = 135.06 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.032793 s, Result = a8c00000, Performance = 136.21 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.033847 s, Result = a8e80000, Performance = 134.51 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.034077 s, Result = a9100000, Performance = 136.12 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.034933 s, Result = a9380000, Performance = 135.24 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.036157 s, Result = a9600000, Performance = 133.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.036339 s, Result = a9880000, Performance = 134.74 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.037560 s, Result = a9b00000, Performance = 132.64 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.038695 s, Result = a9d80000, Performance = 130.97 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.038766 s, Result = aa000000, Performance = 132.95 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.040005 s, Result = aa280000, Performance = 130.98 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.040495 s, Result = aa500000, Performance = 131.52 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.041880 s, Result = aa780000, Performance = 129.22 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046022 s, Result = aaa00000, Performance = 119.45 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   218   787  2048
Test passed: M N K =  1448   409   192
Test passed: M N K =  1047   429  1728
Test passed: M N K =  1210   431   832
Test passed: M N K =   727  1324   448
M N K =  4096  4096   256, Elapsed time =   0.000870 s, Result = 00280000, Performance =  98.70 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001548 s, Result = 00500000, Performance = 110.99 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002178 s, Result = 00780000, Performance = 118.31 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002949 s, Result = 00a00000, Performance = 116.51 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003338 s, Result = 00c80000, Performance = 128.67 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003865 s, Result = 00f00000, Performance = 133.35 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004347 s, Result = 01180000, Performance = 138.31 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005193 s, Result = 01400000, Performance = 132.33 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005524 s, Result = 01680000, Performance = 139.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005789 s, Result = 01900000, Performance = 148.38 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006320 s, Result = 01b80000, Performance = 149.50 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.007111 s, Result = 01e00000, Performance = 144.96 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.007288 s, Result = 02080000, Performance = 153.21 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.007910 s, Result = 02300000, Performance = 152.03 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.008441 s, Result = 02580000, Performance = 152.64 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.010149 s, Result = 02800000, Performance = 135.42 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.009222 s, Result = 02a80000, Performance = 158.34 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013550 s, Result = 02d00000, Performance = 114.11 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.010246 s, Result = 02f80000, Performance = 159.29 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.010865 s, Result = 03200000, Performance = 158.12 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.010966 s, Result = 03480000, Performance = 164.49 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.011560 s, Result = 03700000, Performance = 163.48 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.011794 s, Result = 03980000, Performance = 167.52 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.013430 s, Result = 03c00000, Performance = 153.50 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.012923 s, Result = 03e80000, Performance = 166.18 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.013491 s, Result = 04100000, Performance = 165.54 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.013900 s, Result = 04380000, Performance = 166.85 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.014296 s, Result = 04600000, Performance = 168.24 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.014839 s, Result = 04880000, Performance = 167.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.015354 s, Result = 04b00000, Performance = 167.84 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.015692 s, Result = 04d80000, Performance = 169.69 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.018904 s, Result = 05000000, Performance = 145.41 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.016485 s, Result = 05280000, Performance = 171.95 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.017103 s, Result = 05500000, Performance = 170.76 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.017812 s, Result = 05780000, Performance = 168.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.018065 s, Result = 05a00000, Performance = 171.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.018297 s, Result = 05c80000, Performance = 173.71 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.018915 s, Result = 05f00000, Performance = 172.57 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.019414 s, Result = 06180000, Performance = 172.56 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.020915 s, Result = 06400000, Performance = 164.28 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.020067 s, Result = 06680000, Performance = 175.51 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.020837 s, Result = 06900000, Performance = 173.14 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.021387 s, Result = 06b80000, Performance = 172.71 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.021708 s, Result = 06e00000, Performance = 174.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022258 s, Result = 07080000, Performance = 173.67 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.022593 s, Result = 07300000, Performance = 174.89 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.023172 s, Result = 07580000, Performance = 174.23 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.024889 s, Result = 07800000, Performance = 165.66 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.024040 s, Result = 07a80000, Performance = 175.08 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.024576 s, Result = 07d00000, Performance = 174.76 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.025112 s, Result = 07f80000, Performance = 174.46 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.025715 s, Result = 08200000, Performance = 173.70 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.026316 s, Result = 08480000, Performance = 173.00 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.026753 s, Result = 08700000, Performance = 173.38 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.028106 s, Result = 08980000, Performance = 168.09 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.028494 s, Result = 08c00000, Performance = 168.82 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.029874 s, Result = 08e80000, Performance = 163.90 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.030773 s, Result = 09100000, Performance = 161.90 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.031640 s, Result = 09380000, Performance = 160.18 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.032013 s, Result = 09600000, Performance = 161.00 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.032750 s, Result = 09880000, Performance = 159.99 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.033384 s, Result = 09b00000, Performance = 159.53 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.034351 s, Result = 09d80000, Performance = 157.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.035470 s, Result = 0a000000, Performance = 154.99 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1929   415  1280
Test passed: M N K =  1319  1310  1088
Test passed: M N K =  1897  1273   576
Test passed: M N K =   738  1438   192
Test passed: M N K =   465   590   384
M N K =  4096  4096   256, Elapsed time =   0.009645 s, Result = 10380000, Performance =   8.91 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009918 s, Result = 10600000, Performance =  17.32 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010743 s, Result = 10880000, Performance =  23.99 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012000 s, Result = 10b00000, Performance =  28.63 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012199 s, Result = 10d80000, Performance =  35.21 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013152 s, Result = 11000000, Performance =  39.19 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013397 s, Result = 11280000, Performance =  44.88 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014628 s, Result = 11500000, Performance =  46.98 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014701 s, Result = 11780000, Performance =  52.59 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015703 s, Result = 11a00000, Performance =  54.70 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016336 s, Result = 11c80000, Performance =  57.84 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017584 s, Result = 11f00000, Performance =  58.62 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017394 s, Result = 12180000, Performance =  64.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017870 s, Result = 12400000, Performance =  67.30 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019837 s, Result = 12680000, Performance =  64.95 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.019969 s, Result = 12900000, Performance =  68.83 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019233 s, Result = 12b80000, Performance =  75.93 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019622 s, Result = 12e00000, Performance =  78.80 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020435 s, Result = 13080000, Performance =  79.87 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021272 s, Result = 13300000, Performance =  80.76 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021412 s, Result = 13580000, Performance =  84.25 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022012 s, Result = 13800000, Performance =  85.85 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.034162 s, Result = 13a80000, Performance =  57.83 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023821 s, Result = 13d00000, Performance =  86.54 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023396 s, Result = 13f80000, Performance =  91.79 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.024337 s, Result = 14200000, Performance =  91.77 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024191 s, Result = 14480000, Performance =  95.88 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.025353 s, Result = 14700000, Performance =  94.87 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.025373 s, Result = 14980000, Performance =  98.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.026129 s, Result = 14c00000, Performance =  98.63 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026305 s, Result = 14e80000, Performance = 101.23 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.029585 s, Result = 15100000, Performance =  92.91 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027524 s, Result = 15380000, Performance = 102.99 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028003 s, Result = 15600000, Performance = 104.29 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028710 s, Result = 15880000, Performance = 104.72 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.029048 s, Result = 15b00000, Performance = 106.46 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029359 s, Result = 15d80000, Performance = 108.26 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.030354 s, Result = 16000000, Performance = 107.54 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030662 s, Result = 16280000, Performance = 109.26 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.032471 s, Result = 16500000, Performance = 105.82 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.031939 s, Result = 16780000, Performance = 110.27 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032676 s, Result = 16a00000, Performance = 110.41 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.033259 s, Result = 16c80000, Performance = 111.06 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.033558 s, Result = 16f00000, Performance = 112.63 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.034138 s, Result = 17180000, Performance = 113.23 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.034816 s, Result = 17400000, Performance = 113.49 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.035088 s, Result = 17680000, Performance = 115.06 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040077 s, Result = 17900000, Performance = 102.88 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036644 s, Result = 17b80000, Performance = 114.86 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.037327 s, Result = 17e00000, Performance = 115.06 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.038251 s, Result = 18080000, Performance = 114.53 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.038487 s, Result = 18300000, Performance = 116.06 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.039492 s, Result = 18580000, Performance = 115.28 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.040365 s, Result = 18800000, Performance = 114.92 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.041007 s, Result = 18a80000, Performance = 115.21 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.042812 s, Result = 18d00000, Performance = 112.36 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.042545 s, Result = 18f80000, Performance = 115.08 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.043366 s, Result = 19200000, Performance = 114.89 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.044081 s, Result = 19480000, Performance = 114.97 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.044769 s, Result = 19700000, Performance = 115.12 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.046007 s, Result = 19980000, Performance = 113.89 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.046985 s, Result = 19c00000, Performance = 113.35 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.047620 s, Result = 19e80000, Performance = 113.64 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.051994 s, Result = 1a100000, Performance = 105.73 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1580   600  1472
Test passed: M N K =  1503  1028   512
Test passed: M N K =   874  1948  1600
Test passed: M N K =    24  1509  1536
Test passed: M N K =   659  1961  1600
M N K =  4096  4096   256, Elapsed time =   0.013007 s, Result = 00280000, Performance =   6.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010977 s, Result = 00500000, Performance =  15.65 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012543 s, Result = 00780000, Performance =  20.54 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011863 s, Result = 00a00000, Performance =  28.96 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012772 s, Result = 00c80000, Performance =  33.63 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012411 s, Result = 00f00000, Performance =  41.53 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012704 s, Result = 01180000, Performance =  47.33 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013041 s, Result = 01400000, Performance =  52.69 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013336 s, Result = 01680000, Performance =  57.97 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013687 s, Result = 01900000, Performance =  62.76 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014546 s, Result = 01b80000, Performance =  64.96 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015038 s, Result = 01e00000, Performance =  68.55 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015388 s, Result = 02080000, Performance =  72.57 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015973 s, Result = 02300000, Performance =  75.29 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016327 s, Result = 02580000, Performance =  78.92 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016780 s, Result = 02800000, Performance =  81.91 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016886 s, Result = 02a80000, Performance =  86.48 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017581 s, Result = 02d00000, Performance =  87.95 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018029 s, Result = 02f80000, Performance =  90.52 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018301 s, Result = 03200000, Performance =  93.87 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018841 s, Result = 03480000, Performance =  95.74 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019342 s, Result = 03700000, Performance =  97.70 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019819 s, Result = 03980000, Performance =  99.69 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020553 s, Result = 03c00000, Performance = 100.30 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020930 s, Result = 03e80000, Performance = 102.61 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021615 s, Result = 04100000, Performance = 103.33 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021722 s, Result = 04380000, Performance = 106.77 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022466 s, Result = 04600000, Performance = 107.06 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.023010 s, Result = 04880000, Performance = 108.26 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.023356 s, Result = 04b00000, Performance = 110.34 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023458 s, Result = 04d80000, Performance = 113.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025949 s, Result = 05000000, Performance = 105.93 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024439 s, Result = 05280000, Performance = 115.99 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025520 s, Result = 05500000, Performance = 114.44 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025638 s, Result = 05780000, Performance = 117.27 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026417 s, Result = 05a00000, Performance = 117.06 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026569 s, Result = 05c80000, Performance = 119.62 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.027423 s, Result = 05f00000, Performance = 119.03 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027501 s, Result = 06180000, Performance = 121.82 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029521 s, Result = 06400000, Performance = 116.39 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028412 s, Result = 06680000, Performance = 123.96 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.029322 s, Result = 06900000, Performance = 123.04 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029982 s, Result = 06b80000, Performance = 123.20 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.030339 s, Result = 06e00000, Performance = 124.58 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030324 s, Result = 07080000, Performance = 127.47 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.031172 s, Result = 07300000, Performance = 126.76 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.031124 s, Result = 07580000, Performance = 129.71 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.035728 s, Result = 07800000, Performance = 115.40 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.032464 s, Result = 07a80000, Performance = 129.65 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.033368 s, Result = 07d00000, Performance = 128.71 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.033611 s, Result = 07f80000, Performance = 130.34 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.034274 s, Result = 08200000, Performance = 130.33 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.034728 s, Result = 08480000, Performance = 131.09 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.035298 s, Result = 08700000, Performance = 131.41 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.035805 s, Result = 08980000, Performance = 131.95 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.038304 s, Result = 08c00000, Performance = 125.58 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.037020 s, Result = 08e80000, Performance = 132.26 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.037810 s, Result = 09100000, Performance = 131.77 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.038302 s, Result = 09380000, Performance = 132.32 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.039091 s, Result = 09600000, Performance = 131.85 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.039858 s, Result = 09880000, Performance = 131.46 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.040384 s, Result = 09b00000, Performance = 131.88 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.041257 s, Result = 09d80000, Performance = 131.17 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.045551 s, Result = 0a000000, Performance = 120.69 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1030  1756   512
Test passed: M N K =    34   645   960
Test passed: M N K =  1938  1883  1152
Test passed: M N K =  1899  1707  1408
Test passed: M N K =   348   631  2048
M N K =  4096  4096   256, Elapsed time =   0.006453 s, Result = a0c80000, Performance =  13.31 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006292 s, Result = a0f00000, Performance =  27.30 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007198 s, Result = a1180000, Performance =  35.80 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007464 s, Result = a1400000, Performance =  46.03 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007744 s, Result = a1680000, Performance =  55.46 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008186 s, Result = a1900000, Performance =  62.96 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008718 s, Result = a1b80000, Performance =  68.97 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009361 s, Result = a1e00000, Performance =  73.41 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009697 s, Result = a2080000, Performance =  79.72 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010320 s, Result = a2300000, Performance =  83.24 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010943 s, Result = a2580000, Performance =  86.35 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011389 s, Result = a2800000, Performance =  90.51 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011804 s, Result = a2a80000, Performance =  94.60 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012599 s, Result = a2d00000, Performance =  95.45 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012793 s, Result = a2f80000, Performance = 100.72 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014641 s, Result = a3200000, Performance =  93.87 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013597 s, Result = a3480000, Performance = 107.40 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014610 s, Result = a3700000, Performance = 105.83 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014658 s, Result = a3980000, Performance = 111.35 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014992 s, Result = a3c00000, Performance = 114.60 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015563 s, Result = a3e80000, Performance = 115.91 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.016146 s, Result = a4100000, Performance = 117.04 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016344 s, Result = a4380000, Performance = 120.88 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017672 s, Result = a4600000, Performance = 116.66 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017316 s, Result = a4880000, Performance = 124.02 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017956 s, Result = a4b00000, Performance = 124.38 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018567 s, Result = a4d80000, Performance = 124.91 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019462 s, Result = a5000000, Performance = 123.58 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019730 s, Result = a5280000, Performance = 126.26 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020293 s, Result = a5500000, Performance = 126.99 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020557 s, Result = a5780000, Performance = 129.54 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023965 s, Result = a5a00000, Performance = 114.70 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021306 s, Result = a5c80000, Performance = 133.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022131 s, Result = a5f00000, Performance = 131.97 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022700 s, Result = a6180000, Performance = 132.44 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023399 s, Result = a6400000, Performance = 132.16 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023476 s, Result = a6680000, Performance = 135.38 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024408 s, Result = a6900000, Performance = 133.74 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024494 s, Result = a6b80000, Performance = 136.77 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.026271 s, Result = a6e00000, Performance = 130.79 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025628 s, Result = a7080000, Performance = 137.42 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026052 s, Result = a7300000, Performance = 138.48 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026849 s, Result = a7580000, Performance = 137.57 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.027134 s, Result = a7800000, Performance = 139.29 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027468 s, Result = a7a80000, Performance = 140.72 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.028258 s, Result = a7d00000, Performance = 139.83 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028930 s, Result = a7f80000, Performance = 139.55 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033452 s, Result = a8200000, Performance = 123.26 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029773 s, Result = a8480000, Performance = 141.37 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.030722 s, Result = a8700000, Performance = 139.80 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.031159 s, Result = a8980000, Performance = 140.60 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.031670 s, Result = a8c00000, Performance = 141.04 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.032190 s, Result = a8e80000, Performance = 141.43 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.033472 s, Result = a9100000, Performance = 138.58 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.033632 s, Result = a9380000, Performance = 140.47 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.035480 s, Result = a9600000, Performance = 135.58 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.034740 s, Result = a9880000, Performance = 140.94 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.035462 s, Result = a9b00000, Performance = 140.49 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.036674 s, Result = a9d80000, Performance = 138.19 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.036751 s, Result = aa000000, Performance = 140.24 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.037733 s, Result = aa280000, Performance = 138.87 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.038381 s, Result = aa500000, Performance = 138.76 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039176 s, Result = aa780000, Performance = 138.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.043571 s, Result = aaa00000, Performance = 126.18 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1644   906   128
Test passed: M N K =  1811  1723  1472
Test passed: M N K =  1560  1574   576
Test passed: M N K =  1604  1451  1472
Test passed: M N K =   924   269   640
M N K =  4096  4096   256, Elapsed time =   0.000793 s, Result = 00280000, Performance = 108.25 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001682 s, Result = 00500000, Performance = 102.17 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002398 s, Result = 00780000, Performance = 107.45 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003066 s, Result = 00a00000, Performance = 112.08 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003509 s, Result = 00c80000, Performance = 122.41 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005635 s, Result = 00f00000, Performance =  91.47 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004504 s, Result = 01180000, Performance = 133.51 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005174 s, Result = 01400000, Performance = 132.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005669 s, Result = 01680000, Performance = 136.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006235 s, Result = 01900000, Performance = 137.77 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006859 s, Result = 01b80000, Performance = 137.77 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.007466 s, Result = 01e00000, Performance = 138.06 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.007950 s, Result = 02080000, Performance = 140.46 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.008750 s, Result = 02300000, Performance = 137.44 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.008997 s, Result = 02580000, Performance = 143.22 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.010104 s, Result = 02800000, Performance = 136.02 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.009526 s, Result = 02a80000, Performance = 153.30 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.010325 s, Result = 02d00000, Performance = 149.75 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.010403 s, Result = 02f80000, Performance = 156.88 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.011163 s, Result = 03200000, Performance = 153.90 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.011417 s, Result = 03480000, Performance = 158.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.012063 s, Result = 03700000, Performance = 156.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.012768 s, Result = 03980000, Performance = 154.74 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.013751 s, Result = 03c00000, Performance = 149.92 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.013694 s, Result = 03e80000, Performance = 156.82 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.014539 s, Result = 04100000, Performance = 153.61 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.014819 s, Result = 04380000, Performance = 156.51 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.015439 s, Result = 04600000, Performance = 155.78 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.015509 s, Result = 04880000, Performance = 160.62 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.016421 s, Result = 04b00000, Performance = 156.93 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.016406 s, Result = 04d80000, Performance = 162.31 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.019051 s, Result = 05000000, Performance = 144.29 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.017358 s, Result = 05280000, Performance = 163.31 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.018200 s, Result = 05500000, Performance = 160.47 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.018674 s, Result = 05780000, Performance = 160.99 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.019388 s, Result = 05a00000, Performance = 159.50 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.019622 s, Result = 05c80000, Performance = 161.97 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.020323 s, Result = 05f00000, Performance = 160.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.020264 s, Result = 06180000, Performance = 165.32 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.022162 s, Result = 06400000, Performance = 155.04 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.021423 s, Result = 06680000, Performance = 164.40 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.021731 s, Result = 06900000, Performance = 166.02 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.022246 s, Result = 06b80000, Performance = 166.04 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.022996 s, Result = 06e00000, Performance = 164.36 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022568 s, Result = 07080000, Performance = 171.28 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.023300 s, Result = 07300000, Performance = 169.59 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.023678 s, Result = 07580000, Performance = 170.51 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028273 s, Result = 07800000, Performance = 145.84 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.024655 s, Result = 07a80000, Performance = 170.72 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.025452 s, Result = 07d00000, Performance = 168.75 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.025759 s, Result = 07f80000, Performance = 170.07 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.026700 s, Result = 08200000, Performance = 167.30 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.026998 s, Result = 08480000, Performance = 168.63 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.027366 s, Result = 08700000, Performance = 169.50 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.028148 s, Result = 08980000, Performance = 167.84 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.030026 s, Result = 08c00000, Performance = 160.21 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.028704 s, Result = 08e80000, Performance = 170.58 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.029507 s, Result = 09100000, Performance = 168.84 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.030261 s, Result = 09380000, Performance = 167.48 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.031094 s, Result = 09600000, Performance = 165.76 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.030977 s, Result = 09880000, Performance = 169.15 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.031635 s, Result = 09b00000, Performance = 168.35 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.032714 s, Result = 09d80000, Performance = 165.42 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.037797 s, Result = 0a000000, Performance = 145.45 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    25  1786  1408
Test passed: M N K =   958  1226  1344
Test passed: M N K =   973   903   512
Test passed: M N K =  1897   891   320
Test passed: M N K =  1934   110  1344
M N K =  4096  4096   256, Elapsed time =   0.009574 s, Result = 10380000, Performance =   8.97 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010377 s, Result = 10600000, Performance =  16.55 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010981 s, Result = 10880000, Performance =  23.47 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011741 s, Result = 10b00000, Performance =  29.27 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012294 s, Result = 10d80000, Performance =  34.93 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013168 s, Result = 11000000, Performance =  39.14 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.017299 s, Result = 11280000, Performance =  34.76 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014956 s, Result = 11500000, Performance =  45.95 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015174 s, Result = 11780000, Performance =  50.95 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015757 s, Result = 11a00000, Performance =  54.52 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016844 s, Result = 11c80000, Performance =  56.10 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017286 s, Result = 11f00000, Performance =  59.63 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017800 s, Result = 12180000, Performance =  62.73 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019033 s, Result = 12400000, Performance =  63.19 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019408 s, Result = 12680000, Performance =  66.39 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020257 s, Result = 12900000, Performance =  67.85 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020688 s, Result = 12b80000, Performance =  70.58 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021039 s, Result = 12e00000, Performance =  73.49 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022267 s, Result = 13080000, Performance =  73.30 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.023241 s, Result = 13300000, Performance =  73.92 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022883 s, Result = 13580000, Performance =  78.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023956 s, Result = 13800000, Performance =  78.89 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.024340 s, Result = 13a80000, Performance =  81.17 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024685 s, Result = 13d00000, Performance =  83.51 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.025895 s, Result = 13f80000, Performance =  82.93 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.026017 s, Result = 14200000, Performance =  85.84 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.026954 s, Result = 14480000, Performance =  86.05 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.027396 s, Result = 14700000, Performance =  87.79 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.028216 s, Result = 14980000, Performance =  88.29 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.028399 s, Result = 14c00000, Performance =  90.74 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.029404 s, Result = 14e80000, Performance =  90.56 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.029563 s, Result = 15100000, Performance =  92.98 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.030835 s, Result = 15380000, Performance =  91.93 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.030696 s, Result = 15600000, Performance =  95.15 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.032136 s, Result = 15880000, Performance =  93.56 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.032317 s, Result = 15b00000, Performance =  95.69 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.033031 s, Result = 15d80000, Performance =  96.22 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.033502 s, Result = 16000000, Performance =  97.43 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.034475 s, Result = 16280000, Performance =  97.17 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034403 s, Result = 16500000, Performance =  99.88 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035799 s, Result = 16780000, Performance =  98.38 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036156 s, Result = 16a00000, Performance =  99.78 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.037130 s, Result = 16c80000, Performance =  99.48 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037501 s, Result = 16f00000, Performance = 100.79 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038321 s, Result = 17180000, Performance = 100.87 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.038560 s, Result = 17400000, Performance = 102.47 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.039369 s, Result = 17680000, Performance = 102.55 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040270 s, Result = 17900000, Performance = 102.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041132 s, Result = 17b80000, Performance = 102.33 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.040873 s, Result = 17e00000, Performance = 105.08 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.042130 s, Result = 18080000, Performance = 103.98 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.042422 s, Result = 18300000, Performance = 105.29 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.043365 s, Result = 18580000, Performance = 104.99 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.044361 s, Result = 18800000, Performance = 104.56 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.045334 s, Result = 18a80000, Performance = 104.22 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.044351 s, Result = 18d00000, Performance = 108.46 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.046146 s, Result = 18f80000, Performance = 106.10 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.046594 s, Result = 19200000, Performance = 106.93 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.047937 s, Result = 19480000, Performance = 105.72 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.048647 s, Result = 19700000, Performance = 105.95 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.048899 s, Result = 19980000, Performance = 107.16 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.049612 s, Result = 19c00000, Performance = 107.35 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.050385 s, Result = 19e80000, Performance = 107.41 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.050941 s, Result = 1a100000, Performance = 107.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   814   719   384
Test passed: M N K =  1687  2006  1472
Test passed: M N K =  1027  2033  1600
Test passed: M N K =  1174  1223  1216
Test passed: M N K =  1643  1009  1984
M N K =  4096  4096   256, Elapsed time =   0.012612 s, Result = 00280000, Performance =   6.81 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011536 s, Result = 00500000, Performance =  14.89 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012158 s, Result = 00780000, Performance =  21.20 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012889 s, Result = 00a00000, Performance =  26.66 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011800 s, Result = 00c80000, Performance =  36.40 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012486 s, Result = 00f00000, Performance =  41.28 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013302 s, Result = 01180000, Performance =  45.20 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.012917 s, Result = 01400000, Performance =  53.20 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013534 s, Result = 01680000, Performance =  57.12 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013197 s, Result = 01900000, Performance =  65.09 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014120 s, Result = 01b80000, Performance =  66.92 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014509 s, Result = 01e00000, Performance =  71.04 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015233 s, Result = 02080000, Performance =  73.31 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016099 s, Result = 02300000, Performance =  74.70 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016423 s, Result = 02580000, Performance =  78.46 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016356 s, Result = 02800000, Performance =  84.03 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017441 s, Result = 02a80000, Performance =  83.73 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018280 s, Result = 02d00000, Performance =  84.58 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018909 s, Result = 02f80000, Performance =  86.31 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019284 s, Result = 03200000, Performance =  89.09 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019984 s, Result = 03480000, Performance =  90.27 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020409 s, Result = 03700000, Performance =  92.59 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021358 s, Result = 03980000, Performance =  92.50 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021073 s, Result = 03c00000, Performance =  97.83 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022837 s, Result = 03e80000, Performance =  94.04 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023006 s, Result = 04100000, Performance =  97.08 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023804 s, Result = 04380000, Performance =  97.43 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024426 s, Result = 04600000, Performance =  98.47 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024832 s, Result = 04880000, Performance = 100.32 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025587 s, Result = 04b00000, Performance = 100.72 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026077 s, Result = 04d80000, Performance = 102.12 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026205 s, Result = 05000000, Performance = 104.89 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027264 s, Result = 05280000, Performance = 103.97 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.028192 s, Result = 05500000, Performance = 103.60 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028638 s, Result = 05780000, Performance = 104.98 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.028668 s, Result = 05a00000, Performance = 107.87 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029785 s, Result = 05c80000, Performance = 106.71 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.030427 s, Result = 05f00000, Performance = 107.28 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030573 s, Result = 06180000, Performance = 109.58 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.031279 s, Result = 06400000, Performance = 109.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.031950 s, Result = 06680000, Performance = 110.23 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032669 s, Result = 06900000, Performance = 110.44 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.033569 s, Result = 06b80000, Performance = 110.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.033581 s, Result = 06e00000, Performance = 112.55 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.034141 s, Result = 07080000, Performance = 113.22 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.034872 s, Result = 07300000, Performance = 113.31 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.035498 s, Result = 07580000, Performance = 113.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.036470 s, Result = 07800000, Performance = 113.06 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036747 s, Result = 07a80000, Performance = 114.54 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.037595 s, Result = 07d00000, Performance = 114.24 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.037845 s, Result = 07f80000, Performance = 115.76 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.038417 s, Result = 08200000, Performance = 116.27 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.039263 s, Result = 08480000, Performance = 115.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.039903 s, Result = 08700000, Performance = 116.25 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.040628 s, Result = 08980000, Performance = 116.29 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.040125 s, Result = 08c00000, Performance = 119.88 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.041821 s, Result = 08e80000, Performance = 117.08 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.042365 s, Result = 09100000, Performance = 117.60 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.043283 s, Result = 09380000, Performance = 117.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.043156 s, Result = 09600000, Performance = 119.43 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.044045 s, Result = 09880000, Performance = 118.97 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044693 s, Result = 09b00000, Performance = 119.16 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.045124 s, Result = 09d80000, Performance = 119.93 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046473 s, Result = 0a000000, Performance = 118.30 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   309   499  1344
Test passed: M N K =   105  1631  1920
Test passed: M N K =  1204    98  1792
Test passed: M N K =  1248   621   832
Test passed: M N K =  2017   189   128
M N K =  4096  4096   256, Elapsed time =   0.006458 s, Result = a0c80000, Performance =  13.30 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006542 s, Result = a0f00000, Performance =  26.26 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007028 s, Result = a1180000, Performance =  36.67 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007290 s, Result = a1400000, Performance =  47.13 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007944 s, Result = a1680000, Performance =  54.07 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008343 s, Result = a1900000, Performance =  61.78 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008974 s, Result = a1b80000, Performance =  67.00 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014185 s, Result = a1e00000, Performance =  48.44 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009887 s, Result = a2080000, Performance =  78.19 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010984 s, Result = a2300000, Performance =  78.21 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.011631 s, Result = a2580000, Performance =  81.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012132 s, Result = a2800000, Performance =  84.96 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.012636 s, Result = a2a80000, Performance =  88.38 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.013309 s, Result = a2d00000, Performance =  90.36 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014054 s, Result = a2f80000, Performance =  91.68 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014540 s, Result = a3200000, Performance =  94.53 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015248 s, Result = a3480000, Performance =  95.77 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.015637 s, Result = a3700000, Performance =  98.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.016567 s, Result = a3980000, Performance =  98.51 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017001 s, Result = a3c00000, Performance = 101.05 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017644 s, Result = a3e80000, Performance = 102.24 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018408 s, Result = a4100000, Performance = 102.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018897 s, Result = a4380000, Performance = 104.55 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018821 s, Result = a4600000, Performance = 109.54 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019889 s, Result = a4880000, Performance = 107.97 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020676 s, Result = a4b00000, Performance = 108.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021023 s, Result = a4d80000, Performance = 110.32 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021748 s, Result = a5000000, Performance = 110.59 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022067 s, Result = a5280000, Performance = 112.89 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022917 s, Result = a5500000, Performance = 112.45 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023329 s, Result = a5780000, Performance = 114.15 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023886 s, Result = a5a00000, Performance = 115.08 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024362 s, Result = a5c80000, Performance = 116.36 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024885 s, Result = a5f00000, Performance = 117.36 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025957 s, Result = a6180000, Performance = 115.83 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026616 s, Result = a6400000, Performance = 116.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027009 s, Result = a6680000, Performance = 117.67 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.027425 s, Result = a6900000, Performance = 119.02 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.028447 s, Result = a6b80000, Performance = 117.76 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028326 s, Result = a6e00000, Performance = 121.30 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.029571 s, Result = a7080000, Performance = 119.10 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.029889 s, Result = a7300000, Performance = 120.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030670 s, Result = a7580000, Performance = 120.43 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031568 s, Result = a7800000, Performance = 119.73 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.031450 s, Result = a7a80000, Performance = 122.91 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.032258 s, Result = a7d00000, Performance = 122.49 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032800 s, Result = a7f80000, Performance = 123.09 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033551 s, Result = a8200000, Performance = 122.89 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034005 s, Result = a8480000, Performance = 123.78 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034771 s, Result = a8700000, Performance = 123.52 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035593 s, Result = a8980000, Performance = 123.08 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036059 s, Result = a8c00000, Performance = 123.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.036598 s, Result = a8e80000, Performance = 124.40 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037264 s, Result = a9100000, Performance = 124.48 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.038067 s, Result = a9380000, Performance = 124.11 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.037983 s, Result = a9600000, Performance = 126.65 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.038959 s, Result = a9880000, Performance = 125.68 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.039891 s, Result = a9b00000, Performance = 124.89 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.040629 s, Result = a9d80000, Performance = 124.74 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.041017 s, Result = aa000000, Performance = 125.65 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.041826 s, Result = aa280000, Performance = 125.28 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.041861 s, Result = aa500000, Performance = 127.23 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.042710 s, Result = aa780000, Performance = 126.71 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.043390 s, Result = aaa00000, Performance = 126.70 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  2041   678   832
Test passed: M N K =   273   705  1600
Test passed: M N K =   988   760   448
Test passed: M N K =   616  1113  1920
Test passed: M N K =   906  1232   960
M N K =  4096  4096   256, Elapsed time =   0.000778 s, Result = 00280000, Performance = 110.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001673 s, Result = 00500000, Performance = 102.71 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002419 s, Result = 00780000, Performance = 106.52 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003149 s, Result = 00a00000, Performance = 109.13 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003516 s, Result = 00c80000, Performance = 122.15 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004242 s, Result = 00f00000, Performance = 121.50 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004872 s, Result = 01180000, Performance = 123.41 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005439 s, Result = 01400000, Performance = 126.35 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005905 s, Result = 01680000, Performance = 130.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006765 s, Result = 01900000, Performance = 126.98 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.007545 s, Result = 01b80000, Performance = 125.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008226 s, Result = 01e00000, Performance = 125.31 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.008777 s, Result = 02080000, Performance = 127.23 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.009397 s, Result = 02300000, Performance = 127.98 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010143 s, Result = 02580000, Performance = 127.03 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.010640 s, Result = 02800000, Performance = 129.18 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.012712 s, Result = 02a80000, Performance = 114.87 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.011788 s, Result = 02d00000, Performance = 131.16 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012542 s, Result = 02f80000, Performance = 130.13 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.013196 s, Result = 03200000, Performance = 130.19 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.013331 s, Result = 03480000, Performance = 135.32 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014072 s, Result = 03700000, Performance = 134.29 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014741 s, Result = 03980000, Performance = 134.03 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.014988 s, Result = 03c00000, Performance = 137.55 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015735 s, Result = 03e80000, Performance = 136.48 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016789 s, Result = 04100000, Performance = 133.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017073 s, Result = 04380000, Performance = 135.85 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.017331 s, Result = 04600000, Performance = 138.78 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018129 s, Result = 04880000, Performance = 137.41 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018837 s, Result = 04b00000, Performance = 136.80 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.019403 s, Result = 04d80000, Performance = 137.24 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.019705 s, Result = 05000000, Performance = 139.49 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.020538 s, Result = 05280000, Performance = 138.02 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020856 s, Result = 05500000, Performance = 140.04 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.021553 s, Result = 05780000, Performance = 139.49 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022009 s, Result = 05a00000, Performance = 140.50 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.022598 s, Result = 05c80000, Performance = 140.65 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.023343 s, Result = 05f00000, Performance = 139.84 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024278 s, Result = 06180000, Performance = 137.99 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024278 s, Result = 06400000, Performance = 141.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025049 s, Result = 06680000, Performance = 140.60 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026001 s, Result = 06900000, Performance = 138.76 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026781 s, Result = 06b80000, Performance = 137.92 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026879 s, Result = 06e00000, Performance = 140.62 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027453 s, Result = 07080000, Performance = 140.80 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.027558 s, Result = 07300000, Performance = 143.38 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028874 s, Result = 07580000, Performance = 139.82 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.029493 s, Result = 07800000, Performance = 139.80 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029377 s, Result = 07a80000, Performance = 143.28 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.030081 s, Result = 07d00000, Performance = 142.78 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030859 s, Result = 07f80000, Performance = 141.96 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.031777 s, Result = 08200000, Performance = 140.57 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031925 s, Result = 08480000, Performance = 142.61 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032627 s, Result = 08700000, Performance = 142.17 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.032973 s, Result = 08980000, Performance = 143.28 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.033143 s, Result = 08c00000, Performance = 145.14 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.034103 s, Result = 08e80000, Performance = 143.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.034668 s, Result = 09100000, Performance = 143.71 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.035872 s, Result = 09380000, Performance = 141.28 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.036701 s, Result = 09600000, Performance = 140.43 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.036227 s, Result = 09880000, Performance = 144.64 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.037038 s, Result = 09b00000, Performance = 143.79 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.037834 s, Result = 09d80000, Performance = 143.04 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038788 s, Result = 0a000000, Performance = 141.73 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1625  1672  1664
Test passed: M N K =   502   551   384
Test passed: M N K =   553   553  1408
Test passed: M N K =  1764  1183  1728
Test passed: M N K =   435  1999  1216
M N K =  4096  4096   256, Elapsed time =   0.007443 s, Result = 902e0000, Performance =  11.54 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008258 s, Result = 104c0000, Performance =  20.80 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009638 s, Result = 906a0000, Performance =  26.74 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010191 s, Result = 10880000, Performance =  33.72 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011160 s, Result = 90a60000, Performance =  38.48 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012158 s, Result = 10c40000, Performance =  42.39 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012101 s, Result = 90e20000, Performance =  49.69 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.012113 s, Result = 11000000, Performance =  56.73 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013351 s, Result = 911e0000, Performance =  57.91 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013164 s, Result = 113c0000, Performance =  65.25 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014204 s, Result = 915a0000, Performance =  66.52 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014575 s, Result = 11780000, Performance =  70.72 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015276 s, Result = 91960000, Performance =  73.10 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017083 s, Result = 11b40000, Performance =  70.40 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016335 s, Result = 91d20000, Performance =  78.88 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016154 s, Result = 11f00000, Performance =  85.08 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016994 s, Result = 920e0000, Performance =  85.93 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017064 s, Result = 122c0000, Performance =  90.61 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017735 s, Result = 924a0000, Performance =  92.03 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018329 s, Result = 12680000, Performance =  93.73 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019182 s, Result = 92860000, Performance =  94.04 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019350 s, Result = 12a40000, Performance =  97.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.025934 s, Result = 92c20000, Performance =  76.18 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019790 s, Result = 12e00000, Performance = 104.17 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020996 s, Result = 92fe0000, Performance = 102.28 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021387 s, Result = 131c0000, Performance = 104.43 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021404 s, Result = 933a0000, Performance = 108.36 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022196 s, Result = 13580000, Performance = 108.36 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022494 s, Result = 93760000, Performance = 110.74 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022614 s, Result = 13940000, Performance = 113.96 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023065 s, Result = 93b20000, Performance = 115.45 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.024122 s, Result = 13d00000, Performance = 113.95 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024276 s, Result = 93ee0000, Performance = 116.77 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.024182 s, Result = 140c0000, Performance = 120.77 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025419 s, Result = 942a0000, Performance = 118.28 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.025516 s, Result = 14480000, Performance = 121.19 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026982 s, Result = 94660000, Performance = 117.79 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.026466 s, Result = 14840000, Performance = 123.33 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027183 s, Result = 94a20000, Performance = 123.24 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028430 s, Result = 14c00000, Performance = 120.86 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028671 s, Result = 94de0000, Performance = 122.84 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.028597 s, Result = 14fc0000, Performance = 126.16 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030265 s, Result = 951a0000, Performance = 122.04 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.030366 s, Result = 15380000, Performance = 124.47 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030993 s, Result = 95560000, Performance = 124.72 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.031803 s, Result = 15740000, Performance = 124.25 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.032166 s, Result = 95920000, Performance = 125.51 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033037 s, Result = 15b00000, Performance = 124.81 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034137 s, Result = 95ce0000, Performance = 123.30 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034572 s, Result = 15ec0000, Performance = 124.23 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035583 s, Result = 960a0000, Performance = 123.12 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.035518 s, Result = 16280000, Performance = 125.76 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.037035 s, Result = 96460000, Performance = 122.93 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037475 s, Result = 16640000, Performance = 123.78 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.038238 s, Result = 96820000, Performance = 123.55 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.038657 s, Result = 16a00000, Performance = 124.44 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.038598 s, Result = 96be0000, Performance = 126.85 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.039857 s, Result = 16dc0000, Performance = 125.00 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.041238 s, Result = 96fa0000, Performance = 122.90 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.041237 s, Result = 17180000, Performance = 124.98 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042541 s, Result = 97360000, Performance = 123.17 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.042512 s, Result = 17540000, Performance = 125.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.044059 s, Result = 97720000, Performance = 122.83 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.045842 s, Result = 17900000, Performance = 119.92 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   329   265  1728
Test passed: M N K =  1581   255  1152
Test passed: M N K =   642  1312   256
Test passed: M N K =   404   261  1664
Test passed: M N K =  1554   927  2048
M N K =  4096  4096   256, Elapsed time =   0.010383 s, Result = 001e0000, Performance =   8.27 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008433 s, Result = 003c0000, Performance =  20.37 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009195 s, Result = 005a0000, Performance =  28.03 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008141 s, Result = 00780000, Performance =  42.20 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009164 s, Result = 00960000, Performance =  46.87 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008800 s, Result = 00b40000, Performance =  58.57 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014737 s, Result = 00d20000, Performance =  40.80 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009238 s, Result = 00f00000, Performance =  74.39 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010214 s, Result = 010e0000, Performance =  75.69 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010465 s, Result = 012c0000, Performance =  82.08 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010979 s, Result = 014a0000, Performance =  86.06 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011510 s, Result = 01680000, Performance =  89.56 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011727 s, Result = 01860000, Performance =  95.22 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012297 s, Result = 01a40000, Performance =  97.79 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012899 s, Result = 01c20000, Performance =  99.89 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012962 s, Result = 01e00000, Performance = 106.03 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018580 s, Result = 01fe0000, Performance =  78.59 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013859 s, Result = 021c0000, Performance = 111.56 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014329 s, Result = 023a0000, Performance = 113.90 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015192 s, Result = 02580000, Performance = 113.09 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015133 s, Result = 02760000, Performance = 119.20 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015911 s, Result = 02940000, Performance = 118.77 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016208 s, Result = 02b20000, Performance = 121.90 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017277 s, Result = 02d00000, Performance = 119.32 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.016950 s, Result = 02ee0000, Performance = 126.70 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017446 s, Result = 030c0000, Performance = 128.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017550 s, Result = 032a0000, Performance = 132.16 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.018623 s, Result = 03480000, Performance = 129.15 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018246 s, Result = 03660000, Performance = 136.53 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.019029 s, Result = 03840000, Performance = 135.42 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.019918 s, Result = 03a20000, Performance = 133.69 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020062 s, Result = 03c00000, Performance = 137.01 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.020475 s, Result = 03de0000, Performance = 138.45 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020592 s, Result = 03fc0000, Performance = 141.83 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.020934 s, Result = 041a0000, Performance = 143.62 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022131 s, Result = 04380000, Performance = 139.73 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.022459 s, Result = 04560000, Performance = 141.51 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.022415 s, Result = 04740000, Performance = 145.63 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.023410 s, Result = 04920000, Performance = 143.10 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024337 s, Result = 04b00000, Performance = 141.18 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.023807 s, Result = 04ce0000, Performance = 147.94 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.024910 s, Result = 04ec0000, Performance = 144.83 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.024723 s, Result = 050a0000, Performance = 149.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.025344 s, Result = 05280000, Performance = 149.13 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.026027 s, Result = 05460000, Performance = 148.52 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.026053 s, Result = 05640000, Performance = 151.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.026979 s, Result = 05820000, Performance = 149.65 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.027465 s, Result = 05a00000, Performance = 150.13 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.028173 s, Result = 05be0000, Performance = 149.40 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.028793 s, Result = 05dc0000, Performance = 149.17 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.028855 s, Result = 05fa0000, Performance = 151.83 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.029673 s, Result = 06180000, Performance = 150.54 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.030563 s, Result = 06360000, Performance = 148.96 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.030830 s, Result = 06540000, Performance = 150.46 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.031738 s, Result = 06720000, Performance = 148.86 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032708 s, Result = 06900000, Performance = 147.07 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.033246 s, Result = 06ae0000, Performance = 147.27 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.034409 s, Result = 06cc0000, Performance = 144.79 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.035488 s, Result = 06ea0000, Performance = 142.81 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.035354 s, Result = 07080000, Performance = 145.78 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.036199 s, Result = 07260000, Performance = 144.75 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.037147 s, Result = 07440000, Performance = 143.37 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.037858 s, Result = 07620000, Performance = 142.95 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038994 s, Result = 07800000, Performance = 140.99 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1981  1421  1664
Test passed: M N K =   432  1265   832
Test passed: M N K =  1758   612  1664
Test passed: M N K =  1441  1800  1536
Test passed: M N K =   826  2019  1152
M N K =  4096  4096   256, Elapsed time =   0.006872 s, Result = a0be0000, Performance =  12.50 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006324 s, Result = a0dc0000, Performance =  27.17 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006828 s, Result = a0fa0000, Performance =  37.74 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007066 s, Result = a1180000, Performance =  48.63 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007284 s, Result = a1360000, Performance =  58.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007825 s, Result = a1540000, Performance =  65.87 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007934 s, Result = a1720000, Performance =  75.79 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008559 s, Result = a1900000, Performance =  80.28 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008601 s, Result = a1ae0000, Performance =  89.89 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009114 s, Result = a1cc0000, Performance =  94.25 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009600 s, Result = a1ea0000, Performance =  98.42 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010157 s, Result = a2080000, Performance = 101.49 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010431 s, Result = a2260000, Performance = 107.05 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.013223 s, Result = a2440000, Performance =  90.95 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011412 s, Result = a2620000, Performance = 112.91 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012790 s, Result = a2800000, Performance = 107.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.012088 s, Result = a29e0000, Performance = 120.81 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.012460 s, Result = a2bc0000, Performance = 124.09 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012814 s, Result = a2da0000, Performance = 127.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.013302 s, Result = a2f80000, Performance = 129.15 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.013868 s, Result = a3160000, Performance = 130.08 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014237 s, Result = a3340000, Performance = 132.73 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015017 s, Result = a3520000, Performance = 131.56 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016556 s, Result = a3700000, Performance = 124.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015543 s, Result = a38e0000, Performance = 138.17 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.015850 s, Result = a3ac0000, Performance = 140.91 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.016408 s, Result = a3ca0000, Performance = 141.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.016939 s, Result = a3e80000, Performance = 141.99 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017236 s, Result = a4060000, Performance = 144.52 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.017631 s, Result = a4240000, Performance = 146.16 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.017861 s, Result = a4420000, Performance = 149.09 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020925 s, Result = a4600000, Performance = 131.36 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.018907 s, Result = a47e0000, Performance = 149.93 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.018912 s, Result = a49c0000, Performance = 154.43 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.019666 s, Result = a4ba0000, Performance = 152.87 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020374 s, Result = a4d80000, Performance = 151.78 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.020206 s, Result = a4f60000, Performance = 157.29 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.020842 s, Result = a5140000, Performance = 156.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.021105 s, Result = a5320000, Performance = 158.73 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.022557 s, Result = a5500000, Performance = 152.32 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.022052 s, Result = a56e0000, Performance = 159.71 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.022641 s, Result = a58c0000, Performance = 159.35 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023135 s, Result = a5aa0000, Performance = 159.66 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.023955 s, Result = a5c80000, Performance = 157.78 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.024041 s, Result = a5e60000, Performance = 160.79 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.024567 s, Result = a6040000, Performance = 160.84 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.024887 s, Result = a6220000, Performance = 162.22 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.027480 s, Result = a6400000, Performance = 150.04 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.026510 s, Result = a65e0000, Performance = 158.77 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.026768 s, Result = a67c0000, Performance = 160.45 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.027102 s, Result = a69a0000, Performance = 161.64 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.027766 s, Result = a6b80000, Performance = 160.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.028012 s, Result = a6d60000, Performance = 162.52 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.028703 s, Result = a6f40000, Performance = 161.61 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.030019 s, Result = a7120000, Performance = 157.38 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.031829 s, Result = a7300000, Performance = 151.13 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.030670 s, Result = a74e0000, Performance = 159.64 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.031965 s, Result = a76c0000, Performance = 155.86 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.032232 s, Result = a78a0000, Performance = 157.24 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.032527 s, Result = a7a80000, Performance = 158.45 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.033364 s, Result = a7c60000, Performance = 157.05 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.033731 s, Result = a7e40000, Performance = 157.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.034633 s, Result = a8020000, Performance = 156.26 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038800 s, Result = a8200000, Performance = 141.69 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   208   890  1664
Test passed: M N K =  1715   807   576
Test passed: M N K =  2001   190  1728
Test passed: M N K =   379  1329  2048
Test passed: M N K =   959   938  1536
M N K =  4096  4096   256, Elapsed time =   0.000824 s, Result = 001e0000, Performance = 104.21 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001546 s, Result = 003c0000, Performance = 111.11 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002180 s, Result = 005a0000, Performance = 118.19 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002740 s, Result = 00780000, Performance = 125.40 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003155 s, Result = 00960000, Performance = 136.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003613 s, Result = 00b40000, Performance = 142.66 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005625 s, Result = 00d20000, Performance = 106.89 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004356 s, Result = 00f00000, Performance = 157.78 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004664 s, Result = 010e0000, Performance = 165.76 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005007 s, Result = 012c0000, Performance = 171.54 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.005539 s, Result = 014a0000, Performance = 170.60 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.006001 s, Result = 01680000, Performance = 171.78 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.006356 s, Result = 01860000, Performance = 175.68 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.006617 s, Result = 01a40000, Performance = 181.73 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.006979 s, Result = 01c20000, Performance = 184.63 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.008660 s, Result = 01e00000, Performance = 158.71 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.007846 s, Result = 01fe0000, Performance = 186.12 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.008186 s, Result = 021c0000, Performance = 188.89 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.008553 s, Result = 023a0000, Performance = 190.81 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.009101 s, Result = 02580000, Performance = 188.78 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.009234 s, Result = 02760000, Performance = 195.35 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.009498 s, Result = 02940000, Performance = 198.97 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.010066 s, Result = 02b20000, Performance = 196.27 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.011996 s, Result = 02d00000, Performance = 171.86 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.010795 s, Result = 02ee0000, Performance = 198.93 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.011307 s, Result = 030c0000, Performance = 197.52 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.011609 s, Result = 032a0000, Performance = 199.78 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.012197 s, Result = 03480000, Performance = 197.20 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.012518 s, Result = 03660000, Performance = 199.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.012725 s, Result = 03840000, Performance = 202.51 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.013265 s, Result = 03a20000, Performance = 200.75 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.014648 s, Result = 03c00000, Performance = 187.66 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.013859 s, Result = 03de0000, Performance = 204.53 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.014017 s, Result = 03fc0000, Performance = 208.35 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.014663 s, Result = 041a0000, Performance = 205.04 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.015487 s, Result = 04380000, Performance = 199.67 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.015461 s, Result = 04560000, Performance = 205.57 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.015976 s, Result = 04740000, Performance = 204.32 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.016224 s, Result = 04920000, Performance = 206.49 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.018755 s, Result = 04b00000, Performance = 183.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.016944 s, Result = 04ce0000, Performance = 207.85 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.017287 s, Result = 04ec0000, Performance = 208.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.018043 s, Result = 050a0000, Performance = 204.71 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.017895 s, Result = 05280000, Performance = 211.21 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.018514 s, Result = 05460000, Performance = 208.78 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.018767 s, Result = 05640000, Performance = 210.55 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.019398 s, Result = 05820000, Performance = 208.12 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.021202 s, Result = 05a00000, Performance = 194.47 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.020429 s, Result = 05be0000, Performance = 206.03 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.020805 s, Result = 05dc0000, Performance = 206.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.021296 s, Result = 05fa0000, Performance = 205.71 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.021625 s, Result = 06180000, Performance = 206.55 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.022697 s, Result = 06360000, Performance = 200.58 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.023136 s, Result = 06540000, Performance = 200.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.023571 s, Result = 06720000, Performance = 200.43 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.024672 s, Result = 06900000, Performance = 194.97 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.024901 s, Result = 06ae0000, Performance = 196.63 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.026227 s, Result = 06cc0000, Performance = 189.96 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.027379 s, Result = 06ea0000, Performance = 185.11 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.026734 s, Result = 07080000, Performance = 192.79 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.028474 s, Result = 07260000, Performance = 184.02 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.028465 s, Result = 07440000, Performance = 187.10 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.029636 s, Result = 07620000, Performance = 182.61 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.031960 s, Result = 07800000, Performance = 172.01 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1173  1284   256
Test passed: M N K =   108   701   832
Test passed: M N K =  1461  1750   448
Test passed: M N K =  1927   246   448
Test passed: M N K =   104  1346   576
M N K =  4096  4096   256, Elapsed time =   0.007274 s, Result = 902e0000, Performance =  11.81 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008663 s, Result = 104c0000, Performance =  19.83 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009716 s, Result = 906a0000, Performance =  26.52 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010519 s, Result = 10880000, Performance =  32.66 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011945 s, Result = 90a60000, Performance =  35.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012362 s, Result = 10c40000, Performance =  41.69 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012604 s, Result = 90e20000, Performance =  47.71 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014927 s, Result = 11000000, Performance =  46.04 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013171 s, Result = 911e0000, Performance =  58.69 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014043 s, Result = 113c0000, Performance =  61.17 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014764 s, Result = 915a0000, Performance =  64.00 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015013 s, Result = 11780000, Performance =  68.66 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015425 s, Result = 91960000, Performance =  72.39 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015783 s, Result = 11b40000, Performance =  76.19 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016432 s, Result = 91d20000, Performance =  78.41 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016476 s, Result = 11f00000, Performance =  83.42 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016752 s, Result = 920e0000, Performance =  87.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017033 s, Result = 122c0000, Performance =  90.77 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017878 s, Result = 924a0000, Performance =  91.29 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018377 s, Result = 12680000, Performance =  93.49 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.019269 s, Result = 92860000, Performance =  93.62 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019704 s, Result = 12a40000, Performance =  95.91 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.020054 s, Result = 92c20000, Performance =  98.52 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020862 s, Result = 12e00000, Performance =  98.82 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020794 s, Result = 92fe0000, Performance = 103.27 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021364 s, Result = 131c0000, Performance = 104.54 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022449 s, Result = 933a0000, Performance = 103.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021919 s, Result = 13580000, Performance = 109.73 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022992 s, Result = 93760000, Performance = 108.35 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.023201 s, Result = 13940000, Performance = 111.07 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023238 s, Result = 93b20000, Performance = 114.59 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025134 s, Result = 13d00000, Performance = 109.36 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.023900 s, Result = 93ee0000, Performance = 118.60 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025170 s, Result = 140c0000, Performance = 116.03 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025063 s, Result = 942a0000, Performance = 119.96 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.025683 s, Result = 14480000, Performance = 120.41 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026500 s, Result = 94660000, Performance = 119.93 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.026711 s, Result = 14840000, Performance = 122.20 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027178 s, Result = 94a20000, Performance = 123.26 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028887 s, Result = 14c00000, Performance = 118.94 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.027789 s, Result = 94de0000, Performance = 126.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.029665 s, Result = 14fc0000, Performance = 121.62 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029916 s, Result = 951a0000, Performance = 123.47 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.029703 s, Result = 15380000, Performance = 127.25 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.031070 s, Result = 95560000, Performance = 124.41 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.031208 s, Result = 15740000, Performance = 126.62 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.031345 s, Result = 95920000, Performance = 128.80 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033876 s, Result = 15b00000, Performance = 121.71 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.032145 s, Result = 95ce0000, Performance = 130.94 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.033702 s, Result = 15ec0000, Performance = 127.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.033966 s, Result = 960a0000, Performance = 128.98 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.033975 s, Result = 16280000, Performance = 131.47 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.035055 s, Result = 96460000, Performance = 129.87 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.035475 s, Result = 16640000, Performance = 130.76 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.036802 s, Result = 96820000, Performance = 128.38 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.037579 s, Result = 16a00000, Performance = 128.01 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.037286 s, Result = 96be0000, Performance = 131.32 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.038006 s, Result = 16dc0000, Performance = 131.09 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.038935 s, Result = 96fa0000, Performance = 130.17 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.039174 s, Result = 17180000, Performance = 131.56 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.041352 s, Result = 97360000, Performance = 126.71 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.040435 s, Result = 17540000, Performance = 131.71 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.042652 s, Result = 97720000, Performance = 126.88 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.043173 s, Result = 17900000, Performance = 127.34 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   681   380  1984
Test passed: M N K =  1578   233   640
Test passed: M N K =  1764  1065  1088
Test passed: M N K =  1279  1231  1280
Test passed: M N K =  1304   578   640
M N K =  4096  4096   256, Elapsed time =   0.010299 s, Result = 001e0000, Performance =   8.34 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008072 s, Result = 003c0000, Performance =  21.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009028 s, Result = 005a0000, Performance =  28.54 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008768 s, Result = 00780000, Performance =  39.19 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009388 s, Result = 00960000, Performance =  45.75 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009321 s, Result = 00b40000, Performance =  55.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011608 s, Result = 00d20000, Performance =  51.80 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009983 s, Result = 00f00000, Performance =  68.84 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010464 s, Result = 010e0000, Performance =  73.88 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011571 s, Result = 012c0000, Performance =  74.24 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.011451 s, Result = 014a0000, Performance =  82.51 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012062 s, Result = 01680000, Performance =  85.46 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.012754 s, Result = 01860000, Performance =  87.56 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012886 s, Result = 01a40000, Performance =  93.33 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013823 s, Result = 01c20000, Performance =  93.21 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013661 s, Result = 01e00000, Performance = 100.60 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.014060 s, Result = 01fe0000, Performance = 103.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.015361 s, Result = 021c0000, Performance = 100.66 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014403 s, Result = 023a0000, Performance = 113.32 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015861 s, Result = 02580000, Performance = 108.32 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.016349 s, Result = 02760000, Performance = 110.33 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.016076 s, Result = 02940000, Performance = 117.55 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.017173 s, Result = 02b20000, Performance = 115.05 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017346 s, Result = 02d00000, Performance = 118.85 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017597 s, Result = 02ee0000, Performance = 122.04 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.018985 s, Result = 030c0000, Performance = 117.64 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017988 s, Result = 032a0000, Performance = 128.94 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019673 s, Result = 03480000, Performance = 122.26 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019032 s, Result = 03660000, Performance = 130.89 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020095 s, Result = 03840000, Performance = 128.24 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020713 s, Result = 03a20000, Performance = 128.56 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020674 s, Result = 03c00000, Performance = 132.96 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021758 s, Result = 03de0000, Performance = 130.29 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.021112 s, Result = 03fc0000, Performance = 138.34 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022063 s, Result = 041a0000, Performance = 136.27 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022733 s, Result = 04380000, Performance = 136.03 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.022422 s, Result = 04560000, Performance = 141.75 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.023212 s, Result = 04740000, Performance = 140.62 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.023969 s, Result = 04920000, Performance = 139.77 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024960 s, Result = 04b00000, Performance = 137.66 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025174 s, Result = 04ce0000, Performance = 139.90 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.024937 s, Result = 04ec0000, Performance = 144.67 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.025244 s, Result = 050a0000, Performance = 146.32 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026039 s, Result = 05280000, Performance = 145.15 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.025841 s, Result = 05460000, Performance = 149.59 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.026778 s, Result = 05640000, Performance = 147.56 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.026929 s, Result = 05820000, Performance = 149.92 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028841 s, Result = 05a00000, Performance = 142.96 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.028347 s, Result = 05be0000, Performance = 148.48 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.028397 s, Result = 05dc0000, Performance = 151.25 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.028872 s, Result = 05fa0000, Performance = 151.73 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.029810 s, Result = 06180000, Performance = 149.84 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.029646 s, Result = 06360000, Performance = 153.57 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.031165 s, Result = 06540000, Performance = 148.84 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.030779 s, Result = 06720000, Performance = 153.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032705 s, Result = 06900000, Performance = 147.08 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.031703 s, Result = 06ae0000, Performance = 154.44 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.032428 s, Result = 06cc0000, Performance = 153.64 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.033102 s, Result = 06ea0000, Performance = 153.10 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.033568 s, Result = 07080000, Performance = 153.54 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.034141 s, Result = 07260000, Performance = 153.48 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035206 s, Result = 07440000, Performance = 151.27 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.035350 s, Result = 07620000, Performance = 153.09 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.037347 s, Result = 07800000, Performance = 147.20 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    22  1343   704
Test passed: M N K =  1054   206  1792
Test passed: M N K =  1135  1124  1472
Test passed: M N K =   226  1494   640
Test passed: M N K =  1529  1261   576
M N K =  4096  4096   256, Elapsed time =   0.006726 s, Result = a0be0000, Performance =  12.77 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006130 s, Result = a0dc0000, Performance =  28.03 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006844 s, Result = a0fa0000, Performance =  37.65 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007236 s, Result = a1180000, Performance =  47.49 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007463 s, Result = a1360000, Performance =  57.55 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008060 s, Result = a1540000, Performance =  63.95 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008516 s, Result = a1720000, Performance =  70.61 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008779 s, Result = a1900000, Performance =  78.28 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009389 s, Result = a1ae0000, Performance =  82.34 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009825 s, Result = a1cc0000, Performance =  87.43 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010125 s, Result = a1ea0000, Performance =  93.33 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010916 s, Result = a2080000, Performance =  94.43 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011244 s, Result = a2260000, Performance =  99.32 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011848 s, Result = a2440000, Performance = 101.50 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012363 s, Result = a2620000, Performance = 104.23 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013260 s, Result = a2800000, Performance = 103.65 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013262 s, Result = a29e0000, Performance = 110.11 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013416 s, Result = a2bc0000, Performance = 115.25 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013979 s, Result = a2da0000, Performance = 116.75 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014100 s, Result = a2f80000, Performance = 121.85 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014797 s, Result = a3160000, Performance = 121.91 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015180 s, Result = a3340000, Performance = 124.49 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015417 s, Result = a3520000, Performance = 128.15 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016535 s, Result = a3700000, Performance = 124.68 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.016249 s, Result = a38e0000, Performance = 132.16 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016808 s, Result = a3ac0000, Performance = 132.88 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017311 s, Result = a3ca0000, Performance = 133.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.017529 s, Result = a3e80000, Performance = 137.21 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018094 s, Result = a4060000, Performance = 137.67 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018619 s, Result = a4240000, Performance = 138.40 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.018566 s, Result = a4420000, Performance = 143.43 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020951 s, Result = a4600000, Performance = 131.20 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.019483 s, Result = a47e0000, Performance = 145.50 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020432 s, Result = a49c0000, Performance = 142.94 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.020578 s, Result = a4ba0000, Performance = 146.10 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020591 s, Result = a4d80000, Performance = 150.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.021240 s, Result = a4f60000, Performance = 149.64 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.022073 s, Result = a5140000, Performance = 147.88 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.022399 s, Result = a5320000, Performance = 149.56 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.023402 s, Result = a5500000, Performance = 146.82 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.022463 s, Result = a56e0000, Performance = 156.79 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.023567 s, Result = a58c0000, Performance = 153.09 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023778 s, Result = a5aa0000, Performance = 155.34 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.024180 s, Result = a5c80000, Performance = 156.31 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.024496 s, Result = a5e60000, Performance = 157.80 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.024964 s, Result = a6040000, Performance = 158.29 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.025717 s, Result = a6220000, Performance = 156.99 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028096 s, Result = a6400000, Performance = 146.75 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.026140 s, Result = a65e0000, Performance = 161.02 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.026876 s, Result = a67c0000, Performance = 159.81 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.027082 s, Result = a69a0000, Performance = 161.76 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.027734 s, Result = a6b80000, Performance = 161.06 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.028161 s, Result = a6d60000, Performance = 161.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.028619 s, Result = a6f40000, Performance = 162.08 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.028873 s, Result = a7120000, Performance = 163.63 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.031057 s, Result = a7300000, Performance = 154.89 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.029803 s, Result = a74e0000, Performance = 164.29 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.030797 s, Result = a76c0000, Performance = 161.77 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.030955 s, Result = a78a0000, Performance = 163.72 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.031691 s, Result = a7a80000, Performance = 162.63 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.032104 s, Result = a7c60000, Performance = 163.22 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.032587 s, Result = a7e40000, Performance = 163.43 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.033413 s, Result = a8020000, Performance = 161.96 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.036413 s, Result = a8200000, Performance = 150.98 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    52   828   384
Test passed: M N K =  1016  1327  1984
Test passed: M N K =  2040   411  1152
Test passed: M N K =     7  1136  1728
Test passed: M N K =   761  1821  1600
M N K =  4096  4096   256, Elapsed time =   0.000767 s, Result = 001e0000, Performance = 112.07 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001617 s, Result = 003c0000, Performance = 106.26 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002290 s, Result = 005a0000, Performance = 112.51 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002842 s, Result = 00780000, Performance = 120.90 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003250 s, Result = 00960000, Performance = 132.17 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003770 s, Result = 00b40000, Performance = 136.72 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005539 s, Result = 00d20000, Performance = 108.55 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004554 s, Result = 00f00000, Performance = 150.91 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005003 s, Result = 010e0000, Performance = 154.53 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005581 s, Result = 012c0000, Performance = 153.93 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006123 s, Result = 014a0000, Performance = 154.33 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.006461 s, Result = 01680000, Performance = 159.54 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.007041 s, Result = 01860000, Performance = 158.60 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.007605 s, Result = 01a40000, Performance = 158.13 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.007775 s, Result = 01c20000, Performance = 165.72 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.008075 s, Result = 01e00000, Performance = 170.20 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.008331 s, Result = 01fe0000, Performance = 175.29 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.008950 s, Result = 021c0000, Performance = 172.76 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.009494 s, Result = 023a0000, Performance = 171.90 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.009708 s, Result = 02580000, Performance = 176.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.010281 s, Result = 02760000, Performance = 175.46 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.010734 s, Result = 02940000, Performance = 176.06 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.010926 s, Result = 02b20000, Performance = 180.83 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.011813 s, Result = 02d00000, Performance = 174.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.011871 s, Result = 02ee0000, Performance = 180.90 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.012240 s, Result = 030c0000, Performance = 182.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.012511 s, Result = 032a0000, Performance = 185.38 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.012953 s, Result = 03480000, Performance = 185.68 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.013440 s, Result = 03660000, Performance = 185.35 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.014045 s, Result = 03840000, Performance = 183.48 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.014306 s, Result = 03a20000, Performance = 186.14 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.015305 s, Result = 03c00000, Performance = 179.60 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.014973 s, Result = 03de0000, Performance = 189.32 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.015495 s, Result = 03fc0000, Performance = 188.49 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.015948 s, Result = 041a0000, Performance = 188.52 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.015848 s, Result = 04380000, Performance = 195.13 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.016697 s, Result = 04560000, Performance = 190.35 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.017104 s, Result = 04740000, Performance = 190.84 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.017323 s, Result = 04920000, Performance = 193.39 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.018473 s, Result = 04b00000, Performance = 186.00 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.018213 s, Result = 04ce0000, Performance = 193.37 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.018603 s, Result = 04ec0000, Performance = 193.94 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.018865 s, Result = 050a0000, Performance = 195.80 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.019155 s, Result = 05280000, Performance = 197.31 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.019528 s, Result = 05460000, Performance = 197.95 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.020255 s, Result = 05640000, Performance = 195.08 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.019987 s, Result = 05820000, Performance = 201.99 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.022494 s, Result = 05a00000, Performance = 183.30 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.021053 s, Result = 05be0000, Performance = 199.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.021858 s, Result = 05dc0000, Performance = 196.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.021846 s, Result = 05fa0000, Performance = 200.53 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.022151 s, Result = 06180000, Performance = 201.65 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.022744 s, Result = 06360000, Performance = 200.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.023465 s, Result = 06540000, Performance = 197.68 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.023838 s, Result = 06720000, Performance = 198.19 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.025763 s, Result = 06900000, Performance = 186.71 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.024324 s, Result = 06ae0000, Performance = 201.30 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.025691 s, Result = 06cc0000, Performance = 193.93 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.025540 s, Result = 06ea0000, Performance = 198.44 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.026144 s, Result = 07080000, Performance = 197.14 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.026525 s, Result = 07260000, Performance = 197.55 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.026935 s, Result = 07440000, Performance = 197.73 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.027625 s, Result = 07620000, Performance = 195.90 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.030530 s, Result = 07800000, Performance = 180.07 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1321  1867    64
Test passed: M N K =   320  1610  2048
Test passed: M N K =  1255  1355  1536
Test passed: M N K =  1673  1656  1792
Test passed: M N K =   657  1493  1216
M N K =  4096  4096   256, Elapsed time =   0.007642 s, Result = 902e0000, Performance =  11.24 TOPS
M N K =  4096  4096   512, Elapsed time =   0.008303 s, Result = 104c0000, Performance =  20.69 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009130 s, Result = 906a0000, Performance =  28.22 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010924 s, Result = 10880000, Performance =  31.45 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010644 s, Result = 90a60000, Performance =  40.35 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012211 s, Result = 10c40000, Performance =  42.21 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012956 s, Result = 90e20000, Performance =  46.41 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011922 s, Result = 11000000, Performance =  57.64 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013959 s, Result = 911e0000, Performance =  55.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013395 s, Result = 113c0000, Performance =  64.13 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014941 s, Result = 915a0000, Performance =  63.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015525 s, Result = 11780000, Performance =  66.40 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015181 s, Result = 91960000, Performance =  73.56 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016338 s, Result = 11b40000, Performance =  73.61 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016696 s, Result = 91d20000, Performance =  77.17 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016224 s, Result = 11f00000, Performance =  84.72 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017884 s, Result = 920e0000, Performance =  81.65 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018048 s, Result = 122c0000, Performance =  85.67 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018397 s, Result = 924a0000, Performance =  88.72 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019427 s, Result = 12680000, Performance =  88.43 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018966 s, Result = 92860000, Performance =  95.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020275 s, Result = 12a40000, Performance =  93.21 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021485 s, Result = 92c20000, Performance =  91.96 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020751 s, Result = 12e00000, Performance =  99.35 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022551 s, Result = 92fe0000, Performance =  95.23 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021592 s, Result = 131c0000, Performance = 103.43 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022345 s, Result = 933a0000, Performance = 103.80 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023684 s, Result = 13580000, Performance = 101.55 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.023430 s, Result = 93760000, Performance = 106.32 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024543 s, Result = 13940000, Performance = 105.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.025077 s, Result = 93b20000, Performance = 106.19 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.024350 s, Result = 13d00000, Performance = 112.89 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.026408 s, Result = 93ee0000, Performance = 107.34 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026410 s, Result = 140c0000, Performance = 110.58 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.027202 s, Result = 942a0000, Performance = 110.52 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.027150 s, Result = 14480000, Performance = 113.90 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027923 s, Result = 94660000, Performance = 113.82 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028550 s, Result = 14840000, Performance = 114.33 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.029356 s, Result = 94a20000, Performance = 114.12 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.028936 s, Result = 14c00000, Performance = 118.74 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030474 s, Result = 94de0000, Performance = 115.57 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.030580 s, Result = 14fc0000, Performance = 117.98 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032129 s, Result = 951a0000, Performance = 114.96 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031212 s, Result = 15380000, Performance = 121.09 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.032522 s, Result = 95560000, Performance = 118.86 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.033554 s, Result = 15740000, Performance = 117.76 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.033493 s, Result = 95920000, Performance = 120.54 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.033338 s, Result = 15b00000, Performance = 123.68 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034342 s, Result = 95ce0000, Performance = 122.56 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.035371 s, Result = 15ec0000, Performance = 121.43 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035882 s, Result = 960a0000, Performance = 122.09 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036187 s, Result = 16280000, Performance = 123.44 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.037111 s, Result = 96460000, Performance = 122.68 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037731 s, Result = 16640000, Performance = 122.94 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.038439 s, Result = 96820000, Performance = 122.91 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.038500 s, Result = 16a00000, Performance = 124.94 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039423 s, Result = 96be0000, Performance = 124.20 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.039972 s, Result = 16dc0000, Performance = 124.64 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.040588 s, Result = 96fa0000, Performance = 124.87 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.040783 s, Result = 17180000, Performance = 126.38 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.041683 s, Result = 97360000, Performance = 125.71 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.042391 s, Result = 17540000, Performance = 125.63 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.042624 s, Result = 97720000, Performance = 126.96 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.043120 s, Result = 17900000, Performance = 127.49 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1179   999   448
Test passed: M N K =  1888  1496   704
Test passed: M N K =   595   512  1408
Test passed: M N K =   832   889  1280
Test passed: M N K =   735   485   384
M N K =  4096  4096   256, Elapsed time =   0.010082 s, Result = 001e0000, Performance =   8.52 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007283 s, Result = 003c0000, Performance =  23.59 TOPS
M N K =  4096  4096   768, Elapsed time =   0.008590 s, Result = 005a0000, Performance =  30.00 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008075 s, Result = 00780000, Performance =  42.55 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009064 s, Result = 00960000, Performance =  47.38 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009274 s, Result = 00b40000, Performance =  55.57 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010697 s, Result = 00d20000, Performance =  56.21 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009052 s, Result = 00f00000, Performance =  75.92 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010281 s, Result = 010e0000, Performance =  75.19 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010745 s, Result = 012c0000, Performance =  79.95 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012208 s, Result = 014a0000, Performance =  77.40 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011867 s, Result = 01680000, Performance =  86.87 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.012471 s, Result = 01860000, Performance =  89.54 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.013332 s, Result = 01a40000, Performance =  90.21 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013471 s, Result = 01c20000, Performance =  95.65 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013970 s, Result = 01e00000, Performance =  98.38 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018445 s, Result = 01fe0000, Performance =  79.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014983 s, Result = 021c0000, Performance = 103.20 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.016125 s, Result = 023a0000, Performance = 101.21 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.016047 s, Result = 02580000, Performance = 107.06 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017336 s, Result = 02760000, Performance = 104.05 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017467 s, Result = 02940000, Performance = 108.19 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018189 s, Result = 02b20000, Performance = 108.62 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018420 s, Result = 02d00000, Performance = 111.92 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.018797 s, Result = 02ee0000, Performance = 114.25 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019026 s, Result = 030c0000, Performance = 117.39 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020178 s, Result = 032a0000, Performance = 114.94 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020130 s, Result = 03480000, Performance = 119.48 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020949 s, Result = 03660000, Performance = 118.91 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.021479 s, Result = 03840000, Performance = 119.98 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022062 s, Result = 03a20000, Performance = 120.70 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021660 s, Result = 03c00000, Performance = 126.90 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.022964 s, Result = 03de0000, Performance = 123.44 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.023424 s, Result = 03fc0000, Performance = 124.68 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.024177 s, Result = 041a0000, Performance = 124.35 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.024187 s, Result = 04380000, Performance = 127.85 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.025458 s, Result = 04560000, Performance = 124.84 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.025317 s, Result = 04740000, Performance = 128.93 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.026128 s, Result = 04920000, Performance = 128.22 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.026225 s, Result = 04b00000, Performance = 131.02 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.027235 s, Result = 04ce0000, Performance = 129.31 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.028185 s, Result = 04ec0000, Performance = 128.00 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.027819 s, Result = 050a0000, Performance = 132.77 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.028364 s, Result = 05280000, Performance = 133.25 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.029391 s, Result = 05460000, Performance = 131.52 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.029614 s, Result = 05640000, Performance = 133.43 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.030201 s, Result = 05820000, Performance = 133.68 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.029472 s, Result = 05a00000, Performance = 139.90 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.031220 s, Result = 05be0000, Performance = 134.82 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.031649 s, Result = 05dc0000, Performance = 135.70 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.031762 s, Result = 05fa0000, Performance = 137.93 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.032166 s, Result = 06180000, Performance = 138.86 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.033502 s, Result = 06360000, Performance = 135.89 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.033529 s, Result = 06540000, Performance = 138.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.034377 s, Result = 06720000, Performance = 137.43 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.033986 s, Result = 06900000, Performance = 141.54 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.035098 s, Result = 06ae0000, Performance = 139.50 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.035681 s, Result = 06cc0000, Performance = 139.63 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.036295 s, Result = 06ea0000, Performance = 139.64 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.036603 s, Result = 07080000, Performance = 140.81 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.037422 s, Result = 07260000, Performance = 140.02 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.037708 s, Result = 07440000, Performance = 141.24 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.038514 s, Result = 07620000, Performance = 140.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.037646 s, Result = 07800000, Performance = 146.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   864   816   512
Test passed: M N K =  1768   432   576
Test passed: M N K =  1040  1022   768
Test passed: M N K =   789  1747   960
Test passed: M N K =   214   377  1152
M N K =  4096  4096   256, Elapsed time =   0.006905 s, Result = a0be0000, Performance =  12.44 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006308 s, Result = a0dc0000, Performance =  27.24 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007036 s, Result = a0fa0000, Performance =  36.63 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007035 s, Result = a1180000, Performance =  48.84 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007506 s, Result = a1360000, Performance =  57.22 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007972 s, Result = a1540000, Performance =  64.65 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008536 s, Result = a1720000, Performance =  70.45 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.012011 s, Result = a1900000, Performance =  57.21 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009311 s, Result = a1ae0000, Performance =  83.03 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010103 s, Result = a1cc0000, Performance =  85.02 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010677 s, Result = a1ea0000, Performance =  88.50 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011163 s, Result = a2080000, Performance =  92.34 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011831 s, Result = a2260000, Performance =  94.39 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012119 s, Result = a2440000, Performance =  99.23 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012695 s, Result = a2620000, Performance = 101.50 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012885 s, Result = a2800000, Performance = 106.66 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013898 s, Result = a29e0000, Performance = 105.07 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014116 s, Result = a2bc0000, Performance = 109.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.015089 s, Result = a2da0000, Performance = 108.16 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015170 s, Result = a2f80000, Performance = 113.25 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015481 s, Result = a3160000, Performance = 116.52 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.016287 s, Result = a3340000, Performance = 116.03 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016601 s, Result = a3520000, Performance = 119.01 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017030 s, Result = a3700000, Performance = 121.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017656 s, Result = a38e0000, Performance = 121.63 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017970 s, Result = a3ac0000, Performance = 124.28 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018634 s, Result = a3ca0000, Performance = 124.46 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019030 s, Result = a3e80000, Performance = 126.39 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019683 s, Result = a4060000, Performance = 126.56 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.019849 s, Result = a4240000, Performance = 129.83 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020402 s, Result = a4420000, Performance = 130.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020847 s, Result = a4600000, Performance = 131.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021598 s, Result = a47e0000, Performance = 131.25 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.021757 s, Result = a49c0000, Performance = 134.24 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022642 s, Result = a4ba0000, Performance = 132.78 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022711 s, Result = a4d80000, Performance = 136.16 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023547 s, Result = a4f60000, Performance = 134.97 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.023734 s, Result = a5140000, Performance = 137.53 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024493 s, Result = a5320000, Performance = 136.78 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024377 s, Result = a5500000, Performance = 140.95 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025501 s, Result = a56e0000, Performance = 138.11 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026040 s, Result = a58c0000, Performance = 138.55 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026759 s, Result = a5aa0000, Performance = 138.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026924 s, Result = a5c80000, Performance = 140.38 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027387 s, Result = a5e60000, Performance = 141.14 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.027647 s, Result = a6040000, Performance = 142.92 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028527 s, Result = a6220000, Performance = 141.53 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028103 s, Result = a6400000, Performance = 146.72 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029228 s, Result = a65e0000, Performance = 144.01 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029761 s, Result = a67c0000, Performance = 144.32 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030599 s, Result = a69a0000, Performance = 143.17 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030507 s, Result = a6b80000, Performance = 146.42 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031796 s, Result = a6d60000, Performance = 143.19 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.031903 s, Result = a6f40000, Performance = 145.40 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.032549 s, Result = a7120000, Performance = 145.15 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032614 s, Result = a7300000, Performance = 147.49 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.033443 s, Result = a74e0000, Performance = 146.41 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.034166 s, Result = a76c0000, Performance = 145.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.034759 s, Result = a78a0000, Performance = 145.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.034995 s, Result = a7a80000, Performance = 147.28 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.035307 s, Result = a7c60000, Performance = 148.41 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035876 s, Result = a7e40000, Performance = 148.45 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.036495 s, Result = a8020000, Performance = 148.28 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.036222 s, Result = a8200000, Performance = 151.77 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   989   267   960
Test passed: M N K =   995  1378   960
Test passed: M N K =  1524   149  1536
Test passed: M N K =  1181   879   704
Test passed: M N K =   690    55   192
M N K =  4096  4096   256, Elapsed time =   0.000752 s, Result = 001e0000, Performance = 114.23 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001537 s, Result = 003c0000, Performance = 111.79 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002213 s, Result = 005a0000, Performance = 116.43 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002833 s, Result = 00780000, Performance = 121.29 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003235 s, Result = 00960000, Performance = 132.75 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003672 s, Result = 00b40000, Performance = 140.35 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004167 s, Result = 00d20000, Performance = 144.32 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004565 s, Result = 00f00000, Performance = 150.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005157 s, Result = 010e0000, Performance = 149.91 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005754 s, Result = 012c0000, Performance = 149.28 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006412 s, Result = 014a0000, Performance = 147.35 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.006832 s, Result = 01680000, Performance = 150.88 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.007332 s, Result = 01860000, Performance = 152.31 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.007770 s, Result = 01a40000, Performance = 154.77 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.008306 s, Result = 01c20000, Performance = 155.12 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.008322 s, Result = 01e00000, Performance = 165.14 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.009122 s, Result = 01fe0000, Performance = 160.08 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014177 s, Result = 021c0000, Performance = 109.06 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.010505 s, Result = 023a0000, Performance = 155.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.010885 s, Result = 02580000, Performance = 157.83 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.011130 s, Result = 02760000, Performance = 162.07 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.011767 s, Result = 02940000, Performance = 160.60 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.012248 s, Result = 02b20000, Performance = 161.31 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.012400 s, Result = 02d00000, Performance = 166.26 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.013143 s, Result = 02ee0000, Performance = 163.40 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.013487 s, Result = 030c0000, Performance = 165.59 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.014094 s, Result = 032a0000, Performance = 164.56 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.014785 s, Result = 03480000, Performance = 162.68 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.014975 s, Result = 03660000, Performance = 166.35 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.015575 s, Result = 03840000, Performance = 165.46 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.015869 s, Result = 03a20000, Performance = 167.80 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.015743 s, Result = 03c00000, Performance = 174.61 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.017091 s, Result = 03de0000, Performance = 165.86 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.017292 s, Result = 03fc0000, Performance = 168.89 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.017978 s, Result = 041a0000, Performance = 167.23 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.018513 s, Result = 04380000, Performance = 167.04 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.018873 s, Result = 04560000, Performance = 168.40 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.019348 s, Result = 04740000, Performance = 168.71 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.019827 s, Result = 04920000, Performance = 168.96 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.020174 s, Result = 04b00000, Performance = 170.32 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.020778 s, Result = 04ce0000, Performance = 169.50 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.021135 s, Result = 04ec0000, Performance = 170.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.022078 s, Result = 050a0000, Performance = 167.30 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.022157 s, Result = 05280000, Performance = 170.58 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022833 s, Result = 05460000, Performance = 169.29 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.023498 s, Result = 05640000, Performance = 168.16 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.023874 s, Result = 05820000, Performance = 169.10 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.023511 s, Result = 05a00000, Performance = 175.37 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.024289 s, Result = 05be0000, Performance = 173.29 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.024893 s, Result = 05dc0000, Performance = 172.53 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.025566 s, Result = 05fa0000, Performance = 171.35 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.025807 s, Result = 06180000, Performance = 173.08 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.026503 s, Result = 06360000, Performance = 171.78 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.027160 s, Result = 06540000, Performance = 170.79 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.027782 s, Result = 06720000, Performance = 170.05 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.027446 s, Result = 06900000, Performance = 175.27 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.028399 s, Result = 06ae0000, Performance = 172.41 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.029165 s, Result = 06cc0000, Performance = 170.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.029824 s, Result = 06ea0000, Performance = 169.93 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.029356 s, Result = 07080000, Performance = 175.57 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.030534 s, Result = 07260000, Performance = 171.61 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.031020 s, Result = 07440000, Performance = 171.69 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.031043 s, Result = 07620000, Performance = 174.33 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.031275 s, Result = 07800000, Performance = 175.78 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   100   852  1088
Test passed: M N K =  1292  1612  1216
Test passed: M N K =  1456  1309  1472
Test passed: M N K =  1494   618   832
Test passed: M N K =  1881  1883    64
M N K =  4096  4096   256, Elapsed time =   0.011711 s, Result = 50420000, Performance =   7.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012415 s, Result = 90740000, Performance =  13.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013274 s, Result = d0a60000, Performance =  19.41 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013661 s, Result = 10d80000, Performance =  25.15 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014629 s, Result = 510a0000, Performance =  29.36 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.020070 s, Result = 913c0000, Performance =  25.68 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015169 s, Result = d16e0000, Performance =  39.64 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016195 s, Result = 11a00000, Performance =  42.43 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016727 s, Result = 51d20000, Performance =  46.22 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.017122 s, Result = 92040000, Performance =  50.17 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017964 s, Result = d2360000, Performance =  52.60 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.018182 s, Result = 12680000, Performance =  56.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018722 s, Result = 529a0000, Performance =  59.65 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019905 s, Result = 92cc0000, Performance =  60.42 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.020026 s, Result = d2fe0000, Performance =  64.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.021260 s, Result = 13300000, Performance =  64.65 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.021275 s, Result = 53620000, Performance =  68.64 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021882 s, Result = 93940000, Performance =  70.66 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022526 s, Result = d3c60000, Performance =  72.45 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.022920 s, Result = 13f80000, Performance =  74.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.023809 s, Result = 542a0000, Performance =  75.77 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.023946 s, Result = 945c0000, Performance =  78.92 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.025353 s, Result = d48e0000, Performance =  77.93 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.025950 s, Result = 14c00000, Performance =  79.45 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.026305 s, Result = 54f20000, Performance =  81.64 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.026556 s, Result = 95240000, Performance =  84.10 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.028478 s, Result = d5560000, Performance =  81.44 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.028584 s, Result = 15880000, Performance =  84.14 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029347 s, Result = 55ba0000, Performance =  84.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030168 s, Result = 95ec0000, Performance =  85.42 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.030876 s, Result = d61e0000, Performance =  86.24 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031834 s, Result = 16500000, Performance =  86.35 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.032058 s, Result = 56820000, Performance =  88.42 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.032442 s, Result = 96b40000, Performance =  90.03 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.033491 s, Result = d6e60000, Performance =  89.77 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.033939 s, Result = 17180000, Performance =  91.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034500 s, Result = 574a0000, Performance =  92.12 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035171 s, Result = 977c0000, Performance =  92.81 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.036271 s, Result = d7ae0000, Performance =  92.36 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.036958 s, Result = 17e00000, Performance =  92.97 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037592 s, Result = 58120000, Performance =  93.69 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038576 s, Result = 98440000, Performance =  93.52 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039962 s, Result = d8760000, Performance =  92.43 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.039918 s, Result = 18a80000, Performance =  94.68 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.040434 s, Result = 58da0000, Performance =  95.60 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041291 s, Result = 990c0000, Performance =  95.69 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.042428 s, Result = d93e0000, Performance =  95.16 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.043686 s, Result = 19700000, Performance =  94.38 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.044067 s, Result = 59a20000, Performance =  95.52 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.044526 s, Result = 99d40000, Performance =  96.46 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.045528 s, Result = da060000, Performance =  96.22 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.046030 s, Result = 1a380000, Performance =  97.04 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.047063 s, Result = 5a6a0000, Performance =  96.74 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.047795 s, Result = 9a9c0000, Performance =  97.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.048978 s, Result = dace0000, Performance =  96.46 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.049578 s, Result = 1b000000, Performance =  97.03 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.050366 s, Result = 5b320000, Performance =  97.21 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.052203 s, Result = 9b640000, Performance =  95.44 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.053507 s, Result = db960000, Performance =  94.72 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.053133 s, Result = 1bc80000, Performance =  97.00 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.054597 s, Result = 5bfa0000, Performance =  95.97 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.055531 s, Result = 9c2c0000, Performance =  95.91 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.056407 s, Result = dc5e0000, Performance =  95.94 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.057402 s, Result = 1c900000, Performance =  95.77 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    88   737  1408
Test passed: M N K =  1867  1785   448
Test passed: M N K =  1171  1657  1024
Test passed: M N K =  1562  1065  1920
Test passed: M N K =  1261   509    64
M N K =  4096  4096   256, Elapsed time =   0.013284 s, Result = 00320000, Performance =   6.47 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012087 s, Result = 00640000, Performance =  14.21 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013220 s, Result = 00960000, Performance =  19.49 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013324 s, Result = 00c80000, Performance =  25.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013732 s, Result = 00fa0000, Performance =  31.28 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015351 s, Result = 012c0000, Performance =  33.57 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013881 s, Result = 015e0000, Performance =  43.32 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014372 s, Result = 01900000, Performance =  47.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015278 s, Result = 01c20000, Performance =  50.60 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015410 s, Result = 01f40000, Performance =  55.74 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016012 s, Result = 02260000, Performance =  59.01 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016483 s, Result = 02580000, Performance =  62.54 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017018 s, Result = 028a0000, Performance =  65.62 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017624 s, Result = 02bc0000, Performance =  68.24 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.027665 s, Result = 02ee0000, Performance =  46.58 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018724 s, Result = 03200000, Performance =  73.40 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019162 s, Result = 03520000, Performance =  76.21 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019730 s, Result = 03840000, Performance =  78.37 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.019998 s, Result = 03b60000, Performance =  81.61 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020998 s, Result = 03e80000, Performance =  81.82 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021448 s, Result = 041a0000, Performance =  84.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.021896 s, Result = 044c0000, Performance =  86.31 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.022143 s, Result = 047e0000, Performance =  89.23 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.023278 s, Result = 04b00000, Performance =  88.56 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024199 s, Result = 04e20000, Performance =  88.74 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.024528 s, Result = 05140000, Performance =  91.06 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.025470 s, Result = 05460000, Performance =  91.06 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.025936 s, Result = 05780000, Performance =  92.73 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026322 s, Result = 05aa0000, Performance =  94.64 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.027337 s, Result = 05dc0000, Performance =  94.27 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.027507 s, Result = 060e0000, Performance =  96.81 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.027926 s, Result = 06400000, Performance =  98.43 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.028836 s, Result = 06720000, Performance =  98.30 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.029328 s, Result = 06a40000, Performance =  99.58 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030484 s, Result = 06d60000, Performance =  98.63 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.030333 s, Result = 07080000, Performance = 101.95 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031063 s, Result = 073a0000, Performance = 102.32 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.031768 s, Result = 076c0000, Performance = 102.75 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.032407 s, Result = 079e0000, Performance = 103.37 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.033260 s, Result = 07d00000, Performance = 103.31 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.033446 s, Result = 08020000, Performance = 105.30 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.033925 s, Result = 08340000, Performance = 106.34 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.035367 s, Result = 08660000, Performance = 104.44 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.035352 s, Result = 08980000, Performance = 106.91 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.036051 s, Result = 08ca0000, Performance = 107.22 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.036543 s, Result = 08fc0000, Performance = 108.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.037366 s, Result = 092e0000, Performance = 108.05 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.038393 s, Result = 09600000, Performance = 107.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.038790 s, Result = 09920000, Performance = 108.51 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.039062 s, Result = 09c40000, Performance = 109.95 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.040242 s, Result = 09f60000, Performance = 108.86 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.040716 s, Result = 0a280000, Performance = 109.71 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.041845 s, Result = 0a5a0000, Performance = 108.80 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.041807 s, Result = 0a8c0000, Performance = 110.95 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.043042 s, Result = 0abe0000, Performance = 109.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.044064 s, Result = 0af00000, Performance = 109.17 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.045166 s, Result = 0b220000, Performance = 108.41 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.045634 s, Result = 0b540000, Performance = 109.18 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.046945 s, Result = 0b860000, Performance = 107.96 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.047322 s, Result = 0bb80000, Performance = 108.91 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.048299 s, Result = 0bea0000, Performance = 108.49 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.048843 s, Result = 0c1c0000, Performance = 109.04 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.050255 s, Result = 0c4e0000, Performance = 107.68 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.050502 s, Result = 0c800000, Performance = 108.86 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   872   158   320
Test passed: M N K =   743   903   384
Test passed: M N K =    67  1138  1024
Test passed: M N K =  1092  1161   448
Test passed: M N K =  1171   866  1984
M N K =  4096  4096   256, Elapsed time =   0.006429 s, Result = a0d20000, Performance =  13.36 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006677 s, Result = a1040000, Performance =  25.73 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007452 s, Result = a1360000, Performance =  34.58 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007984 s, Result = a1680000, Performance =  43.04 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008389 s, Result = a19a0000, Performance =  51.20 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009272 s, Result = a1cc0000, Performance =  55.59 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009769 s, Result = a1fe0000, Performance =  61.55 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016078 s, Result = a2300000, Performance =  42.74 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011125 s, Result = a2620000, Performance =  69.49 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011373 s, Result = a2940000, Performance =  75.53 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012407 s, Result = a2c60000, Performance =  76.16 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.012879 s, Result = a2f80000, Performance =  80.03 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013293 s, Result = a32a0000, Performance =  84.00 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014466 s, Result = a35c0000, Performance =  83.13 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014402 s, Result = a38e0000, Performance =  89.46 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017399 s, Result = a3c00000, Performance =  78.99 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015710 s, Result = a3f20000, Performance =  92.95 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016137 s, Result = a4240000, Performance =  95.82 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017474 s, Result = a4560000, Performance =  93.40 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017406 s, Result = a4880000, Performance =  98.70 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018445 s, Result = a4ba0000, Performance =  97.80 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018479 s, Result = a4ec0000, Performance = 102.26 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019025 s, Result = a51e0000, Performance = 103.85 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.020794 s, Result = a5500000, Performance =  99.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020055 s, Result = a5820000, Performance = 107.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.021050 s, Result = a5b40000, Performance = 106.10 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021357 s, Result = a5e60000, Performance = 108.60 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.022299 s, Result = a6180000, Performance = 107.86 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022724 s, Result = a64a0000, Performance = 109.62 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.023194 s, Result = a67c0000, Performance = 111.11 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023886 s, Result = a6ae0000, Performance = 111.48 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025834 s, Result = a6e00000, Performance = 106.40 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025165 s, Result = a7120000, Performance = 112.65 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026054 s, Result = a7440000, Performance = 112.10 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026543 s, Result = a7760000, Performance = 113.27 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026955 s, Result = a7a80000, Performance = 114.72 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027715 s, Result = a7da0000, Performance = 114.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028248 s, Result = a80c0000, Performance = 115.56 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.029328 s, Result = a83e0000, Performance = 114.23 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.030253 s, Result = a8700000, Performance = 113.57 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030651 s, Result = a8a20000, Performance = 114.90 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.031159 s, Result = a8d40000, Performance = 115.79 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032490 s, Result = a9060000, Performance = 113.69 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032452 s, Result = a9380000, Performance = 116.47 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.033340 s, Result = a96a0000, Performance = 115.94 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.033734 s, Result = a99c0000, Performance = 117.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.034813 s, Result = a9ce0000, Performance = 115.97 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.036309 s, Result = aa000000, Performance = 113.56 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036215 s, Result = aa320000, Performance = 116.22 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.036510 s, Result = aa640000, Performance = 117.64 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.037919 s, Result = aa960000, Performance = 115.53 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.037930 s, Result = aac80000, Performance = 117.76 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.038954 s, Result = aafa0000, Performance = 116.87 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.039459 s, Result = ab2c0000, Performance = 117.56 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.040875 s, Result = ab5e0000, Performance = 115.58 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.041341 s, Result = ab900000, Performance = 116.36 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.042127 s, Result = abc20000, Performance = 116.23 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.042915 s, Result = abf40000, Performance = 116.09 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.044523 s, Result = ac260000, Performance = 113.83 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.044657 s, Result = ac580000, Performance = 115.41 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.045553 s, Result = ac8a0000, Performance = 115.03 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.046216 s, Result = acbc0000, Performance = 115.24 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.047004 s, Result = acee0000, Performance = 115.13 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.048232 s, Result = ad200000, Performance = 113.98 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   547  1027  1920
Test passed: M N K =   792   450   960
Test passed: M N K =   714   906  1600
Test passed: M N K =  1252   659  1408
Test passed: M N K =  1166  1707   448
M N K =  4096  4096   256, Elapsed time =   0.000924 s, Result = 00320000, Performance =  93.00 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001740 s, Result = 00640000, Performance =  98.74 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002293 s, Result = 00960000, Performance = 112.40 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002934 s, Result = 00c80000, Performance = 117.10 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003698 s, Result = 00fa0000, Performance = 116.16 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004314 s, Result = 012c0000, Performance = 119.46 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004918 s, Result = 015e0000, Performance = 122.25 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006006 s, Result = 01900000, Performance = 114.42 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006129 s, Result = 01c20000, Performance = 126.14 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006719 s, Result = 01f40000, Performance = 127.84 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.007338 s, Result = 02260000, Performance = 128.77 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008288 s, Result = 02580000, Performance = 124.37 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.008960 s, Result = 028a0000, Performance = 124.64 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.009207 s, Result = 02bc0000, Performance = 130.62 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010041 s, Result = 02ee0000, Performance = 128.32 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.011844 s, Result = 03200000, Performance = 116.04 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011156 s, Result = 03520000, Performance = 130.90 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.011460 s, Result = 03840000, Performance = 134.92 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012120 s, Result = 03b60000, Performance = 134.66 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.012584 s, Result = 03e80000, Performance = 136.52 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.013045 s, Result = 041a0000, Performance = 138.28 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.013703 s, Result = 044c0000, Performance = 137.92 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014343 s, Result = 047e0000, Performance = 137.75 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016097 s, Result = 04b00000, Performance = 128.07 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015339 s, Result = 04e20000, Performance = 140.01 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016221 s, Result = 05140000, Performance = 137.69 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.016629 s, Result = 05460000, Performance = 139.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.017354 s, Result = 05780000, Performance = 138.59 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017694 s, Result = 05aa0000, Performance = 140.78 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018312 s, Result = 05dc0000, Performance = 140.73 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.019120 s, Result = 060e0000, Performance = 139.27 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021034 s, Result = 06400000, Performance = 130.68 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.019771 s, Result = 06720000, Performance = 143.37 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020796 s, Result = 06a40000, Performance = 140.44 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.021262 s, Result = 06d60000, Performance = 141.40 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022055 s, Result = 07080000, Performance = 140.22 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.022121 s, Result = 073a0000, Performance = 143.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.022766 s, Result = 076c0000, Performance = 143.38 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.023540 s, Result = 079e0000, Performance = 142.31 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025161 s, Result = 07d00000, Performance = 136.56 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.024489 s, Result = 08020000, Performance = 143.81 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.024819 s, Result = 08340000, Performance = 145.36 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.025907 s, Result = 08660000, Performance = 142.58 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026378 s, Result = 08980000, Performance = 143.29 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.026662 s, Result = 08ca0000, Performance = 144.98 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.027331 s, Result = 08fc0000, Performance = 144.58 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028207 s, Result = 092e0000, Performance = 143.13 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028920 s, Result = 09600000, Performance = 142.57 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029489 s, Result = 09920000, Performance = 142.73 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029537 s, Result = 09c40000, Performance = 145.41 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030352 s, Result = 09f60000, Performance = 144.34 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030755 s, Result = 0a280000, Performance = 145.24 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031557 s, Result = 0a5a0000, Performance = 144.27 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032399 s, Result = 0a8c0000, Performance = 143.17 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.033094 s, Result = 0abe0000, Performance = 142.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.033892 s, Result = 0af00000, Performance = 141.93 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.034440 s, Result = 0b220000, Performance = 142.17 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.035283 s, Result = 0b540000, Performance = 141.21 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.037357 s, Result = 0b860000, Performance = 135.67 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.037082 s, Result = 0bb80000, Performance = 138.99 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.037958 s, Result = 0bea0000, Performance = 138.04 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.038925 s, Result = 0c1c0000, Performance = 136.82 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039742 s, Result = 0c4e0000, Performance = 136.17 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.040190 s, Result = 0c800000, Performance = 136.79 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   544  1206  1920
Test passed: M N K =   183  1307  1088
Test passed: M N K =  1379  1193   896
Test passed: M N K =  2005  1051  1280
Test passed: M N K =  1859   965  1152
M N K =  4096  4096   256, Elapsed time =   0.011716 s, Result = 50420000, Performance =   7.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012310 s, Result = 90740000, Performance =  13.96 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012926 s, Result = d0a60000, Performance =  19.94 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013647 s, Result = 10d80000, Performance =  25.18 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014615 s, Result = 510a0000, Performance =  29.39 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014829 s, Result = 913c0000, Performance =  34.76 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015680 s, Result = d16e0000, Performance =  38.35 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016438 s, Result = 11a00000, Performance =  41.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.017546 s, Result = 51d20000, Performance =  44.06 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.018024 s, Result = 92040000, Performance =  47.66 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.018880 s, Result = d2360000, Performance =  50.05 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.020236 s, Result = 12680000, Performance =  50.94 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020793 s, Result = 529a0000, Performance =  53.70 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021140 s, Result = 92cc0000, Performance =  56.89 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021639 s, Result = d2fe0000, Performance =  59.55 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.023918 s, Result = 13300000, Performance =  57.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022179 s, Result = 53620000, Performance =  65.84 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.022944 s, Result = 93940000, Performance =  67.39 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.023454 s, Result = d3c60000, Performance =  69.59 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024223 s, Result = 13f80000, Performance =  70.92 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024973 s, Result = 542a0000, Performance =  72.23 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.025674 s, Result = 945c0000, Performance =  73.61 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.025805 s, Result = d48e0000, Performance =  76.56 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.027839 s, Result = 14c00000, Performance =  74.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.027236 s, Result = 54f20000, Performance =  78.85 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.028019 s, Result = 95240000, Performance =  79.71 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.028522 s, Result = d5560000, Performance =  81.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.029182 s, Result = 15880000, Performance =  82.42 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.029964 s, Result = 55ba0000, Performance =  83.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030679 s, Result = 95ec0000, Performance =  84.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.031002 s, Result = d61e0000, Performance =  85.89 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.034895 s, Result = 16500000, Performance =  78.77 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.032395 s, Result = 56820000, Performance =  87.50 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.033294 s, Result = 96b40000, Performance =  87.72 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.033742 s, Result = d6e60000, Performance =  89.10 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.034239 s, Result = 17180000, Performance =  90.32 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.034821 s, Result = 574a0000, Performance =  91.28 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.035928 s, Result = 977c0000, Performance =  90.85 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.036043 s, Result = d7ae0000, Performance =  92.95 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039136 s, Result = 17e00000, Performance =  87.80 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.037518 s, Result = 58120000, Performance =  93.87 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.038473 s, Result = 98440000, Performance =  93.77 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.039117 s, Result = d8760000, Performance =  94.43 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.039593 s, Result = 18a80000, Performance =  95.46 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.040317 s, Result = 58da0000, Performance =  95.88 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.041027 s, Result = 990c0000, Performance =  96.31 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.041414 s, Result = d93e0000, Performance =  97.49 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047477 s, Result = 19700000, Performance =  86.85 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.043093 s, Result = 59a20000, Performance =  97.68 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.044189 s, Result = 99d40000, Performance =  97.19 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.044752 s, Result = da060000, Performance =  97.89 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.045396 s, Result = 1a380000, Performance =  98.40 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.045936 s, Result = 5a6a0000, Performance =  99.11 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.047379 s, Result = 9a9c0000, Performance =  97.90 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.047480 s, Result = dace0000, Performance =  99.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.050703 s, Result = 1b000000, Performance =  94.87 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.048796 s, Result = 5b320000, Performance = 100.34 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.049718 s, Result = 9b640000, Performance = 100.21 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.050745 s, Result = db960000, Performance =  99.87 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.051083 s, Result = 1bc80000, Performance = 100.89 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.052140 s, Result = 5bfa0000, Performance = 100.50 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.052800 s, Result = 9c2c0000, Performance = 100.87 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.053694 s, Result = dc5e0000, Performance = 100.79 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.059541 s, Result = 1c900000, Performance =  92.33 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1282  1800  1664
Test passed: M N K =  1492  1933  1280
Test passed: M N K =  1863   296  1600
Test passed: M N K =  1925  1401  1600
Test passed: M N K =  1535   361  1216
M N K =  4096  4096   256, Elapsed time =   0.013088 s, Result = 00320000, Performance =   6.56 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012697 s, Result = 00640000, Performance =  13.53 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013522 s, Result = 00960000, Performance =  19.06 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013171 s, Result = 00c80000, Performance =  26.09 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013771 s, Result = 00fa0000, Performance =  31.19 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014078 s, Result = 012c0000, Performance =  36.61 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014362 s, Result = 015e0000, Performance =  41.87 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014956 s, Result = 01900000, Performance =  45.95 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015562 s, Result = 01c20000, Performance =  49.68 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015980 s, Result = 01f40000, Performance =  53.75 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016739 s, Result = 02260000, Performance =  56.45 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017471 s, Result = 02580000, Performance =  59.00 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018959 s, Result = 028a0000, Performance =  58.90 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018949 s, Result = 02bc0000, Performance =  63.46 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019438 s, Result = 02ee0000, Performance =  66.29 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020496 s, Result = 03200000, Performance =  67.06 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020435 s, Result = 03520000, Performance =  71.46 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.020933 s, Result = 03840000, Performance =  73.86 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020881 s, Result = 03b60000, Performance =  78.16 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.021968 s, Result = 03e80000, Performance =  78.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.022548 s, Result = 041a0000, Performance =  80.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.022999 s, Result = 044c0000, Performance =  82.17 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.023503 s, Result = 047e0000, Performance =  84.06 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024792 s, Result = 04b00000, Performance =  83.16 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.024551 s, Result = 04e20000, Performance =  87.47 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.025677 s, Result = 05140000, Performance =  86.98 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.025765 s, Result = 05460000, Performance =  90.02 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.026716 s, Result = 05780000, Performance =  90.03 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026988 s, Result = 05aa0000, Performance =  92.30 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.027772 s, Result = 05dc0000, Performance =  92.79 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.028423 s, Result = 060e0000, Performance =  93.69 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.030641 s, Result = 06400000, Performance =  89.71 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029605 s, Result = 06720000, Performance =  95.75 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.030614 s, Result = 06a40000, Performance =  95.40 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.030562 s, Result = 06d60000, Performance =  98.37 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.031353 s, Result = 07080000, Performance =  98.63 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.031897 s, Result = 073a0000, Performance =  99.64 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.032592 s, Result = 076c0000, Performance = 100.15 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.033090 s, Result = 079e0000, Performance = 101.24 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.035679 s, Result = 07d00000, Performance =  96.30 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.034256 s, Result = 08020000, Performance = 102.81 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.035308 s, Result = 08340000, Performance = 102.18 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.035707 s, Result = 08660000, Performance = 103.44 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.036293 s, Result = 08980000, Performance = 104.14 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.036549 s, Result = 08ca0000, Performance = 105.76 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.037699 s, Result = 08fc0000, Performance = 104.81 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.037888 s, Result = 092e0000, Performance = 106.56 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.042772 s, Result = 09600000, Performance =  96.40 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.039291 s, Result = 09920000, Performance = 107.13 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.040215 s, Result = 09c40000, Performance = 106.80 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.040404 s, Result = 09f60000, Performance = 108.43 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.041183 s, Result = 0a280000, Performance = 108.46 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.041904 s, Result = 0a5a0000, Performance = 108.65 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.043172 s, Result = 0a8c0000, Performance = 107.44 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.043255 s, Result = 0abe0000, Performance = 109.22 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046268 s, Result = 0af00000, Performance = 103.97 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.044341 s, Result = 0b220000, Performance = 110.42 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.045330 s, Result = 0b540000, Performance = 109.91 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.045752 s, Result = 0b860000, Performance = 110.77 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.046372 s, Result = 0bb80000, Performance = 111.14 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.046833 s, Result = 0bea0000, Performance = 111.88 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.048126 s, Result = 0c1c0000, Performance = 110.66 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.048390 s, Result = 0c4e0000, Performance = 111.83 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054328 s, Result = 0c800000, Performance = 101.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   262   285   192
Test passed: M N K =   619   546   320
Test passed: M N K =  1041   215   640
Test passed: M N K =  1489   862  1408
Test passed: M N K =   986  1802   704
M N K =  4096  4096   256, Elapsed time =   0.006279 s, Result = a0d20000, Performance =  13.68 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006636 s, Result = a1040000, Performance =  25.89 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007532 s, Result = a1360000, Performance =  34.22 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008035 s, Result = a1680000, Performance =  42.76 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008597 s, Result = a19a0000, Performance =  49.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009244 s, Result = a1cc0000, Performance =  55.76 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010036 s, Result = a1fe0000, Performance =  59.91 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.017085 s, Result = a2300000, Performance =  40.22 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011505 s, Result = a2620000, Performance =  67.19 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012552 s, Result = a2940000, Performance =  68.44 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012981 s, Result = a2c60000, Performance =  72.79 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013660 s, Result = a2f80000, Performance =  75.46 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014496 s, Result = a32a0000, Performance =  77.03 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015565 s, Result = a35c0000, Performance =  77.26 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015495 s, Result = a38e0000, Performance =  83.16 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017796 s, Result = a3c00000, Performance =  77.23 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016640 s, Result = a3f20000, Performance =  87.76 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017127 s, Result = a4240000, Performance =  90.28 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017705 s, Result = a4560000, Performance =  92.18 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018249 s, Result = a4880000, Performance =  94.14 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018848 s, Result = a4ba0000, Performance =  95.71 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.019701 s, Result = a4ec0000, Performance =  95.93 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019906 s, Result = a51e0000, Performance =  99.25 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021800 s, Result = a5500000, Performance =  94.57 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.021220 s, Result = a5820000, Performance = 101.20 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022251 s, Result = a5b40000, Performance = 100.37 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022809 s, Result = a5e60000, Performance = 101.68 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023329 s, Result = a6180000, Performance = 103.10 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.023607 s, Result = a64a0000, Performance = 105.52 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024725 s, Result = a67c0000, Performance = 104.23 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.024465 s, Result = a6ae0000, Performance = 108.84 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.028466 s, Result = a6e00000, Performance =  96.56 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025994 s, Result = a7120000, Performance = 109.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026677 s, Result = a7440000, Performance = 109.48 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.027385 s, Result = a7760000, Performance = 109.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.028090 s, Result = a7a80000, Performance = 110.09 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.028476 s, Result = a7da0000, Performance = 111.61 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.029063 s, Result = a80c0000, Performance = 112.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030260 s, Result = a83e0000, Performance = 110.71 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.032463 s, Result = a8700000, Performance = 105.84 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030946 s, Result = a8a20000, Performance = 113.81 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.031548 s, Result = a8d40000, Performance = 114.36 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032289 s, Result = a9060000, Performance = 114.39 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032900 s, Result = a9380000, Performance = 114.88 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.033229 s, Result = a96a0000, Performance = 116.33 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.034676 s, Result = a99c0000, Performance = 113.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.034734 s, Result = a9ce0000, Performance = 116.23 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040337 s, Result = aa000000, Performance = 102.22 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036008 s, Result = aa320000, Performance = 116.89 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.036944 s, Result = aa640000, Performance = 116.25 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.037437 s, Result = aa960000, Performance = 117.02 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.038223 s, Result = aac80000, Performance = 116.86 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.038597 s, Result = aafa0000, Performance = 117.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.039525 s, Result = ab2c0000, Performance = 117.36 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039779 s, Result = ab5e0000, Performance = 118.77 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.043630 s, Result = ab900000, Performance = 110.25 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.041328 s, Result = abc20000, Performance = 118.47 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.042500 s, Result = abf40000, Performance = 117.23 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.042727 s, Result = ac260000, Performance = 118.62 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.043521 s, Result = ac580000, Performance = 118.42 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.043653 s, Result = ac8a0000, Performance = 120.03 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044692 s, Result = acbc0000, Performance = 119.17 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.045053 s, Result = acee0000, Performance = 120.12 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.051745 s, Result = ad200000, Performance = 106.24 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1049    96  1152
Test passed: M N K =  1296  1169  1472
Test passed: M N K =   345  1060    64
Test passed: M N K =   459  1470    64
Test passed: M N K =  1470  1957  1088
M N K =  4096  4096   256, Elapsed time =   0.000855 s, Result = 00320000, Performance = 100.49 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001688 s, Result = 00640000, Performance = 101.78 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002462 s, Result = 00960000, Performance = 104.68 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003291 s, Result = 00c80000, Performance = 104.42 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003813 s, Result = 00fa0000, Performance = 112.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004453 s, Result = 012c0000, Performance = 115.74 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005258 s, Result = 015e0000, Performance = 114.35 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005875 s, Result = 01900000, Performance = 116.97 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006557 s, Result = 01c20000, Performance = 117.91 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007729 s, Result = 01f40000, Performance = 111.15 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008180 s, Result = 02260000, Performance = 115.52 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009008 s, Result = 02580000, Performance = 114.43 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009567 s, Result = 028a0000, Performance = 116.73 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010475 s, Result = 02bc0000, Performance = 114.80 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010832 s, Result = 02ee0000, Performance = 118.95 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012027 s, Result = 03200000, Performance = 114.28 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011731 s, Result = 03520000, Performance = 124.49 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.012496 s, Result = 03840000, Performance = 123.73 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012871 s, Result = 03b60000, Performance = 126.80 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.013289 s, Result = 03e80000, Performance = 129.28 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014003 s, Result = 041a0000, Performance = 128.82 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014607 s, Result = 044c0000, Performance = 129.38 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015526 s, Result = 047e0000, Performance = 127.25 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016832 s, Result = 04b00000, Performance = 122.48 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.016463 s, Result = 04e20000, Performance = 130.44 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017572 s, Result = 05140000, Performance = 127.10 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017823 s, Result = 05460000, Performance = 130.13 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.018475 s, Result = 05780000, Performance = 130.19 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018957 s, Result = 05aa0000, Performance = 131.40 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.019776 s, Result = 05dc0000, Performance = 130.31 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020047 s, Result = 060e0000, Performance = 132.83 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.022900 s, Result = 06400000, Performance = 120.03 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021401 s, Result = 06720000, Performance = 132.45 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022432 s, Result = 06a40000, Performance = 130.20 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022413 s, Result = 06d60000, Performance = 134.14 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023132 s, Result = 07080000, Performance = 133.68 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023664 s, Result = 073a0000, Performance = 134.31 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024763 s, Result = 076c0000, Performance = 131.82 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024969 s, Result = 079e0000, Performance = 134.17 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.027146 s, Result = 07d00000, Performance = 126.57 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.026159 s, Result = 08020000, Performance = 134.64 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.027300 s, Result = 08340000, Performance = 132.15 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.027330 s, Result = 08660000, Performance = 135.15 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.027400 s, Result = 08980000, Performance = 137.94 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027695 s, Result = 08ca0000, Performance = 139.57 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.029009 s, Result = 08fc0000, Performance = 136.21 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.029258 s, Result = 092e0000, Performance = 137.99 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034662 s, Result = 09600000, Performance = 118.95 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.030323 s, Result = 09920000, Performance = 138.81 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.031040 s, Result = 09c40000, Performance = 138.37 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.031643 s, Result = 09f60000, Performance = 138.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.032191 s, Result = 0a280000, Performance = 138.76 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.032691 s, Result = 0a5a0000, Performance = 139.26 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.034116 s, Result = 0a8c0000, Performance = 135.96 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.033660 s, Result = 0abe0000, Performance = 140.36 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.037428 s, Result = 0af00000, Performance = 128.52 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.034992 s, Result = 0b220000, Performance = 139.92 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.036417 s, Result = 0b540000, Performance = 136.81 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.036260 s, Result = 0b860000, Performance = 139.77 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.036788 s, Result = 0bb80000, Performance = 140.10 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.037605 s, Result = 0bea0000, Performance = 139.34 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.038274 s, Result = 0c1c0000, Performance = 139.15 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.038972 s, Result = 0c4e0000, Performance = 138.86 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.045496 s, Result = 0c800000, Performance = 120.84 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1116  2030   128
Test passed: M N K =  1845  1053  1088
Test passed: M N K =  1381  1056  1856
Test passed: M N K =   387  1954  1984
Test passed: M N K =  1376  1883  1408
M N K =  4096  4096   256, Elapsed time =   0.011409 s, Result = 50420000, Performance =   7.53 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012404 s, Result = 90740000, Performance =  13.85 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012919 s, Result = d0a60000, Performance =  19.95 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013797 s, Result = 10d80000, Performance =  24.90 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014332 s, Result = 510a0000, Performance =  29.97 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015270 s, Result = 913c0000, Performance =  33.75 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015806 s, Result = d16e0000, Performance =  38.04 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.016326 s, Result = 11a00000, Performance =  42.09 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.017214 s, Result = 51d20000, Performance =  44.91 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.018250 s, Result = 92040000, Performance =  47.07 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.019357 s, Result = d2360000, Performance =  48.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.020067 s, Result = 12680000, Performance =  51.37 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.028594 s, Result = 529a0000, Performance =  39.05 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021664 s, Result = 92cc0000, Performance =  55.51 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.022222 s, Result = d2fe0000, Performance =  57.98 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022523 s, Result = 13300000, Performance =  61.02 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023787 s, Result = 53620000, Performance =  61.39 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024514 s, Result = 93940000, Performance =  63.07 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025733 s, Result = d3c60000, Performance =  63.42 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026773 s, Result = 13f80000, Performance =  64.17 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.027348 s, Result = 542a0000, Performance =  65.96 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.028065 s, Result = 945c0000, Performance =  67.34 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.029130 s, Result = d48e0000, Performance =  67.82 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.028693 s, Result = 14c00000, Performance =  71.85 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.030396 s, Result = 54f20000, Performance =  70.65 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.030849 s, Result = 95240000, Performance =  72.40 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.031547 s, Result = d5560000, Performance =  73.52 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.032322 s, Result = 15880000, Performance =  74.41 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.033147 s, Result = 55ba0000, Performance =  75.15 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.033930 s, Result = 95ec0000, Performance =  75.95 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.034895 s, Result = d61e0000, Performance =  76.31 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.034708 s, Result = 16500000, Performance =  79.20 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.036540 s, Result = 56820000, Performance =  77.58 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.036700 s, Result = 96b40000, Performance =  79.58 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.038010 s, Result = d6e60000, Performance =  79.10 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.038368 s, Result = 17180000, Performance =  80.60 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.039256 s, Result = 574a0000, Performance =  80.96 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.039965 s, Result = 977c0000, Performance =  81.68 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.040982 s, Result = d7ae0000, Performance =  81.75 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.041079 s, Result = 17e00000, Performance =  83.64 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.043087 s, Result = 58120000, Performance =  81.74 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.042880 s, Result = 98440000, Performance =  84.14 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.044618 s, Result = d8760000, Performance =  82.78 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.044534 s, Result = 18a80000, Performance =  84.87 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.045540 s, Result = 58da0000, Performance =  84.88 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.046401 s, Result = 990c0000, Performance =  85.16 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.046979 s, Result = d93e0000, Performance =  85.94 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047004 s, Result = 19700000, Performance =  87.72 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.048682 s, Result = 59a20000, Performance =  86.46 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.049185 s, Result = 99d40000, Performance =  87.32 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.050451 s, Result = da060000, Performance =  86.83 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050687 s, Result = 1a380000, Performance =  88.12 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.052225 s, Result = 5a6a0000, Performance =  87.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052914 s, Result = 9a9c0000, Performance =  87.66 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.053587 s, Result = dace0000, Performance =  88.16 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.053735 s, Result = 1b000000, Performance =  89.52 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.055141 s, Result = 5b320000, Performance =  88.80 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.056112 s, Result = 9b640000, Performance =  88.79 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.057209 s, Result = db960000, Performance =  88.59 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.057444 s, Result = 1bc80000, Performance =  89.72 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.058713 s, Result = 5bfa0000, Performance =  89.25 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.059105 s, Result = 9c2c0000, Performance =  90.11 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.060397 s, Result = dc5e0000, Performance =  89.60 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.059568 s, Result = 1c900000, Performance =  92.29 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   462   773   576
Test passed: M N K =   823    90   704
Test passed: M N K =   495   436   512
Test passed: M N K =   241   169   896
Test passed: M N K =  1752  1302   640
M N K =  4096  4096   256, Elapsed time =   0.013064 s, Result = 00320000, Performance =   6.58 TOPS
M N K =  4096  4096   512, Elapsed time =   0.012402 s, Result = 00640000, Performance =  13.85 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013202 s, Result = 00960000, Performance =  19.52 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.013446 s, Result = 00c80000, Performance =  25.55 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.014011 s, Result = 00fa0000, Performance =  30.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013766 s, Result = 012c0000, Performance =  37.44 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014462 s, Result = 015e0000, Performance =  41.58 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.017015 s, Result = 01900000, Performance =  40.39 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015227 s, Result = 01c20000, Performance =  50.77 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016410 s, Result = 01f40000, Performance =  52.34 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017041 s, Result = 02260000, Performance =  55.45 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017620 s, Result = 02580000, Performance =  58.50 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018482 s, Result = 028a0000, Performance =  60.42 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019529 s, Result = 02bc0000, Performance =  61.58 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019682 s, Result = 02ee0000, Performance =  65.47 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.019823 s, Result = 03200000, Performance =  69.33 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.021643 s, Result = 03520000, Performance =  67.47 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.022428 s, Result = 03840000, Performance =  68.94 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.022981 s, Result = 03b60000, Performance =  71.02 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.023835 s, Result = 03e80000, Performance =  72.08 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.024847 s, Result = 041a0000, Performance =  72.60 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.024976 s, Result = 044c0000, Performance =  75.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.026106 s, Result = 047e0000, Performance =  75.68 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.026513 s, Result = 04b00000, Performance =  77.76 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.027161 s, Result = 04e20000, Performance =  79.06 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.028335 s, Result = 05140000, Performance =  78.82 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.028697 s, Result = 05460000, Performance =  80.82 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.029525 s, Result = 05780000, Performance =  81.46 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.030448 s, Result = 05aa0000, Performance =  81.81 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.030959 s, Result = 05dc0000, Performance =  83.24 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.032053 s, Result = 060e0000, Performance =  83.08 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.031252 s, Result = 06400000, Performance =  87.96 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.033251 s, Result = 06720000, Performance =  85.25 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.034222 s, Result = 06a40000, Performance =  85.34 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035044 s, Result = 06d60000, Performance =  85.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.035492 s, Result = 07080000, Performance =  87.13 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036166 s, Result = 073a0000, Performance =  87.88 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.036482 s, Result = 076c0000, Performance =  89.47 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.037844 s, Result = 079e0000, Performance =  88.52 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.037845 s, Result = 07d00000, Performance =  90.79 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.039103 s, Result = 08020000, Performance =  90.07 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.039784 s, Result = 08340000, Performance =  90.69 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.041042 s, Result = 08660000, Performance =  90.00 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.041257 s, Result = 08980000, Performance =  91.61 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.042437 s, Result = 08ca0000, Performance =  91.09 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.042446 s, Result = 08fc0000, Performance =  93.09 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.043668 s, Result = 092e0000, Performance =  92.45 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.043695 s, Result = 09600000, Performance =  94.36 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.045005 s, Result = 09920000, Performance =  93.52 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.045582 s, Result = 09c40000, Performance =  94.23 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.046233 s, Result = 09f60000, Performance =  94.76 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.047040 s, Result = 0a280000, Performance =  94.96 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.048572 s, Result = 0a5a0000, Performance =  93.73 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.048664 s, Result = 0a8c0000, Performance =  95.32 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.049928 s, Result = 0abe0000, Performance =  94.62 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.049506 s, Result = 0af00000, Performance =  97.17 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.051001 s, Result = 0b220000, Performance =  96.00 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.051834 s, Result = 0b540000, Performance =  96.12 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.052756 s, Result = 0b860000, Performance =  96.07 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.053274 s, Result = 0bb80000, Performance =  96.74 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.054277 s, Result = 0bea0000, Performance =  96.54 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.054703 s, Result = 0c1c0000, Performance =  97.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055712 s, Result = 0c4e0000, Performance =  97.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.054694 s, Result = 0c800000, Performance = 100.51 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    42  1739  1920
Test passed: M N K =  1159  2008  1088
Test passed: M N K =  1392   299   640
Test passed: M N K =   716   998   192
Test passed: M N K =   641   629  1920
M N K =  4096  4096   256, Elapsed time =   0.006168 s, Result = a0d20000, Performance =  13.93 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006775 s, Result = a1040000, Performance =  25.36 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007122 s, Result = a1360000, Performance =  36.18 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007981 s, Result = a1680000, Performance =  43.05 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008250 s, Result = a19a0000, Performance =  52.06 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009243 s, Result = a1cc0000, Performance =  55.76 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010076 s, Result = a1fe0000, Performance =  59.67 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010582 s, Result = a2300000, Performance =  64.94 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011291 s, Result = a2620000, Performance =  68.47 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012554 s, Result = a2940000, Performance =  68.42 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013156 s, Result = a2c60000, Performance =  71.82 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014095 s, Result = a2f80000, Performance =  73.13 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014466 s, Result = a32a0000, Performance =  77.19 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015683 s, Result = a35c0000, Performance =  76.68 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016394 s, Result = a38e0000, Performance =  78.60 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016665 s, Result = a3c00000, Performance =  82.47 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017624 s, Result = a3f20000, Performance =  82.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018835 s, Result = a4240000, Performance =  82.09 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.019649 s, Result = a4560000, Performance =  83.06 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020266 s, Result = a4880000, Performance =  84.77 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.021224 s, Result = a4ba0000, Performance =  84.99 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.021585 s, Result = a4ec0000, Performance =  87.55 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.022787 s, Result = a51e0000, Performance =  86.70 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022766 s, Result = a5500000, Performance =  90.56 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.023950 s, Result = a5820000, Performance =  89.66 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.024507 s, Result = a5b40000, Performance =  91.13 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.025386 s, Result = a5e60000, Performance =  91.36 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.026538 s, Result = a6180000, Performance =  90.63 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.026938 s, Result = a64a0000, Performance =  92.48 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.027452 s, Result = a67c0000, Performance =  93.87 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.028385 s, Result = a6ae0000, Performance =  93.81 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.028462 s, Result = a6e00000, Performance =  96.58 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.029637 s, Result = a7120000, Performance =  95.65 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.030519 s, Result = a7440000, Performance =  95.70 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.031376 s, Result = a7760000, Performance =  95.82 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.032105 s, Result = a7a80000, Performance =  96.32 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.033028 s, Result = a7da0000, Performance =  96.23 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.033602 s, Result = a80c0000, Performance =  97.14 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.034233 s, Result = a83e0000, Performance =  97.86 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.034251 s, Result = a8700000, Performance = 100.32 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.035558 s, Result = a8a20000, Performance =  99.04 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.036134 s, Result = a8d40000, Performance =  99.84 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.037726 s, Result = a9060000, Performance =  97.91 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.037811 s, Result = a9380000, Performance =  99.96 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.038738 s, Result = a96a0000, Performance =  99.79 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.039403 s, Result = a99c0000, Performance = 100.28 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.040522 s, Result = a9ce0000, Performance =  99.63 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.040395 s, Result = aa000000, Performance = 102.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.041506 s, Result = aa320000, Performance = 101.41 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.042389 s, Result = aa640000, Performance = 101.32 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.043174 s, Result = aa960000, Performance = 101.47 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.044301 s, Result = aac80000, Performance = 100.83 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.045481 s, Result = aafa0000, Performance = 100.10 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.045936 s, Result = ab2c0000, Performance = 100.98 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.046935 s, Result = ab5e0000, Performance = 100.66 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.046226 s, Result = ab900000, Performance = 104.06 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.047985 s, Result = abc20000, Performance = 102.04 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.048457 s, Result = abf40000, Performance = 102.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.049763 s, Result = ac260000, Performance = 101.84 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.050057 s, Result = ac580000, Performance = 102.96 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.050735 s, Result = ac8a0000, Performance = 103.28 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.051414 s, Result = acbc0000, Performance = 103.59 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.052640 s, Result = acee0000, Performance = 102.81 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.051928 s, Result = ad200000, Performance = 105.87 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   910  1400   640
Test passed: M N K =   904   586  1216
Test passed: M N K =  1205  1332    64
Test passed: M N K =   873  1788  1280
Test passed: M N K =    80  1294  1408
M N K =  4096  4096   256, Elapsed time =   0.000903 s, Result = 00320000, Performance =  95.11 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001730 s, Result = 00640000, Performance =  99.29 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002532 s, Result = 00960000, Performance = 101.79 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003313 s, Result = 00c80000, Performance = 103.73 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004086 s, Result = 00fa0000, Performance = 105.11 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004757 s, Result = 012c0000, Performance = 108.35 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005390 s, Result = 015e0000, Performance = 111.56 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006266 s, Result = 01900000, Performance = 109.66 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.007006 s, Result = 01c20000, Performance = 110.34 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008040 s, Result = 01f40000, Performance = 106.84 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008816 s, Result = 02260000, Performance = 107.18 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009689 s, Result = 02580000, Performance = 106.38 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010488 s, Result = 028a0000, Performance = 106.47 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011542 s, Result = 02bc0000, Performance = 104.20 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012014 s, Result = 02ee0000, Performance = 107.25 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012460 s, Result = 03200000, Performance = 110.30 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013415 s, Result = 03520000, Performance = 108.85 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014660 s, Result = 03840000, Performance = 105.47 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.015283 s, Result = 03b60000, Performance = 106.79 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015936 s, Result = 03e80000, Performance = 107.80 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.016221 s, Result = 041a0000, Performance = 111.21 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017060 s, Result = 044c0000, Performance = 110.78 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.017937 s, Result = 047e0000, Performance = 110.15 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018140 s, Result = 04b00000, Performance = 113.65 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019092 s, Result = 04e20000, Performance = 112.48 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019761 s, Result = 05140000, Performance = 113.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020794 s, Result = 05460000, Performance = 111.54 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021342 s, Result = 05780000, Performance = 112.70 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022065 s, Result = 05aa0000, Performance = 112.90 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022691 s, Result = 05dc0000, Performance = 113.57 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023802 s, Result = 060e0000, Performance = 111.88 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.023336 s, Result = 06400000, Performance = 117.79 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024652 s, Result = 06720000, Performance = 114.99 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025530 s, Result = 06a40000, Performance = 114.40 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026577 s, Result = 06d60000, Performance = 113.13 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026855 s, Result = 07080000, Performance = 115.15 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027638 s, Result = 073a0000, Performance = 115.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028480 s, Result = 076c0000, Performance = 114.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.029345 s, Result = 079e0000, Performance = 114.16 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029586 s, Result = 07d00000, Performance = 116.13 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030917 s, Result = 08020000, Performance = 113.91 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.031556 s, Result = 08340000, Performance = 114.33 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032433 s, Result = 08660000, Performance = 113.89 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032763 s, Result = 08980000, Performance = 115.36 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.033574 s, Result = 08ca0000, Performance = 115.13 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.034165 s, Result = 08fc0000, Performance = 115.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.035001 s, Result = 092e0000, Performance = 115.35 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.035153 s, Result = 09600000, Performance = 117.29 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.036114 s, Result = 09920000, Performance = 116.55 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.036896 s, Result = 09c40000, Performance = 116.41 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.038019 s, Result = 09f60000, Performance = 115.23 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.038097 s, Result = 0a280000, Performance = 117.25 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.039120 s, Result = 0a5a0000, Performance = 116.38 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.039971 s, Result = 0a8c0000, Performance = 116.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.041247 s, Result = 0abe0000, Performance = 114.54 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.040978 s, Result = 0af00000, Performance = 117.39 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.042715 s, Result = 0b220000, Performance = 114.63 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.043044 s, Result = 0b540000, Performance = 115.75 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.044037 s, Result = 0b860000, Performance = 115.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.044463 s, Result = 0bb80000, Performance = 115.92 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.045425 s, Result = 0bea0000, Performance = 115.35 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.045733 s, Result = 0c1c0000, Performance = 116.45 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.046628 s, Result = 0c4e0000, Performance = 116.06 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.046553 s, Result = 0c800000, Performance = 118.09 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   501  1952  2048
Test passed: M N K =   905  1003    64
Test passed: M N K =  1344  1972  1024
Test passed: M N K =   214   463  1344
Test passed: M N K =   932  1970   896
M N K =  4096  4096   256, Elapsed time =   0.010222 s, Result = 902e0000, Performance =   8.40 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010684 s, Result = 104c0000, Performance =  16.08 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012026 s, Result = 906a0000, Performance =  21.43 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012718 s, Result = 10880000, Performance =  27.02 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013338 s, Result = 90a60000, Performance =  32.20 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013317 s, Result = 10c40000, Performance =  38.70 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014045 s, Result = 90e20000, Performance =  42.81 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013945 s, Result = 11000000, Performance =  49.28 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014890 s, Result = 911e0000, Performance =  51.92 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014897 s, Result = 113c0000, Performance =  57.66 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015709 s, Result = 915a0000, Performance =  60.15 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016111 s, Result = 11780000, Performance =  63.98 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.016517 s, Result = 91960000, Performance =  67.61 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016938 s, Result = 11b40000, Performance =  71.00 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017544 s, Result = 91d20000, Performance =  73.44 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017930 s, Result = 11f00000, Performance =  76.65 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017922 s, Result = 920e0000, Performance =  81.48 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018577 s, Result = 122c0000, Performance =  83.23 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.018869 s, Result = 924a0000, Performance =  86.50 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019290 s, Result = 12680000, Performance =  89.06 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.020157 s, Result = 92860000, Performance =  89.49 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020503 s, Result = 12a40000, Performance =  92.17 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021221 s, Result = 92c20000, Performance =  93.10 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.021660 s, Result = 12e00000, Performance =  95.18 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.021829 s, Result = 92fe0000, Performance =  98.38 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022473 s, Result = 131c0000, Performance =  99.38 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.022483 s, Result = 933a0000, Performance = 103.16 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023054 s, Result = 13580000, Performance = 104.33 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.023425 s, Result = 93760000, Performance = 106.34 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024014 s, Result = 13940000, Performance = 107.31 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.024558 s, Result = 93b20000, Performance = 108.43 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.025201 s, Result = 13d00000, Performance = 109.07 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025871 s, Result = 93ee0000, Performance = 109.57 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.026278 s, Result = 140c0000, Performance = 111.14 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026380 s, Result = 942a0000, Performance = 113.97 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.027056 s, Result = 14480000, Performance = 114.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027695 s, Result = 94660000, Performance = 114.76 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.028354 s, Result = 14840000, Performance = 115.12 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.028731 s, Result = 94a20000, Performance = 116.60 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029322 s, Result = 14c00000, Performance = 117.18 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.030238 s, Result = 94de0000, Performance = 116.47 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.030142 s, Result = 14fc0000, Performance = 119.69 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.031595 s, Result = 951a0000, Performance = 116.91 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031192 s, Result = 15380000, Performance = 121.17 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.032151 s, Result = 95560000, Performance = 120.23 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.033201 s, Result = 15740000, Performance = 119.01 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.033942 s, Result = 95920000, Performance = 118.95 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034592 s, Result = 15b00000, Performance = 119.20 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.034977 s, Result = 95ce0000, Performance = 120.34 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.035319 s, Result = 15ec0000, Performance = 121.60 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.036196 s, Result = 960a0000, Performance = 121.03 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.036592 s, Result = 16280000, Performance = 122.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.038015 s, Result = 96460000, Performance = 119.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.038257 s, Result = 16640000, Performance = 121.25 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039990 s, Result = 96820000, Performance = 118.14 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.040034 s, Result = 16a00000, Performance = 120.16 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.041078 s, Result = 96be0000, Performance = 119.19 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.042014 s, Result = 16dc0000, Performance = 118.58 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.042918 s, Result = 96fa0000, Performance = 118.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042932 s, Result = 17180000, Performance = 120.05 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.044502 s, Result = 97360000, Performance = 117.75 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.044839 s, Result = 17540000, Performance = 118.78 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.046843 s, Result = 97720000, Performance = 115.53 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.047536 s, Result = 17900000, Performance = 115.65 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   185  1159  1728
Test passed: M N K =  1166  1009   832
Test passed: M N K =  1017   424  1536
Test passed: M N K =   485  1570  1600
Test passed: M N K =  1023  1070   512
M N K =  4096  4096   256, Elapsed time =   0.012940 s, Result = 001e0000, Performance =   6.64 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011018 s, Result = 003c0000, Performance =  15.59 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011898 s, Result = 005a0000, Performance =  21.66 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011556 s, Result = 00780000, Performance =  29.73 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011655 s, Result = 00960000, Performance =  36.85 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011288 s, Result = 00b40000, Performance =  45.66 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015835 s, Result = 00d20000, Performance =  37.97 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011442 s, Result = 00f00000, Performance =  60.06 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013023 s, Result = 010e0000, Performance =  59.36 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012877 s, Result = 012c0000, Performance =  66.71 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013561 s, Result = 014a0000, Performance =  69.68 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014267 s, Result = 01680000, Performance =  72.25 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014127 s, Result = 01860000, Performance =  79.05 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014697 s, Result = 01a40000, Performance =  81.83 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014961 s, Result = 01c20000, Performance =  86.12 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.015132 s, Result = 01e00000, Performance =  90.83 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.015854 s, Result = 01fe0000, Performance =  92.11 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016351 s, Result = 021c0000, Performance =  94.56 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.016640 s, Result = 023a0000, Performance =  98.08 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.016686 s, Result = 02580000, Performance = 102.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017631 s, Result = 02760000, Performance = 102.31 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017718 s, Result = 02940000, Performance = 106.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018081 s, Result = 02b20000, Performance = 109.27 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019602 s, Result = 02d00000, Performance = 105.17 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.018767 s, Result = 02ee0000, Performance = 114.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019400 s, Result = 030c0000, Performance = 115.12 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.019440 s, Result = 032a0000, Performance = 119.30 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019770 s, Result = 03480000, Performance = 121.66 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020868 s, Result = 03660000, Performance = 119.37 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020434 s, Result = 03840000, Performance = 126.11 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020954 s, Result = 03a20000, Performance = 127.08 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021736 s, Result = 03c00000, Performance = 126.46 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021665 s, Result = 03de0000, Performance = 130.84 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022402 s, Result = 03fc0000, Performance = 130.37 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022936 s, Result = 041a0000, Performance = 131.08 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023426 s, Result = 04380000, Performance = 132.00 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023544 s, Result = 04560000, Performance = 134.99 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024247 s, Result = 04740000, Performance = 134.62 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024947 s, Result = 04920000, Performance = 134.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025425 s, Result = 04b00000, Performance = 135.14 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025271 s, Result = 04ce0000, Performance = 139.36 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.025932 s, Result = 04ec0000, Performance = 139.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026584 s, Result = 050a0000, Performance = 138.94 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026812 s, Result = 05280000, Performance = 140.96 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027202 s, Result = 05460000, Performance = 142.10 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.027742 s, Result = 05640000, Performance = 142.43 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028112 s, Result = 05820000, Performance = 143.61 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.029070 s, Result = 05a00000, Performance = 141.84 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029409 s, Result = 05be0000, Performance = 143.12 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029901 s, Result = 05dc0000, Performance = 143.64 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030380 s, Result = 05fa0000, Performance = 144.20 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030532 s, Result = 06180000, Performance = 146.30 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031611 s, Result = 06360000, Performance = 144.02 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032447 s, Result = 06540000, Performance = 142.96 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.032879 s, Result = 06720000, Performance = 143.69 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.033740 s, Result = 06900000, Performance = 142.57 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.034248 s, Result = 06ae0000, Performance = 142.97 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.035727 s, Result = 06cc0000, Performance = 139.45 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.036685 s, Result = 06ea0000, Performance = 138.15 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.036159 s, Result = 07080000, Performance = 142.54 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.037335 s, Result = 07260000, Performance = 140.35 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.037978 s, Result = 07440000, Performance = 140.23 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039174 s, Result = 07620000, Performance = 138.15 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.040185 s, Result = 07800000, Performance = 136.81 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   567    33   320
Test passed: M N K =  1551   992   192
Test passed: M N K =   570  1415  1984
Test passed: M N K =  1833   996   960
Test passed: M N K =   403  1677   576
M N K =  4096  4096   256, Elapsed time =   0.006383 s, Result = a0be0000, Performance =  13.46 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006500 s, Result = a0dc0000, Performance =  26.43 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007025 s, Result = a0fa0000, Performance =  36.68 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007310 s, Result = a1180000, Performance =  47.00 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007934 s, Result = a1360000, Performance =  54.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007993 s, Result = a1540000, Performance =  64.48 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.009242 s, Result = a1720000, Performance =  65.06 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009004 s, Result = a1900000, Performance =  76.32 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009153 s, Result = a1ae0000, Performance =  84.47 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009371 s, Result = a1cc0000, Performance =  91.66 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009786 s, Result = a1ea0000, Performance =  96.56 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010191 s, Result = a2080000, Performance = 101.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010986 s, Result = a2260000, Performance = 101.65 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011153 s, Result = a2440000, Performance = 107.83 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011723 s, Result = a2620000, Performance = 109.91 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013075 s, Result = a2800000, Performance = 105.11 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020322 s, Result = a29e0000, Performance =  71.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.012818 s, Result = a2bc0000, Performance = 120.62 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013410 s, Result = a2da0000, Performance = 121.71 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.013782 s, Result = a2f80000, Performance = 124.65 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014290 s, Result = a3160000, Performance = 126.23 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014508 s, Result = a3340000, Performance = 130.25 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014789 s, Result = a3520000, Performance = 133.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016998 s, Result = a3700000, Performance = 121.28 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015598 s, Result = a38e0000, Performance = 137.68 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016019 s, Result = a3ac0000, Performance = 139.42 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.016317 s, Result = a3ca0000, Performance = 142.14 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.016804 s, Result = a3e80000, Performance = 143.13 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017358 s, Result = a4060000, Performance = 143.52 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.017492 s, Result = a4240000, Performance = 147.32 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.018163 s, Result = a4420000, Performance = 146.61 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020986 s, Result = a4600000, Performance = 130.98 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.018684 s, Result = a47e0000, Performance = 151.72 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.019500 s, Result = a49c0000, Performance = 149.78 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.019907 s, Result = a4ba0000, Performance = 151.03 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020050 s, Result = a4d80000, Performance = 154.24 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.020933 s, Result = a4f60000, Performance = 151.83 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.020859 s, Result = a5140000, Performance = 156.49 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.022005 s, Result = a5320000, Performance = 152.24 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.023545 s, Result = a5500000, Performance = 145.93 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.022357 s, Result = a56e0000, Performance = 157.53 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.022949 s, Result = a58c0000, Performance = 157.21 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023761 s, Result = a5aa0000, Performance = 155.45 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.023986 s, Result = a5c80000, Performance = 157.58 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.024668 s, Result = a5e60000, Performance = 156.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.024867 s, Result = a6040000, Performance = 158.90 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.025754 s, Result = a6220000, Performance = 156.76 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028584 s, Result = a6400000, Performance = 144.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.026567 s, Result = a65e0000, Performance = 158.43 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.027622 s, Result = a67c0000, Performance = 155.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.027767 s, Result = a69a0000, Performance = 157.77 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.028445 s, Result = a6b80000, Performance = 157.03 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.029235 s, Result = a6d60000, Performance = 155.73 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.029656 s, Result = a6f40000, Performance = 156.41 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.030560 s, Result = a7120000, Performance = 154.60 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032386 s, Result = a7300000, Performance = 148.53 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.031687 s, Result = a74e0000, Performance = 154.52 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.032160 s, Result = a76c0000, Performance = 154.92 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.033543 s, Result = a78a0000, Performance = 151.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.033944 s, Result = a7a80000, Performance = 151.84 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.034317 s, Result = a7c60000, Performance = 152.69 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035520 s, Result = a7e40000, Performance = 149.94 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.036001 s, Result = a8020000, Performance = 150.32 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.039452 s, Result = a8200000, Performance = 139.35 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1682  1055  2048
Test passed: M N K =  1432  1047   512
Test passed: M N K =    62   200   320
Test passed: M N K =    52   267  1920
Test passed: M N K =  1556    51  1408
M N K =  4096  4096   256, Elapsed time =   0.000727 s, Result = 001e0000, Performance = 118.09 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001467 s, Result = 003c0000, Performance = 117.10 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002064 s, Result = 005a0000, Performance = 124.85 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002596 s, Result = 00780000, Performance = 132.37 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002943 s, Result = 00960000, Performance = 145.94 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003377 s, Result = 00b40000, Performance = 152.63 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003902 s, Result = 00d20000, Performance = 154.09 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004356 s, Result = 00f00000, Performance = 157.77 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004593 s, Result = 010e0000, Performance = 168.32 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005036 s, Result = 012c0000, Performance = 170.57 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.005276 s, Result = 014a0000, Performance = 179.09 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.005725 s, Result = 01680000, Performance = 180.06 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.006264 s, Result = 01860000, Performance = 178.27 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.006622 s, Result = 01a40000, Performance = 181.61 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.006999 s, Result = 01c20000, Performance = 184.11 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.008191 s, Result = 01e00000, Performance = 167.78 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.007753 s, Result = 01fe0000, Performance = 188.36 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.007890 s, Result = 021c0000, Performance = 195.98 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.008556 s, Result = 023a0000, Performance = 190.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.008955 s, Result = 02580000, Performance = 191.85 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.009255 s, Result = 02760000, Performance = 194.91 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.009646 s, Result = 02940000, Performance = 195.91 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.010012 s, Result = 02b20000, Performance = 197.33 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.011571 s, Result = 02d00000, Performance = 178.17 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015897 s, Result = 02ee0000, Performance = 135.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.010952 s, Result = 030c0000, Performance = 203.93 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.011459 s, Result = 032a0000, Performance = 202.39 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.012459 s, Result = 03480000, Performance = 193.04 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.012314 s, Result = 03660000, Performance = 202.30 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.012829 s, Result = 03840000, Performance = 200.87 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.013278 s, Result = 03a20000, Performance = 200.54 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.014531 s, Result = 03c00000, Performance = 189.17 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.013833 s, Result = 03de0000, Performance = 204.91 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.014168 s, Result = 03fc0000, Performance = 206.14 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.014698 s, Result = 041a0000, Performance = 204.55 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.015137 s, Result = 04380000, Performance = 204.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.015333 s, Result = 04560000, Performance = 207.29 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.015945 s, Result = 04740000, Performance = 204.72 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.016091 s, Result = 04920000, Performance = 208.20 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.018022 s, Result = 04b00000, Performance = 190.65 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.016899 s, Result = 04ce0000, Performance = 208.41 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.017255 s, Result = 04ec0000, Performance = 209.09 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.017737 s, Result = 050a0000, Performance = 208.25 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.017854 s, Result = 05280000, Performance = 211.69 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.018403 s, Result = 05460000, Performance = 210.05 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.018767 s, Result = 05640000, Performance = 210.55 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.019370 s, Result = 05820000, Performance = 208.43 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.020851 s, Result = 05a00000, Performance = 197.75 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.020277 s, Result = 05be0000, Performance = 207.58 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.020807 s, Result = 05dc0000, Performance = 206.42 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.021088 s, Result = 05fa0000, Performance = 207.74 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.021589 s, Result = 06180000, Performance = 206.90 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.022685 s, Result = 06360000, Performance = 200.69 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.022657 s, Result = 06540000, Performance = 204.73 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.023625 s, Result = 06720000, Performance = 199.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.024316 s, Result = 06900000, Performance = 197.82 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.025014 s, Result = 06ae0000, Performance = 195.74 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.025732 s, Result = 06cc0000, Performance = 193.62 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.027768 s, Result = 06ea0000, Performance = 182.52 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.027197 s, Result = 07080000, Performance = 189.50 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.027734 s, Result = 07260000, Performance = 188.93 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.028516 s, Result = 07440000, Performance = 186.77 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.029215 s, Result = 07620000, Performance = 185.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.032844 s, Result = 07800000, Performance = 167.38 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   779   697   128
Test passed: M N K =   733   479  1408
Test passed: M N K =  1214  1171   768
Test passed: M N K =  1535  1652   256
Test passed: M N K =   224  1407   960
M N K =  4096  4096   256, Elapsed time =   0.010188 s, Result = 902e0000, Performance =   8.43 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011041 s, Result = 104c0000, Performance =  15.56 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011869 s, Result = 906a0000, Performance =  21.71 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012641 s, Result = 10880000, Performance =  27.18 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013202 s, Result = 90a60000, Performance =  32.53 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013960 s, Result = 10c40000, Performance =  36.92 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.015608 s, Result = 90e20000, Performance =  38.52 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014035 s, Result = 11000000, Performance =  48.96 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015119 s, Result = 911e0000, Performance =  51.13 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015441 s, Result = 113c0000, Performance =  55.63 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016179 s, Result = 915a0000, Performance =  58.40 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016317 s, Result = 11780000, Performance =  63.17 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.016892 s, Result = 91960000, Performance =  66.11 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017060 s, Result = 11b40000, Performance =  70.49 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017660 s, Result = 91d20000, Performance =  72.96 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018086 s, Result = 11f00000, Performance =  75.99 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019823 s, Result = 920e0000, Performance =  73.67 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.018468 s, Result = 122c0000, Performance =  83.72 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.019259 s, Result = 924a0000, Performance =  84.74 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.019650 s, Result = 12680000, Performance =  87.43 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.020040 s, Result = 92860000, Performance =  90.01 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.020824 s, Result = 12a40000, Performance =  90.75 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021282 s, Result = 92c20000, Performance =  92.83 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022283 s, Result = 12e00000, Performance =  92.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022240 s, Result = 92fe0000, Performance =  96.56 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.022640 s, Result = 131c0000, Performance =  98.65 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.023032 s, Result = 933a0000, Performance = 100.70 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.023629 s, Result = 13580000, Performance = 101.79 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.024037 s, Result = 93760000, Performance = 103.64 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.024429 s, Result = 13940000, Performance = 105.49 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.024893 s, Result = 93b20000, Performance = 106.97 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026353 s, Result = 13d00000, Performance = 104.31 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.025593 s, Result = 93ee0000, Performance = 110.76 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025969 s, Result = 140c0000, Performance = 112.46 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.026511 s, Result = 942a0000, Performance = 113.41 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.026904 s, Result = 14480000, Performance = 114.94 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.027542 s, Result = 94660000, Performance = 115.40 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.027895 s, Result = 14840000, Performance = 117.02 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.028620 s, Result = 94a20000, Performance = 117.05 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.029660 s, Result = 14c00000, Performance = 115.84 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.029426 s, Result = 94de0000, Performance = 119.69 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.030625 s, Result = 14fc0000, Performance = 117.81 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.030514 s, Result = 951a0000, Performance = 121.05 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.031127 s, Result = 15380000, Performance = 121.43 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.031629 s, Result = 95560000, Performance = 122.21 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.032283 s, Result = 15740000, Performance = 122.40 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.033150 s, Result = 95920000, Performance = 121.79 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034818 s, Result = 15b00000, Performance = 118.42 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.033957 s, Result = 95ce0000, Performance = 123.95 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.034761 s, Result = 15ec0000, Performance = 123.56 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.035226 s, Result = 960a0000, Performance = 124.37 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.035669 s, Result = 16280000, Performance = 125.23 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.036336 s, Result = 96460000, Performance = 125.29 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.037000 s, Result = 16640000, Performance = 125.37 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.037758 s, Result = 96820000, Performance = 125.13 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.038298 s, Result = 16a00000, Performance = 125.60 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.039035 s, Result = 96be0000, Performance = 125.43 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.039719 s, Result = 16dc0000, Performance = 125.44 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.040963 s, Result = 96fa0000, Performance = 123.72 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.040762 s, Result = 17180000, Performance = 126.44 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042556 s, Result = 97360000, Performance = 123.13 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.042509 s, Result = 17540000, Performance = 125.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.043910 s, Result = 97720000, Performance = 123.25 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.044294 s, Result = 17900000, Performance = 124.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1141  1883   576
Test passed: M N K =  1667  1305  1984
Test passed: M N K =   627  1844   512
Test passed: M N K =   554  1488  1088
Test passed: M N K =    64   877  1152
M N K =  4096  4096   256, Elapsed time =   0.012653 s, Result = 001e0000, Performance =   6.79 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010821 s, Result = 003c0000, Performance =  15.88 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012052 s, Result = 005a0000, Performance =  21.38 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011257 s, Result = 00780000, Performance =  30.52 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012029 s, Result = 00960000, Performance =  35.71 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.012005 s, Result = 00b40000, Performance =  42.93 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011877 s, Result = 00d20000, Performance =  50.63 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011724 s, Result = 00f00000, Performance =  58.61 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012556 s, Result = 010e0000, Performance =  61.57 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013170 s, Result = 012c0000, Performance =  65.22 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013259 s, Result = 014a0000, Performance =  71.26 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013366 s, Result = 01680000, Performance =  77.12 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014478 s, Result = 01860000, Performance =  77.13 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014735 s, Result = 01a40000, Performance =  81.62 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.020051 s, Result = 01c20000, Performance =  64.26 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014763 s, Result = 01e00000, Performance =  93.10 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016222 s, Result = 01fe0000, Performance =  90.02 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016694 s, Result = 021c0000, Performance =  92.62 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017184 s, Result = 023a0000, Performance =  94.98 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017165 s, Result = 02580000, Performance = 100.08 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017731 s, Result = 02760000, Performance = 101.73 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018031 s, Result = 02940000, Performance = 104.81 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019183 s, Result = 02b20000, Performance = 102.99 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019251 s, Result = 02d00000, Performance = 107.09 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020065 s, Result = 02ee0000, Performance = 107.03 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020366 s, Result = 030c0000, Performance = 109.66 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020679 s, Result = 032a0000, Performance = 112.15 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020948 s, Result = 03480000, Performance = 114.82 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.021382 s, Result = 03660000, Performance = 116.50 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.021799 s, Result = 03840000, Performance = 118.22 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022049 s, Result = 03a20000, Performance = 120.77 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.022353 s, Result = 03c00000, Performance = 122.97 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.022968 s, Result = 03de0000, Performance = 123.42 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.023452 s, Result = 03fc0000, Performance = 124.54 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.024154 s, Result = 041a0000, Performance = 124.47 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023641 s, Result = 04380000, Performance = 130.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.024540 s, Result = 04560000, Performance = 129.52 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024958 s, Result = 04740000, Performance = 130.79 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.025218 s, Result = 04920000, Performance = 132.85 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.026601 s, Result = 04b00000, Performance = 129.17 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025897 s, Result = 04ce0000, Performance = 135.99 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026454 s, Result = 04ec0000, Performance = 136.38 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.027226 s, Result = 050a0000, Performance = 135.66 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.027374 s, Result = 05280000, Performance = 138.07 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027794 s, Result = 05460000, Performance = 139.08 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.028412 s, Result = 05640000, Performance = 139.07 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028330 s, Result = 05820000, Performance = 142.51 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.030575 s, Result = 05a00000, Performance = 134.86 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029653 s, Result = 05be0000, Performance = 141.95 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029831 s, Result = 05dc0000, Performance = 143.98 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030437 s, Result = 05fa0000, Performance = 143.93 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030924 s, Result = 06180000, Performance = 144.44 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031105 s, Result = 06360000, Performance = 146.36 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032130 s, Result = 06540000, Performance = 144.37 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.032225 s, Result = 06720000, Performance = 146.61 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.034136 s, Result = 06900000, Performance = 140.92 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.033277 s, Result = 06ae0000, Performance = 147.14 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.033871 s, Result = 06cc0000, Performance = 147.09 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.034303 s, Result = 06ea0000, Performance = 147.74 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.034543 s, Result = 07080000, Performance = 149.20 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.035183 s, Result = 07260000, Performance = 148.93 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035962 s, Result = 07440000, Performance = 148.09 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.036584 s, Result = 07620000, Performance = 147.92 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038666 s, Result = 07800000, Performance = 142.18 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   351   257  1728
Test passed: M N K =  1004   828  1664
Test passed: M N K =  1607  1425  2048
Test passed: M N K =  1342  1960   256
Test passed: M N K =  1598   281   960
M N K =  4096  4096   256, Elapsed time =   0.006357 s, Result = a0be0000, Performance =  13.51 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006429 s, Result = a0dc0000, Performance =  26.72 TOPS
M N K =  4096  4096   768, Elapsed time =   0.007128 s, Result = a0fa0000, Performance =  36.15 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007204 s, Result = a1180000, Performance =  47.70 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008111 s, Result = a1360000, Performance =  52.95 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009693 s, Result = a1540000, Performance =  53.17 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008521 s, Result = a1720000, Performance =  70.57 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009117 s, Result = a1900000, Performance =  75.38 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009678 s, Result = a1ae0000, Performance =  79.88 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010399 s, Result = a1cc0000, Performance =  82.60 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010788 s, Result = a1ea0000, Performance =  87.58 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010933 s, Result = a2080000, Performance =  94.28 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011827 s, Result = a2260000, Performance =  94.42 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012361 s, Result = a2440000, Performance =  97.29 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019659 s, Result = a2620000, Performance =  65.54 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.013659 s, Result = a2800000, Performance = 100.62 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013372 s, Result = a29e0000, Performance = 109.20 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013922 s, Result = a2bc0000, Performance = 111.06 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014044 s, Result = a2da0000, Performance = 116.22 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014392 s, Result = a2f80000, Performance = 119.37 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014822 s, Result = a3160000, Performance = 121.71 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.015514 s, Result = a3340000, Performance = 121.81 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015842 s, Result = a3520000, Performance = 124.71 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.016660 s, Result = a3700000, Performance = 123.74 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.016457 s, Result = a38e0000, Performance = 130.49 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.017603 s, Result = a3ac0000, Performance = 126.87 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017339 s, Result = a3ca0000, Performance = 133.76 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.017772 s, Result = a3e80000, Performance = 135.34 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018346 s, Result = a4060000, Performance = 135.78 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018957 s, Result = a4240000, Performance = 135.94 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.019361 s, Result = a4420000, Performance = 137.54 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020733 s, Result = a4600000, Performance = 132.58 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.019591 s, Result = a47e0000, Performance = 144.69 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.020613 s, Result = a49c0000, Performance = 141.69 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.020520 s, Result = a4ba0000, Performance = 146.52 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.021448 s, Result = a4d80000, Performance = 144.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.021404 s, Result = a4f60000, Performance = 148.49 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.021983 s, Result = a5140000, Performance = 148.49 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.022238 s, Result = a5320000, Performance = 150.65 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.023778 s, Result = a5500000, Performance = 144.50 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.023222 s, Result = a56e0000, Performance = 151.66 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.023718 s, Result = a58c0000, Performance = 152.11 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023870 s, Result = a5aa0000, Performance = 154.74 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.024365 s, Result = a5c80000, Performance = 155.13 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.025221 s, Result = a5e60000, Performance = 153.26 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.025557 s, Result = a6040000, Performance = 154.61 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.025876 s, Result = a6220000, Performance = 156.03 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028938 s, Result = a6400000, Performance = 142.48 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.026677 s, Result = a65e0000, Performance = 157.78 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.027075 s, Result = a67c0000, Performance = 158.63 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.027638 s, Result = a69a0000, Performance = 158.51 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.027821 s, Result = a6b80000, Performance = 160.55 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.028225 s, Result = a6d60000, Performance = 161.30 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.029164 s, Result = a6f40000, Performance = 159.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.029260 s, Result = a7120000, Performance = 161.46 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.030734 s, Result = a7300000, Performance = 156.52 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.030502 s, Result = a74e0000, Performance = 160.52 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.031313 s, Result = a76c0000, Performance = 159.11 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.031659 s, Result = a78a0000, Performance = 160.08 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.031877 s, Result = a7a80000, Performance = 161.68 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.032882 s, Result = a7c60000, Performance = 159.35 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.033559 s, Result = a7e40000, Performance = 158.70 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.034252 s, Result = a8020000, Performance = 158.00 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.036694 s, Result = a8200000, Performance = 149.82 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   901  1067  1728
Test passed: M N K =  1460   478  1024
Test passed: M N K =  2035  1881   896
Test passed: M N K =  1934  1671  1216
Test passed: M N K =   301  1802  1216
M N K =  4096  4096   256, Elapsed time =   0.000707 s, Result = 001e0000, Performance = 121.52 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001412 s, Result = 003c0000, Performance = 121.66 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002113 s, Result = 005a0000, Performance = 121.95 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002656 s, Result = 00780000, Performance = 129.38 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003164 s, Result = 00960000, Performance = 135.73 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003593 s, Result = 00b40000, Performance = 143.45 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004013 s, Result = 00d20000, Performance = 149.84 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004280 s, Result = 00f00000, Performance = 160.57 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004856 s, Result = 010e0000, Performance = 159.20 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005322 s, Result = 012c0000, Performance = 161.41 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.005723 s, Result = 014a0000, Performance = 165.11 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.006181 s, Result = 01680000, Performance = 166.78 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.006607 s, Result = 01860000, Performance = 169.01 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010101 s, Result = 01a40000, Performance = 119.05 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.007501 s, Result = 01c20000, Performance = 171.77 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.007605 s, Result = 01e00000, Performance = 180.73 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.008164 s, Result = 01fe0000, Performance = 178.87 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.008735 s, Result = 021c0000, Performance = 177.01 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.009130 s, Result = 023a0000, Performance = 178.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.009394 s, Result = 02580000, Performance = 182.89 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.009754 s, Result = 02760000, Performance = 184.93 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.010051 s, Result = 02940000, Performance = 188.01 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.010872 s, Result = 02b20000, Performance = 181.72 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.013796 s, Result = 02d00000, Performance = 149.43 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.011273 s, Result = 02ee0000, Performance = 190.49 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.011909 s, Result = 030c0000, Performance = 187.54 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.012298 s, Result = 032a0000, Performance = 188.59 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.012446 s, Result = 03480000, Performance = 193.25 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.013322 s, Result = 03660000, Performance = 187.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.013879 s, Result = 03840000, Performance = 185.68 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.014085 s, Result = 03a20000, Performance = 189.06 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.015050 s, Result = 03c00000, Performance = 182.64 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.014785 s, Result = 03de0000, Performance = 191.73 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.015397 s, Result = 03fc0000, Performance = 189.68 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.015626 s, Result = 041a0000, Performance = 192.41 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.015975 s, Result = 04380000, Performance = 193.58 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.016577 s, Result = 04560000, Performance = 191.73 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.016847 s, Result = 04740000, Performance = 193.76 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.017110 s, Result = 04920000, Performance = 195.80 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.018502 s, Result = 04b00000, Performance = 185.71 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.017804 s, Result = 04ce0000, Performance = 197.81 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.018285 s, Result = 04ec0000, Performance = 197.31 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.018614 s, Result = 050a0000, Performance = 198.43 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.018676 s, Result = 05280000, Performance = 202.38 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.019255 s, Result = 05460000, Performance = 200.75 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.019782 s, Result = 05640000, Performance = 199.74 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.019900 s, Result = 05820000, Performance = 202.88 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.022310 s, Result = 05a00000, Performance = 184.81 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.020989 s, Result = 05be0000, Performance = 200.54 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.021306 s, Result = 05dc0000, Performance = 201.59 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.021887 s, Result = 05fa0000, Performance = 200.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.021956 s, Result = 06180000, Performance = 203.45 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.022177 s, Result = 06360000, Performance = 205.29 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.023004 s, Result = 06540000, Performance = 201.65 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.023161 s, Result = 06720000, Performance = 203.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.025274 s, Result = 06900000, Performance = 190.33 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.024298 s, Result = 06ae0000, Performance = 201.51 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.024799 s, Result = 06cc0000, Performance = 200.90 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.025184 s, Result = 06ea0000, Performance = 201.24 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.025247 s, Result = 07080000, Performance = 204.14 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.026084 s, Result = 07260000, Performance = 200.88 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.027048 s, Result = 07440000, Performance = 196.90 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.027378 s, Result = 07620000, Performance = 197.66 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.029847 s, Result = 07800000, Performance = 184.19 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1799   903   256
Test passed: M N K =  1768  2038   896
Test passed: M N K =  1809   212   192
Test passed: M N K =   690  1318  1856
Test passed: M N K =  1766    70  1280
M N K =  4096  4096   256, Elapsed time =   0.010294 s, Result = 902e0000, Performance =   8.34 TOPS
M N K =  4096  4096   512, Elapsed time =   0.010961 s, Result = 104c0000, Performance =  15.67 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011657 s, Result = 906a0000, Performance =  22.11 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012371 s, Result = 10880000, Performance =  27.77 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013100 s, Result = 90a60000, Performance =  32.79 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014893 s, Result = 10c40000, Performance =  34.61 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013983 s, Result = 90e20000, Performance =  43.00 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014541 s, Result = 11000000, Performance =  47.26 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014726 s, Result = 911e0000, Performance =  52.50 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015471 s, Result = 113c0000, Performance =  55.52 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015849 s, Result = 915a0000, Performance =  59.62 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016061 s, Result = 11780000, Performance =  64.18 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.016629 s, Result = 91960000, Performance =  67.15 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.017463 s, Result = 11b40000, Performance =  68.87 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017733 s, Result = 91d20000, Performance =  72.66 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.018312 s, Result = 11f00000, Performance =  75.05 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.018827 s, Result = 920e0000, Performance =  77.56 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.019171 s, Result = 122c0000, Performance =  80.65 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.020138 s, Result = 924a0000, Performance =  81.04 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.020326 s, Result = 12680000, Performance =  84.52 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.020917 s, Result = 92860000, Performance =  86.24 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.021424 s, Result = 12a40000, Performance =  88.21 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.021589 s, Result = 92c20000, Performance =  91.51 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.022143 s, Result = 12e00000, Performance =  93.10 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.022567 s, Result = 92fe0000, Performance =  95.16 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.023190 s, Result = 131c0000, Performance =  96.31 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.024252 s, Result = 933a0000, Performance =  95.63 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.024652 s, Result = 13580000, Performance =  97.57 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.025511 s, Result = 93760000, Performance =  97.65 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.025811 s, Result = 13940000, Performance =  99.84 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.026480 s, Result = 93b20000, Performance = 100.56 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.026382 s, Result = 13d00000, Performance = 104.19 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.027518 s, Result = 93ee0000, Performance = 103.01 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.027853 s, Result = 140c0000, Performance = 104.86 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.028137 s, Result = 942a0000, Performance = 106.85 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.028552 s, Result = 14480000, Performance = 108.31 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.029288 s, Result = 94660000, Performance = 108.52 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.030040 s, Result = 14840000, Performance = 108.66 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.030231 s, Result = 94a20000, Performance = 110.81 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.030772 s, Result = 14c00000, Performance = 111.66 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.031701 s, Result = 94de0000, Performance = 111.10 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.032110 s, Result = 14fc0000, Performance = 112.36 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.032724 s, Result = 951a0000, Performance = 112.87 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.032912 s, Result = 15380000, Performance = 114.84 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.033774 s, Result = 95560000, Performance = 114.45 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.034226 s, Result = 15740000, Performance = 115.45 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.034967 s, Result = 95920000, Performance = 115.46 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.034576 s, Result = 15b00000, Performance = 119.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.035849 s, Result = 95ce0000, Performance = 117.41 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.036367 s, Result = 15ec0000, Performance = 118.10 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.037161 s, Result = 960a0000, Performance = 117.89 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.037553 s, Result = 16280000, Performance = 118.94 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.038354 s, Result = 96460000, Performance = 118.70 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.038583 s, Result = 16640000, Performance = 120.22 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.039469 s, Result = 96820000, Performance = 119.70 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.039275 s, Result = 16a00000, Performance = 122.48 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.040525 s, Result = 96be0000, Performance = 120.82 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.040936 s, Result = 16dc0000, Performance = 121.71 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.041587 s, Result = 96fa0000, Performance = 121.87 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.042124 s, Result = 17180000, Performance = 122.35 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.042821 s, Result = 97360000, Performance = 122.37 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.043512 s, Result = 17540000, Performance = 122.40 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.044172 s, Result = 97720000, Performance = 122.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.043968 s, Result = 17900000, Performance = 125.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   231   912   192
Test passed: M N K =   944    84   512
Test passed: M N K =  1271   375  1920
Test passed: M N K =    10   873  1600
Test passed: M N K =  1455  1807  1280
M N K =  4096  4096   256, Elapsed time =   0.012757 s, Result = 001e0000, Performance =   6.73 TOPS
M N K =  4096  4096   512, Elapsed time =   0.011272 s, Result = 003c0000, Performance =  15.24 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011415 s, Result = 005a0000, Performance =  22.57 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011550 s, Result = 00780000, Performance =  29.75 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011381 s, Result = 00960000, Performance =  37.74 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011928 s, Result = 00b40000, Performance =  43.21 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013552 s, Result = 00d20000, Performance =  44.37 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011745 s, Result = 00f00000, Performance =  58.51 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012394 s, Result = 010e0000, Performance =  62.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012861 s, Result = 012c0000, Performance =  66.79 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013627 s, Result = 014a0000, Performance =  69.34 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014100 s, Result = 01680000, Performance =  73.11 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014552 s, Result = 01860000, Performance =  76.74 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014645 s, Result = 01a40000, Performance =  82.12 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015766 s, Result = 01c20000, Performance =  81.72 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022396 s, Result = 01e00000, Performance =  61.37 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016411 s, Result = 01fe0000, Performance =  88.98 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017123 s, Result = 021c0000, Performance =  90.30 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017495 s, Result = 023a0000, Performance =  93.29 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017840 s, Result = 02580000, Performance =  96.30 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018165 s, Result = 02760000, Performance =  99.31 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018802 s, Result = 02940000, Performance = 100.51 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.019719 s, Result = 02b20000, Performance = 100.19 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019536 s, Result = 02d00000, Performance = 105.53 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020502 s, Result = 02ee0000, Performance = 104.74 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020972 s, Result = 030c0000, Performance = 106.49 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.021335 s, Result = 032a0000, Performance = 108.71 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.021754 s, Result = 03480000, Performance = 110.56 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.022041 s, Result = 03660000, Performance = 113.02 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022910 s, Result = 03840000, Performance = 112.48 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.023467 s, Result = 03a20000, Performance = 113.47 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.022878 s, Result = 03c00000, Performance = 120.15 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.024226 s, Result = 03de0000, Performance = 117.01 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.025011 s, Result = 03fc0000, Performance = 116.77 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.025524 s, Result = 041a0000, Performance = 117.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.025568 s, Result = 04380000, Performance = 120.95 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.026473 s, Result = 04560000, Performance = 120.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.026914 s, Result = 04740000, Performance = 121.28 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.027385 s, Result = 04920000, Performance = 122.33 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.027387 s, Result = 04b00000, Performance = 125.46 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.028447 s, Result = 04ce0000, Performance = 123.80 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.028609 s, Result = 04ec0000, Performance = 126.11 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.029347 s, Result = 050a0000, Performance = 125.86 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.029565 s, Result = 05280000, Performance = 127.84 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.030574 s, Result = 05460000, Performance = 126.43 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.030720 s, Result = 05640000, Performance = 128.62 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.031681 s, Result = 05820000, Performance = 127.44 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.030753 s, Result = 05a00000, Performance = 134.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.032097 s, Result = 05be0000, Performance = 131.14 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.032701 s, Result = 05dc0000, Performance = 131.34 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.033274 s, Result = 05fa0000, Performance = 131.66 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.033455 s, Result = 06180000, Performance = 133.51 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.034215 s, Result = 06360000, Performance = 133.06 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.035003 s, Result = 06540000, Performance = 132.52 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.035487 s, Result = 06720000, Performance = 133.13 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.035330 s, Result = 06900000, Performance = 136.16 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.036623 s, Result = 06ae0000, Performance = 133.69 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.037131 s, Result = 06cc0000, Performance = 134.18 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.037462 s, Result = 06ea0000, Performance = 135.28 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.037783 s, Result = 07080000, Performance = 136.41 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.038312 s, Result = 07260000, Performance = 136.77 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.039021 s, Result = 07440000, Performance = 136.49 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039673 s, Result = 07620000, Performance = 136.41 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038682 s, Result = 07800000, Performance = 142.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1945  1332   576
Test passed: M N K =  1194   419   576
Test passed: M N K =   478   634   320
Test passed: M N K =   581  2000  1984
Test passed: M N K =  1631   311  1088
M N K =  4096  4096   256, Elapsed time =   0.006535 s, Result = a0be0000, Performance =  13.14 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006573 s, Result = a0dc0000, Performance =  26.14 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006884 s, Result = a0fa0000, Performance =  37.44 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.007207 s, Result = a1180000, Performance =  47.68 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007818 s, Result = a1360000, Performance =  54.94 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008072 s, Result = a1540000, Performance =  63.85 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008404 s, Result = a1720000, Performance =  71.55 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009181 s, Result = a1900000, Performance =  74.85 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009536 s, Result = a1ae0000, Performance =  81.07 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010569 s, Result = a1cc0000, Performance =  81.27 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010883 s, Result = a1ea0000, Performance =  86.82 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011269 s, Result = a2080000, Performance =  91.47 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011516 s, Result = a2260000, Performance =  96.97 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012476 s, Result = a2440000, Performance =  96.39 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012575 s, Result = a2620000, Performance = 102.47 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017299 s, Result = a2800000, Performance =  79.45 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.013605 s, Result = a29e0000, Performance = 107.34 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.014306 s, Result = a2bc0000, Performance = 108.08 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.014983 s, Result = a2da0000, Performance = 108.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.015491 s, Result = a2f80000, Performance = 110.90 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.015445 s, Result = a3160000, Performance = 116.79 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.016308 s, Result = a3340000, Performance = 115.88 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.016802 s, Result = a3520000, Performance = 117.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.017049 s, Result = a3700000, Performance = 120.92 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.017669 s, Result = a38e0000, Performance = 121.54 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.018344 s, Result = a3ac0000, Performance = 121.75 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.018828 s, Result = a3ca0000, Performance = 123.18 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019122 s, Result = a3e80000, Performance = 125.78 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019882 s, Result = a4060000, Performance = 125.30 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020185 s, Result = a4240000, Performance = 127.67 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020882 s, Result = a4420000, Performance = 127.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.020689 s, Result = a4600000, Performance = 132.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021570 s, Result = a47e0000, Performance = 131.42 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.021963 s, Result = a49c0000, Performance = 132.98 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.022602 s, Result = a4ba0000, Performance = 133.02 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022887 s, Result = a4d80000, Performance = 135.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023448 s, Result = a4f60000, Performance = 135.55 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024119 s, Result = a5140000, Performance = 135.34 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024594 s, Result = a5320000, Performance = 136.21 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024741 s, Result = a5500000, Performance = 138.88 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025389 s, Result = a56e0000, Performance = 138.72 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.025928 s, Result = a58c0000, Performance = 139.15 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026601 s, Result = a5aa0000, Performance = 138.86 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026807 s, Result = a5c80000, Performance = 140.99 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027284 s, Result = a5e60000, Performance = 141.68 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.028115 s, Result = a6040000, Performance = 140.54 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028298 s, Result = a6220000, Performance = 142.67 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028858 s, Result = a6400000, Performance = 142.88 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029220 s, Result = a65e0000, Performance = 144.05 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029737 s, Result = a67c0000, Performance = 144.43 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030564 s, Result = a69a0000, Performance = 143.33 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030938 s, Result = a6b80000, Performance = 144.38 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031598 s, Result = a6d60000, Performance = 144.08 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032031 s, Result = a6f40000, Performance = 144.81 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.032532 s, Result = a7120000, Performance = 145.22 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032339 s, Result = a7300000, Performance = 148.75 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.033525 s, Result = a74e0000, Performance = 146.05 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.033776 s, Result = a76c0000, Performance = 147.51 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.034581 s, Result = a78a0000, Performance = 146.55 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.034599 s, Result = a7a80000, Performance = 148.96 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.035374 s, Result = a7c60000, Performance = 148.13 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035945 s, Result = a7e40000, Performance = 148.16 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.036407 s, Result = a8020000, Performance = 148.65 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.036393 s, Result = a8200000, Performance = 151.06 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1708  1703  1984
Test passed: M N K =   415  1325  1728
Test passed: M N K =  2043   344   768
Test passed: M N K =  1864  1768  1792
Test passed: M N K =  1802  1177  1216
M N K =  4096  4096   256, Elapsed time =   0.000692 s, Result = 001e0000, Performance = 124.07 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001417 s, Result = 003c0000, Performance = 121.23 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002028 s, Result = 005a0000, Performance = 127.09 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002664 s, Result = 00780000, Performance = 128.98 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003133 s, Result = 00960000, Performance = 137.07 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003582 s, Result = 00b40000, Performance = 143.88 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003976 s, Result = 00d20000, Performance = 151.22 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004451 s, Result = 00f00000, Performance = 154.40 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004940 s, Result = 010e0000, Performance = 156.51 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005597 s, Result = 012c0000, Performance = 153.48 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006085 s, Result = 014a0000, Performance = 155.29 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.006518 s, Result = 01680000, Performance = 158.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.007008 s, Result = 01860000, Performance = 159.35 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010532 s, Result = 01a40000, Performance = 114.18 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.008163 s, Result = 01c20000, Performance = 157.84 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.007806 s, Result = 01e00000, Performance = 176.07 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.008949 s, Result = 01fe0000, Performance = 163.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.009412 s, Result = 021c0000, Performance = 164.28 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.010161 s, Result = 023a0000, Performance = 160.62 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.010432 s, Result = 02580000, Performance = 164.68 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.010799 s, Result = 02760000, Performance = 167.04 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.011337 s, Result = 02940000, Performance = 166.69 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.011856 s, Result = 02b20000, Performance = 166.65 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.011790 s, Result = 02d00000, Performance = 174.85 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.012939 s, Result = 02ee0000, Performance = 165.97 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.013410 s, Result = 030c0000, Performance = 166.54 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.014009 s, Result = 032a0000, Performance = 165.56 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.014271 s, Result = 03480000, Performance = 168.53 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.014923 s, Result = 03660000, Performance = 166.93 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.014941 s, Result = 03840000, Performance = 172.48 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.015962 s, Result = 03a20000, Performance = 166.83 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.015437 s, Result = 03c00000, Performance = 178.07 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.016519 s, Result = 03de0000, Performance = 171.61 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.016982 s, Result = 03fc0000, Performance = 171.98 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.018241 s, Result = 041a0000, Performance = 164.82 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.017981 s, Result = 04380000, Performance = 171.98 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.018653 s, Result = 04560000, Performance = 170.39 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.018956 s, Result = 04740000, Performance = 172.20 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.019887 s, Result = 04920000, Performance = 168.46 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.019621 s, Result = 04b00000, Performance = 175.12 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.020370 s, Result = 04ce0000, Performance = 172.89 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.020919 s, Result = 04ec0000, Performance = 172.46 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.021683 s, Result = 050a0000, Performance = 170.35 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.021767 s, Result = 05280000, Performance = 173.64 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022588 s, Result = 05460000, Performance = 171.13 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.022738 s, Result = 05640000, Performance = 173.78 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.023359 s, Result = 05820000, Performance = 172.84 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.023132 s, Result = 05a00000, Performance = 178.24 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.024049 s, Result = 05be0000, Performance = 175.02 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.024768 s, Result = 05dc0000, Performance = 173.41 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.025402 s, Result = 05fa0000, Performance = 172.46 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.025339 s, Result = 06180000, Performance = 176.28 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.026017 s, Result = 06360000, Performance = 174.98 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.026438 s, Result = 06540000, Performance = 175.45 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.027214 s, Result = 06720000, Performance = 173.61 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.027592 s, Result = 06900000, Performance = 174.34 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.027467 s, Result = 06ae0000, Performance = 178.26 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.028544 s, Result = 06cc0000, Performance = 174.54 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.028946 s, Result = 06ea0000, Performance = 175.09 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.029244 s, Result = 07080000, Performance = 176.24 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.029970 s, Result = 07260000, Performance = 174.84 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.030121 s, Result = 07440000, Performance = 176.81 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.030760 s, Result = 07620000, Performance = 175.93 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.030201 s, Result = 07800000, Performance = 182.03 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   618  1091   384
Test passed: M N K =  1343  1181   640
Test passed: M N K =   317    91  1600
Test passed: M N K =  1277   805   704
Test passed: M N K =   165  1393   256
M N K =  4096  4096   256, Elapsed time =   0.008529 s, Result = 10240000, Performance =  10.07 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009361 s, Result = 10380000, Performance =  18.35 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010398 s, Result = 104c0000, Performance =  24.78 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010076 s, Result = 10600000, Performance =  34.10 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011850 s, Result = 10740000, Performance =  36.25 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011358 s, Result = 10880000, Performance =  45.38 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012395 s, Result = 109c0000, Performance =  48.51 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013972 s, Result = 10b00000, Performance =  49.18 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014055 s, Result = 10c40000, Performance =  55.00 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013976 s, Result = 10d80000, Performance =  61.46 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014341 s, Result = 10ec0000, Performance =  65.89 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014992 s, Result = 11000000, Performance =  68.76 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015300 s, Result = 11140000, Performance =  72.99 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015946 s, Result = 11280000, Performance =  75.42 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015615 s, Result = 113c0000, Performance =  82.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020959 s, Result = 11500000, Performance =  65.58 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017160 s, Result = 11640000, Performance =  85.10 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017148 s, Result = 11780000, Performance =  90.17 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017111 s, Result = 118c0000, Performance =  95.39 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.016462 s, Result = 11a00000, Performance = 104.36 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.018046 s, Result = 11b40000, Performance =  99.96 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018852 s, Result = 11c80000, Performance = 100.25 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018399 s, Result = 11dc0000, Performance = 107.38 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.019129 s, Result = 11f00000, Performance = 107.77 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.020194 s, Result = 12040000, Performance = 106.34 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.020044 s, Result = 12180000, Performance = 111.42 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.019992 s, Result = 122c0000, Performance = 116.01 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.019751 s, Result = 12400000, Performance = 121.78 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.021575 s, Result = 12540000, Performance = 115.46 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.022562 s, Result = 12680000, Performance = 114.22 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.022116 s, Result = 127c0000, Performance = 120.41 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021411 s, Result = 12900000, Performance = 128.38 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.023610 s, Result = 12a40000, Performance = 120.06 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.023230 s, Result = 12b80000, Performance = 125.72 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.023839 s, Result = 12cc0000, Performance = 126.12 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023631 s, Result = 12e00000, Performance = 130.86 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.024648 s, Result = 12f40000, Performance = 128.95 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.025388 s, Result = 13080000, Performance = 128.57 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.026007 s, Result = 131c0000, Performance = 128.82 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025606 s, Result = 13300000, Performance = 134.19 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.026274 s, Result = 13440000, Performance = 134.04 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026937 s, Result = 13580000, Performance = 133.93 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.027354 s, Result = 136c0000, Performance = 135.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.027564 s, Result = 13800000, Performance = 137.12 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.029164 s, Result = 13940000, Performance = 132.54 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.029064 s, Result = 13a80000, Performance = 135.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.030025 s, Result = 13bc0000, Performance = 134.46 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.029608 s, Result = 13d00000, Performance = 139.26 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.031230 s, Result = 13e40000, Performance = 134.78 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.031299 s, Result = 13f80000, Performance = 137.22 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.032693 s, Result = 140c0000, Performance = 134.00 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.033384 s, Result = 14200000, Performance = 133.80 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.034133 s, Result = 14340000, Performance = 133.38 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.034861 s, Result = 14480000, Performance = 133.06 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.036130 s, Result = 145c0000, Performance = 130.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.036340 s, Result = 14700000, Performance = 132.37 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.037902 s, Result = 14840000, Performance = 129.18 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.038268 s, Result = 14980000, Performance = 130.19 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.038584 s, Result = 14ac0000, Performance = 131.35 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.039197 s, Result = 14c00000, Performance = 131.49 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.040557 s, Result = 14d40000, Performance = 129.20 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.040684 s, Result = 14e80000, Performance = 130.91 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.041939 s, Result = 14fc0000, Performance = 129.04 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.042238 s, Result = 15100000, Performance = 130.16 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1862   760  1024
Test passed: M N K =  1090   622   512
Test passed: M N K =   233  1388   704
Test passed: M N K =  1842  1186  1472
Test passed: M N K =   578   758  1920
M N K =  4096  4096   256, Elapsed time =   0.009442 s, Result = 00140000, Performance =   9.10 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009399 s, Result = 00280000, Performance =  18.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009148 s, Result = 003c0000, Performance =  28.17 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008976 s, Result = 00500000, Performance =  38.28 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008894 s, Result = 00640000, Performance =  48.29 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008814 s, Result = 00780000, Performance =  58.48 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008790 s, Result = 008c0000, Performance =  68.41 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009103 s, Result = 00a00000, Performance =  75.49 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008917 s, Result = 00b40000, Performance =  86.70 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010122 s, Result = 00c80000, Performance =  84.87 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009765 s, Result = 00dc0000, Performance =  96.76 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010214 s, Result = 00f00000, Performance = 100.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011005 s, Result = 01040000, Performance = 101.47 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010797 s, Result = 01180000, Performance = 111.38 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013106 s, Result = 012c0000, Performance =  98.32 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.011738 s, Result = 01400000, Performance = 117.08 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.012800 s, Result = 01540000, Performance = 114.08 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013132 s, Result = 01680000, Performance = 117.74 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013348 s, Result = 017c0000, Performance = 122.27 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.013069 s, Result = 01900000, Performance = 131.46 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014119 s, Result = 01a40000, Performance = 127.76 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014429 s, Result = 01b80000, Performance = 130.97 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014279 s, Result = 01cc0000, Performance = 138.37 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.026589 s, Result = 01e00000, Performance =  77.54 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015204 s, Result = 01f40000, Performance = 141.24 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016269 s, Result = 02080000, Performance = 137.28 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.016773 s, Result = 021c0000, Performance = 138.27 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.016688 s, Result = 02300000, Performance = 144.13 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017513 s, Result = 02440000, Performance = 142.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.017808 s, Result = 02580000, Performance = 144.71 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.017447 s, Result = 026c0000, Performance = 152.62 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.018694 s, Result = 02800000, Performance = 147.04 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.018753 s, Result = 02940000, Performance = 151.16 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.018531 s, Result = 02a80000, Performance = 157.60 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.019866 s, Result = 02bc0000, Performance = 151.34 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020368 s, Result = 02d00000, Performance = 151.83 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.019950 s, Result = 02e40000, Performance = 159.31 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.020570 s, Result = 02f80000, Performance = 158.69 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.020416 s, Result = 030c0000, Performance = 164.09 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.021792 s, Result = 03200000, Performance = 157.67 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.021759 s, Result = 03340000, Performance = 161.86 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.021314 s, Result = 03480000, Performance = 169.27 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023412 s, Result = 035c0000, Performance = 157.77 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.022295 s, Result = 03700000, Performance = 169.52 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.024023 s, Result = 03840000, Performance = 160.91 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.024405 s, Result = 03980000, Performance = 161.91 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.024364 s, Result = 03ac0000, Performance = 165.71 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.024905 s, Result = 03c00000, Performance = 165.56 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.026403 s, Result = 03d40000, Performance = 159.41 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.026076 s, Result = 03e80000, Performance = 164.71 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.027115 s, Result = 03fc0000, Performance = 161.56 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.027077 s, Result = 04100000, Performance = 164.96 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.028214 s, Result = 04240000, Performance = 161.36 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.028491 s, Result = 04380000, Performance = 162.81 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.028812 s, Result = 044c0000, Performance = 163.97 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.030255 s, Result = 04600000, Performance = 158.99 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.031273 s, Result = 04740000, Performance = 156.56 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.031429 s, Result = 04880000, Performance = 158.52 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.033809 s, Result = 049c0000, Performance = 149.90 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.033181 s, Result = 04b00000, Performance = 155.33 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.034386 s, Result = 04c40000, Performance = 152.38 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.034239 s, Result = 04d80000, Performance = 155.55 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.035388 s, Result = 04ec0000, Performance = 152.92 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.037187 s, Result = 05000000, Performance = 147.83 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   415  1052   256
Test passed: M N K =  2035    72   128
Test passed: M N K =  1772   995   320
Test passed: M N K =  1350  1040   320
Test passed: M N K =  1032  1202  1920
M N K =  4096  4096   256, Elapsed time =   0.006768 s, Result = a0b40000, Performance =  12.69 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006151 s, Result = a0c80000, Performance =  27.93 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006899 s, Result = a0dc0000, Performance =  37.35 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.006812 s, Result = a0f00000, Performance =  50.44 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007393 s, Result = a1040000, Performance =  58.09 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007501 s, Result = a1180000, Performance =  68.71 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007763 s, Result = a12c0000, Performance =  77.46 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010133 s, Result = a1400000, Performance =  67.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008346 s, Result = a1540000, Performance =  92.63 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008580 s, Result = a1680000, Performance = 100.12 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008907 s, Result = a17c0000, Performance = 106.09 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009286 s, Result = a1900000, Performance = 111.01 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009832 s, Result = a1a40000, Performance = 113.58 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010208 s, Result = a1b80000, Performance = 117.81 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010613 s, Result = a1cc0000, Performance = 121.41 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.011934 s, Result = a1e00000, Performance = 115.17 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011066 s, Result = a1f40000, Performance = 131.97 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.011569 s, Result = a2080000, Performance = 133.65 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.011714 s, Result = a21c0000, Performance = 139.33 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.012435 s, Result = a2300000, Performance = 138.16 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.012489 s, Result = a2440000, Performance = 144.43 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.012463 s, Result = a2580000, Performance = 151.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.013284 s, Result = a26c0000, Performance = 148.72 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.014157 s, Result = a2800000, Performance = 145.62 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.013774 s, Result = a2940000, Performance = 155.91 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.013950 s, Result = a2a80000, Performance = 160.10 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.014305 s, Result = a2bc0000, Performance = 162.13 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.014980 s, Result = a2d00000, Performance = 160.56 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.014908 s, Result = a2e40000, Performance = 167.10 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.015396 s, Result = a2f80000, Performance = 167.38 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.015594 s, Result = a30c0000, Performance = 170.76 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.016858 s, Result = a3200000, Performance = 163.06 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.016004 s, Result = a3340000, Performance = 177.12 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.016847 s, Result = a3480000, Performance = 173.36 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.016760 s, Result = a35c0000, Performance = 179.38 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.017340 s, Result = a3700000, Performance = 178.34 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.017941 s, Result = a3840000, Performance = 177.15 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.017665 s, Result = a3980000, Performance = 184.78 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.018202 s, Result = a3ac0000, Performance = 184.04 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.019340 s, Result = a3c00000, Performance = 177.66 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.019231 s, Result = a3d40000, Performance = 183.13 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.019910 s, Result = a3e80000, Performance = 181.21 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.019963 s, Result = a3fc0000, Performance = 185.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.020535 s, Result = a4100000, Performance = 184.06 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.021038 s, Result = a4240000, Performance = 183.74 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.020783 s, Result = a4380000, Performance = 190.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.021694 s, Result = a44c0000, Performance = 186.10 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.022927 s, Result = a4600000, Performance = 179.84 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.022649 s, Result = a4740000, Performance = 185.84 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.023297 s, Result = a4880000, Performance = 184.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.023678 s, Result = a49c0000, Performance = 185.02 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.024772 s, Result = a4b00000, Performance = 180.31 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.025399 s, Result = a4c40000, Performance = 179.24 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.025558 s, Result = a4d80000, Performance = 181.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.026399 s, Result = a4ec0000, Performance = 178.96 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.027482 s, Result = a5000000, Performance = 175.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.027654 s, Result = a5140000, Performance = 177.05 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.028679 s, Result = a5280000, Performance = 173.72 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.029832 s, Result = a53c0000, Performance = 169.89 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.029868 s, Result = a5500000, Performance = 172.56 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.031831 s, Result = a5640000, Performance = 164.62 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.031931 s, Result = a5780000, Performance = 166.79 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.032602 s, Result = a58c0000, Performance = 165.99 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.034263 s, Result = a5a00000, Performance = 160.45 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1612  1931  1984
Test passed: M N K =  1928   736  1344
Test passed: M N K =    78  1320  2048
Test passed: M N K =  1375  1632  1920
Test passed: M N K =  1135   657   768
M N K =  4096  4096   256, Elapsed time =   0.000696 s, Result = 00140000, Performance = 123.51 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001433 s, Result = 00280000, Performance = 119.89 TOPS
M N K =  4096  4096   768, Elapsed time =   0.001951 s, Result = 003c0000, Performance = 132.08 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002591 s, Result = 00500000, Performance = 132.61 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002726 s, Result = 00640000, Performance = 157.53 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003015 s, Result = 00780000, Performance = 170.96 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003321 s, Result = 008c0000, Performance = 181.04 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.003150 s, Result = 00a00000, Performance = 218.16 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.003751 s, Result = 00b40000, Performance = 206.11 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.003978 s, Result = 00c80000, Performance = 215.95 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.004228 s, Result = 00dc0000, Performance = 223.49 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.004841 s, Result = 00f00000, Performance = 212.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.004946 s, Result = 01040000, Performance = 225.77 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.005340 s, Result = 01180000, Performance = 225.22 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.005498 s, Result = 012c0000, Performance = 234.35 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.005656 s, Result = 01400000, Performance = 243.00 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.006182 s, Result = 01540000, Performance = 236.23 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.006342 s, Result = 01680000, Performance = 243.81 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.006564 s, Result = 017c0000, Performance = 248.63 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.007261 s, Result = 01900000, Performance = 236.62 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.007073 s, Result = 01a40000, Performance = 255.05 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.007352 s, Result = 01b80000, Performance = 257.06 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.008337 s, Result = 01cc0000, Performance = 236.97 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.009401 s, Result = 01e00000, Performance = 219.28 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.008888 s, Result = 01f40000, Performance = 241.61 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.008821 s, Result = 02080000, Performance = 253.20 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.009273 s, Result = 021c0000, Performance = 250.12 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.010335 s, Result = 02300000, Performance = 232.73 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.009967 s, Result = 02440000, Performance = 249.94 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.010050 s, Result = 02580000, Performance = 256.41 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.010582 s, Result = 026c0000, Performance = 251.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.012081 s, Result = 02800000, Performance = 227.53 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.011091 s, Result = 02940000, Performance = 255.59 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.011295 s, Result = 02a80000, Performance = 258.57 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.011941 s, Result = 02bc0000, Performance = 251.77 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.012129 s, Result = 02d00000, Performance = 254.95 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.012579 s, Result = 02e40000, Performance = 252.66 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.012565 s, Result = 02f80000, Performance = 259.78 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.012934 s, Result = 030c0000, Performance = 259.01 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.015035 s, Result = 03200000, Performance = 228.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.013937 s, Result = 03340000, Performance = 252.70 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.013887 s, Result = 03480000, Performance = 259.79 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.014122 s, Result = 035c0000, Performance = 261.56 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.014435 s, Result = 03700000, Performance = 261.83 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.014894 s, Result = 03840000, Performance = 259.54 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.015839 s, Result = 03980000, Performance = 249.47 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.015819 s, Result = 03ac0000, Performance = 255.22 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.016770 s, Result = 03c00000, Performance = 245.86 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.017152 s, Result = 03d40000, Performance = 245.39 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.017363 s, Result = 03e80000, Performance = 247.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.018280 s, Result = 03fc0000, Performance = 239.65 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.018466 s, Result = 04100000, Performance = 241.89 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.019149 s, Result = 04240000, Performance = 237.75 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.020064 s, Result = 04380000, Performance = 231.18 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.019929 s, Result = 044c0000, Performance = 237.06 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.021289 s, Result = 04600000, Performance = 225.95 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.022585 s, Result = 04740000, Performance = 216.79 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.022192 s, Result = 04880000, Performance = 224.50 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.024021 s, Result = 049c0000, Performance = 210.99 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.024674 s, Result = 04b00000, Performance = 208.88 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.025175 s, Result = 04c40000, Performance = 208.13 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.026005 s, Result = 04d80000, Performance = 204.80 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.026536 s, Result = 04ec0000, Performance = 203.93 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.028118 s, Result = 05000000, Performance = 195.52 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =   181   327  1024
Test passed: M N K =  1249   124  1024
Test passed: M N K =  1117  1841    64
Test passed: M N K =   666   228   256
Test passed: M N K =  1276   587   128
M N K =  4096  4096   256, Elapsed time =   0.008952 s, Result = 10240000, Performance =   9.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009615 s, Result = 10380000, Performance =  17.87 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009482 s, Result = 104c0000, Performance =  27.18 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012061 s, Result = 10600000, Performance =  28.49 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012922 s, Result = 10740000, Performance =  33.24 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011285 s, Result = 10880000, Performance =  45.67 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013054 s, Result = 109c0000, Performance =  46.06 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.011720 s, Result = 10b00000, Performance =  58.63 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.013656 s, Result = 10c40000, Performance =  56.61 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014297 s, Result = 10d80000, Performance =  60.08 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014210 s, Result = 10ec0000, Performance =  66.50 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013961 s, Result = 11000000, Performance =  73.83 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014092 s, Result = 11140000, Performance =  79.24 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.014573 s, Result = 11280000, Performance =  82.52 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015851 s, Result = 113c0000, Performance =  81.29 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.015405 s, Result = 11500000, Performance =  89.22 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016360 s, Result = 11640000, Performance =  89.26 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.017498 s, Result = 11780000, Performance =  88.36 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017111 s, Result = 118c0000, Performance =  95.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017288 s, Result = 11a00000, Performance =  99.38 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017600 s, Result = 11b40000, Performance = 102.50 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.017714 s, Result = 11c80000, Performance = 106.69 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018801 s, Result = 11dc0000, Performance = 105.08 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.018435 s, Result = 11f00000, Performance = 111.83 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.018922 s, Result = 12040000, Performance = 113.49 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019639 s, Result = 12180000, Performance = 113.72 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.019401 s, Result = 122c0000, Performance = 119.55 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020017 s, Result = 12400000, Performance = 120.16 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.020298 s, Result = 12540000, Performance = 122.73 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.020584 s, Result = 12680000, Performance = 125.19 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.021487 s, Result = 127c0000, Performance = 123.93 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021642 s, Result = 12900000, Performance = 127.01 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.021426 s, Result = 12a40000, Performance = 132.30 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022828 s, Result = 12b80000, Performance = 127.94 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.023000 s, Result = 12cc0000, Performance = 130.72 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.022823 s, Result = 12e00000, Performance = 135.50 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023700 s, Result = 12f40000, Performance = 134.10 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.023839 s, Result = 13080000, Performance = 136.93 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024150 s, Result = 131c0000, Performance = 138.72 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.025141 s, Result = 13300000, Performance = 136.67 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.026161 s, Result = 13440000, Performance = 134.62 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.026436 s, Result = 13580000, Performance = 136.47 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026592 s, Result = 136c0000, Performance = 138.90 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026979 s, Result = 13800000, Performance = 140.09 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.028026 s, Result = 13940000, Performance = 137.92 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.028424 s, Result = 13a80000, Performance = 139.01 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.028675 s, Result = 13bc0000, Performance = 140.79 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.029101 s, Result = 13d00000, Performance = 141.68 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.029414 s, Result = 13e40000, Performance = 143.10 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.030452 s, Result = 13f80000, Performance = 141.04 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.031359 s, Result = 140c0000, Performance = 139.70 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.031257 s, Result = 14200000, Performance = 142.90 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.032317 s, Result = 14340000, Performance = 140.88 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.032853 s, Result = 14480000, Performance = 141.19 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.033759 s, Result = 145c0000, Performance = 139.95 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.033648 s, Result = 14700000, Performance = 142.96 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.035308 s, Result = 14840000, Performance = 138.67 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.035815 s, Result = 14980000, Performance = 139.11 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.036735 s, Result = 14ac0000, Performance = 137.96 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.037122 s, Result = 14c00000, Performance = 138.84 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.038664 s, Result = 14d40000, Performance = 135.52 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.038491 s, Result = 14e80000, Performance = 138.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.039879 s, Result = 14fc0000, Performance = 135.70 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.038371 s, Result = 15100000, Performance = 143.27 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  2025  1620  1344
Test passed: M N K =   600  1594  1152
Test passed: M N K =   669  1343   512
Test passed: M N K =  1241  1274   384
Test passed: M N K =  1981  1897  1024
M N K =  4096  4096   256, Elapsed time =   0.009240 s, Result = 00140000, Performance =   9.30 TOPS
M N K =  4096  4096   512, Elapsed time =   0.007663 s, Result = 00280000, Performance =  22.42 TOPS
M N K =  4096  4096   768, Elapsed time =   0.008180 s, Result = 003c0000, Performance =  31.50 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008084 s, Result = 00500000, Performance =  42.51 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008127 s, Result = 00640000, Performance =  52.85 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008551 s, Result = 00780000, Performance =  60.27 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008789 s, Result = 008c0000, Performance =  68.41 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008680 s, Result = 00a00000, Performance =  79.17 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009596 s, Result = 00b40000, Performance =  80.56 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009689 s, Result = 00c80000, Performance =  88.66 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009997 s, Result = 00dc0000, Performance =  94.51 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010761 s, Result = 00f00000, Performance =  95.79 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010904 s, Result = 01040000, Performance = 102.41 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011435 s, Result = 01180000, Performance = 105.17 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.011784 s, Result = 012c0000, Performance = 109.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012089 s, Result = 01400000, Performance = 113.69 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.012682 s, Result = 01540000, Performance = 115.15 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013322 s, Result = 01680000, Performance = 116.06 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012911 s, Result = 017c0000, Performance = 126.41 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014121 s, Result = 01900000, Performance = 121.67 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014601 s, Result = 01a40000, Performance = 123.55 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014100 s, Result = 01b80000, Performance = 134.02 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015081 s, Result = 01cc0000, Performance = 131.00 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.014910 s, Result = 01e00000, Performance = 138.27 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.015816 s, Result = 01f40000, Performance = 135.78 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.015839 s, Result = 02080000, Performance = 141.00 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.015560 s, Result = 021c0000, Performance = 149.06 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.016977 s, Result = 02300000, Performance = 141.67 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.017624 s, Result = 02440000, Performance = 141.34 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.017793 s, Result = 02580000, Performance = 144.83 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.018528 s, Result = 026c0000, Performance = 143.72 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.018594 s, Result = 02800000, Performance = 147.83 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.018940 s, Result = 02940000, Performance = 149.66 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.019649 s, Result = 02a80000, Performance = 148.64 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.019695 s, Result = 02bc0000, Performance = 152.65 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020642 s, Result = 02d00000, Performance = 149.81 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.020482 s, Result = 02e40000, Performance = 155.17 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.020248 s, Result = 02f80000, Performance = 161.21 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.020901 s, Result = 030c0000, Performance = 160.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.021891 s, Result = 03200000, Performance = 156.96 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.022436 s, Result = 03340000, Performance = 156.98 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.022035 s, Result = 03480000, Performance = 163.73 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.022238 s, Result = 035c0000, Performance = 166.10 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.023231 s, Result = 03700000, Performance = 162.69 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022585 s, Result = 03840000, Performance = 171.15 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.023887 s, Result = 03980000, Performance = 165.42 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.023791 s, Result = 03ac0000, Performance = 169.70 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.024060 s, Result = 03c00000, Performance = 171.37 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.024966 s, Result = 03d40000, Performance = 168.59 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.024621 s, Result = 03e80000, Performance = 174.45 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.024961 s, Result = 03fc0000, Performance = 175.51 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.026017 s, Result = 04100000, Performance = 171.69 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.025875 s, Result = 04240000, Performance = 175.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.026303 s, Result = 04380000, Performance = 176.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.027257 s, Result = 044c0000, Performance = 173.33 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.028210 s, Result = 04600000, Performance = 170.52 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.028702 s, Result = 04740000, Performance = 170.59 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.028889 s, Result = 04880000, Performance = 172.46 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.029600 s, Result = 049c0000, Performance = 171.22 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.030382 s, Result = 04b00000, Performance = 169.64 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.030880 s, Result = 04c40000, Performance = 169.69 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.031913 s, Result = 04d80000, Performance = 166.88 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.033084 s, Result = 04ec0000, Performance = 163.57 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.032896 s, Result = 05000000, Performance = 167.12 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1847  1327  1728
Test passed: M N K =   198    94  1408
Test passed: M N K =  1657   132   704
Test passed: M N K =    30  1291   320
Test passed: M N K =  1639  1863  1472
M N K =  4096  4096   256, Elapsed time =   0.006536 s, Result = a0b40000, Performance =  13.14 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006114 s, Result = a0c80000, Performance =  28.10 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006900 s, Result = a0dc0000, Performance =  37.35 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.006827 s, Result = a0f00000, Performance =  50.33 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007329 s, Result = a1040000, Performance =  58.60 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007567 s, Result = a1180000, Performance =  68.11 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007879 s, Result = a12c0000, Performance =  76.32 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008009 s, Result = a1400000, Performance =  85.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008525 s, Result = a1540000, Performance =  90.68 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008703 s, Result = a1680000, Performance =  98.70 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009213 s, Result = a17c0000, Performance = 102.56 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009816 s, Result = a1900000, Performance = 105.01 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010127 s, Result = a1a40000, Performance = 110.27 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010494 s, Result = a1b80000, Performance = 114.59 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010621 s, Result = a1cc0000, Performance = 121.31 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.012358 s, Result = a1e00000, Performance = 111.22 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011240 s, Result = a1f40000, Performance = 129.92 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.011663 s, Result = a2080000, Performance = 132.57 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012439 s, Result = a21c0000, Performance = 131.21 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.012461 s, Result = a2300000, Performance = 137.87 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.012757 s, Result = a2440000, Performance = 141.40 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.013346 s, Result = a2580000, Performance = 141.60 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.013654 s, Result = a26c0000, Performance = 144.70 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.014285 s, Result = a2800000, Performance = 144.32 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.014339 s, Result = a2940000, Performance = 149.77 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.015012 s, Result = a2a80000, Performance = 148.77 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.015259 s, Result = a2bc0000, Performance = 151.99 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.015424 s, Result = a2d00000, Performance = 155.94 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.015795 s, Result = a2e40000, Performance = 157.71 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.016130 s, Result = a2f80000, Performance = 159.76 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.016468 s, Result = a30c0000, Performance = 161.70 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.017157 s, Result = a3200000, Performance = 160.22 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.017112 s, Result = a3340000, Performance = 165.65 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.017483 s, Result = a3480000, Performance = 167.05 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.017783 s, Result = a35c0000, Performance = 169.06 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.017851 s, Result = a3700000, Performance = 173.23 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.018279 s, Result = a3840000, Performance = 173.87 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.018598 s, Result = a3980000, Performance = 175.51 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.018965 s, Result = a3ac0000, Performance = 176.64 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.019488 s, Result = a3c00000, Performance = 176.31 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.019629 s, Result = a3d40000, Performance = 179.42 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.019926 s, Result = a3e80000, Performance = 181.06 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.020028 s, Result = a3fc0000, Performance = 184.42 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.020665 s, Result = a4100000, Performance = 182.90 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.020921 s, Result = a4240000, Performance = 184.76 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.021382 s, Result = a4380000, Performance = 184.80 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.021620 s, Result = a44c0000, Performance = 186.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.022468 s, Result = a4600000, Performance = 183.51 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.022866 s, Result = a4740000, Performance = 184.08 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.022843 s, Result = a4880000, Performance = 188.02 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.023432 s, Result = a49c0000, Performance = 186.96 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.023669 s, Result = a4b00000, Performance = 188.72 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.024212 s, Result = a4c40000, Performance = 188.03 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.024346 s, Result = a4d80000, Performance = 190.53 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.025191 s, Result = a4ec0000, Performance = 187.55 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.025420 s, Result = a5000000, Performance = 189.23 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.025969 s, Result = a5140000, Performance = 188.54 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.026349 s, Result = a5280000, Performance = 189.09 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.027761 s, Result = a53c0000, Performance = 182.56 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.027999 s, Result = a5500000, Performance = 184.07 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.029143 s, Result = a5640000, Performance = 179.80 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.029610 s, Result = a5780000, Performance = 179.87 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.030789 s, Result = a58c0000, Performance = 175.77 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.030229 s, Result = a5a00000, Performance = 181.87 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1040    32  1216
Test passed: M N K =   146  2002  1472
Test passed: M N K =  1967  1644   640
Test passed: M N K =  1393   507    64
Test passed: M N K =  1948  1191   128
M N K =  4096  4096   256, Elapsed time =   0.000612 s, Result = 00140000, Performance = 140.41 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001384 s, Result = 00280000, Performance = 124.09 TOPS
M N K =  4096  4096   768, Elapsed time =   0.001919 s, Result = 003c0000, Performance = 134.31 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002402 s, Result = 00500000, Performance = 143.06 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002749 s, Result = 00640000, Performance = 156.24 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003082 s, Result = 00780000, Performance = 167.25 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003303 s, Result = 008c0000, Performance = 182.05 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004996 s, Result = 00a00000, Performance = 137.56 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.003831 s, Result = 00b40000, Performance = 201.79 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.004243 s, Result = 00c80000, Performance = 202.45 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.004448 s, Result = 00dc0000, Performance = 212.43 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.004844 s, Result = 00f00000, Performance = 212.79 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.005372 s, Result = 01040000, Performance = 207.89 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.005598 s, Result = 01180000, Performance = 214.84 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.006012 s, Result = 012c0000, Performance = 214.33 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.005625 s, Result = 01400000, Performance = 244.35 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.006518 s, Result = 01540000, Performance = 224.04 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.007002 s, Result = 01680000, Performance = 220.82 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.007211 s, Result = 017c0000, Performance = 226.34 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.007362 s, Result = 01900000, Performance = 233.37 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.007963 s, Result = 01a40000, Performance = 226.52 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.008232 s, Result = 01b80000, Performance = 229.55 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.008486 s, Result = 01cc0000, Performance = 232.81 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.008642 s, Result = 01e00000, Performance = 238.56 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.009392 s, Result = 01f40000, Performance = 228.66 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.009458 s, Result = 02080000, Performance = 236.14 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.010097 s, Result = 021c0000, Performance = 229.70 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.010157 s, Result = 02300000, Performance = 236.81 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.010437 s, Result = 02440000, Performance = 238.69 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.010987 s, Result = 02580000, Performance = 234.55 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.011372 s, Result = 026c0000, Performance = 234.16 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.010947 s, Result = 02800000, Performance = 251.10 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.011926 s, Result = 02940000, Performance = 237.68 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.012462 s, Result = 02a80000, Performance = 234.36 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.012724 s, Result = 02bc0000, Performance = 236.28 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.012655 s, Result = 02d00000, Performance = 244.35 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.013148 s, Result = 02e40000, Performance = 241.73 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.013658 s, Result = 02f80000, Performance = 238.99 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.013601 s, Result = 030c0000, Performance = 246.31 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.014238 s, Result = 03200000, Performance = 241.33 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.014120 s, Result = 03340000, Performance = 249.43 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.014483 s, Result = 03480000, Performance = 249.10 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.015199 s, Result = 035c0000, Performance = 243.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.014691 s, Result = 03700000, Performance = 257.28 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.015331 s, Result = 03840000, Performance = 252.14 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.016069 s, Result = 03980000, Performance = 245.90 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.015747 s, Result = 03ac0000, Performance = 256.39 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.016178 s, Result = 03c00000, Performance = 254.87 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.016048 s, Result = 03d40000, Performance = 262.28 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.016749 s, Result = 03e80000, Performance = 256.43 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.017271 s, Result = 03fc0000, Performance = 253.65 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.017324 s, Result = 04100000, Performance = 257.84 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.017627 s, Result = 04240000, Performance = 258.28 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.018247 s, Result = 04380000, Performance = 254.21 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.018909 s, Result = 044c0000, Performance = 249.85 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.019709 s, Result = 04600000, Performance = 244.07 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.020196 s, Result = 04740000, Performance = 242.44 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.020380 s, Result = 04880000, Performance = 244.47 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.021630 s, Result = 049c0000, Performance = 234.31 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.021825 s, Result = 04b00000, Performance = 236.15 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.023156 s, Result = 04c40000, Performance = 226.29 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.023933 s, Result = 04d80000, Performance = 222.53 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.024952 s, Result = 04ec0000, Performance = 216.89 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.024492 s, Result = 05000000, Performance = 224.47 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1902   486   832
Test passed: M N K =  1258   146  1600
Test passed: M N K =    45  1024  1024
Test passed: M N K =   368    44   768
Test passed: M N K =   885  1110   448
M N K =  4096  4096   256, Elapsed time =   0.008615 s, Result = 10240000, Performance =   9.97 TOPS
M N K =  4096  4096   512, Elapsed time =   0.009332 s, Result = 10380000, Performance =  18.41 TOPS
M N K =  4096  4096   768, Elapsed time =   0.009796 s, Result = 104c0000, Performance =  26.31 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.010589 s, Result = 10600000, Performance =  32.45 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012818 s, Result = 10740000, Performance =  33.51 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.011242 s, Result = 10880000, Performance =  45.85 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011849 s, Result = 109c0000, Performance =  50.75 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.012887 s, Result = 10b00000, Performance =  53.33 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012892 s, Result = 10c40000, Performance =  59.97 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014944 s, Result = 10d80000, Performance =  57.48 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014375 s, Result = 10ec0000, Performance =  65.73 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015457 s, Result = 11000000, Performance =  66.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015522 s, Result = 11140000, Performance =  71.94 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015482 s, Result = 11280000, Performance =  77.68 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.016362 s, Result = 113c0000, Performance =  78.75 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.015522 s, Result = 11500000, Performance =  88.55 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.017626 s, Result = 11640000, Performance =  82.85 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016816 s, Result = 11780000, Performance =  91.95 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.017330 s, Result = 118c0000, Performance =  94.18 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.017241 s, Result = 11a00000, Performance =  99.65 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.017839 s, Result = 11b40000, Performance = 101.12 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.018327 s, Result = 11c80000, Performance = 103.11 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.018613 s, Result = 11dc0000, Performance = 106.15 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.024675 s, Result = 11f00000, Performance =  83.55 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.019342 s, Result = 12040000, Performance = 111.02 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.019123 s, Result = 12180000, Performance = 116.79 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.020083 s, Result = 122c0000, Performance = 115.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.020194 s, Result = 12400000, Performance = 119.10 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.019695 s, Result = 12540000, Performance = 126.49 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.021484 s, Result = 12680000, Performance = 119.95 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.020830 s, Result = 127c0000, Performance = 127.84 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.021363 s, Result = 12900000, Performance = 128.67 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.022867 s, Result = 12a40000, Performance = 123.96 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.022107 s, Result = 12b80000, Performance = 132.11 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.023189 s, Result = 12cc0000, Performance = 129.65 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.023246 s, Result = 12e00000, Performance = 133.03 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.023419 s, Result = 12f40000, Performance = 135.72 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.024671 s, Result = 13080000, Performance = 132.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.024883 s, Result = 131c0000, Performance = 134.63 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.024431 s, Result = 13300000, Performance = 140.64 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.025925 s, Result = 13440000, Performance = 135.85 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.025961 s, Result = 13580000, Performance = 138.97 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.026600 s, Result = 136c0000, Performance = 138.86 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.026929 s, Result = 13800000, Performance = 140.35 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.027164 s, Result = 13940000, Performance = 142.30 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.028165 s, Result = 13a80000, Performance = 140.30 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.027793 s, Result = 13bc0000, Performance = 145.26 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.028848 s, Result = 13d00000, Performance = 142.93 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.028927 s, Result = 13e40000, Performance = 145.51 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.029108 s, Result = 13f80000, Performance = 147.55 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.030070 s, Result = 140c0000, Performance = 145.69 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.030755 s, Result = 14200000, Performance = 145.24 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.031303 s, Result = 14340000, Performance = 145.44 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.031236 s, Result = 14480000, Performance = 148.50 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.031868 s, Result = 145c0000, Performance = 148.25 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.032040 s, Result = 14700000, Performance = 150.14 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.033063 s, Result = 14840000, Performance = 148.09 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.033320 s, Result = 14980000, Performance = 149.53 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.033621 s, Result = 14ac0000, Performance = 150.74 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.034268 s, Result = 14c00000, Performance = 150.40 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.034723 s, Result = 14d40000, Performance = 150.90 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.035717 s, Result = 14e80000, Performance = 149.11 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.035821 s, Result = 14fc0000, Performance = 151.08 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.036646 s, Result = 15100000, Performance = 150.02 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =    37  1052   832
Test passed: M N K =  1031  1581   320
Test passed: M N K =   855  1839   896
Test passed: M N K =  1926  1157   192
Test passed: M N K =  1332  1664   320
M N K =  4096  4096   256, Elapsed time =   0.009615 s, Result = 00140000, Performance =   8.93 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006732 s, Result = 00280000, Performance =  25.52 TOPS
M N K =  4096  4096   768, Elapsed time =   0.008645 s, Result = 003c0000, Performance =  29.81 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008433 s, Result = 00500000, Performance =  40.75 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.008048 s, Result = 00640000, Performance =  53.37 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008400 s, Result = 00780000, Performance =  61.36 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.010172 s, Result = 008c0000, Performance =  59.11 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008308 s, Result = 00a00000, Performance =  82.72 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009474 s, Result = 00b40000, Performance =  81.60 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010075 s, Result = 00c80000, Performance =  85.26 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010441 s, Result = 00dc0000, Performance =  90.49 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010846 s, Result = 00f00000, Performance =  95.04 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011440 s, Result = 01040000, Performance =  97.61 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011185 s, Result = 01180000, Performance = 107.52 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.012199 s, Result = 012c0000, Performance = 105.62 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.011939 s, Result = 01400000, Performance = 115.12 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.019116 s, Result = 01540000, Performance =  76.39 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.013407 s, Result = 01680000, Performance = 115.33 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.013911 s, Result = 017c0000, Performance = 117.32 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.014147 s, Result = 01900000, Performance = 121.44 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.014376 s, Result = 01a40000, Performance = 125.48 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.014924 s, Result = 01b80000, Performance = 126.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.015650 s, Result = 01cc0000, Performance = 126.24 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.015926 s, Result = 01e00000, Performance = 129.45 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.016184 s, Result = 01f40000, Performance = 132.69 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.016828 s, Result = 02080000, Performance = 132.72 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.017303 s, Result = 021c0000, Performance = 134.04 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.016830 s, Result = 02300000, Performance = 142.91 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.018001 s, Result = 02440000, Performance = 138.39 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.018176 s, Result = 02580000, Performance = 141.78 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.018408 s, Result = 026c0000, Performance = 144.66 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.018456 s, Result = 02800000, Performance = 148.93 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.018906 s, Result = 02940000, Performance = 149.94 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.019938 s, Result = 02a80000, Performance = 146.48 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.019971 s, Result = 02bc0000, Performance = 150.54 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.020336 s, Result = 02d00000, Performance = 152.06 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.020804 s, Result = 02e40000, Performance = 152.77 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.021347 s, Result = 02f80000, Performance = 152.91 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.022038 s, Result = 030c0000, Performance = 152.02 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.021517 s, Result = 03200000, Performance = 159.69 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.021918 s, Result = 03340000, Performance = 160.68 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.023039 s, Result = 03480000, Performance = 156.60 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.023171 s, Result = 035c0000, Performance = 159.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.023498 s, Result = 03700000, Performance = 160.85 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.024212 s, Result = 03840000, Performance = 159.65 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.024524 s, Result = 03980000, Performance = 161.12 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.025133 s, Result = 03ac0000, Performance = 160.64 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.024368 s, Result = 03c00000, Performance = 169.20 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.025403 s, Result = 03d40000, Performance = 165.69 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.026119 s, Result = 03e80000, Performance = 164.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.026029 s, Result = 03fc0000, Performance = 168.31 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.026949 s, Result = 04100000, Performance = 165.75 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.027557 s, Result = 04240000, Performance = 165.21 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.027246 s, Result = 04380000, Performance = 170.25 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.028114 s, Result = 044c0000, Performance = 168.05 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.027717 s, Result = 04600000, Performance = 173.55 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.028629 s, Result = 04740000, Performance = 171.02 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.029294 s, Result = 04880000, Performance = 170.07 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.029608 s, Result = 049c0000, Performance = 171.17 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.029768 s, Result = 04b00000, Performance = 173.14 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.030292 s, Result = 04c40000, Performance = 172.98 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.030956 s, Result = 04d80000, Performance = 172.04 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.031368 s, Result = 04ec0000, Performance = 172.52 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.031876 s, Result = 05000000, Performance = 172.47 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1411   568   448
Test passed: M N K =   550   705  1024
Test passed: M N K =  1352  1598  1344
Test passed: M N K =   874  1538  1472
Test passed: M N K =   956  1657  1536
M N K =  4096  4096   256, Elapsed time =   0.006749 s, Result = a0b40000, Performance =  12.73 TOPS
M N K =  4096  4096   512, Elapsed time =   0.006236 s, Result = a0c80000, Performance =  27.55 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006497 s, Result = a0dc0000, Performance =  39.66 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.006707 s, Result = a0f00000, Performance =  51.23 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007073 s, Result = a1040000, Performance =  60.72 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008931 s, Result = a1180000, Performance =  57.71 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007682 s, Result = a12c0000, Performance =  78.27 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008005 s, Result = a1400000, Performance =  85.84 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008584 s, Result = a1540000, Performance =  90.06 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009030 s, Result = a1680000, Performance =  95.12 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009464 s, Result = a17c0000, Performance =  99.84 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.009779 s, Result = a1900000, Performance = 105.41 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009817 s, Result = a1a40000, Performance = 113.75 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.010587 s, Result = a1b80000, Performance = 113.59 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.010707 s, Result = a1cc0000, Performance = 120.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014338 s, Result = a1e00000, Performance =  95.86 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.011705 s, Result = a1f40000, Performance = 124.76 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.012250 s, Result = a2080000, Performance = 126.22 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.012586 s, Result = a21c0000, Performance = 129.67 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.012958 s, Result = a2300000, Performance = 132.58 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.013130 s, Result = a2440000, Performance = 137.39 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.013625 s, Result = a2580000, Performance = 138.70 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.014103 s, Result = a26c0000, Performance = 140.09 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.014221 s, Result = a2800000, Performance = 144.97 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.014819 s, Result = a2940000, Performance = 144.92 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.014980 s, Result = a2a80000, Performance = 149.09 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.015503 s, Result = a2bc0000, Performance = 149.60 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.015728 s, Result = a2d00000, Performance = 152.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.015986 s, Result = a2e40000, Performance = 155.83 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.016651 s, Result = a2f80000, Performance = 154.76 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.017348 s, Result = a30c0000, Performance = 153.50 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.016944 s, Result = a3200000, Performance = 162.23 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.017732 s, Result = a3340000, Performance = 159.87 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.017905 s, Result = a3480000, Performance = 163.12 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.018563 s, Result = a35c0000, Performance = 161.96 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.018521 s, Result = a3700000, Performance = 166.97 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.019041 s, Result = a3840000, Performance = 166.92 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.019551 s, Result = a3980000, Performance = 166.95 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.019852 s, Result = a3ac0000, Performance = 168.75 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.019959 s, Result = a3c00000, Performance = 172.15 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.020593 s, Result = a3d40000, Performance = 171.02 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.020961 s, Result = a3e80000, Performance = 172.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.021516 s, Result = a3fc0000, Performance = 171.67 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.021853 s, Result = a4100000, Performance = 172.95 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.022102 s, Result = a4240000, Performance = 174.89 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.022241 s, Result = a4380000, Performance = 177.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.022859 s, Result = a44c0000, Performance = 176.62 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.022644 s, Result = a4600000, Performance = 182.09 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.023531 s, Result = a4740000, Performance = 178.87 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.023812 s, Result = a4880000, Performance = 180.37 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.024231 s, Result = a49c0000, Performance = 180.80 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.024591 s, Result = a4b00000, Performance = 181.64 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.025050 s, Result = a4c40000, Performance = 181.75 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.025175 s, Result = a4d80000, Performance = 184.25 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.025851 s, Result = a4ec0000, Performance = 182.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.025633 s, Result = a5000000, Performance = 187.67 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.026489 s, Result = a5140000, Performance = 184.84 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.026693 s, Result = a5280000, Performance = 186.65 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.027133 s, Result = a53c0000, Performance = 186.78 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.027397 s, Result = a5500000, Performance = 188.12 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.027913 s, Result = a5640000, Performance = 187.72 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.028195 s, Result = a5780000, Performance = 188.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.028749 s, Result = a58c0000, Performance = 188.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.028984 s, Result = a5a00000, Performance = 189.68 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=1 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=300*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm 
objdump -d amx-gemm > amx-gemm.s
make lockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo userspace | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
	echo 2300000  | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_setspeed > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 1 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 300 MB
Test passed: M N K =  1568   987   448
Test passed: M N K =   843   886   384
Test passed: M N K =   119  1835  1600
Test passed: M N K =  1336  1536   512
Test passed: M N K =   495  1160   640
M N K =  4096  4096   256, Elapsed time =   0.000693 s, Result = 00140000, Performance = 124.01 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001374 s, Result = 00280000, Performance = 125.04 TOPS
M N K =  4096  4096   768, Elapsed time =   0.001896 s, Result = 003c0000, Performance = 135.93 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002328 s, Result = 00500000, Performance = 147.60 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002735 s, Result = 00640000, Performance = 157.02 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003087 s, Result = 00780000, Performance = 166.97 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003446 s, Result = 008c0000, Performance = 174.50 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.003534 s, Result = 00a00000, Performance = 194.43 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004117 s, Result = 00b40000, Performance = 187.77 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.004312 s, Result = 00c80000, Performance = 199.23 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.004738 s, Result = 00dc0000, Performance = 199.43 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.005030 s, Result = 00f00000, Performance = 204.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.005418 s, Result = 01040000, Performance = 206.12 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.005783 s, Result = 01180000, Performance = 207.95 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.006346 s, Result = 012c0000, Performance = 203.03 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.005987 s, Result = 01400000, Performance = 229.57 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.006919 s, Result = 01540000, Performance = 211.05 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.007189 s, Result = 01680000, Performance = 215.08 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.007795 s, Result = 017c0000, Performance = 209.39 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.008040 s, Result = 01900000, Performance = 213.69 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.008411 s, Result = 01a40000, Performance = 214.48 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.008683 s, Result = 01b80000, Performance = 217.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.009168 s, Result = 01cc0000, Performance = 215.50 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.009092 s, Result = 01e00000, Performance = 226.74 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.009759 s, Result = 01f40000, Performance = 220.05 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.015516 s, Result = 02080000, Performance = 143.94 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.010520 s, Result = 021c0000, Performance = 220.47 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.010564 s, Result = 02300000, Performance = 227.68 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.011150 s, Result = 02440000, Performance = 223.41 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.011388 s, Result = 02580000, Performance = 226.28 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.011952 s, Result = 026c0000, Performance = 222.79 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.011082 s, Result = 02800000, Performance = 248.04 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.012570 s, Result = 02940000, Performance = 225.51 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.012609 s, Result = 02a80000, Performance = 231.63 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.013142 s, Result = 02bc0000, Performance = 228.76 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.013457 s, Result = 02d00000, Performance = 229.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.013679 s, Result = 02e40000, Performance = 232.34 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.014308 s, Result = 02f80000, Performance = 228.13 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.014798 s, Result = 030c0000, Performance = 226.38 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.014681 s, Result = 03200000, Performance = 234.04 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.015295 s, Result = 03340000, Performance = 230.27 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.015429 s, Result = 03480000, Performance = 233.83 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.016175 s, Result = 035c0000, Performance = 228.35 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.016063 s, Result = 03700000, Performance = 235.29 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.016637 s, Result = 03840000, Performance = 232.34 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.017090 s, Result = 03980000, Performance = 231.21 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.017226 s, Result = 03ac0000, Performance = 234.37 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.016804 s, Result = 03c00000, Performance = 245.36 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.017878 s, Result = 03d40000, Performance = 235.43 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.018234 s, Result = 03e80000, Performance = 235.55 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.018795 s, Result = 03fc0000, Performance = 233.09 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.018859 s, Result = 04100000, Performance = 236.85 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.019698 s, Result = 04240000, Performance = 231.13 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.019853 s, Result = 04380000, Performance = 233.64 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.020196 s, Result = 044c0000, Performance = 233.93 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.020396 s, Result = 04600000, Performance = 235.85 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.021028 s, Result = 04740000, Performance = 232.85 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.021232 s, Result = 04880000, Performance = 234.66 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.021596 s, Result = 049c0000, Performance = 234.67 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.021852 s, Result = 04b00000, Performance = 235.86 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.022470 s, Result = 04c40000, Performance = 233.19 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.022704 s, Result = 04d80000, Performance = 234.58 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.023529 s, Result = 04ec0000, Performance = 230.00 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.023287 s, Result = 05000000, Performance = 236.08 TOPS
make unlockfreq
make[1]: Entering directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239; do \
	echo ondemand | sudo tee /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor > /dev/null; \
done
make[1]: Leaving directory '/home/wangchongxi/452/cpu-gemm-ldst-bench'
