cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   514  1564  1216
Test passed: M N K =  1451   787  1536
Test passed: M N K =   509  1703   960
Test passed: M N K =   931  1451   320
Test passed: M N K =  1473   706   640
M N K =  1024  1024   256, Elapsed time =   0.005796 s, Result = 59060000, Performance =   0.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007944 s, Result = a10b0000, Performance =   1.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008471 s, Result = e9100000, Performance =   1.90 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.009774 s, Result = 31150000, Performance =   2.20 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.011327 s, Result = 791a0000, Performance =   2.37 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012942 s, Result = c11f0000, Performance =   2.49 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.014553 s, Result = 09240000, Performance =   2.58 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.016022 s, Result = 51290000, Performance =   2.68 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.017428 s, Result = 992e0000, Performance =   2.77 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.018965 s, Result = e1330000, Performance =   2.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.020377 s, Result = 29380000, Performance =   2.90 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.021781 s, Result = 713d0000, Performance =   2.96 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.023108 s, Result = b9420000, Performance =   3.02 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.024939 s, Result = 01470000, Performance =   3.01 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.026060 s, Result = 494c0000, Performance =   3.09 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.027569 s, Result = 91510000, Performance =   3.12 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.029041 s, Result = d9560000, Performance =   3.14 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.030674 s, Result = 215b0000, Performance =   3.15 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.032481 s, Result = 69600000, Performance =   3.14 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.034091 s, Result = b1650000, Performance =   3.15 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.035842 s, Result = f96a0000, Performance =   3.15 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.037833 s, Result = 416f0000, Performance =   3.12 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.039971 s, Result = 89740000, Performance =   3.09 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.042528 s, Result = d1790000, Performance =   3.03 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.044589 s, Result = 197e0000, Performance =   3.01 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.046860 s, Result = 61830000, Performance =   2.98 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.048820 s, Result = a9880000, Performance =   2.97 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.050947 s, Result = f18d0000, Performance =   2.95 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.053744 s, Result = 39920000, Performance =   2.90 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.055394 s, Result = 81970000, Performance =   2.91 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.057076 s, Result = c99c0000, Performance =   2.92 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.058748 s, Result = 11a10000, Performance =   2.92 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.058535 s, Result = 59a60000, Performance =   3.03 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.060212 s, Result = a1ab0000, Performance =   3.03 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.063195 s, Result = e9b00000, Performance =   2.97 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.064996 s, Result = 31b50000, Performance =   2.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.067910 s, Result = 79ba0000, Performance =   2.93 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.069610 s, Result = c1bf0000, Performance =   2.93 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.071940 s, Result = 09c40000, Performance =   2.91 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.074290 s, Result = 51c90000, Performance =   2.89 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.076252 s, Result = 99ce0000, Performance =   2.89 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.077267 s, Result = e1d30000, Performance =   2.92 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.078958 s, Result = 29d80000, Performance =   2.92 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.082918 s, Result = 71dd0000, Performance =   2.85 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.082962 s, Result = b9e20000, Performance =   2.91 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.103184 s, Result = 01e70000, Performance =   2.39 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.093665 s, Result = 49ec0000, Performance =   2.69 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.110904 s, Result = 91f10000, Performance =   2.32 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.092143 s, Result = d9f60000, Performance =   2.85 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.094390 s, Result = 21fb0000, Performance =   2.84 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.093042 s, Result = 6a000000, Performance =   2.94 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.095813 s, Result = b2050000, Performance =   2.91 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.098073 s, Result = fa0a0000, Performance =   2.90 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.100971 s, Result = 420f0000, Performance =   2.87 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.104114 s, Result = 8a140000, Performance =   2.84 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.106401 s, Result = d2190000, Performance =   2.83 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.107658 s, Result = 1a1e0000, Performance =   2.84 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.111223 s, Result = 62230000, Performance =   2.80 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.113755 s, Result = aa280000, Performance =   2.78 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.116727 s, Result = f22d0000, Performance =   2.76 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.117581 s, Result = 3a320000, Performance =   2.79 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.120775 s, Result = 82370000, Performance =   2.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.122502 s, Result = ca3c0000, Performance =   2.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.124525 s, Result = 12410000, Performance =   2.76 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1033   316  1600
Test passed: M N K =  1042  1179  1792
Test passed: M N K =   222  1575   576
Test passed: M N K =   406  1925   512
Test passed: M N K =  1012   785  1792
M N K =  1024  1024   256, Elapsed time =   0.002771 s, Result = 00050000, Performance =   1.94 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004176 s, Result = 000a0000, Performance =   2.57 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005816 s, Result = 000f0000, Performance =   2.77 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007368 s, Result = 00140000, Performance =   2.91 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008860 s, Result = 00190000, Performance =   3.03 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010334 s, Result = 001e0000, Performance =   3.12 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011760 s, Result = 00230000, Performance =   3.20 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013269 s, Result = 00280000, Performance =   3.24 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014649 s, Result = 002d0000, Performance =   3.30 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.016045 s, Result = 00320000, Performance =   3.35 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.017424 s, Result = 00370000, Performance =   3.39 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.018434 s, Result = 003c0000, Performance =   3.49 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.019871 s, Result = 00410000, Performance =   3.51 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.021366 s, Result = 00460000, Performance =   3.52 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.022898 s, Result = 004b0000, Performance =   3.52 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.024293 s, Result = 00500000, Performance =   3.54 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.025978 s, Result = 00550000, Performance =   3.51 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.027587 s, Result = 005a0000, Performance =   3.50 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.029228 s, Result = 005f0000, Performance =   3.49 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.030550 s, Result = 00640000, Performance =   3.51 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.032323 s, Result = 00690000, Performance =   3.49 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.034055 s, Result = 006e0000, Performance =   3.47 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.035678 s, Result = 00730000, Performance =   3.46 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.037629 s, Result = 00780000, Performance =   3.42 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.039143 s, Result = 007d0000, Performance =   3.43 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.040977 s, Result = 00820000, Performance =   3.41 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.042838 s, Result = 00870000, Performance =   3.38 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.044519 s, Result = 008c0000, Performance =   3.38 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.046199 s, Result = 00910000, Performance =   3.37 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.048685 s, Result = 00960000, Performance =   3.31 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.050524 s, Result = 009b0000, Performance =   3.29 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.052156 s, Result = 00a00000, Performance =   3.29 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.053063 s, Result = 00a50000, Performance =   3.34 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.054675 s, Result = 00aa0000, Performance =   3.34 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.057349 s, Result = 00af0000, Performance =   3.28 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.059764 s, Result = 00b40000, Performance =   3.23 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.060845 s, Result = 00b90000, Performance =   3.26 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.063746 s, Result = 00be0000, Performance =   3.20 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.065348 s, Result = 00c30000, Performance =   3.20 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.066880 s, Result = 00c80000, Performance =   3.21 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.069087 s, Result = 00cd0000, Performance =   3.19 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.071166 s, Result = 00d20000, Performance =   3.17 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.072078 s, Result = 00d70000, Performance =   3.20 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.075163 s, Result = 00dc0000, Performance =   3.14 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.075846 s, Result = 00e10000, Performance =   3.19 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.078843 s, Result = 00e60000, Performance =   3.13 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.080807 s, Result = 00eb0000, Performance =   3.12 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.082334 s, Result = 00f00000, Performance =   3.13 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.084292 s, Result = 00f50000, Performance =   3.12 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.087909 s, Result = 00fa0000, Performance =   3.05 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.088599 s, Result = 00ff0000, Performance =   3.09 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.093620 s, Result = 01040000, Performance =   2.98 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.094107 s, Result = 01090000, Performance =   3.02 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.097596 s, Result = 010e0000, Performance =   2.97 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.098280 s, Result = 01130000, Performance =   3.00 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.102787 s, Result = 01180000, Performance =   2.92 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.104115 s, Result = 011d0000, Performance =   2.94 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.105188 s, Result = 01220000, Performance =   2.96 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.108853 s, Result = 01270000, Performance =   2.91 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.109672 s, Result = 012c0000, Performance =   2.94 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.113059 s, Result = 01310000, Performance =   2.90 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.114962 s, Result = 01360000, Performance =   2.90 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.118289 s, Result = 013b0000, Performance =   2.86 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.120882 s, Result = 01400000, Performance =   2.84 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1190   482  1408
Test passed: M N K =  1620  1912   896
Test passed: M N K =   444   784   512
Test passed: M N K =   254   792   640
Test passed: M N K =  1056   918  1280
M N K =  1024  1024   256, Elapsed time =   0.004827 s, Result = 0a0f0000, Performance =   1.11 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006196 s, Result = 0a140000, Performance =   1.73 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007792 s, Result = 0a190000, Performance =   2.07 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008971 s, Result = 0a1e0000, Performance =   2.39 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.010624 s, Result = 0a230000, Performance =   2.53 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012144 s, Result = 0a280000, Performance =   2.65 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.013536 s, Result = 0a2d0000, Performance =   2.78 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.014984 s, Result = 0a320000, Performance =   2.87 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.016309 s, Result = 0a370000, Performance =   2.96 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.017642 s, Result = 0a3c0000, Performance =   3.04 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.018978 s, Result = 0a410000, Performance =   3.11 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.020356 s, Result = 0a460000, Performance =   3.16 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.021818 s, Result = 0a4b0000, Performance =   3.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.023245 s, Result = 0a500000, Performance =   3.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.024684 s, Result = 0a550000, Performance =   3.26 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.026132 s, Result = 0a5a0000, Performance =   3.29 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.027560 s, Result = 0a5f0000, Performance =   3.31 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.028977 s, Result = 0a640000, Performance =   3.33 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.030424 s, Result = 0a690000, Performance =   3.35 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.031941 s, Result = 0a6e0000, Performance =   3.36 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.033612 s, Result = 0a730000, Performance =   3.35 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.035028 s, Result = 0a780000, Performance =   3.37 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.036628 s, Result = 0a7d0000, Performance =   3.37 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.038353 s, Result = 0a820000, Performance =   3.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.039996 s, Result = 0a870000, Performance =   3.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.041718 s, Result = 0a8c0000, Performance =   3.35 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.043450 s, Result = 0a910000, Performance =   3.34 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.045059 s, Result = 0a960000, Performance =   3.34 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.046691 s, Result = 0a9b0000, Performance =   3.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.048542 s, Result = 0aa00000, Performance =   3.32 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.050215 s, Result = 0aa50000, Performance =   3.31 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.052034 s, Result = 0aaa0000, Performance =   3.30 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.052788 s, Result = 0aaf0000, Performance =   3.36 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.054569 s, Result = 0ab40000, Performance =   3.35 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.056165 s, Result = 0ab90000, Performance =   3.35 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.058041 s, Result = 0abe0000, Performance =   3.33 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.059612 s, Result = 0ac30000, Performance =   3.33 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.060985 s, Result = 0ac80000, Performance =   3.35 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.063049 s, Result = 0acd0000, Performance =   3.32 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.064985 s, Result = 0ad20000, Performance =   3.30 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.070557 s, Result = 0ad70000, Performance =   3.12 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.072045 s, Result = 0adc0000, Performance =   3.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.074061 s, Result = 0ae10000, Performance =   3.12 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.075802 s, Result = 0ae60000, Performance =   3.12 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.077404 s, Result = 0aeb0000, Performance =   3.12 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.079994 s, Result = 0af00000, Performance =   3.09 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.082843 s, Result = 0af50000, Performance =   3.05 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.083292 s, Result = 0afa0000, Performance =   3.09 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.084097 s, Result = 0aff0000, Performance =   3.13 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.086972 s, Result = 0b040000, Performance =   3.09 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.091639 s, Result = 0b090000, Performance =   2.99 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.093097 s, Result = 0b0e0000, Performance =   3.00 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.093244 s, Result = 0b130000, Performance =   3.05 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.096824 s, Result = 0b180000, Performance =   2.99 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.099447 s, Result = 0b1d0000, Performance =   2.97 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.101606 s, Result = 0b220000, Performance =   2.96 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.103493 s, Result = 0b270000, Performance =   2.96 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.105750 s, Result = 0b2c0000, Performance =   2.94 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.108720 s, Result = 0b310000, Performance =   2.91 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.110987 s, Result = 0b360000, Performance =   2.90 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.112970 s, Result = 0b3b0000, Performance =   2.90 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.115656 s, Result = 0b400000, Performance =   2.88 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.119177 s, Result = 0b450000, Performance =   2.84 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.120338 s, Result = 0b4a0000, Performance =   2.86 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1888   240  1792
Test passed: M N K =   495   152  1152
Test passed: M N K =   784  1188  1664
Test passed: M N K =  1426   658   832
Test passed: M N K =   820  1122   640
M N K =  1024  1024   256, Elapsed time =   0.001367 s, Result = 00050000, Performance =   3.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002958 s, Result = 000a0000, Performance =   3.63 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004371 s, Result = 000f0000, Performance =   3.68 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005789 s, Result = 00140000, Performance =   3.71 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007308 s, Result = 00190000, Performance =   3.67 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008529 s, Result = 001e0000, Performance =   3.78 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009685 s, Result = 00230000, Performance =   3.88 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011014 s, Result = 00280000, Performance =   3.90 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012484 s, Result = 002d0000, Performance =   3.87 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013956 s, Result = 00320000, Performance =   3.85 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015225 s, Result = 00370000, Performance =   3.88 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016522 s, Result = 003c0000, Performance =   3.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017953 s, Result = 00410000, Performance =   3.89 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019344 s, Result = 00460000, Performance =   3.89 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020739 s, Result = 004b0000, Performance =   3.88 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022278 s, Result = 00500000, Performance =   3.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023755 s, Result = 00550000, Performance =   3.84 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024931 s, Result = 005a0000, Performance =   3.88 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.026452 s, Result = 005f0000, Performance =   3.86 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.028174 s, Result = 00640000, Performance =   3.81 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.029820 s, Result = 00690000, Performance =   3.78 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.031429 s, Result = 006e0000, Performance =   3.76 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.032910 s, Result = 00730000, Performance =   3.75 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.034520 s, Result = 00780000, Performance =   3.73 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.036017 s, Result = 007d0000, Performance =   3.73 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.038069 s, Result = 00820000, Performance =   3.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.039727 s, Result = 00870000, Performance =   3.65 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.041165 s, Result = 008c0000, Performance =   3.65 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.042925 s, Result = 00910000, Performance =   3.63 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.045390 s, Result = 00960000, Performance =   3.55 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.047469 s, Result = 009b0000, Performance =   3.51 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.048429 s, Result = 00a00000, Performance =   3.55 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.049260 s, Result = 00a50000, Performance =   3.60 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.051423 s, Result = 00aa0000, Performance =   3.55 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.053791 s, Result = 00af0000, Performance =   3.49 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.055865 s, Result = 00b40000, Performance =   3.46 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.057966 s, Result = 00b90000, Performance =   3.43 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.059110 s, Result = 00be0000, Performance =   3.45 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.060542 s, Result = 00c30000, Performance =   3.46 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.063508 s, Result = 00c80000, Performance =   3.38 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.064483 s, Result = 00cd0000, Performance =   3.41 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.065773 s, Result = 00d20000, Performance =   3.43 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.067006 s, Result = 00d70000, Performance =   3.45 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.070294 s, Result = 00dc0000, Performance =   3.36 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.071091 s, Result = 00e10000, Performance =   3.40 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.073634 s, Result = 00e60000, Performance =   3.35 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.076583 s, Result = 00eb0000, Performance =   3.29 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.078063 s, Result = 00f00000, Performance =   3.30 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.079646 s, Result = 00f50000, Performance =   3.30 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.083027 s, Result = 00fa0000, Performance =   3.23 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.085914 s, Result = 00ff0000, Performance =   3.19 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.088953 s, Result = 01040000, Performance =   3.14 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.089700 s, Result = 01090000, Performance =   3.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.091613 s, Result = 010e0000, Performance =   3.16 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.093509 s, Result = 01130000, Performance =   3.16 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.095306 s, Result = 01180000, Performance =   3.15 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.097662 s, Result = 011d0000, Performance =   3.13 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.100367 s, Result = 01220000, Performance =   3.10 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.101355 s, Result = 01270000, Performance =   3.13 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.105470 s, Result = 012c0000, Performance =   3.05 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.107833 s, Result = 01310000, Performance =   3.04 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.112354 s, Result = 01360000, Performance =   2.96 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.112589 s, Result = 013b0000, Performance =   3.00 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.114428 s, Result = 01400000, Performance =   3.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    69   658   704
Test passed: M N K =   400   319  2048
Test passed: M N K =  1317  1749  1088
Test passed: M N K =   592  1513   320
Test passed: M N K =   459   245   768
M N K =  1024  1024   256, Elapsed time =   0.007352 s, Result = 59060000, Performance =   0.73 TOPS
M N K =  1024  1024   512, Elapsed time =   0.008617 s, Result = a10b0000, Performance =   1.25 TOPS
M N K =  1024  1024   768, Elapsed time =   0.010366 s, Result = e9100000, Performance =   1.55 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.010038 s, Result = 31150000, Performance =   2.14 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.011016 s, Result = 791a0000, Performance =   2.44 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012391 s, Result = c11f0000, Performance =   2.60 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.013766 s, Result = 09240000, Performance =   2.73 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.015479 s, Result = 51290000, Performance =   2.77 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.016509 s, Result = 992e0000, Performance =   2.93 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.017863 s, Result = e1330000, Performance =   3.01 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.019285 s, Result = 29380000, Performance =   3.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.020680 s, Result = 713d0000, Performance =   3.12 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022075 s, Result = b9420000, Performance =   3.16 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.023561 s, Result = 01470000, Performance =   3.19 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.035560 s, Result = 494c0000, Performance =   2.26 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.028697 s, Result = 91510000, Performance =   2.99 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.027796 s, Result = d9560000, Performance =   3.28 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.038163 s, Result = 215b0000, Performance =   2.53 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.041316 s, Result = 69600000, Performance =   2.47 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.032350 s, Result = b1650000, Performance =   3.32 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.039019 s, Result = f96a0000, Performance =   2.89 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.036834 s, Result = 416f0000, Performance =   3.21 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.036925 s, Result = 89740000, Performance =   3.34 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.047376 s, Result = d1790000, Performance =   2.72 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.049442 s, Result = 197e0000, Performance =   2.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.041583 s, Result = 61830000, Performance =   3.36 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.062243 s, Result = a9880000, Performance =   2.33 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.049177 s, Result = f18d0000, Performance =   3.06 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.053188 s, Result = 39920000, Performance =   2.93 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.052707 s, Result = 81970000, Performance =   3.06 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.050879 s, Result = c99c0000, Performance =   3.27 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.077786 s, Result = 11a10000, Performance =   2.21 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.054009 s, Result = 59a60000, Performance =   3.28 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.072601 s, Result = a1ab0000, Performance =   2.51 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.056738 s, Result = e9b00000, Performance =   3.31 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.071256 s, Result = 31b50000, Performance =   2.71 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.060115 s, Result = 79ba0000, Performance =   3.30 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.075196 s, Result = c1bf0000, Performance =   2.71 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.075072 s, Result = 09c40000, Performance =   2.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.066310 s, Result = 51c90000, Performance =   3.24 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.069523 s, Result = 99ce0000, Performance =   3.17 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.071169 s, Result = e1d30000, Performance =   3.17 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.091577 s, Result = 29d80000, Performance =   2.52 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.077084 s, Result = 71dd0000, Performance =   3.06 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.080259 s, Result = b9e20000, Performance =   3.01 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.094131 s, Result = 01e70000, Performance =   2.62 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.095936 s, Result = 49ec0000, Performance =   2.63 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.086471 s, Result = 91f10000, Performance =   2.98 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.084063 s, Result = d9f60000, Performance =   3.13 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.086981 s, Result = 21fb0000, Performance =   3.09 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.089454 s, Result = 6a000000, Performance =   3.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.091119 s, Result = b2050000, Performance =   3.06 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.140088 s, Result = fa0a0000, Performance =   2.03 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.146779 s, Result = 420f0000, Performance =   1.98 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.105349 s, Result = 8a140000, Performance =   2.80 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.104230 s, Result = d2190000, Performance =   2.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.111612 s, Result = 1a1e0000, Performance =   2.74 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.113580 s, Result = 62230000, Performance =   2.74 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.110709 s, Result = aa280000, Performance =   2.86 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.114659 s, Result = f22d0000, Performance =   2.81 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.116548 s, Result = 3a320000, Performance =   2.81 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.119857 s, Result = 82370000, Performance =   2.78 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.119565 s, Result = ca3c0000, Performance =   2.83 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.123158 s, Result = 12410000, Performance =   2.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   627  1202  1856
Test passed: M N K =  1190  1368   384
Test passed: M N K =   918    58  1408
Test passed: M N K =   159  1595   704
Test passed: M N K =   660   796   384
M N K =  1024  1024   256, Elapsed time =   0.003821 s, Result = 00050000, Performance =   1.41 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004544 s, Result = 000a0000, Performance =   2.36 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005932 s, Result = 000f0000, Performance =   2.72 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007327 s, Result = 00140000, Performance =   2.93 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008756 s, Result = 00190000, Performance =   3.07 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010317 s, Result = 001e0000, Performance =   3.12 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011950 s, Result = 00230000, Performance =   3.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013476 s, Result = 00280000, Performance =   3.19 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.015092 s, Result = 002d0000, Performance =   3.20 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.016558 s, Result = 00320000, Performance =   3.24 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.018105 s, Result = 00370000, Performance =   3.26 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.019458 s, Result = 003c0000, Performance =   3.31 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.020884 s, Result = 00410000, Performance =   3.34 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.022194 s, Result = 00460000, Performance =   3.39 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.023507 s, Result = 004b0000, Performance =   3.43 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.024943 s, Result = 00500000, Performance =   3.44 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.026495 s, Result = 00550000, Performance =   3.44 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.028146 s, Result = 005a0000, Performance =   3.43 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.029702 s, Result = 005f0000, Performance =   3.43 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.031071 s, Result = 00640000, Performance =   3.46 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.032933 s, Result = 00690000, Performance =   3.42 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.034712 s, Result = 006e0000, Performance =   3.40 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.041165 s, Result = 00730000, Performance =   3.00 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.036872 s, Result = 00780000, Performance =   3.49 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.038336 s, Result = 007d0000, Performance =   3.50 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.041380 s, Result = 00820000, Performance =   3.37 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.041231 s, Result = 00870000, Performance =   3.52 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.043142 s, Result = 008c0000, Performance =   3.48 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.044495 s, Result = 00910000, Performance =   3.50 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.046278 s, Result = 00960000, Performance =   3.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.048011 s, Result = 009b0000, Performance =   3.47 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.050073 s, Result = 00a00000, Performance =   3.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.050964 s, Result = 00a50000, Performance =   3.48 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.052337 s, Result = 00aa0000, Performance =   3.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.053772 s, Result = 00af0000, Performance =   3.49 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.055944 s, Result = 00b40000, Performance =   3.45 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.057336 s, Result = 00b90000, Performance =   3.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.059584 s, Result = 00be0000, Performance =   3.42 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.061298 s, Result = 00c30000, Performance =   3.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.063919 s, Result = 00c80000, Performance =   3.36 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.065960 s, Result = 00cd0000, Performance =   3.34 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.066841 s, Result = 00d20000, Performance =   3.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.069334 s, Result = 00d70000, Performance =   3.33 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.071306 s, Result = 00dc0000, Performance =   3.31 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.073489 s, Result = 00e10000, Performance =   3.29 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.075269 s, Result = 00e60000, Performance =   3.28 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.076589 s, Result = 00eb0000, Performance =   3.29 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.103916 s, Result = 00f00000, Performance =   2.48 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.093678 s, Result = 00f50000, Performance =   2.81 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.104836 s, Result = 00fa0000, Performance =   2.56 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.088930 s, Result = 00ff0000, Performance =   3.08 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.091838 s, Result = 01040000, Performance =   3.04 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.091949 s, Result = 01090000, Performance =   3.09 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.094843 s, Result = 010e0000, Performance =   3.06 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.096879 s, Result = 01130000, Performance =   3.05 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.099419 s, Result = 01180000, Performance =   3.02 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.101891 s, Result = 011d0000, Performance =   3.00 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.104312 s, Result = 01220000, Performance =   2.99 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.106052 s, Result = 01270000, Performance =   2.99 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.109511 s, Result = 012c0000, Performance =   2.94 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.111340 s, Result = 01310000, Performance =   2.94 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.115440 s, Result = 01360000, Performance =   2.88 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.116163 s, Result = 013b0000, Performance =   2.91 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.118054 s, Result = 01400000, Performance =   2.91 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   671  1426   512
Test passed: M N K =   993   362   448
Test passed: M N K =   817  1368  1024
Test passed: M N K =  1997    32  1856
Test passed: M N K =  1122   137   320
M N K =  1024  1024   256, Elapsed time =   0.005628 s, Result = 0a0f0000, Performance =   0.95 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006942 s, Result = 0a140000, Performance =   1.55 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007932 s, Result = 0a190000, Performance =   2.03 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.009346 s, Result = 0a1e0000, Performance =   2.30 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.010907 s, Result = 0a230000, Performance =   2.46 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012727 s, Result = 0a280000, Performance =   2.53 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.014577 s, Result = 0a2d0000, Performance =   2.58 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.015730 s, Result = 0a320000, Performance =   2.73 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.017194 s, Result = 0a370000, Performance =   2.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.018481 s, Result = 0a3c0000, Performance =   2.91 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.020095 s, Result = 0a410000, Performance =   2.94 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.020970 s, Result = 0a460000, Performance =   3.07 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022381 s, Result = 0a4b0000, Performance =   3.12 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.024131 s, Result = 0a500000, Performance =   3.11 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.025173 s, Result = 0a550000, Performance =   3.20 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.026663 s, Result = 0a5a0000, Performance =   3.22 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.028087 s, Result = 0a5f0000, Performance =   3.25 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.029655 s, Result = 0a640000, Performance =   3.26 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.031956 s, Result = 0a690000, Performance =   3.19 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.033126 s, Result = 0a6e0000, Performance =   3.24 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.034589 s, Result = 0a730000, Performance =   3.26 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.036489 s, Result = 0a780000, Performance =   3.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.038301 s, Result = 0a7d0000, Performance =   3.22 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.040691 s, Result = 0a820000, Performance =   3.17 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.042437 s, Result = 0a870000, Performance =   3.16 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.045159 s, Result = 0a8c0000, Performance =   3.09 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.045614 s, Result = 0a910000, Performance =   3.18 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.048100 s, Result = 0a960000, Performance =   3.13 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.049742 s, Result = 0a9b0000, Performance =   3.13 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.051711 s, Result = 0aa00000, Performance =   3.11 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.053801 s, Result = 0aa50000, Performance =   3.09 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.055447 s, Result = 0aaa0000, Performance =   3.10 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.056842 s, Result = 0aaf0000, Performance =   3.12 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.057335 s, Result = 0ab40000, Performance =   3.18 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.059051 s, Result = 0ab90000, Performance =   3.18 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.061052 s, Result = 0abe0000, Performance =   3.17 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.062471 s, Result = 0ac30000, Performance =   3.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.065857 s, Result = 0ac80000, Performance =   3.10 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.066498 s, Result = 0acd0000, Performance =   3.15 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.068577 s, Result = 0ad20000, Performance =   3.13 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.071084 s, Result = 0ad70000, Performance =   3.10 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.072003 s, Result = 0adc0000, Performance =   3.13 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.073373 s, Result = 0ae10000, Performance =   3.15 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.075926 s, Result = 0ae60000, Performance =   3.11 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.077354 s, Result = 0aeb0000, Performance =   3.12 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.078173 s, Result = 0af00000, Performance =   3.16 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.082328 s, Result = 0af50000, Performance =   3.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.083578 s, Result = 0afa0000, Performance =   3.08 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.084276 s, Result = 0aff0000, Performance =   3.12 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.087823 s, Result = 0b040000, Performance =   3.06 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.088286 s, Result = 0b090000, Performance =   3.10 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.090212 s, Result = 0b0e0000, Performance =   3.09 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.093801 s, Result = 0b130000, Performance =   3.03 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.094496 s, Result = 0b180000, Performance =   3.07 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.097055 s, Result = 0b1d0000, Performance =   3.04 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.100386 s, Result = 0b220000, Performance =   2.99 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.102857 s, Result = 0b270000, Performance =   2.98 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.105703 s, Result = 0b2c0000, Performance =   2.95 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.107525 s, Result = 0b310000, Performance =   2.95 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.111098 s, Result = 0b360000, Performance =   2.90 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.113166 s, Result = 0b3b0000, Performance =   2.89 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.115451 s, Result = 0b400000, Performance =   2.88 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.117217 s, Result = 0b450000, Performance =   2.89 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.119391 s, Result = 0b4a0000, Performance =   2.88 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   640   484   448
Test passed: M N K =   303   260  1472
Test passed: M N K =  1298  1954   704
Test passed: M N K =   874   859  1408
Test passed: M N K =  1557  1575  1536
M N K =  1024  1024   256, Elapsed time =   0.001530 s, Result = 00050000, Performance =   3.51 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003090 s, Result = 000a0000, Performance =   3.47 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004869 s, Result = 000f0000, Performance =   3.31 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006568 s, Result = 00140000, Performance =   3.27 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008292 s, Result = 00190000, Performance =   3.24 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009869 s, Result = 001e0000, Performance =   3.26 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011881 s, Result = 00230000, Performance =   3.16 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013497 s, Result = 00280000, Performance =   3.18 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.015231 s, Result = 002d0000, Performance =   3.17 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.016953 s, Result = 00320000, Performance =   3.17 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.018889 s, Result = 00370000, Performance =   3.13 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.020528 s, Result = 003c0000, Performance =   3.14 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022493 s, Result = 00410000, Performance =   3.10 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.024065 s, Result = 00460000, Performance =   3.12 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.026011 s, Result = 004b0000, Performance =   3.10 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.027483 s, Result = 00500000, Performance =   3.13 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.029299 s, Result = 00550000, Performance =   3.12 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.030796 s, Result = 005a0000, Performance =   3.14 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.032302 s, Result = 005f0000, Performance =   3.16 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.032990 s, Result = 00640000, Performance =   3.25 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.033945 s, Result = 00690000, Performance =   3.32 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.033189 s, Result = 006e0000, Performance =   3.56 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.033335 s, Result = 00730000, Performance =   3.70 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.034795 s, Result = 00780000, Performance =   3.70 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.036513 s, Result = 007d0000, Performance =   3.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.038094 s, Result = 00820000, Performance =   3.66 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.040039 s, Result = 00870000, Performance =   3.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.042142 s, Result = 008c0000, Performance =   3.57 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.044147 s, Result = 00910000, Performance =   3.53 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.046954 s, Result = 00960000, Performance =   3.43 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.049386 s, Result = 009b0000, Performance =   3.37 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.052662 s, Result = 00a00000, Performance =   3.26 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.053248 s, Result = 00a50000, Performance =   3.33 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.054118 s, Result = 00aa0000, Performance =   3.37 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.055316 s, Result = 00af0000, Performance =   3.40 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.056817 s, Result = 00b40000, Performance =   3.40 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.057634 s, Result = 00b90000, Performance =   3.45 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.061310 s, Result = 00be0000, Performance =   3.33 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.060001 s, Result = 00c30000, Performance =   3.49 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.063763 s, Result = 00c80000, Performance =   3.37 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.064838 s, Result = 00cd0000, Performance =   3.39 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.066826 s, Result = 00d20000, Performance =   3.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.068494 s, Result = 00d70000, Performance =   3.37 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.069704 s, Result = 00dc0000, Performance =   3.39 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.071435 s, Result = 00e10000, Performance =   3.38 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.073359 s, Result = 00e60000, Performance =   3.37 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.075800 s, Result = 00eb0000, Performance =   3.33 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.076684 s, Result = 00f00000, Performance =   3.36 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.079151 s, Result = 00f50000, Performance =   3.32 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.080436 s, Result = 00fa0000, Performance =   3.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.082356 s, Result = 00ff0000, Performance =   3.32 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.084968 s, Result = 01040000, Performance =   3.29 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.087702 s, Result = 01090000, Performance =   3.24 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.089573 s, Result = 010e0000, Performance =   3.24 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.091427 s, Result = 01130000, Performance =   3.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.094176 s, Result = 01180000, Performance =   3.19 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.097272 s, Result = 011d0000, Performance =   3.15 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.099559 s, Result = 01220000, Performance =   3.13 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.100881 s, Result = 01270000, Performance =   3.14 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.103454 s, Result = 012c0000, Performance =   3.11 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.105837 s, Result = 01310000, Performance =   3.09 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.108073 s, Result = 01360000, Performance =   3.08 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.110873 s, Result = 013b0000, Performance =   3.05 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.112406 s, Result = 01400000, Performance =   3.06 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   274  1858   320
Test passed: M N K =  1637  1055  2048
Test passed: M N K =   525   366   960
Test passed: M N K =   487  1119  1920
Test passed: M N K =   888  1020  1600
M N K =  1024  1024   256, Elapsed time =   0.006238 s, Result = 59060000, Performance =   0.86 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007154 s, Result = a10b0000, Performance =   1.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008314 s, Result = e9100000, Performance =   1.94 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.009742 s, Result = 31150000, Performance =   2.20 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.011415 s, Result = 791a0000, Performance =   2.35 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012891 s, Result = c11f0000, Performance =   2.50 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.014408 s, Result = 09240000, Performance =   2.61 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.015746 s, Result = 51290000, Performance =   2.73 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.017225 s, Result = 992e0000, Performance =   2.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.018705 s, Result = e1330000, Performance =   2.87 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.020019 s, Result = 29380000, Performance =   2.95 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.021278 s, Result = 713d0000, Performance =   3.03 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022610 s, Result = b9420000, Performance =   3.09 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.024015 s, Result = 01470000, Performance =   3.13 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.025498 s, Result = 494c0000, Performance =   3.16 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.026917 s, Result = 91510000, Performance =   3.19 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.028670 s, Result = d9560000, Performance =   3.18 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.029769 s, Result = 215b0000, Performance =   3.25 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.031270 s, Result = 69600000, Performance =   3.26 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.033079 s, Result = b1650000, Performance =   3.25 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.034554 s, Result = f96a0000, Performance =   3.26 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.036069 s, Result = 416f0000, Performance =   3.27 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.038015 s, Result = 89740000, Performance =   3.25 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.039798 s, Result = d1790000, Performance =   3.24 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.041936 s, Result = 197e0000, Performance =   3.20 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.043726 s, Result = 61830000, Performance =   3.19 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.045982 s, Result = a9880000, Performance =   3.15 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.047582 s, Result = f18d0000, Performance =   3.16 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.049856 s, Result = 39920000, Performance =   3.12 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.051457 s, Result = 81970000, Performance =   3.13 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.053418 s, Result = c99c0000, Performance =   3.12 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.055330 s, Result = 11a10000, Performance =   3.10 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.057645 s, Result = 59a60000, Performance =   3.07 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.059084 s, Result = a1ab0000, Performance =   3.09 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.060959 s, Result = e9b00000, Performance =   3.08 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.061736 s, Result = 31b50000, Performance =   3.13 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.064078 s, Result = 79ba0000, Performance =   3.10 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.065813 s, Result = c1bf0000, Performance =   3.10 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.067477 s, Result = 09c40000, Performance =   3.10 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.068938 s, Result = 51c90000, Performance =   3.12 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.071910 s, Result = 99ce0000, Performance =   3.06 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.072387 s, Result = e1d30000, Performance =   3.11 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.074955 s, Result = 29d80000, Performance =   3.08 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.075879 s, Result = 71dd0000, Performance =   3.11 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.077387 s, Result = b9e20000, Performance =   3.12 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.079290 s, Result = 01e70000, Performance =   3.11 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.081654 s, Result = 49ec0000, Performance =   3.09 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.084719 s, Result = 91f10000, Performance =   3.04 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.085159 s, Result = d9f60000, Performance =   3.09 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.086917 s, Result = 21fb0000, Performance =   3.09 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.089455 s, Result = 6a000000, Performance =   3.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.090669 s, Result = b2050000, Performance =   3.08 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.094193 s, Result = fa0a0000, Performance =   3.02 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.095259 s, Result = 420f0000, Performance =   3.04 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.099433 s, Result = 8a140000, Performance =   2.97 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.101125 s, Result = d2190000, Performance =   2.97 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.103936 s, Result = 1a1e0000, Performance =   2.94 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.107372 s, Result = 62230000, Performance =   2.90 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.108446 s, Result = aa280000, Performance =   2.92 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.111793 s, Result = f22d0000, Performance =   2.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.114181 s, Result = 3a320000, Performance =   2.87 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.116067 s, Result = 82370000, Performance =   2.87 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.118759 s, Result = ca3c0000, Performance =   2.85 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.121193 s, Result = 12410000, Performance =   2.84 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   203   870  1728
Test passed: M N K =  1626  1431  1024
Test passed: M N K =   525   253  1408
Test passed: M N K =  1674  1600   960
Test passed: M N K =   280  1823   960
M N K =  1024  1024   256, Elapsed time =   0.005258 s, Result = 00050000, Performance =   1.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007230 s, Result = 000a0000, Performance =   1.49 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008694 s, Result = 000f0000, Performance =   1.85 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.010203 s, Result = 00140000, Performance =   2.10 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.012313 s, Result = 00190000, Performance =   2.18 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.013923 s, Result = 001e0000, Performance =   2.31 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.015511 s, Result = 00230000, Performance =   2.42 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.017066 s, Result = 00280000, Performance =   2.52 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.018812 s, Result = 002d0000, Performance =   2.57 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.020317 s, Result = 00320000, Performance =   2.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.021360 s, Result = 00370000, Performance =   2.76 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.022434 s, Result = 003c0000, Performance =   2.87 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.023627 s, Result = 00410000, Performance =   2.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.024055 s, Result = 00460000, Performance =   3.12 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.024467 s, Result = 004b0000, Performance =   3.29 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.025925 s, Result = 00500000, Performance =   3.31 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.026793 s, Result = 00550000, Performance =   3.41 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.028749 s, Result = 005a0000, Performance =   3.36 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.029965 s, Result = 005f0000, Performance =   3.40 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.031281 s, Result = 00640000, Performance =   3.43 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.032844 s, Result = 00690000, Performance =   3.43 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.034281 s, Result = 006e0000, Performance =   3.45 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.035923 s, Result = 00730000, Performance =   3.44 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.037418 s, Result = 00780000, Performance =   3.44 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.039050 s, Result = 007d0000, Performance =   3.44 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.040946 s, Result = 00820000, Performance =   3.41 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.042782 s, Result = 00870000, Performance =   3.39 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.045312 s, Result = 008c0000, Performance =   3.32 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.046879 s, Result = 00910000, Performance =   3.32 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.049421 s, Result = 00960000, Performance =   3.26 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.051892 s, Result = 009b0000, Performance =   3.21 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.053787 s, Result = 00a00000, Performance =   3.19 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.055944 s, Result = 00a50000, Performance =   3.17 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.058672 s, Result = 00aa0000, Performance =   3.11 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.059158 s, Result = 00af0000, Performance =   3.18 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.060624 s, Result = 00b40000, Performance =   3.19 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.061753 s, Result = 00b90000, Performance =   3.22 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.063738 s, Result = 00be0000, Performance =   3.20 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.064810 s, Result = 00c30000, Performance =   3.23 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.066192 s, Result = 00c80000, Performance =   3.24 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.066045 s, Result = 00cd0000, Performance =   3.33 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.070955 s, Result = 00d20000, Performance =   3.18 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.071179 s, Result = 00d70000, Performance =   3.24 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.072442 s, Result = 00dc0000, Performance =   3.26 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.075038 s, Result = 00e10000, Performance =   3.22 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.076398 s, Result = 00e60000, Performance =   3.23 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.078994 s, Result = 00eb0000, Performance =   3.19 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.079450 s, Result = 00f00000, Performance =   3.24 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.080859 s, Result = 00f50000, Performance =   3.25 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.084080 s, Result = 00fa0000, Performance =   3.19 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.085242 s, Result = 00ff0000, Performance =   3.21 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.087011 s, Result = 01040000, Performance =   3.21 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.089261 s, Result = 01090000, Performance =   3.19 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.092257 s, Result = 010e0000, Performance =   3.14 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.093909 s, Result = 01130000, Performance =   3.14 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.096433 s, Result = 01180000, Performance =   3.12 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.099259 s, Result = 011d0000, Performance =   3.08 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.101915 s, Result = 01220000, Performance =   3.06 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.102980 s, Result = 01270000, Performance =   3.08 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.106349 s, Result = 012c0000, Performance =   3.03 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.108928 s, Result = 01310000, Performance =   3.01 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.111244 s, Result = 01360000, Performance =   2.99 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.115210 s, Result = 013b0000, Performance =   2.94 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.117459 s, Result = 01400000, Performance =   2.93 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1688   866  1152
Test passed: M N K =   216  1993  1920
Test passed: M N K =   288   359  1152
Test passed: M N K =   971   291  1472
Test passed: M N K =  1737   662  1920
M N K =  1024  1024   256, Elapsed time =   0.005884 s, Result = 0a0f0000, Performance =   0.91 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007940 s, Result = 0a140000, Performance =   1.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008107 s, Result = 0a190000, Performance =   1.99 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.009198 s, Result = 0a1e0000, Performance =   2.33 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.010828 s, Result = 0a230000, Performance =   2.48 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012351 s, Result = 0a280000, Performance =   2.61 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.013948 s, Result = 0a2d0000, Performance =   2.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.015412 s, Result = 0a320000, Performance =   2.79 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.016864 s, Result = 0a370000, Performance =   2.87 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.018414 s, Result = 0a3c0000, Performance =   2.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.019796 s, Result = 0a410000, Performance =   2.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.021093 s, Result = 0a460000, Performance =   3.05 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022517 s, Result = 0a4b0000, Performance =   3.10 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.023876 s, Result = 0a500000, Performance =   3.15 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.025263 s, Result = 0a550000, Performance =   3.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.026372 s, Result = 0a5a0000, Performance =   3.26 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.028007 s, Result = 0a5f0000, Performance =   3.26 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.029380 s, Result = 0a640000, Performance =   3.29 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.031023 s, Result = 0a690000, Performance =   3.29 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.032622 s, Result = 0a6e0000, Performance =   3.29 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.034027 s, Result = 0a730000, Performance =   3.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.035580 s, Result = 0a780000, Performance =   3.32 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.037094 s, Result = 0a7d0000, Performance =   3.33 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.038532 s, Result = 0a820000, Performance =   3.34 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.040450 s, Result = 0a870000, Performance =   3.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.042604 s, Result = 0a8c0000, Performance =   3.28 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.044565 s, Result = 0a910000, Performance =   3.25 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.046267 s, Result = 0a960000, Performance =   3.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.048418 s, Result = 0a9b0000, Performance =   3.22 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.050379 s, Result = 0aa00000, Performance =   3.20 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.052052 s, Result = 0aa50000, Performance =   3.20 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.055337 s, Result = 0aaa0000, Performance =   3.10 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.055868 s, Result = 0aaf0000, Performance =   3.17 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.058579 s, Result = 0ab40000, Performance =   3.12 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.059013 s, Result = 0ab90000, Performance =   3.18 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.061789 s, Result = 0abe0000, Performance =   3.13 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.061855 s, Result = 0ac30000, Performance =   3.21 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.064985 s, Result = 0ac80000, Performance =   3.14 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.066271 s, Result = 0acd0000, Performance =   3.16 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.067944 s, Result = 0ad20000, Performance =   3.16 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.069722 s, Result = 0ad70000, Performance =   3.16 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.069924 s, Result = 0adc0000, Performance =   3.22 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.072565 s, Result = 0ae10000, Performance =   3.18 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.072794 s, Result = 0ae60000, Performance =   3.25 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.076596 s, Result = 0aeb0000, Performance =   3.15 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.075838 s, Result = 0af00000, Performance =   3.26 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.079948 s, Result = 0af50000, Performance =   3.16 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.082296 s, Result = 0afa0000, Performance =   3.13 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.083657 s, Result = 0aff0000, Performance =   3.14 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.084813 s, Result = 0b040000, Performance =   3.17 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.086154 s, Result = 0b090000, Performance =   3.18 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.087924 s, Result = 0b0e0000, Performance =   3.18 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.091020 s, Result = 0b130000, Performance =   3.13 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.093424 s, Result = 0b180000, Performance =   3.10 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.095902 s, Result = 0b1d0000, Performance =   3.08 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.097646 s, Result = 0b220000, Performance =   3.08 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.100272 s, Result = 0b270000, Performance =   3.05 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.103077 s, Result = 0b2c0000, Performance =   3.02 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.105054 s, Result = 0b310000, Performance =   3.02 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.108558 s, Result = 0b360000, Performance =   2.97 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.112049 s, Result = 0b3b0000, Performance =   2.92 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.114812 s, Result = 0b400000, Performance =   2.90 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.116663 s, Result = 0b450000, Performance =   2.90 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.120381 s, Result = 0b4a0000, Performance =   2.85 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   803  1137   320
Test passed: M N K =  1095  1871  1024
Test passed: M N K =  1368   648  2048
Test passed: M N K =  1644   374   512
Test passed: M N K =   315   992  1856
M N K =  1024  1024   256, Elapsed time =   0.001516 s, Result = 00050000, Performance =   3.54 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003097 s, Result = 000a0000, Performance =   3.47 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004657 s, Result = 000f0000, Performance =   3.46 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006177 s, Result = 00140000, Performance =   3.48 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007941 s, Result = 00190000, Performance =   3.38 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009585 s, Result = 001e0000, Performance =   3.36 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011340 s, Result = 00230000, Performance =   3.31 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012843 s, Result = 00280000, Performance =   3.34 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014492 s, Result = 002d0000, Performance =   3.33 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015318 s, Result = 00320000, Performance =   3.50 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015903 s, Result = 00370000, Performance =   3.71 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016670 s, Result = 003c0000, Performance =   3.86 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018090 s, Result = 00410000, Performance =   3.86 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019472 s, Result = 00460000, Performance =   3.86 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020763 s, Result = 004b0000, Performance =   3.88 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021977 s, Result = 00500000, Performance =   3.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023450 s, Result = 00550000, Performance =   3.89 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024793 s, Result = 005a0000, Performance =   3.90 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.026291 s, Result = 005f0000, Performance =   3.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027712 s, Result = 00640000, Performance =   3.87 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.029172 s, Result = 00690000, Performance =   3.86 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.030670 s, Result = 006e0000, Performance =   3.85 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.032059 s, Result = 00730000, Performance =   3.85 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.033465 s, Result = 00780000, Performance =   3.85 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.035739 s, Result = 007d0000, Performance =   3.76 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.037201 s, Result = 00820000, Performance =   3.75 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.039080 s, Result = 00870000, Performance =   3.71 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.040908 s, Result = 008c0000, Performance =   3.67 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.042861 s, Result = 00910000, Performance =   3.63 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.045119 s, Result = 00960000, Performance =   3.57 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.046965 s, Result = 009b0000, Performance =   3.54 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.049079 s, Result = 00a00000, Performance =   3.50 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.051536 s, Result = 00a50000, Performance =   3.44 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.052601 s, Result = 00aa0000, Performance =   3.47 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.055330 s, Result = 00af0000, Performance =   3.40 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.055273 s, Result = 00b40000, Performance =   3.50 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.058123 s, Result = 00b90000, Performance =   3.42 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.058702 s, Result = 00be0000, Performance =   3.48 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.060810 s, Result = 00c30000, Performance =   3.44 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.063690 s, Result = 00c80000, Performance =   3.37 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.065427 s, Result = 00cd0000, Performance =   3.36 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.065685 s, Result = 00d20000, Performance =   3.43 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.067610 s, Result = 00d70000, Performance =   3.41 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.069080 s, Result = 00dc0000, Performance =   3.42 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.070408 s, Result = 00e10000, Performance =   3.43 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.072606 s, Result = 00e60000, Performance =   3.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.074493 s, Result = 00eb0000, Performance =   3.39 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.075816 s, Result = 00f00000, Performance =   3.40 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.077283 s, Result = 00f50000, Performance =   3.40 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.079040 s, Result = 00fa0000, Performance =   3.40 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.082939 s, Result = 00ff0000, Performance =   3.30 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.082473 s, Result = 01040000, Performance =   3.39 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.083536 s, Result = 01090000, Performance =   3.41 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.086593 s, Result = 010e0000, Performance =   3.35 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.087584 s, Result = 01130000, Performance =   3.37 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.090894 s, Result = 01180000, Performance =   3.31 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.092787 s, Result = 011d0000, Performance =   3.30 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.095555 s, Result = 01220000, Performance =   3.26 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.097583 s, Result = 01270000, Performance =   3.25 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.100402 s, Result = 012c0000, Performance =   3.21 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.103484 s, Result = 01310000, Performance =   3.16 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.104934 s, Result = 01360000, Performance =   3.17 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.109319 s, Result = 013b0000, Performance =   3.09 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.111007 s, Result = 01400000, Performance =   3.10 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2047  2008   512
Test passed: M N K =  1319   940   640
Test passed: M N K =   310   287   896
Test passed: M N K =   172   222   128
Test passed: M N K =   561   275  1856
M N K =  1024  1024   256, Elapsed time =   0.005680 s, Result = 8d04c000, Performance =   0.95 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006459 s, Result = f9088000, Performance =   1.66 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007305 s, Result = 650c4000, Performance =   2.20 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008344 s, Result = d1100000, Performance =   2.57 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009537 s, Result = 3d13c000, Performance =   2.81 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010741 s, Result = a9178000, Performance =   3.00 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011941 s, Result = 151b4000, Performance =   3.15 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013192 s, Result = 811f0000, Performance =   3.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014430 s, Result = ed22c000, Performance =   3.35 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015570 s, Result = 59268000, Performance =   3.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016938 s, Result = c52a4000, Performance =   3.49 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.018100 s, Result = 312e0000, Performance =   3.56 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.019256 s, Result = 9d31c000, Performance =   3.62 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.020540 s, Result = 09358000, Performance =   3.66 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.021522 s, Result = 75394000, Performance =   3.74 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022566 s, Result = e13d0000, Performance =   3.81 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023604 s, Result = 4d40c000, Performance =   3.87 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024855 s, Result = b9448000, Performance =   3.89 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.026119 s, Result = 25484000, Performance =   3.91 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027195 s, Result = 914c0000, Performance =   3.95 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.028363 s, Result = fd4fc000, Performance =   3.97 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.029669 s, Result = 69538000, Performance =   3.98 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030983 s, Result = d5574000, Performance =   3.99 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.032104 s, Result = 415b0000, Performance =   4.01 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.033522 s, Result = ad5ec000, Performance =   4.00 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034715 s, Result = 19628000, Performance =   4.02 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.036123 s, Result = 85664000, Performance =   4.01 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.037551 s, Result = f16a0000, Performance =   4.00 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.039222 s, Result = 5d6dc000, Performance =   3.97 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.041107 s, Result = c9718000, Performance =   3.92 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.043558 s, Result = 35754000, Performance =   3.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.045385 s, Result = a1790000, Performance =   3.79 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.045967 s, Result = 0d7cc000, Performance =   3.85 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.047599 s, Result = 79808000, Performance =   3.83 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.049246 s, Result = e5844000, Performance =   3.82 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.050915 s, Result = 51880000, Performance =   3.80 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.052450 s, Result = bd8bc000, Performance =   3.79 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.054677 s, Result = 298f8000, Performance =   3.73 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.057093 s, Result = 95934000, Performance =   3.67 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.058836 s, Result = 01970000, Performance =   3.65 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.060028 s, Result = 6d9ac000, Performance =   3.67 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.061924 s, Result = d99e8000, Performance =   3.64 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.063133 s, Result = 45a24000, Performance =   3.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.066405 s, Result = b1a60000, Performance =   3.56 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.067748 s, Result = 1da9c000, Performance =   3.57 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.069774 s, Result = 89ad8000, Performance =   3.54 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.070894 s, Result = f5b14000, Performance =   3.56 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.073233 s, Result = 61b50000, Performance =   3.52 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.073919 s, Result = cdb8c000, Performance =   3.56 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.075504 s, Result = 39bc8000, Performance =   3.56 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.076579 s, Result = a5c04000, Performance =   3.58 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.079574 s, Result = 11c40000, Performance =   3.51 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.081231 s, Result = 7dc7c000, Performance =   3.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.083430 s, Result = e9cb8000, Performance =   3.47 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.084458 s, Result = 55cf4000, Performance =   3.50 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.088131 s, Result = c1d30000, Performance =   3.41 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.088289 s, Result = 2dd6c000, Performance =   3.47 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.090439 s, Result = 99da8000, Performance =   3.44 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.092628 s, Result = 05de4000, Performance =   3.42 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.094819 s, Result = 71e20000, Performance =   3.40 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.096324 s, Result = dde5c000, Performance =   3.40 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.097785 s, Result = 49e98000, Performance =   3.40 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.099224 s, Result = b5ed4000, Performance =   3.41 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.101762 s, Result = 21f10000, Performance =   3.38 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1528  1170   384
Test passed: M N K =  1872  1576   256
Test passed: M N K =  1519  1919  1920
Test passed: M N K =   952   819   128
Test passed: M N K =  1512  1756  1664
M N K =  1024  1024   256, Elapsed time =   0.004977 s, Result = 0003c000, Performance =   1.08 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006729 s, Result = 00078000, Performance =   1.60 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008042 s, Result = 000b4000, Performance =   2.00 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.009408 s, Result = 000f0000, Performance =   2.28 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.011089 s, Result = 0012c000, Performance =   2.42 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.012363 s, Result = 00168000, Performance =   2.61 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.013845 s, Result = 001a4000, Performance =   2.71 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.015197 s, Result = 001e0000, Performance =   2.83 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.015738 s, Result = 0021c000, Performance =   3.07 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.016721 s, Result = 00258000, Performance =   3.21 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016691 s, Result = 00294000, Performance =   3.54 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016146 s, Result = 002d0000, Performance =   3.99 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016992 s, Result = 0030c000, Performance =   4.11 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018354 s, Result = 00348000, Performance =   4.10 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019491 s, Result = 00384000, Performance =   4.13 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020741 s, Result = 003c0000, Performance =   4.14 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021551 s, Result = 003fc000, Performance =   4.24 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022658 s, Result = 00438000, Performance =   4.26 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023940 s, Result = 00474000, Performance =   4.26 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025147 s, Result = 004b0000, Performance =   4.27 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026519 s, Result = 004ec000, Performance =   4.25 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027627 s, Result = 00528000, Performance =   4.28 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028859 s, Result = 00564000, Performance =   4.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.030167 s, Result = 005a0000, Performance =   4.27 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031568 s, Result = 005dc000, Performance =   4.25 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032966 s, Result = 00618000, Performance =   4.23 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.034196 s, Result = 00654000, Performance =   4.24 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035517 s, Result = 00690000, Performance =   4.23 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037046 s, Result = 006cc000, Performance =   4.20 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038909 s, Result = 00708000, Performance =   4.14 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040822 s, Result = 00744000, Performance =   4.08 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.042205 s, Result = 00780000, Performance =   4.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.043222 s, Result = 007bc000, Performance =   4.10 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.045196 s, Result = 007f8000, Performance =   4.04 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.047163 s, Result = 00834000, Performance =   3.98 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.049023 s, Result = 00870000, Performance =   3.94 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.050764 s, Result = 008ac000, Performance =   3.91 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.055565 s, Result = 008e8000, Performance =   3.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.055562 s, Result = 00924000, Performance =   3.77 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.057412 s, Result = 00960000, Performance =   3.74 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.058882 s, Result = 0099c000, Performance =   3.74 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.059359 s, Result = 009d8000, Performance =   3.80 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.062888 s, Result = 00a14000, Performance =   3.67 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.062232 s, Result = 00a50000, Performance =   3.80 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.064495 s, Result = 00a8c000, Performance =   3.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.065259 s, Result = 00ac8000, Performance =   3.78 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.067272 s, Result = 00b04000, Performance =   3.75 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.070584 s, Result = 00b40000, Performance =   3.65 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.071003 s, Result = 00b7c000, Performance =   3.71 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.071731 s, Result = 00bb8000, Performance =   3.74 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.073246 s, Result = 00bf4000, Performance =   3.74 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.074894 s, Result = 00c30000, Performance =   3.73 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076415 s, Result = 00c6c000, Performance =   3.72 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078534 s, Result = 00ca8000, Performance =   3.69 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.079389 s, Result = 00ce4000, Performance =   3.72 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.082735 s, Result = 00d20000, Performance =   3.63 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.085572 s, Result = 00d5c000, Performance =   3.58 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.087526 s, Result = 00d98000, Performance =   3.56 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.088910 s, Result = 00dd4000, Performance =   3.56 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.091745 s, Result = 00e10000, Performance =   3.51 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.092950 s, Result = 00e4c000, Performance =   3.52 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.096068 s, Result = 00e88000, Performance =   3.46 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.097384 s, Result = 00ec4000, Performance =   3.47 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.099108 s, Result = 00f00000, Performance =   3.47 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1917   961  1408
Test passed: M N K =   443  1763  1984
Test passed: M N K =   312   751   832
Test passed: M N K =  1070  1641    64
Test passed: M N K =   179   718   896
M N K =  1024  1024   256, Elapsed time =   0.005433 s, Result = 0a0dc000, Performance =   0.99 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007714 s, Result = 0a118000, Performance =   1.39 TOPS
M N K =  1024  1024   768, Elapsed time =   0.009029 s, Result = 0a154000, Performance =   1.78 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.010321 s, Result = 0a190000, Performance =   2.08 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.011822 s, Result = 0a1cc000, Performance =   2.27 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.013156 s, Result = 0a208000, Performance =   2.45 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.014783 s, Result = 0a244000, Performance =   2.54 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.016129 s, Result = 0a280000, Performance =   2.66 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.017727 s, Result = 0a2bc000, Performance =   2.73 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.019673 s, Result = 0a2f8000, Performance =   2.73 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.020600 s, Result = 0a334000, Performance =   2.87 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.021237 s, Result = 0a370000, Performance =   3.03 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.022638 s, Result = 0a3ac000, Performance =   3.08 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.023097 s, Result = 0a3e8000, Performance =   3.25 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.022283 s, Result = 0a424000, Performance =   3.61 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022225 s, Result = 0a460000, Performance =   3.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023466 s, Result = 0a49c000, Performance =   3.89 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024856 s, Result = 0a4d8000, Performance =   3.89 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.026184 s, Result = 0a514000, Performance =   3.90 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027250 s, Result = 0a550000, Performance =   3.94 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.028495 s, Result = 0a58c000, Performance =   3.96 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.030257 s, Result = 0a5c8000, Performance =   3.90 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.031202 s, Result = 0a604000, Performance =   3.96 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.032482 s, Result = 0a640000, Performance =   3.97 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.034990 s, Result = 0a67c000, Performance =   3.84 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.037393 s, Result = 0a6b8000, Performance =   3.73 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.039538 s, Result = 0a6f4000, Performance =   3.67 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.041269 s, Result = 0a730000, Performance =   3.64 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.040708 s, Result = 0a76c000, Performance =   3.82 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.043239 s, Result = 0a7a8000, Performance =   3.72 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.046656 s, Result = 0a7e4000, Performance =   3.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.049914 s, Result = 0a820000, Performance =   3.44 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.046933 s, Result = 0a85c000, Performance =   3.77 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.048842 s, Result = 0a898000, Performance =   3.74 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.050060 s, Result = 0a8d4000, Performance =   3.75 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.051841 s, Result = 0a910000, Performance =   3.73 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.054001 s, Result = 0a94c000, Performance =   3.68 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.054164 s, Result = 0a988000, Performance =   3.77 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.056457 s, Result = 0a9c4000, Performance =   3.71 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.058465 s, Result = 0aa00000, Performance =   3.67 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.058990 s, Result = 0aa3c000, Performance =   3.73 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.061244 s, Result = 0aa78000, Performance =   3.68 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.061685 s, Result = 0aab4000, Performance =   3.74 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.064639 s, Result = 0aaf0000, Performance =   3.65 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.065166 s, Result = 0ab2c000, Performance =   3.71 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.065475 s, Result = 0ab68000, Performance =   3.77 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.067573 s, Result = 0aba4000, Performance =   3.73 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.068738 s, Result = 0abe0000, Performance =   3.75 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.070465 s, Result = 0ac1c000, Performance =   3.73 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.072308 s, Result = 0ac58000, Performance =   3.71 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.073724 s, Result = 0ac94000, Performance =   3.71 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.074720 s, Result = 0acd0000, Performance =   3.74 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076625 s, Result = 0ad0c000, Performance =   3.71 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078398 s, Result = 0ad48000, Performance =   3.70 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.080458 s, Result = 0ad84000, Performance =   3.67 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.083288 s, Result = 0adc0000, Performance =   3.61 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.084482 s, Result = 0adfc000, Performance =   3.62 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.085935 s, Result = 0ae38000, Performance =   3.62 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.089461 s, Result = 0ae74000, Performance =   3.54 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.089569 s, Result = 0aeb0000, Performance =   3.60 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.092290 s, Result = 0aeec000, Performance =   3.55 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.094223 s, Result = 0af28000, Performance =   3.53 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.096224 s, Result = 0af64000, Performance =   3.52 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.097113 s, Result = 0afa0000, Performance =   3.54 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1402  1210  1024
Test passed: M N K =  1259  1603   320
Test passed: M N K =  1159   581  1792
Test passed: M N K =  1580  1755  1408
Test passed: M N K =   706  1154   576
M N K =  1024  1024   256, Elapsed time =   0.001256 s, Result = 0003c000, Performance =   4.27 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002625 s, Result = 00078000, Performance =   4.09 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003953 s, Result = 000b4000, Performance =   4.07 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005303 s, Result = 000f0000, Performance =   4.05 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006537 s, Result = 0012c000, Performance =   4.11 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007811 s, Result = 00168000, Performance =   4.12 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009071 s, Result = 001a4000, Performance =   4.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010113 s, Result = 001e0000, Performance =   4.25 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011388 s, Result = 0021c000, Performance =   4.24 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012196 s, Result = 00258000, Performance =   4.40 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013282 s, Result = 00294000, Performance =   4.45 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013895 s, Result = 002d0000, Performance =   4.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014619 s, Result = 0030c000, Performance =   4.77 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015698 s, Result = 00348000, Performance =   4.79 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017111 s, Result = 00384000, Performance =   4.71 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018204 s, Result = 003c0000, Performance =   4.72 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019276 s, Result = 003fc000, Performance =   4.73 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020284 s, Result = 00438000, Performance =   4.76 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021138 s, Result = 00474000, Performance =   4.83 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022201 s, Result = 004b0000, Performance =   4.84 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023468 s, Result = 004ec000, Performance =   4.80 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024674 s, Result = 00528000, Performance =   4.79 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025925 s, Result = 00564000, Performance =   4.76 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027126 s, Result = 005a0000, Performance =   4.75 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028344 s, Result = 005dc000, Performance =   4.74 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029588 s, Result = 00618000, Performance =   4.72 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030838 s, Result = 00654000, Performance =   4.70 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.032296 s, Result = 00690000, Performance =   4.65 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033411 s, Result = 006cc000, Performance =   4.66 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034979 s, Result = 00708000, Performance =   4.60 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036454 s, Result = 00744000, Performance =   4.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037820 s, Result = 00780000, Performance =   4.54 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039253 s, Result = 007bc000, Performance =   4.51 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040630 s, Result = 007f8000, Performance =   4.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.042320 s, Result = 00834000, Performance =   4.44 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.047044 s, Result = 00870000, Performance =   4.11 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.049429 s, Result = 008ac000, Performance =   4.02 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.050684 s, Result = 008e8000, Performance =   4.03 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.053110 s, Result = 00924000, Performance =   3.94 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.052150 s, Result = 00960000, Performance =   4.12 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.053938 s, Result = 0099c000, Performance =   4.08 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.055147 s, Result = 009d8000, Performance =   4.09 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.058255 s, Result = 00a14000, Performance =   3.96 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.059246 s, Result = 00a50000, Performance =   3.99 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.059886 s, Result = 00a8c000, Performance =   4.03 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.062626 s, Result = 00ac8000, Performance =   3.94 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.061735 s, Result = 00b04000, Performance =   4.09 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.063944 s, Result = 00b40000, Performance =   4.03 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.063781 s, Result = 00b7c000, Performance =   4.12 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.065712 s, Result = 00bb8000, Performance =   4.09 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.067368 s, Result = 00bf4000, Performance =   4.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.070901 s, Result = 00c30000, Performance =   3.94 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.071579 s, Result = 00c6c000, Performance =   3.98 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.073308 s, Result = 00ca8000, Performance =   3.95 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.074946 s, Result = 00ce4000, Performance =   3.94 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.076535 s, Result = 00d20000, Performance =   3.93 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.076832 s, Result = 00d5c000, Performance =   3.98 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.079039 s, Result = 00d98000, Performance =   3.94 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.081431 s, Result = 00dd4000, Performance =   3.89 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.083274 s, Result = 00e10000, Performance =   3.87 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.085075 s, Result = 00e4c000, Performance =   3.85 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.089348 s, Result = 00e88000, Performance =   3.73 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.089859 s, Result = 00ec4000, Performance =   3.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.093440 s, Result = 00f00000, Performance =   3.68 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   307   479   640
Test passed: M N K =  1209  1153   256
Test passed: M N K =  1478   998  2048
Test passed: M N K =   253   808   896
Test passed: M N K =   553   645   128
M N K =  1024  1024   256, Elapsed time =   0.005779 s, Result = 8d04c000, Performance =   0.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006444 s, Result = f9088000, Performance =   1.67 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007289 s, Result = 650c4000, Performance =   2.21 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008325 s, Result = d1100000, Performance =   2.58 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009494 s, Result = 3d13c000, Performance =   2.83 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010716 s, Result = a9178000, Performance =   3.01 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011961 s, Result = 151b4000, Performance =   3.14 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012928 s, Result = 811f0000, Performance =   3.32 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014315 s, Result = ed22c000, Performance =   3.38 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015396 s, Result = 59268000, Performance =   3.49 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016568 s, Result = c52a4000, Performance =   3.56 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017628 s, Result = 312e0000, Performance =   3.65 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018825 s, Result = 9d31c000, Performance =   3.71 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019878 s, Result = 09358000, Performance =   3.78 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.021075 s, Result = 75394000, Performance =   3.82 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022058 s, Result = e13d0000, Performance =   3.89 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.022984 s, Result = 4d40c000, Performance =   3.97 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024217 s, Result = b9448000, Performance =   3.99 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.025469 s, Result = 25484000, Performance =   4.01 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.026532 s, Result = 914c0000, Performance =   4.05 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.027863 s, Result = fd4fc000, Performance =   4.05 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.029156 s, Result = 69538000, Performance =   4.05 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030417 s, Result = d5574000, Performance =   4.06 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031772 s, Result = 415b0000, Performance =   4.06 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.033062 s, Result = ad5ec000, Performance =   4.06 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034451 s, Result = 19628000, Performance =   4.05 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.036076 s, Result = 85664000, Performance =   4.02 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.037873 s, Result = f16a0000, Performance =   3.97 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.039999 s, Result = 5d6dc000, Performance =   3.89 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.041821 s, Result = c9718000, Performance =   3.85 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.043636 s, Result = 35754000, Performance =   3.81 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.047366 s, Result = a1790000, Performance =   3.63 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.046506 s, Result = 0d7cc000, Performance =   3.81 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.047446 s, Result = 79808000, Performance =   3.85 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.049330 s, Result = e5844000, Performance =   3.81 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.052236 s, Result = 51880000, Performance =   3.70 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.053865 s, Result = bd8bc000, Performance =   3.69 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.054956 s, Result = 298f8000, Performance =   3.71 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.055753 s, Result = 95934000, Performance =   3.76 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.056251 s, Result = 01970000, Performance =   3.82 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.058006 s, Result = 6d9ac000, Performance =   3.79 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.057906 s, Result = d99e8000, Performance =   3.89 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.058898 s, Result = 45a24000, Performance =   3.92 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.061118 s, Result = b1a60000, Performance =   3.87 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.068899 s, Result = 1da9c000, Performance =   3.51 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.063397 s, Result = 89ad8000, Performance =   3.90 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.065384 s, Result = f5b14000, Performance =   3.86 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.067535 s, Result = 61b50000, Performance =   3.82 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.069244 s, Result = cdb8c000, Performance =   3.80 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.069834 s, Result = 39bc8000, Performance =   3.84 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.071633 s, Result = a5c04000, Performance =   3.82 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.073190 s, Result = 11c40000, Performance =   3.81 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.074309 s, Result = 7dc7c000, Performance =   3.83 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.076393 s, Result = e9cb8000, Performance =   3.79 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.078413 s, Result = 55cf4000, Performance =   3.77 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.080204 s, Result = c1d30000, Performance =   3.75 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.082240 s, Result = 2dd6c000, Performance =   3.72 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.083912 s, Result = 99da8000, Performance =   3.71 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.086359 s, Result = 05de4000, Performance =   3.67 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.088280 s, Result = 71e20000, Performance =   3.65 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.091034 s, Result = dde5c000, Performance =   3.60 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.092444 s, Result = 49e98000, Performance =   3.60 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.093641 s, Result = b5ed4000, Performance =   3.61 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.096271 s, Result = 21f10000, Performance =   3.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1712  2000  1600
Test passed: M N K =  1560  1803  1088
Test passed: M N K =  1442  1357  1984
Test passed: M N K =    76   668    64
Test passed: M N K =   104   845   960
M N K =  1024  1024   256, Elapsed time =   0.003782 s, Result = 0003c000, Performance =   1.42 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003686 s, Result = 00078000, Performance =   2.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004757 s, Result = 000b4000, Performance =   3.39 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005821 s, Result = 000f0000, Performance =   3.69 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006893 s, Result = 0012c000, Performance =   3.89 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007984 s, Result = 00168000, Performance =   4.03 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009184 s, Result = 001a4000, Performance =   4.09 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010331 s, Result = 001e0000, Performance =   4.16 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011651 s, Result = 0021c000, Performance =   4.15 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012848 s, Result = 00258000, Performance =   4.18 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014120 s, Result = 00294000, Performance =   4.18 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015320 s, Result = 002d0000, Performance =   4.21 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016578 s, Result = 0030c000, Performance =   4.21 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017705 s, Result = 00348000, Performance =   4.25 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018967 s, Result = 00384000, Performance =   4.25 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019991 s, Result = 003c0000, Performance =   4.30 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021453 s, Result = 003fc000, Performance =   4.25 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022062 s, Result = 00438000, Performance =   4.38 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023183 s, Result = 00474000, Performance =   4.40 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024454 s, Result = 004b0000, Performance =   4.39 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.025815 s, Result = 004ec000, Performance =   4.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027034 s, Result = 00528000, Performance =   4.37 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028685 s, Result = 00564000, Performance =   4.30 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029617 s, Result = 005a0000, Performance =   4.35 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030832 s, Result = 005dc000, Performance =   4.35 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032045 s, Result = 00618000, Performance =   4.36 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033263 s, Result = 00654000, Performance =   4.36 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034632 s, Result = 00690000, Performance =   4.34 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.036286 s, Result = 006cc000, Performance =   4.29 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.037406 s, Result = 00708000, Performance =   4.31 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.038726 s, Result = 00744000, Performance =   4.30 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.040919 s, Result = 00780000, Performance =   4.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.041578 s, Result = 007bc000, Performance =   4.26 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.042406 s, Result = 007f8000, Performance =   4.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.044655 s, Result = 00834000, Performance =   4.21 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.046143 s, Result = 00870000, Performance =   4.19 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.047859 s, Result = 008ac000, Performance =   4.15 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.050293 s, Result = 008e8000, Performance =   4.06 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.051784 s, Result = 00924000, Performance =   4.04 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.053876 s, Result = 00960000, Performance =   3.99 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.055288 s, Result = 0099c000, Performance =   3.98 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.058103 s, Result = 009d8000, Performance =   3.88 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.060256 s, Result = 00a14000, Performance =   3.83 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.061799 s, Result = 00a50000, Performance =   3.82 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.062802 s, Result = 00a8c000, Performance =   3.85 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.063741 s, Result = 00ac8000, Performance =   3.87 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.063222 s, Result = 00b04000, Performance =   3.99 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.064507 s, Result = 00b40000, Performance =   3.99 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.066121 s, Result = 00b7c000, Performance =   3.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.067825 s, Result = 00bb8000, Performance =   3.96 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.068876 s, Result = 00bf4000, Performance =   3.98 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.071114 s, Result = 00c30000, Performance =   3.93 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.072561 s, Result = 00c6c000, Performance =   3.92 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.074327 s, Result = 00ca8000, Performance =   3.90 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.075470 s, Result = 00ce4000, Performance =   3.91 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.077499 s, Result = 00d20000, Performance =   3.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.078735 s, Result = 00d5c000, Performance =   3.89 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.080586 s, Result = 00d98000, Performance =   3.86 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.082065 s, Result = 00dd4000, Performance =   3.86 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.085397 s, Result = 00e10000, Performance =   3.77 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.087491 s, Result = 00e4c000, Performance =   3.74 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.088730 s, Result = 00e88000, Performance =   3.75 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.091126 s, Result = 00ec4000, Performance =   3.71 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.092419 s, Result = 00f00000, Performance =   3.72 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   933  1648   832
Test passed: M N K =   998   649   640
Test passed: M N K =    26  1140   512
Test passed: M N K =    42   704  1536
Test passed: M N K =   367    26  1600
M N K =  1024  1024   256, Elapsed time =   0.005372 s, Result = 0a0dc000, Performance =   1.00 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007178 s, Result = 0a118000, Performance =   1.50 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007772 s, Result = 0a154000, Performance =   2.07 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008153 s, Result = 0a190000, Performance =   2.63 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009173 s, Result = 0a1cc000, Performance =   2.93 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010248 s, Result = 0a208000, Performance =   3.14 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011435 s, Result = 0a244000, Performance =   3.29 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012538 s, Result = 0a280000, Performance =   3.43 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013877 s, Result = 0a2bc000, Performance =   3.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014919 s, Result = 0a2f8000, Performance =   3.60 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016132 s, Result = 0a334000, Performance =   3.66 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017267 s, Result = 0a370000, Performance =   3.73 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018435 s, Result = 0a3ac000, Performance =   3.79 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019673 s, Result = 0a3e8000, Performance =   3.82 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020953 s, Result = 0a424000, Performance =   3.84 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021956 s, Result = 0a460000, Performance =   3.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.024007 s, Result = 0a49c000, Performance =   3.80 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.026558 s, Result = 0a4d8000, Performance =   3.64 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.027642 s, Result = 0a514000, Performance =   3.69 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.028085 s, Result = 0a550000, Performance =   3.82 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.029800 s, Result = 0a58c000, Performance =   3.78 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.030176 s, Result = 0a5c8000, Performance =   3.91 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030927 s, Result = 0a604000, Performance =   3.99 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.033774 s, Result = 0a640000, Performance =   3.81 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.035190 s, Result = 0a67c000, Performance =   3.81 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.038961 s, Result = 0a6b8000, Performance =   3.58 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.038003 s, Result = 0a6f4000, Performance =   3.81 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.043191 s, Result = 0a730000, Performance =   3.48 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.042861 s, Result = 0a76c000, Performance =   3.63 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.046520 s, Result = 0a7a8000, Performance =   3.46 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.046131 s, Result = 0a7e4000, Performance =   3.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.048369 s, Result = 0a820000, Performance =   3.55 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.046837 s, Result = 0a85c000, Performance =   3.78 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.046370 s, Result = 0a898000, Performance =   3.94 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.052683 s, Result = 0a8d4000, Performance =   3.57 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.051117 s, Result = 0a910000, Performance =   3.78 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.052095 s, Result = 0a94c000, Performance =   3.81 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.060665 s, Result = 0a988000, Performance =   3.36 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.086894 s, Result = 0a9c4000, Performance =   2.41 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.068050 s, Result = 0aa00000, Performance =   3.16 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.062684 s, Result = 0aa3c000, Performance =   3.51 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.056950 s, Result = 0aa78000, Performance =   3.96 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.064540 s, Result = 0aab4000, Performance =   3.58 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.091347 s, Result = 0aaf0000, Performance =   2.59 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.076148 s, Result = 0ab2c000, Performance =   3.17 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.067213 s, Result = 0ab68000, Performance =   3.67 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.067666 s, Result = 0aba4000, Performance =   3.73 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.074407 s, Result = 0abe0000, Performance =   3.46 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.091258 s, Result = 0ac1c000, Performance =   2.88 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.081059 s, Result = 0ac58000, Performance =   3.31 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.074306 s, Result = 0ac94000, Performance =   3.68 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.071375 s, Result = 0acd0000, Performance =   3.91 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.073267 s, Result = 0ad0c000, Performance =   3.88 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.104577 s, Result = 0ad48000, Performance =   2.77 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.099232 s, Result = 0ad84000, Performance =   2.98 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.091688 s, Result = 0adc0000, Performance =   3.28 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.085742 s, Result = 0adfc000, Performance =   3.57 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.082929 s, Result = 0ae38000, Performance =   3.75 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.083604 s, Result = 0ae74000, Performance =   3.79 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.085963 s, Result = 0aeb0000, Performance =   3.75 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.087194 s, Result = 0aeec000, Performance =   3.76 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.089819 s, Result = 0af28000, Performance =   3.71 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.089755 s, Result = 0af64000, Performance =   3.77 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.092738 s, Result = 0afa0000, Performance =   3.71 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   630   126   448
Test passed: M N K =  1299   247   640
Test passed: M N K =  1035  1502  1664
Test passed: M N K =  1338   164   256
Test passed: M N K =   807  1632  1344
M N K =  1024  1024   256, Elapsed time =   0.001106 s, Result = 0003c000, Performance =   4.85 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002317 s, Result = 00078000, Performance =   4.63 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003770 s, Result = 000b4000, Performance =   4.27 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005053 s, Result = 000f0000, Performance =   4.25 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006294 s, Result = 0012c000, Performance =   4.27 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007352 s, Result = 00168000, Performance =   4.38 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008544 s, Result = 001a4000, Performance =   4.40 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009298 s, Result = 001e0000, Performance =   4.62 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010009 s, Result = 0021c000, Performance =   4.83 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010609 s, Result = 00258000, Performance =   5.06 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011521 s, Result = 00294000, Performance =   5.13 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012611 s, Result = 002d0000, Performance =   5.11 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013768 s, Result = 0030c000, Performance =   5.07 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014950 s, Result = 00348000, Performance =   5.03 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016003 s, Result = 00384000, Performance =   5.03 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017038 s, Result = 003c0000, Performance =   5.04 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018442 s, Result = 003fc000, Performance =   4.95 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019730 s, Result = 00438000, Performance =   4.90 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020919 s, Result = 00474000, Performance =   4.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022371 s, Result = 004b0000, Performance =   4.80 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022956 s, Result = 004ec000, Performance =   4.91 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024444 s, Result = 00528000, Performance =   4.83 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025449 s, Result = 00564000, Performance =   4.85 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026769 s, Result = 005a0000, Performance =   4.81 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027514 s, Result = 005dc000, Performance =   4.88 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028781 s, Result = 00618000, Performance =   4.85 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030293 s, Result = 00654000, Performance =   4.79 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031554 s, Result = 00690000, Performance =   4.76 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033076 s, Result = 006cc000, Performance =   4.71 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034623 s, Result = 00708000, Performance =   4.65 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036002 s, Result = 00744000, Performance =   4.62 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037642 s, Result = 00780000, Performance =   4.56 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038195 s, Result = 007bc000, Performance =   4.64 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.038775 s, Result = 007f8000, Performance =   4.71 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040133 s, Result = 00834000, Performance =   4.68 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041552 s, Result = 00870000, Performance =   4.65 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043043 s, Result = 008ac000, Performance =   4.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044658 s, Result = 008e8000, Performance =   4.57 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.046365 s, Result = 00924000, Performance =   4.52 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.047825 s, Result = 00960000, Performance =   4.49 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.049009 s, Result = 0099c000, Performance =   4.49 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.051216 s, Result = 009d8000, Performance =   4.40 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.052089 s, Result = 00a14000, Performance =   4.43 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.054349 s, Result = 00a50000, Performance =   4.35 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.055120 s, Result = 00a8c000, Performance =   4.38 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.056935 s, Result = 00ac8000, Performance =   4.34 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.058276 s, Result = 00b04000, Performance =   4.33 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.060853 s, Result = 00b40000, Performance =   4.23 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.061766 s, Result = 00b7c000, Performance =   4.26 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.063649 s, Result = 00bb8000, Performance =   4.22 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.064657 s, Result = 00bf4000, Performance =   4.23 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.067692 s, Result = 00c30000, Performance =   4.12 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.067735 s, Result = 00c6c000, Performance =   4.20 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.070570 s, Result = 00ca8000, Performance =   4.11 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.070250 s, Result = 00ce4000, Performance =   4.20 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.073993 s, Result = 00d20000, Performance =   4.06 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.073612 s, Result = 00d5c000, Performance =   4.16 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.076251 s, Result = 00d98000, Performance =   4.08 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.078723 s, Result = 00dd4000, Performance =   4.02 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.079081 s, Result = 00e10000, Performance =   4.07 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.080835 s, Result = 00e4c000, Performance =   4.05 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.083059 s, Result = 00e88000, Performance =   4.01 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.084698 s, Result = 00ec4000, Performance =   3.99 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.085698 s, Result = 00f00000, Performance =   4.01 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1289   855  1024
Test passed: M N K =   266   873  1280
Test passed: M N K =   811   807   448
Test passed: M N K =   763   789  1920
Test passed: M N K =  2003  1804  1536
M N K =  1024  1024   256, Elapsed time =   0.005745 s, Result = 8d04c000, Performance =   0.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006270 s, Result = f9088000, Performance =   1.71 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007206 s, Result = 650c4000, Performance =   2.24 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008253 s, Result = d1100000, Performance =   2.60 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009383 s, Result = 3d13c000, Performance =   2.86 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010451 s, Result = a9178000, Performance =   3.08 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011494 s, Result = 151b4000, Performance =   3.27 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012533 s, Result = 811f0000, Performance =   3.43 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013705 s, Result = ed22c000, Performance =   3.53 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014773 s, Result = 59268000, Performance =   3.63 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015896 s, Result = c52a4000, Performance =   3.72 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016888 s, Result = 312e0000, Performance =   3.81 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017970 s, Result = 9d31c000, Performance =   3.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018997 s, Result = 09358000, Performance =   3.96 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020082 s, Result = 75394000, Performance =   4.01 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021003 s, Result = e13d0000, Performance =   4.09 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.022171 s, Result = 4d40c000, Performance =   4.12 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023205 s, Result = b9448000, Performance =   4.16 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.024266 s, Result = 25484000, Performance =   4.20 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025479 s, Result = 914c0000, Performance =   4.21 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026749 s, Result = fd4fc000, Performance =   4.21 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.028108 s, Result = 69538000, Performance =   4.20 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029287 s, Result = d5574000, Performance =   4.22 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.030573 s, Result = 415b0000, Performance =   4.21 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031886 s, Result = ad5ec000, Performance =   4.21 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.033158 s, Result = 19628000, Performance =   4.21 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.034530 s, Result = 85664000, Performance =   4.20 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035660 s, Result = f16a0000, Performance =   4.22 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037213 s, Result = 5d6dc000, Performance =   4.18 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038702 s, Result = c9718000, Performance =   4.16 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040065 s, Result = 35754000, Performance =   4.15 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.041445 s, Result = a1790000, Performance =   4.15 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.042872 s, Result = 0d7cc000, Performance =   4.13 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.044509 s, Result = 79808000, Performance =   4.10 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.045759 s, Result = e5844000, Performance =   4.11 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.046692 s, Result = 51880000, Performance =   4.14 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.048533 s, Result = bd8bc000, Performance =   4.09 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.050030 s, Result = 298f8000, Performance =   4.08 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.051305 s, Result = 95934000, Performance =   4.08 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.052227 s, Result = 01970000, Performance =   4.11 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.053995 s, Result = 6d9ac000, Performance =   4.08 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.055457 s, Result = d99e8000, Performance =   4.07 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.057137 s, Result = 45a24000, Performance =   4.04 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.058459 s, Result = b1a60000, Performance =   4.04 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.060290 s, Result = 1da9c000, Performance =   4.01 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.062041 s, Result = 89ad8000, Performance =   3.98 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.063668 s, Result = f5b14000, Performance =   3.96 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.068632 s, Result = 61b50000, Performance =   3.75 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.068563 s, Result = cdb8c000, Performance =   3.84 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.071470 s, Result = 39bc8000, Performance =   3.76 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.071927 s, Result = a5c04000, Performance =   3.81 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.075656 s, Result = 11c40000, Performance =   3.69 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076501 s, Result = 7dc7c000, Performance =   3.72 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078808 s, Result = e9cb8000, Performance =   3.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.081225 s, Result = 55cf4000, Performance =   3.64 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.082075 s, Result = c1d30000, Performance =   3.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.084370 s, Result = 2dd6c000, Performance =   3.63 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.085328 s, Result = 99da8000, Performance =   3.65 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.087303 s, Result = 05de4000, Performance =   3.63 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.091145 s, Result = 71e20000, Performance =   3.53 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.089563 s, Result = dde5c000, Performance =   3.66 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.092167 s, Result = 49e98000, Performance =   3.61 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.093561 s, Result = b5ed4000, Performance =   3.62 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.095584 s, Result = 21f10000, Performance =   3.59 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   302  1355  1856
Test passed: M N K =  1668   853  1984
Test passed: M N K =  1175  1790  1728
Test passed: M N K =   102  1908   576
Test passed: M N K =  1832   791  1536
M N K =  1024  1024   256, Elapsed time =   0.003615 s, Result = 0003c000, Performance =   1.49 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003707 s, Result = 00078000, Performance =   2.90 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004717 s, Result = 000b4000, Performance =   3.41 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005764 s, Result = 000f0000, Performance =   3.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006926 s, Result = 0012c000, Performance =   3.88 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008005 s, Result = 00168000, Performance =   4.02 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009163 s, Result = 001a4000, Performance =   4.10 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010215 s, Result = 001e0000, Performance =   4.20 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011375 s, Result = 0021c000, Performance =   4.25 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012515 s, Result = 00258000, Performance =   4.29 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013676 s, Result = 00294000, Performance =   4.32 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014847 s, Result = 002d0000, Performance =   4.34 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015992 s, Result = 0030c000, Performance =   4.36 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017050 s, Result = 00348000, Performance =   4.41 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018144 s, Result = 00384000, Performance =   4.44 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019172 s, Result = 003c0000, Performance =   4.48 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020244 s, Result = 003fc000, Performance =   4.51 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021323 s, Result = 00438000, Performance =   4.53 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022376 s, Result = 00474000, Performance =   4.56 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023529 s, Result = 004b0000, Performance =   4.56 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024704 s, Result = 004ec000, Performance =   4.56 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025870 s, Result = 00528000, Performance =   4.57 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027082 s, Result = 00564000, Performance =   4.56 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.028311 s, Result = 005a0000, Performance =   4.55 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030366 s, Result = 005dc000, Performance =   4.42 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.031234 s, Result = 00618000, Performance =   4.47 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.032779 s, Result = 00654000, Performance =   4.42 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033780 s, Result = 00690000, Performance =   4.45 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035288 s, Result = 006cc000, Performance =   4.41 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036646 s, Result = 00708000, Performance =   4.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.037901 s, Result = 00744000, Performance =   4.39 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039229 s, Result = 00780000, Performance =   4.38 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.040642 s, Result = 007bc000, Performance =   4.36 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.042347 s, Result = 007f8000, Performance =   4.31 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.043054 s, Result = 00834000, Performance =   4.36 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.044343 s, Result = 00870000, Performance =   4.36 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.046080 s, Result = 008ac000, Performance =   4.31 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.047425 s, Result = 008e8000, Performance =   4.30 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.048744 s, Result = 00924000, Performance =   4.30 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.050405 s, Result = 00960000, Performance =   4.26 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.052153 s, Result = 0099c000, Performance =   4.22 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.053505 s, Result = 009d8000, Performance =   4.21 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.055135 s, Result = 00a14000, Performance =   4.19 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.056224 s, Result = 00a50000, Performance =   4.20 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.058048 s, Result = 00a8c000, Performance =   4.16 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.059834 s, Result = 00ac8000, Performance =   4.13 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.061235 s, Result = 00b04000, Performance =   4.12 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.064415 s, Result = 00b40000, Performance =   4.00 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.064666 s, Result = 00b7c000, Performance =   4.07 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.067008 s, Result = 00bb8000, Performance =   4.01 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.067896 s, Result = 00bf4000, Performance =   4.03 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.070494 s, Result = 00c30000, Performance =   3.96 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.071892 s, Result = 00c6c000, Performance =   3.96 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.073808 s, Result = 00ca8000, Performance =   3.93 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.074622 s, Result = 00ce4000, Performance =   3.96 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.077021 s, Result = 00d20000, Performance =   3.90 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.079061 s, Result = 00d5c000, Performance =   3.87 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.080944 s, Result = 00d98000, Performance =   3.85 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.083771 s, Result = 00dd4000, Performance =   3.78 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.083784 s, Result = 00e10000, Performance =   3.84 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.085538 s, Result = 00e4c000, Performance =   3.83 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.086056 s, Result = 00e88000, Performance =   3.87 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.088242 s, Result = 00ec4000, Performance =   3.83 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.089481 s, Result = 00f00000, Performance =   3.84 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2006  1202   512
Test passed: M N K =  1981   552   704
Test passed: M N K =  1512   704  1344
Test passed: M N K =   351  1664   960
Test passed: M N K =   324   723  1920
M N K =  1024  1024   256, Elapsed time =   0.005268 s, Result = 0a0dc000, Performance =   1.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006929 s, Result = 0a118000, Performance =   1.55 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007408 s, Result = 0a154000, Performance =   2.17 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008017 s, Result = 0a190000, Performance =   2.68 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008875 s, Result = 0a1cc000, Performance =   3.02 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009968 s, Result = 0a208000, Performance =   3.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011030 s, Result = 0a244000, Performance =   3.41 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012143 s, Result = 0a280000, Performance =   3.54 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013285 s, Result = 0a2bc000, Performance =   3.64 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014378 s, Result = 0a2f8000, Performance =   3.73 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015516 s, Result = 0a334000, Performance =   3.81 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016510 s, Result = 0a370000, Performance =   3.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017600 s, Result = 0a3ac000, Performance =   3.97 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018624 s, Result = 0a3e8000, Performance =   4.04 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019679 s, Result = 0a424000, Performance =   4.09 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020655 s, Result = 0a460000, Performance =   4.16 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021780 s, Result = 0a49c000, Performance =   4.19 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022743 s, Result = 0a4d8000, Performance =   4.25 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023899 s, Result = 0a514000, Performance =   4.27 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024853 s, Result = 0a550000, Performance =   4.32 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026099 s, Result = 0a58c000, Performance =   4.32 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027206 s, Result = 0a5c8000, Performance =   4.34 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028384 s, Result = 0a604000, Performance =   4.35 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029556 s, Result = 0a640000, Performance =   4.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030908 s, Result = 0a67c000, Performance =   4.34 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032039 s, Result = 0a6b8000, Performance =   4.36 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033183 s, Result = 0a6f4000, Performance =   4.37 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034348 s, Result = 0a730000, Performance =   4.38 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035628 s, Result = 0a76c000, Performance =   4.37 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038586 s, Result = 0a7a8000, Performance =   4.17 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.039609 s, Result = 0a7e4000, Performance =   4.20 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.040760 s, Result = 0a820000, Performance =   4.21 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.042039 s, Result = 0a85c000, Performance =   4.21 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.043497 s, Result = 0a898000, Performance =   4.20 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.044317 s, Result = 0a8d4000, Performance =   4.24 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.045198 s, Result = 0a910000, Performance =   4.28 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.046942 s, Result = 0a94c000, Performance =   4.23 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.048325 s, Result = 0a988000, Performance =   4.22 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.049728 s, Result = 0a9c4000, Performance =   4.21 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.051484 s, Result = 0aa00000, Performance =   4.17 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.053015 s, Result = 0aa3c000, Performance =   4.15 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.054917 s, Result = 0aa78000, Performance =   4.11 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.056889 s, Result = 0aab4000, Performance =   4.06 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.057569 s, Result = 0aaf0000, Performance =   4.10 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.059568 s, Result = 0ab2c000, Performance =   4.06 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.060579 s, Result = 0ab68000, Performance =   4.08 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.062752 s, Result = 0aba4000, Performance =   4.02 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.063850 s, Result = 0abe0000, Performance =   4.04 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.065823 s, Result = 0ac1c000, Performance =   4.00 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.067347 s, Result = 0ac58000, Performance =   3.99 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.068680 s, Result = 0ac94000, Performance =   3.99 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.070283 s, Result = 0acd0000, Performance =   3.97 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.072098 s, Result = 0ad0c000, Performance =   3.95 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.074857 s, Result = 0ad48000, Performance =   3.87 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.075279 s, Result = 0ad84000, Performance =   3.92 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.077834 s, Result = 0adc0000, Performance =   3.86 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.078356 s, Result = 0adfc000, Performance =   3.91 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.081617 s, Result = 0ae38000, Performance =   3.82 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.081219 s, Result = 0ae74000, Performance =   3.90 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.085971 s, Result = 0aeb0000, Performance =   3.75 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.085329 s, Result = 0aeec000, Performance =   3.84 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.089392 s, Result = 0af28000, Performance =   3.72 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.088609 s, Result = 0af64000, Performance =   3.82 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.090089 s, Result = 0afa0000, Performance =   3.81 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1891   967   512
Test passed: M N K =   861   361  1408
Test passed: M N K =  1327   261  1536
Test passed: M N K =  1833   561   704
Test passed: M N K =   836  1599  1472
M N K =  1024  1024   256, Elapsed time =   0.001193 s, Result = 0003c000, Performance =   4.50 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002330 s, Result = 00078000, Performance =   4.61 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003492 s, Result = 000b4000, Performance =   4.61 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004730 s, Result = 000f0000, Performance =   4.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006064 s, Result = 0012c000, Performance =   4.43 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007135 s, Result = 00168000, Performance =   4.51 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008018 s, Result = 001a4000, Performance =   4.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008516 s, Result = 001e0000, Performance =   5.04 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009285 s, Result = 0021c000, Performance =   5.20 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010292 s, Result = 00258000, Performance =   5.22 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011352 s, Result = 00294000, Performance =   5.20 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012375 s, Result = 002d0000, Performance =   5.21 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013510 s, Result = 0030c000, Performance =   5.17 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014614 s, Result = 00348000, Performance =   5.14 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015723 s, Result = 00384000, Performance =   5.12 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016713 s, Result = 003c0000, Performance =   5.14 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017838 s, Result = 003fc000, Performance =   5.12 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018897 s, Result = 00438000, Performance =   5.11 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019918 s, Result = 00474000, Performance =   5.12 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020870 s, Result = 004b0000, Performance =   5.14 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022639 s, Result = 004ec000, Performance =   4.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023501 s, Result = 00528000, Performance =   5.03 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024937 s, Result = 00564000, Performance =   4.95 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025913 s, Result = 005a0000, Performance =   4.97 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027225 s, Result = 005dc000, Performance =   4.93 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028539 s, Result = 00618000, Performance =   4.89 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029715 s, Result = 00654000, Performance =   4.88 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.030939 s, Result = 00690000, Performance =   4.86 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.031690 s, Result = 006cc000, Performance =   4.91 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.033018 s, Result = 00708000, Performance =   4.88 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.034563 s, Result = 00744000, Performance =   4.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.035707 s, Result = 00780000, Performance =   4.81 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.037218 s, Result = 007bc000, Performance =   4.76 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.038617 s, Result = 007f8000, Performance =   4.73 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039848 s, Result = 00834000, Performance =   4.72 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.040283 s, Result = 00870000, Performance =   4.80 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.042029 s, Result = 008ac000, Performance =   4.73 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.043142 s, Result = 008e8000, Performance =   4.73 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.044617 s, Result = 00924000, Performance =   4.69 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046161 s, Result = 00960000, Performance =   4.65 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.047774 s, Result = 0099c000, Performance =   4.61 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.048739 s, Result = 009d8000, Performance =   4.63 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050802 s, Result = 00a14000, Performance =   4.54 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.052293 s, Result = 00a50000, Performance =   4.52 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.053865 s, Result = 00a8c000, Performance =   4.49 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.055442 s, Result = 00ac8000, Performance =   4.45 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.057299 s, Result = 00b04000, Performance =   4.40 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.060122 s, Result = 00b40000, Performance =   4.29 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058979 s, Result = 00b7c000, Performance =   4.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.060544 s, Result = 00bb8000, Performance =   4.43 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061968 s, Result = 00bf4000, Performance =   4.42 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.063475 s, Result = 00c30000, Performance =   4.40 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.066087 s, Result = 00c6c000, Performance =   4.31 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.066494 s, Result = 00ca8000, Performance =   4.36 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.068328 s, Result = 00ce4000, Performance =   4.32 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.069056 s, Result = 00d20000, Performance =   4.35 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.074284 s, Result = 00d5c000, Performance =   4.12 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.075036 s, Result = 00d98000, Performance =   4.15 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.076614 s, Result = 00dd4000, Performance =   4.13 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.077712 s, Result = 00e10000, Performance =   4.15 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.078924 s, Result = 00e4c000, Performance =   4.15 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.080287 s, Result = 00e88000, Performance =   4.15 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.082453 s, Result = 00ec4000, Performance =   4.10 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.083689 s, Result = 00f00000, Performance =   4.11 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1934   446   512
Test passed: M N K =   631   302  1088
Test passed: M N K =  1915   557   576
Test passed: M N K =   817    89  1600
Test passed: M N K =  1227  1132  2048
M N K =  1024  1024   256, Elapsed time =   0.005259 s, Result = f5042000, Performance =   1.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005957 s, Result = a9074000, Performance =   1.80 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006840 s, Result = 5d0a6000, Performance =   2.35 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007746 s, Result = 110d8000, Performance =   2.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008702 s, Result = c510a000, Performance =   3.08 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009766 s, Result = 7913c000, Performance =   3.30 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010813 s, Result = 2d16e000, Performance =   3.48 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011915 s, Result = e11a0000, Performance =   3.60 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012990 s, Result = 951d2000, Performance =   3.72 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014011 s, Result = 49204000, Performance =   3.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015209 s, Result = fd236000, Performance =   3.88 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016195 s, Result = b1268000, Performance =   3.98 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017299 s, Result = 6529a000, Performance =   4.03 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019321 s, Result = 192cc000, Performance =   3.89 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020597 s, Result = cd2fe000, Performance =   3.91 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021434 s, Result = 81330000, Performance =   4.01 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.022252 s, Result = 35362000, Performance =   4.10 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023083 s, Result = e9394000, Performance =   4.19 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.024152 s, Result = 9d3c6000, Performance =   4.22 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025058 s, Result = 513f8000, Performance =   4.29 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026018 s, Result = 0542a000, Performance =   4.33 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027856 s, Result = b945c000, Performance =   4.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029190 s, Result = 6d48e000, Performance =   4.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.030131 s, Result = 214c0000, Performance =   4.28 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031603 s, Result = d54f2000, Performance =   4.25 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032485 s, Result = 89524000, Performance =   4.30 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.034136 s, Result = 3d556000, Performance =   4.25 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035781 s, Result = f1588000, Performance =   4.20 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037075 s, Result = a55ba000, Performance =   4.20 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038816 s, Result = 595ec000, Performance =   4.15 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040821 s, Result = 0d61e000, Performance =   4.08 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.042193 s, Result = c1650000, Performance =   4.07 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.041010 s, Result = 75682000, Performance =   4.32 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.042202 s, Result = 296b4000, Performance =   4.33 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.043705 s, Result = dd6e6000, Performance =   4.30 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.045111 s, Result = 91718000, Performance =   4.28 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.046928 s, Result = 4574a000, Performance =   4.23 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.047943 s, Result = f977c000, Performance =   4.26 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.050338 s, Result = ad7ae000, Performance =   4.16 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.051805 s, Result = 617e0000, Performance =   4.15 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.054219 s, Result = 15812000, Performance =   4.06 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.056898 s, Result = c9844000, Performance =   3.96 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.055467 s, Result = 7d876000, Performance =   4.16 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.056799 s, Result = 318a8000, Performance =   4.16 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.057738 s, Result = e58da000, Performance =   4.18 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.059140 s, Result = 9990c000, Performance =   4.18 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.060165 s, Result = 4d93e000, Performance =   4.19 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.061838 s, Result = 01970000, Performance =   4.17 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.062251 s, Result = b59a2000, Performance =   4.23 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.064757 s, Result = 699d4000, Performance =   4.15 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.066566 s, Result = 1da06000, Performance =   4.11 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.065696 s, Result = d1a38000, Performance =   4.25 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.070337 s, Result = 85a6a000, Performance =   4.05 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.069471 s, Result = 39a9c000, Performance =   4.17 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.070926 s, Result = edace000, Performance =   4.16 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.070449 s, Result = a1b00000, Performance =   4.27 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.073138 s, Result = 55b32000, Performance =   4.18 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.072051 s, Result = 09b64000, Performance =   4.32 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.077245 s, Result = bdb96000, Performance =   4.10 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.075285 s, Result = 71bc8000, Performance =   4.28 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.077126 s, Result = 25bfa000, Performance =   4.25 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.077992 s, Result = d9c2c000, Performance =   4.27 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.076994 s, Result = 8dc5e000, Performance =   4.39 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.080810 s, Result = 41c90000, Performance =   4.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   139  1254   960
Test passed: M N K =   448   492  1984
Test passed: M N K =   492  1237  1856
Test passed: M N K =  2003  1119  2048
Test passed: M N K =  1551  1885   768
M N K =  1024  1024   256, Elapsed time =   0.002895 s, Result = 00032000, Performance =   1.85 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003280 s, Result = 00064000, Performance =   3.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004152 s, Result = 00096000, Performance =   3.88 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005051 s, Result = 000c8000, Performance =   4.25 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006004 s, Result = 000fa000, Performance =   4.47 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006986 s, Result = 0012c000, Performance =   4.61 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007984 s, Result = 0015e000, Performance =   4.71 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009118 s, Result = 00190000, Performance =   4.71 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010199 s, Result = 001c2000, Performance =   4.74 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011403 s, Result = 001f4000, Performance =   4.71 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012548 s, Result = 00226000, Performance =   4.71 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013778 s, Result = 00258000, Performance =   4.68 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014888 s, Result = 0028a000, Performance =   4.69 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016028 s, Result = 002bc000, Performance =   4.69 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017070 s, Result = 002ee000, Performance =   4.72 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018109 s, Result = 00320000, Performance =   4.74 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018985 s, Result = 00352000, Performance =   4.81 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020108 s, Result = 00384000, Performance =   4.81 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020895 s, Result = 003b6000, Performance =   4.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021850 s, Result = 003e8000, Performance =   4.91 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022836 s, Result = 0041a000, Performance =   4.94 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023920 s, Result = 0044c000, Performance =   4.94 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024978 s, Result = 0047e000, Performance =   4.94 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026224 s, Result = 004b0000, Performance =   4.91 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027533 s, Result = 004e2000, Performance =   4.87 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028576 s, Result = 00514000, Performance =   4.88 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029968 s, Result = 00546000, Performance =   4.84 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031134 s, Result = 00578000, Performance =   4.83 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.032361 s, Result = 005aa000, Performance =   4.81 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.033509 s, Result = 005dc000, Performance =   4.81 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.034753 s, Result = 0060e000, Performance =   4.79 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.035924 s, Result = 00640000, Performance =   4.78 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.036166 s, Result = 00672000, Performance =   4.90 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.037188 s, Result = 006a4000, Performance =   4.91 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.038517 s, Result = 006d6000, Performance =   4.88 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.039731 s, Result = 00708000, Performance =   4.86 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041121 s, Result = 0073a000, Performance =   4.83 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.048029 s, Result = 0076c000, Performance =   4.25 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.046395 s, Result = 0079e000, Performance =   4.51 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.047882 s, Result = 007d0000, Performance =   4.48 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.048958 s, Result = 00802000, Performance =   4.50 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.050896 s, Result = 00834000, Performance =   4.43 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.051818 s, Result = 00866000, Performance =   4.46 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.052986 s, Result = 00898000, Performance =   4.46 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.054229 s, Result = 008ca000, Performance =   4.46 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.055912 s, Result = 008fc000, Performance =   4.42 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.056708 s, Result = 0092e000, Performance =   4.45 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.058202 s, Result = 00960000, Performance =   4.43 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058947 s, Result = 00992000, Performance =   4.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.061785 s, Result = 009c4000, Performance =   4.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061633 s, Result = 009f6000, Performance =   4.44 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.063676 s, Result = 00a28000, Performance =   4.38 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.063844 s, Result = 00a5a000, Performance =   4.46 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.067386 s, Result = 00a8c000, Performance =   4.30 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.066056 s, Result = 00abe000, Performance =   4.47 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.068738 s, Result = 00af0000, Performance =   4.37 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068930 s, Result = 00b22000, Performance =   4.44 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.071324 s, Result = 00b54000, Performance =   4.37 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.072293 s, Result = 00b86000, Performance =   4.38 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.072431 s, Result = 00bb8000, Performance =   4.45 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.074544 s, Result = 00bea000, Performance =   4.39 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.076363 s, Result = 00c1c000, Performance =   4.36 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.076466 s, Result = 00c4e000, Performance =   4.42 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.079358 s, Result = 00c80000, Performance =   4.33 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   961  1870   192
Test passed: M N K =   228  1333  1024
Test passed: M N K =   884  1263  1664
Test passed: M N K =  1819   168  1408
Test passed: M N K =  1458  1291   448
M N K =  1024  1024   256, Elapsed time =   0.004649 s, Result = 0a0d2000, Performance =   1.15 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005629 s, Result = 0a104000, Performance =   1.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006556 s, Result = 0a136000, Performance =   2.46 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007417 s, Result = 0a168000, Performance =   2.90 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008293 s, Result = 0a19a000, Performance =   3.24 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009426 s, Result = 0a1cc000, Performance =   3.42 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010477 s, Result = 0a1fe000, Performance =   3.59 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011548 s, Result = 0a230000, Performance =   3.72 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012600 s, Result = 0a262000, Performance =   3.83 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013702 s, Result = 0a294000, Performance =   3.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014834 s, Result = 0a2c6000, Performance =   3.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015876 s, Result = 0a2f8000, Performance =   4.06 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016957 s, Result = 0a32a000, Performance =   4.12 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017941 s, Result = 0a35c000, Performance =   4.19 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019160 s, Result = 0a38e000, Performance =   4.20 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019808 s, Result = 0a3c0000, Performance =   4.34 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020706 s, Result = 0a3f2000, Performance =   4.41 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021747 s, Result = 0a424000, Performance =   4.44 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022725 s, Result = 0a456000, Performance =   4.49 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023814 s, Result = 0a488000, Performance =   4.51 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024865 s, Result = 0a4ba000, Performance =   4.53 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.028019 s, Result = 0a4ec000, Performance =   4.22 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027794 s, Result = 0a51e000, Performance =   4.44 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029249 s, Result = 0a550000, Performance =   4.41 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030471 s, Result = 0a582000, Performance =   4.40 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.031908 s, Result = 0a5b4000, Performance =   4.37 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033345 s, Result = 0a5e6000, Performance =   4.35 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034618 s, Result = 0a618000, Performance =   4.34 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.036028 s, Result = 0a64a000, Performance =   4.32 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.037441 s, Result = 0a67c000, Performance =   4.30 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.039225 s, Result = 0a6ae000, Performance =   4.24 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.040171 s, Result = 0a6e0000, Performance =   4.28 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039033 s, Result = 0a712000, Performance =   4.54 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040623 s, Result = 0a744000, Performance =   4.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.041898 s, Result = 0a776000, Performance =   4.48 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.043102 s, Result = 0a7a8000, Performance =   4.48 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.044947 s, Result = 0a7da000, Performance =   4.42 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.045782 s, Result = 0a80c000, Performance =   4.46 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.047190 s, Result = 0a83e000, Performance =   4.44 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.048455 s, Result = 0a870000, Performance =   4.43 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.050119 s, Result = 0a8a2000, Performance =   4.39 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.051656 s, Result = 0a8d4000, Performance =   4.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.053157 s, Result = 0a906000, Performance =   4.34 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.054026 s, Result = 0a938000, Performance =   4.37 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.055499 s, Result = 0a96a000, Performance =   4.35 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.056950 s, Result = 0a99c000, Performance =   4.34 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.057776 s, Result = 0a9ce000, Performance =   4.37 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.059577 s, Result = 0aa00000, Performance =   4.33 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.059553 s, Result = 0aa32000, Performance =   4.42 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.062331 s, Result = 0aa64000, Performance =   4.31 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.062645 s, Result = 0aa96000, Performance =   4.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.064331 s, Result = 0aac8000, Performance =   4.34 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.064498 s, Result = 0aafa000, Performance =   4.41 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.066311 s, Result = 0ab2c000, Performance =   4.37 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.069656 s, Result = 0ab5e000, Performance =   4.24 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.067465 s, Result = 0ab90000, Performance =   4.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068102 s, Result = 0abc2000, Performance =   4.49 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.068478 s, Result = 0abf4000, Performance =   4.55 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.070051 s, Result = 0ac26000, Performance =   4.52 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.072121 s, Result = 0ac58000, Performance =   4.47 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.073734 s, Result = 0ac8a000, Performance =   4.44 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.075294 s, Result = 0acbc000, Performance =   4.42 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.076552 s, Result = 0acee000, Performance =   4.42 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.078848 s, Result = 0ad20000, Performance =   4.36 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1714  1982  1600
Test passed: M N K =  1813    61   832
Test passed: M N K =  1222  1121  1984
Test passed: M N K =  1780  2042   128
Test passed: M N K =  1223   856  1280
M N K =  1024  1024   256, Elapsed time =   0.000995 s, Result = 00032000, Performance =   5.39 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002146 s, Result = 00064000, Performance =   5.00 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003361 s, Result = 00096000, Performance =   4.79 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004609 s, Result = 000c8000, Performance =   4.66 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005797 s, Result = 000fa000, Performance =   4.63 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006914 s, Result = 0012c000, Performance =   4.66 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008004 s, Result = 0015e000, Performance =   4.70 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009086 s, Result = 00190000, Performance =   4.73 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010542 s, Result = 001c2000, Performance =   4.58 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011881 s, Result = 001f4000, Performance =   4.52 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012850 s, Result = 00226000, Performance =   4.60 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013831 s, Result = 00258000, Performance =   4.66 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014739 s, Result = 0028a000, Performance =   4.74 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015019 s, Result = 002bc000, Performance =   5.00 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015817 s, Result = 002ee000, Performance =   5.09 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016318 s, Result = 00320000, Performance =   5.26 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017118 s, Result = 00352000, Performance =   5.33 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018110 s, Result = 00384000, Performance =   5.34 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019155 s, Result = 003b6000, Performance =   5.33 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020047 s, Result = 003e8000, Performance =   5.36 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021175 s, Result = 0041a000, Performance =   5.32 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022010 s, Result = 0044c000, Performance =   5.37 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023049 s, Result = 0047e000, Performance =   5.36 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024211 s, Result = 004b0000, Performance =   5.32 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025193 s, Result = 004e2000, Performance =   5.33 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026411 s, Result = 00514000, Performance =   5.29 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027625 s, Result = 00546000, Performance =   5.25 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.028801 s, Result = 00578000, Performance =   5.22 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030065 s, Result = 005aa000, Performance =   5.18 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031221 s, Result = 005dc000, Performance =   5.16 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032515 s, Result = 0060e000, Performance =   5.12 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.033498 s, Result = 00640000, Performance =   5.13 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033641 s, Result = 00672000, Performance =   5.27 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034820 s, Result = 006a4000, Performance =   5.24 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035825 s, Result = 006d6000, Performance =   5.25 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037151 s, Result = 00708000, Performance =   5.20 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.038613 s, Result = 0073a000, Performance =   5.14 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039867 s, Result = 0076c000, Performance =   5.12 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040990 s, Result = 0079e000, Performance =   5.11 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.042368 s, Result = 007d0000, Performance =   5.07 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.043508 s, Result = 00802000, Performance =   5.06 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.044739 s, Result = 00834000, Performance =   5.04 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.045999 s, Result = 00866000, Performance =   5.02 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.047466 s, Result = 00898000, Performance =   4.98 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.048760 s, Result = 008ca000, Performance =   4.95 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.049977 s, Result = 008fc000, Performance =   4.94 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.051173 s, Result = 0092e000, Performance =   4.93 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.052665 s, Result = 00960000, Performance =   4.89 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056228 s, Result = 00992000, Performance =   4.68 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057234 s, Result = 009c4000, Performance =   4.69 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.058261 s, Result = 009f6000, Performance =   4.70 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059518 s, Result = 00a28000, Performance =   4.69 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.061346 s, Result = 00a5a000, Performance =   4.64 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.061578 s, Result = 00a8c000, Performance =   4.71 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.063728 s, Result = 00abe000, Performance =   4.63 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.063339 s, Result = 00af0000, Performance =   4.75 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066466 s, Result = 00b22000, Performance =   4.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.065249 s, Result = 00b54000, Performance =   4.77 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.068612 s, Result = 00b86000, Performance =   4.62 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.067670 s, Result = 00bb8000, Performance =   4.76 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.069400 s, Result = 00bea000, Performance =   4.72 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.070180 s, Result = 00c1c000, Performance =   4.74 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073745 s, Result = 00c4e000, Performance =   4.59 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.075108 s, Result = 00c80000, Performance =   4.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1000   749   832
Test passed: M N K =  1341   326  1472
Test passed: M N K =   496  1649  1920
Test passed: M N K =  1848   313  1024
Test passed: M N K =   768  1305   512
M N K =  1024  1024   256, Elapsed time =   0.005706 s, Result = f5042000, Performance =   0.94 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006403 s, Result = a9074000, Performance =   1.68 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006817 s, Result = 5d0a6000, Performance =   2.36 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007659 s, Result = 110d8000, Performance =   2.80 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008578 s, Result = c510a000, Performance =   3.13 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009570 s, Result = 7913c000, Performance =   3.37 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010548 s, Result = 2d16e000, Performance =   3.56 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011503 s, Result = e11a0000, Performance =   3.73 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013357 s, Result = 951d2000, Performance =   3.62 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014437 s, Result = 49204000, Performance =   3.72 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015314 s, Result = fd236000, Performance =   3.86 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016321 s, Result = b1268000, Performance =   3.95 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017281 s, Result = 6529a000, Performance =   4.04 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018224 s, Result = 192cc000, Performance =   4.12 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019199 s, Result = cd2fe000, Performance =   4.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020163 s, Result = 81330000, Performance =   4.26 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021116 s, Result = 35362000, Performance =   4.32 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021914 s, Result = e9394000, Performance =   4.41 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023089 s, Result = 9d3c6000, Performance =   4.42 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023918 s, Result = 513f8000, Performance =   4.49 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024989 s, Result = 0542a000, Performance =   4.51 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025865 s, Result = b945c000, Performance =   4.57 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027040 s, Result = 6d48e000, Performance =   4.57 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.028206 s, Result = 214c0000, Performance =   4.57 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031507 s, Result = d54f2000, Performance =   4.26 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.031854 s, Result = 89524000, Performance =   4.38 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033263 s, Result = 3d556000, Performance =   4.36 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034294 s, Result = f1588000, Performance =   4.38 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035417 s, Result = a55ba000, Performance =   4.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036519 s, Result = 595ec000, Performance =   4.41 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.038022 s, Result = 0d61e000, Performance =   4.38 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039444 s, Result = c1650000, Performance =   4.36 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039117 s, Result = 75682000, Performance =   4.53 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039427 s, Result = 296b4000, Performance =   4.63 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040669 s, Result = dd6e6000, Performance =   4.62 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041943 s, Result = 91718000, Performance =   4.61 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043329 s, Result = 4574a000, Performance =   4.58 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044629 s, Result = f977c000, Performance =   4.57 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.045924 s, Result = ad7ae000, Performance =   4.56 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.047316 s, Result = 617e0000, Performance =   4.54 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.048746 s, Result = 15812000, Performance =   4.52 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.049936 s, Result = c9844000, Performance =   4.52 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.051569 s, Result = 7d876000, Performance =   4.48 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.052610 s, Result = 318a8000, Performance =   4.49 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.054194 s, Result = e58da000, Performance =   4.46 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.055418 s, Result = 9990c000, Performance =   4.46 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.056782 s, Result = 4d93e000, Performance =   4.44 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.057956 s, Result = 01970000, Performance =   4.45 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058946 s, Result = b59a2000, Performance =   4.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.060056 s, Result = 699d4000, Performance =   4.47 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061874 s, Result = 1da06000, Performance =   4.43 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.063415 s, Result = d1a38000, Performance =   4.40 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.063551 s, Result = 85a6a000, Performance =   4.48 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.065474 s, Result = 39a9c000, Performance =   4.43 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.065979 s, Result = edace000, Performance =   4.48 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.068560 s, Result = a1b00000, Performance =   4.39 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068695 s, Result = 55b32000, Performance =   4.45 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.071224 s, Result = 09b64000, Performance =   4.37 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.071274 s, Result = bdb96000, Performance =   4.44 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.073013 s, Result = 71bc8000, Performance =   4.41 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.074005 s, Result = 25bfa000, Performance =   4.43 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.075641 s, Result = d9c2c000, Performance =   4.40 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.076384 s, Result = 8dc5e000, Performance =   4.43 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.078112 s, Result = 41c90000, Performance =   4.40 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1612  1247  1216
Test passed: M N K =  1921  1361  1856
Test passed: M N K =   901  2008  1216
Test passed: M N K =  1538  1044  1920
Test passed: M N K =  1903  1803  1472
M N K =  1024  1024   256, Elapsed time =   0.003353 s, Result = 00032000, Performance =   1.60 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003339 s, Result = 00064000, Performance =   3.22 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004167 s, Result = 00096000, Performance =   3.86 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004988 s, Result = 000c8000, Performance =   4.30 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005946 s, Result = 000fa000, Performance =   4.51 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006836 s, Result = 0012c000, Performance =   4.71 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007813 s, Result = 0015e000, Performance =   4.81 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008887 s, Result = 00190000, Performance =   4.83 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009876 s, Result = 001c2000, Performance =   4.89 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010899 s, Result = 001f4000, Performance =   4.93 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011959 s, Result = 00226000, Performance =   4.94 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013024 s, Result = 00258000, Performance =   4.95 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014110 s, Result = 0028a000, Performance =   4.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015138 s, Result = 002bc000, Performance =   4.96 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016241 s, Result = 002ee000, Performance =   4.96 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017135 s, Result = 00320000, Performance =   5.01 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018136 s, Result = 00352000, Performance =   5.03 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019127 s, Result = 00384000, Performance =   5.05 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020192 s, Result = 003b6000, Performance =   5.05 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021040 s, Result = 003e8000, Performance =   5.10 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022069 s, Result = 0041a000, Performance =   5.11 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023050 s, Result = 0044c000, Performance =   5.12 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024217 s, Result = 0047e000, Performance =   5.10 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025172 s, Result = 004b0000, Performance =   5.12 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026370 s, Result = 004e2000, Performance =   5.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027443 s, Result = 00514000, Performance =   5.09 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028638 s, Result = 00546000, Performance =   5.06 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029649 s, Result = 00578000, Performance =   5.07 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030904 s, Result = 005aa000, Performance =   5.04 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031924 s, Result = 005dc000, Performance =   5.05 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.033314 s, Result = 0060e000, Performance =   5.00 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034401 s, Result = 00640000, Performance =   4.99 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.035296 s, Result = 00672000, Performance =   5.02 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.035597 s, Result = 006a4000, Performance =   5.13 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.036791 s, Result = 006d6000, Performance =   5.11 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037981 s, Result = 00708000, Performance =   5.09 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.039398 s, Result = 0073a000, Performance =   5.04 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.040435 s, Result = 0076c000, Performance =   5.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.041793 s, Result = 0079e000, Performance =   5.01 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.042849 s, Result = 007d0000, Performance =   5.01 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.044038 s, Result = 00802000, Performance =   5.00 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.045153 s, Result = 00834000, Performance =   4.99 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.046701 s, Result = 00866000, Performance =   4.94 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.048005 s, Result = 00898000, Performance =   4.92 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049296 s, Result = 008ca000, Performance =   4.90 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053547 s, Result = 008fc000, Performance =   4.61 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.053706 s, Result = 0092e000, Performance =   4.70 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.055904 s, Result = 00960000, Performance =   4.61 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056329 s, Result = 00992000, Performance =   4.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057695 s, Result = 009c4000, Performance =   4.65 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.058892 s, Result = 009f6000, Performance =   4.65 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.060164 s, Result = 00a28000, Performance =   4.64 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.061592 s, Result = 00a5a000, Performance =   4.62 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.062919 s, Result = 00a8c000, Performance =   4.61 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.063542 s, Result = 00abe000, Performance =   4.65 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.064634 s, Result = 00af0000, Performance =   4.65 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066099 s, Result = 00b22000, Performance =   4.63 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066944 s, Result = 00b54000, Performance =   4.65 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.069335 s, Result = 00b86000, Performance =   4.57 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.070236 s, Result = 00bb8000, Performance =   4.59 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.071538 s, Result = 00bea000, Performance =   4.58 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.072966 s, Result = 00c1c000, Performance =   4.56 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073505 s, Result = 00c4e000, Performance =   4.60 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.075656 s, Result = 00c80000, Performance =   4.54 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1908   914  1664
Test passed: M N K =   272  1902  1408
Test passed: M N K =  1308  1764   128
Test passed: M N K =  1372   523   768
Test passed: M N K =    65   664   960
M N K =  1024  1024   256, Elapsed time =   0.005007 s, Result = 0a0d2000, Performance =   1.07 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006342 s, Result = 0a104000, Performance =   1.69 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007944 s, Result = 0a136000, Performance =   2.03 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008528 s, Result = 0a168000, Performance =   2.52 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009967 s, Result = 0a19a000, Performance =   2.69 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010770 s, Result = 0a1cc000, Performance =   2.99 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.012327 s, Result = 0a1fe000, Performance =   3.05 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013194 s, Result = 0a230000, Performance =   3.26 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014302 s, Result = 0a262000, Performance =   3.38 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015405 s, Result = 0a294000, Performance =   3.48 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016885 s, Result = 0a2c6000, Performance =   3.50 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017408 s, Result = 0a2f8000, Performance =   3.70 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018624 s, Result = 0a32a000, Performance =   3.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018434 s, Result = 0a35c000, Performance =   4.08 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019144 s, Result = 0a38e000, Performance =   4.21 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019436 s, Result = 0a3c0000, Performance =   4.42 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020413 s, Result = 0a3f2000, Performance =   4.47 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021234 s, Result = 0a424000, Performance =   4.55 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022408 s, Result = 0a456000, Performance =   4.55 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023682 s, Result = 0a488000, Performance =   4.53 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024552 s, Result = 0a4ba000, Performance =   4.59 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025603 s, Result = 0a4ec000, Performance =   4.61 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026836 s, Result = 0a51e000, Performance =   4.60 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027805 s, Result = 0a550000, Performance =   4.63 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.029164 s, Result = 0a582000, Performance =   4.60 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030268 s, Result = 0a5b4000, Performance =   4.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.031343 s, Result = 0a5e6000, Performance =   4.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.032599 s, Result = 0a618000, Performance =   4.61 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.034491 s, Result = 0a64a000, Performance =   4.51 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034854 s, Result = 0a67c000, Performance =   4.62 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036643 s, Result = 0a6ae000, Performance =   4.54 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.038487 s, Result = 0a6e0000, Performance =   4.46 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038105 s, Result = 0a712000, Performance =   4.65 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.038623 s, Result = 0a744000, Performance =   4.73 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040359 s, Result = 0a776000, Performance =   4.66 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.040352 s, Result = 0a7a8000, Performance =   4.79 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041525 s, Result = 0a7da000, Performance =   4.78 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042963 s, Result = 0a80c000, Performance =   4.75 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.044097 s, Result = 0a83e000, Performance =   4.75 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.045571 s, Result = 0a870000, Performance =   4.71 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.046615 s, Result = 0a8a2000, Performance =   4.72 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.048015 s, Result = 0a8d4000, Performance =   4.70 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.048918 s, Result = 0a906000, Performance =   4.72 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051299 s, Result = 0a938000, Performance =   4.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.051691 s, Result = 0a96a000, Performance =   4.67 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053554 s, Result = 0a99c000, Performance =   4.61 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.054172 s, Result = 0a9ce000, Performance =   4.66 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.055895 s, Result = 0aa00000, Performance =   4.61 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.057104 s, Result = 0aa32000, Performance =   4.61 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.058087 s, Result = 0aa64000, Performance =   4.62 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.059357 s, Result = 0aa96000, Performance =   4.61 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.060587 s, Result = 0aac8000, Performance =   4.61 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.061482 s, Result = 0aafa000, Performance =   4.63 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.063377 s, Result = 0ab2c000, Performance =   4.57 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.064088 s, Result = 0ab5e000, Performance =   4.61 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.065747 s, Result = 0ab90000, Performance =   4.57 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066463 s, Result = 0abc2000, Performance =   4.60 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.068680 s, Result = 0abf4000, Performance =   4.53 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.068902 s, Result = 0ac26000, Performance =   4.60 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.070549 s, Result = 0ac58000, Performance =   4.57 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.071589 s, Result = 0ac8a000, Performance =   4.57 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.072692 s, Result = 0acbc000, Performance =   4.58 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073775 s, Result = 0acee000, Performance =   4.58 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.073845 s, Result = 0ad20000, Performance =   4.65 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1427  1314  1152
Test passed: M N K =   438  1399   320
Test passed: M N K =   797  1743   192
Test passed: M N K =   595  1183  1216
Test passed: M N K =   463   713    64
M N K =  1024  1024   256, Elapsed time =   0.000987 s, Result = 00032000, Performance =   5.44 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002011 s, Result = 00064000, Performance =   5.34 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003302 s, Result = 00096000, Performance =   4.88 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004391 s, Result = 000c8000, Performance =   4.89 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005548 s, Result = 000fa000, Performance =   4.84 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006775 s, Result = 0012c000, Performance =   4.75 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007952 s, Result = 0015e000, Performance =   4.73 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008934 s, Result = 00190000, Performance =   4.81 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010222 s, Result = 001c2000, Performance =   4.73 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011347 s, Result = 001f4000, Performance =   4.73 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012924 s, Result = 00226000, Performance =   4.57 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013875 s, Result = 00258000, Performance =   4.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015158 s, Result = 0028a000, Performance =   4.60 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016380 s, Result = 002bc000, Performance =   4.59 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017715 s, Result = 002ee000, Performance =   4.55 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018441 s, Result = 00320000, Performance =   4.66 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019464 s, Result = 00352000, Performance =   4.69 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019888 s, Result = 00384000, Performance =   4.86 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020393 s, Result = 003b6000, Performance =   5.00 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019672 s, Result = 003e8000, Performance =   5.46 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020555 s, Result = 0041a000, Performance =   5.48 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021904 s, Result = 0044c000, Performance =   5.39 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025007 s, Result = 0047e000, Performance =   4.94 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024130 s, Result = 004b0000, Performance =   5.34 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024908 s, Result = 004e2000, Performance =   5.39 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025800 s, Result = 00514000, Performance =   5.41 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027093 s, Result = 00546000, Performance =   5.35 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.028225 s, Result = 00578000, Performance =   5.33 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028916 s, Result = 005aa000, Performance =   5.38 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029949 s, Result = 005dc000, Performance =   5.38 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031166 s, Result = 0060e000, Performance =   5.34 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032774 s, Result = 00640000, Performance =   5.24 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033620 s, Result = 00672000, Performance =   5.27 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033932 s, Result = 006a4000, Performance =   5.38 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035182 s, Result = 006d6000, Performance =   5.34 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.036457 s, Result = 00708000, Performance =   5.30 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037383 s, Result = 0073a000, Performance =   5.31 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038837 s, Result = 0076c000, Performance =   5.25 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039820 s, Result = 0079e000, Performance =   5.26 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.041388 s, Result = 007d0000, Performance =   5.19 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.042208 s, Result = 00802000, Performance =   5.22 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043823 s, Result = 00834000, Performance =   5.15 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044825 s, Result = 00866000, Performance =   5.15 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.046445 s, Result = 00898000, Performance =   5.09 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.047734 s, Result = 008ca000, Performance =   5.06 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.050093 s, Result = 008fc000, Performance =   4.93 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.050392 s, Result = 0092e000, Performance =   5.01 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.052128 s, Result = 00960000, Performance =   4.94 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.052778 s, Result = 00992000, Performance =   4.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.054731 s, Result = 009c4000, Performance =   4.90 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.055204 s, Result = 009f6000, Performance =   4.96 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.057263 s, Result = 00a28000, Performance =   4.88 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.057552 s, Result = 00a5a000, Performance =   4.94 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.059200 s, Result = 00a8c000, Performance =   4.90 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.059632 s, Result = 00abe000, Performance =   4.95 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.061572 s, Result = 00af0000, Performance =   4.88 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.062102 s, Result = 00b22000, Performance =   4.93 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.063704 s, Result = 00b54000, Performance =   4.89 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.064401 s, Result = 00b86000, Performance =   4.92 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.065994 s, Result = 00bb8000, Performance =   4.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.065942 s, Result = 00bea000, Performance =   4.97 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.067993 s, Result = 00c1c000, Performance =   4.90 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.068361 s, Result = 00c4e000, Performance =   4.95 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.069136 s, Result = 00c80000, Performance =   4.97 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   150   612    64
Test passed: M N K =  1843   553   448
Test passed: M N K =   191   592   192
Test passed: M N K =    22  1586   640
Test passed: M N K =  1117   700  1280
M N K =  1024  1024   256, Elapsed time =   0.005411 s, Result = f5042000, Performance =   0.99 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006093 s, Result = a9074000, Performance =   1.76 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007030 s, Result = 5d0a6000, Performance =   2.29 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007961 s, Result = 110d8000, Performance =   2.70 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008710 s, Result = c510a000, Performance =   3.08 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009638 s, Result = 7913c000, Performance =   3.34 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010578 s, Result = 2d16e000, Performance =   3.55 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011479 s, Result = e11a0000, Performance =   3.74 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013350 s, Result = 951d2000, Performance =   3.62 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014385 s, Result = 49204000, Performance =   3.73 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015202 s, Result = fd236000, Performance =   3.88 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016155 s, Result = b1268000, Performance =   3.99 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017082 s, Result = 6529a000, Performance =   4.09 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018050 s, Result = 192cc000, Performance =   4.16 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019008 s, Result = cd2fe000, Performance =   4.24 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019944 s, Result = 81330000, Performance =   4.31 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021105 s, Result = 35362000, Performance =   4.32 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021939 s, Result = e9394000, Performance =   4.40 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022538 s, Result = 9d3c6000, Performance =   4.53 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023087 s, Result = 513f8000, Performance =   4.65 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024336 s, Result = 0542a000, Performance =   4.63 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025477 s, Result = b945c000, Performance =   4.64 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026483 s, Result = 6d48e000, Performance =   4.66 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027590 s, Result = 214c0000, Performance =   4.67 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028699 s, Result = d54f2000, Performance =   4.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029859 s, Result = 89524000, Performance =   4.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.031076 s, Result = 3d556000, Performance =   4.66 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.032073 s, Result = f1588000, Performance =   4.69 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033554 s, Result = a55ba000, Performance =   4.64 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034672 s, Result = 595ec000, Performance =   4.65 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036024 s, Result = 0d61e000, Performance =   4.62 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037182 s, Result = c1650000, Performance =   4.62 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038615 s, Result = 75682000, Performance =   4.59 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039725 s, Result = 296b4000, Performance =   4.59 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040477 s, Result = dd6e6000, Performance =   4.64 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041575 s, Result = 91718000, Performance =   4.65 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.042523 s, Result = 4574a000, Performance =   4.67 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044176 s, Result = f977c000, Performance =   4.62 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.044940 s, Result = ad7ae000, Performance =   4.66 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046274 s, Result = 617e0000, Performance =   4.64 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.047404 s, Result = 15812000, Performance =   4.64 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.049016 s, Result = c9844000, Performance =   4.60 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050041 s, Result = 7d876000, Performance =   4.61 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051549 s, Result = 318a8000, Performance =   4.58 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.052840 s, Result = e58da000, Performance =   4.57 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.054325 s, Result = 9990c000, Performance =   4.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.055443 s, Result = 4d93e000, Performance =   4.55 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.057145 s, Result = 01970000, Performance =   4.51 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058171 s, Result = b59a2000, Performance =   4.52 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.059536 s, Result = 699d4000, Performance =   4.51 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061002 s, Result = 1da06000, Performance =   4.49 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.061890 s, Result = d1a38000, Performance =   4.51 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.065782 s, Result = 85a6a000, Performance =   4.33 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.064861 s, Result = 39a9c000, Performance =   4.47 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.066977 s, Result = edace000, Performance =   4.41 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.067004 s, Result = a1b00000, Performance =   4.49 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068547 s, Result = 55b32000, Performance =   4.46 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.069954 s, Result = 09b64000, Performance =   4.45 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.070097 s, Result = bdb96000, Performance =   4.52 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.072184 s, Result = 71bc8000, Performance =   4.46 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.072393 s, Result = 25bfa000, Performance =   4.52 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.073731 s, Result = d9c2c000, Performance =   4.51 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.075487 s, Result = 8dc5e000, Performance =   4.48 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.077182 s, Result = 41c90000, Performance =   4.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   231     8  1408
Test passed: M N K =  1207   221   512
Test passed: M N K =   839   852  1728
Test passed: M N K =  1995   320  1408
Test passed: M N K =   686  1637  1792
M N K =  1024  1024   256, Elapsed time =   0.002839 s, Result = 00032000, Performance =   1.89 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003205 s, Result = 00064000, Performance =   3.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004072 s, Result = 00096000, Performance =   3.96 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004963 s, Result = 000c8000, Performance =   4.33 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005909 s, Result = 000fa000, Performance =   4.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006815 s, Result = 0012c000, Performance =   4.73 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007731 s, Result = 0015e000, Performance =   4.86 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008609 s, Result = 00190000, Performance =   4.99 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009704 s, Result = 001c2000, Performance =   4.98 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011950 s, Result = 001f4000, Performance =   4.49 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012931 s, Result = 00226000, Performance =   4.57 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013779 s, Result = 00258000, Performance =   4.68 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014847 s, Result = 0028a000, Performance =   4.70 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015650 s, Result = 002bc000, Performance =   4.80 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016556 s, Result = 002ee000, Performance =   4.86 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017331 s, Result = 00320000, Performance =   4.96 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018209 s, Result = 00352000, Performance =   5.01 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019266 s, Result = 00384000, Performance =   5.02 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020095 s, Result = 003b6000, Performance =   5.08 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020866 s, Result = 003e8000, Performance =   5.15 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021988 s, Result = 0041a000, Performance =   5.13 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023015 s, Result = 0044c000, Performance =   5.13 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023836 s, Result = 0047e000, Performance =   5.18 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024680 s, Result = 004b0000, Performance =   5.22 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025882 s, Result = 004e2000, Performance =   5.19 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027235 s, Result = 00514000, Performance =   5.13 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028150 s, Result = 00546000, Performance =   5.15 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029394 s, Result = 00578000, Performance =   5.11 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030456 s, Result = 005aa000, Performance =   5.11 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031713 s, Result = 005dc000, Performance =   5.08 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.033091 s, Result = 0060e000, Performance =   5.03 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034554 s, Result = 00640000, Performance =   4.97 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.035721 s, Result = 00672000, Performance =   4.96 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.036598 s, Result = 006a4000, Performance =   4.99 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.037757 s, Result = 006d6000, Performance =   4.98 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.038533 s, Result = 00708000, Performance =   5.02 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.039827 s, Result = 0073a000, Performance =   4.99 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.040995 s, Result = 0076c000, Performance =   4.98 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.042156 s, Result = 0079e000, Performance =   4.97 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.043314 s, Result = 007d0000, Performance =   4.96 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.044630 s, Result = 00802000, Performance =   4.93 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046006 s, Result = 00834000, Performance =   4.90 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.047105 s, Result = 00866000, Performance =   4.90 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.048563 s, Result = 00898000, Performance =   4.86 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049948 s, Result = 008ca000, Performance =   4.84 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.051448 s, Result = 008fc000, Performance =   4.80 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.052682 s, Result = 0092e000, Performance =   4.79 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.053793 s, Result = 00960000, Performance =   4.79 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056593 s, Result = 00992000, Performance =   4.65 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.055439 s, Result = 009c4000, Performance =   4.84 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.056540 s, Result = 009f6000, Performance =   4.84 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.057483 s, Result = 00a28000, Performance =   4.86 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.058572 s, Result = 00a5a000, Performance =   4.86 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.060056 s, Result = 00a8c000, Performance =   4.83 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.060975 s, Result = 00abe000, Performance =   4.84 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.062452 s, Result = 00af0000, Performance =   4.81 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.063434 s, Result = 00b22000, Performance =   4.82 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066253 s, Result = 00b54000, Performance =   4.70 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.067409 s, Result = 00b86000, Performance =   4.70 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.070009 s, Result = 00bb8000, Performance =   4.60 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.068957 s, Result = 00bea000, Performance =   4.75 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.071474 s, Result = 00c1c000, Performance =   4.66 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.072309 s, Result = 00c4e000, Performance =   4.68 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.074703 s, Result = 00c80000, Performance =   4.60 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   592   629  1536
Test passed: M N K =  1046  1728   960
Test passed: M N K =   686   756  1984
Test passed: M N K =   808   218   896
Test passed: M N K =  2018   947   640
M N K =  1024  1024   256, Elapsed time =   0.004183 s, Result = 0a0d2000, Performance =   1.28 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005184 s, Result = 0a104000, Performance =   2.07 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006320 s, Result = 0a136000, Performance =   2.55 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007139 s, Result = 0a168000, Performance =   3.01 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008163 s, Result = 0a19a000, Performance =   3.29 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009104 s, Result = 0a1cc000, Performance =   3.54 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010193 s, Result = 0a1fe000, Performance =   3.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011166 s, Result = 0a230000, Performance =   3.85 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012213 s, Result = 0a262000, Performance =   3.96 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013208 s, Result = 0a294000, Performance =   4.06 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014122 s, Result = 0a2c6000, Performance =   4.18 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015199 s, Result = 0a2f8000, Performance =   4.24 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016197 s, Result = 0a32a000, Performance =   4.31 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017037 s, Result = 0a35c000, Performance =   4.41 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017947 s, Result = 0a38e000, Performance =   4.49 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018932 s, Result = 0a3c0000, Performance =   4.54 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019811 s, Result = 0a3f2000, Performance =   4.61 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.020783 s, Result = 0a424000, Performance =   4.65 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021651 s, Result = 0a456000, Performance =   4.71 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022666 s, Result = 0a488000, Performance =   4.74 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023540 s, Result = 0a4ba000, Performance =   4.79 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025907 s, Result = 0a4ec000, Performance =   4.56 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025972 s, Result = 0a51e000, Performance =   4.75 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026995 s, Result = 0a550000, Performance =   4.77 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028284 s, Result = 0a582000, Performance =   4.75 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029295 s, Result = 0a5b4000, Performance =   4.76 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030238 s, Result = 0a5e6000, Performance =   4.79 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031272 s, Result = 0a618000, Performance =   4.81 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.032551 s, Result = 0a64a000, Performance =   4.78 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.033690 s, Result = 0a67c000, Performance =   4.78 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.034840 s, Result = 0a6ae000, Performance =   4.78 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036073 s, Result = 0a6e0000, Performance =   4.76 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.037290 s, Result = 0a712000, Performance =   4.75 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.038569 s, Result = 0a744000, Performance =   4.73 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039499 s, Result = 0a776000, Performance =   4.76 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.040145 s, Result = 0a7a8000, Performance =   4.81 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041345 s, Result = 0a7da000, Performance =   4.80 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042578 s, Result = 0a80c000, Performance =   4.79 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043545 s, Result = 0a83e000, Performance =   4.81 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044944 s, Result = 0a870000, Performance =   4.78 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.046188 s, Result = 0a8a2000, Performance =   4.77 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.047455 s, Result = 0a8d4000, Performance =   4.75 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.048567 s, Result = 0a906000, Performance =   4.75 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.049912 s, Result = 0a938000, Performance =   4.73 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.050893 s, Result = 0a96a000, Performance =   4.75 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.052665 s, Result = 0a99c000, Performance =   4.69 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.054076 s, Result = 0a9ce000, Performance =   4.67 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.054808 s, Result = 0aa00000, Performance =   4.70 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056118 s, Result = 0aa32000, Performance =   4.69 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057427 s, Result = 0aa64000, Performance =   4.67 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.058417 s, Result = 0aa96000, Performance =   4.69 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.060014 s, Result = 0aac8000, Performance =   4.65 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.061163 s, Result = 0aafa000, Performance =   4.65 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.062403 s, Result = 0ab2c000, Performance =   4.65 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.063580 s, Result = 0ab5e000, Performance =   4.64 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.064696 s, Result = 0ab90000, Performance =   4.65 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066279 s, Result = 0abc2000, Performance =   4.62 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.068036 s, Result = 0abf4000, Performance =   4.58 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.067817 s, Result = 0ac26000, Performance =   4.67 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.070204 s, Result = 0ac58000, Performance =   4.59 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.069961 s, Result = 0ac8a000, Performance =   4.68 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.071642 s, Result = 0acbc000, Performance =   4.65 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.072644 s, Result = 0acee000, Performance =   4.66 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.074553 s, Result = 0ad20000, Performance =   4.61 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1841  2041   576
Test passed: M N K =  1713   937   384
Test passed: M N K =   453   332   640
Test passed: M N K =    65  1224  1728
Test passed: M N K =  1462  2001   128
M N K =  1024  1024   256, Elapsed time =   0.001044 s, Result = 00032000, Performance =   5.14 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002053 s, Result = 00064000, Performance =   5.23 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003122 s, Result = 00096000, Performance =   5.16 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004094 s, Result = 000c8000, Performance =   5.25 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005474 s, Result = 000fa000, Performance =   4.90 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006585 s, Result = 0012c000, Performance =   4.89 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007582 s, Result = 0015e000, Performance =   4.96 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008583 s, Result = 00190000, Performance =   5.00 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009698 s, Result = 001c2000, Performance =   4.98 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010319 s, Result = 001f4000, Performance =   5.20 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011110 s, Result = 00226000, Performance =   5.32 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011565 s, Result = 00258000, Performance =   5.57 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011941 s, Result = 0028a000, Performance =   5.84 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012938 s, Result = 002bc000, Performance =   5.81 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013995 s, Result = 002ee000, Performance =   5.75 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014935 s, Result = 00320000, Performance =   5.75 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015957 s, Result = 00352000, Performance =   5.72 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016957 s, Result = 00384000, Performance =   5.70 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017895 s, Result = 003b6000, Performance =   5.70 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018826 s, Result = 003e8000, Performance =   5.70 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019806 s, Result = 0041a000, Performance =   5.69 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020735 s, Result = 0044c000, Performance =   5.70 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021636 s, Result = 0047e000, Performance =   5.71 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022483 s, Result = 004b0000, Performance =   5.73 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023606 s, Result = 004e2000, Performance =   5.69 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024567 s, Result = 00514000, Performance =   5.68 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025611 s, Result = 00546000, Performance =   5.66 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026556 s, Result = 00578000, Performance =   5.66 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027668 s, Result = 005aa000, Performance =   5.63 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028662 s, Result = 005dc000, Performance =   5.62 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029843 s, Result = 0060e000, Performance =   5.58 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030830 s, Result = 00640000, Performance =   5.57 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032235 s, Result = 00672000, Performance =   5.50 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033245 s, Result = 006a4000, Performance =   5.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034126 s, Result = 006d6000, Performance =   5.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034818 s, Result = 00708000, Performance =   5.55 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036019 s, Result = 0073a000, Performance =   5.51 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.037060 s, Result = 0076c000, Performance =   5.50 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038182 s, Result = 0079e000, Performance =   5.48 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.039170 s, Result = 007d0000, Performance =   5.48 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040464 s, Result = 00802000, Performance =   5.44 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041648 s, Result = 00834000, Performance =   5.41 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042712 s, Result = 00866000, Performance =   5.40 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.043711 s, Result = 00898000, Performance =   5.40 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.045124 s, Result = 008ca000, Performance =   5.35 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.046421 s, Result = 008fc000, Performance =   5.32 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.047589 s, Result = 0092e000, Performance =   5.30 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.048662 s, Result = 00960000, Performance =   5.30 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.049929 s, Result = 00992000, Performance =   5.27 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.051114 s, Result = 009c4000, Performance =   5.25 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.055028 s, Result = 009f6000, Performance =   4.98 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055487 s, Result = 00a28000, Performance =   5.03 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.056905 s, Result = 00a5a000, Performance =   5.00 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.058415 s, Result = 00a8c000, Performance =   4.96 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.059593 s, Result = 00abe000, Performance =   4.95 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.061041 s, Result = 00af0000, Performance =   4.93 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.061845 s, Result = 00b22000, Performance =   4.95 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.063994 s, Result = 00b54000, Performance =   4.87 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.063589 s, Result = 00b86000, Performance =   4.98 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.066958 s, Result = 00bb8000, Performance =   4.81 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.066126 s, Result = 00bea000, Performance =   4.95 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.068740 s, Result = 00c1c000, Performance =   4.84 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.069832 s, Result = 00c4e000, Performance =   4.84 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.072420 s, Result = 00c80000, Performance =   4.74 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   896   734   256
Test passed: M N K =  1353  1912   512
Test passed: M N K =   864  1269  1024
Test passed: M N K =  1831  1030  1856
Test passed: M N K =  1239   202   832
M N K =  1024  1024   256, Elapsed time =   0.006456 s, Result = 8d04c000, Performance =   0.83 TOPS
M N K =  1024  1024   512, Elapsed time =   0.008294 s, Result = f9088000, Performance =   1.29 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008775 s, Result = 650c4000, Performance =   1.84 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008738 s, Result = d1100000, Performance =   2.46 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009564 s, Result = 3d13c000, Performance =   2.81 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010718 s, Result = a9178000, Performance =   3.01 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011840 s, Result = 151b4000, Performance =   3.17 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.013112 s, Result = 811f0000, Performance =   3.28 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014309 s, Result = ed22c000, Performance =   3.38 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015447 s, Result = 59268000, Performance =   3.48 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016572 s, Result = c52a4000, Performance =   3.56 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017708 s, Result = 312e0000, Performance =   3.64 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018836 s, Result = 9d31c000, Performance =   3.71 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.020017 s, Result = 09358000, Performance =   3.75 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.021095 s, Result = 75394000, Performance =   3.82 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022227 s, Result = e13d0000, Performance =   3.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023344 s, Result = 4d40c000, Performance =   3.91 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024654 s, Result = b9448000, Performance =   3.92 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.025895 s, Result = 25484000, Performance =   3.94 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027735 s, Result = 914c0000, Performance =   3.87 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.029489 s, Result = fd4fc000, Performance =   3.82 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.031059 s, Result = 69538000, Performance =   3.80 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.032561 s, Result = d5574000, Performance =   3.79 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.034097 s, Result = 415b0000, Performance =   3.78 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.035501 s, Result = ad5ec000, Performance =   3.78 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.037157 s, Result = 19628000, Performance =   3.76 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.038655 s, Result = 85664000, Performance =   3.75 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.040965 s, Result = f16a0000, Performance =   3.67 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.042429 s, Result = 5d6dc000, Performance =   3.67 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.044349 s, Result = c9718000, Performance =   3.63 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.046082 s, Result = 35754000, Performance =   3.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.047269 s, Result = a1790000, Performance =   3.63 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.048131 s, Result = 0d7cc000, Performance =   3.68 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.049739 s, Result = 79808000, Performance =   3.67 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.051627 s, Result = e5844000, Performance =   3.64 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.053625 s, Result = 51880000, Performance =   3.60 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.055136 s, Result = bd8bc000, Performance =   3.60 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.057333 s, Result = 298f8000, Performance =   3.56 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.058985 s, Result = 95934000, Performance =   3.55 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.060951 s, Result = 01970000, Performance =   3.52 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.063021 s, Result = 6d9ac000, Performance =   3.49 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.065021 s, Result = d99e8000, Performance =   3.47 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.066363 s, Result = 45a24000, Performance =   3.48 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.067838 s, Result = b1a60000, Performance =   3.48 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.070344 s, Result = 1da9c000, Performance =   3.43 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.073488 s, Result = 89ad8000, Performance =   3.36 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.074160 s, Result = f5b14000, Performance =   3.40 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.077425 s, Result = 61b50000, Performance =   3.33 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.078037 s, Result = cdb8c000, Performance =   3.37 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.081050 s, Result = 39bc8000, Performance =   3.31 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.083183 s, Result = a5c04000, Performance =   3.29 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.085033 s, Result = 11c40000, Performance =   3.28 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.086997 s, Result = 7dc7c000, Performance =   3.27 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.088630 s, Result = e9cb8000, Performance =   3.27 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.090898 s, Result = 55cf4000, Performance =   3.25 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.092811 s, Result = c1d30000, Performance =   3.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.095273 s, Result = 2dd6c000, Performance =   3.21 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.096497 s, Result = 99da8000, Performance =   3.23 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.098226 s, Result = 05de4000, Performance =   3.22 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.100239 s, Result = 71e20000, Performance =   3.21 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.102005 s, Result = dde5c000, Performance =   3.21 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.102314 s, Result = 49e98000, Performance =   3.25 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.105740 s, Result = b5ed4000, Performance =   3.20 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.102796 s, Result = 21f10000, Performance =   3.34 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   837   176  1856
Test passed: M N K =   143  1595   896
Test passed: M N K =  1682   821  1984
Test passed: M N K =  1493  1596   384
Test passed: M N K =   875  1092  1216
M N K =  1024  1024   256, Elapsed time =   0.003233 s, Result = 0003c000, Performance =   1.66 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003758 s, Result = 00078000, Performance =   2.86 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004843 s, Result = 000b4000, Performance =   3.33 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005970 s, Result = 000f0000, Performance =   3.60 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007092 s, Result = 0012c000, Performance =   3.79 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008275 s, Result = 00168000, Performance =   3.89 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009539 s, Result = 001a4000, Performance =   3.94 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010778 s, Result = 001e0000, Performance =   3.98 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012196 s, Result = 0021c000, Performance =   3.96 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013450 s, Result = 00258000, Performance =   3.99 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014763 s, Result = 00294000, Performance =   4.00 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015806 s, Result = 002d0000, Performance =   4.08 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016988 s, Result = 0030c000, Performance =   4.11 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018132 s, Result = 00348000, Performance =   4.15 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019218 s, Result = 00384000, Performance =   4.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020328 s, Result = 003c0000, Performance =   4.23 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021233 s, Result = 003fc000, Performance =   4.30 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022447 s, Result = 00438000, Performance =   4.31 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023622 s, Result = 00474000, Performance =   4.32 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024766 s, Result = 004b0000, Performance =   4.34 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026173 s, Result = 004ec000, Performance =   4.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027872 s, Result = 00528000, Performance =   4.24 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029520 s, Result = 00564000, Performance =   4.18 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031112 s, Result = 005a0000, Performance =   4.14 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.032821 s, Result = 005dc000, Performance =   4.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034384 s, Result = 00618000, Performance =   4.06 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.035908 s, Result = 00654000, Performance =   4.04 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.037262 s, Result = 00690000, Performance =   4.03 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.038775 s, Result = 006cc000, Performance =   4.02 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.043037 s, Result = 00708000, Performance =   3.74 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.044002 s, Result = 00744000, Performance =   3.78 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.046018 s, Result = 00780000, Performance =   3.73 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.044775 s, Result = 007bc000, Performance =   3.96 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.046993 s, Result = 007f8000, Performance =   3.88 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.048684 s, Result = 00834000, Performance =   3.86 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.050100 s, Result = 00870000, Performance =   3.86 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.052560 s, Result = 008ac000, Performance =   3.78 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.053923 s, Result = 008e8000, Performance =   3.78 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.056482 s, Result = 00924000, Performance =   3.71 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.057028 s, Result = 00960000, Performance =   3.77 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.059913 s, Result = 0099c000, Performance =   3.67 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.061285 s, Result = 009d8000, Performance =   3.68 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.063780 s, Result = 00a14000, Performance =   3.62 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.065178 s, Result = 00a50000, Performance =   3.62 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.067173 s, Result = 00a8c000, Performance =   3.60 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.069253 s, Result = 00ac8000, Performance =   3.57 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.070841 s, Result = 00b04000, Performance =   3.56 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.072925 s, Result = 00b40000, Performance =   3.53 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.074810 s, Result = 00b7c000, Performance =   3.52 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.076439 s, Result = 00bb8000, Performance =   3.51 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.079974 s, Result = 00bf4000, Performance =   3.42 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.081569 s, Result = 00c30000, Performance =   3.42 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.084089 s, Result = 00c6c000, Performance =   3.38 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.085525 s, Result = 00ca8000, Performance =   3.39 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.088624 s, Result = 00ce4000, Performance =   3.33 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.089211 s, Result = 00d20000, Performance =   3.37 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.092063 s, Result = 00d5c000, Performance =   3.32 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.093760 s, Result = 00d98000, Performance =   3.32 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.095483 s, Result = 00dd4000, Performance =   3.32 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.096362 s, Result = 00e10000, Performance =   3.34 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.097714 s, Result = 00e4c000, Performance =   3.35 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.097915 s, Result = 00e88000, Performance =   3.40 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.101860 s, Result = 00ec4000, Performance =   3.32 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.099386 s, Result = 00f00000, Performance =   3.46 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   239  1007   256
Test passed: M N K =   385    27  1216
Test passed: M N K =  1508  1065  1600
Test passed: M N K =  1674   707  1536
Test passed: M N K =  1884   173   960
M N K =  1024  1024   256, Elapsed time =   0.005000 s, Result = 0a0dc000, Performance =   1.07 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005789 s, Result = 0a118000, Performance =   1.85 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006682 s, Result = 0a154000, Performance =   2.41 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007746 s, Result = 0a190000, Performance =   2.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008834 s, Result = 0a1cc000, Performance =   3.04 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010095 s, Result = 0a208000, Performance =   3.19 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011347 s, Result = 0a244000, Performance =   3.31 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012638 s, Result = 0a280000, Performance =   3.40 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013891 s, Result = 0a2bc000, Performance =   3.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015121 s, Result = 0a2f8000, Performance =   3.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016290 s, Result = 0a334000, Performance =   3.63 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017435 s, Result = 0a370000, Performance =   3.70 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018598 s, Result = 0a3ac000, Performance =   3.75 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019749 s, Result = 0a3e8000, Performance =   3.81 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020887 s, Result = 0a424000, Performance =   3.86 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021983 s, Result = 0a460000, Performance =   3.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023144 s, Result = 0a49c000, Performance =   3.94 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.025567 s, Result = 0a4d8000, Performance =   3.78 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.026669 s, Result = 0a514000, Performance =   3.82 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027599 s, Result = 0a550000, Performance =   3.89 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.029123 s, Result = 0a58c000, Performance =   3.87 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.030426 s, Result = 0a5c8000, Performance =   3.88 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.031736 s, Result = 0a604000, Performance =   3.89 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.033304 s, Result = 0a640000, Performance =   3.87 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.036176 s, Result = 0a67c000, Performance =   3.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.037038 s, Result = 0a6b8000, Performance =   3.77 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.038491 s, Result = 0a6f4000, Performance =   3.77 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.040326 s, Result = 0a730000, Performance =   3.73 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.040997 s, Result = 0a76c000, Performance =   3.80 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.042565 s, Result = 0a7a8000, Performance =   3.78 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.044348 s, Result = 0a7e4000, Performance =   3.75 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.045526 s, Result = 0a820000, Performance =   3.77 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.044767 s, Result = 0a85c000, Performance =   3.96 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.047056 s, Result = 0a898000, Performance =   3.88 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.048336 s, Result = 0a8d4000, Performance =   3.89 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.050658 s, Result = 0a910000, Performance =   3.82 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.051396 s, Result = 0a94c000, Performance =   3.86 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.054197 s, Result = 0a988000, Performance =   3.76 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.055488 s, Result = 0a9c4000, Performance =   3.77 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.057737 s, Result = 0aa00000, Performance =   3.72 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.058221 s, Result = 0aa3c000, Performance =   3.78 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.060633 s, Result = 0aa78000, Performance =   3.72 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.062435 s, Result = 0aab4000, Performance =   3.70 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.063942 s, Result = 0aaf0000, Performance =   3.69 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.066460 s, Result = 0ab2c000, Performance =   3.64 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.068092 s, Result = 0ab68000, Performance =   3.63 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.070495 s, Result = 0aba4000, Performance =   3.58 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.072186 s, Result = 0abe0000, Performance =   3.57 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.073891 s, Result = 0ac1c000, Performance =   3.56 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.076554 s, Result = 0ac58000, Performance =   3.51 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.078441 s, Result = 0ac94000, Performance =   3.49 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.079544 s, Result = 0acd0000, Performance =   3.51 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.082764 s, Result = 0ad0c000, Performance =   3.44 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.084032 s, Result = 0ad48000, Performance =   3.45 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.087461 s, Result = 0ad84000, Performance =   3.38 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.087944 s, Result = 0adc0000, Performance =   3.42 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.091307 s, Result = 0adfc000, Performance =   3.35 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.090778 s, Result = 0ae38000, Performance =   3.43 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.094317 s, Result = 0ae74000, Performance =   3.36 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.094552 s, Result = 0aeb0000, Performance =   3.41 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.096639 s, Result = 0aeec000, Performance =   3.39 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.097299 s, Result = 0af28000, Performance =   3.42 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.100194 s, Result = 0af64000, Performance =   3.38 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.098339 s, Result = 0afa0000, Performance =   3.49 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    83    56  1728
Test passed: M N K =    95   567   640
Test passed: M N K =  1967   145   704
Test passed: M N K =   429   960   320
Test passed: M N K =  1299  1573   512
M N K =  1024  1024   256, Elapsed time =   0.001187 s, Result = 0003c000, Performance =   4.52 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002449 s, Result = 00078000, Performance =   4.38 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003713 s, Result = 000b4000, Performance =   4.34 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005097 s, Result = 000f0000, Performance =   4.21 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006339 s, Result = 0012c000, Performance =   4.23 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007511 s, Result = 00168000, Performance =   4.29 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008375 s, Result = 001a4000, Performance =   4.49 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008952 s, Result = 001e0000, Performance =   4.80 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010185 s, Result = 0021c000, Performance =   4.74 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011107 s, Result = 00258000, Performance =   4.83 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011798 s, Result = 00294000, Performance =   5.01 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012994 s, Result = 002d0000, Performance =   4.96 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014301 s, Result = 0030c000, Performance =   4.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015553 s, Result = 00348000, Performance =   4.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016655 s, Result = 00384000, Performance =   4.84 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017876 s, Result = 003c0000, Performance =   4.81 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018769 s, Result = 003fc000, Performance =   4.86 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019875 s, Result = 00438000, Performance =   4.86 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020882 s, Result = 00474000, Performance =   4.88 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021932 s, Result = 004b0000, Performance =   4.90 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023112 s, Result = 004ec000, Performance =   4.88 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024277 s, Result = 00528000, Performance =   4.87 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025631 s, Result = 00564000, Performance =   4.82 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029526 s, Result = 005a0000, Performance =   4.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030439 s, Result = 005dc000, Performance =   4.41 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032155 s, Result = 00618000, Performance =   4.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033324 s, Result = 00654000, Performance =   4.35 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034845 s, Result = 00690000, Performance =   4.31 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.036818 s, Result = 006cc000, Performance =   4.23 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038104 s, Result = 00708000, Performance =   4.23 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040501 s, Result = 00744000, Performance =   4.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.041617 s, Result = 00780000, Performance =   4.13 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.040927 s, Result = 007bc000, Performance =   4.33 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.042416 s, Result = 007f8000, Performance =   4.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.043664 s, Result = 00834000, Performance =   4.30 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.045513 s, Result = 00870000, Performance =   4.25 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.056313 s, Result = 008ac000, Performance =   3.53 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.052707 s, Result = 008e8000, Performance =   3.87 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.048228 s, Result = 00924000, Performance =   4.34 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.053260 s, Result = 00960000, Performance =   4.03 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.057245 s, Result = 0099c000, Performance =   3.85 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.053071 s, Result = 009d8000, Performance =   4.25 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.061450 s, Result = 00a14000, Performance =   3.76 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.057866 s, Result = 00a50000, Performance =   4.08 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.059681 s, Result = 00a8c000, Performance =   4.05 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.061130 s, Result = 00ac8000, Performance =   4.04 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.064086 s, Result = 00b04000, Performance =   3.94 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.065181 s, Result = 00b40000, Performance =   3.95 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.067734 s, Result = 00b7c000, Performance =   3.88 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.070597 s, Result = 00bb8000, Performance =   3.80 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.070045 s, Result = 00bf4000, Performance =   3.91 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.072060 s, Result = 00c30000, Performance =   3.87 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.074315 s, Result = 00c6c000, Performance =   3.83 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.076744 s, Result = 00ca8000, Performance =   3.78 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.077541 s, Result = 00ce4000, Performance =   3.81 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.080531 s, Result = 00d20000, Performance =   3.73 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.082799 s, Result = 00d5c000, Performance =   3.70 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.084789 s, Result = 00d98000, Performance =   3.67 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.085929 s, Result = 00dd4000, Performance =   3.69 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.100872 s, Result = 00e10000, Performance =   3.19 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.102995 s, Result = 00e4c000, Performance =   3.18 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.101533 s, Result = 00e88000, Performance =   3.28 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.113875 s, Result = 00ec4000, Performance =   2.97 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.103941 s, Result = 00f00000, Performance =   3.31 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   385  1811  1920
Test passed: M N K =    14  1002  1600
Test passed: M N K =   786  1708   704
Test passed: M N K =    81  1094  1088
Test passed: M N K =  1513   268  1216
M N K =  1024  1024   256, Elapsed time =   0.006158 s, Result = 8d04c000, Performance =   0.87 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007094 s, Result = f9088000, Performance =   1.51 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007421 s, Result = 650c4000, Performance =   2.17 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008433 s, Result = d1100000, Performance =   2.55 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009497 s, Result = 3d13c000, Performance =   2.83 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010570 s, Result = a9178000, Performance =   3.05 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011675 s, Result = 151b4000, Performance =   3.22 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012771 s, Result = 811f0000, Performance =   3.36 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013887 s, Result = ed22c000, Performance =   3.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015029 s, Result = 59268000, Performance =   3.57 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016273 s, Result = c52a4000, Performance =   3.63 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017493 s, Result = 312e0000, Performance =   3.68 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018745 s, Result = 9d31c000, Performance =   3.72 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.020628 s, Result = 09358000, Performance =   3.64 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.021679 s, Result = 75394000, Performance =   3.71 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.022588 s, Result = e13d0000, Performance =   3.80 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.024600 s, Result = 4d40c000, Performance =   3.71 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023990 s, Result = b9448000, Performance =   4.03 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.025061 s, Result = 25484000, Performance =   4.07 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.027035 s, Result = 914c0000, Performance =   3.97 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.027385 s, Result = fd4fc000, Performance =   4.12 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.028855 s, Result = 69538000, Performance =   4.09 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029965 s, Result = d5574000, Performance =   4.12 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031240 s, Result = 415b0000, Performance =   4.12 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.032665 s, Result = ad5ec000, Performance =   4.11 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034233 s, Result = 19628000, Performance =   4.08 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.035576 s, Result = 85664000, Performance =   4.07 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.037362 s, Result = f16a0000, Performance =   4.02 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.064310 s, Result = 5d6dc000, Performance =   2.42 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.044223 s, Result = c9718000, Performance =   3.64 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.042213 s, Result = 35754000, Performance =   3.94 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.045785 s, Result = a1790000, Performance =   3.75 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.044578 s, Result = 0d7cc000, Performance =   3.97 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.044477 s, Result = 79808000, Performance =   4.10 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.046529 s, Result = e5844000, Performance =   4.04 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.067928 s, Result = 51880000, Performance =   2.85 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.050999 s, Result = bd8bc000, Performance =   3.90 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.052094 s, Result = 298f8000, Performance =   3.92 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.054690 s, Result = 95934000, Performance =   3.83 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.056180 s, Result = 01970000, Performance =   3.82 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.058154 s, Result = 6d9ac000, Performance =   3.79 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.058981 s, Result = d99e8000, Performance =   3.82 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.062249 s, Result = 45a24000, Performance =   3.71 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.062619 s, Result = b1a60000, Performance =   3.77 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.066334 s, Result = 1da9c000, Performance =   3.64 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.067216 s, Result = 89ad8000, Performance =   3.67 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.069161 s, Result = f5b14000, Performance =   3.65 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.071662 s, Result = 61b50000, Performance =   3.60 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.072801 s, Result = cdb8c000, Performance =   3.61 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.073989 s, Result = 39bc8000, Performance =   3.63 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.077146 s, Result = a5c04000, Performance =   3.55 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.077943 s, Result = 11c40000, Performance =   3.58 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.081327 s, Result = 7dc7c000, Performance =   3.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.082354 s, Result = e9cb8000, Performance =   3.52 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.085309 s, Result = 55cf4000, Performance =   3.46 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.085481 s, Result = c1d30000, Performance =   3.52 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.088770 s, Result = 2dd6c000, Performance =   3.45 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.089806 s, Result = 99da8000, Performance =   3.47 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.091728 s, Result = 05de4000, Performance =   3.45 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.093220 s, Result = 71e20000, Performance =   3.46 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.096954 s, Result = dde5c000, Performance =   3.38 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.098119 s, Result = 49e98000, Performance =   3.39 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.098728 s, Result = b5ed4000, Performance =   3.43 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.099143 s, Result = 21f10000, Performance =   3.47 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   990   744  1216
Test passed: M N K =   261  1754  1664
Test passed: M N K =    70  1383   896
Test passed: M N K =  1710   183  1920
Test passed: M N K =   871  1442   768
M N K =  1024  1024   256, Elapsed time =   0.003292 s, Result = 0003c000, Performance =   1.63 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003905 s, Result = 00078000, Performance =   2.75 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004950 s, Result = 000b4000, Performance =   3.25 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006068 s, Result = 000f0000, Performance =   3.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007131 s, Result = 0012c000, Performance =   3.76 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008359 s, Result = 00168000, Performance =   3.85 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009358 s, Result = 001a4000, Performance =   4.02 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010461 s, Result = 001e0000, Performance =   4.11 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011618 s, Result = 0021c000, Performance =   4.16 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012808 s, Result = 00258000, Performance =   4.19 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014255 s, Result = 00294000, Performance =   4.14 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016280 s, Result = 002d0000, Performance =   3.96 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017095 s, Result = 0030c000, Performance =   4.08 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017973 s, Result = 00348000, Performance =   4.18 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018928 s, Result = 00384000, Performance =   4.25 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019890 s, Result = 003c0000, Performance =   4.32 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021138 s, Result = 003fc000, Performance =   4.32 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022180 s, Result = 00438000, Performance =   4.36 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023468 s, Result = 00474000, Performance =   4.35 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025864 s, Result = 004b0000, Performance =   4.15 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026657 s, Result = 004ec000, Performance =   4.23 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.028060 s, Result = 00528000, Performance =   4.21 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029493 s, Result = 00564000, Performance =   4.19 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031129 s, Result = 005a0000, Performance =   4.14 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.032369 s, Result = 005dc000, Performance =   4.15 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.033808 s, Result = 00618000, Performance =   4.13 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.035455 s, Result = 00654000, Performance =   4.09 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.036023 s, Result = 00690000, Performance =   4.17 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037452 s, Result = 006cc000, Performance =   4.16 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.039079 s, Result = 00708000, Performance =   4.12 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040387 s, Result = 00744000, Performance =   4.12 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.042387 s, Result = 00780000, Performance =   4.05 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.042632 s, Result = 007bc000, Performance =   4.16 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.043135 s, Result = 007f8000, Performance =   4.23 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.044808 s, Result = 00834000, Performance =   4.19 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.046295 s, Result = 00870000, Performance =   4.17 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.048074 s, Result = 008ac000, Performance =   4.13 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.049181 s, Result = 008e8000, Performance =   4.15 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.051666 s, Result = 00924000, Performance =   4.05 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.052421 s, Result = 00960000, Performance =   4.10 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.055275 s, Result = 0099c000, Performance =   3.98 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.056103 s, Result = 009d8000, Performance =   4.02 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.058542 s, Result = 00a14000, Performance =   3.94 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.059705 s, Result = 00a50000, Performance =   3.96 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.061554 s, Result = 00a8c000, Performance =   3.92 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.063453 s, Result = 00ac8000, Performance =   3.89 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.065777 s, Result = 00b04000, Performance =   3.84 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.067242 s, Result = 00b40000, Performance =   3.83 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.069051 s, Result = 00b7c000, Performance =   3.81 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.070468 s, Result = 00bb8000, Performance =   3.81 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.072588 s, Result = 00bf4000, Performance =   3.77 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.074514 s, Result = 00c30000, Performance =   3.75 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076853 s, Result = 00c6c000, Performance =   3.70 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078011 s, Result = 00ca8000, Performance =   3.72 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.079925 s, Result = 00ce4000, Performance =   3.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.082114 s, Result = 00d20000, Performance =   3.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.083656 s, Result = 00d5c000, Performance =   3.66 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.085881 s, Result = 00d98000, Performance =   3.63 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.087129 s, Result = 00dd4000, Performance =   3.64 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.089088 s, Result = 00e10000, Performance =   3.62 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.091576 s, Result = 00e4c000, Performance =   3.58 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.093700 s, Result = 00e88000, Performance =   3.55 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.093235 s, Result = 00ec4000, Performance =   3.63 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.094836 s, Result = 00f00000, Performance =   3.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   709    45  1216
Test passed: M N K =  1437   618   896
Test passed: M N K =  1746   165  1408
Test passed: M N K =  1150   608  1088
Test passed: M N K =  2004   971  1024
M N K =  1024  1024   256, Elapsed time =   0.005509 s, Result = 0a0dc000, Performance =   0.97 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006833 s, Result = 0a118000, Performance =   1.57 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006817 s, Result = 0a154000, Performance =   2.36 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007742 s, Result = 0a190000, Performance =   2.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008811 s, Result = 0a1cc000, Performance =   3.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009865 s, Result = 0a208000, Performance =   3.27 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011029 s, Result = 0a244000, Performance =   3.41 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012175 s, Result = 0a280000, Performance =   3.53 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013463 s, Result = 0a2bc000, Performance =   3.59 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014834 s, Result = 0a2f8000, Performance =   3.62 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016098 s, Result = 0a334000, Performance =   3.67 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017270 s, Result = 0a370000, Performance =   3.73 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018516 s, Result = 0a3ac000, Performance =   3.77 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019650 s, Result = 0a3e8000, Performance =   3.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020913 s, Result = 0a424000, Performance =   3.85 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021892 s, Result = 0a460000, Performance =   3.92 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.023142 s, Result = 0a49c000, Performance =   3.94 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.024547 s, Result = 0a4d8000, Performance =   3.94 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.025653 s, Result = 0a514000, Performance =   3.98 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.026814 s, Result = 0a550000, Performance =   4.00 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.028627 s, Result = 0a58c000, Performance =   3.94 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.030082 s, Result = 0a5c8000, Performance =   3.93 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030805 s, Result = 0a604000, Performance =   4.01 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031866 s, Result = 0a640000, Performance =   4.04 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.033359 s, Result = 0a67c000, Performance =   4.02 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034975 s, Result = 0a6b8000, Performance =   3.99 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.036355 s, Result = 0a6f4000, Performance =   3.99 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.038135 s, Result = 0a730000, Performance =   3.94 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.039446 s, Result = 0a76c000, Performance =   3.95 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.040386 s, Result = 0a7a8000, Performance =   3.99 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.041940 s, Result = 0a7e4000, Performance =   3.97 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.043453 s, Result = 0a820000, Performance =   3.95 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.044100 s, Result = 0a85c000, Performance =   4.02 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.044599 s, Result = 0a898000, Performance =   4.09 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.045825 s, Result = 0a8d4000, Performance =   4.10 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.047370 s, Result = 0a910000, Performance =   4.08 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.048832 s, Result = 0a94c000, Performance =   4.07 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.050376 s, Result = 0a988000, Performance =   4.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.052340 s, Result = 0a9c4000, Performance =   4.00 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.053538 s, Result = 0aa00000, Performance =   4.01 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.055315 s, Result = 0aa3c000, Performance =   3.98 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.057008 s, Result = 0aa78000, Performance =   3.96 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.058363 s, Result = 0aab4000, Performance =   3.96 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.060712 s, Result = 0aaf0000, Performance =   3.89 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.062122 s, Result = 0ab2c000, Performance =   3.89 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.064396 s, Result = 0ab68000, Performance =   3.84 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.065775 s, Result = 0aba4000, Performance =   3.84 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.067938 s, Result = 0abe0000, Performance =   3.79 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.068686 s, Result = 0ac1c000, Performance =   3.83 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.070753 s, Result = 0ac58000, Performance =   3.79 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.073415 s, Result = 0ac94000, Performance =   3.73 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.073981 s, Result = 0acd0000, Performance =   3.77 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076824 s, Result = 0ad0c000, Performance =   3.70 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078654 s, Result = 0ad48000, Performance =   3.69 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.079988 s, Result = 0ad84000, Performance =   3.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.081696 s, Result = 0adc0000, Performance =   3.68 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.083848 s, Result = 0adfc000, Performance =   3.65 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.084734 s, Result = 0ae38000, Performance =   3.67 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.087345 s, Result = 0ae74000, Performance =   3.63 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.088938 s, Result = 0aeb0000, Performance =   3.62 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.092035 s, Result = 0aeec000, Performance =   3.56 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.093076 s, Result = 0af28000, Performance =   3.58 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.093775 s, Result = 0af64000, Performance =   3.61 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.095046 s, Result = 0afa0000, Performance =   3.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1938  1562  1024
Test passed: M N K =   424   813  1728
Test passed: M N K =    92   807  1856
Test passed: M N K =   525   403   768
Test passed: M N K =  1177   326   320
M N K =  1024  1024   256, Elapsed time =   0.001183 s, Result = 0003c000, Performance =   4.54 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002500 s, Result = 00078000, Performance =   4.30 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003909 s, Result = 000b4000, Performance =   4.12 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005224 s, Result = 000f0000, Performance =   4.11 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006398 s, Result = 0012c000, Performance =   4.20 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007784 s, Result = 00168000, Performance =   4.14 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009192 s, Result = 001a4000, Performance =   4.09 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010433 s, Result = 001e0000, Performance =   4.12 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011837 s, Result = 0021c000, Performance =   4.08 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012922 s, Result = 00258000, Performance =   4.15 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014269 s, Result = 00294000, Performance =   4.14 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015360 s, Result = 002d0000, Performance =   4.19 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016763 s, Result = 0030c000, Performance =   4.16 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017409 s, Result = 00348000, Performance =   4.32 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017226 s, Result = 00384000, Performance =   4.67 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017644 s, Result = 003c0000, Performance =   4.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018828 s, Result = 003fc000, Performance =   4.85 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019997 s, Result = 00438000, Performance =   4.83 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021111 s, Result = 00474000, Performance =   4.83 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022444 s, Result = 004b0000, Performance =   4.78 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023530 s, Result = 004ec000, Performance =   4.79 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024999 s, Result = 00528000, Performance =   4.72 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025957 s, Result = 00564000, Performance =   4.76 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027575 s, Result = 005a0000, Performance =   4.67 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.029285 s, Result = 005dc000, Performance =   4.58 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030927 s, Result = 00618000, Performance =   4.51 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.032152 s, Result = 00654000, Performance =   4.51 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033745 s, Result = 00690000, Performance =   4.45 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035036 s, Result = 006cc000, Performance =   4.44 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036570 s, Result = 00708000, Performance =   4.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.037648 s, Result = 00744000, Performance =   4.42 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039474 s, Result = 00780000, Performance =   4.35 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039948 s, Result = 007bc000, Performance =   4.43 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040530 s, Result = 007f8000, Performance =   4.50 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.042074 s, Result = 00834000, Performance =   4.47 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.043429 s, Result = 00870000, Performance =   4.45 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.044869 s, Result = 008ac000, Performance =   4.43 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.046285 s, Result = 008e8000, Performance =   4.41 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.047938 s, Result = 00924000, Performance =   4.37 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.049090 s, Result = 00960000, Performance =   4.37 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.051088 s, Result = 0099c000, Performance =   4.31 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.052422 s, Result = 009d8000, Performance =   4.30 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.053866 s, Result = 00a14000, Performance =   4.29 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.056968 s, Result = 00a50000, Performance =   4.15 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.058242 s, Result = 00a8c000, Performance =   4.15 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.060529 s, Result = 00ac8000, Performance =   4.08 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.059991 s, Result = 00b04000, Performance =   4.21 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.061754 s, Result = 00b40000, Performance =   4.17 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.062979 s, Result = 00b7c000, Performance =   4.18 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.065684 s, Result = 00bb8000, Performance =   4.09 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.066760 s, Result = 00bf4000, Performance =   4.10 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.069464 s, Result = 00c30000, Performance =   4.02 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.070253 s, Result = 00c6c000, Performance =   4.05 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.072714 s, Result = 00ca8000, Performance =   3.99 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.073942 s, Result = 00ce4000, Performance =   3.99 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.076373 s, Result = 00d20000, Performance =   3.94 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.077318 s, Result = 00d5c000, Performance =   3.96 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.079225 s, Result = 00d98000, Performance =   3.93 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.080889 s, Result = 00dd4000, Performance =   3.92 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.082568 s, Result = 00e10000, Performance =   3.90 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.085310 s, Result = 00e4c000, Performance =   3.84 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.087352 s, Result = 00e88000, Performance =   3.81 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.088532 s, Result = 00ec4000, Performance =   3.82 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.089163 s, Result = 00f00000, Performance =   3.85 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1187   149  2048
Test passed: M N K =   725  2024  1920
Test passed: M N K =    69   535  1088
Test passed: M N K =  1822  1686  1920
Test passed: M N K =  1616   514   192
M N K =  1024  1024   256, Elapsed time =   0.005442 s, Result = 8d04c000, Performance =   0.99 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006345 s, Result = f9088000, Performance =   1.69 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007350 s, Result = 650c4000, Performance =   2.19 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008383 s, Result = d1100000, Performance =   2.56 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009548 s, Result = 3d13c000, Performance =   2.81 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010602 s, Result = a9178000, Performance =   3.04 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011690 s, Result = 151b4000, Performance =   3.21 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012700 s, Result = 811f0000, Performance =   3.38 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013894 s, Result = ed22c000, Performance =   3.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015134 s, Result = 59268000, Performance =   3.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016297 s, Result = c52a4000, Performance =   3.62 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017371 s, Result = 312e0000, Performance =   3.71 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018490 s, Result = 9d31c000, Performance =   3.77 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019607 s, Result = 09358000, Performance =   3.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020686 s, Result = 75394000, Performance =   3.89 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021692 s, Result = e13d0000, Performance =   3.96 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.022853 s, Result = 4d40c000, Performance =   3.99 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023906 s, Result = b9448000, Performance =   4.04 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.025154 s, Result = 25484000, Performance =   4.06 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.026291 s, Result = 914c0000, Performance =   4.08 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.027662 s, Result = fd4fc000, Performance =   4.08 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.029113 s, Result = 69538000, Performance =   4.06 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030462 s, Result = d5574000, Performance =   4.05 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031810 s, Result = 415b0000, Performance =   4.05 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.033371 s, Result = ad5ec000, Performance =   4.02 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.034917 s, Result = 19628000, Performance =   4.00 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.036375 s, Result = 85664000, Performance =   3.98 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.037635 s, Result = f16a0000, Performance =   3.99 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.039068 s, Result = 5d6dc000, Performance =   3.99 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.040501 s, Result = c9718000, Performance =   3.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.041748 s, Result = 35754000, Performance =   3.99 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.043298 s, Result = a1790000, Performance =   3.97 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.044627 s, Result = 0d7cc000, Performance =   3.97 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.046116 s, Result = 79808000, Performance =   3.96 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.047098 s, Result = e5844000, Performance =   3.99 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.048152 s, Result = 51880000, Performance =   4.01 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.049815 s, Result = bd8bc000, Performance =   3.99 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.051538 s, Result = 298f8000, Performance =   3.96 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.053096 s, Result = 95934000, Performance =   3.94 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.055016 s, Result = 01970000, Performance =   3.90 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.055695 s, Result = 6d9ac000, Performance =   3.95 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.057292 s, Result = d99e8000, Performance =   3.94 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.058913 s, Result = 45a24000, Performance =   3.92 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.060527 s, Result = b1a60000, Performance =   3.90 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.062723 s, Result = 1da9c000, Performance =   3.85 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.063888 s, Result = 89ad8000, Performance =   3.87 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.066122 s, Result = f5b14000, Performance =   3.82 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.067140 s, Result = 61b50000, Performance =   3.84 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.069719 s, Result = cdb8c000, Performance =   3.77 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.070655 s, Result = 39bc8000, Performance =   3.80 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.073431 s, Result = a5c04000, Performance =   3.73 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.074354 s, Result = 11c40000, Performance =   3.75 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.076688 s, Result = 7dc7c000, Performance =   3.71 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.078317 s, Result = e9cb8000, Performance =   3.70 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.080090 s, Result = 55cf4000, Performance =   3.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.081244 s, Result = c1d30000, Performance =   3.70 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.082829 s, Result = 2dd6c000, Performance =   3.69 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.086557 s, Result = 99da8000, Performance =   3.60 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.085726 s, Result = 05de4000, Performance =   3.69 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.089505 s, Result = 71e20000, Performance =   3.60 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.089987 s, Result = dde5c000, Performance =   3.64 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.091803 s, Result = 49e98000, Performance =   3.63 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.093779 s, Result = b5ed4000, Performance =   3.61 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.096373 s, Result = 21f10000, Performance =   3.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1939   555  1792
Test passed: M N K =  1082  1499  1728
Test passed: M N K =  1111  1084  1152
Test passed: M N K =  1753  1393  1856
Test passed: M N K =  1486  1690  1216
M N K =  1024  1024   256, Elapsed time =   0.003259 s, Result = 0003c000, Performance =   1.65 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003971 s, Result = 00078000, Performance =   2.70 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004968 s, Result = 000b4000, Performance =   3.24 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006002 s, Result = 000f0000, Performance =   3.58 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007132 s, Result = 0012c000, Performance =   3.76 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008265 s, Result = 00168000, Performance =   3.90 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009320 s, Result = 001a4000, Performance =   4.03 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010440 s, Result = 001e0000, Performance =   4.11 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011616 s, Result = 0021c000, Performance =   4.16 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012801 s, Result = 00258000, Performance =   4.19 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014250 s, Result = 00294000, Performance =   4.14 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015346 s, Result = 002d0000, Performance =   4.20 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016643 s, Result = 0030c000, Performance =   4.19 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017763 s, Result = 00348000, Performance =   4.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018873 s, Result = 00384000, Performance =   4.27 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019946 s, Result = 003c0000, Performance =   4.31 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021044 s, Result = 003fc000, Performance =   4.34 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022050 s, Result = 00438000, Performance =   4.38 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023162 s, Result = 00474000, Performance =   4.40 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024479 s, Result = 004b0000, Performance =   4.39 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.025471 s, Result = 004ec000, Performance =   4.43 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.026607 s, Result = 00528000, Performance =   4.44 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027968 s, Result = 00564000, Performance =   4.42 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029408 s, Result = 005a0000, Performance =   4.38 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.031085 s, Result = 005dc000, Performance =   4.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032445 s, Result = 00618000, Performance =   4.30 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033944 s, Result = 00654000, Performance =   4.27 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035305 s, Result = 00690000, Performance =   4.26 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037265 s, Result = 006cc000, Performance =   4.18 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038428 s, Result = 00708000, Performance =   4.19 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.041091 s, Result = 00744000, Performance =   4.05 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.041384 s, Result = 00780000, Performance =   4.15 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.042001 s, Result = 007bc000, Performance =   4.22 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.043622 s, Result = 007f8000, Performance =   4.18 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.044557 s, Result = 00834000, Performance =   4.22 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.045445 s, Result = 00870000, Performance =   4.25 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.047332 s, Result = 008ac000, Performance =   4.20 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.050385 s, Result = 008e8000, Performance =   4.05 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.047019 s, Result = 00924000, Performance =   4.45 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.058341 s, Result = 00960000, Performance =   3.68 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.054594 s, Result = 0099c000, Performance =   4.03 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.056541 s, Result = 009d8000, Performance =   3.99 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.057847 s, Result = 00a14000, Performance =   3.99 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.059129 s, Result = 00a50000, Performance =   4.00 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.063080 s, Result = 00a8c000, Performance =   3.83 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.062406 s, Result = 00ac8000, Performance =   3.96 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.064848 s, Result = 00b04000, Performance =   3.89 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.064769 s, Result = 00b40000, Performance =   3.98 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.066350 s, Result = 00b7c000, Performance =   3.96 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.068000 s, Result = 00bb8000, Performance =   3.95 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.069340 s, Result = 00bf4000, Performance =   3.95 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.070957 s, Result = 00c30000, Performance =   3.93 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.073072 s, Result = 00c6c000, Performance =   3.89 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.075006 s, Result = 00ca8000, Performance =   3.87 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.077239 s, Result = 00ce4000, Performance =   3.82 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.078648 s, Result = 00d20000, Performance =   3.82 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.079713 s, Result = 00d5c000, Performance =   3.84 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.082993 s, Result = 00d98000, Performance =   3.75 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.083974 s, Result = 00dd4000, Performance =   3.77 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.086914 s, Result = 00e10000, Performance =   3.71 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.086272 s, Result = 00e4c000, Performance =   3.80 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.090349 s, Result = 00e88000, Performance =   3.68 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.091110 s, Result = 00ec4000, Performance =   3.71 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.093801 s, Result = 00f00000, Performance =   3.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   468   446    64
Test passed: M N K =   276  1913  1408
Test passed: M N K =   530   265  1600
Test passed: M N K =  1552  1318  1664
Test passed: M N K =  1548   418  1600
M N K =  1024  1024   256, Elapsed time =   0.005130 s, Result = 0a0dc000, Performance =   1.05 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005930 s, Result = 0a118000, Performance =   1.81 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006668 s, Result = 0a154000, Performance =   2.42 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007692 s, Result = 0a190000, Performance =   2.79 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008856 s, Result = 0a1cc000, Performance =   3.03 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009947 s, Result = 0a208000, Performance =   3.24 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011059 s, Result = 0a244000, Performance =   3.40 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012248 s, Result = 0a280000, Performance =   3.51 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013575 s, Result = 0a2bc000, Performance =   3.56 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014909 s, Result = 0a2f8000, Performance =   3.60 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016143 s, Result = 0a334000, Performance =   3.66 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.017215 s, Result = 0a370000, Performance =   3.74 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.018396 s, Result = 0a3ac000, Performance =   3.79 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019416 s, Result = 0a3e8000, Performance =   3.87 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020513 s, Result = 0a424000, Performance =   3.93 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021484 s, Result = 0a460000, Performance =   4.00 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.022481 s, Result = 0a49c000, Performance =   4.06 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.023529 s, Result = 0a4d8000, Performance =   4.11 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.024595 s, Result = 0a514000, Performance =   4.15 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.025763 s, Result = 0a550000, Performance =   4.17 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026922 s, Result = 0a58c000, Performance =   4.19 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.028216 s, Result = 0a5c8000, Performance =   4.19 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.029402 s, Result = 0a604000, Performance =   4.20 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.031470 s, Result = 0a640000, Performance =   4.09 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.032245 s, Result = 0a67c000, Performance =   4.16 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.033360 s, Result = 0a6b8000, Performance =   4.18 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.034963 s, Result = 0a6f4000, Performance =   4.15 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.036275 s, Result = 0a730000, Performance =   4.14 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037745 s, Result = 0a76c000, Performance =   4.12 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.039063 s, Result = 0a7a8000, Performance =   4.12 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040479 s, Result = 0a7e4000, Performance =   4.11 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.045385 s, Result = 0a820000, Performance =   3.79 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.046571 s, Result = 0a85c000, Performance =   3.80 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.048296 s, Result = 0a898000, Performance =   3.78 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.048385 s, Result = 0a8d4000, Performance =   3.88 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.045916 s, Result = 0a910000, Performance =   4.21 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.047466 s, Result = 0a94c000, Performance =   4.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.048801 s, Result = 0a988000, Performance =   4.18 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.050740 s, Result = 0a9c4000, Performance =   4.13 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.051827 s, Result = 0aa00000, Performance =   4.14 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.053468 s, Result = 0aa3c000, Performance =   4.12 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.054838 s, Result = 0aa78000, Performance =   4.11 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.057097 s, Result = 0aab4000, Performance =   4.04 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.058384 s, Result = 0aaf0000, Performance =   4.05 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.060807 s, Result = 0ab2c000, Performance =   3.97 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.061685 s, Result = 0ab68000, Performance =   4.00 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.063910 s, Result = 0aba4000, Performance =   3.95 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.065599 s, Result = 0abe0000, Performance =   3.93 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.066578 s, Result = 0ac1c000, Performance =   3.95 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.068700 s, Result = 0ac58000, Performance =   3.91 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.070586 s, Result = 0ac94000, Performance =   3.88 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.071801 s, Result = 0acd0000, Performance =   3.89 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.074163 s, Result = 0ad0c000, Performance =   3.84 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.075262 s, Result = 0ad48000, Performance =   3.85 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.079062 s, Result = 0ad84000, Performance =   3.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.078702 s, Result = 0adc0000, Performance =   3.82 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.080902 s, Result = 0adfc000, Performance =   3.78 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.084267 s, Result = 0ae38000, Performance =   3.70 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.085069 s, Result = 0ae74000, Performance =   3.72 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.087245 s, Result = 0aeb0000, Performance =   3.69 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.088244 s, Result = 0aeec000, Performance =   3.71 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.089363 s, Result = 0af28000, Performance =   3.72 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.092018 s, Result = 0af64000, Performance =   3.68 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.093782 s, Result = 0afa0000, Performance =   3.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   207  2005   320
Test passed: M N K =  1913  1748   448
Test passed: M N K =   203   454    64
Test passed: M N K =  1095   723  1280
Test passed: M N K =   811   257  1088
M N K =  1024  1024   256, Elapsed time =   0.001177 s, Result = 0003c000, Performance =   4.56 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002516 s, Result = 00078000, Performance =   4.27 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003607 s, Result = 000b4000, Performance =   4.46 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004581 s, Result = 000f0000, Performance =   4.69 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005918 s, Result = 0012c000, Performance =   4.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006783 s, Result = 00168000, Performance =   4.75 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007620 s, Result = 001a4000, Performance =   4.93 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008251 s, Result = 001e0000, Performance =   5.21 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009228 s, Result = 0021c000, Performance =   5.24 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010287 s, Result = 00258000, Performance =   5.22 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011353 s, Result = 00294000, Performance =   5.20 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012403 s, Result = 002d0000, Performance =   5.19 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013627 s, Result = 0030c000, Performance =   5.12 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014813 s, Result = 00348000, Performance =   5.07 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015924 s, Result = 00384000, Performance =   5.06 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017022 s, Result = 003c0000, Performance =   5.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018220 s, Result = 003fc000, Performance =   5.01 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019226 s, Result = 00438000, Performance =   5.03 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020350 s, Result = 00474000, Performance =   5.01 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021329 s, Result = 004b0000, Performance =   5.03 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022347 s, Result = 004ec000, Performance =   5.05 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023372 s, Result = 00528000, Performance =   5.05 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024491 s, Result = 00564000, Performance =   5.04 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025560 s, Result = 005a0000, Performance =   5.04 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026814 s, Result = 005dc000, Performance =   5.01 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028025 s, Result = 00618000, Performance =   4.98 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029366 s, Result = 00654000, Performance =   4.94 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.030747 s, Result = 00690000, Performance =   4.89 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.032472 s, Result = 006cc000, Performance =   4.79 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.033981 s, Result = 00708000, Performance =   4.74 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.035278 s, Result = 00744000, Performance =   4.72 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036725 s, Result = 00780000, Performance =   4.68 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038236 s, Result = 007bc000, Performance =   4.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039576 s, Result = 007f8000, Performance =   4.61 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040671 s, Result = 00834000, Performance =   4.62 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041634 s, Result = 00870000, Performance =   4.64 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043162 s, Result = 008ac000, Performance =   4.60 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044359 s, Result = 008e8000, Performance =   4.60 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.045617 s, Result = 00924000, Performance =   4.59 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046958 s, Result = 00960000, Performance =   4.57 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.048396 s, Result = 0099c000, Performance =   4.55 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.049778 s, Result = 009d8000, Performance =   4.53 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050992 s, Result = 00a14000, Performance =   4.53 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.053933 s, Result = 00a50000, Performance =   4.38 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.054015 s, Result = 00a8c000, Performance =   4.47 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.055666 s, Result = 00ac8000, Performance =   4.44 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.057471 s, Result = 00b04000, Performance =   4.39 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.058585 s, Result = 00b40000, Performance =   4.40 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.060248 s, Result = 00b7c000, Performance =   4.37 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.062928 s, Result = 00bb8000, Performance =   4.27 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.063752 s, Result = 00bf4000, Performance =   4.29 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.066237 s, Result = 00c30000, Performance =   4.21 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.068024 s, Result = 00c6c000, Performance =   4.18 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.069175 s, Result = 00ca8000, Performance =   4.19 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.070930 s, Result = 00ce4000, Performance =   4.16 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.073229 s, Result = 00d20000, Performance =   4.11 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.074212 s, Result = 00d5c000, Performance =   4.12 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.078537 s, Result = 00d98000, Performance =   3.96 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.078372 s, Result = 00dd4000, Performance =   4.04 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.081036 s, Result = 00e10000, Performance =   3.98 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.081958 s, Result = 00e4c000, Performance =   4.00 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.083595 s, Result = 00e88000, Performance =   3.98 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.085062 s, Result = 00ec4000, Performance =   3.98 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.087249 s, Result = 00f00000, Performance =   3.94 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1635  1147  1856
Test passed: M N K =  1699  1594  1216
Test passed: M N K =    11  1033   640
Test passed: M N K =   845    24  1408
Test passed: M N K =   841   112  1600
M N K =  1024  1024   256, Elapsed time =   0.005315 s, Result = d1038000, Performance =   1.01 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005672 s, Result = 61060000, Performance =   1.89 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006397 s, Result = f1088000, Performance =   2.52 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007124 s, Result = 810b0000, Performance =   3.01 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007868 s, Result = 110d8000, Performance =   3.41 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008661 s, Result = a1100000, Performance =   3.72 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009461 s, Result = 31128000, Performance =   3.97 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010286 s, Result = c1150000, Performance =   4.18 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011164 s, Result = 51178000, Performance =   4.33 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012003 s, Result = e11a0000, Performance =   4.47 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012972 s, Result = 711c8000, Performance =   4.55 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013992 s, Result = 011f0000, Performance =   4.60 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015151 s, Result = 91218000, Performance =   4.61 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016283 s, Result = 21240000, Performance =   4.62 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017229 s, Result = b1268000, Performance =   4.67 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018156 s, Result = 41290000, Performance =   4.73 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018798 s, Result = d12b8000, Performance =   4.86 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019745 s, Result = 612e0000, Performance =   4.89 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020564 s, Result = f1308000, Performance =   4.96 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021404 s, Result = 81330000, Performance =   5.02 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022187 s, Result = 11358000, Performance =   5.08 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023016 s, Result = a1380000, Performance =   5.13 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024177 s, Result = 313a8000, Performance =   5.11 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025478 s, Result = c13d0000, Performance =   5.06 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026572 s, Result = 513f8000, Performance =   5.05 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028230 s, Result = e1420000, Performance =   4.94 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029582 s, Result = 71448000, Performance =   4.90 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031163 s, Result = 01470000, Performance =   4.82 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.032614 s, Result = 91498000, Performance =   4.77 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034001 s, Result = 214c0000, Performance =   4.74 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.035625 s, Result = b14e8000, Performance =   4.67 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036626 s, Result = 41510000, Performance =   4.69 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.036052 s, Result = d1538000, Performance =   4.91 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.037520 s, Result = 61560000, Performance =   4.87 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039367 s, Result = f1588000, Performance =   4.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.039844 s, Result = 815b0000, Performance =   4.85 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041286 s, Result = 115d8000, Performance =   4.81 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042102 s, Result = a1600000, Performance =   4.85 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043538 s, Result = 31628000, Performance =   4.81 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044833 s, Result = c1650000, Performance =   4.79 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.046713 s, Result = 51678000, Performance =   4.71 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.047546 s, Result = e16a0000, Performance =   4.74 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.049565 s, Result = 716c8000, Performance =   4.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.050755 s, Result = 016f0000, Performance =   4.65 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.052217 s, Result = 91718000, Performance =   4.63 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053498 s, Result = 21740000, Performance =   4.62 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.054646 s, Result = b1768000, Performance =   4.62 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.056431 s, Result = 41790000, Performance =   4.57 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058100 s, Result = d17b8000, Performance =   4.53 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.061756 s, Result = 617e0000, Performance =   4.35 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.062674 s, Result = f1808000, Performance =   4.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.064725 s, Result = 81830000, Performance =   4.31 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.066605 s, Result = 11858000, Performance =   4.27 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.067720 s, Result = a1880000, Performance =   4.28 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.068915 s, Result = 318a8000, Performance =   4.28 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.067954 s, Result = c18d0000, Performance =   4.42 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068579 s, Result = 518f8000, Performance =   4.46 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.070429 s, Result = e1920000, Performance =   4.42 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.071948 s, Result = 71948000, Performance =   4.40 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.073128 s, Result = 01970000, Performance =   4.40 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.074628 s, Result = 91998000, Performance =   4.39 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.074426 s, Result = 219c0000, Performance =   4.47 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.077007 s, Result = b19e8000, Performance =   4.39 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.075401 s, Result = 41a10000, Performance =   4.56 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1470    43  1280
Test passed: M N K =  1309   425   512
Test passed: M N K =  1650   448   320
Test passed: M N K =   419  1915  1344
Test passed: M N K =   625  1450   512
M N K =  1024  1024   256, Elapsed time =   0.004691 s, Result = 00028000, Performance =   1.14 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005750 s, Result = 00050000, Performance =   1.87 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006274 s, Result = 00078000, Performance =   2.57 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006672 s, Result = 000a0000, Performance =   3.22 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006875 s, Result = 000c8000, Performance =   3.90 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006628 s, Result = 000f0000, Performance =   4.86 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006892 s, Result = 00118000, Performance =   5.45 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007674 s, Result = 00140000, Performance =   5.60 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010018 s, Result = 00168000, Performance =   4.82 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011238 s, Result = 00190000, Performance =   4.78 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012269 s, Result = 001b8000, Performance =   4.81 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013192 s, Result = 001e0000, Performance =   4.88 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013938 s, Result = 00208000, Performance =   5.01 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014834 s, Result = 00230000, Performance =   5.07 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015531 s, Result = 00258000, Performance =   5.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016419 s, Result = 00280000, Performance =   5.23 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016823 s, Result = 002a8000, Performance =   5.43 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017737 s, Result = 002d0000, Performance =   5.45 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018275 s, Result = 002f8000, Performance =   5.58 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018911 s, Result = 00320000, Performance =   5.68 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019902 s, Result = 00348000, Performance =   5.67 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020731 s, Result = 00370000, Performance =   5.70 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021847 s, Result = 00398000, Performance =   5.65 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023047 s, Result = 003c0000, Performance =   5.59 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024468 s, Result = 003e8000, Performance =   5.49 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025455 s, Result = 00410000, Performance =   5.48 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027088 s, Result = 00438000, Performance =   5.35 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.028483 s, Result = 00460000, Performance =   5.28 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029873 s, Result = 00488000, Performance =   5.21 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031549 s, Result = 004b0000, Performance =   5.11 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032966 s, Result = 004d8000, Performance =   5.05 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034132 s, Result = 00500000, Performance =   5.03 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033343 s, Result = 00528000, Performance =   5.31 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034555 s, Result = 00550000, Performance =   5.28 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035754 s, Result = 00578000, Performance =   5.26 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037255 s, Result = 005a0000, Performance =   5.19 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.038162 s, Result = 005c8000, Performance =   5.21 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.039966 s, Result = 005f0000, Performance =   5.10 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.040643 s, Result = 00618000, Performance =   5.15 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.042384 s, Result = 00640000, Performance =   5.07 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.043461 s, Result = 00668000, Performance =   5.06 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.045014 s, Result = 00690000, Performance =   5.01 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.045547 s, Result = 006b8000, Performance =   5.07 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.047309 s, Result = 006e0000, Performance =   4.99 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049525 s, Result = 00708000, Performance =   4.88 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.050824 s, Result = 00730000, Performance =   4.86 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.051527 s, Result = 00758000, Performance =   4.90 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.055336 s, Result = 00780000, Performance =   4.66 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054307 s, Result = 007a8000, Performance =   4.84 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057872 s, Result = 007d0000, Performance =   4.64 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.059515 s, Result = 007f8000, Performance =   4.60 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.061986 s, Result = 00820000, Performance =   4.50 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.063197 s, Result = 00848000, Performance =   4.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.063517 s, Result = 00870000, Performance =   4.56 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.065012 s, Result = 00898000, Performance =   4.54 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.066477 s, Result = 008c0000, Performance =   4.52 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.065772 s, Result = 008e8000, Performance =   4.65 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066277 s, Result = 00910000, Performance =   4.70 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.067670 s, Result = 00938000, Performance =   4.68 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.069237 s, Result = 00960000, Performance =   4.65 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.072152 s, Result = 00988000, Performance =   4.54 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.071235 s, Result = 009b0000, Performance =   4.67 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073474 s, Result = 009d8000, Performance =   4.60 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.072109 s, Result = 00a00000, Performance =   4.76 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1742  1175  1344
Test passed: M N K =  1566  1174  1536
Test passed: M N K =  1648   876  1280
Test passed: M N K =  1973  1441  1664
Test passed: M N K =   916   194   960
M N K =  1024  1024   256, Elapsed time =   0.005321 s, Result = 0a0c8000, Performance =   1.01 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007100 s, Result = 0a0f0000, Performance =   1.51 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007863 s, Result = 0a118000, Performance =   2.05 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008885 s, Result = 0a140000, Performance =   2.42 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009934 s, Result = 0a168000, Performance =   2.70 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010885 s, Result = 0a190000, Performance =   2.96 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011903 s, Result = 0a1b8000, Performance =   3.16 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012949 s, Result = 0a1e0000, Performance =   3.32 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.014441 s, Result = 0a208000, Performance =   3.35 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015790 s, Result = 0a230000, Performance =   3.40 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.017259 s, Result = 0a258000, Performance =   3.42 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.018356 s, Result = 0a280000, Performance =   3.51 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.019750 s, Result = 0a2a8000, Performance =   3.53 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.020607 s, Result = 0a2d0000, Performance =   3.65 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020796 s, Result = 0a2f8000, Performance =   3.87 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020458 s, Result = 0a320000, Performance =   4.20 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.019052 s, Result = 0a348000, Performance =   4.79 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019677 s, Result = 0a370000, Performance =   4.91 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020533 s, Result = 0a398000, Performance =   4.97 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021579 s, Result = 0a3c0000, Performance =   4.98 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022650 s, Result = 0a3e8000, Performance =   4.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023690 s, Result = 0a410000, Performance =   4.99 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024937 s, Result = 0a438000, Performance =   4.95 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026308 s, Result = 0a460000, Performance =   4.90 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027767 s, Result = 0a488000, Performance =   4.83 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029274 s, Result = 0a4b0000, Performance =   4.77 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030455 s, Result = 0a4d8000, Performance =   4.76 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031805 s, Result = 0a500000, Performance =   4.73 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033429 s, Result = 0a528000, Performance =   4.66 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.035406 s, Result = 0a550000, Performance =   4.55 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.037179 s, Result = 0a578000, Performance =   4.48 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039990 s, Result = 0a5a0000, Performance =   4.30 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038984 s, Result = 0a5c8000, Performance =   4.54 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039684 s, Result = 0a5f0000, Performance =   4.60 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039866 s, Result = 0a618000, Performance =   4.71 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.042672 s, Result = 0a640000, Performance =   4.53 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.042320 s, Result = 0a668000, Performance =   4.69 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.043186 s, Result = 0a690000, Performance =   4.72 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.046486 s, Result = 0a6b8000, Performance =   4.50 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.045061 s, Result = 0a6e0000, Performance =   4.77 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.048328 s, Result = 0a708000, Performance =   4.55 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.048689 s, Result = 0a730000, Performance =   4.63 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050532 s, Result = 0a758000, Performance =   4.57 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.047660 s, Result = 0a780000, Performance =   4.96 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049434 s, Result = 0a7a8000, Performance =   4.89 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.050780 s, Result = 0a7d0000, Performance =   4.86 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.052191 s, Result = 0a7f8000, Performance =   4.83 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.054408 s, Result = 0a820000, Performance =   4.74 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054599 s, Result = 0a848000, Performance =   4.82 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.056306 s, Result = 0a870000, Performance =   4.77 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.057630 s, Result = 0a898000, Performance =   4.75 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059173 s, Result = 0a8c0000, Performance =   4.72 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.060390 s, Result = 0a8e8000, Performance =   4.71 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.062050 s, Result = 0a910000, Performance =   4.67 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.062806 s, Result = 0a938000, Performance =   4.70 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.065084 s, Result = 0a960000, Performance =   4.62 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066329 s, Result = 0a988000, Performance =   4.61 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.067392 s, Result = 0a9b0000, Performance =   4.62 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.068581 s, Result = 0a9d8000, Performance =   4.62 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.069801 s, Result = 0aa00000, Performance =   4.61 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.071063 s, Result = 0aa28000, Performance =   4.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.073697 s, Result = 0aa50000, Performance =   4.52 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073687 s, Result = 0aa78000, Performance =   4.59 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.071149 s, Result = 0aaa0000, Performance =   4.83 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1149  1459   320
Test passed: M N K =   981  1401    64
Test passed: M N K =   511   232  1216
Test passed: M N K =  1327   457  1152
Test passed: M N K =  2040   856   192
M N K =  1024  1024   256, Elapsed time =   0.000835 s, Result = 00028000, Performance =   6.43 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002006 s, Result = 00050000, Performance =   5.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002946 s, Result = 00078000, Performance =   5.47 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003876 s, Result = 000a0000, Performance =   5.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005064 s, Result = 000c8000, Performance =   5.30 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006047 s, Result = 000f0000, Performance =   5.33 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007065 s, Result = 00118000, Performance =   5.32 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007999 s, Result = 00140000, Performance =   5.37 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009214 s, Result = 00168000, Performance =   5.24 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010302 s, Result = 00190000, Performance =   5.21 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011606 s, Result = 001b8000, Performance =   5.09 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012056 s, Result = 001e0000, Performance =   5.34 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012926 s, Result = 00208000, Performance =   5.40 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013282 s, Result = 00230000, Performance =   5.66 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011244 s, Result = 00258000, Performance =   7.16 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012640 s, Result = 00280000, Performance =   6.80 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013414 s, Result = 002a8000, Performance =   6.80 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014489 s, Result = 002d0000, Performance =   6.67 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015480 s, Result = 002f8000, Performance =   6.59 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017308 s, Result = 00320000, Performance =   6.20 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017755 s, Result = 00348000, Performance =   6.35 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018617 s, Result = 00370000, Performance =   6.34 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019099 s, Result = 00398000, Performance =   6.47 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020297 s, Result = 003c0000, Performance =   6.35 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021085 s, Result = 003e8000, Performance =   6.37 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022582 s, Result = 00410000, Performance =   6.18 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023650 s, Result = 00438000, Performance =   6.13 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023619 s, Result = 00460000, Performance =   6.36 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024947 s, Result = 00488000, Performance =   6.24 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026453 s, Result = 004b0000, Performance =   6.09 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.028327 s, Result = 004d8000, Performance =   5.88 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.029046 s, Result = 00500000, Performance =   5.91 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.028517 s, Result = 00528000, Performance =   6.21 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.030445 s, Result = 00550000, Performance =   6.00 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.031252 s, Result = 00578000, Performance =   6.01 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.032395 s, Result = 005a0000, Performance =   5.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.033421 s, Result = 005c8000, Performance =   5.94 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.034683 s, Result = 005f0000, Performance =   5.88 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036172 s, Result = 00618000, Performance =   5.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037130 s, Result = 00640000, Performance =   5.78 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.038179 s, Result = 00668000, Performance =   5.77 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.039655 s, Result = 00690000, Performance =   5.69 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.041301 s, Result = 006b8000, Performance =   5.59 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041876 s, Result = 006e0000, Performance =   5.64 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043955 s, Result = 00708000, Performance =   5.50 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.045034 s, Result = 00730000, Performance =   5.48 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046307 s, Result = 00758000, Performance =   5.45 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.047886 s, Result = 00780000, Performance =   5.38 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.048199 s, Result = 007a8000, Performance =   5.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.053628 s, Result = 007d0000, Performance =   5.01 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.054212 s, Result = 007f8000, Performance =   5.05 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.053335 s, Result = 00820000, Performance =   5.23 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.055777 s, Result = 00848000, Performance =   5.10 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.057825 s, Result = 00870000, Performance =   5.01 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.058230 s, Result = 00898000, Performance =   5.07 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.058926 s, Result = 008c0000, Performance =   5.10 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.059227 s, Result = 008e8000, Performance =   5.17 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.060822 s, Result = 00910000, Performance =   5.12 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.062215 s, Result = 00938000, Performance =   5.09 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.064529 s, Result = 00960000, Performance =   4.99 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.064685 s, Result = 00988000, Performance =   5.06 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.065914 s, Result = 009b0000, Performance =   5.05 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.067574 s, Result = 009d8000, Performance =   5.01 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.068169 s, Result = 00a00000, Performance =   5.04 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1886   287   960
Test passed: M N K =  1399   928   384
Test passed: M N K =   143  1010   832
Test passed: M N K =   130  1491   128
Test passed: M N K =   945   703   192
M N K =  1024  1024   256, Elapsed time =   0.006464 s, Result = d1038000, Performance =   0.83 TOPS
M N K =  1024  1024   512, Elapsed time =   0.007790 s, Result = 61060000, Performance =   1.38 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008235 s, Result = f1088000, Performance =   1.96 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008294 s, Result = 810b0000, Performance =   2.59 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008057 s, Result = 110d8000, Performance =   3.33 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008542 s, Result = a1100000, Performance =   3.77 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009319 s, Result = 31128000, Performance =   4.03 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010029 s, Result = c1150000, Performance =   4.28 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010833 s, Result = 51178000, Performance =   4.46 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011582 s, Result = e11a0000, Performance =   4.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012436 s, Result = 711c8000, Performance =   4.75 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013293 s, Result = 011f0000, Performance =   4.85 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015174 s, Result = 91218000, Performance =   4.60 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015819 s, Result = 21240000, Performance =   4.75 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016418 s, Result = b1268000, Performance =   4.90 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017021 s, Result = 41290000, Performance =   5.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017741 s, Result = d12b8000, Performance =   5.14 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018244 s, Result = 612e0000, Performance =   5.30 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019137 s, Result = f1308000, Performance =   5.33 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019975 s, Result = 81330000, Performance =   5.38 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021097 s, Result = 11358000, Performance =   5.34 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022062 s, Result = a1380000, Performance =   5.35 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022854 s, Result = 313a8000, Performance =   5.40 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023801 s, Result = c13d0000, Performance =   5.41 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024813 s, Result = 513f8000, Performance =   5.41 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026138 s, Result = e1420000, Performance =   5.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027439 s, Result = 71448000, Performance =   5.28 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.028697 s, Result = 01470000, Performance =   5.24 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029789 s, Result = 91498000, Performance =   5.23 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031268 s, Result = 214c0000, Performance =   5.15 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032282 s, Result = b14e8000, Performance =   5.16 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034010 s, Result = 41510000, Performance =   5.05 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.034332 s, Result = d1538000, Performance =   5.16 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034678 s, Result = 61560000, Performance =   5.26 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035606 s, Result = f1588000, Performance =   5.28 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037121 s, Result = 815b0000, Performance =   5.21 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.040917 s, Result = 115d8000, Performance =   4.85 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042114 s, Result = a1600000, Performance =   4.84 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.042731 s, Result = 31628000, Performance =   4.90 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.043969 s, Result = c1650000, Performance =   4.88 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.045246 s, Result = 51678000, Performance =   4.86 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.045689 s, Result = e16a0000, Performance =   4.94 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.047158 s, Result = 716c8000, Performance =   4.90 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.049999 s, Result = 016f0000, Performance =   4.72 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.047251 s, Result = 91718000, Performance =   5.11 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.049387 s, Result = 21740000, Performance =   5.00 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.050824 s, Result = b1768000, Performance =   4.96 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.052294 s, Result = 41790000, Performance =   4.93 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.053290 s, Result = d17b8000, Performance =   4.94 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.054943 s, Result = 617e0000, Performance =   4.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.056437 s, Result = f1808000, Performance =   4.85 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.057422 s, Result = 81830000, Performance =   4.86 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059027 s, Result = 11858000, Performance =   4.82 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.060540 s, Result = a1880000, Performance =   4.79 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.061714 s, Result = 318a8000, Performance =   4.78 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.063122 s, Result = c18d0000, Performance =   4.76 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.064437 s, Result = 518f8000, Performance =   4.75 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.065237 s, Result = e1920000, Performance =   4.77 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.066955 s, Result = 71948000, Performance =   4.73 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.068026 s, Result = 01970000, Performance =   4.74 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.070080 s, Result = 91998000, Performance =   4.67 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.070925 s, Result = 219c0000, Performance =   4.69 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.071126 s, Result = b19e8000, Performance =   4.76 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.072491 s, Result = 41a10000, Performance =   4.74 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   440   804   768
Test passed: M N K =  1510   460   960
Test passed: M N K =  1561   709   960
Test passed: M N K =  1887  2030   192
Test passed: M N K =   601   634  1664
M N K =  1024  1024   256, Elapsed time =   0.004217 s, Result = 00028000, Performance =   1.27 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005760 s, Result = 00050000, Performance =   1.86 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007008 s, Result = 00078000, Performance =   2.30 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007878 s, Result = 000a0000, Performance =   2.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009040 s, Result = 000c8000, Performance =   2.97 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010037 s, Result = 000f0000, Performance =   3.21 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010881 s, Result = 00118000, Performance =   3.45 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011511 s, Result = 00140000, Performance =   3.73 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012450 s, Result = 00168000, Performance =   3.88 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013187 s, Result = 00190000, Performance =   4.07 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.013886 s, Result = 001b8000, Performance =   4.25 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013867 s, Result = 001e0000, Performance =   4.65 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013558 s, Result = 00208000, Performance =   5.15 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013111 s, Result = 00230000, Performance =   5.73 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013680 s, Result = 00258000, Performance =   5.89 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014893 s, Result = 00280000, Performance =   5.77 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016017 s, Result = 002a8000, Performance =   5.70 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016934 s, Result = 002d0000, Performance =   5.71 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017779 s, Result = 002f8000, Performance =   5.74 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018786 s, Result = 00320000, Performance =   5.72 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019614 s, Result = 00348000, Performance =   5.75 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020578 s, Result = 00370000, Performance =   5.74 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021553 s, Result = 00398000, Performance =   5.73 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022726 s, Result = 003c0000, Performance =   5.67 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024025 s, Result = 003e8000, Performance =   5.59 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025424 s, Result = 00410000, Performance =   5.49 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026408 s, Result = 00438000, Performance =   5.49 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027703 s, Result = 00460000, Performance =   5.43 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028606 s, Result = 00488000, Performance =   5.44 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030248 s, Result = 004b0000, Performance =   5.32 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031087 s, Result = 004d8000, Performance =   5.35 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032738 s, Result = 00500000, Performance =   5.25 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032777 s, Result = 00528000, Performance =   5.41 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032973 s, Result = 00550000, Performance =   5.54 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034101 s, Result = 00578000, Performance =   5.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.035212 s, Result = 005a0000, Performance =   5.49 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036355 s, Result = 005c8000, Performance =   5.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.037659 s, Result = 005f0000, Performance =   5.42 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038647 s, Result = 00618000, Performance =   5.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040215 s, Result = 00640000, Performance =   5.34 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041044 s, Result = 00668000, Performance =   5.36 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043708 s, Result = 00690000, Performance =   5.16 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.043440 s, Result = 006b8000, Performance =   5.31 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.045837 s, Result = 006e0000, Performance =   5.15 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.046384 s, Result = 00708000, Performance =   5.21 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.047487 s, Result = 00730000, Performance =   5.20 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.048663 s, Result = 00758000, Performance =   5.19 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.050073 s, Result = 00780000, Performance =   5.15 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.050701 s, Result = 007a8000, Performance =   5.19 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.052534 s, Result = 007d0000, Performance =   5.11 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.053349 s, Result = 007f8000, Performance =   5.13 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055218 s, Result = 00820000, Performance =   5.06 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.054985 s, Result = 00848000, Performance =   5.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.056571 s, Result = 00870000, Performance =   5.12 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.057002 s, Result = 00898000, Performance =   5.18 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.058969 s, Result = 008c0000, Performance =   5.10 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.059972 s, Result = 008e8000, Performance =   5.10 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.061671 s, Result = 00910000, Performance =   5.05 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.062526 s, Result = 00938000, Performance =   5.07 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.065826 s, Result = 00960000, Performance =   4.89 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.066518 s, Result = 00988000, Performance =   4.92 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.067672 s, Result = 009b0000, Performance =   4.92 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.066902 s, Result = 009d8000, Performance =   5.06 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.068408 s, Result = 00a00000, Performance =   5.02 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1644  1941   192
Test passed: M N K =   562   409  1792
Test passed: M N K =   225   469  1024
Test passed: M N K =    98  1571  1536
Test passed: M N K =  1536  1408  1536
M N K =  1024  1024   256, Elapsed time =   0.005247 s, Result = 0a0c8000, Performance =   1.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006917 s, Result = 0a0f0000, Performance =   1.55 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007722 s, Result = 0a118000, Performance =   2.09 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008644 s, Result = 0a140000, Performance =   2.48 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.009598 s, Result = 0a168000, Performance =   2.80 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.010601 s, Result = 0a190000, Performance =   3.04 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.011619 s, Result = 0a1b8000, Performance =   3.23 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.012723 s, Result = 0a1e0000, Performance =   3.38 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013875 s, Result = 0a208000, Performance =   3.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.015009 s, Result = 0a230000, Performance =   3.58 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.016057 s, Result = 0a258000, Performance =   3.68 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016924 s, Result = 0a280000, Performance =   3.81 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017989 s, Result = 0a2a8000, Performance =   3.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018760 s, Result = 0a2d0000, Performance =   4.01 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018398 s, Result = 0a2f8000, Performance =   4.38 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017015 s, Result = 0a320000, Performance =   5.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017281 s, Result = 0a348000, Performance =   5.28 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018248 s, Result = 0a370000, Performance =   5.30 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018859 s, Result = 0a398000, Performance =   5.41 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019796 s, Result = 0a3c0000, Performance =   5.42 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020572 s, Result = 0a3e8000, Performance =   5.48 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021413 s, Result = 0a410000, Performance =   5.52 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022163 s, Result = 0a438000, Performance =   5.57 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022921 s, Result = 0a460000, Performance =   5.62 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023752 s, Result = 0a488000, Performance =   5.65 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024887 s, Result = 0a4b0000, Performance =   5.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025809 s, Result = 0a4d8000, Performance =   5.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026978 s, Result = 0a500000, Performance =   5.57 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028151 s, Result = 0a528000, Performance =   5.53 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029559 s, Result = 0a550000, Performance =   5.45 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030560 s, Result = 0a578000, Performance =   5.45 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032003 s, Result = 0a5a0000, Performance =   5.37 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032442 s, Result = 0a5c8000, Performance =   5.46 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032591 s, Result = 0a5f0000, Performance =   5.60 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.033778 s, Result = 0a618000, Performance =   5.56 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034905 s, Result = 0a640000, Performance =   5.54 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035945 s, Result = 0a668000, Performance =   5.53 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.037037 s, Result = 0a690000, Performance =   5.51 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038049 s, Result = 0a6b8000, Performance =   5.50 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.039284 s, Result = 0a6e0000, Performance =   5.47 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040303 s, Result = 0a708000, Performance =   5.46 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041483 s, Result = 0a730000, Performance =   5.44 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042042 s, Result = 0a758000, Performance =   5.49 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044295 s, Result = 0a780000, Performance =   5.33 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.044826 s, Result = 0a7a8000, Performance =   5.39 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.046926 s, Result = 0a7d0000, Performance =   5.26 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.047250 s, Result = 0a7f8000, Performance =   5.34 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.049623 s, Result = 0a820000, Performance =   5.19 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.050836 s, Result = 0a848000, Performance =   5.17 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.052324 s, Result = 0a870000, Performance =   5.13 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.052880 s, Result = 0a898000, Performance =   5.18 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055462 s, Result = 0a8c0000, Performance =   5.03 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.055965 s, Result = 0a8e8000, Performance =   5.08 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.058105 s, Result = 0a910000, Performance =   4.99 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.058422 s, Result = 0a938000, Performance =   5.05 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.060598 s, Result = 0a960000, Performance =   4.96 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.061040 s, Result = 0a988000, Performance =   5.01 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.063206 s, Result = 0a9b0000, Performance =   4.93 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.063569 s, Result = 0a9d8000, Performance =   4.98 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.065258 s, Result = 0aa00000, Performance =   4.94 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.066521 s, Result = 0aa28000, Performance =   4.92 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.068373 s, Result = 0aa50000, Performance =   4.87 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.067698 s, Result = 0aa78000, Performance =   5.00 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.069050 s, Result = 0aaa0000, Performance =   4.98 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   585  1448   192
Test passed: M N K =   490   184   832
Test passed: M N K =    14  1866  1920
Test passed: M N K =   473   623  2048
Test passed: M N K =  1163  1574  1920
M N K =  1024  1024   256, Elapsed time =   0.000789 s, Result = 00028000, Performance =   6.81 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001841 s, Result = 00050000, Performance =   5.83 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002842 s, Result = 00078000, Performance =   5.67 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003759 s, Result = 000a0000, Performance =   5.71 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004893 s, Result = 000c8000, Performance =   5.49 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005835 s, Result = 000f0000, Performance =   5.52 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007005 s, Result = 00118000, Performance =   5.36 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007806 s, Result = 00140000, Performance =   5.50 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008946 s, Result = 00168000, Performance =   5.40 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009788 s, Result = 00190000, Performance =   5.49 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011105 s, Result = 001b8000, Performance =   5.32 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011750 s, Result = 001e0000, Performance =   5.48 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012963 s, Result = 00208000, Performance =   5.38 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013352 s, Result = 00230000, Performance =   5.63 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013157 s, Result = 00258000, Performance =   6.12 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012661 s, Result = 00280000, Performance =   6.78 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012808 s, Result = 002a8000, Performance =   7.13 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013590 s, Result = 002d0000, Performance =   7.11 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014632 s, Result = 002f8000, Performance =   6.97 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015494 s, Result = 00320000, Performance =   6.93 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017216 s, Result = 00348000, Performance =   6.55 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017550 s, Result = 00370000, Performance =   6.73 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018093 s, Result = 00398000, Performance =   6.82 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019000 s, Result = 003c0000, Performance =   6.78 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019772 s, Result = 003e8000, Performance =   6.79 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020733 s, Result = 00410000, Performance =   6.73 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021577 s, Result = 00438000, Performance =   6.72 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021910 s, Result = 00460000, Performance =   6.86 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022760 s, Result = 00488000, Performance =   6.84 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024407 s, Result = 004b0000, Performance =   6.60 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025315 s, Result = 004d8000, Performance =   6.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027087 s, Result = 00500000, Performance =   6.34 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027621 s, Result = 00528000, Performance =   6.41 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027526 s, Result = 00550000, Performance =   6.63 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029213 s, Result = 00578000, Performance =   6.43 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030318 s, Result = 005a0000, Performance =   6.37 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031496 s, Result = 005c8000, Performance =   6.31 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032540 s, Result = 005f0000, Performance =   6.27 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.033601 s, Result = 00618000, Performance =   6.23 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034507 s, Result = 00640000, Performance =   6.22 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.035928 s, Result = 00668000, Performance =   6.13 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036425 s, Result = 00690000, Performance =   6.19 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037128 s, Result = 006b8000, Performance =   6.22 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.039064 s, Result = 006e0000, Performance =   6.05 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.039786 s, Result = 00708000, Performance =   6.07 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041713 s, Result = 00730000, Performance =   5.92 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042479 s, Result = 00758000, Performance =   5.94 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.044153 s, Result = 00780000, Performance =   5.84 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045083 s, Result = 007a8000, Performance =   5.84 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.046358 s, Result = 007d0000, Performance =   5.79 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.048443 s, Result = 007f8000, Performance =   5.65 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.049436 s, Result = 00820000, Performance =   5.65 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.050832 s, Result = 00848000, Performance =   5.60 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.052436 s, Result = 00870000, Performance =   5.53 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.052743 s, Result = 00898000, Performance =   5.60 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.054125 s, Result = 008c0000, Performance =   5.55 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.055400 s, Result = 008e8000, Performance =   5.52 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.056622 s, Result = 00910000, Performance =   5.50 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.057612 s, Result = 00938000, Performance =   5.50 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.060291 s, Result = 00960000, Performance =   5.34 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.060430 s, Result = 00988000, Performance =   5.42 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.062621 s, Result = 009b0000, Performance =   5.32 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.061800 s, Result = 009d8000, Performance =   5.47 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.063637 s, Result = 00a00000, Performance =   5.40 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   292  1093  1216
Test passed: M N K =  1356    45   960
Test passed: M N K =   179  1142  2048
Test passed: M N K =  1885  1824   768
Test passed: M N K =  1357   531  1664
M N K =  1024  1024   256, Elapsed time =   0.005203 s, Result = d1038000, Performance =   1.03 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005655 s, Result = 61060000, Performance =   1.90 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006290 s, Result = f1088000, Performance =   2.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006984 s, Result = 810b0000, Performance =   3.07 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007763 s, Result = 110d8000, Performance =   3.46 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008501 s, Result = a1100000, Performance =   3.79 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009242 s, Result = 31128000, Performance =   4.07 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009977 s, Result = c1150000, Performance =   4.31 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010783 s, Result = 51178000, Performance =   4.48 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011562 s, Result = e11a0000, Performance =   4.64 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012406 s, Result = 711c8000, Performance =   4.76 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013074 s, Result = 011f0000, Performance =   4.93 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014163 s, Result = 91218000, Performance =   4.93 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015054 s, Result = 21240000, Performance =   4.99 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016030 s, Result = b1268000, Performance =   5.02 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016820 s, Result = 41290000, Performance =   5.11 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017703 s, Result = d12b8000, Performance =   5.16 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018514 s, Result = 612e0000, Performance =   5.22 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019323 s, Result = f1308000, Performance =   5.28 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020043 s, Result = 81330000, Performance =   5.36 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020982 s, Result = 11358000, Performance =   5.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021699 s, Result = a1380000, Performance =   5.44 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022414 s, Result = 313a8000, Performance =   5.51 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.023327 s, Result = c13d0000, Performance =   5.52 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024291 s, Result = 513f8000, Performance =   5.53 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.025356 s, Result = e1420000, Performance =   5.51 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026465 s, Result = 71448000, Performance =   5.48 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027567 s, Result = 01470000, Performance =   5.45 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028827 s, Result = 91498000, Performance =   5.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030006 s, Result = 214c0000, Performance =   5.37 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031162 s, Result = b14e8000, Performance =   5.34 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032421 s, Result = 41510000, Performance =   5.30 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033751 s, Result = d1538000, Performance =   5.25 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034898 s, Result = 61560000, Performance =   5.23 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035641 s, Result = f1588000, Performance =   5.27 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.036155 s, Result = 815b0000, Performance =   5.35 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037319 s, Result = 115d8000, Performance =   5.32 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038324 s, Result = a1600000, Performance =   5.32 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039550 s, Result = 31628000, Performance =   5.29 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040573 s, Result = c1650000, Performance =   5.29 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041833 s, Result = 51678000, Performance =   5.26 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043047 s, Result = e16a0000, Performance =   5.24 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044125 s, Result = 716c8000, Performance =   5.23 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.045330 s, Result = 016f0000, Performance =   5.21 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.046481 s, Result = 91718000, Performance =   5.20 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.048501 s, Result = 21740000, Performance =   5.09 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.048774 s, Result = b1768000, Performance =   5.17 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.050154 s, Result = 41790000, Performance =   5.14 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.051486 s, Result = d17b8000, Performance =   5.11 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.053090 s, Result = 617e0000, Performance =   5.06 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.054129 s, Result = f1808000, Performance =   5.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055169 s, Result = 81830000, Performance =   5.06 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.056543 s, Result = 11858000, Performance =   5.03 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.058660 s, Result = a1880000, Performance =   4.94 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.060361 s, Result = 318a8000, Performance =   4.89 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.060053 s, Result = c18d0000, Performance =   5.01 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.060425 s, Result = 518f8000, Performance =   5.06 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.062986 s, Result = e1920000, Performance =   4.94 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.062365 s, Result = 71948000, Performance =   5.08 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.065630 s, Result = 01970000, Performance =   4.91 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.065337 s, Result = 91998000, Performance =   5.01 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.066961 s, Result = 219c0000, Performance =   4.97 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.068508 s, Result = b19e8000, Performance =   4.94 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.070596 s, Result = 41a10000, Performance =   4.87 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   964   970  2048
Test passed: M N K =  1592   466  1664
Test passed: M N K =  1971   940  1088
Test passed: M N K =  1588  1620  1216
Test passed: M N K =  1745  1357  1536
M N K =  1024  1024   256, Elapsed time =   0.003711 s, Result = 00028000, Performance =   1.45 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004673 s, Result = 00050000, Performance =   2.30 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005977 s, Result = 00078000, Performance =   2.69 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006575 s, Result = 000a0000, Performance =   3.27 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007328 s, Result = 000c8000, Performance =   3.66 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007418 s, Result = 000f0000, Performance =   4.34 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007968 s, Result = 00118000, Performance =   4.72 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007895 s, Result = 00140000, Performance =   5.44 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008262 s, Result = 00168000, Performance =   5.85 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008996 s, Result = 00190000, Performance =   5.97 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009836 s, Result = 001b8000, Performance =   6.00 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010605 s, Result = 001e0000, Performance =   6.07 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011447 s, Result = 00208000, Performance =   6.10 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012330 s, Result = 00230000, Performance =   6.10 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013280 s, Result = 00258000, Performance =   6.06 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014331 s, Result = 00280000, Performance =   5.99 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015325 s, Result = 002a8000, Performance =   5.96 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016217 s, Result = 002d0000, Performance =   5.96 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017021 s, Result = 002f8000, Performance =   5.99 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017734 s, Result = 00320000, Performance =   6.05 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018654 s, Result = 00348000, Performance =   6.04 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019480 s, Result = 00370000, Performance =   6.06 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020355 s, Result = 00398000, Performance =   6.07 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021160 s, Result = 003c0000, Performance =   6.09 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021956 s, Result = 003e8000, Performance =   6.11 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022638 s, Result = 00410000, Performance =   6.17 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023503 s, Result = 00438000, Performance =   6.17 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024638 s, Result = 00460000, Performance =   6.10 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.025838 s, Result = 00488000, Performance =   6.03 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026934 s, Result = 004b0000, Performance =   5.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.028002 s, Result = 004d8000, Performance =   5.94 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.029299 s, Result = 00500000, Performance =   5.86 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.031008 s, Result = 00528000, Performance =   5.71 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.032498 s, Result = 00550000, Performance =   5.62 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.032759 s, Result = 00578000, Performance =   5.74 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033617 s, Result = 005a0000, Performance =   5.75 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034514 s, Result = 005c8000, Performance =   5.76 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035993 s, Result = 005f0000, Performance =   5.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036682 s, Result = 00618000, Performance =   5.71 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037882 s, Result = 00640000, Performance =   5.67 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.038987 s, Result = 00668000, Performance =   5.65 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.040182 s, Result = 00690000, Performance =   5.61 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040792 s, Result = 006b8000, Performance =   5.66 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042288 s, Result = 006e0000, Performance =   5.59 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043372 s, Result = 00708000, Performance =   5.57 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.044475 s, Result = 00730000, Performance =   5.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.046144 s, Result = 00758000, Performance =   5.47 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046986 s, Result = 00780000, Performance =   5.48 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.048127 s, Result = 007a8000, Performance =   5.47 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.049612 s, Result = 007d0000, Performance =   5.41 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.051017 s, Result = 007f8000, Performance =   5.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.051842 s, Result = 00820000, Performance =   5.39 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.053213 s, Result = 00848000, Performance =   5.35 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.054907 s, Result = 00870000, Performance =   5.28 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.056495 s, Result = 00898000, Performance =   5.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.057422 s, Result = 008c0000, Performance =   5.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.058390 s, Result = 008e8000, Performance =   5.24 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.060686 s, Result = 00910000, Performance =   5.13 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.059746 s, Result = 00938000, Performance =   5.30 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.062650 s, Result = 00960000, Performance =   5.14 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.062124 s, Result = 00988000, Performance =   5.27 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.064012 s, Result = 009b0000, Performance =   5.20 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.065290 s, Result = 009d8000, Performance =   5.18 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.066925 s, Result = 00a00000, Performance =   5.13 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1907  1161  1600
Test passed: M N K =  1881   170  1920
Test passed: M N K =  1517    44   384
Test passed: M N K =   704   269   704
Test passed: M N K =  1841  1029  1792
M N K =  1024  1024   256, Elapsed time =   0.004414 s, Result = 0a0c8000, Performance =   1.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005678 s, Result = 0a0f0000, Performance =   1.89 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006291 s, Result = 0a118000, Performance =   2.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006904 s, Result = 0a140000, Performance =   3.11 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007345 s, Result = 0a168000, Performance =   3.65 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007956 s, Result = 0a190000, Performance =   4.05 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008644 s, Result = 0a1b8000, Performance =   4.35 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009423 s, Result = 0a1e0000, Performance =   4.56 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010174 s, Result = 0a208000, Performance =   4.75 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010997 s, Result = 0a230000, Performance =   4.88 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011849 s, Result = 0a258000, Performance =   4.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012718 s, Result = 0a280000, Performance =   5.07 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013760 s, Result = 0a2a8000, Performance =   5.07 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014718 s, Result = 0a2d0000, Performance =   5.11 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015522 s, Result = 0a2f8000, Performance =   5.19 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016252 s, Result = 0a320000, Performance =   5.29 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017114 s, Result = 0a348000, Performance =   5.33 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017905 s, Result = 0a370000, Performance =   5.40 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018650 s, Result = 0a398000, Performance =   5.47 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019500 s, Result = 0a3c0000, Performance =   5.51 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020388 s, Result = 0a3e8000, Performance =   5.53 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021160 s, Result = 0a410000, Performance =   5.58 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021801 s, Result = 0a438000, Performance =   5.66 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022543 s, Result = 0a460000, Performance =   5.72 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023511 s, Result = 0a488000, Performance =   5.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024490 s, Result = 0a4b0000, Performance =   5.70 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025190 s, Result = 0a4d8000, Performance =   5.75 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026198 s, Result = 0a500000, Performance =   5.74 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027265 s, Result = 0a528000, Performance =   5.71 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028498 s, Result = 0a550000, Performance =   5.65 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029922 s, Result = 0a578000, Performance =   5.56 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030989 s, Result = 0a5a0000, Performance =   5.54 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032251 s, Result = 0a5c8000, Performance =   5.49 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033127 s, Result = 0a5f0000, Performance =   5.51 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034023 s, Result = 0a618000, Performance =   5.52 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034553 s, Result = 0a640000, Performance =   5.59 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.035704 s, Result = 0a668000, Performance =   5.56 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036807 s, Result = 0a690000, Performance =   5.54 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.037859 s, Result = 0a6b8000, Performance =   5.53 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038743 s, Result = 0a6e0000, Performance =   5.54 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.040074 s, Result = 0a708000, Performance =   5.49 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.041131 s, Result = 0a730000, Performance =   5.48 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.042384 s, Result = 0a758000, Performance =   5.45 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.043396 s, Result = 0a780000, Performance =   5.44 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.044702 s, Result = 0a7a8000, Performance =   5.40 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.045901 s, Result = 0a7d0000, Performance =   5.38 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.047136 s, Result = 0a7f8000, Performance =   5.35 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.048374 s, Result = 0a820000, Performance =   5.33 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.049353 s, Result = 0a848000, Performance =   5.33 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.050505 s, Result = 0a870000, Performance =   5.32 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.051787 s, Result = 0a898000, Performance =   5.29 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.052877 s, Result = 0a8c0000, Performance =   5.28 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.055331 s, Result = 0a8e8000, Performance =   5.14 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.055897 s, Result = 0a910000, Performance =   5.19 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.057280 s, Result = 0a938000, Performance =   5.16 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.058597 s, Result = 0a960000, Performance =   5.13 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.058415 s, Result = 0a988000, Performance =   5.24 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.060667 s, Result = 0a9b0000, Performance =   5.13 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.059310 s, Result = 0a9d8000, Performance =   5.34 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.062464 s, Result = 0aa00000, Performance =   5.16 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.063056 s, Result = 0aa28000, Performance =   5.19 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.064504 s, Result = 0aa50000, Performance =   5.16 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.065664 s, Result = 0aa78000, Performance =   5.15 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.067564 s, Result = 0aaa0000, Performance =   5.09 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   963   411  1472
Test passed: M N K =  1032   702  1664
Test passed: M N K =  1174   716  1664
Test passed: M N K =   509   175   704
Test passed: M N K =  1293   872  1152
M N K =  1024  1024   256, Elapsed time =   0.000823 s, Result = 00028000, Performance =   6.52 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001853 s, Result = 00050000, Performance =   5.79 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002570 s, Result = 00078000, Performance =   6.27 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003201 s, Result = 000a0000, Performance =   6.71 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003859 s, Result = 000c8000, Performance =   6.96 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004580 s, Result = 000f0000, Performance =   7.03 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005008 s, Result = 00118000, Performance =   7.50 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005504 s, Result = 00140000, Performance =   7.80 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006219 s, Result = 00168000, Performance =   7.77 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007736 s, Result = 00190000, Performance =   6.94 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008296 s, Result = 001b8000, Performance =   7.12 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009140 s, Result = 001e0000, Performance =   7.05 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010040 s, Result = 00208000, Performance =   6.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011003 s, Result = 00230000, Performance =   6.83 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011805 s, Result = 00258000, Performance =   6.82 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012561 s, Result = 00280000, Performance =   6.84 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013541 s, Result = 002a8000, Performance =   6.74 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014391 s, Result = 002d0000, Performance =   6.71 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014578 s, Result = 002f8000, Performance =   7.00 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015255 s, Result = 00320000, Performance =   7.04 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016141 s, Result = 00348000, Performance =   6.98 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016958 s, Result = 00370000, Performance =   6.96 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017584 s, Result = 00398000, Performance =   7.02 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018375 s, Result = 003c0000, Performance =   7.01 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020069 s, Result = 003e8000, Performance =   6.69 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021199 s, Result = 00410000, Performance =   6.58 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021911 s, Result = 00438000, Performance =   6.62 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022749 s, Result = 00460000, Performance =   6.61 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024336 s, Result = 00488000, Performance =   6.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025358 s, Result = 004b0000, Performance =   6.35 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026227 s, Result = 004d8000, Performance =   6.35 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027716 s, Result = 00500000, Performance =   6.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026593 s, Result = 00528000, Performance =   6.66 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028956 s, Result = 00550000, Performance =   6.30 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029222 s, Result = 00578000, Performance =   6.43 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029740 s, Result = 005a0000, Performance =   6.50 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030772 s, Result = 005c8000, Performance =   6.46 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032037 s, Result = 005f0000, Performance =   6.37 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032883 s, Result = 00618000, Performance =   6.37 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033861 s, Result = 00640000, Performance =   6.34 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034691 s, Result = 00668000, Performance =   6.35 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036057 s, Result = 00690000, Performance =   6.25 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.036949 s, Result = 006b8000, Performance =   6.25 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.038362 s, Result = 006e0000, Performance =   6.16 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.039246 s, Result = 00708000, Performance =   6.16 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040735 s, Result = 00730000, Performance =   6.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.041968 s, Result = 00758000, Performance =   6.01 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.043147 s, Result = 00780000, Performance =   5.97 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.043975 s, Result = 007a8000, Performance =   5.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.045588 s, Result = 007d0000, Performance =   5.89 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.052424 s, Result = 007f8000, Performance =   5.22 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.047033 s, Result = 00820000, Performance =   5.94 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.048739 s, Result = 00848000, Performance =   5.84 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.049879 s, Result = 00870000, Performance =   5.81 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051475 s, Result = 00898000, Performance =   5.74 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052425 s, Result = 008c0000, Performance =   5.73 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053611 s, Result = 008e8000, Performance =   5.71 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.055536 s, Result = 00910000, Performance =   5.61 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.055303 s, Result = 00938000, Performance =   5.73 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.057898 s, Result = 00960000, Performance =   5.56 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.057949 s, Result = 00988000, Performance =   5.65 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.059481 s, Result = 009b0000, Performance =   5.60 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.060852 s, Result = 009d8000, Performance =   5.56 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.062044 s, Result = 00a00000, Performance =   5.54 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1882   396   960
Test passed: M N K =  1234   412  1024
Test passed: M N K =  1517  1514   448
Test passed: M N K =   777   336  1472
Test passed: M N K =  1808  1092  1280
M N K =  1024  1024   256, Elapsed time =   0.005055 s, Result = 5902e000, Performance =   1.06 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006070 s, Result = 3104c000, Performance =   1.77 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006272 s, Result = 0906a000, Performance =   2.57 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006543 s, Result = e1088000, Performance =   3.28 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007115 s, Result = b90a6000, Performance =   3.77 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007797 s, Result = 910c4000, Performance =   4.13 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008447 s, Result = 690e2000, Performance =   4.45 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009134 s, Result = 41100000, Performance =   4.70 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009887 s, Result = 1911e000, Performance =   4.89 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010669 s, Result = f113c000, Performance =   5.03 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011663 s, Result = c915a000, Performance =   5.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012450 s, Result = a1178000, Performance =   5.17 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013766 s, Result = 79196000, Performance =   5.07 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014766 s, Result = 511b4000, Performance =   5.09 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015933 s, Result = 291d2000, Performance =   5.05 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016874 s, Result = 011f0000, Performance =   5.09 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017224 s, Result = d920e000, Performance =   5.30 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018102 s, Result = b122c000, Performance =   5.34 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018645 s, Result = 8924a000, Performance =   5.47 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019787 s, Result = 61268000, Performance =   5.43 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020460 s, Result = 39286000, Performance =   5.51 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.021425 s, Result = 112a4000, Performance =   5.51 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.022064 s, Result = e92c2000, Performance =   5.60 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022914 s, Result = c12e0000, Performance =   5.62 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023635 s, Result = 992fe000, Performance =   5.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024506 s, Result = 7131c000, Performance =   5.70 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025556 s, Result = 4933a000, Performance =   5.67 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027884 s, Result = 21358000, Performance =   5.39 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028325 s, Result = f9376000, Performance =   5.50 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029833 s, Result = d1394000, Performance =   5.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.030996 s, Result = a93b2000, Performance =   5.37 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032184 s, Result = 813d0000, Performance =   5.34 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.030801 s, Result = 593ee000, Performance =   5.75 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.031684 s, Result = 3140c000, Performance =   5.76 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.032977 s, Result = 0942a000, Performance =   5.70 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034166 s, Result = e1448000, Performance =   5.66 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034665 s, Result = b9466000, Performance =   5.73 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035860 s, Result = 91484000, Performance =   5.69 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036925 s, Result = 694a2000, Performance =   5.67 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.038173 s, Result = 414c0000, Performance =   5.63 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.039089 s, Result = 194de000, Performance =   5.63 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.039792 s, Result = f14fc000, Performance =   5.67 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040393 s, Result = c951a000, Performance =   5.72 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.042203 s, Result = a1538000, Performance =   5.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.043174 s, Result = 79556000, Performance =   5.60 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043675 s, Result = 51574000, Performance =   5.65 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.044663 s, Result = 29592000, Performance =   5.65 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045173 s, Result = 015b0000, Performance =   5.70 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045715 s, Result = d95ce000, Performance =   5.75 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.046825 s, Result = b15ec000, Performance =   5.73 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047379 s, Result = 8960a000, Performance =   5.78 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.047557 s, Result = 61628000, Performance =   5.87 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.049381 s, Result = 39646000, Performance =   5.76 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050324 s, Result = 11664000, Performance =   5.76 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051787 s, Result = e9682000, Performance =   5.70 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052621 s, Result = c16a0000, Performance =   5.71 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053323 s, Result = 996be000, Performance =   5.74 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.053724 s, Result = 716dc000, Performance =   5.80 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054792 s, Result = 496fa000, Performance =   5.78 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055279 s, Result = 21718000, Performance =   5.83 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.056350 s, Result = f9736000, Performance =   5.81 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.057188 s, Result = d1754000, Performance =   5.82 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.057919 s, Result = a9772000, Performance =   5.84 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.057996 s, Result = 81790000, Performance =   5.92 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1736  1783   832
Test passed: M N K =    89   965   192
Test passed: M N K =  1436  1927   960
Test passed: M N K =  1322  1332  1536
Test passed: M N K =  1476  1064  1536
M N K =  1024  1024   256, Elapsed time =   0.004298 s, Result = 0001e000, Performance =   1.25 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005635 s, Result = 0003c000, Performance =   1.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006567 s, Result = 0005a000, Performance =   2.45 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007098 s, Result = 00078000, Performance =   3.03 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007606 s, Result = 00096000, Performance =   3.53 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008115 s, Result = 000b4000, Performance =   3.97 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008435 s, Result = 000d2000, Performance =   4.46 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008019 s, Result = 000f0000, Performance =   5.36 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008107 s, Result = 0010e000, Performance =   5.96 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008049 s, Result = 0012c000, Performance =   6.67 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008699 s, Result = 0014a000, Performance =   6.79 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009468 s, Result = 00168000, Performance =   6.80 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010432 s, Result = 00186000, Performance =   6.69 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011426 s, Result = 001a4000, Performance =   6.58 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012531 s, Result = 001c2000, Performance =   6.43 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013898 s, Result = 001e0000, Performance =   6.18 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014418 s, Result = 001fe000, Performance =   6.33 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015548 s, Result = 0021c000, Performance =   6.22 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016463 s, Result = 0023a000, Performance =   6.20 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017072 s, Result = 00258000, Performance =   6.29 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018076 s, Result = 00276000, Performance =   6.24 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018807 s, Result = 00294000, Performance =   6.28 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019817 s, Result = 002b2000, Performance =   6.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020683 s, Result = 002d0000, Performance =   6.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021437 s, Result = 002ee000, Performance =   6.26 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022246 s, Result = 0030c000, Performance =   6.27 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023091 s, Result = 0032a000, Performance =   6.28 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024008 s, Result = 00348000, Performance =   6.26 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024887 s, Result = 00366000, Performance =   6.26 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.026078 s, Result = 00384000, Performance =   6.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.027108 s, Result = 003a2000, Performance =   6.14 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027708 s, Result = 003c0000, Performance =   6.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026730 s, Result = 003de000, Performance =   6.63 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027845 s, Result = 003fc000, Performance =   6.56 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028844 s, Result = 0041a000, Performance =   6.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029622 s, Result = 00438000, Performance =   6.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030713 s, Result = 00456000, Performance =   6.47 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.031514 s, Result = 00474000, Performance =   6.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032634 s, Result = 00492000, Performance =   6.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034720 s, Result = 004b0000, Performance =   6.19 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.035740 s, Result = 004ce000, Performance =   6.16 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036675 s, Result = 004ec000, Performance =   6.15 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037786 s, Result = 0050a000, Performance =   6.11 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.038606 s, Result = 00528000, Performance =   6.12 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.039760 s, Result = 00546000, Performance =   6.08 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040530 s, Result = 00564000, Performance =   6.09 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.041503 s, Result = 00582000, Performance =   6.08 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.042723 s, Result = 005a0000, Performance =   6.03 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.042983 s, Result = 005be000, Performance =   6.12 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.044482 s, Result = 005dc000, Performance =   6.03 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.044987 s, Result = 005fa000, Performance =   6.09 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.045631 s, Result = 00618000, Performance =   6.12 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.046528 s, Result = 00636000, Performance =   6.12 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.047299 s, Result = 00654000, Performance =   6.13 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.047046 s, Result = 00672000, Performance =   6.28 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.048208 s, Result = 00690000, Performance =   6.24 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.050144 s, Result = 006ae000, Performance =   6.10 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.051104 s, Result = 006cc000, Performance =   6.09 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051853 s, Result = 006ea000, Performance =   6.11 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.052625 s, Result = 00708000, Performance =   6.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.053595 s, Result = 00726000, Performance =   6.11 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.054453 s, Result = 00744000, Performance =   6.11 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.055063 s, Result = 00762000, Performance =   6.14 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055957 s, Result = 00780000, Performance =   6.14 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   454   477  1344
Test passed: M N K =   572  1360   576
Test passed: M N K =  1621   798  1216
Test passed: M N K =   664   288   384
Test passed: M N K =    28   458   576
M N K =  1024  1024   256, Elapsed time =   0.004189 s, Result = 0a0be000, Performance =   1.28 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005326 s, Result = 0a0dc000, Performance =   2.02 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005504 s, Result = 0a0fa000, Performance =   2.93 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006174 s, Result = 0a118000, Performance =   3.48 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006800 s, Result = 0a136000, Performance =   3.95 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007378 s, Result = 0a154000, Performance =   4.37 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008016 s, Result = 0a172000, Performance =   4.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008718 s, Result = 0a190000, Performance =   4.93 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009641 s, Result = 0a1ae000, Performance =   5.01 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010373 s, Result = 0a1cc000, Performance =   5.18 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011243 s, Result = 0a1ea000, Performance =   5.25 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012116 s, Result = 0a208000, Performance =   5.32 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014148 s, Result = 0a226000, Performance =   4.93 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015001 s, Result = 0a244000, Performance =   5.01 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015688 s, Result = 0a262000, Performance =   5.13 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016357 s, Result = 0a280000, Performance =   5.25 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016640 s, Result = 0a29e000, Performance =   5.48 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017470 s, Result = 0a2bc000, Performance =   5.53 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018373 s, Result = 0a2da000, Performance =   5.55 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018619 s, Result = 0a2f8000, Performance =   5.77 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018979 s, Result = 0a316000, Performance =   5.94 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019540 s, Result = 0a334000, Performance =   6.04 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020303 s, Result = 0a352000, Performance =   6.08 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021145 s, Result = 0a370000, Performance =   6.09 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022057 s, Result = 0a38e000, Performance =   6.08 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.023358 s, Result = 0a3ac000, Performance =   5.98 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024469 s, Result = 0a3ca000, Performance =   5.92 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025620 s, Result = 0a3e8000, Performance =   5.87 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026865 s, Result = 0a406000, Performance =   5.80 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028252 s, Result = 0a424000, Performance =   5.70 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029652 s, Result = 0a442000, Performance =   5.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030907 s, Result = 0a460000, Performance =   5.56 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029096 s, Result = 0a47e000, Performance =   6.09 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.030055 s, Result = 0a49c000, Performance =   6.07 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.031297 s, Result = 0a4ba000, Performance =   6.00 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034441 s, Result = 0a4d8000, Performance =   5.61 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.033098 s, Result = 0a4f6000, Performance =   6.00 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.034074 s, Result = 0a514000, Performance =   5.99 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.035408 s, Result = 0a532000, Performance =   5.91 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.036427 s, Result = 0a550000, Performance =   5.90 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.037557 s, Result = 0a56e000, Performance =   5.86 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.038106 s, Result = 0a58c000, Performance =   5.92 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.038692 s, Result = 0a5aa000, Performance =   5.97 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.038711 s, Result = 0a5c8000, Performance =   6.10 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.040799 s, Result = 0a5e6000, Performance =   5.92 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041418 s, Result = 0a604000, Performance =   5.96 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.042153 s, Result = 0a622000, Performance =   5.99 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.043271 s, Result = 0a640000, Performance =   5.96 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.043458 s, Result = 0a65e000, Performance =   6.05 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.044861 s, Result = 0a67c000, Performance =   5.98 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.045182 s, Result = 0a69a000, Performance =   6.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.046312 s, Result = 0a6b8000, Performance =   6.03 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.046697 s, Result = 0a6d6000, Performance =   6.09 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.047969 s, Result = 0a6f4000, Performance =   6.04 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.048254 s, Result = 0a712000, Performance =   6.12 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.049905 s, Result = 0a730000, Performance =   6.02 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.050042 s, Result = 0a74e000, Performance =   6.12 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.051214 s, Result = 0a76c000, Performance =   6.08 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051314 s, Result = 0a78a000, Performance =   6.17 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.052145 s, Result = 0a7a8000, Performance =   6.18 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052761 s, Result = 0a7c6000, Performance =   6.21 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053549 s, Result = 0a7e4000, Performance =   6.22 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.054729 s, Result = 0a802000, Performance =   6.18 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055743 s, Result = 0a820000, Performance =   6.16 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   208  1829  1984
Test passed: M N K =  1931   849  1152
Test passed: M N K =   562  1134  1728
Test passed: M N K =  2016  1064   832
Test passed: M N K =  1941  2021   832
M N K =  1024  1024   256, Elapsed time =   0.000665 s, Result = 0001e000, Performance =   8.08 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001616 s, Result = 0003c000, Performance =   6.65 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002523 s, Result = 0005a000, Performance =   6.38 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003283 s, Result = 00078000, Performance =   6.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004150 s, Result = 00096000, Performance =   6.47 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005197 s, Result = 000b4000, Performance =   6.20 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006050 s, Result = 000d2000, Performance =   6.21 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005475 s, Result = 000f0000, Performance =   7.84 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005477 s, Result = 0010e000, Performance =   8.82 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005973 s, Result = 0012c000, Performance =   8.99 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006561 s, Result = 0014a000, Performance =   9.00 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007198 s, Result = 00168000, Performance =   8.95 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007920 s, Result = 00186000, Performance =   8.81 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008693 s, Result = 001a4000, Performance =   8.65 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009488 s, Result = 001c2000, Performance =   8.49 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010425 s, Result = 001e0000, Performance =   8.24 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011366 s, Result = 001fe000, Performance =   8.03 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011706 s, Result = 0021c000, Performance =   8.26 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013209 s, Result = 0023a000, Performance =   7.72 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014575 s, Result = 00258000, Performance =   7.37 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015390 s, Result = 00276000, Performance =   7.33 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016187 s, Result = 00294000, Performance =   7.30 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017087 s, Result = 002b2000, Performance =   7.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017905 s, Result = 002d0000, Performance =   7.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018837 s, Result = 002ee000, Performance =   7.13 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019661 s, Result = 0030c000, Performance =   7.10 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020441 s, Result = 0032a000, Performance =   7.09 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021152 s, Result = 00348000, Performance =   7.11 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021827 s, Result = 00366000, Performance =   7.13 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022564 s, Result = 00384000, Performance =   7.14 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023376 s, Result = 003a2000, Performance =   7.12 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024153 s, Result = 003c0000, Performance =   7.11 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023309 s, Result = 003de000, Performance =   7.60 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.024195 s, Result = 003fc000, Performance =   7.54 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025157 s, Result = 0041a000, Performance =   7.47 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026041 s, Result = 00438000, Performance =   7.42 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026802 s, Result = 00456000, Performance =   7.41 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027925 s, Result = 00474000, Performance =   7.31 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029125 s, Result = 00492000, Performance =   7.19 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030230 s, Result = 004b0000, Performance =   7.10 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031131 s, Result = 004ce000, Performance =   7.07 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031946 s, Result = 004ec000, Performance =   7.06 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033028 s, Result = 0050a000, Performance =   6.99 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034159 s, Result = 00528000, Performance =   6.92 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.035076 s, Result = 00546000, Performance =   6.89 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.036036 s, Result = 00564000, Performance =   6.85 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037164 s, Result = 00582000, Performance =   6.79 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037996 s, Result = 005a0000, Performance =   6.78 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.038443 s, Result = 005be000, Performance =   6.84 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039265 s, Result = 005dc000, Performance =   6.84 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040191 s, Result = 005fa000, Performance =   6.81 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.041012 s, Result = 00618000, Performance =   6.81 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043265 s, Result = 00636000, Performance =   6.58 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.043389 s, Result = 00654000, Performance =   6.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.044292 s, Result = 00672000, Performance =   6.67 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044674 s, Result = 00690000, Performance =   6.73 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.045866 s, Result = 006ae000, Performance =   6.67 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.046415 s, Result = 006cc000, Performance =   6.71 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.047008 s, Result = 006ea000, Performance =   6.74 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.047859 s, Result = 00708000, Performance =   6.73 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.048256 s, Result = 00726000, Performance =   6.79 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.049281 s, Result = 00744000, Performance =   6.75 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.050611 s, Result = 00762000, Performance =   6.68 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051467 s, Result = 00780000, Performance =   6.68 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1896  1015   384
Test passed: M N K =  1165  1201  1600
Test passed: M N K =  1378  1767   640
Test passed: M N K =  1884  1529    64
Test passed: M N K =   367    14   128
M N K =  1024  1024   256, Elapsed time =   0.005620 s, Result = 5902e000, Performance =   0.96 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006160 s, Result = 3104c000, Performance =   1.74 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006347 s, Result = 0906a000, Performance =   2.54 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006739 s, Result = e1088000, Performance =   3.19 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007082 s, Result = b90a6000, Performance =   3.79 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007577 s, Result = 910c4000, Performance =   4.25 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008233 s, Result = 690e2000, Performance =   4.56 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008852 s, Result = 41100000, Performance =   4.85 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009475 s, Result = 1911e000, Performance =   5.10 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010142 s, Result = f113c000, Performance =   5.29 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010952 s, Result = c915a000, Performance =   5.39 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011639 s, Result = a1178000, Performance =   5.54 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012676 s, Result = 79196000, Performance =   5.51 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013647 s, Result = 511b4000, Performance =   5.51 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013692 s, Result = 291d2000, Performance =   5.88 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015481 s, Result = 011f0000, Performance =   5.55 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016445 s, Result = d920e000, Performance =   5.55 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017060 s, Result = b122c000, Performance =   5.66 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017898 s, Result = 8924a000, Performance =   5.70 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018712 s, Result = 61268000, Performance =   5.74 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.019547 s, Result = 39286000, Performance =   5.77 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020341 s, Result = 112a4000, Performance =   5.81 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021105 s, Result = e92c2000, Performance =   5.85 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022065 s, Result = c12e0000, Performance =   5.84 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022927 s, Result = 992fe000, Performance =   5.85 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.023738 s, Result = 7131c000, Performance =   5.88 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024709 s, Result = 4933a000, Performance =   5.87 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025868 s, Result = 21358000, Performance =   5.81 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.026742 s, Result = f9376000, Performance =   5.82 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.027993 s, Result = d1394000, Performance =   5.75 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.028751 s, Result = a93b2000, Performance =   5.79 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030118 s, Result = 813d0000, Performance =   5.70 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.030113 s, Result = 593ee000, Performance =   5.88 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029707 s, Result = 3140c000, Performance =   6.14 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030797 s, Result = 0942a000, Performance =   6.10 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.031487 s, Result = e1448000, Performance =   6.14 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.032469 s, Result = b9466000, Performance =   6.12 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.033143 s, Result = 91484000, Performance =   6.16 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.034273 s, Result = 694a2000, Performance =   6.11 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.035521 s, Result = 414c0000, Performance =   6.05 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.036065 s, Result = 194de000, Performance =   6.10 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.036963 s, Result = f14fc000, Performance =   6.10 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.037595 s, Result = c951a000, Performance =   6.14 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.037716 s, Result = a1538000, Performance =   6.26 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.038618 s, Result = 79556000, Performance =   6.26 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040063 s, Result = 51574000, Performance =   6.16 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.040403 s, Result = 29592000, Performance =   6.25 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.041650 s, Result = 015b0000, Performance =   6.19 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.042019 s, Result = d95ce000, Performance =   6.26 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043488 s, Result = b15ec000, Performance =   6.17 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.043724 s, Result = 8960a000, Performance =   6.26 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.045028 s, Result = 61628000, Performance =   6.20 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.045718 s, Result = 39646000, Performance =   6.22 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.046895 s, Result = 11664000, Performance =   6.18 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.047170 s, Result = e9682000, Performance =   6.26 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.048536 s, Result = c16a0000, Performance =   6.19 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.048976 s, Result = 996be000, Performance =   6.25 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.050326 s, Result = 716dc000, Performance =   6.19 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.050739 s, Result = 496fa000, Performance =   6.24 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.052107 s, Result = 21718000, Performance =   6.18 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052889 s, Result = f9736000, Performance =   6.19 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053902 s, Result = d1754000, Performance =   6.18 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.053295 s, Result = a9772000, Performance =   6.35 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.054323 s, Result = 81790000, Performance =   6.33 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   431   494  1088
Test passed: M N K =  1366  1278   320
Test passed: M N K =  1327  1993   704
Test passed: M N K =  1550  1119   384
Test passed: M N K =   422   818  1664
M N K =  1024  1024   256, Elapsed time =   0.002943 s, Result = 0001e000, Performance =   1.82 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002883 s, Result = 0003c000, Performance =   3.72 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003370 s, Result = 0005a000, Performance =   4.78 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003856 s, Result = 00078000, Performance =   5.57 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004352 s, Result = 00096000, Performance =   6.17 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004900 s, Result = 000b4000, Performance =   6.57 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005483 s, Result = 000d2000, Performance =   6.85 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006063 s, Result = 000f0000, Performance =   7.08 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006731 s, Result = 0010e000, Performance =   7.18 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007366 s, Result = 0012c000, Performance =   7.29 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008031 s, Result = 0014a000, Performance =   7.35 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008681 s, Result = 00168000, Performance =   7.42 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009297 s, Result = 00186000, Performance =   7.51 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010078 s, Result = 001a4000, Performance =   7.46 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010927 s, Result = 001c2000, Performance =   7.37 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011699 s, Result = 001e0000, Performance =   7.34 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012561 s, Result = 001fe000, Performance =   7.27 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013571 s, Result = 0021c000, Performance =   7.12 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014589 s, Result = 0023a000, Performance =   6.99 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015537 s, Result = 00258000, Performance =   6.91 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016416 s, Result = 00276000, Performance =   6.87 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017160 s, Result = 00294000, Performance =   6.88 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017891 s, Result = 002b2000, Performance =   6.90 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018770 s, Result = 002d0000, Performance =   6.86 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019381 s, Result = 002ee000, Performance =   6.93 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020335 s, Result = 0030c000, Performance =   6.86 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020979 s, Result = 0032a000, Performance =   6.91 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021856 s, Result = 00348000, Performance =   6.88 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022376 s, Result = 00366000, Performance =   6.96 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023167 s, Result = 00384000, Performance =   6.95 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023935 s, Result = 003a2000, Performance =   6.95 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024906 s, Result = 003c0000, Performance =   6.90 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025319 s, Result = 003de000, Performance =   7.00 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027200 s, Result = 003fc000, Performance =   6.71 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027258 s, Result = 0041a000, Performance =   6.89 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028228 s, Result = 00438000, Performance =   6.85 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029199 s, Result = 00456000, Performance =   6.80 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030461 s, Result = 00474000, Performance =   6.70 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.031092 s, Result = 00492000, Performance =   6.73 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032401 s, Result = 004b0000, Performance =   6.63 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032917 s, Result = 004ce000, Performance =   6.69 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034061 s, Result = 004ec000, Performance =   6.62 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.034602 s, Result = 0050a000, Performance =   6.67 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.035817 s, Result = 00528000, Performance =   6.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036296 s, Result = 00546000, Performance =   6.66 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.037796 s, Result = 00564000, Performance =   6.53 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038343 s, Result = 00582000, Performance =   6.58 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039562 s, Result = 005a0000, Performance =   6.51 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039951 s, Result = 005be000, Performance =   6.58 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041310 s, Result = 005dc000, Performance =   6.50 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.041584 s, Result = 005fa000, Performance =   6.58 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.043135 s, Result = 00618000, Performance =   6.47 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043634 s, Result = 00636000, Performance =   6.52 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.045027 s, Result = 00654000, Performance =   6.44 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.045276 s, Result = 00672000, Performance =   6.52 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046656 s, Result = 00690000, Performance =   6.44 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046798 s, Result = 006ae000, Performance =   6.54 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.048189 s, Result = 006cc000, Performance =   6.46 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.048938 s, Result = 006ea000, Performance =   6.47 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.049809 s, Result = 00708000, Performance =   6.47 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.050464 s, Result = 00726000, Performance =   6.49 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.052571 s, Result = 00744000, Performance =   6.33 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.052276 s, Result = 00762000, Performance =   6.47 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.053945 s, Result = 00780000, Performance =   6.37 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1756  1399   192
Test passed: M N K =  1328   944   768
Test passed: M N K =   281   496   640
Test passed: M N K =  1776   722  1408
Test passed: M N K =   344  1965   512
M N K =  1024  1024   256, Elapsed time =   0.004698 s, Result = 0a0be000, Performance =   1.14 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006117 s, Result = 0a0dc000, Performance =   1.76 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006747 s, Result = 0a0fa000, Performance =   2.39 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007430 s, Result = 0a118000, Performance =   2.89 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008022 s, Result = 0a136000, Performance =   3.35 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008639 s, Result = 0a154000, Performance =   3.73 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009178 s, Result = 0a172000, Performance =   4.09 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009533 s, Result = 0a190000, Performance =   4.51 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009943 s, Result = 0a1ae000, Performance =   4.86 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010795 s, Result = 0a1cc000, Performance =   4.97 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011092 s, Result = 0a1ea000, Performance =   5.32 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011351 s, Result = 0a208000, Performance =   5.68 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012069 s, Result = 0a226000, Performance =   5.78 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012983 s, Result = 0a244000, Performance =   5.79 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013661 s, Result = 0a262000, Performance =   5.89 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014369 s, Result = 0a280000, Performance =   5.98 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015198 s, Result = 0a29e000, Performance =   6.01 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015880 s, Result = 0a2bc000, Performance =   6.09 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016713 s, Result = 0a2da000, Performance =   6.10 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017343 s, Result = 0a2f8000, Performance =   6.19 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018152 s, Result = 0a316000, Performance =   6.21 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018824 s, Result = 0a334000, Performance =   6.27 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019484 s, Result = 0a352000, Performance =   6.34 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020334 s, Result = 0a370000, Performance =   6.34 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020959 s, Result = 0a38e000, Performance =   6.40 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021651 s, Result = 0a3ac000, Performance =   6.45 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022186 s, Result = 0a3ca000, Performance =   6.53 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023021 s, Result = 0a3e8000, Performance =   6.53 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023721 s, Result = 0a406000, Performance =   6.56 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024625 s, Result = 0a424000, Performance =   6.54 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026259 s, Result = 0a442000, Performance =   6.34 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026652 s, Result = 0a460000, Performance =   6.45 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026885 s, Result = 0a47e000, Performance =   6.59 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026682 s, Result = 0a49c000, Performance =   6.84 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027556 s, Result = 0a4ba000, Performance =   6.82 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028850 s, Result = 0a4d8000, Performance =   6.70 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029648 s, Result = 0a4f6000, Performance =   6.70 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.031288 s, Result = 0a514000, Performance =   6.52 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.031932 s, Result = 0a532000, Performance =   6.56 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033089 s, Result = 0a550000, Performance =   6.49 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033668 s, Result = 0a56e000, Performance =   6.54 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034885 s, Result = 0a58c000, Performance =   6.46 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035267 s, Result = 0a5aa000, Performance =   6.55 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036309 s, Result = 0a5c8000, Performance =   6.51 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036950 s, Result = 0a5e6000, Performance =   6.54 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.038603 s, Result = 0a604000, Performance =   6.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038608 s, Result = 0a622000, Performance =   6.54 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.040081 s, Result = 0a640000, Performance =   6.43 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040201 s, Result = 0a65e000, Performance =   6.54 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041574 s, Result = 0a67c000, Performance =   6.46 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.042472 s, Result = 0a69a000, Performance =   6.45 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.043481 s, Result = 0a6b8000, Performance =   6.42 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043604 s, Result = 0a6d6000, Performance =   6.53 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.045132 s, Result = 0a6f4000, Performance =   6.42 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.045366 s, Result = 0a712000, Performance =   6.51 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046767 s, Result = 0a730000, Performance =   6.43 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046903 s, Result = 0a74e000, Performance =   6.52 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.048378 s, Result = 0a76c000, Performance =   6.44 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.048687 s, Result = 0a78a000, Performance =   6.51 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.049687 s, Result = 0a7a8000, Performance =   6.48 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.050187 s, Result = 0a7c6000, Performance =   6.53 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.052152 s, Result = 0a7e4000, Performance =   6.38 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.051370 s, Result = 0a802000, Performance =   6.58 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.052497 s, Result = 0a820000, Performance =   6.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   227  1554  1792
Test passed: M N K =     4  1649   320
Test passed: M N K =  1781  1659   448
Test passed: M N K =  1335  2013  1024
Test passed: M N K =  1875   615   128
M N K =  1024  1024   256, Elapsed time =   0.000650 s, Result = 0001e000, Performance =   8.26 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001472 s, Result = 0003c000, Performance =   7.29 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002351 s, Result = 0005a000, Performance =   6.85 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003206 s, Result = 00078000, Performance =   6.70 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004111 s, Result = 00096000, Performance =   6.53 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004916 s, Result = 000b4000, Performance =   6.55 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005818 s, Result = 000d2000, Performance =   6.46 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006525 s, Result = 000f0000, Performance =   6.58 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007507 s, Result = 0010e000, Performance =   6.44 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008442 s, Result = 0012c000, Performance =   6.36 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009379 s, Result = 0014a000, Performance =   6.30 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010071 s, Result = 00168000, Performance =   6.40 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011002 s, Result = 00186000, Performance =   6.34 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011894 s, Result = 001a4000, Performance =   6.32 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012921 s, Result = 001c2000, Performance =   6.23 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013148 s, Result = 001e0000, Performance =   6.53 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013962 s, Result = 001fe000, Performance =   6.54 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014254 s, Result = 0021c000, Performance =   6.78 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012627 s, Result = 0023a000, Performance =   8.08 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013705 s, Result = 00258000, Performance =   7.83 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015040 s, Result = 00276000, Performance =   7.50 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015446 s, Result = 00294000, Performance =   7.65 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016177 s, Result = 002b2000, Performance =   7.63 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017195 s, Result = 002d0000, Performance =   7.49 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017916 s, Result = 002ee000, Performance =   7.49 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018816 s, Result = 0030c000, Performance =   7.42 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019511 s, Result = 0032a000, Performance =   7.43 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020497 s, Result = 00348000, Performance =   7.33 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020995 s, Result = 00366000, Performance =   7.42 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022054 s, Result = 00384000, Performance =   7.30 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022870 s, Result = 003a2000, Performance =   7.28 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023857 s, Result = 003c0000, Performance =   7.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023848 s, Result = 003de000, Performance =   7.43 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023616 s, Result = 003fc000, Performance =   7.73 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025020 s, Result = 0041a000, Performance =   7.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025481 s, Result = 00438000, Performance =   7.59 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026328 s, Result = 00456000, Performance =   7.54 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028026 s, Result = 00474000, Performance =   7.28 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028421 s, Result = 00492000, Performance =   7.37 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029641 s, Result = 004b0000, Performance =   7.24 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030387 s, Result = 004ce000, Performance =   7.24 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030756 s, Result = 004ec000, Performance =   7.33 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.031543 s, Result = 0050a000, Performance =   7.32 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.032886 s, Result = 00528000, Performance =   7.18 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033630 s, Result = 00546000, Performance =   7.18 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033671 s, Result = 00564000, Performance =   7.33 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034790 s, Result = 00582000, Performance =   7.25 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.036068 s, Result = 005a0000, Performance =   7.14 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036320 s, Result = 005be000, Performance =   7.24 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037487 s, Result = 005dc000, Performance =   7.16 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037964 s, Result = 005fa000, Performance =   7.21 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.039415 s, Result = 00618000, Performance =   7.08 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.039710 s, Result = 00636000, Performance =   7.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040887 s, Result = 00654000, Performance =   7.09 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.041033 s, Result = 00672000, Performance =   7.20 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.042358 s, Result = 00690000, Performance =   7.10 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.043874 s, Result = 006ae000, Performance =   6.97 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043631 s, Result = 006cc000, Performance =   7.14 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.044131 s, Result = 006ea000, Performance =   7.18 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.045220 s, Result = 00708000, Performance =   7.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.045436 s, Result = 00726000, Performance =   7.21 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.047234 s, Result = 00744000, Performance =   7.05 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046217 s, Result = 00762000, Performance =   7.32 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.047841 s, Result = 00780000, Performance =   7.18 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1012  1279  1984
Test passed: M N K =  1405  1851  2048
Test passed: M N K =    86   989   192
Test passed: M N K =  2012   687   384
Test passed: M N K =   666   149  1408
M N K =  1024  1024   256, Elapsed time =   0.005214 s, Result = 5902e000, Performance =   1.03 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005404 s, Result = 3104c000, Performance =   1.99 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005906 s, Result = 0906a000, Performance =   2.73 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006477 s, Result = e1088000, Performance =   3.32 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007108 s, Result = b90a6000, Performance =   3.78 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007719 s, Result = 910c4000, Performance =   4.17 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008254 s, Result = 690e2000, Performance =   4.55 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008872 s, Result = 41100000, Performance =   4.84 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009512 s, Result = 1911e000, Performance =   5.08 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010670 s, Result = f113c000, Performance =   5.03 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010967 s, Result = c915a000, Performance =   5.39 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011628 s, Result = a1178000, Performance =   5.54 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012551 s, Result = 79196000, Performance =   5.56 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013346 s, Result = 511b4000, Performance =   5.63 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014224 s, Result = 291d2000, Performance =   5.66 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015105 s, Result = 011f0000, Performance =   5.69 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015668 s, Result = d920e000, Performance =   5.82 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016355 s, Result = b122c000, Performance =   5.91 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.017070 s, Result = 8924a000, Performance =   5.98 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017649 s, Result = 61268000, Performance =   6.08 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018474 s, Result = 39286000, Performance =   6.10 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019199 s, Result = 112a4000, Performance =   6.15 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019986 s, Result = e92c2000, Performance =   6.18 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020579 s, Result = c12e0000, Performance =   6.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021250 s, Result = 992fe000, Performance =   6.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021970 s, Result = 7131c000, Performance =   6.35 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022895 s, Result = 4933a000, Performance =   6.33 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023503 s, Result = 21358000, Performance =   6.40 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024384 s, Result = f9376000, Performance =   6.38 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025396 s, Result = d1394000, Performance =   6.34 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026218 s, Result = a93b2000, Performance =   6.35 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027148 s, Result = 813d0000, Performance =   6.33 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.029214 s, Result = 593ee000, Performance =   6.06 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029113 s, Result = 3140c000, Performance =   6.27 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.029799 s, Result = 0942a000, Performance =   6.31 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030273 s, Result = e1448000, Performance =   6.38 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.031152 s, Result = b9466000, Performance =   6.38 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032074 s, Result = 91484000, Performance =   6.36 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032952 s, Result = 694a2000, Performance =   6.35 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033633 s, Result = 414c0000, Performance =   6.39 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034171 s, Result = 194de000, Performance =   6.44 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.035166 s, Result = f14fc000, Performance =   6.41 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035998 s, Result = c951a000, Performance =   6.41 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036785 s, Result = a1538000, Performance =   6.42 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.037560 s, Result = 79556000, Performance =   6.43 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.038559 s, Result = 51574000, Performance =   6.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.039678 s, Result = 29592000, Performance =   6.36 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.040318 s, Result = 015b0000, Performance =   6.39 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.041301 s, Result = d95ce000, Performance =   6.37 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.042028 s, Result = b15ec000, Performance =   6.39 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.042961 s, Result = 8960a000, Performance =   6.37 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.043749 s, Result = 61628000, Performance =   6.38 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.044665 s, Result = 39646000, Performance =   6.37 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.045601 s, Result = 11664000, Performance =   6.36 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.046888 s, Result = e9682000, Performance =   6.30 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.047071 s, Result = c16a0000, Performance =   6.39 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.048242 s, Result = 996be000, Performance =   6.34 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.049677 s, Result = 716dc000, Performance =   6.27 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.049365 s, Result = 496fa000, Performance =   6.42 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051420 s, Result = 21718000, Performance =   6.26 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.049941 s, Result = f9736000, Performance =   6.56 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053607 s, Result = d1754000, Performance =   6.21 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.053306 s, Result = a9772000, Performance =   6.35 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.054965 s, Result = 81790000, Performance =   6.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1165  1374  1792
Test passed: M N K =   660  1873   320
Test passed: M N K =   482  2025    64
Test passed: M N K =   246   977  1536
Test passed: M N K =   141   215   512
M N K =  1024  1024   256, Elapsed time =   0.003598 s, Result = 0001e000, Performance =   1.49 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004092 s, Result = 0003c000, Performance =   2.62 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003903 s, Result = 0005a000, Performance =   4.13 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004023 s, Result = 00078000, Performance =   5.34 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004509 s, Result = 00096000, Performance =   5.95 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004995 s, Result = 000b4000, Performance =   6.45 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005524 s, Result = 000d2000, Performance =   6.80 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006173 s, Result = 000f0000, Performance =   6.96 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006798 s, Result = 0010e000, Performance =   7.11 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007371 s, Result = 0012c000, Performance =   7.28 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008044 s, Result = 0014a000, Performance =   7.34 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008590 s, Result = 00168000, Performance =   7.50 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009316 s, Result = 00186000, Performance =   7.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010120 s, Result = 001a4000, Performance =   7.43 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010874 s, Result = 001c2000, Performance =   7.41 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011866 s, Result = 001e0000, Performance =   7.24 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012718 s, Result = 001fe000, Performance =   7.18 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014322 s, Result = 0021c000, Performance =   6.75 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014499 s, Result = 0023a000, Performance =   7.04 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015104 s, Result = 00258000, Performance =   7.11 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015758 s, Result = 00276000, Performance =   7.15 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016285 s, Result = 00294000, Performance =   7.25 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016953 s, Result = 002b2000, Performance =   7.28 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017475 s, Result = 002d0000, Performance =   7.37 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018710 s, Result = 002ee000, Performance =   7.17 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019338 s, Result = 0030c000, Performance =   7.22 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020080 s, Result = 0032a000, Performance =   7.22 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022156 s, Result = 00348000, Performance =   6.78 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023139 s, Result = 00366000, Performance =   6.73 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024240 s, Result = 00384000, Performance =   6.64 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024840 s, Result = 003a2000, Performance =   6.70 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025910 s, Result = 003c0000, Performance =   6.63 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026545 s, Result = 003de000, Performance =   6.67 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027281 s, Result = 003fc000, Performance =   6.69 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028153 s, Result = 0041a000, Performance =   6.67 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026686 s, Result = 00438000, Performance =   7.24 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028406 s, Result = 00456000, Performance =   6.99 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029644 s, Result = 00474000, Performance =   6.88 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030309 s, Result = 00492000, Performance =   6.91 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030907 s, Result = 004b0000, Performance =   6.95 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031787 s, Result = 004ce000, Performance =   6.92 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032758 s, Result = 004ec000, Performance =   6.88 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033279 s, Result = 0050a000, Performance =   6.94 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034298 s, Result = 00528000, Performance =   6.89 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034887 s, Result = 00546000, Performance =   6.92 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.036087 s, Result = 00564000, Performance =   6.84 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037008 s, Result = 00582000, Performance =   6.82 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037918 s, Result = 005a0000, Performance =   6.80 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.038753 s, Result = 005be000, Performance =   6.79 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039758 s, Result = 005dc000, Performance =   6.75 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040520 s, Result = 005fa000, Performance =   6.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.041132 s, Result = 00618000, Performance =   6.79 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.042039 s, Result = 00636000, Performance =   6.77 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.042900 s, Result = 00654000, Performance =   6.76 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.044125 s, Result = 00672000, Performance =   6.69 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044337 s, Result = 00690000, Performance =   6.78 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.045434 s, Result = 006ae000, Performance =   6.74 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.046738 s, Result = 006cc000, Performance =   6.66 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.046083 s, Result = 006ea000, Performance =   6.87 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.048091 s, Result = 00708000, Performance =   6.70 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.047117 s, Result = 00726000, Performance =   6.95 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.049239 s, Result = 00744000, Performance =   6.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.050672 s, Result = 00762000, Performance =   6.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.052013 s, Result = 00780000, Performance =   6.61 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   469   953  1024
Test passed: M N K =   889   225   576
Test passed: M N K =  1796   133  1664
Test passed: M N K =  1367   931   320
Test passed: M N K =  1520   626  1664
M N K =  1024  1024   256, Elapsed time =   0.004561 s, Result = 0a0be000, Performance =   1.18 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006112 s, Result = 0a0dc000, Performance =   1.76 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006480 s, Result = 0a0fa000, Performance =   2.49 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007190 s, Result = 0a118000, Performance =   2.99 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008196 s, Result = 0a136000, Performance =   3.28 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009299 s, Result = 0a154000, Performance =   3.46 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009774 s, Result = 0a172000, Performance =   3.85 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010736 s, Result = 0a190000, Performance =   4.00 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011331 s, Result = 0a1ae000, Performance =   4.26 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.012271 s, Result = 0a1cc000, Performance =   4.38 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012381 s, Result = 0a1ea000, Performance =   4.77 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012784 s, Result = 0a208000, Performance =   5.04 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013271 s, Result = 0a226000, Performance =   5.26 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013672 s, Result = 0a244000, Performance =   5.50 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013767 s, Result = 0a262000, Performance =   5.85 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014626 s, Result = 0a280000, Performance =   5.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015340 s, Result = 0a29e000, Performance =   5.95 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.016233 s, Result = 0a2bc000, Performance =   5.95 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016794 s, Result = 0a2da000, Performance =   6.07 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016513 s, Result = 0a2f8000, Performance =   6.50 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017467 s, Result = 0a316000, Performance =   6.45 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018047 s, Result = 0a334000, Performance =   6.54 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018613 s, Result = 0a352000, Performance =   6.63 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019130 s, Result = 0a370000, Performance =   6.74 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019765 s, Result = 0a38e000, Performance =   6.79 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020674 s, Result = 0a3ac000, Performance =   6.75 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021315 s, Result = 0a3ca000, Performance =   6.80 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022673 s, Result = 0a3e8000, Performance =   6.63 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023385 s, Result = 0a406000, Performance =   6.66 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024325 s, Result = 0a424000, Performance =   6.62 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025167 s, Result = 0a442000, Performance =   6.61 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026756 s, Result = 0a460000, Performance =   6.42 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027450 s, Result = 0a47e000, Performance =   6.45 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028217 s, Result = 0a49c000, Performance =   6.47 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028908 s, Result = 0a4ba000, Performance =   6.50 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029511 s, Result = 0a4d8000, Performance =   6.55 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030231 s, Result = 0a4f6000, Performance =   6.57 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.031194 s, Result = 0a514000, Performance =   6.54 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032236 s, Result = 0a532000, Performance =   6.50 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032874 s, Result = 0a550000, Performance =   6.53 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033950 s, Result = 0a56e000, Performance =   6.48 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034481 s, Result = 0a58c000, Performance =   6.54 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035136 s, Result = 0a5aa000, Performance =   6.57 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036172 s, Result = 0a5c8000, Performance =   6.53 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.037023 s, Result = 0a5e6000, Performance =   6.53 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.037889 s, Result = 0a604000, Performance =   6.52 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.039018 s, Result = 0a622000, Performance =   6.47 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039933 s, Result = 0a640000, Performance =   6.45 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040624 s, Result = 0a65e000, Performance =   6.48 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041622 s, Result = 0a67c000, Performance =   6.45 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.042121 s, Result = 0a69a000, Performance =   6.50 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042844 s, Result = 0a6b8000, Performance =   6.52 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043929 s, Result = 0a6d6000, Performance =   6.48 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044490 s, Result = 0a6f4000, Performance =   6.52 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.045447 s, Result = 0a712000, Performance =   6.50 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045729 s, Result = 0a730000, Performance =   6.57 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046190 s, Result = 0a74e000, Performance =   6.63 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.047785 s, Result = 0a76c000, Performance =   6.52 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.047665 s, Result = 0a78a000, Performance =   6.65 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.049157 s, Result = 0a7a8000, Performance =   6.55 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.048102 s, Result = 0a7c6000, Performance =   6.81 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.048875 s, Result = 0a7e4000, Performance =   6.81 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.050794 s, Result = 0a802000, Performance =   6.66 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051579 s, Result = 0a820000, Performance =   6.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   654  1093  1216
Test passed: M N K =   249   867   896
Test passed: M N K =  1629   511   768
Test passed: M N K =   284   325   896
Test passed: M N K =  1984  1480   128
M N K =  1024  1024   256, Elapsed time =   0.000647 s, Result = 0001e000, Performance =   8.30 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001417 s, Result = 0003c000, Performance =   7.58 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001944 s, Result = 0005a000, Performance =   8.29 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002529 s, Result = 00078000, Performance =   8.49 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003055 s, Result = 00096000, Performance =   8.79 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003412 s, Result = 000b4000, Performance =   9.44 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.003819 s, Result = 000d2000, Performance =   9.84 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004270 s, Result = 000f0000, Performance =  10.06 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.004861 s, Result = 0010e000, Performance =   9.94 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005465 s, Result = 0012c000, Performance =   9.82 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006010 s, Result = 0014a000, Performance =   9.83 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.006592 s, Result = 00168000, Performance =   9.77 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007326 s, Result = 00186000, Performance =   9.53 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.007859 s, Result = 001a4000, Performance =   9.56 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008567 s, Result = 001c2000, Performance =   9.40 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009265 s, Result = 001e0000, Performance =   9.27 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010101 s, Result = 001fe000, Performance =   9.04 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010844 s, Result = 0021c000, Performance =   8.91 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012045 s, Result = 0023a000, Performance =   8.47 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012884 s, Result = 00258000, Performance =   8.33 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013688 s, Result = 00276000, Performance =   8.24 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014579 s, Result = 00294000, Performance =   8.10 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015265 s, Result = 002b2000, Performance =   8.09 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015948 s, Result = 002d0000, Performance =   8.08 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016629 s, Result = 002ee000, Performance =   8.07 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017413 s, Result = 0030c000, Performance =   8.02 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018000 s, Result = 0032a000, Performance =   8.05 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018917 s, Result = 00348000, Performance =   7.95 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019618 s, Result = 00366000, Performance =   7.94 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020634 s, Result = 00384000, Performance =   7.81 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020883 s, Result = 003a2000, Performance =   7.97 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021792 s, Result = 003c0000, Performance =   7.88 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022308 s, Result = 003de000, Performance =   7.94 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022997 s, Result = 003fc000, Performance =   7.94 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023590 s, Result = 0041a000, Performance =   7.97 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024021 s, Result = 00438000, Performance =   8.05 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024800 s, Result = 00456000, Performance =   8.01 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.027317 s, Result = 00474000, Performance =   7.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027188 s, Result = 00492000, Performance =   7.70 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.028349 s, Result = 004b0000, Performance =   7.58 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.028908 s, Result = 004ce000, Performance =   7.61 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029814 s, Result = 004ec000, Performance =   7.56 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030936 s, Result = 0050a000, Performance =   7.46 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031594 s, Result = 00528000, Performance =   7.48 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032444 s, Result = 00546000, Performance =   7.45 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033419 s, Result = 00564000, Performance =   7.39 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034476 s, Result = 00582000, Performance =   7.32 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035259 s, Result = 005a0000, Performance =   7.31 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.036291 s, Result = 005be000, Performance =   7.25 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.037126 s, Result = 005dc000, Performance =   7.23 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037956 s, Result = 005fa000, Performance =   7.21 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038349 s, Result = 00618000, Performance =   7.28 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.040693 s, Result = 00636000, Performance =   6.99 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.040008 s, Result = 00654000, Performance =   7.25 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040974 s, Result = 00672000, Performance =   7.21 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.041334 s, Result = 00690000, Performance =   7.27 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042448 s, Result = 006ae000, Performance =   7.21 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043035 s, Result = 006cc000, Performance =   7.24 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.042914 s, Result = 006ea000, Performance =   7.38 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.044477 s, Result = 00708000, Performance =   7.24 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044148 s, Result = 00726000, Performance =   7.42 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.046025 s, Result = 00744000, Performance =   7.23 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.047831 s, Result = 00762000, Performance =   7.07 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.049445 s, Result = 00780000, Performance =   6.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    31  1580   128
Test passed: M N K =  1322     5  1472
Test passed: M N K =   418   835  1088
Test passed: M N K =   938   402   768
Test passed: M N K =  1841  1850   448
M N K =  1024  1024   256, Elapsed time =   0.005655 s, Result = f5042000, Performance =   0.95 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006054 s, Result = a9074000, Performance =   1.77 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006964 s, Result = 5d0a6000, Performance =   2.31 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007905 s, Result = 110d8000, Performance =   2.72 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008895 s, Result = c510a000, Performance =   3.02 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009872 s, Result = 7913c000, Performance =   3.26 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010918 s, Result = 2d16e000, Performance =   3.44 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011991 s, Result = e11a0000, Performance =   3.58 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013269 s, Result = 951d2000, Performance =   3.64 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014561 s, Result = 49204000, Performance =   3.69 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015693 s, Result = fd236000, Performance =   3.76 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016834 s, Result = b1268000, Performance =   3.83 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017978 s, Result = 6529a000, Performance =   3.88 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.019012 s, Result = 192cc000, Performance =   3.95 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.020055 s, Result = cd2fe000, Performance =   4.02 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.021224 s, Result = 81330000, Performance =   4.05 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021684 s, Result = 35362000, Performance =   4.21 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022854 s, Result = e9394000, Performance =   4.23 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023863 s, Result = 9d3c6000, Performance =   4.27 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024950 s, Result = 513f8000, Performance =   4.30 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.026963 s, Result = 0542a000, Performance =   4.18 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027218 s, Result = b945c000, Performance =   4.34 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.028476 s, Result = 6d48e000, Performance =   4.34 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.029588 s, Result = 214c0000, Performance =   4.35 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030757 s, Result = d54f2000, Performance =   4.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.032185 s, Result = 89524000, Performance =   4.34 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033404 s, Result = 3d556000, Performance =   4.34 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.034504 s, Result = f1588000, Performance =   4.36 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.035875 s, Result = a55ba000, Performance =   4.34 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036946 s, Result = 595ec000, Performance =   4.36 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.038035 s, Result = 0d61e000, Performance =   4.38 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.039318 s, Result = c1650000, Performance =   4.37 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039466 s, Result = 75682000, Performance =   4.49 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040684 s, Result = 296b4000, Performance =   4.49 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.041840 s, Result = dd6e6000, Performance =   4.49 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.043257 s, Result = 91718000, Performance =   4.47 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.044638 s, Result = 4574a000, Performance =   4.45 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.045688 s, Result = f977c000, Performance =   4.47 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.047382 s, Result = ad7ae000, Performance =   4.42 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.048721 s, Result = 617e0000, Performance =   4.41 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.050036 s, Result = 15812000, Performance =   4.40 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.051390 s, Result = c9844000, Performance =   4.39 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.052149 s, Result = 7d876000, Performance =   4.43 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.054101 s, Result = 318a8000, Performance =   4.37 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.059354 s, Result = e58da000, Performance =   4.07 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.059000 s, Result = 9990c000, Performance =   4.19 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.060025 s, Result = 4d93e000, Performance =   4.20 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.061887 s, Result = 01970000, Performance =   4.16 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.062360 s, Result = b59a2000, Performance =   4.22 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.064254 s, Result = 699d4000, Performance =   4.18 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.065246 s, Result = 1da06000, Performance =   4.20 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.067037 s, Result = d1a38000, Performance =   4.16 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.067278 s, Result = 85a6a000, Performance =   4.23 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.068732 s, Result = 39a9c000, Performance =   4.22 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.069875 s, Result = edace000, Performance =   4.23 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.071740 s, Result = a1b00000, Performance =   4.19 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.072913 s, Result = 55b32000, Performance =   4.20 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.074294 s, Result = 09b64000, Performance =   4.19 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.074218 s, Result = bdb96000, Performance =   4.27 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.076289 s, Result = 71bc8000, Performance =   4.22 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.077507 s, Result = 25bfa000, Performance =   4.23 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.078687 s, Result = d9c2c000, Performance =   4.23 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.080352 s, Result = 8dc5e000, Performance =   4.21 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.082830 s, Result = 41c90000, Performance =   4.15 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   244   674  1984
Test passed: M N K =  1075   355  1792
Test passed: M N K =   491  1017  1152
Test passed: M N K =   977  1055  1792
Test passed: M N K =   582  1507  1856
M N K =  1024  1024   256, Elapsed time =   0.003988 s, Result = 00032000, Performance =   1.35 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004969 s, Result = 00064000, Performance =   2.16 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005018 s, Result = 00096000, Performance =   3.21 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005690 s, Result = 000c8000, Performance =   3.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006630 s, Result = 000fa000, Performance =   4.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007609 s, Result = 0012c000, Performance =   4.23 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009494 s, Result = 0015e000, Performance =   3.96 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010603 s, Result = 00190000, Performance =   4.05 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012284 s, Result = 001c2000, Performance =   3.93 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013484 s, Result = 001f4000, Performance =   3.98 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014165 s, Result = 00226000, Performance =   4.17 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016486 s, Result = 00258000, Performance =   3.91 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016006 s, Result = 0028a000, Performance =   4.36 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017128 s, Result = 002bc000, Performance =   4.39 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017960 s, Result = 002ee000, Performance =   4.48 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018940 s, Result = 00320000, Performance =   4.54 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020256 s, Result = 00352000, Performance =   4.51 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021411 s, Result = 00384000, Performance =   4.51 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022536 s, Result = 003b6000, Performance =   4.53 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023310 s, Result = 003e8000, Performance =   4.61 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024312 s, Result = 0041a000, Performance =   4.64 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025386 s, Result = 0044c000, Performance =   4.65 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026618 s, Result = 0047e000, Performance =   4.64 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027877 s, Result = 004b0000, Performance =   4.62 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.029322 s, Result = 004e2000, Performance =   4.58 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030957 s, Result = 00514000, Performance =   4.51 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.032456 s, Result = 00546000, Performance =   4.47 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033379 s, Result = 00578000, Performance =   4.50 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.034790 s, Result = 005aa000, Performance =   4.48 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.036380 s, Result = 005dc000, Performance =   4.43 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.037578 s, Result = 0060e000, Performance =   4.43 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.038643 s, Result = 00640000, Performance =   4.45 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038031 s, Result = 00672000, Performance =   4.66 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039524 s, Result = 006a4000, Performance =   4.62 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040650 s, Result = 006d6000, Performance =   4.62 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041821 s, Result = 00708000, Performance =   4.62 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043546 s, Result = 0073a000, Performance =   4.56 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044510 s, Result = 0076c000, Performance =   4.58 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.045661 s, Result = 0079e000, Performance =   4.59 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.052190 s, Result = 007d0000, Performance =   4.11 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.052945 s, Result = 00802000, Performance =   4.16 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.055417 s, Result = 00834000, Performance =   4.07 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.055558 s, Result = 00866000, Performance =   4.16 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.058454 s, Result = 00898000, Performance =   4.04 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.059279 s, Result = 008ca000, Performance =   4.08 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.061807 s, Result = 008fc000, Performance =   4.00 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.061255 s, Result = 0092e000, Performance =   4.12 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.058369 s, Result = 00960000, Performance =   4.41 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058220 s, Result = 00992000, Performance =   4.52 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.060208 s, Result = 009c4000, Performance =   4.46 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061196 s, Result = 009f6000, Performance =   4.47 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.062973 s, Result = 00a28000, Performance =   4.43 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.063890 s, Result = 00a5a000, Performance =   4.45 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.065059 s, Result = 00a8c000, Performance =   4.46 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.066343 s, Result = 00abe000, Performance =   4.45 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.067348 s, Result = 00af0000, Performance =   4.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.070122 s, Result = 00b22000, Performance =   4.36 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.070420 s, Result = 00b54000, Performance =   4.42 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.071222 s, Result = 00b86000, Performance =   4.45 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.072115 s, Result = 00bb8000, Performance =   4.47 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.074313 s, Result = 00bea000, Performance =   4.41 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.074915 s, Result = 00c1c000, Performance =   4.44 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.077135 s, Result = 00c4e000, Performance =   4.38 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.079056 s, Result = 00c80000, Performance =   4.35 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   508   957    64
Test passed: M N K =   411  1480   960
Test passed: M N K =   714   193  1664
Test passed: M N K =  1640  1322   704
Test passed: M N K =   355   258  2048
M N K =  1024  1024   256, Elapsed time =   0.004921 s, Result = 0a0d2000, Performance =   1.09 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005399 s, Result = 0a104000, Performance =   1.99 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006083 s, Result = 0a136000, Performance =   2.65 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007072 s, Result = 0a168000, Performance =   3.04 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008084 s, Result = 0a19a000, Performance =   3.32 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009096 s, Result = 0a1cc000, Performance =   3.54 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010139 s, Result = 0a1fe000, Performance =   3.71 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011373 s, Result = 0a230000, Performance =   3.78 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012698 s, Result = 0a262000, Performance =   3.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014089 s, Result = 0a294000, Performance =   3.81 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015292 s, Result = 0a2c6000, Performance =   3.86 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.016351 s, Result = 0a2f8000, Performance =   3.94 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017483 s, Result = 0a32a000, Performance =   3.99 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.018546 s, Result = 0a35c000, Performance =   4.05 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019646 s, Result = 0a38e000, Performance =   4.10 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.020665 s, Result = 0a3c0000, Performance =   4.16 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.021388 s, Result = 0a3f2000, Performance =   4.27 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.022361 s, Result = 0a424000, Performance =   4.32 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.023428 s, Result = 0a456000, Performance =   4.35 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024397 s, Result = 0a488000, Performance =   4.40 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.025530 s, Result = 0a4ba000, Performance =   4.42 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.026552 s, Result = 0a4ec000, Performance =   4.45 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027673 s, Result = 0a51e000, Performance =   4.46 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.028873 s, Result = 0a550000, Performance =   4.46 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.030031 s, Result = 0a582000, Performance =   4.47 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.033863 s, Result = 0a5b4000, Performance =   4.12 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.033892 s, Result = 0a5e6000, Performance =   4.28 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.035358 s, Result = 0a618000, Performance =   4.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.036966 s, Result = 0a64a000, Performance =   4.21 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.038497 s, Result = 0a67c000, Performance =   4.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.040120 s, Result = 0a6ae000, Performance =   4.15 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.041282 s, Result = 0a6e0000, Performance =   4.16 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039918 s, Result = 0a712000, Performance =   4.44 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.041477 s, Result = 0a744000, Performance =   4.40 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.042801 s, Result = 0a776000, Performance =   4.39 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.043887 s, Result = 0a7a8000, Performance =   4.40 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.045120 s, Result = 0a7da000, Performance =   4.40 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.046154 s, Result = 0a80c000, Performance =   4.42 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.047710 s, Result = 0a83e000, Performance =   4.39 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.048906 s, Result = 0a870000, Performance =   4.39 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.050627 s, Result = 0a8a2000, Performance =   4.35 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.051606 s, Result = 0a8d4000, Performance =   4.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.053227 s, Result = 0a906000, Performance =   4.34 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.054466 s, Result = 0a938000, Performance =   4.34 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.056364 s, Result = 0a96a000, Performance =   4.29 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.056785 s, Result = 0a99c000, Performance =   4.35 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.057994 s, Result = 0a9ce000, Performance =   4.35 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.059174 s, Result = 0aa00000, Performance =   4.35 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.060172 s, Result = 0aa32000, Performance =   4.37 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.061915 s, Result = 0aa64000, Performance =   4.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.063088 s, Result = 0aa96000, Performance =   4.34 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.063607 s, Result = 0aac8000, Performance =   4.39 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.064615 s, Result = 0aafa000, Performance =   4.40 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.065534 s, Result = 0ab2c000, Performance =   4.42 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.066641 s, Result = 0ab5e000, Performance =   4.43 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.068316 s, Result = 0ab90000, Performance =   4.40 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.070023 s, Result = 0abc2000, Performance =   4.37 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.069922 s, Result = 0abf4000, Performance =   4.45 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.071757 s, Result = 0ac26000, Performance =   4.41 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.072833 s, Result = 0ac58000, Performance =   4.42 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.074504 s, Result = 0ac8a000, Performance =   4.40 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.075452 s, Result = 0acbc000, Performance =   4.41 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.077283 s, Result = 0acee000, Performance =   4.38 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.080056 s, Result = 0ad20000, Performance =   4.29 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1627   710  2048
Test passed: M N K =   860   182  1024
Test passed: M N K =  1971   424  1088
Test passed: M N K =   885  2045  1344
Test passed: M N K =  1753  1630  1344
M N K =  1024  1024   256, Elapsed time =   0.000981 s, Result = 00032000, Performance =   5.47 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002267 s, Result = 00064000, Performance =   4.74 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003408 s, Result = 00096000, Performance =   4.73 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004636 s, Result = 000c8000, Performance =   4.63 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005671 s, Result = 000fa000, Performance =   4.73 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006909 s, Result = 0012c000, Performance =   4.66 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008005 s, Result = 0015e000, Performance =   4.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008882 s, Result = 00190000, Performance =   4.84 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009649 s, Result = 001c2000, Performance =   5.01 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009671 s, Result = 001f4000, Performance =   5.55 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010594 s, Result = 00226000, Performance =   5.57 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011655 s, Result = 00258000, Performance =   5.53 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012859 s, Result = 0028a000, Performance =   5.43 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013961 s, Result = 002bc000, Performance =   5.38 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015173 s, Result = 002ee000, Performance =   5.31 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016280 s, Result = 00320000, Performance =   5.28 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.017136 s, Result = 00352000, Performance =   5.33 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018200 s, Result = 00384000, Performance =   5.31 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.019260 s, Result = 003b6000, Performance =   5.30 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.020384 s, Result = 003e8000, Performance =   5.27 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021240 s, Result = 0041a000, Performance =   5.31 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.022151 s, Result = 0044c000, Performance =   5.33 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.023052 s, Result = 0047e000, Performance =   5.36 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.024180 s, Result = 004b0000, Performance =   5.33 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.025210 s, Result = 004e2000, Performance =   5.32 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026468 s, Result = 00514000, Performance =   5.27 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.027430 s, Result = 00546000, Performance =   5.28 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.028612 s, Result = 00578000, Performance =   5.25 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029863 s, Result = 005aa000, Performance =   5.21 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031115 s, Result = 005dc000, Performance =   5.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.032366 s, Result = 0060e000, Performance =   5.14 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.033474 s, Result = 00640000, Performance =   5.13 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033554 s, Result = 00672000, Performance =   5.28 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.034824 s, Result = 006a4000, Performance =   5.24 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035963 s, Result = 006d6000, Performance =   5.23 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.037294 s, Result = 00708000, Performance =   5.18 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.040791 s, Result = 0073a000, Performance =   4.87 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.041271 s, Result = 0076c000, Performance =   4.94 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043392 s, Result = 0079e000, Performance =   4.83 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044348 s, Result = 007d0000, Performance =   4.84 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.045300 s, Result = 00802000, Performance =   4.86 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046536 s, Result = 00834000, Performance =   4.85 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.048155 s, Result = 00866000, Performance =   4.79 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051292 s, Result = 00898000, Performance =   4.61 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.053367 s, Result = 008ca000, Performance =   4.53 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053348 s, Result = 008fc000, Performance =   4.63 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.055798 s, Result = 0092e000, Performance =   4.52 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.057691 s, Result = 00960000, Performance =   4.47 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054846 s, Result = 00992000, Performance =   4.80 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.057348 s, Result = 009c4000, Performance =   4.68 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.058119 s, Result = 009f6000, Performance =   4.71 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059662 s, Result = 00a28000, Performance =   4.68 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059801 s, Result = 00a5a000, Performance =   4.76 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.061998 s, Result = 00a8c000, Performance =   4.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.063305 s, Result = 00abe000, Performance =   4.66 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.064451 s, Result = 00af0000, Performance =   4.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.065049 s, Result = 00b22000, Performance =   4.70 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066030 s, Result = 00b54000, Performance =   4.72 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.067775 s, Result = 00b86000, Performance =   4.67 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.069072 s, Result = 00bb8000, Performance =   4.66 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.069458 s, Result = 00bea000, Performance =   4.71 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.071053 s, Result = 00c1c000, Performance =   4.68 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.072418 s, Result = 00c4e000, Performance =   4.67 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.075470 s, Result = 00c80000, Performance =   4.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   181  1198  1984
Test passed: M N K =   324  1935  1280
Test passed: M N K =  1995  1646    64
Test passed: M N K =  1093  1349   384
Test passed: M N K =   435  1865  1408
M N K =  1024  1024   256, Elapsed time =   0.005835 s, Result = f5042000, Performance =   0.92 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006134 s, Result = a9074000, Performance =   1.75 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007006 s, Result = 5d0a6000, Performance =   2.30 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007868 s, Result = 110d8000, Performance =   2.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008800 s, Result = c510a000, Performance =   3.05 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009747 s, Result = 7913c000, Performance =   3.30 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010732 s, Result = 2d16e000, Performance =   3.50 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011758 s, Result = e11a0000, Performance =   3.65 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012806 s, Result = 951d2000, Performance =   3.77 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013857 s, Result = 49204000, Performance =   3.87 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.015024 s, Result = fd236000, Performance =   3.93 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015928 s, Result = b1268000, Performance =   4.04 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.017017 s, Result = 6529a000, Performance =   4.10 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017884 s, Result = 192cc000, Performance =   4.20 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.019009 s, Result = cd2fe000, Performance =   4.24 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019993 s, Result = 81330000, Performance =   4.30 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020991 s, Result = 35362000, Performance =   4.35 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021808 s, Result = e9394000, Performance =   4.43 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022860 s, Result = 9d3c6000, Performance =   4.46 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.024329 s, Result = 513f8000, Performance =   4.41 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024983 s, Result = 0542a000, Performance =   4.51 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025998 s, Result = b945c000, Performance =   4.54 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.027153 s, Result = 6d48e000, Performance =   4.55 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.028351 s, Result = 214c0000, Performance =   4.54 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.029624 s, Result = d54f2000, Performance =   4.53 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030779 s, Result = 89524000, Performance =   4.54 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.032105 s, Result = 3d556000, Performance =   4.51 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033292 s, Result = f1588000, Performance =   4.52 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.034540 s, Result = a55ba000, Performance =   4.51 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.035546 s, Result = 595ec000, Performance =   4.53 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036811 s, Result = 0d61e000, Performance =   4.52 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037980 s, Result = c1650000, Performance =   4.52 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038979 s, Result = 75682000, Performance =   4.55 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039595 s, Result = 296b4000, Performance =   4.61 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.040947 s, Result = dd6e6000, Performance =   4.59 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041875 s, Result = 91718000, Performance =   4.62 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.043095 s, Result = 4574a000, Performance =   4.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.044233 s, Result = f977c000, Performance =   4.61 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.045534 s, Result = ad7ae000, Performance =   4.60 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046664 s, Result = 617e0000, Performance =   4.60 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.047852 s, Result = 15812000, Performance =   4.60 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.049012 s, Result = c9844000, Performance =   4.60 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.052420 s, Result = 7d876000, Performance =   4.40 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.052737 s, Result = 318a8000, Performance =   4.48 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.055080 s, Result = e58da000, Performance =   4.39 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.055904 s, Result = 9990c000, Performance =   4.42 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.056826 s, Result = 4d93e000, Performance =   4.44 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.057824 s, Result = 01970000, Performance =   4.46 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.058983 s, Result = b59a2000, Performance =   4.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.059866 s, Result = 699d4000, Performance =   4.48 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.061315 s, Result = 1da06000, Performance =   4.47 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.062214 s, Result = d1a38000, Performance =   4.49 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.063323 s, Result = 85a6a000, Performance =   4.49 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.064976 s, Result = 39a9c000, Performance =   4.46 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.066139 s, Result = edace000, Performance =   4.46 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.067430 s, Result = a1b00000, Performance =   4.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.068606 s, Result = 55b32000, Performance =   4.46 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.070000 s, Result = 09b64000, Performance =   4.45 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.071102 s, Result = bdb96000, Performance =   4.45 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.073317 s, Result = 71bc8000, Performance =   4.39 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.073936 s, Result = 25bfa000, Performance =   4.43 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.076681 s, Result = d9c2c000, Performance =   4.34 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.077201 s, Result = 8dc5e000, Performance =   4.38 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.079470 s, Result = 41c90000, Performance =   4.32 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   568   482   256
Test passed: M N K =   608    35   512
Test passed: M N K =   287   671   768
Test passed: M N K =  2040  1905   960
Test passed: M N K =  1404   257   960
M N K =  1024  1024   256, Elapsed time =   0.003430 s, Result = 00032000, Performance =   1.57 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003421 s, Result = 00064000, Performance =   3.14 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004411 s, Result = 00096000, Performance =   3.65 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005335 s, Result = 000c8000, Performance =   4.03 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006303 s, Result = 000fa000, Performance =   4.26 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007259 s, Result = 0012c000, Performance =   4.44 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008276 s, Result = 0015e000, Performance =   4.54 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009265 s, Result = 00190000, Performance =   4.64 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010437 s, Result = 001c2000, Performance =   4.63 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011547 s, Result = 001f4000, Performance =   4.65 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012734 s, Result = 00226000, Performance =   4.64 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013764 s, Result = 00258000, Performance =   4.68 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014881 s, Result = 0028a000, Performance =   4.69 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015894 s, Result = 002bc000, Performance =   4.73 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016970 s, Result = 002ee000, Performance =   4.75 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017879 s, Result = 00320000, Performance =   4.80 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018902 s, Result = 00352000, Performance =   4.83 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019870 s, Result = 00384000, Performance =   4.86 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020955 s, Result = 003b6000, Performance =   4.87 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021721 s, Result = 003e8000, Performance =   4.94 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022717 s, Result = 0041a000, Performance =   4.96 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023669 s, Result = 0044c000, Performance =   4.99 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024767 s, Result = 0047e000, Performance =   4.99 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025792 s, Result = 004b0000, Performance =   5.00 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026868 s, Result = 004e2000, Performance =   5.00 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.028022 s, Result = 00514000, Performance =   4.98 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.029213 s, Result = 00546000, Performance =   4.96 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.030258 s, Result = 00578000, Performance =   4.97 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.031288 s, Result = 005aa000, Performance =   4.98 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.032502 s, Result = 005dc000, Performance =   4.96 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.033685 s, Result = 0060e000, Performance =   4.94 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034839 s, Result = 00640000, Performance =   4.93 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.035947 s, Result = 00672000, Performance =   4.93 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.036351 s, Result = 006a4000, Performance =   5.02 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.037516 s, Result = 006d6000, Performance =   5.01 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.038602 s, Result = 00708000, Performance =   5.01 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.039961 s, Result = 0073a000, Performance =   4.97 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.041197 s, Result = 0076c000, Performance =   4.95 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.042353 s, Result = 0079e000, Performance =   4.94 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.043350 s, Result = 007d0000, Performance =   4.95 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.044411 s, Result = 00802000, Performance =   4.96 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.045514 s, Result = 00834000, Performance =   4.95 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.046751 s, Result = 00866000, Performance =   4.94 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.048027 s, Result = 00898000, Performance =   4.92 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049517 s, Result = 008ca000, Performance =   4.88 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.052013 s, Result = 008fc000, Performance =   4.75 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.052422 s, Result = 0092e000, Performance =   4.81 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.053785 s, Result = 00960000, Performance =   4.79 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054867 s, Result = 00992000, Performance =   4.79 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.056337 s, Result = 009c4000, Performance =   4.76 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.057546 s, Result = 009f6000, Performance =   4.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059024 s, Result = 00a28000, Performance =   4.73 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.062152 s, Result = 00a5a000, Performance =   4.58 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.062323 s, Result = 00a8c000, Performance =   4.65 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.063599 s, Result = 00abe000, Performance =   4.64 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.064628 s, Result = 00af0000, Performance =   4.65 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.066321 s, Result = 00b22000, Performance =   4.61 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.067462 s, Result = 00b54000, Performance =   4.62 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.068399 s, Result = 00b86000, Performance =   4.63 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.069880 s, Result = 00bb8000, Performance =   4.61 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.070973 s, Result = 00bea000, Performance =   4.61 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.073269 s, Result = 00c1c000, Performance =   4.54 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.075737 s, Result = 00c4e000, Performance =   4.47 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.075092 s, Result = 00c80000, Performance =   4.58 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   142   618  1152
Test passed: M N K =   598  1843   384
Test passed: M N K =  1502   393   640
Test passed: M N K =  1901  1322    64
Test passed: M N K =  1997  1639  1664
M N K =  1024  1024   256, Elapsed time =   0.005187 s, Result = 0a0d2000, Performance =   1.03 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005612 s, Result = 0a104000, Performance =   1.91 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006469 s, Result = 0a136000, Performance =   2.49 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007133 s, Result = 0a168000, Performance =   3.01 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007996 s, Result = 0a19a000, Performance =   3.36 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008897 s, Result = 0a1cc000, Performance =   3.62 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009987 s, Result = 0a1fe000, Performance =   3.76 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011117 s, Result = 0a230000, Performance =   3.86 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012297 s, Result = 0a262000, Performance =   3.93 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013393 s, Result = 0a294000, Performance =   4.01 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014529 s, Result = 0a2c6000, Performance =   4.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015520 s, Result = 0a2f8000, Performance =   4.15 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016555 s, Result = 0a32a000, Performance =   4.22 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017600 s, Result = 0a35c000, Performance =   4.27 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018610 s, Result = 0a38e000, Performance =   4.33 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019541 s, Result = 0a3c0000, Performance =   4.40 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020494 s, Result = 0a3f2000, Performance =   4.45 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021388 s, Result = 0a424000, Performance =   4.52 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022301 s, Result = 0a456000, Performance =   4.57 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023241 s, Result = 0a488000, Performance =   4.62 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024325 s, Result = 0a4ba000, Performance =   4.63 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.025298 s, Result = 0a4ec000, Performance =   4.67 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026428 s, Result = 0a51e000, Performance =   4.67 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027516 s, Result = 0a550000, Performance =   4.68 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028596 s, Result = 0a582000, Performance =   4.69 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029633 s, Result = 0a5b4000, Performance =   4.71 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.030928 s, Result = 0a5e6000, Performance =   4.69 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.031962 s, Result = 0a618000, Performance =   4.70 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033152 s, Result = 0a64a000, Performance =   4.70 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.034135 s, Result = 0a67c000, Performance =   4.72 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.035304 s, Result = 0a6ae000, Performance =   4.71 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.036367 s, Result = 0a6e0000, Performance =   4.72 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.037373 s, Result = 0a712000, Performance =   4.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.037835 s, Result = 0a744000, Performance =   4.82 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039149 s, Result = 0a776000, Performance =   4.80 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.040199 s, Result = 0a7a8000, Performance =   4.81 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041529 s, Result = 0a7da000, Performance =   4.78 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042567 s, Result = 0a80c000, Performance =   4.79 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043818 s, Result = 0a83e000, Performance =   4.78 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044895 s, Result = 0a870000, Performance =   4.78 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.046004 s, Result = 0a8a2000, Performance =   4.78 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046961 s, Result = 0a8d4000, Performance =   4.80 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050661 s, Result = 0a906000, Performance =   4.56 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051150 s, Result = 0a938000, Performance =   4.62 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.052166 s, Result = 0a96a000, Performance =   4.63 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053816 s, Result = 0a99c000, Performance =   4.59 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.054542 s, Result = 0a9ce000, Performance =   4.63 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.056393 s, Result = 0aa00000, Performance =   4.57 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.056908 s, Result = 0aa32000, Performance =   4.62 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.058466 s, Result = 0aa64000, Performance =   4.59 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.060785 s, Result = 0aa96000, Performance =   4.50 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.061027 s, Result = 0aac8000, Performance =   4.57 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.062167 s, Result = 0aafa000, Performance =   4.58 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.062653 s, Result = 0ab2c000, Performance =   4.63 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.064336 s, Result = 0ab5e000, Performance =   4.59 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.065249 s, Result = 0ab90000, Performance =   4.61 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.065800 s, Result = 0abc2000, Performance =   4.65 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.067313 s, Result = 0abf4000, Performance =   4.63 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.068494 s, Result = 0ac26000, Performance =   4.62 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.070649 s, Result = 0ac58000, Performance =   4.56 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.071797 s, Result = 0ac8a000, Performance =   4.56 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.073803 s, Result = 0acbc000, Performance =   4.51 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.074127 s, Result = 0acee000, Performance =   4.56 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.076032 s, Result = 0ad20000, Performance =   4.52 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1461   374   384
Test passed: M N K =  1408   166   448
Test passed: M N K =   110  1178  1408
Test passed: M N K =   972   887  1024
Test passed: M N K =  1191   877  1216
M N K =  1024  1024   256, Elapsed time =   0.000973 s, Result = 00032000, Performance =   5.52 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002050 s, Result = 00064000, Performance =   5.24 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003309 s, Result = 00096000, Performance =   4.87 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.004402 s, Result = 000c8000, Performance =   4.88 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005485 s, Result = 000fa000, Performance =   4.89 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006689 s, Result = 0012c000, Performance =   4.82 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007862 s, Result = 0015e000, Performance =   4.78 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008959 s, Result = 00190000, Performance =   4.79 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010369 s, Result = 001c2000, Performance =   4.66 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011431 s, Result = 001f4000, Performance =   4.70 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012925 s, Result = 00226000, Performance =   4.57 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.014038 s, Result = 00258000, Performance =   4.59 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.015528 s, Result = 0028a000, Performance =   4.49 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.016357 s, Result = 002bc000, Performance =   4.60 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.017602 s, Result = 002ee000, Performance =   4.58 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.018448 s, Result = 00320000, Performance =   4.66 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020358 s, Result = 00352000, Performance =   4.48 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021430 s, Result = 00384000, Performance =   4.51 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.021962 s, Result = 003b6000, Performance =   4.64 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022622 s, Result = 003e8000, Performance =   4.75 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.021309 s, Result = 0041a000, Performance =   5.29 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020697 s, Result = 0044c000, Performance =   5.71 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021922 s, Result = 0047e000, Performance =   5.63 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022826 s, Result = 004b0000, Performance =   5.64 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023805 s, Result = 004e2000, Performance =   5.64 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024982 s, Result = 00514000, Performance =   5.59 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026096 s, Result = 00546000, Performance =   5.55 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027317 s, Result = 00578000, Performance =   5.50 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.028533 s, Result = 005aa000, Performance =   5.46 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.029840 s, Result = 005dc000, Performance =   5.40 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031121 s, Result = 0060e000, Performance =   5.35 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032573 s, Result = 00640000, Performance =   5.27 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.033562 s, Result = 00672000, Performance =   5.28 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033698 s, Result = 006a4000, Performance =   5.42 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.035112 s, Result = 006d6000, Performance =   5.35 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.036058 s, Result = 00708000, Performance =   5.36 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037386 s, Result = 0073a000, Performance =   5.31 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.038541 s, Result = 0076c000, Performance =   5.29 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039772 s, Result = 0079e000, Performance =   5.26 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040791 s, Result = 007d0000, Performance =   5.26 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041967 s, Result = 00802000, Performance =   5.25 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043176 s, Result = 00834000, Performance =   5.22 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044292 s, Result = 00866000, Performance =   5.21 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.045292 s, Result = 00898000, Performance =   5.22 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.046669 s, Result = 008ca000, Performance =   5.18 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.048283 s, Result = 008fc000, Performance =   5.11 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.049113 s, Result = 0092e000, Performance =   5.14 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.050938 s, Result = 00960000, Performance =   5.06 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.051763 s, Result = 00992000, Performance =   5.08 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.052896 s, Result = 009c4000, Performance =   5.07 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.054463 s, Result = 009f6000, Performance =   5.03 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.055358 s, Result = 00a28000, Performance =   5.04 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.056513 s, Result = 00a5a000, Performance =   5.04 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.057801 s, Result = 00a8c000, Performance =   5.02 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.058567 s, Result = 00abe000, Performance =   5.04 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.060028 s, Result = 00af0000, Performance =   5.01 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.061039 s, Result = 00b22000, Performance =   5.01 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.062141 s, Result = 00b54000, Performance =   5.01 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.064248 s, Result = 00b86000, Performance =   4.93 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.064868 s, Result = 00bb8000, Performance =   4.97 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.065776 s, Result = 00bea000, Performance =   4.98 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.067998 s, Result = 00c1c000, Performance =   4.90 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.068460 s, Result = 00c4e000, Performance =   4.94 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.069936 s, Result = 00c80000, Performance =   4.91 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1435   248   384
Test passed: M N K =    67  1553   832
Test passed: M N K =  1078  1737   896
Test passed: M N K =   113  1984   128
Test passed: M N K =   734   922  1536
M N K =  1024  1024   256, Elapsed time =   0.005681 s, Result = f5042000, Performance =   0.95 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006126 s, Result = a9074000, Performance =   1.75 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006945 s, Result = 5d0a6000, Performance =   2.32 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007840 s, Result = 110d8000, Performance =   2.74 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008817 s, Result = c510a000, Performance =   3.04 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009799 s, Result = 7913c000, Performance =   3.29 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010716 s, Result = 2d16e000, Performance =   3.51 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011624 s, Result = e11a0000, Performance =   3.69 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.012782 s, Result = 951d2000, Performance =   3.78 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.013748 s, Result = 49204000, Performance =   3.91 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014763 s, Result = fd236000, Performance =   4.00 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015763 s, Result = b1268000, Performance =   4.09 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016807 s, Result = 6529a000, Performance =   4.15 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017754 s, Result = 192cc000, Performance =   4.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018766 s, Result = cd2fe000, Performance =   4.29 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019698 s, Result = 81330000, Performance =   4.36 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020576 s, Result = 35362000, Performance =   4.44 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021542 s, Result = e9394000, Performance =   4.49 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022448 s, Result = 9d3c6000, Performance =   4.54 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.023486 s, Result = 513f8000, Performance =   4.57 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.024563 s, Result = 0542a000, Performance =   4.59 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.026265 s, Result = b945c000, Performance =   4.50 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.026457 s, Result = 6d48e000, Performance =   4.67 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.027406 s, Result = 214c0000, Performance =   4.70 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028707 s, Result = d54f2000, Performance =   4.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.030135 s, Result = 89524000, Performance =   4.63 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.031607 s, Result = 3d556000, Performance =   4.59 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.032836 s, Result = f1588000, Performance =   4.58 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.034120 s, Result = a55ba000, Performance =   4.56 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.035351 s, Result = 595ec000, Performance =   4.56 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036586 s, Result = 0d61e000, Performance =   4.55 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.037732 s, Result = c1650000, Performance =   4.55 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.038893 s, Result = 75682000, Performance =   4.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.039994 s, Result = 296b4000, Performance =   4.56 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.041000 s, Result = dd6e6000, Performance =   4.58 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.041396 s, Result = 91718000, Performance =   4.67 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.042651 s, Result = 4574a000, Performance =   4.66 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.043709 s, Result = f977c000, Performance =   4.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.045002 s, Result = ad7ae000, Performance =   4.65 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.046053 s, Result = 617e0000, Performance =   4.66 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.047180 s, Result = 15812000, Performance =   4.67 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.048578 s, Result = c9844000, Performance =   4.64 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.049647 s, Result = 7d876000, Performance =   4.65 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051151 s, Result = 318a8000, Performance =   4.62 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.052228 s, Result = e58da000, Performance =   4.63 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.053421 s, Result = 9990c000, Performance =   4.62 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.055149 s, Result = 4d93e000, Performance =   4.58 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.055769 s, Result = 01970000, Performance =   4.62 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.057296 s, Result = b59a2000, Performance =   4.59 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.058463 s, Result = 699d4000, Performance =   4.59 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.060153 s, Result = 1da06000, Performance =   4.55 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.060700 s, Result = d1a38000, Performance =   4.60 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.062002 s, Result = 85a6a000, Performance =   4.59 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.063687 s, Result = 39a9c000, Performance =   4.55 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.064543 s, Result = edace000, Performance =   4.57 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.065489 s, Result = a1b00000, Performance =   4.59 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.067395 s, Result = 55b32000, Performance =   4.54 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.068685 s, Result = 09b64000, Performance =   4.53 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.069543 s, Result = bdb96000, Performance =   4.55 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.071720 s, Result = 71bc8000, Performance =   4.49 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.071515 s, Result = 25bfa000, Performance =   4.58 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.073439 s, Result = d9c2c000, Performance =   4.53 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.075182 s, Result = 8dc5e000, Performance =   4.50 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.076958 s, Result = 41c90000, Performance =   4.46 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   450   867  1216
Test passed: M N K =   616  1449   448
Test passed: M N K =  1914  1443  1856
Test passed: M N K =  1716   944  1472
Test passed: M N K =  1992   263  1856
M N K =  1024  1024   256, Elapsed time =   0.003559 s, Result = 00032000, Performance =   1.51 TOPS
M N K =  1024  1024   512, Elapsed time =   0.003977 s, Result = 00064000, Performance =   2.70 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004644 s, Result = 00096000, Performance =   3.47 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005461 s, Result = 000c8000, Performance =   3.93 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006417 s, Result = 000fa000, Performance =   4.18 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007338 s, Result = 0012c000, Performance =   4.39 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008316 s, Result = 0015e000, Performance =   4.52 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009273 s, Result = 00190000, Performance =   4.63 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010376 s, Result = 001c2000, Performance =   4.66 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011484 s, Result = 001f4000, Performance =   4.67 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012554 s, Result = 00226000, Performance =   4.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.013551 s, Result = 00258000, Performance =   4.75 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.014753 s, Result = 0028a000, Performance =   4.73 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.015823 s, Result = 002bc000, Performance =   4.75 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.016800 s, Result = 002ee000, Performance =   4.79 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.017691 s, Result = 00320000, Performance =   4.86 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.018783 s, Result = 00352000, Performance =   4.86 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.019780 s, Result = 00384000, Performance =   4.89 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.020559 s, Result = 003b6000, Performance =   4.96 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.021505 s, Result = 003e8000, Performance =   4.99 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.022446 s, Result = 0041a000, Performance =   5.02 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.023494 s, Result = 0044c000, Performance =   5.03 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.024458 s, Result = 0047e000, Performance =   5.05 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.025426 s, Result = 004b0000, Performance =   5.07 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.026581 s, Result = 004e2000, Performance =   5.05 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.027722 s, Result = 00514000, Performance =   5.04 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.028689 s, Result = 00546000, Performance =   5.05 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.029667 s, Result = 00578000, Performance =   5.07 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.030759 s, Result = 005aa000, Performance =   5.06 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.031969 s, Result = 005dc000, Performance =   5.04 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.033159 s, Result = 0060e000, Performance =   5.02 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.034172 s, Result = 00640000, Performance =   5.03 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.035382 s, Result = 00672000, Performance =   5.01 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.036570 s, Result = 006a4000, Performance =   4.99 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.038741 s, Result = 006d6000, Performance =   4.85 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.039211 s, Result = 00708000, Performance =   4.93 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.040473 s, Result = 0073a000, Performance =   4.91 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.041665 s, Result = 0076c000, Performance =   4.90 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.042826 s, Result = 0079e000, Performance =   4.89 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044124 s, Result = 007d0000, Performance =   4.87 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.045025 s, Result = 00802000, Performance =   4.89 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046248 s, Result = 00834000, Performance =   4.88 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.050386 s, Result = 00866000, Performance =   4.58 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.051339 s, Result = 00898000, Performance =   4.60 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.052699 s, Result = 008ca000, Performance =   4.58 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.054245 s, Result = 008fc000, Performance =   4.55 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.051980 s, Result = 0092e000, Performance =   4.85 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.053595 s, Result = 00960000, Performance =   4.81 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.054600 s, Result = 00992000, Performance =   4.82 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.056393 s, Result = 009c4000, Performance =   4.76 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.057733 s, Result = 009f6000, Performance =   4.74 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.057895 s, Result = 00a28000, Performance =   4.82 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059341 s, Result = 00a5a000, Performance =   4.80 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.060738 s, Result = 00a8c000, Performance =   4.77 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.061847 s, Result = 00abe000, Performance =   4.77 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.062442 s, Result = 00af0000, Performance =   4.81 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.064806 s, Result = 00b22000, Performance =   4.72 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066087 s, Result = 00b54000, Performance =   4.71 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.066522 s, Result = 00b86000, Performance =   4.76 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.068651 s, Result = 00bb8000, Performance =   4.69 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.068658 s, Result = 00bea000, Performance =   4.77 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.070597 s, Result = 00c1c000, Performance =   4.71 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.072179 s, Result = 00c4e000, Performance =   4.69 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.074328 s, Result = 00c80000, Performance =   4.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   834   220  1344
Test passed: M N K =    23   381   192
Test passed: M N K =   421   746  1664
Test passed: M N K =   236  1573   320
Test passed: M N K =   516  1513  1024
M N K =  1024  1024   256, Elapsed time =   0.004606 s, Result = 0a0d2000, Performance =   1.17 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006659 s, Result = 0a104000, Performance =   1.61 TOPS
M N K =  1024  1024   768, Elapsed time =   0.007584 s, Result = 0a136000, Performance =   2.12 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.008438 s, Result = 0a168000, Performance =   2.54 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008959 s, Result = 0a19a000, Performance =   3.00 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009424 s, Result = 0a1cc000, Performance =   3.42 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010177 s, Result = 0a1fe000, Performance =   3.69 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.011129 s, Result = 0a230000, Performance =   3.86 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.013182 s, Result = 0a262000, Performance =   3.67 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.014039 s, Result = 0a294000, Performance =   3.82 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.014831 s, Result = 0a2c6000, Performance =   3.98 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.015596 s, Result = 0a2f8000, Performance =   4.13 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.016348 s, Result = 0a32a000, Performance =   4.27 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.017227 s, Result = 0a35c000, Performance =   4.36 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.018037 s, Result = 0a38e000, Performance =   4.46 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.019026 s, Result = 0a3c0000, Performance =   4.51 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.020026 s, Result = 0a3f2000, Performance =   4.56 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.021211 s, Result = 0a424000, Performance =   4.56 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.022229 s, Result = 0a456000, Performance =   4.59 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.022936 s, Result = 0a488000, Performance =   4.68 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023936 s, Result = 0a4ba000, Performance =   4.71 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.024941 s, Result = 0a4ec000, Performance =   4.74 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.025721 s, Result = 0a51e000, Performance =   4.80 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026827 s, Result = 0a550000, Performance =   4.80 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.028014 s, Result = 0a582000, Performance =   4.79 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.029172 s, Result = 0a5b4000, Performance =   4.79 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.031326 s, Result = 0a5e6000, Performance =   4.63 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.033047 s, Result = 0a618000, Performance =   4.55 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.033905 s, Result = 0a64a000, Performance =   4.59 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.035389 s, Result = 0a67c000, Performance =   4.55 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.036376 s, Result = 0a6ae000, Performance =   4.58 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.038275 s, Result = 0a6e0000, Performance =   4.49 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.039461 s, Result = 0a712000, Performance =   4.49 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.040169 s, Result = 0a744000, Performance =   4.54 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.039376 s, Result = 0a776000, Performance =   4.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.040110 s, Result = 0a7a8000, Performance =   4.82 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.041439 s, Result = 0a7da000, Performance =   4.79 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042328 s, Result = 0a80c000, Performance =   4.82 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.043544 s, Result = 0a83e000, Performance =   4.81 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.044567 s, Result = 0a870000, Performance =   4.82 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.045791 s, Result = 0a8a2000, Performance =   4.81 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.046890 s, Result = 0a8d4000, Performance =   4.81 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.048064 s, Result = 0a906000, Performance =   4.80 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.049212 s, Result = 0a938000, Performance =   4.80 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.050428 s, Result = 0a96a000, Performance =   4.79 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.051576 s, Result = 0a99c000, Performance =   4.79 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.053456 s, Result = 0a9ce000, Performance =   4.72 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.054322 s, Result = 0aa00000, Performance =   4.74 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.055489 s, Result = 0aa32000, Performance =   4.74 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.056824 s, Result = 0aa64000, Performance =   4.72 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.057933 s, Result = 0aa96000, Performance =   4.73 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.059074 s, Result = 0aac8000, Performance =   4.73 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.059929 s, Result = 0aafa000, Performance =   4.75 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.061148 s, Result = 0ab2c000, Performance =   4.74 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.062402 s, Result = 0ab5e000, Performance =   4.73 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.063202 s, Result = 0ab90000, Performance =   4.76 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.065205 s, Result = 0abc2000, Performance =   4.69 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.066287 s, Result = 0abf4000, Performance =   4.70 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.067301 s, Result = 0ac26000, Performance =   4.71 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.069168 s, Result = 0ac58000, Performance =   4.66 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.069279 s, Result = 0ac8a000, Performance =   4.73 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.071533 s, Result = 0acbc000, Performance =   4.65 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.073256 s, Result = 0acee000, Performance =   4.62 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.074795 s, Result = 0ad20000, Performance =   4.59 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   577  1106  1664
Test passed: M N K =  1755   931  1856
Test passed: M N K =   474   460   960
Test passed: M N K =   372  1705  2048
Test passed: M N K =  1705  1764   256
M N K =  1024  1024   256, Elapsed time =   0.001011 s, Result = 00032000, Performance =   5.31 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002008 s, Result = 00064000, Performance =   5.35 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002976 s, Result = 00096000, Performance =   5.41 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003995 s, Result = 000c8000, Performance =   5.38 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005429 s, Result = 000fa000, Performance =   4.94 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006508 s, Result = 0012c000, Performance =   4.95 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007199 s, Result = 0015e000, Performance =   5.22 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007846 s, Result = 00190000, Performance =   5.47 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008504 s, Result = 001c2000, Performance =   5.68 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009197 s, Result = 001f4000, Performance =   5.84 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009972 s, Result = 00226000, Performance =   5.92 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010932 s, Result = 00258000, Performance =   5.89 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011928 s, Result = 0028a000, Performance =   5.85 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012987 s, Result = 002bc000, Performance =   5.79 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013990 s, Result = 002ee000, Performance =   5.76 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014929 s, Result = 00320000, Performance =   5.75 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016010 s, Result = 00352000, Performance =   5.70 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.017061 s, Result = 00384000, Performance =   5.66 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018063 s, Result = 003b6000, Performance =   5.65 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.018945 s, Result = 003e8000, Performance =   5.67 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020065 s, Result = 0041a000, Performance =   5.62 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020877 s, Result = 0044c000, Performance =   5.66 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021913 s, Result = 0047e000, Performance =   5.64 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022708 s, Result = 004b0000, Performance =   5.67 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023806 s, Result = 004e2000, Performance =   5.64 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.024917 s, Result = 00514000, Performance =   5.60 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.025899 s, Result = 00546000, Performance =   5.60 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.026659 s, Result = 00578000, Performance =   5.64 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027779 s, Result = 005aa000, Performance =   5.60 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028790 s, Result = 005dc000, Performance =   5.59 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029906 s, Result = 0060e000, Performance =   5.57 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030975 s, Result = 00640000, Performance =   5.55 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.032067 s, Result = 00672000, Performance =   5.52 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.033070 s, Result = 006a4000, Performance =   5.52 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.034120 s, Result = 006d6000, Performance =   5.51 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.034839 s, Result = 00708000, Performance =   5.55 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.036051 s, Result = 0073a000, Performance =   5.51 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.036903 s, Result = 0076c000, Performance =   5.53 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.039848 s, Result = 0079e000, Performance =   5.25 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.040071 s, Result = 007d0000, Performance =   5.36 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041628 s, Result = 00802000, Performance =   5.29 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.042505 s, Result = 00834000, Performance =   5.30 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.044041 s, Result = 00866000, Performance =   5.24 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044773 s, Result = 00898000, Performance =   5.28 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.046044 s, Result = 008ca000, Performance =   5.25 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.047137 s, Result = 008fc000, Performance =   5.24 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.048397 s, Result = 0092e000, Performance =   5.21 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.049612 s, Result = 00960000, Performance =   5.19 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.050757 s, Result = 00992000, Performance =   5.18 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.051927 s, Result = 009c4000, Performance =   5.17 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.053354 s, Result = 009f6000, Performance =   5.13 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.054338 s, Result = 00a28000, Performance =   5.14 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.056257 s, Result = 00a5a000, Performance =   5.06 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.058006 s, Result = 00a8c000, Performance =   5.00 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.058577 s, Result = 00abe000, Performance =   5.04 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.059311 s, Result = 00af0000, Performance =   5.07 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.060688 s, Result = 00b22000, Performance =   5.04 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.062082 s, Result = 00b54000, Performance =   5.02 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.062358 s, Result = 00b86000, Performance =   5.08 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.064636 s, Result = 00bb8000, Performance =   4.98 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.064286 s, Result = 00bea000, Performance =   5.09 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.065964 s, Result = 00c1c000, Performance =   5.05 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.067937 s, Result = 00c4e000, Performance =   4.98 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.069354 s, Result = 00c80000, Performance =   4.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1752   440  1984
Test passed: M N K =   620   751   640
Test passed: M N K =  1561  1386  2048
Test passed: M N K =  1037    83  1088
Test passed: M N K =   921  1704   576
M N K =  1024  1024   256, Elapsed time =   0.005406 s, Result = 5902e000, Performance =   0.99 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005650 s, Result = 3104c000, Performance =   1.90 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005994 s, Result = 0906a000, Performance =   2.69 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006520 s, Result = e1088000, Performance =   3.29 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007137 s, Result = b90a6000, Performance =   3.76 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007791 s, Result = 910c4000, Performance =   4.13 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008442 s, Result = 690e2000, Performance =   4.45 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009279 s, Result = 41100000, Performance =   4.63 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010157 s, Result = 1911e000, Performance =   4.76 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011023 s, Result = f113c000, Performance =   4.87 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012065 s, Result = c915a000, Performance =   4.89 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012969 s, Result = a1178000, Performance =   4.97 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.013972 s, Result = 79196000, Performance =   5.00 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.014883 s, Result = 511b4000, Performance =   5.05 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.015691 s, Result = 291d2000, Performance =   5.13 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.016548 s, Result = 011f0000, Performance =   5.19 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.016938 s, Result = d920e000, Performance =   5.39 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.018007 s, Result = b122c000, Performance =   5.37 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.018801 s, Result = 8924a000, Performance =   5.43 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.019597 s, Result = 61268000, Performance =   5.48 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.020163 s, Result = 39286000, Performance =   5.59 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.020970 s, Result = 112a4000, Performance =   5.63 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.021771 s, Result = e92c2000, Performance =   5.67 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.022645 s, Result = c12e0000, Performance =   5.69 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.023543 s, Result = 992fe000, Performance =   5.70 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.026402 s, Result = 7131c000, Performance =   5.29 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.026300 s, Result = 4933a000, Performance =   5.51 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.027623 s, Result = 21358000, Performance =   5.44 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.029107 s, Result = f9376000, Performance =   5.35 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.030314 s, Result = d1394000, Performance =   5.31 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.031504 s, Result = a93b2000, Performance =   5.28 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.032278 s, Result = 813d0000, Performance =   5.32 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.030672 s, Result = 593ee000, Performance =   5.78 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.031673 s, Result = 3140c000, Performance =   5.76 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.032549 s, Result = 0942a000, Performance =   5.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.033330 s, Result = e1448000, Performance =   5.80 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.034286 s, Result = b9466000, Performance =   5.79 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.035354 s, Result = 91484000, Performance =   5.77 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036187 s, Result = 694a2000, Performance =   5.79 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.037190 s, Result = 414c0000, Performance =   5.77 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.038298 s, Result = 194de000, Performance =   5.75 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.039245 s, Result = f14fc000, Performance =   5.75 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.040066 s, Result = c951a000, Performance =   5.76 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.041260 s, Result = a1538000, Performance =   5.73 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.042226 s, Result = 79556000, Performance =   5.72 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.043444 s, Result = 51574000, Performance =   5.68 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.043986 s, Result = 29592000, Performance =   5.74 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.045072 s, Result = 015b0000, Performance =   5.72 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.045294 s, Result = d95ce000, Performance =   5.81 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.046731 s, Result = b15ec000, Performance =   5.74 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047352 s, Result = 8960a000, Performance =   5.78 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.048474 s, Result = 61628000, Performance =   5.76 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.049253 s, Result = 39646000, Performance =   5.78 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.050412 s, Result = 11664000, Performance =   5.75 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051130 s, Result = e9682000, Performance =   5.78 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.051660 s, Result = c16a0000, Performance =   5.82 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.052606 s, Result = 996be000, Performance =   5.82 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.053205 s, Result = 716dc000, Performance =   5.85 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.054266 s, Result = 496fa000, Performance =   5.84 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.055124 s, Result = 21718000, Performance =   5.84 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.056075 s, Result = f9736000, Performance =   5.84 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.056987 s, Result = d1754000, Performance =   5.84 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.058317 s, Result = a9772000, Performance =   5.80 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.059142 s, Result = 81790000, Performance =   5.81 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   711  1939   448
Test passed: M N K =  1741   311  1408
Test passed: M N K =  1693  1262   640
Test passed: M N K =  1189  1956   128
Test passed: M N K =   466  1209  1792
M N K =  1024  1024   256, Elapsed time =   0.003840 s, Result = 0001e000, Performance =   1.40 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004558 s, Result = 0003c000, Performance =   2.36 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006062 s, Result = 0005a000, Performance =   2.66 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007061 s, Result = 00078000, Performance =   3.04 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.008128 s, Result = 00096000, Performance =   3.30 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008809 s, Result = 000b4000, Performance =   3.66 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009225 s, Result = 000d2000, Performance =   4.07 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009426 s, Result = 000f0000, Performance =   4.56 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010019 s, Result = 0010e000, Performance =   4.82 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010150 s, Result = 0012c000, Performance =   5.29 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010109 s, Result = 0014a000, Performance =   5.84 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010332 s, Result = 00168000, Performance =   6.24 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010679 s, Result = 00186000, Performance =   6.54 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011844 s, Result = 001a4000, Performance =   6.35 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013212 s, Result = 001c2000, Performance =   6.10 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014159 s, Result = 001e0000, Performance =   6.07 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014776 s, Result = 001fe000, Performance =   6.18 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015900 s, Result = 0021c000, Performance =   6.08 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016846 s, Result = 0023a000, Performance =   6.06 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017697 s, Result = 00258000, Performance =   6.07 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018656 s, Result = 00276000, Performance =   6.04 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.019505 s, Result = 00294000, Performance =   6.06 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.020256 s, Result = 002b2000, Performance =   6.10 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.021291 s, Result = 002d0000, Performance =   6.05 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022228 s, Result = 002ee000, Performance =   6.04 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.023190 s, Result = 0030c000, Performance =   6.02 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.024358 s, Result = 0032a000, Performance =   5.95 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.025742 s, Result = 00348000, Performance =   5.84 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.027302 s, Result = 00366000, Performance =   5.70 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.028833 s, Result = 00384000, Performance =   5.59 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.029257 s, Result = 003a2000, Performance =   5.69 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.030031 s, Result = 003c0000, Performance =   5.72 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.028318 s, Result = 003de000, Performance =   6.26 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.029147 s, Result = 003fc000, Performance =   6.26 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.030370 s, Result = 0041a000, Performance =   6.19 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.030712 s, Result = 00438000, Performance =   6.29 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.032140 s, Result = 00456000, Performance =   6.18 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.032918 s, Result = 00474000, Performance =   6.20 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.033956 s, Result = 00492000, Performance =   6.17 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.035552 s, Result = 004b0000, Performance =   6.04 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.041522 s, Result = 004ce000, Performance =   5.30 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.043237 s, Result = 004ec000, Performance =   5.22 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.047021 s, Result = 0050a000, Performance =   4.91 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.060454 s, Result = 00528000, Performance =   3.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.049259 s, Result = 00546000, Performance =   4.90 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.041410 s, Result = 00564000, Performance =   5.96 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.052610 s, Result = 00582000, Performance =   4.80 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.046957 s, Result = 005a0000, Performance =   5.49 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.053867 s, Result = 005be000, Performance =   4.88 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.044698 s, Result = 005dc000, Performance =   6.01 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.045095 s, Result = 005fa000, Performance =   6.07 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.046427 s, Result = 00618000, Performance =   6.01 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.046403 s, Result = 00636000, Performance =   6.13 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.047780 s, Result = 00654000, Performance =   6.07 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.051350 s, Result = 00672000, Performance =   5.75 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.052129 s, Result = 00690000, Performance =   5.77 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.053237 s, Result = 006ae000, Performance =   5.75 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.051405 s, Result = 006cc000, Performance =   6.06 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051424 s, Result = 006ea000, Performance =   6.16 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.052598 s, Result = 00708000, Performance =   6.12 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052560 s, Result = 00726000, Performance =   6.23 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.054328 s, Result = 00744000, Performance =   6.13 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.065975 s, Result = 00762000, Performance =   5.13 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.088710 s, Result = 00780000, Performance =   3.87 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1064   192  1984
Test passed: M N K =   781   342  1792
Test passed: M N K =  1159  1585  1856
Test passed: M N K =  1944  1926   832
Test passed: M N K =  1631  1066   640
M N K =  1024  1024   256, Elapsed time =   0.004592 s, Result = 0a0be000, Performance =   1.17 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005179 s, Result = 0a0dc000, Performance =   2.07 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005454 s, Result = 0a0fa000, Performance =   2.95 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005927 s, Result = 0a118000, Performance =   3.62 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007592 s, Result = 0a136000, Performance =   3.54 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.009301 s, Result = 0a154000, Performance =   3.46 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.010476 s, Result = 0a172000, Performance =   3.59 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010633 s, Result = 0a190000, Performance =   4.04 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.011676 s, Result = 0a1ae000, Performance =   4.14 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011642 s, Result = 0a1cc000, Performance =   4.61 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012538 s, Result = 0a1ea000, Performance =   4.71 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012339 s, Result = 0a208000, Performance =   5.22 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012058 s, Result = 0a226000, Performance =   5.79 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012494 s, Result = 0a244000, Performance =   6.02 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013223 s, Result = 0a262000, Performance =   6.09 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014016 s, Result = 0a280000, Performance =   6.13 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014477 s, Result = 0a29e000, Performance =   6.30 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015256 s, Result = 0a2bc000, Performance =   6.33 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016191 s, Result = 0a2da000, Performance =   6.30 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016862 s, Result = 0a2f8000, Performance =   6.37 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017707 s, Result = 0a316000, Performance =   6.37 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018562 s, Result = 0a334000, Performance =   6.36 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019334 s, Result = 0a352000, Performance =   6.39 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020254 s, Result = 0a370000, Performance =   6.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021048 s, Result = 0a38e000, Performance =   6.38 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021840 s, Result = 0a3ac000, Performance =   6.39 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022782 s, Result = 0a3ca000, Performance =   6.36 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023593 s, Result = 0a3e8000, Performance =   6.37 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024571 s, Result = 0a406000, Performance =   6.34 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025463 s, Result = 0a424000, Performance =   6.33 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026324 s, Result = 0a442000, Performance =   6.32 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027270 s, Result = 0a460000, Performance =   6.30 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.026834 s, Result = 0a47e000, Performance =   6.60 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027894 s, Result = 0a49c000, Performance =   6.54 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028838 s, Result = 0a4ba000, Performance =   6.52 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029716 s, Result = 0a4d8000, Performance =   6.50 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030850 s, Result = 0a4f6000, Performance =   6.44 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.033150 s, Result = 0a514000, Performance =   6.15 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.038391 s, Result = 0a532000, Performance =   5.45 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.033886 s, Result = 0a550000, Performance =   6.34 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.034747 s, Result = 0a56e000, Performance =   6.33 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.035418 s, Result = 0a58c000, Performance =   6.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.036293 s, Result = 0a5aa000, Performance =   6.36 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.037451 s, Result = 0a5c8000, Performance =   6.31 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.038701 s, Result = 0a5e6000, Performance =   6.24 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.039968 s, Result = 0a604000, Performance =   6.18 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.040968 s, Result = 0a622000, Performance =   6.16 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.041975 s, Result = 0a640000, Performance =   6.14 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.042637 s, Result = 0a65e000, Performance =   6.17 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.044372 s, Result = 0a67c000, Performance =   6.05 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.045166 s, Result = 0a69a000, Performance =   6.06 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.046058 s, Result = 0a6b8000, Performance =   6.06 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.046809 s, Result = 0a6d6000, Performance =   6.08 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.047310 s, Result = 0a6f4000, Performance =   6.13 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.048241 s, Result = 0a712000, Performance =   6.12 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.049104 s, Result = 0a730000, Performance =   6.12 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.049671 s, Result = 0a74e000, Performance =   6.16 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.050640 s, Result = 0a76c000, Performance =   6.15 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051289 s, Result = 0a78a000, Performance =   6.18 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.052229 s, Result = 0a7a8000, Performance =   6.17 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052843 s, Result = 0a7c6000, Performance =   6.20 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053076 s, Result = 0a7e4000, Performance =   6.27 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.054970 s, Result = 0a802000, Performance =   6.15 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.054586 s, Result = 0a820000, Performance =   6.29 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1202   919  1728
Test passed: M N K =   763   781  1792
Test passed: M N K =   145   310  1408
Test passed: M N K =   697   971  1728
Test passed: M N K =  1486   778   320
M N K =  1024  1024   256, Elapsed time =   0.000694 s, Result = 0001e000, Performance =   7.73 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001484 s, Result = 0003c000, Performance =   7.24 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002514 s, Result = 0005a000, Performance =   6.41 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003314 s, Result = 00078000, Performance =   6.48 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004113 s, Result = 00096000, Performance =   6.53 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005154 s, Result = 000b4000, Performance =   6.25 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005927 s, Result = 000d2000, Performance =   6.34 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006778 s, Result = 000f0000, Performance =   6.34 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007942 s, Result = 0010e000, Performance =   6.08 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009072 s, Result = 0012c000, Performance =   5.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010135 s, Result = 0014a000, Performance =   5.83 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011131 s, Result = 00168000, Performance =   5.79 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012442 s, Result = 00186000, Performance =   5.61 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012948 s, Result = 001a4000, Performance =   5.81 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013405 s, Result = 001c2000, Performance =   6.01 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013320 s, Result = 001e0000, Performance =   6.45 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011099 s, Result = 001fe000, Performance =   8.22 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010923 s, Result = 0021c000, Performance =   8.85 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011663 s, Result = 0023a000, Performance =   8.75 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012776 s, Result = 00258000, Performance =   8.40 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013746 s, Result = 00276000, Performance =   8.20 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014664 s, Result = 00294000, Performance =   8.05 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015469 s, Result = 002b2000, Performance =   7.98 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016295 s, Result = 002d0000, Performance =   7.91 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017394 s, Result = 002ee000, Performance =   7.72 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018123 s, Result = 0030c000, Performance =   7.70 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019094 s, Result = 0032a000, Performance =   7.59 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019928 s, Result = 00348000, Performance =   7.54 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021047 s, Result = 00366000, Performance =   7.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021587 s, Result = 00384000, Performance =   7.46 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022651 s, Result = 003a2000, Performance =   7.35 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023428 s, Result = 003c0000, Performance =   7.33 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022834 s, Result = 003de000, Performance =   7.76 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023802 s, Result = 003fc000, Performance =   7.67 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024616 s, Result = 0041a000, Performance =   7.63 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025717 s, Result = 00438000, Performance =   7.52 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026748 s, Result = 00456000, Performance =   7.43 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028168 s, Result = 00474000, Performance =   7.24 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028892 s, Result = 00492000, Performance =   7.25 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030498 s, Result = 004b0000, Performance =   7.04 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031111 s, Result = 004ce000, Performance =   7.08 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032158 s, Result = 004ec000, Performance =   7.01 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032520 s, Result = 0050a000, Performance =   7.10 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034170 s, Result = 00528000, Performance =   6.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034851 s, Result = 00546000, Performance =   6.93 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.036045 s, Result = 00564000, Performance =   6.85 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.036750 s, Result = 00582000, Performance =   6.87 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037755 s, Result = 005a0000, Performance =   6.83 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.038277 s, Result = 005be000, Performance =   6.87 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039659 s, Result = 005dc000, Performance =   6.77 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040527 s, Result = 005fa000, Performance =   6.76 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038748 s, Result = 00618000, Performance =   7.20 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.042862 s, Result = 00636000, Performance =   6.64 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.042620 s, Result = 00654000, Performance =   6.80 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.043736 s, Result = 00672000, Performance =   6.75 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.044458 s, Result = 00690000, Performance =   6.76 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.044880 s, Result = 006ae000, Performance =   6.82 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.050438 s, Result = 006cc000, Performance =   6.17 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.050871 s, Result = 006ea000, Performance =   6.23 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051629 s, Result = 00708000, Performance =   6.24 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052315 s, Result = 00726000, Performance =   6.26 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.053005 s, Result = 00744000, Performance =   6.28 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.049888 s, Result = 00762000, Performance =   6.78 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.050500 s, Result = 00780000, Performance =   6.80 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1055  1381  2048
Test passed: M N K =   447   576  1984
Test passed: M N K =  1937  2012  2048
Test passed: M N K =  1487   772   320
Test passed: M N K =   312  1260  1920
M N K =  1024  1024   256, Elapsed time =   0.005404 s, Result = 5902e000, Performance =   0.99 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005242 s, Result = 3104c000, Performance =   2.05 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005845 s, Result = 0906a000, Performance =   2.76 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006386 s, Result = e1088000, Performance =   3.36 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006963 s, Result = b90a6000, Performance =   3.86 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007519 s, Result = 910c4000, Performance =   4.28 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008103 s, Result = 690e2000, Performance =   4.64 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008642 s, Result = 41100000, Performance =   4.97 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.009275 s, Result = 1911e000, Performance =   5.21 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009847 s, Result = f113c000, Performance =   5.45 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010555 s, Result = c915a000, Performance =   5.60 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011159 s, Result = a1178000, Performance =   5.77 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011924 s, Result = 79196000, Performance =   5.85 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012526 s, Result = 511b4000, Performance =   6.00 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013321 s, Result = 291d2000, Performance =   6.05 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013974 s, Result = 011f0000, Performance =   6.15 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014875 s, Result = d920e000, Performance =   6.14 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015590 s, Result = b122c000, Performance =   6.20 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016480 s, Result = 8924a000, Performance =   6.19 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017173 s, Result = 61268000, Performance =   6.25 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017958 s, Result = 39286000, Performance =   6.28 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018654 s, Result = 112a4000, Performance =   6.33 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019334 s, Result = e92c2000, Performance =   6.39 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.019932 s, Result = c12e0000, Performance =   6.46 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.020626 s, Result = 992fe000, Performance =   6.51 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021399 s, Result = 7131c000, Performance =   6.52 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022187 s, Result = 4933a000, Performance =   6.53 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.022917 s, Result = 21358000, Performance =   6.56 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.023683 s, Result = f9376000, Performance =   6.57 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.024558 s, Result = d1394000, Performance =   6.56 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025360 s, Result = a93b2000, Performance =   6.56 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026182 s, Result = 813d0000, Performance =   6.56 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027024 s, Result = 593ee000, Performance =   6.56 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027032 s, Result = 3140c000, Performance =   6.75 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.027985 s, Result = 0942a000, Performance =   6.71 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028962 s, Result = e1448000, Performance =   6.67 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030153 s, Result = b9466000, Performance =   6.59 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030955 s, Result = 91484000, Performance =   6.59 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.032082 s, Result = 694a2000, Performance =   6.53 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032979 s, Result = 414c0000, Performance =   6.51 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033861 s, Result = 194de000, Performance =   6.50 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034678 s, Result = f14fc000, Performance =   6.50 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035662 s, Result = c951a000, Performance =   6.47 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036717 s, Result = a1538000, Performance =   6.43 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.038044 s, Result = 79556000, Performance =   6.35 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.039496 s, Result = 51574000, Performance =   6.25 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.040338 s, Result = 29592000, Performance =   6.26 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.041496 s, Result = 015b0000, Performance =   6.21 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.042414 s, Result = d95ce000, Performance =   6.20 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.043264 s, Result = b15ec000, Performance =   6.20 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.044296 s, Result = 8960a000, Performance =   6.18 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.045047 s, Result = 61628000, Performance =   6.20 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.046060 s, Result = 39646000, Performance =   6.18 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.046822 s, Result = 11664000, Performance =   6.19 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.047125 s, Result = e9682000, Performance =   6.27 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.048680 s, Result = c16a0000, Performance =   6.18 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.048572 s, Result = 996be000, Performance =   6.30 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.049955 s, Result = 716dc000, Performance =   6.23 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.051002 s, Result = 496fa000, Performance =   6.21 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051260 s, Result = 21718000, Performance =   6.28 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052801 s, Result = f9736000, Performance =   6.20 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.054200 s, Result = d1754000, Performance =   6.14 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.053953 s, Result = a9772000, Performance =   6.27 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.055321 s, Result = 81790000, Performance =   6.21 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   763  1666  1152
Test passed: M N K =  1422  1089  1152
Test passed: M N K =  1255  1837   256
Test passed: M N K =  1216  2036   128
Test passed: M N K =   952  1026  2048
M N K =  1024  1024   256, Elapsed time =   0.003018 s, Result = 0001e000, Performance =   1.78 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002781 s, Result = 0003c000, Performance =   3.86 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003332 s, Result = 0005a000, Performance =   4.83 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003871 s, Result = 00078000, Performance =   5.55 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005269 s, Result = 00096000, Performance =   5.09 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007638 s, Result = 000b4000, Performance =   4.22 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008535 s, Result = 000d2000, Performance =   4.40 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009678 s, Result = 000f0000, Performance =   4.44 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010708 s, Result = 0010e000, Performance =   4.51 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011316 s, Result = 0012c000, Performance =   4.74 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.012621 s, Result = 0014a000, Performance =   4.68 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012034 s, Result = 00168000, Performance =   5.35 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012276 s, Result = 00186000, Performance =   5.69 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011555 s, Result = 001a4000, Performance =   6.50 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011295 s, Result = 001c2000, Performance =   7.13 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011472 s, Result = 001e0000, Performance =   7.49 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012170 s, Result = 001fe000, Performance =   7.50 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012854 s, Result = 0021c000, Performance =   7.52 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013710 s, Result = 0023a000, Performance =   7.44 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014511 s, Result = 00258000, Performance =   7.40 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015539 s, Result = 00276000, Performance =   7.26 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016350 s, Result = 00294000, Performance =   7.22 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017071 s, Result = 002b2000, Performance =   7.23 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017818 s, Result = 002d0000, Performance =   7.23 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018449 s, Result = 002ee000, Performance =   7.28 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019220 s, Result = 0030c000, Performance =   7.26 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019931 s, Result = 0032a000, Performance =   7.27 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020617 s, Result = 00348000, Performance =   7.29 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021387 s, Result = 00366000, Performance =   7.28 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022243 s, Result = 00384000, Performance =   7.24 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.024113 s, Result = 003a2000, Performance =   6.90 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024756 s, Result = 003c0000, Performance =   6.94 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025694 s, Result = 003de000, Performance =   6.90 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025351 s, Result = 003fc000, Performance =   7.20 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026494 s, Result = 0041a000, Performance =   7.09 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027561 s, Result = 00438000, Performance =   7.01 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028543 s, Result = 00456000, Performance =   6.96 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029816 s, Result = 00474000, Performance =   6.84 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030020 s, Result = 00492000, Performance =   6.97 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.031430 s, Result = 004b0000, Performance =   6.83 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032084 s, Result = 004ce000, Performance =   6.86 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032690 s, Result = 004ec000, Performance =   6.90 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.033565 s, Result = 0050a000, Performance =   6.88 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.034451 s, Result = 00528000, Performance =   6.86 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.035609 s, Result = 00546000, Performance =   6.78 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.036959 s, Result = 00564000, Performance =   6.68 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037930 s, Result = 00582000, Performance =   6.65 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.038689 s, Result = 005a0000, Performance =   6.66 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039438 s, Result = 005be000, Performance =   6.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.040501 s, Result = 005dc000, Performance =   6.63 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.040879 s, Result = 005fa000, Performance =   6.70 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042283 s, Result = 00618000, Performance =   6.60 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.042634 s, Result = 00636000, Performance =   6.67 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044515 s, Result = 00654000, Performance =   6.51 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.044447 s, Result = 00672000, Performance =   6.64 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045756 s, Result = 00690000, Performance =   6.57 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046299 s, Result = 006ae000, Performance =   6.61 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.047224 s, Result = 006cc000, Performance =   6.59 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.048146 s, Result = 006ea000, Performance =   6.58 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.048638 s, Result = 00708000, Performance =   6.62 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.050199 s, Result = 00726000, Performance =   6.52 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.051008 s, Result = 00744000, Performance =   6.53 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.050852 s, Result = 00762000, Performance =   6.65 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051846 s, Result = 00780000, Performance =   6.63 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1001  1413  2048
Test passed: M N K =  1293  1889   448
Test passed: M N K =   963  1282  1920
Test passed: M N K =   443  1292  1024
Test passed: M N K =  1996    26  1728
M N K =  1024  1024   256, Elapsed time =   0.004538 s, Result = 0a0be000, Performance =   1.18 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005027 s, Result = 0a0dc000, Performance =   2.14 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005414 s, Result = 0a0fa000, Performance =   2.97 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005827 s, Result = 0a118000, Performance =   3.69 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006357 s, Result = 0a136000, Performance =   4.22 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006853 s, Result = 0a154000, Performance =   4.70 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007366 s, Result = 0a172000, Performance =   5.10 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007937 s, Result = 0a190000, Performance =   5.41 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008562 s, Result = 0a1ae000, Performance =   5.64 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009175 s, Result = 0a1cc000, Performance =   5.85 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009814 s, Result = 0a1ea000, Performance =   6.02 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010435 s, Result = 0a208000, Performance =   6.17 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011073 s, Result = 0a226000, Performance =   6.30 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011713 s, Result = 0a244000, Performance =   6.42 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012332 s, Result = 0a262000, Performance =   6.53 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012979 s, Result = 0a280000, Performance =   6.62 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013740 s, Result = 0a29e000, Performance =   6.64 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014402 s, Result = 0a2bc000, Performance =   6.71 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015301 s, Result = 0a2da000, Performance =   6.67 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016031 s, Result = 0a2f8000, Performance =   6.70 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016938 s, Result = 0a316000, Performance =   6.66 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017404 s, Result = 0a334000, Performance =   6.79 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018126 s, Result = 0a352000, Performance =   6.81 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018883 s, Result = 0a370000, Performance =   6.82 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019528 s, Result = 0a38e000, Performance =   6.87 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020321 s, Result = 0a3ac000, Performance =   6.87 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021111 s, Result = 0a3ca000, Performance =   6.87 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021801 s, Result = 0a3e8000, Performance =   6.90 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.022610 s, Result = 0a406000, Performance =   6.89 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.023318 s, Result = 0a424000, Performance =   6.91 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025299 s, Result = 0a442000, Performance =   6.58 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026427 s, Result = 0a460000, Performance =   6.50 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027256 s, Result = 0a47e000, Performance =   6.50 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.027205 s, Result = 0a49c000, Performance =   6.71 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028168 s, Result = 0a4ba000, Performance =   6.67 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029248 s, Result = 0a4d8000, Performance =   6.61 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.030038 s, Result = 0a4f6000, Performance =   6.61 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030987 s, Result = 0a514000, Performance =   6.58 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.031662 s, Result = 0a532000, Performance =   6.61 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032818 s, Result = 0a550000, Performance =   6.54 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033366 s, Result = 0a56e000, Performance =   6.60 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.033980 s, Result = 0a58c000, Performance =   6.64 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.034789 s, Result = 0a5aa000, Performance =   6.64 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.035603 s, Result = 0a5c8000, Performance =   6.63 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036780 s, Result = 0a5e6000, Performance =   6.57 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.038100 s, Result = 0a604000, Performance =   6.48 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038871 s, Result = 0a622000, Performance =   6.49 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039749 s, Result = 0a640000, Performance =   6.48 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040064 s, Result = 0a65e000, Performance =   6.57 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041377 s, Result = 0a67c000, Performance =   6.49 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.042001 s, Result = 0a69a000, Performance =   6.52 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042932 s, Result = 0a6b8000, Performance =   6.50 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043785 s, Result = 0a6d6000, Performance =   6.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044684 s, Result = 0a6f4000, Performance =   6.49 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.045397 s, Result = 0a712000, Performance =   6.50 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.046568 s, Result = 0a730000, Performance =   6.46 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046891 s, Result = 0a74e000, Performance =   6.53 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.054124 s, Result = 0a76c000, Performance =   5.75 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.050363 s, Result = 0a78a000, Performance =   6.29 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.051365 s, Result = 0a7a8000, Performance =   6.27 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.051839 s, Result = 0a7c6000, Performance =   6.32 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.052966 s, Result = 0a7e4000, Performance =   6.28 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.052612 s, Result = 0a802000, Performance =   6.43 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.053266 s, Result = 0a820000, Performance =   6.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1706  1386   512
Test passed: M N K =  1105  1817  2048
Test passed: M N K =  1862  1381   320
Test passed: M N K =    47   807   320
Test passed: M N K =   666   317  1280
M N K =  1024  1024   256, Elapsed time =   0.000650 s, Result = 0001e000, Performance =   8.26 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001433 s, Result = 0003c000, Performance =   7.49 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002728 s, Result = 0005a000, Performance =   5.90 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003820 s, Result = 00078000, Performance =   5.62 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004897 s, Result = 00096000, Performance =   5.48 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005697 s, Result = 000b4000, Performance =   5.65 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007855 s, Result = 000d2000, Performance =   4.78 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007671 s, Result = 000f0000, Performance =   5.60 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007761 s, Result = 0010e000, Performance =   6.23 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008517 s, Result = 0012c000, Performance =   6.30 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009479 s, Result = 0014a000, Performance =   6.23 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010345 s, Result = 00168000, Performance =   6.23 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011289 s, Result = 00186000, Performance =   6.18 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012180 s, Result = 001a4000, Performance =   6.17 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013464 s, Result = 001c2000, Performance =   5.98 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012867 s, Result = 001e0000, Performance =   6.68 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014838 s, Result = 001fe000, Performance =   6.15 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015061 s, Result = 0021c000, Performance =   6.42 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014869 s, Result = 0023a000, Performance =   6.86 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014489 s, Result = 00258000, Performance =   7.41 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.023361 s, Result = 00276000, Performance =   4.83 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.027409 s, Result = 00294000, Performance =   4.31 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.030052 s, Result = 002b2000, Performance =   4.11 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.026081 s, Result = 002d0000, Performance =   4.94 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.024382 s, Result = 002ee000, Performance =   5.50 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.020940 s, Result = 0030c000, Performance =   6.67 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019219 s, Result = 0032a000, Performance =   7.54 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018002 s, Result = 00348000, Performance =   8.35 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018992 s, Result = 00366000, Performance =   8.20 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022444 s, Result = 00384000, Performance =   7.18 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021290 s, Result = 003a2000, Performance =   7.82 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024401 s, Result = 003c0000, Performance =   7.04 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023920 s, Result = 003de000, Performance =   7.41 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.024352 s, Result = 003fc000, Performance =   7.50 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023160 s, Result = 0041a000, Performance =   8.11 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024171 s, Result = 00438000, Performance =   8.00 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.037110 s, Result = 00456000, Performance =   5.35 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.043695 s, Result = 00474000, Performance =   4.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.036005 s, Result = 00492000, Performance =   5.82 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.034169 s, Result = 004b0000, Performance =   6.28 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032166 s, Result = 004ce000, Performance =   6.84 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031911 s, Result = 004ec000, Performance =   7.07 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032309 s, Result = 0050a000, Performance =   7.15 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033457 s, Result = 00528000, Performance =   7.06 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.033967 s, Result = 00546000, Performance =   7.11 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.035347 s, Result = 00564000, Performance =   6.99 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035743 s, Result = 00582000, Performance =   7.06 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.037170 s, Result = 005a0000, Performance =   6.93 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037593 s, Result = 005be000, Performance =   7.00 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.039317 s, Result = 005dc000, Performance =   6.83 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.039779 s, Result = 005fa000, Performance =   6.88 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.041159 s, Result = 00618000, Performance =   6.78 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.041575 s, Result = 00636000, Performance =   6.84 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.043403 s, Result = 00654000, Performance =   6.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.043538 s, Result = 00672000, Performance =   6.78 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045217 s, Result = 00690000, Performance =   6.65 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.045191 s, Result = 006ae000, Performance =   6.77 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.047008 s, Result = 006cc000, Performance =   6.62 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.046916 s, Result = 006ea000, Performance =   6.75 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.048528 s, Result = 00708000, Performance =   6.64 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.052496 s, Result = 00726000, Performance =   6.24 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.056040 s, Result = 00744000, Performance =   5.94 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.046905 s, Result = 00762000, Performance =   7.21 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.065590 s, Result = 00780000, Performance =   5.24 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   250   726  1216
Test passed: M N K =   160   722   832
Test passed: M N K =   993   811   512
Test passed: M N K =  1055   924  1920
Test passed: M N K =   632  1510   128
M N K =  1024  1024   256, Elapsed time =   0.006413 s, Result = 5902e000, Performance =   0.84 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006783 s, Result = 3104c000, Performance =   1.58 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006911 s, Result = 0906a000, Performance =   2.33 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.007005 s, Result = e1088000, Performance =   3.07 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007311 s, Result = b90a6000, Performance =   3.67 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007735 s, Result = 910c4000, Performance =   4.16 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008281 s, Result = 690e2000, Performance =   4.54 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008848 s, Result = 41100000, Performance =   4.85 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010355 s, Result = 1911e000, Performance =   4.67 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010956 s, Result = f113c000, Performance =   4.90 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011537 s, Result = c915a000, Performance =   5.12 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.012136 s, Result = a1178000, Performance =   5.31 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012914 s, Result = 79196000, Performance =   5.40 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.013675 s, Result = 511b4000, Performance =   5.50 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.014224 s, Result = 291d2000, Performance =   5.66 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.014737 s, Result = 011f0000, Performance =   5.83 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015546 s, Result = d920e000, Performance =   5.87 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015978 s, Result = b122c000, Performance =   6.05 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016632 s, Result = 8924a000, Performance =   6.13 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017302 s, Result = 61268000, Performance =   6.21 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.018041 s, Result = 39286000, Performance =   6.25 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018813 s, Result = 112a4000, Performance =   6.28 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.019537 s, Result = e92c2000, Performance =   6.32 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020122 s, Result = c12e0000, Performance =   6.40 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.021111 s, Result = 992fe000, Performance =   6.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.021866 s, Result = 7131c000, Performance =   6.38 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.022590 s, Result = 4933a000, Performance =   6.42 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.023312 s, Result = 21358000, Performance =   6.45 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024057 s, Result = f9376000, Performance =   6.47 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025123 s, Result = d1394000, Performance =   6.41 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025892 s, Result = a93b2000, Performance =   6.43 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026729 s, Result = 813d0000, Performance =   6.43 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027254 s, Result = 593ee000, Performance =   6.50 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028463 s, Result = 3140c000, Performance =   6.41 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028799 s, Result = 0942a000, Performance =   6.52 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.029468 s, Result = e1448000, Performance =   6.56 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029983 s, Result = b9466000, Performance =   6.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.030897 s, Result = 91484000, Performance =   6.60 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.031665 s, Result = 694a2000, Performance =   6.61 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032685 s, Result = 414c0000, Performance =   6.57 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.033327 s, Result = 194de000, Performance =   6.60 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.034276 s, Result = f14fc000, Performance =   6.58 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.035148 s, Result = c951a000, Performance =   6.57 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.036079 s, Result = a1538000, Performance =   6.55 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.036938 s, Result = 79556000, Performance =   6.54 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.040129 s, Result = 51574000, Performance =   6.15 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.038903 s, Result = 29592000, Performance =   6.49 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.039523 s, Result = 015b0000, Performance =   6.52 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.040724 s, Result = d95ce000, Performance =   6.46 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.059868 s, Result = b15ec000, Performance =   4.48 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.042585 s, Result = 8960a000, Performance =   6.43 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.043691 s, Result = 61628000, Performance =   6.39 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.061027 s, Result = 39646000, Performance =   4.66 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.045058 s, Result = 11664000, Performance =   6.43 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.049724 s, Result = e9682000, Performance =   5.94 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.060648 s, Result = c16a0000, Performance =   4.96 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.047469 s, Result = 996be000, Performance =   6.45 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.050705 s, Result = 716dc000, Performance =   6.14 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.048742 s, Result = 496fa000, Performance =   6.50 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.050097 s, Result = 21718000, Performance =   6.43 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.049681 s, Result = f9736000, Performance =   6.59 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.051261 s, Result = d1754000, Performance =   6.49 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.068995 s, Result = a9772000, Performance =   4.90 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.059383 s, Result = 81790000, Performance =   5.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1407  1816  1408
Test passed: M N K =  1010  1709   576
Test passed: M N K =  1640   119  2048
Test passed: M N K =  1695    80    64
Test passed: M N K =  1019   728    64
M N K =  1024  1024   256, Elapsed time =   0.002044 s, Result = 0001e000, Performance =   2.63 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002608 s, Result = 0003c000, Performance =   4.12 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003217 s, Result = 0005a000, Performance =   5.01 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003884 s, Result = 00078000, Performance =   5.53 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.004591 s, Result = 00096000, Performance =   5.85 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.005278 s, Result = 000b4000, Performance =   6.10 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005898 s, Result = 000d2000, Performance =   6.37 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006521 s, Result = 000f0000, Performance =   6.59 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007149 s, Result = 0010e000, Performance =   6.76 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007786 s, Result = 0012c000, Performance =   6.90 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008361 s, Result = 0014a000, Performance =   7.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009015 s, Result = 00168000, Performance =   7.15 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009699 s, Result = 00186000, Performance =   7.20 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010397 s, Result = 001a4000, Performance =   7.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011048 s, Result = 001c2000, Performance =   7.29 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011641 s, Result = 001e0000, Performance =   7.38 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012413 s, Result = 001fe000, Performance =   7.35 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013004 s, Result = 0021c000, Performance =   7.43 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013742 s, Result = 0023a000, Performance =   7.42 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014300 s, Result = 00258000, Performance =   7.51 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015011 s, Result = 00276000, Performance =   7.51 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015502 s, Result = 00294000, Performance =   7.62 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016114 s, Result = 002b2000, Performance =   7.66 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016727 s, Result = 002d0000, Performance =   7.70 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017417 s, Result = 002ee000, Performance =   7.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018089 s, Result = 0030c000, Performance =   7.72 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018848 s, Result = 0032a000, Performance =   7.69 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019500 s, Result = 00348000, Performance =   7.71 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020342 s, Result = 00366000, Performance =   7.65 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021214 s, Result = 00384000, Performance =   7.59 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022046 s, Result = 003a2000, Performance =   7.55 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.025100 s, Result = 003c0000, Performance =   6.84 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024889 s, Result = 003de000, Performance =   7.12 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025867 s, Result = 003fc000, Performance =   7.06 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026336 s, Result = 0041a000, Performance =   7.13 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026809 s, Result = 00438000, Performance =   7.21 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.027524 s, Result = 00456000, Performance =   7.22 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028279 s, Result = 00474000, Performance =   7.21 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.029322 s, Result = 00492000, Performance =   7.14 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029986 s, Result = 004b0000, Performance =   7.16 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030722 s, Result = 004ce000, Performance =   7.16 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.031577 s, Result = 004ec000, Performance =   7.14 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032437 s, Result = 0050a000, Performance =   7.12 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033249 s, Result = 00528000, Performance =   7.10 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034203 s, Result = 00546000, Performance =   7.06 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034974 s, Result = 00564000, Performance =   7.06 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.036032 s, Result = 00582000, Performance =   7.00 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.036527 s, Result = 005a0000, Performance =   7.06 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.037664 s, Result = 005be000, Performance =   6.98 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.038500 s, Result = 005dc000, Performance =   6.97 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.039626 s, Result = 005fa000, Performance =   6.91 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.040338 s, Result = 00618000, Performance =   6.92 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.041365 s, Result = 00636000, Performance =   6.88 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.041936 s, Result = 00654000, Performance =   6.91 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.043130 s, Result = 00672000, Performance =   6.85 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.043350 s, Result = 00690000, Performance =   6.94 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.044332 s, Result = 006ae000, Performance =   6.90 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.045705 s, Result = 006cc000, Performance =   6.81 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.045279 s, Result = 006ea000, Performance =   7.00 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.047231 s, Result = 00708000, Performance =   6.82 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.046847 s, Result = 00726000, Performance =   6.99 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.048501 s, Result = 00744000, Performance =   6.86 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.049484 s, Result = 00762000, Performance =   6.84 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.051450 s, Result = 00780000, Performance =   6.68 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1944    36  1344
Test passed: M N K =  1608   244  1856
Test passed: M N K =   398  1446   576
Test passed: M N K =  1976  1187   128
Test passed: M N K =  1338   664  1600
M N K =  1024  1024   256, Elapsed time =   0.005146 s, Result = 0a0be000, Performance =   1.04 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006030 s, Result = 0a0dc000, Performance =   1.78 TOPS
M N K =  1024  1024   768, Elapsed time =   0.008089 s, Result = 0a0fa000, Performance =   1.99 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.010436 s, Result = 0a118000, Performance =   2.06 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007335 s, Result = 0a136000, Performance =   3.66 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.007829 s, Result = 0a154000, Performance =   4.11 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.008230 s, Result = 0a172000, Performance =   4.57 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.010894 s, Result = 0a190000, Performance =   3.94 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.015522 s, Result = 0a1ae000, Performance =   3.11 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.010069 s, Result = 0a1cc000, Performance =   5.33 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010489 s, Result = 0a1ea000, Performance =   5.63 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011035 s, Result = 0a208000, Performance =   5.84 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.012478 s, Result = 0a226000, Performance =   5.59 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012712 s, Result = 0a244000, Performance =   5.91 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013124 s, Result = 0a262000, Performance =   6.14 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013708 s, Result = 0a280000, Performance =   6.27 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.014376 s, Result = 0a29e000, Performance =   6.35 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015013 s, Result = 0a2bc000, Performance =   6.44 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015717 s, Result = 0a2da000, Performance =   6.49 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016524 s, Result = 0a2f8000, Performance =   6.50 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017186 s, Result = 0a316000, Performance =   6.56 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017710 s, Result = 0a334000, Performance =   6.67 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018209 s, Result = 0a352000, Performance =   6.78 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018840 s, Result = 0a370000, Performance =   6.84 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.027645 s, Result = 0a38e000, Performance =   4.86 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.031914 s, Result = 0a3ac000, Performance =   4.37 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.021212 s, Result = 0a3ca000, Performance =   6.83 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021337 s, Result = 0a3e8000, Performance =   7.05 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.037665 s, Result = 0a406000, Performance =   4.13 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025592 s, Result = 0a424000, Performance =   6.29 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.025410 s, Result = 0a442000, Performance =   6.55 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.027698 s, Result = 0a460000, Performance =   6.20 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.027702 s, Result = 0a47e000, Performance =   6.40 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.028073 s, Result = 0a49c000, Performance =   6.50 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.028534 s, Result = 0a4ba000, Performance =   6.59 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.028889 s, Result = 0a4d8000, Performance =   6.69 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.029417 s, Result = 0a4f6000, Performance =   6.75 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.042372 s, Result = 0a514000, Performance =   4.81 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.041116 s, Result = 0a532000, Performance =   5.09 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.032235 s, Result = 0a550000, Performance =   6.66 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.032449 s, Result = 0a56e000, Performance =   6.78 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.035411 s, Result = 0a58c000, Performance =   6.37 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.034335 s, Result = 0a5aa000, Performance =   6.72 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.044860 s, Result = 0a5c8000, Performance =   5.27 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.041341 s, Result = 0a5e6000, Performance =   5.84 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.037155 s, Result = 0a604000, Performance =   6.65 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.037831 s, Result = 0a622000, Performance =   6.67 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.038540 s, Result = 0a640000, Performance =   6.69 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.039445 s, Result = 0a65e000, Performance =   6.67 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.041541 s, Result = 0a67c000, Performance =   6.46 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.047391 s, Result = 0a69a000, Performance =   5.78 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.042835 s, Result = 0a6b8000, Performance =   6.52 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.043600 s, Result = 0a6d6000, Performance =   6.53 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.044446 s, Result = 0a6f4000, Performance =   6.52 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.045567 s, Result = 0a712000, Performance =   6.48 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.045625 s, Result = 0a730000, Performance =   6.59 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.046632 s, Result = 0a74e000, Performance =   6.56 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.048314 s, Result = 0a76c000, Performance =   6.45 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.047414 s, Result = 0a78a000, Performance =   6.68 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.049457 s, Result = 0a7a8000, Performance =   6.51 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.048715 s, Result = 0a7c6000, Performance =   6.72 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.050529 s, Result = 0a7e4000, Performance =   6.59 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.051832 s, Result = 0a802000, Performance =   6.53 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.053287 s, Result = 0a820000, Performance =   6.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   823  1170   192
Test passed: M N K =  1249  1620  1728
Test passed: M N K =  1395   801   832
Test passed: M N K =  1261   941  1280
Test passed: M N K =  1494   840  1408
M N K =  1024  1024   256, Elapsed time =   0.000651 s, Result = 0001e000, Performance =   8.25 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001450 s, Result = 0003c000, Performance =   7.40 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002120 s, Result = 0005a000, Performance =   7.60 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002857 s, Result = 00078000, Performance =   7.52 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003924 s, Result = 00096000, Performance =   6.84 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004929 s, Result = 000b4000, Performance =   6.54 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.005594 s, Result = 000d2000, Performance =   6.72 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.006225 s, Result = 000f0000, Performance =   6.90 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007309 s, Result = 0010e000, Performance =   6.61 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008036 s, Result = 0012c000, Performance =   6.68 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008819 s, Result = 0014a000, Performance =   6.70 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009276 s, Result = 00168000, Performance =   6.95 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010248 s, Result = 00186000, Performance =   6.81 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010785 s, Result = 001a4000, Performance =   6.97 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010656 s, Result = 001c2000, Performance =   7.56 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009536 s, Result = 001e0000, Performance =   9.01 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010245 s, Result = 001fe000, Performance =   8.91 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.011152 s, Result = 0021c000, Performance =   8.67 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011926 s, Result = 0023a000, Performance =   8.55 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012690 s, Result = 00258000, Performance =   8.46 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013633 s, Result = 00276000, Performance =   8.27 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014547 s, Result = 00294000, Performance =   8.12 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015416 s, Result = 002b2000, Performance =   8.01 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016262 s, Result = 002d0000, Performance =   7.92 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017017 s, Result = 002ee000, Performance =   7.89 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017944 s, Result = 0030c000, Performance =   7.78 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018985 s, Result = 0032a000, Performance =   7.64 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019647 s, Result = 00348000, Performance =   7.65 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.020211 s, Result = 00366000, Performance =   7.70 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021535 s, Result = 00384000, Performance =   7.48 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020389 s, Result = 003a2000, Performance =   8.16 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021150 s, Result = 003c0000, Performance =   8.12 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021990 s, Result = 003de000, Performance =   8.06 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022891 s, Result = 003fc000, Performance =   7.97 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023300 s, Result = 0041a000, Performance =   8.06 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023504 s, Result = 00438000, Performance =   8.22 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024594 s, Result = 00456000, Performance =   8.08 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025250 s, Result = 00474000, Performance =   8.08 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.026216 s, Result = 00492000, Performance =   7.99 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.026913 s, Result = 004b0000, Performance =   7.98 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.028103 s, Result = 004ce000, Performance =   7.83 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029016 s, Result = 004ec000, Performance =   7.77 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030117 s, Result = 0050a000, Performance =   7.67 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.030915 s, Result = 00528000, Performance =   7.64 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032097 s, Result = 00546000, Performance =   7.53 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032997 s, Result = 00564000, Performance =   7.48 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.034038 s, Result = 00582000, Performance =   7.41 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.034803 s, Result = 005a0000, Performance =   7.40 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.035762 s, Result = 005be000, Performance =   7.36 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.036480 s, Result = 005dc000, Performance =   7.36 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037446 s, Result = 005fa000, Performance =   7.31 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.038001 s, Result = 00618000, Performance =   7.35 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038713 s, Result = 00636000, Performance =   7.35 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.039480 s, Result = 00654000, Performance =   7.34 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.040520 s, Result = 00672000, Performance =   7.29 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.040898 s, Result = 00690000, Performance =   7.35 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.042116 s, Result = 006ae000, Performance =   7.27 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.043705 s, Result = 006cc000, Performance =   7.12 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.043151 s, Result = 006ea000, Performance =   7.34 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.044608 s, Result = 00708000, Performance =   7.22 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.044593 s, Result = 00726000, Performance =   7.34 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.045496 s, Result = 00744000, Performance =   7.32 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.047348 s, Result = 00762000, Performance =   7.14 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.047775 s, Result = 00780000, Performance =   7.19 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   102   501   448
Test passed: M N K =  1462   160   256
Test passed: M N K =  1475  1014   384
Test passed: M N K =   831  1153  1344
Test passed: M N K =  1975   216   448
M N K =  1024  1024   256, Elapsed time =   0.005028 s, Result = 21024000, Performance =   1.07 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005915 s, Result = 41038000, Performance =   1.82 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005643 s, Result = 6104c000, Performance =   2.85 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005922 s, Result = 81060000, Performance =   3.63 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006425 s, Result = a1074000, Performance =   4.18 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006860 s, Result = c1088000, Performance =   4.70 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007541 s, Result = e109c000, Performance =   4.98 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.008060 s, Result = 010b0000, Performance =   5.33 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008691 s, Result = 210c4000, Performance =   5.56 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.009425 s, Result = 410d8000, Performance =   5.70 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.010235 s, Result = 610ec000, Performance =   5.77 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.011022 s, Result = 81100000, Performance =   5.85 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011910 s, Result = a1114000, Performance =   5.86 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.012720 s, Result = c1128000, Performance =   5.91 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.013515 s, Result = e113c000, Performance =   5.96 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.015548 s, Result = 01150000, Performance =   5.52 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.015339 s, Result = 21164000, Performance =   5.95 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.015955 s, Result = 41178000, Performance =   6.06 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.016556 s, Result = 6118c000, Performance =   6.16 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.017132 s, Result = 811a0000, Performance =   6.27 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.017585 s, Result = a11b4000, Performance =   6.41 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.018095 s, Result = c11c8000, Performance =   6.53 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.018692 s, Result = e11dc000, Performance =   6.61 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.020661 s, Result = 011f0000, Performance =   6.24 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.022026 s, Result = 21204000, Performance =   6.09 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.022806 s, Result = 41218000, Performance =   6.12 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.023619 s, Result = 6122c000, Performance =   6.14 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.024397 s, Result = 81240000, Performance =   6.16 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.024927 s, Result = a1254000, Performance =   6.25 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.025466 s, Result = c1268000, Performance =   6.32 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.026698 s, Result = e127c000, Performance =   6.23 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.026194 s, Result = 01290000, Performance =   6.56 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.025249 s, Result = 212a4000, Performance =   7.02 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.026049 s, Result = 412b8000, Performance =   7.01 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.026870 s, Result = 612cc000, Performance =   6.99 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.027890 s, Result = 812e0000, Performance =   6.93 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.028690 s, Result = a12f4000, Performance =   6.92 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.029420 s, Result = c1308000, Performance =   6.93 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.030231 s, Result = e131c000, Performance =   6.93 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.030902 s, Result = 01330000, Performance =   6.95 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.031584 s, Result = 21344000, Performance =   6.97 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.032320 s, Result = 41358000, Performance =   6.98 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.032784 s, Result = 6136c000, Performance =   7.04 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.033567 s, Result = 81380000, Performance =   7.04 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.034180 s, Result = a1394000, Performance =   7.07 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.034935 s, Result = c13a8000, Performance =   7.07 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.035261 s, Result = e13bc000, Performance =   7.16 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.035705 s, Result = 013d0000, Performance =   7.22 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.035904 s, Result = 213e4000, Performance =   7.33 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.036585 s, Result = 413f8000, Performance =   7.34 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.037086 s, Result = 6140c000, Performance =   7.38 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.037608 s, Result = 81420000, Performance =   7.42 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.038157 s, Result = a1434000, Performance =   7.46 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.038819 s, Result = c1448000, Performance =   7.47 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.039129 s, Result = e145c000, Performance =   7.55 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.039674 s, Result = 01470000, Performance =   7.58 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.039885 s, Result = 21484000, Performance =   7.67 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.040274 s, Result = 41498000, Performance =   7.73 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.040631 s, Result = 614ac000, Performance =   7.80 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.041175 s, Result = 814c0000, Performance =   7.82 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.041539 s, Result = a14d4000, Performance =   7.88 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.041950 s, Result = c14e8000, Performance =   7.93 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.043144 s, Result = e14fc000, Performance =   7.84 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.042074 s, Result = 01510000, Performance =   8.17 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1179  1423  1024
Test passed: M N K =    38  1415  1216
Test passed: M N K =  1397   337   896
Test passed: M N K =   325  1902   512
Test passed: M N K =   180  1448   896
M N K =  1024  1024   256, Elapsed time =   0.002657 s, Result = 00014000, Performance =   2.02 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002703 s, Result = 00028000, Performance =   3.97 TOPS
M N K =  1024  1024   768, Elapsed time =   0.003001 s, Result = 0003c000, Performance =   5.37 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003380 s, Result = 00050000, Performance =   6.35 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003801 s, Result = 00064000, Performance =   7.06 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004314 s, Result = 00078000, Performance =   7.47 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004907 s, Result = 0008c000, Performance =   7.66 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005409 s, Result = 000a0000, Performance =   7.94 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006047 s, Result = 000b4000, Performance =   7.99 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006700 s, Result = 000c8000, Performance =   8.01 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007443 s, Result = 000dc000, Performance =   7.93 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008091 s, Result = 000f0000, Performance =   7.96 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008883 s, Result = 00104000, Performance =   7.86 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009591 s, Result = 00118000, Performance =   7.84 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010603 s, Result = 0012c000, Performance =   7.60 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011364 s, Result = 00140000, Performance =   7.56 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011856 s, Result = 00154000, Performance =   7.70 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012759 s, Result = 00168000, Performance =   7.57 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014750 s, Result = 0017c000, Performance =   6.92 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014738 s, Result = 00190000, Performance =   7.29 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015145 s, Result = 001a4000, Performance =   7.44 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015656 s, Result = 001b8000, Performance =   7.54 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016396 s, Result = 001cc000, Performance =   7.53 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016913 s, Result = 001e0000, Performance =   7.62 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017673 s, Result = 001f4000, Performance =   7.59 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.018354 s, Result = 00208000, Performance =   7.61 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.019544 s, Result = 0021c000, Performance =   7.42 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020271 s, Result = 00230000, Performance =   7.42 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021058 s, Result = 00244000, Performance =   7.39 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022000 s, Result = 00258000, Performance =   7.32 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022825 s, Result = 0026c000, Performance =   7.29 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023304 s, Result = 00280000, Performance =   7.37 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022447 s, Result = 00294000, Performance =   7.89 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023133 s, Result = 002a8000, Performance =   7.89 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.023955 s, Result = 002bc000, Performance =   7.84 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.025013 s, Result = 002d0000, Performance =   7.73 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.025837 s, Result = 002e4000, Performance =   7.69 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.026632 s, Result = 002f8000, Performance =   7.66 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027523 s, Result = 0030c000, Performance =   7.61 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.028344 s, Result = 00320000, Performance =   7.58 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029068 s, Result = 00334000, Performance =   7.57 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029729 s, Result = 00348000, Performance =   7.58 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030412 s, Result = 0035c000, Performance =   7.59 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.031132 s, Result = 00370000, Performance =   7.59 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031941 s, Result = 00384000, Performance =   7.56 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032609 s, Result = 00398000, Performance =   7.57 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033059 s, Result = 003ac000, Performance =   7.63 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.033475 s, Result = 003c0000, Performance =   7.70 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.033837 s, Result = 003d4000, Performance =   7.77 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.034465 s, Result = 003e8000, Performance =   7.79 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.035005 s, Result = 003fc000, Performance =   7.82 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.035394 s, Result = 00410000, Performance =   7.89 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035853 s, Result = 00424000, Performance =   7.94 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.036345 s, Result = 00438000, Performance =   7.98 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036780 s, Result = 0044c000, Performance =   8.03 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.037359 s, Result = 00460000, Performance =   8.05 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.037774 s, Result = 00474000, Performance =   8.10 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.037956 s, Result = 00488000, Performance =   8.20 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038299 s, Result = 0049c000, Performance =   8.27 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038877 s, Result = 004b0000, Performance =   8.29 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039173 s, Result = 004c4000, Performance =   8.36 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.039731 s, Result = 004d8000, Performance =   8.38 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.040590 s, Result = 004ec000, Performance =   8.33 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.039766 s, Result = 00500000, Performance =   8.64 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   333  1721   256
Test passed: M N K =   326  1408   192
Test passed: M N K =  1925   945   512
Test passed: M N K =  1550  1380  1344
Test passed: M N K =  1381  1911   704
M N K =  1024  1024   256, Elapsed time =   0.003838 s, Result = 0a0b4000, Performance =   1.40 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004178 s, Result = 0a0c8000, Performance =   2.57 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004842 s, Result = 0a0dc000, Performance =   3.33 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005252 s, Result = 0a0f0000, Performance =   4.09 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005835 s, Result = 0a104000, Performance =   4.60 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006324 s, Result = 0a118000, Performance =   5.09 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006887 s, Result = 0a12c000, Performance =   5.46 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007507 s, Result = 0a140000, Performance =   5.72 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008141 s, Result = 0a154000, Performance =   5.94 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008727 s, Result = 0a168000, Performance =   6.15 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009575 s, Result = 0a17c000, Performance =   6.17 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010427 s, Result = 0a190000, Performance =   6.18 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.011171 s, Result = 0a1a4000, Performance =   6.25 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011907 s, Result = 0a1b8000, Performance =   6.31 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012571 s, Result = 0a1cc000, Performance =   6.41 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.013458 s, Result = 0a1e0000, Performance =   6.38 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013869 s, Result = 0a1f4000, Performance =   6.58 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014544 s, Result = 0a208000, Performance =   6.64 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.015445 s, Result = 0a21c000, Performance =   6.60 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.016012 s, Result = 0a230000, Performance =   6.71 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016709 s, Result = 0a244000, Performance =   6.75 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017173 s, Result = 0a258000, Performance =   6.88 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017803 s, Result = 0a26c000, Performance =   6.94 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018573 s, Result = 0a280000, Performance =   6.94 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.019141 s, Result = 0a294000, Performance =   7.01 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019715 s, Result = 0a2a8000, Performance =   7.08 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020423 s, Result = 0a2bc000, Performance =   7.10 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.021094 s, Result = 0a2d0000, Performance =   7.13 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021813 s, Result = 0a2e4000, Performance =   7.14 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.022565 s, Result = 0a2f8000, Performance =   7.14 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.023261 s, Result = 0a30c000, Performance =   7.15 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.024168 s, Result = 0a320000, Performance =   7.11 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023004 s, Result = 0a334000, Performance =   7.70 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.025703 s, Result = 0a348000, Performance =   7.10 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.025715 s, Result = 0a35c000, Performance =   7.31 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.026417 s, Result = 0a370000, Performance =   7.32 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.027203 s, Result = 0a384000, Performance =   7.30 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.028070 s, Result = 0a398000, Performance =   7.27 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.028806 s, Result = 0a3ac000, Performance =   7.27 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.029632 s, Result = 0a3c0000, Performance =   7.25 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.030232 s, Result = 0a3d4000, Performance =   7.28 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.030906 s, Result = 0a3e8000, Performance =   7.30 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.031452 s, Result = 0a3fc000, Performance =   7.34 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.032043 s, Result = 0a410000, Performance =   7.37 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.032549 s, Result = 0a424000, Performance =   7.42 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.033245 s, Result = 0a438000, Performance =   7.43 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.033563 s, Result = 0a44c000, Performance =   7.52 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.034012 s, Result = 0a460000, Performance =   7.58 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.034174 s, Result = 0a474000, Performance =   7.70 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.035011 s, Result = 0a488000, Performance =   7.67 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.035375 s, Result = 0a49c000, Performance =   7.74 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.035799 s, Result = 0a4b0000, Performance =   7.80 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.036411 s, Result = 0a4c4000, Performance =   7.81 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.036918 s, Result = 0a4d8000, Performance =   7.85 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.037635 s, Result = 0a4ec000, Performance =   7.85 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.038000 s, Result = 0a500000, Performance =   7.91 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.038462 s, Result = 0a514000, Performance =   7.96 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.038791 s, Result = 0a528000, Performance =   8.03 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.039178 s, Result = 0a53c000, Performance =   8.08 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.039466 s, Result = 0a550000, Performance =   8.16 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039899 s, Result = 0a564000, Performance =   8.21 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.039977 s, Result = 0a578000, Performance =   8.33 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.041214 s, Result = 0a58c000, Performance =   8.21 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.040410 s, Result = 0a5a0000, Performance =   8.50 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   547  1696  1088
Test passed: M N K =  1528   160  1792
Test passed: M N K =  1516  1681  1472
Test passed: M N K =   781   530   832
Test passed: M N K =   690   546   896
M N K =  1024  1024   256, Elapsed time =   0.000450 s, Result = 00014000, Performance =  11.93 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001371 s, Result = 00028000, Performance =   7.83 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002030 s, Result = 0003c000, Performance =   7.94 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002764 s, Result = 00050000, Performance =   7.77 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003496 s, Result = 00064000, Performance =   7.68 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003990 s, Result = 00078000, Performance =   8.07 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004735 s, Result = 0008c000, Performance =   7.94 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005403 s, Result = 000a0000, Performance =   7.95 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.006471 s, Result = 000b4000, Performance =   7.47 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.007352 s, Result = 000c8000, Performance =   7.30 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008161 s, Result = 000dc000, Performance =   7.24 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008682 s, Result = 000f0000, Performance =   7.42 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.009461 s, Result = 00104000, Performance =   7.38 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010400 s, Result = 00118000, Performance =   7.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010271 s, Result = 0012c000, Performance =   7.84 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009888 s, Result = 00140000, Performance =   8.69 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.009607 s, Result = 00154000, Performance =   9.50 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.009941 s, Result = 00168000, Performance =   9.72 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.010747 s, Result = 0017c000, Performance =   9.49 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.011525 s, Result = 00190000, Performance =   9.32 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.012407 s, Result = 001a4000, Performance =   9.09 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013382 s, Result = 001b8000, Performance =   8.83 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014300 s, Result = 001cc000, Performance =   8.63 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015156 s, Result = 001e0000, Performance =   8.50 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015885 s, Result = 001f4000, Performance =   8.45 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016715 s, Result = 00208000, Performance =   8.35 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017383 s, Result = 0021c000, Performance =   8.34 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018076 s, Result = 00230000, Performance =   8.32 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018803 s, Result = 00244000, Performance =   8.28 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019506 s, Result = 00258000, Performance =   8.26 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020144 s, Result = 0026c000, Performance =   8.26 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.022316 s, Result = 00280000, Performance =   7.70 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020064 s, Result = 00294000, Performance =   8.83 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.020286 s, Result = 002a8000, Performance =   9.00 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021056 s, Result = 002bc000, Performance =   8.92 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021756 s, Result = 002d0000, Performance =   8.88 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022749 s, Result = 002e4000, Performance =   8.73 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023684 s, Result = 002f8000, Performance =   8.61 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024466 s, Result = 0030c000, Performance =   8.56 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025264 s, Result = 00320000, Performance =   8.50 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026116 s, Result = 00334000, Performance =   8.43 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027088 s, Result = 00348000, Performance =   8.32 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027776 s, Result = 0035c000, Performance =   8.31 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028676 s, Result = 00370000, Performance =   8.24 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029470 s, Result = 00384000, Performance =   8.20 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030033 s, Result = 00398000, Performance =   8.22 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030536 s, Result = 003ac000, Performance =   8.26 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.031140 s, Result = 003c0000, Performance =   8.28 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031364 s, Result = 003d4000, Performance =   8.39 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032116 s, Result = 003e8000, Performance =   8.36 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032575 s, Result = 003fc000, Performance =   8.41 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032930 s, Result = 00410000, Performance =   8.48 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033481 s, Result = 00424000, Performance =   8.50 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033865 s, Result = 00438000, Performance =   8.56 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034303 s, Result = 0044c000, Performance =   8.61 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034732 s, Result = 00460000, Performance =   8.66 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035129 s, Result = 00474000, Performance =   8.71 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.035374 s, Result = 00488000, Performance =   8.80 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.035767 s, Result = 0049c000, Performance =   8.86 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036286 s, Result = 004b0000, Performance =   8.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.036678 s, Result = 004c4000, Performance =   8.93 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036962 s, Result = 004d8000, Performance =   9.01 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.038192 s, Result = 004ec000, Performance =   8.86 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.037643 s, Result = 00500000, Performance =   9.13 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1899  1651   384
Test passed: M N K =  1257   126   192
Test passed: M N K =   994  1736   832
Test passed: M N K =    32  1447   128
Test passed: M N K =   607   738  1728
M N K =  1024  1024   256, Elapsed time =   0.005530 s, Result = 21024000, Performance =   0.97 TOPS
M N K =  1024  1024   512, Elapsed time =   0.006479 s, Result = 41038000, Performance =   1.66 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006644 s, Result = 6104c000, Performance =   2.42 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006328 s, Result = 81060000, Performance =   3.39 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006478 s, Result = a1074000, Performance =   4.14 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006687 s, Result = c1088000, Performance =   4.82 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007336 s, Result = e109c000, Performance =   5.12 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007809 s, Result = 010b0000, Performance =   5.50 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008240 s, Result = 210c4000, Performance =   5.86 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008816 s, Result = 410d8000, Performance =   6.09 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009444 s, Result = 610ec000, Performance =   6.25 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010115 s, Result = 81100000, Performance =   6.37 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010797 s, Result = a1114000, Performance =   6.46 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011438 s, Result = c1128000, Performance =   6.57 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012078 s, Result = e113c000, Performance =   6.67 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012736 s, Result = 01150000, Performance =   6.74 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013559 s, Result = 21164000, Performance =   6.73 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.014231 s, Result = 41178000, Performance =   6.79 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014925 s, Result = 6118c000, Performance =   6.83 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015555 s, Result = 811a0000, Performance =   6.90 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.016235 s, Result = a11b4000, Performance =   6.94 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016795 s, Result = c11c8000, Performance =   7.03 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017488 s, Result = e11dc000, Performance =   7.06 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.018002 s, Result = 011f0000, Performance =   7.16 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018704 s, Result = 21204000, Performance =   7.18 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019389 s, Result = 41218000, Performance =   7.20 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020055 s, Result = 6122c000, Performance =   7.23 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020653 s, Result = 81240000, Performance =   7.28 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021251 s, Result = a1254000, Performance =   7.33 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021949 s, Result = c1268000, Performance =   7.34 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022554 s, Result = e127c000, Performance =   7.38 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023348 s, Result = 01290000, Performance =   7.36 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.023971 s, Result = 212a4000, Performance =   7.39 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023521 s, Result = 412b8000, Performance =   7.76 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024254 s, Result = 612cc000, Performance =   7.75 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024968 s, Result = 812e0000, Performance =   7.74 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.026053 s, Result = a12f4000, Performance =   7.62 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.026902 s, Result = c1308000, Performance =   7.58 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027719 s, Result = e131c000, Performance =   7.55 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.028350 s, Result = 01330000, Performance =   7.57 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.029146 s, Result = 21344000, Performance =   7.55 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.029636 s, Result = 41358000, Performance =   7.61 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.030231 s, Result = 6136c000, Performance =   7.64 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.030602 s, Result = 81380000, Performance =   7.72 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031361 s, Result = a1394000, Performance =   7.70 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.032056 s, Result = c13a8000, Performance =   7.70 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.032630 s, Result = e13bc000, Performance =   7.73 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.033102 s, Result = 013d0000, Performance =   7.78 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.033514 s, Result = 213e4000, Performance =   7.85 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.033989 s, Result = 413f8000, Performance =   7.90 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.034504 s, Result = 6140c000, Performance =   7.94 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.035039 s, Result = 81420000, Performance =   7.97 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.035438 s, Result = a1434000, Performance =   8.03 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.035968 s, Result = c1448000, Performance =   8.06 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.036479 s, Result = e145c000, Performance =   8.09 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.036975 s, Result = 01470000, Performance =   8.13 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.037223 s, Result = 21484000, Performance =   8.22 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.038071 s, Result = 41498000, Performance =   8.18 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.038304 s, Result = 614ac000, Performance =   8.27 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.038633 s, Result = 814c0000, Performance =   8.34 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.039123 s, Result = a14d4000, Performance =   8.37 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.040435 s, Result = c14e8000, Performance =   8.23 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039893 s, Result = e14fc000, Performance =   8.48 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.041598 s, Result = 01510000, Performance =   8.26 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   954  1762  1472
Test passed: M N K =  1103    31  1792
Test passed: M N K =  1996  1262   448
Test passed: M N K =   700  1892   192
Test passed: M N K =  1667  1851   512
M N K =  1024  1024   256, Elapsed time =   0.002298 s, Result = 00014000, Performance =   2.34 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002525 s, Result = 00028000, Performance =   4.25 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002990 s, Result = 0003c000, Performance =   5.39 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003295 s, Result = 00050000, Performance =   6.52 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003647 s, Result = 00064000, Performance =   7.36 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004085 s, Result = 00078000, Performance =   7.89 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004525 s, Result = 0008c000, Performance =   8.30 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004973 s, Result = 000a0000, Performance =   8.64 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005468 s, Result = 000b4000, Performance =   8.84 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005981 s, Result = 000c8000, Performance =   8.98 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006517 s, Result = 000dc000, Performance =   9.06 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007141 s, Result = 000f0000, Performance =   9.02 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007702 s, Result = 00104000, Performance =   9.06 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008377 s, Result = 00118000, Performance =   8.97 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008956 s, Result = 0012c000, Performance =   8.99 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009645 s, Result = 00140000, Performance =   8.91 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010339 s, Result = 00154000, Performance =   8.83 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010998 s, Result = 00168000, Performance =   8.79 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011770 s, Result = 0017c000, Performance =   8.67 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012550 s, Result = 00190000, Performance =   8.56 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013404 s, Result = 001a4000, Performance =   8.41 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.014093 s, Result = 001b8000, Performance =   8.38 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014776 s, Result = 001cc000, Performance =   8.36 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015413 s, Result = 001e0000, Performance =   8.36 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.016016 s, Result = 001f4000, Performance =   8.38 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016611 s, Result = 00208000, Performance =   8.40 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.017265 s, Result = 0021c000, Performance =   8.40 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017949 s, Result = 00230000, Performance =   8.38 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018541 s, Result = 00244000, Performance =   8.40 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019206 s, Result = 00258000, Performance =   8.39 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019806 s, Result = 0026c000, Performance =   8.40 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020529 s, Result = 00280000, Performance =   8.37 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021137 s, Result = 00294000, Performance =   8.38 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.020672 s, Result = 002a8000, Performance =   8.83 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021226 s, Result = 002bc000, Performance =   8.85 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021845 s, Result = 002d0000, Performance =   8.85 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022736 s, Result = 002e4000, Performance =   8.74 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.023522 s, Result = 002f8000, Performance =   8.67 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.024236 s, Result = 0030c000, Performance =   8.64 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.026126 s, Result = 00320000, Performance =   8.22 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026381 s, Result = 00334000, Performance =   8.34 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.026907 s, Result = 00348000, Performance =   8.38 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027319 s, Result = 0035c000, Performance =   8.45 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028065 s, Result = 00370000, Performance =   8.42 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028843 s, Result = 00384000, Performance =   8.38 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029511 s, Result = 00398000, Performance =   8.37 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030043 s, Result = 003ac000, Performance =   8.40 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030524 s, Result = 003c0000, Performance =   8.44 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031153 s, Result = 003d4000, Performance =   8.44 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031615 s, Result = 003e8000, Performance =   8.49 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032154 s, Result = 003fc000, Performance =   8.52 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032711 s, Result = 00410000, Performance =   8.53 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033089 s, Result = 00424000, Performance =   8.60 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033562 s, Result = 00438000, Performance =   8.64 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034018 s, Result = 0044c000, Performance =   8.68 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034461 s, Result = 00460000, Performance =   8.72 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034811 s, Result = 00474000, Performance =   8.79 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.035519 s, Result = 00488000, Performance =   8.77 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.035851 s, Result = 0049c000, Performance =   8.84 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.035998 s, Result = 004b0000, Performance =   8.95 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.036812 s, Result = 004c4000, Performance =   8.90 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.037618 s, Result = 004d8000, Performance =   8.85 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.037457 s, Result = 004ec000, Performance =   9.03 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038797 s, Result = 00500000, Performance =   8.86 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   695  1523   256
Test passed: M N K =  1359   346  1088
Test passed: M N K =  1831  1982   576
Test passed: M N K =   186   684   384
Test passed: M N K =   667   371  1536
M N K =  1024  1024   256, Elapsed time =   0.004512 s, Result = 0a0b4000, Performance =   1.19 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005422 s, Result = 0a0c8000, Performance =   1.98 TOPS
M N K =  1024  1024   768, Elapsed time =   0.006285 s, Result = 0a0dc000, Performance =   2.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006861 s, Result = 0a0f0000, Performance =   3.13 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.007828 s, Result = 0a104000, Performance =   3.43 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.008335 s, Result = 0a118000, Performance =   3.86 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.009198 s, Result = 0a12c000, Performance =   4.09 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.009600 s, Result = 0a140000, Performance =   4.47 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.010494 s, Result = 0a154000, Performance =   4.60 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.011009 s, Result = 0a168000, Performance =   4.88 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.011039 s, Result = 0a17c000, Performance =   5.35 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010884 s, Result = 0a190000, Performance =   5.92 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010039 s, Result = 0a1a4000, Performance =   6.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009881 s, Result = 0a1b8000, Performance =   7.61 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.010738 s, Result = 0a1cc000, Performance =   7.50 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011409 s, Result = 0a1e0000, Performance =   7.53 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012350 s, Result = 0a1f4000, Performance =   7.39 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013236 s, Result = 0a208000, Performance =   7.30 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014208 s, Result = 0a21c000, Performance =   7.18 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014776 s, Result = 0a230000, Performance =   7.27 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015904 s, Result = 0a244000, Performance =   7.09 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.016399 s, Result = 0a258000, Performance =   7.20 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.017227 s, Result = 0a26c000, Performance =   7.17 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017733 s, Result = 0a280000, Performance =   7.27 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.018530 s, Result = 0a294000, Performance =   7.24 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.019275 s, Result = 0a2a8000, Performance =   7.24 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.020046 s, Result = 0a2bc000, Performance =   7.23 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.020573 s, Result = 0a2d0000, Performance =   7.31 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.021676 s, Result = 0a2e4000, Performance =   7.18 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.021981 s, Result = 0a2f8000, Performance =   7.33 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.022961 s, Result = 0a30c000, Performance =   7.25 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.023372 s, Result = 0a320000, Performance =   7.35 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.024034 s, Result = 0a334000, Performance =   7.37 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023037 s, Result = 0a348000, Performance =   7.92 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024171 s, Result = 0a35c000, Performance =   7.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024654 s, Result = 0a370000, Performance =   7.84 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.025761 s, Result = 0a384000, Performance =   7.71 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.026113 s, Result = 0a398000, Performance =   7.81 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.027027 s, Result = 0a3ac000, Performance =   7.75 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.027677 s, Result = 0a3c0000, Performance =   7.76 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.028788 s, Result = 0a3d4000, Performance =   7.65 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.028844 s, Result = 0a3e8000, Performance =   7.82 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.029663 s, Result = 0a3fc000, Performance =   7.78 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.030125 s, Result = 0a410000, Performance =   7.84 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.031008 s, Result = 0a424000, Performance =   7.79 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.031449 s, Result = 0a438000, Performance =   7.85 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.032245 s, Result = 0a44c000, Performance =   7.83 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.032713 s, Result = 0a460000, Performance =   7.88 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.032414 s, Result = 0a474000, Performance =   8.12 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032906 s, Result = 0a488000, Performance =   8.16 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.033240 s, Result = 0a49c000, Performance =   8.24 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.033602 s, Result = 0a4b0000, Performance =   8.31 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.034042 s, Result = 0a4c4000, Performance =   8.36 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.034455 s, Result = 0a4d8000, Performance =   8.41 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034958 s, Result = 0a4ec000, Performance =   8.45 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.035175 s, Result = 0a500000, Performance =   8.55 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.035699 s, Result = 0a514000, Performance =   8.57 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036356 s, Result = 0a528000, Performance =   8.56 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036593 s, Result = 0a53c000, Performance =   8.66 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036609 s, Result = 0a550000, Performance =   8.80 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.037894 s, Result = 0a564000, Performance =   8.64 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038392 s, Result = 0a578000, Performance =   8.67 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.037900 s, Result = 0a58c000, Performance =   8.92 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038570 s, Result = 0a5a0000, Performance =   8.91 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1802  1103  1408
Test passed: M N K =   162  2025  1984
Test passed: M N K =   167  1322   960
Test passed: M N K =  1694   353   128
Test passed: M N K =  1156  1594  1088
M N K =  1024  1024   256, Elapsed time =   0.000479 s, Result = 00014000, Performance =  11.21 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001128 s, Result = 00028000, Performance =   9.52 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001882 s, Result = 0003c000, Performance =   8.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002663 s, Result = 00050000, Performance =   8.07 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003294 s, Result = 00064000, Performance =   8.15 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003808 s, Result = 00078000, Performance =   8.46 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004576 s, Result = 0008c000, Performance =   8.21 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.005242 s, Result = 000a0000, Performance =   8.19 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005990 s, Result = 000b4000, Performance =   8.07 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006775 s, Result = 000c8000, Performance =   7.92 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.007332 s, Result = 000dc000, Performance =   8.05 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.008069 s, Result = 000f0000, Performance =   7.98 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008665 s, Result = 00104000, Performance =   8.06 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009132 s, Result = 00118000, Performance =   8.23 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009502 s, Result = 0012c000, Performance =   8.48 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.008800 s, Result = 00140000, Performance =   9.76 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.008901 s, Result = 00154000, Performance =  10.25 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.008296 s, Result = 00168000, Performance =  11.65 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.008860 s, Result = 0017c000, Performance =  11.51 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.009261 s, Result = 00190000, Performance =  11.59 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.010358 s, Result = 001a4000, Performance =  10.88 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.011283 s, Result = 001b8000, Performance =  10.47 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.012146 s, Result = 001cc000, Performance =  10.17 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.017754 s, Result = 001e0000, Performance =   7.26 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.014341 s, Result = 001f4000, Performance =   9.36 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.013824 s, Result = 00208000, Performance =  10.10 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.013926 s, Result = 0021c000, Performance =  10.41 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.015423 s, Result = 00230000, Performance =   9.75 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015104 s, Result = 00244000, Performance =  10.31 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.015207 s, Result = 00258000, Performance =  10.59 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.015709 s, Result = 0026c000, Performance =  10.59 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.016008 s, Result = 00280000, Performance =  10.73 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.016498 s, Result = 00294000, Performance =  10.74 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.016414 s, Result = 002a8000, Performance =  11.12 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.017246 s, Result = 002bc000, Performance =  10.90 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.018067 s, Result = 002d0000, Performance =  10.70 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.019317 s, Result = 002e4000, Performance =  10.28 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020027 s, Result = 002f8000, Performance =  10.19 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.020912 s, Result = 0030c000, Performance =  10.01 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021554 s, Result = 00320000, Performance =   9.96 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.022269 s, Result = 00334000, Performance =   9.88 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.022778 s, Result = 00348000, Performance =   9.90 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.023552 s, Result = 0035c000, Performance =   9.80 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.024097 s, Result = 00370000, Performance =   9.80 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.024823 s, Result = 00384000, Performance =   9.73 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025466 s, Result = 00398000, Performance =   9.70 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026098 s, Result = 003ac000, Performance =   9.67 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.034232 s, Result = 003c0000, Performance =   7.53 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031295 s, Result = 003d4000, Performance =   8.41 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.027778 s, Result = 003e8000, Performance =   9.66 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.028813 s, Result = 003fc000, Performance =   9.50 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.034713 s, Result = 00410000, Performance =   8.04 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.029430 s, Result = 00424000, Performance =   9.67 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.029861 s, Result = 00438000, Performance =   9.71 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.033069 s, Result = 0044c000, Performance =   8.93 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.032222 s, Result = 00460000, Performance =   9.33 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.032525 s, Result = 00474000, Performance =   9.41 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.033566 s, Result = 00488000, Performance =   9.28 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.033861 s, Result = 0049c000, Performance =   9.35 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.033647 s, Result = 004b0000, Performance =   9.57 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.034575 s, Result = 004c4000, Performance =   9.47 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.035558 s, Result = 004d8000, Performance =   9.36 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.035310 s, Result = 004ec000, Performance =   9.58 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.035575 s, Result = 00500000, Performance =   9.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   991   404   640
Test passed: M N K =  1211  1535   256
Test passed: M N K =   998   283   960
Test passed: M N K =   529   981    64
Test passed: M N K =  1038   665  1344
M N K =  1024  1024   256, Elapsed time =   0.005467 s, Result = 21024000, Performance =   0.98 TOPS
M N K =  1024  1024   512, Elapsed time =   0.005873 s, Result = 41038000, Performance =   1.83 TOPS
M N K =  1024  1024   768, Elapsed time =   0.005993 s, Result = 6104c000, Performance =   2.69 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.006115 s, Result = 81060000, Performance =   3.51 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.006489 s, Result = a1074000, Performance =   4.14 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006968 s, Result = c1088000, Performance =   4.62 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.007391 s, Result = e109c000, Performance =   5.08 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007711 s, Result = 010b0000, Performance =   5.57 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.008271 s, Result = 210c4000, Performance =   5.84 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008830 s, Result = 410d8000, Performance =   6.08 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.009512 s, Result = 610ec000, Performance =   6.21 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.010088 s, Result = 81100000, Performance =   6.39 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010743 s, Result = a1114000, Performance =   6.50 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.011450 s, Result = c1128000, Performance =   6.56 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.012058 s, Result = e113c000, Performance =   6.68 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.012508 s, Result = 01150000, Performance =   6.87 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.013229 s, Result = 21164000, Performance =   6.90 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013979 s, Result = 41178000, Performance =   6.91 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.014713 s, Result = 6118c000, Performance =   6.93 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.015290 s, Result = 811a0000, Performance =   7.02 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015857 s, Result = a11b4000, Performance =   7.11 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.017097 s, Result = c11c8000, Performance =   6.91 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016470 s, Result = e11dc000, Performance =   7.50 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016868 s, Result = 011f0000, Performance =   7.64 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017480 s, Result = 21204000, Performance =   7.68 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017995 s, Result = 41218000, Performance =   7.76 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018644 s, Result = 6122c000, Performance =   7.77 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.019259 s, Result = 81240000, Performance =   7.81 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019993 s, Result = a1254000, Performance =   7.79 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.020759 s, Result = c1268000, Performance =   7.76 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.021423 s, Result = e127c000, Performance =   7.77 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.022524 s, Result = 01290000, Performance =   7.63 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.022950 s, Result = 212a4000, Performance =   7.72 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.023661 s, Result = 412b8000, Performance =   7.71 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.024132 s, Result = 612cc000, Performance =   7.79 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.024256 s, Result = 812e0000, Performance =   7.97 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.024929 s, Result = a12f4000, Performance =   7.97 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.025550 s, Result = c1308000, Performance =   7.98 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.026159 s, Result = e131c000, Performance =   8.00 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.026512 s, Result = 01330000, Performance =   8.10 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.027414 s, Result = 21344000, Performance =   8.03 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027939 s, Result = 41358000, Performance =   8.07 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.028503 s, Result = 6136c000, Performance =   8.10 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028916 s, Result = 81380000, Performance =   8.17 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.029686 s, Result = a1394000, Performance =   8.14 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.030213 s, Result = c13a8000, Performance =   8.17 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.030785 s, Result = e13bc000, Performance =   8.20 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030946 s, Result = 013d0000, Performance =   8.33 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.031835 s, Result = 213e4000, Performance =   8.26 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.032231 s, Result = 413f8000, Performance =   8.33 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.032816 s, Result = 6140c000, Performance =   8.34 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.033252 s, Result = 81420000, Performance =   8.40 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.033631 s, Result = a1434000, Performance =   8.46 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.034368 s, Result = c1448000, Performance =   8.44 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.035212 s, Result = e145c000, Performance =   8.39 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.034647 s, Result = 01470000, Performance =   8.68 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.036141 s, Result = 21484000, Performance =   8.47 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.036684 s, Result = 41498000, Performance =   8.49 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.036441 s, Result = 614ac000, Performance =   8.69 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.037457 s, Result = 814c0000, Performance =   8.60 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.036215 s, Result = a14d4000, Performance =   9.04 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.038012 s, Result = c14e8000, Performance =   8.76 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.039084 s, Result = e14fc000, Performance =   8.65 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.041141 s, Result = 01510000, Performance =   8.35 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1102  1463  1920
Test passed: M N K =  1506  1294  1600
Test passed: M N K =  1899  1934  1088
Test passed: M N K =    91  1229   640
Test passed: M N K =   502  1425  1408
M N K =  1024  1024   256, Elapsed time =   0.002173 s, Result = 00014000, Performance =   2.47 TOPS
M N K =  1024  1024   512, Elapsed time =   0.002410 s, Result = 00028000, Performance =   4.46 TOPS
M N K =  1024  1024   768, Elapsed time =   0.002925 s, Result = 0003c000, Performance =   5.51 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.003288 s, Result = 00050000, Performance =   6.53 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.003691 s, Result = 00064000, Performance =   7.27 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.004149 s, Result = 00078000, Performance =   7.76 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004578 s, Result = 0008c000, Performance =   8.21 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004956 s, Result = 000a0000, Performance =   8.67 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005485 s, Result = 000b4000, Performance =   8.81 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.005969 s, Result = 000c8000, Performance =   8.99 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006454 s, Result = 000dc000, Performance =   9.15 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007112 s, Result = 000f0000, Performance =   9.06 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.007685 s, Result = 00104000, Performance =   9.08 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.008313 s, Result = 00118000, Performance =   9.04 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.008996 s, Result = 0012c000, Performance =   8.95 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.009482 s, Result = 00140000, Performance =   9.06 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.010261 s, Result = 00154000, Performance =   8.90 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.010958 s, Result = 00168000, Performance =   8.82 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.011761 s, Result = 0017c000, Performance =   8.67 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.012391 s, Result = 00190000, Performance =   8.67 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.013071 s, Result = 001a4000, Performance =   8.63 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.013917 s, Result = 001b8000, Performance =   8.49 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.014482 s, Result = 001cc000, Performance =   8.53 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.014936 s, Result = 001e0000, Performance =   8.63 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015524 s, Result = 001f4000, Performance =   8.65 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.016301 s, Result = 00208000, Performance =   8.56 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.016993 s, Result = 0021c000, Performance =   8.53 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.017508 s, Result = 00230000, Performance =   8.59 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.018084 s, Result = 00244000, Performance =   8.61 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.018749 s, Result = 00258000, Performance =   8.59 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.019407 s, Result = 0026c000, Performance =   8.58 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.020158 s, Result = 00280000, Performance =   8.52 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.020565 s, Result = 00294000, Performance =   8.61 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.021083 s, Result = 002a8000, Performance =   8.66 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.021437 s, Result = 002bc000, Performance =   8.77 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.021699 s, Result = 002d0000, Performance =   8.91 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.022340 s, Result = 002e4000, Performance =   8.89 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.022820 s, Result = 002f8000, Performance =   8.94 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.023514 s, Result = 0030c000, Performance =   8.90 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.023802 s, Result = 00320000, Performance =   9.02 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.024703 s, Result = 00334000, Performance =   8.91 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.025307 s, Result = 00348000, Performance =   8.91 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.025866 s, Result = 0035c000, Performance =   8.93 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.026505 s, Result = 00370000, Performance =   8.91 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.027046 s, Result = 00384000, Performance =   8.93 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.027901 s, Result = 00398000, Performance =   8.85 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.028682 s, Result = 003ac000, Performance =   8.80 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.029089 s, Result = 003c0000, Performance =   8.86 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.029404 s, Result = 003d4000, Performance =   8.95 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.029699 s, Result = 003e8000, Performance =   9.04 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.030346 s, Result = 003fc000, Performance =   9.02 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.030712 s, Result = 00410000, Performance =   9.09 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.031043 s, Result = 00424000, Performance =   9.17 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.031820 s, Result = 00438000, Performance =   9.11 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.032444 s, Result = 0044c000, Performance =   9.10 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.032026 s, Result = 00460000, Performance =   9.39 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.033290 s, Result = 00474000, Performance =   9.19 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.033918 s, Result = 00488000, Performance =   9.18 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.033690 s, Result = 0049c000, Performance =   9.40 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.034924 s, Result = 004b0000, Performance =   9.22 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.033337 s, Result = 004c4000, Performance =   9.82 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.035650 s, Result = 004d8000, Performance =   9.34 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.036445 s, Result = 004ec000, Performance =   9.28 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.038391 s, Result = 00500000, Performance =   8.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   531  1192   448
Test passed: M N K =   294   493  1984
Test passed: M N K =   229  1336  1984
Test passed: M N K =  1773   158  1472
Test passed: M N K =   930  1932   192
M N K =  1024  1024   256, Elapsed time =   0.003792 s, Result = 0a0b4000, Performance =   1.42 TOPS
M N K =  1024  1024   512, Elapsed time =   0.004235 s, Result = 0a0c8000, Performance =   2.54 TOPS
M N K =  1024  1024   768, Elapsed time =   0.004866 s, Result = 0a0dc000, Performance =   3.31 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.005297 s, Result = 0a0f0000, Performance =   4.05 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.005821 s, Result = 0a104000, Performance =   4.61 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.006318 s, Result = 0a118000, Performance =   5.10 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.006694 s, Result = 0a12c000, Performance =   5.61 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.007205 s, Result = 0a140000, Performance =   5.96 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.007737 s, Result = 0a154000, Performance =   6.25 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.008224 s, Result = 0a168000, Performance =   6.53 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.008867 s, Result = 0a17c000, Performance =   6.66 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.009343 s, Result = 0a190000, Performance =   6.90 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.010044 s, Result = 0a1a4000, Performance =   6.95 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.010654 s, Result = 0a1b8000, Performance =   7.05 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.011341 s, Result = 0a1cc000, Performance =   7.10 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.011768 s, Result = 0a1e0000, Performance =   7.30 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.012439 s, Result = 0a1f4000, Performance =   7.34 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.013091 s, Result = 0a208000, Performance =   7.38 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.013684 s, Result = 0a21c000, Performance =   7.45 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.014455 s, Result = 0a230000, Performance =   7.43 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.015602 s, Result = 0a244000, Performance =   7.23 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015836 s, Result = 0a258000, Performance =   7.46 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.016142 s, Result = 0a26c000, Performance =   7.65 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.016647 s, Result = 0a280000, Performance =   7.74 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.017151 s, Result = 0a294000, Performance =   7.83 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.017667 s, Result = 0a2a8000, Performance =   7.90 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.018176 s, Result = 0a2bc000, Performance =   7.98 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.018538 s, Result = 0a2d0000, Performance =   8.11 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.019049 s, Result = 0a2e4000, Performance =   8.17 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.019664 s, Result = 0a2f8000, Performance =   8.19 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.020942 s, Result = 0a30c000, Performance =   7.95 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.021349 s, Result = 0a320000, Performance =   8.05 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.021829 s, Result = 0a334000, Performance =   8.12 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.022446 s, Result = 0a348000, Performance =   8.13 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.022857 s, Result = 0a35c000, Performance =   8.22 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.023202 s, Result = 0a370000, Performance =   8.33 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.023880 s, Result = 0a384000, Performance =   8.32 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.024514 s, Result = 0a398000, Performance =   8.32 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.025439 s, Result = 0a3ac000, Performance =   8.23 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.025711 s, Result = 0a3c0000, Performance =   8.35 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.026786 s, Result = 0a3d4000, Performance =   8.22 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.027126 s, Result = 0a3e8000, Performance =   8.31 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.027706 s, Result = 0a3fc000, Performance =   8.33 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.028134 s, Result = 0a410000, Performance =   8.40 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.028694 s, Result = 0a424000, Performance =   8.42 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.029393 s, Result = 0a438000, Performance =   8.40 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.029864 s, Result = 0a44c000, Performance =   8.45 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.030163 s, Result = 0a460000, Performance =   8.54 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.030953 s, Result = 0a474000, Performance =   8.50 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.031451 s, Result = 0a488000, Performance =   8.53 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.031770 s, Result = 0a49c000, Performance =   8.62 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.032214 s, Result = 0a4b0000, Performance =   8.67 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.032771 s, Result = 0a4c4000, Performance =   8.68 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.033387 s, Result = 0a4d8000, Performance =   8.68 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.034076 s, Result = 0a4ec000, Performance =   8.67 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.033636 s, Result = 0a500000, Performance =   8.94 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.034686 s, Result = 0a514000, Performance =   8.82 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.035834 s, Result = 0a528000, Performance =   8.69 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.034807 s, Result = 0a53c000, Performance =   9.10 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.036284 s, Result = 0a550000, Performance =   8.88 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.034822 s, Result = 0a564000, Performance =   9.40 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.036784 s, Result = 0a578000, Performance =   9.05 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.037454 s, Result = 0a58c000, Performance =   9.03 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.039209 s, Result = 0a5a0000, Performance =   8.76 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=1024 -DTEST_N=1024 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=1 -DMULTI_CORE=0 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 1 CPU Core (Core 0), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    33  1567  1856
Test passed: M N K =   776    37  1536
Test passed: M N K =   682   920  1280
Test passed: M N K =   599   405   768
Test passed: M N K =   153   844  1920
M N K =  1024  1024   256, Elapsed time =   0.000478 s, Result = 00014000, Performance =  11.22 TOPS
M N K =  1024  1024   512, Elapsed time =   0.001077 s, Result = 00028000, Performance =   9.97 TOPS
M N K =  1024  1024   768, Elapsed time =   0.001685 s, Result = 0003c000, Performance =   9.56 TOPS
M N K =  1024  1024  1024, Elapsed time =   0.002207 s, Result = 00050000, Performance =   9.73 TOPS
M N K =  1024  1024  1280, Elapsed time =   0.002978 s, Result = 00064000, Performance =   9.01 TOPS
M N K =  1024  1024  1536, Elapsed time =   0.003540 s, Result = 00078000, Performance =   9.10 TOPS
M N K =  1024  1024  1792, Elapsed time =   0.004384 s, Result = 0008c000, Performance =   8.57 TOPS
M N K =  1024  1024  2048, Elapsed time =   0.004860 s, Result = 000a0000, Performance =   8.84 TOPS
M N K =  1024  1024  2304, Elapsed time =   0.005737 s, Result = 000b4000, Performance =   8.42 TOPS
M N K =  1024  1024  2560, Elapsed time =   0.006368 s, Result = 000c8000, Performance =   8.43 TOPS
M N K =  1024  1024  2816, Elapsed time =   0.006935 s, Result = 000dc000, Performance =   8.52 TOPS
M N K =  1024  1024  3072, Elapsed time =   0.007526 s, Result = 000f0000, Performance =   8.56 TOPS
M N K =  1024  1024  3328, Elapsed time =   0.008368 s, Result = 00104000, Performance =   8.34 TOPS
M N K =  1024  1024  3584, Elapsed time =   0.009240 s, Result = 00118000, Performance =   8.13 TOPS
M N K =  1024  1024  3840, Elapsed time =   0.009762 s, Result = 0012c000, Performance =   8.25 TOPS
M N K =  1024  1024  4096, Elapsed time =   0.010257 s, Result = 00140000, Performance =   8.38 TOPS
M N K =  1024  1024  4352, Elapsed time =   0.011111 s, Result = 00154000, Performance =   8.21 TOPS
M N K =  1024  1024  4608, Elapsed time =   0.012183 s, Result = 00168000, Performance =   7.93 TOPS
M N K =  1024  1024  4864, Elapsed time =   0.012575 s, Result = 0017c000, Performance =   8.11 TOPS
M N K =  1024  1024  5120, Elapsed time =   0.013347 s, Result = 00190000, Performance =   8.04 TOPS
M N K =  1024  1024  5376, Elapsed time =   0.014239 s, Result = 001a4000, Performance =   7.92 TOPS
M N K =  1024  1024  5632, Elapsed time =   0.015262 s, Result = 001b8000, Performance =   7.74 TOPS
M N K =  1024  1024  5888, Elapsed time =   0.015550 s, Result = 001cc000, Performance =   7.94 TOPS
M N K =  1024  1024  6144, Elapsed time =   0.015717 s, Result = 001e0000, Performance =   8.20 TOPS
M N K =  1024  1024  6400, Elapsed time =   0.015410 s, Result = 001f4000, Performance =   8.71 TOPS
M N K =  1024  1024  6656, Elapsed time =   0.015407 s, Result = 00208000, Performance =   9.06 TOPS
M N K =  1024  1024  6912, Elapsed time =   0.015155 s, Result = 0021c000, Performance =   9.57 TOPS
M N K =  1024  1024  7168, Elapsed time =   0.015196 s, Result = 00230000, Performance =   9.89 TOPS
M N K =  1024  1024  7424, Elapsed time =   0.015528 s, Result = 00244000, Performance =  10.03 TOPS
M N K =  1024  1024  7680, Elapsed time =   0.016143 s, Result = 00258000, Performance =   9.98 TOPS
M N K =  1024  1024  7936, Elapsed time =   0.017600 s, Result = 0026c000, Performance =   9.46 TOPS
M N K =  1024  1024  8192, Elapsed time =   0.018196 s, Result = 00280000, Performance =   9.44 TOPS
M N K =  1024  1024  8448, Elapsed time =   0.019010 s, Result = 00294000, Performance =   9.32 TOPS
M N K =  1024  1024  8704, Elapsed time =   0.019287 s, Result = 002a8000, Performance =   9.46 TOPS
M N K =  1024  1024  8960, Elapsed time =   0.019779 s, Result = 002bc000, Performance =   9.50 TOPS
M N K =  1024  1024  9216, Elapsed time =   0.020093 s, Result = 002d0000, Performance =   9.62 TOPS
M N K =  1024  1024  9472, Elapsed time =   0.020619 s, Result = 002e4000, Performance =   9.63 TOPS
M N K =  1024  1024  9728, Elapsed time =   0.020946 s, Result = 002f8000, Performance =   9.74 TOPS
M N K =  1024  1024  9984, Elapsed time =   0.020982 s, Result = 0030c000, Performance =   9.98 TOPS
M N K =  1024  1024 10240, Elapsed time =   0.021481 s, Result = 00320000, Performance =  10.00 TOPS
M N K =  1024  1024 10496, Elapsed time =   0.022215 s, Result = 00334000, Performance =   9.91 TOPS
M N K =  1024  1024 10752, Elapsed time =   0.023048 s, Result = 00348000, Performance =   9.78 TOPS
M N K =  1024  1024 11008, Elapsed time =   0.023732 s, Result = 0035c000, Performance =   9.73 TOPS
M N K =  1024  1024 11264, Elapsed time =   0.024273 s, Result = 00370000, Performance =   9.73 TOPS
M N K =  1024  1024 11520, Elapsed time =   0.024946 s, Result = 00384000, Performance =   9.68 TOPS
M N K =  1024  1024 11776, Elapsed time =   0.025681 s, Result = 00398000, Performance =   9.62 TOPS
M N K =  1024  1024 12032, Elapsed time =   0.026181 s, Result = 003ac000, Performance =   9.64 TOPS
M N K =  1024  1024 12288, Elapsed time =   0.026582 s, Result = 003c0000, Performance =   9.69 TOPS
M N K =  1024  1024 12544, Elapsed time =   0.027254 s, Result = 003d4000, Performance =   9.65 TOPS
M N K =  1024  1024 12800, Elapsed time =   0.027814 s, Result = 003e8000, Performance =   9.65 TOPS
M N K =  1024  1024 13056, Elapsed time =   0.028287 s, Result = 003fc000, Performance =   9.68 TOPS
M N K =  1024  1024 13312, Elapsed time =   0.028750 s, Result = 00410000, Performance =   9.71 TOPS
M N K =  1024  1024 13568, Elapsed time =   0.029094 s, Result = 00424000, Performance =   9.78 TOPS
M N K =  1024  1024 13824, Elapsed time =   0.029623 s, Result = 00438000, Performance =   9.79 TOPS
M N K =  1024  1024 14080, Elapsed time =   0.030405 s, Result = 0044c000, Performance =   9.71 TOPS
M N K =  1024  1024 14336, Elapsed time =   0.029897 s, Result = 00460000, Performance =  10.06 TOPS
M N K =  1024  1024 14592, Elapsed time =   0.031149 s, Result = 00474000, Performance =   9.82 TOPS
M N K =  1024  1024 14848, Elapsed time =   0.031995 s, Result = 00488000, Performance =   9.73 TOPS
M N K =  1024  1024 15104, Elapsed time =   0.031512 s, Result = 0049c000, Performance =  10.05 TOPS
M N K =  1024  1024 15360, Elapsed time =   0.032761 s, Result = 004b0000, Performance =   9.83 TOPS
M N K =  1024  1024 15616, Elapsed time =   0.031195 s, Result = 004c4000, Performance =  10.50 TOPS
M N K =  1024  1024 15872, Elapsed time =   0.033436 s, Result = 004d8000, Performance =   9.96 TOPS
M N K =  1024  1024 16128, Elapsed time =   0.034268 s, Result = 004ec000, Performance =   9.87 TOPS
M N K =  1024  1024 16384, Elapsed time =   0.035560 s, Result = 00500000, Performance =   9.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1279   524  1088
Test passed: M N K =  1986  1897  1984
Test passed: M N K =   422  1185   576
Test passed: M N K =  1469  1332  1344
Test passed: M N K =    44  1762  1984
M N K =  2048  2048   256, Elapsed time =   0.006460 s, Result = 64180000, Performance =   3.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009527 s, Result = 842c0000, Performance =   4.51 TOPS
M N K =  2048  2048   768, Elapsed time =   0.018319 s, Result = a4400000, Performance =   3.52 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.019521 s, Result = c4540000, Performance =   4.40 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.018674 s, Result = e4680000, Performance =   5.75 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.017592 s, Result = 047c0000, Performance =   7.32 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.019474 s, Result = 24900000, Performance =   7.72 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.021218 s, Result = 44a40000, Performance =   8.10 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.023268 s, Result = 64b80000, Performance =   8.31 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.025569 s, Result = 84cc0000, Performance =   8.40 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.027694 s, Result = a4e00000, Performance =   8.53 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.029881 s, Result = c4f40000, Performance =   8.62 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.032550 s, Result = e5080000, Performance =   8.58 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.034947 s, Result = 051c0000, Performance =   8.60 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.037160 s, Result = 25300000, Performance =   8.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.039302 s, Result = 45440000, Performance =   8.74 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.042276 s, Result = 65580000, Performance =   8.64 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.044998 s, Result = 856c0000, Performance =   8.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.047169 s, Result = a5800000, Performance =   8.65 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.050120 s, Result = c5940000, Performance =   8.57 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.052403 s, Result = e5a80000, Performance =   8.61 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.055368 s, Result = 05bc0000, Performance =   8.53 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.058211 s, Result = 25d00000, Performance =   8.49 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.060762 s, Result = 45e40000, Performance =   8.48 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.063937 s, Result = 65f80000, Performance =   8.40 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.066671 s, Result = 860c0000, Performance =   8.37 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.070943 s, Result = a6200000, Performance =   8.17 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.073241 s, Result = c6340000, Performance =   8.21 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.076639 s, Result = e6480000, Performance =   8.13 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.080123 s, Result = 065c0000, Performance =   8.04 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.084240 s, Result = 26700000, Performance =   7.90 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.084321 s, Result = 46840000, Performance =   8.15 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.086129 s, Result = 66980000, Performance =   8.23 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.089535 s, Result = 86ac0000, Performance =   8.15 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.092141 s, Result = a6c00000, Performance =   8.16 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.095342 s, Result = c6d40000, Performance =   8.11 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.098137 s, Result = e6e80000, Performance =   8.10 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.101219 s, Result = 06fc0000, Performance =   8.06 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.104425 s, Result = 27100000, Performance =   8.02 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.107374 s, Result = 47240000, Performance =   8.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.109705 s, Result = 67380000, Performance =   8.03 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.112864 s, Result = 874c0000, Performance =   7.99 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.113694 s, Result = a7600000, Performance =   8.12 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.118248 s, Result = c7740000, Performance =   7.99 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.125719 s, Result = e7880000, Performance =   7.69 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.129179 s, Result = 079c0000, Performance =   7.65 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.131003 s, Result = 27b00000, Performance =   7.70 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.134798 s, Result = 47c40000, Performance =   7.65 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.137361 s, Result = 67d80000, Performance =   7.66 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.139970 s, Result = 87ec0000, Performance =   7.67 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.139263 s, Result = a8000000, Performance =   7.86 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.143358 s, Result = c8140000, Performance =   7.79 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.148445 s, Result = e8280000, Performance =   7.67 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.151532 s, Result = 083c0000, Performance =   7.65 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.153079 s, Result = 28500000, Performance =   7.72 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.154984 s, Result = 48640000, Performance =   7.76 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.156792 s, Result = 68780000, Performance =   7.81 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.158078 s, Result = 888c0000, Performance =   7.88 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.159569 s, Result = a8a00000, Performance =   7.94 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.161627 s, Result = c8b40000, Performance =   7.97 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.164469 s, Result = e8c80000, Performance =   7.96 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.165322 s, Result = 08dc0000, Performance =   8.05 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.165499 s, Result = 28f00000, Performance =   8.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.194192 s, Result = 49040000, Performance =   7.08 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   555  1818  2048
Test passed: M N K =  1532  1417   384
Test passed: M N K =  1398  1448  2048
Test passed: M N K =   586  1703    64
Test passed: M N K =  1522   183   704
M N K =  2048  2048   256, Elapsed time =   0.009249 s, Result = 00140000, Performance =   2.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007196 s, Result = 00280000, Performance =   5.97 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008263 s, Result = 003c0000, Performance =   7.80 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010425 s, Result = 00500000, Performance =   8.24 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012188 s, Result = 00640000, Performance =   8.81 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013536 s, Result = 00780000, Performance =   9.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015150 s, Result = 008c0000, Performance =   9.92 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.017174 s, Result = 00a00000, Performance =  10.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.019223 s, Result = 00b40000, Performance =  10.05 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.021067 s, Result = 00c80000, Performance =  10.19 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.023659 s, Result = 00dc0000, Performance =   9.98 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.025377 s, Result = 00f00000, Performance =  10.15 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.027621 s, Result = 01040000, Performance =  10.11 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.029849 s, Result = 01180000, Performance =  10.07 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.032031 s, Result = 012c0000, Performance =  10.06 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.033774 s, Result = 01400000, Performance =  10.17 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.036964 s, Result = 01540000, Performance =   9.88 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.038920 s, Result = 01680000, Performance =   9.93 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.041581 s, Result = 017c0000, Performance =   9.81 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.043713 s, Result = 01900000, Performance =   9.83 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.046539 s, Result = 01a40000, Performance =   9.69 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.048420 s, Result = 01b80000, Performance =   9.76 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.051945 s, Result = 01cc0000, Performance =   9.51 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.054649 s, Result = 01e00000, Performance =   9.43 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.057688 s, Result = 01f40000, Performance =   9.31 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.060615 s, Result = 02080000, Performance =   9.21 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.063775 s, Result = 021c0000, Performance =   9.09 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.066935 s, Result = 02300000, Performance =   8.98 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.070139 s, Result = 02440000, Performance =   8.88 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.073801 s, Result = 02580000, Performance =   8.73 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.077959 s, Result = 026c0000, Performance =   8.54 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.078322 s, Result = 02800000, Performance =   8.77 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.080915 s, Result = 02940000, Performance =   8.76 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.082691 s, Result = 02a80000, Performance =   8.83 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.085421 s, Result = 02bc0000, Performance =   8.80 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.087614 s, Result = 02d00000, Performance =   8.82 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.091615 s, Result = 02e40000, Performance =   8.67 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.094910 s, Result = 02f80000, Performance =   8.60 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.097881 s, Result = 030c0000, Performance =   8.56 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.101568 s, Result = 03200000, Performance =   8.46 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.109432 s, Result = 03340000, Performance =   8.05 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.113894 s, Result = 03480000, Performance =   7.92 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.114825 s, Result = 035c0000, Performance =   8.04 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.119079 s, Result = 03700000, Performance =   7.94 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.122156 s, Result = 03840000, Performance =   7.91 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.124826 s, Result = 03980000, Performance =   7.91 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.128450 s, Result = 03ac0000, Performance =   7.86 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.131212 s, Result = 03c00000, Performance =   7.86 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.133085 s, Result = 03d40000, Performance =   7.91 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.135343 s, Result = 03e80000, Performance =   7.93 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.139211 s, Result = 03fc0000, Performance =   7.87 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.141422 s, Result = 04100000, Performance =   7.90 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.144279 s, Result = 04240000, Performance =   7.89 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.146813 s, Result = 04380000, Performance =   7.90 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.146277 s, Result = 044c0000, Performance =   8.07 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.149475 s, Result = 04600000, Performance =   8.05 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.150942 s, Result = 04740000, Performance =   8.11 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.151735 s, Result = 04880000, Performance =   8.21 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.154037 s, Result = 049c0000, Performance =   8.23 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.156482 s, Result = 04b00000, Performance =   8.23 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.160375 s, Result = 04c40000, Performance =   8.17 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.162144 s, Result = 04d80000, Performance =   8.21 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.159194 s, Result = 04ec0000, Performance =   8.50 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.182792 s, Result = 05000000, Performance =   7.52 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1231    68  1984
Test passed: M N K =  1419   230   640
Test passed: M N K =   690  1602   960
Test passed: M N K =  2025   866   256
Test passed: M N K =  1352   733  1600
M N K =  2048  2048   256, Elapsed time =   0.007849 s, Result = 283c0000, Performance =   2.74 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008571 s, Result = 28500000, Performance =   5.01 TOPS
M N K =  2048  2048   768, Elapsed time =   0.011436 s, Result = 28640000, Performance =   5.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.012755 s, Result = 28780000, Performance =   6.73 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.014519 s, Result = 288c0000, Performance =   7.40 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.015993 s, Result = 28a00000, Performance =   8.06 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.017916 s, Result = 28b40000, Performance =   8.39 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.019505 s, Result = 28c80000, Performance =   8.81 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.021190 s, Result = 28dc0000, Performance =   9.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.023566 s, Result = 28f00000, Performance =   9.11 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.025194 s, Result = 29040000, Performance =   9.38 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.027021 s, Result = 29180000, Performance =   9.54 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.029135 s, Result = 292c0000, Performance =   9.58 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.031104 s, Result = 29400000, Performance =   9.67 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.033281 s, Result = 29540000, Performance =   9.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.034714 s, Result = 29680000, Performance =   9.90 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.037794 s, Result = 297c0000, Performance =   9.66 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.039521 s, Result = 29900000, Performance =   9.78 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.041877 s, Result = 29a40000, Performance =   9.74 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.043913 s, Result = 29b80000, Performance =   9.78 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.046840 s, Result = 29cc0000, Performance =   9.63 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.048951 s, Result = 29e00000, Performance =   9.65 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.052005 s, Result = 29f40000, Performance =   9.50 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.054137 s, Result = 2a080000, Performance =   9.52 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.057055 s, Result = 2a1c0000, Performance =   9.41 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.060107 s, Result = 2a300000, Performance =   9.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.063458 s, Result = 2a440000, Performance =   9.14 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.066619 s, Result = 2a580000, Performance =   9.03 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.069977 s, Result = 2a6c0000, Performance =   8.90 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.073222 s, Result = 2a800000, Performance =   8.80 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.075750 s, Result = 2a940000, Performance =   8.79 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.077659 s, Result = 2aa80000, Performance =   8.85 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.078625 s, Result = 2abc0000, Performance =   9.01 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.082187 s, Result = 2ad00000, Performance =   8.88 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.084490 s, Result = 2ae40000, Performance =   8.90 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.087644 s, Result = 2af80000, Performance =   8.82 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.090332 s, Result = 2b0c0000, Performance =   8.80 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.093776 s, Result = 2b200000, Performance =   8.70 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.096962 s, Result = 2b340000, Performance =   8.64 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.099658 s, Result = 2b480000, Performance =   8.62 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.102323 s, Result = 2b5c0000, Performance =   8.60 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.104131 s, Result = 2b700000, Performance =   8.66 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.106008 s, Result = 2b840000, Performance =   8.71 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.110593 s, Result = 2b980000, Performance =   8.54 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.114107 s, Result = 2bac0000, Performance =   8.47 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.116654 s, Result = 2bc00000, Performance =   8.47 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.119255 s, Result = 2bd40000, Performance =   8.46 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.122880 s, Result = 2be80000, Performance =   8.39 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.124688 s, Result = 2bfc0000, Performance =   8.44 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.127608 s, Result = 2c100000, Performance =   8.41 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.130987 s, Result = 2c240000, Performance =   8.36 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.133287 s, Result = 2c380000, Performance =   8.38 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.136379 s, Result = 2c4c0000, Performance =   8.35 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.138678 s, Result = 2c600000, Performance =   8.36 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.141356 s, Result = 2c740000, Performance =   8.36 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.144837 s, Result = 2c880000, Performance =   8.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.147579 s, Result = 2c9c0000, Performance =   8.29 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.148369 s, Result = 2cb00000, Performance =   8.39 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.150712 s, Result = 2cc40000, Performance =   8.41 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.152479 s, Result = 2cd80000, Performance =   8.45 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.155251 s, Result = 2cec0000, Performance =   8.44 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.157793 s, Result = 2d000000, Performance =   8.44 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.156689 s, Result = 2d140000, Performance =   8.63 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.181458 s, Result = 2d280000, Performance =   7.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   244  1064   640
Test passed: M N K =   706  1548   768
Test passed: M N K =  1727   444   448
Test passed: M N K =  1032  2045  1344
Test passed: M N K =  1559  1668   384
M N K =  2048  2048   256, Elapsed time =   0.001575 s, Result = 00140000, Performance =  13.63 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003600 s, Result = 00280000, Performance =  11.93 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005672 s, Result = 003c0000, Performance =  11.36 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006462 s, Result = 00500000, Performance =  13.29 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007592 s, Result = 00640000, Performance =  14.14 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009112 s, Result = 00780000, Performance =  14.14 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010669 s, Result = 008c0000, Performance =  14.09 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012059 s, Result = 00a00000, Performance =  14.25 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013690 s, Result = 00b40000, Performance =  14.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015495 s, Result = 00c80000, Performance =  13.86 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017195 s, Result = 00dc0000, Performance =  13.74 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018765 s, Result = 00f00000, Performance =  13.73 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020353 s, Result = 01040000, Performance =  13.72 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022263 s, Result = 01180000, Performance =  13.50 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023939 s, Result = 012c0000, Performance =  13.46 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025580 s, Result = 01400000, Performance =  13.43 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027920 s, Result = 01540000, Performance =  13.08 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029858 s, Result = 01680000, Performance =  12.95 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031723 s, Result = 017c0000, Performance =  12.86 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034144 s, Result = 01900000, Performance =  12.58 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.036485 s, Result = 01a40000, Performance =  12.36 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.039050 s, Result = 01b80000, Performance =  12.10 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.041065 s, Result = 01cc0000, Performance =  12.03 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.044147 s, Result = 01e00000, Performance =  11.67 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.046312 s, Result = 01f40000, Performance =  11.59 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.048363 s, Result = 02080000, Performance =  11.54 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.052797 s, Result = 021c0000, Performance =  10.98 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.056377 s, Result = 02300000, Performance =  10.67 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.059517 s, Result = 02440000, Performance =  10.46 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.063116 s, Result = 02580000, Performance =  10.21 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.065979 s, Result = 026c0000, Performance =  10.09 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.067733 s, Result = 02800000, Performance =  10.15 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.068655 s, Result = 02940000, Performance =  10.32 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.073029 s, Result = 02a80000, Performance =  10.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.075742 s, Result = 02bc0000, Performance =   9.92 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.078905 s, Result = 02d00000, Performance =   9.80 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.080353 s, Result = 02e40000, Performance =   9.89 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.083806 s, Result = 02f80000, Performance =   9.74 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.087462 s, Result = 030c0000, Performance =   9.58 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.091067 s, Result = 03200000, Performance =   9.43 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.093280 s, Result = 03340000, Performance =   9.44 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.095092 s, Result = 03480000, Performance =   9.48 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.097004 s, Result = 035c0000, Performance =   9.52 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.102896 s, Result = 03700000, Performance =   9.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.106620 s, Result = 03840000, Performance =   9.06 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.108912 s, Result = 03980000, Performance =   9.07 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.111899 s, Result = 03ac0000, Performance =   9.02 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.115486 s, Result = 03c00000, Performance =   8.93 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.117372 s, Result = 03d40000, Performance =   8.97 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.119645 s, Result = 03e80000, Performance =   8.97 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.123078 s, Result = 03fc0000, Performance =   8.90 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.125796 s, Result = 04100000, Performance =   8.88 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.128288 s, Result = 04240000, Performance =   8.87 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.131529 s, Result = 04380000, Performance =   8.82 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.133288 s, Result = 044c0000, Performance =   8.86 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.138244 s, Result = 04600000, Performance =   8.70 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.140073 s, Result = 04740000, Performance =   8.74 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.140089 s, Result = 04880000, Performance =   8.89 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.142460 s, Result = 049c0000, Performance =   8.89 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.145303 s, Result = 04b00000, Performance =   8.87 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.148237 s, Result = 04c40000, Performance =   8.84 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.149997 s, Result = 04d80000, Performance =   8.88 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.148138 s, Result = 04ec0000, Performance =   9.13 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.175101 s, Result = 05000000, Performance =   7.85 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1449  1514   192
Test passed: M N K =  1807  1590  1856
Test passed: M N K =   860  1374   640
Test passed: M N K =  1830  1188   320
Test passed: M N K =   628  1369   576
M N K =  2048  2048   256, Elapsed time =   0.007542 s, Result = 64180000, Performance =   2.85 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008582 s, Result = 842c0000, Performance =   5.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.011624 s, Result = a4400000, Performance =   5.54 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.013220 s, Result = c4540000, Performance =   6.50 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.014936 s, Result = e4680000, Performance =   7.19 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.016649 s, Result = 047c0000, Performance =   7.74 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.019025 s, Result = 24900000, Performance =   7.90 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.020476 s, Result = 44a40000, Performance =   8.39 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.022547 s, Result = 64b80000, Performance =   8.57 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.024475 s, Result = 84cc0000, Performance =   8.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.026514 s, Result = a4e00000, Performance =   8.91 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.028376 s, Result = c4f40000, Performance =   9.08 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.030252 s, Result = e5080000, Performance =   9.23 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.032633 s, Result = 051c0000, Performance =   9.21 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.034883 s, Result = 25300000, Performance =   9.23 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.036569 s, Result = 45440000, Performance =   9.40 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.039367 s, Result = 65580000, Performance =   9.27 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.041339 s, Result = 856c0000, Performance =   9.35 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.043910 s, Result = a5800000, Performance =   9.29 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.046276 s, Result = c5940000, Performance =   9.28 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.049050 s, Result = e5a80000, Performance =   9.19 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.050870 s, Result = 05bc0000, Performance =   9.29 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.053881 s, Result = 25d00000, Performance =   9.17 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.055798 s, Result = 45e40000, Performance =   9.24 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.059725 s, Result = 65f80000, Performance =   8.99 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.062127 s, Result = 860c0000, Performance =   8.99 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.065297 s, Result = a6200000, Performance =   8.88 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.068029 s, Result = c6340000, Performance =   8.84 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.071107 s, Result = e6480000, Performance =   8.76 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.074152 s, Result = 065c0000, Performance =   8.69 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.076872 s, Result = 26700000, Performance =   8.66 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.079888 s, Result = 46840000, Performance =   8.60 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.082909 s, Result = 66980000, Performance =   8.55 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.086491 s, Result = 86ac0000, Performance =   8.44 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.089225 s, Result = a6c00000, Performance =   8.42 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.092073 s, Result = c6d40000, Performance =   8.40 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.095011 s, Result = e6e80000, Performance =   8.36 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.097463 s, Result = 06fc0000, Performance =   8.37 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.100556 s, Result = 27100000, Performance =   8.33 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.102083 s, Result = 47240000, Performance =   8.41 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.105391 s, Result = 67380000, Performance =   8.35 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.106747 s, Result = 874c0000, Performance =   8.45 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.109229 s, Result = a7600000, Performance =   8.45 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.111840 s, Result = c7740000, Performance =   8.45 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.114235 s, Result = e7880000, Performance =   8.46 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.117424 s, Result = 079c0000, Performance =   8.41 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.119750 s, Result = 27b00000, Performance =   8.43 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.122285 s, Result = 47c40000, Performance =   8.43 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.125411 s, Result = 67d80000, Performance =   8.39 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.127293 s, Result = 87ec0000, Performance =   8.44 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.129651 s, Result = a8000000, Performance =   8.45 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.131473 s, Result = c8140000, Performance =   8.49 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.133661 s, Result = e8280000, Performance =   8.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.135953 s, Result = 083c0000, Performance =   8.53 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.137813 s, Result = 28500000, Performance =   8.57 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.139003 s, Result = 48640000, Performance =   8.65 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.142081 s, Result = 68780000, Performance =   8.62 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.145358 s, Result = 888c0000, Performance =   8.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.146093 s, Result = a8a00000, Performance =   8.67 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.151233 s, Result = c8b40000, Performance =   8.52 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.150895 s, Result = e8c80000, Performance =   8.68 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.150300 s, Result = 08dc0000, Performance =   8.86 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.155140 s, Result = 28f00000, Performance =   8.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.196845 s, Result = 49040000, Performance =   6.98 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   733  1371   832
Test passed: M N K =  1741    39  1088
Test passed: M N K =   690   201  1536
Test passed: M N K =   225  1739  2048
Test passed: M N K =   350  1861   512
M N K =  2048  2048   256, Elapsed time =   0.009222 s, Result = 00140000, Performance =   2.33 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006391 s, Result = 00280000, Performance =   6.72 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008102 s, Result = 003c0000, Performance =   7.95 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010141 s, Result = 00500000, Performance =   8.47 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011575 s, Result = 00640000, Performance =   9.28 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013244 s, Result = 00780000, Performance =   9.73 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015213 s, Result = 008c0000, Performance =   9.88 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016727 s, Result = 00a00000, Performance =  10.27 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018699 s, Result = 00b40000, Performance =  10.34 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.020205 s, Result = 00c80000, Performance =  10.63 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.021971 s, Result = 00dc0000, Performance =  10.75 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.024276 s, Result = 00f00000, Performance =  10.62 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.026110 s, Result = 01040000, Performance =  10.69 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.027994 s, Result = 01180000, Performance =  10.74 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.030120 s, Result = 012c0000, Performance =  10.69 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.032094 s, Result = 01400000, Performance =  10.71 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.034485 s, Result = 01540000, Performance =  10.59 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.036509 s, Result = 01680000, Performance =  10.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.038968 s, Result = 017c0000, Performance =  10.47 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.040954 s, Result = 01900000, Performance =  10.49 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.043630 s, Result = 01a40000, Performance =  10.34 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.045572 s, Result = 01b80000, Performance =  10.37 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.047962 s, Result = 01cc0000, Performance =  10.30 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.050370 s, Result = 01e00000, Performance =  10.23 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.052552 s, Result = 01f40000, Performance =  10.22 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.055995 s, Result = 02080000, Performance =   9.97 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.059282 s, Result = 021c0000, Performance =   9.78 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.061838 s, Result = 02300000, Performance =   9.72 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.064448 s, Result = 02440000, Performance =   9.66 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.067338 s, Result = 02580000, Performance =   9.57 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.070628 s, Result = 026c0000, Performance =   9.43 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.073543 s, Result = 02800000, Performance =   9.34 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.074022 s, Result = 02940000, Performance =   9.57 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.074625 s, Result = 02a80000, Performance =   9.78 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.078137 s, Result = 02bc0000, Performance =   9.62 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.080494 s, Result = 02d00000, Performance =   9.60 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.083733 s, Result = 02e40000, Performance =   9.49 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.085949 s, Result = 02f80000, Performance =   9.49 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.089080 s, Result = 030c0000, Performance =   9.40 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.092189 s, Result = 03200000, Performance =   9.32 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.095022 s, Result = 03340000, Performance =   9.27 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.097358 s, Result = 03480000, Performance =   9.26 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.099285 s, Result = 035c0000, Performance =   9.30 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.102082 s, Result = 03700000, Performance =   9.26 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.104989 s, Result = 03840000, Performance =   9.20 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.109043 s, Result = 03980000, Performance =   9.06 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.111921 s, Result = 03ac0000, Performance =   9.02 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.114652 s, Result = 03c00000, Performance =   8.99 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.120122 s, Result = 03d40000, Performance =   8.76 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.121062 s, Result = 03e80000, Performance =   8.87 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.126016 s, Result = 03fc0000, Performance =   8.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.127006 s, Result = 04100000, Performance =   8.79 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.129699 s, Result = 04240000, Performance =   8.78 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.130798 s, Result = 04380000, Performance =   8.87 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.134380 s, Result = 044c0000, Performance =   8.79 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.133737 s, Result = 04600000, Performance =   8.99 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.139030 s, Result = 04740000, Performance =   8.80 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.139917 s, Result = 04880000, Performance =   8.90 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.142836 s, Result = 049c0000, Performance =   8.87 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.147803 s, Result = 04b00000, Performance =   8.72 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.147943 s, Result = 04c40000, Performance =   8.85 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.145925 s, Result = 04d80000, Performance =   9.12 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.150058 s, Result = 04ec0000, Performance =   9.02 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.189450 s, Result = 05000000, Performance =   7.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   500  1440    64
Test passed: M N K =   922   722    64
Test passed: M N K =  1897   769  1728
Test passed: M N K =  1121   383   448
Test passed: M N K =   465    36  1344
M N K =  2048  2048   256, Elapsed time =   0.010472 s, Result = 283c0000, Performance =   2.05 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009690 s, Result = 28500000, Performance =   4.43 TOPS
M N K =  2048  2048   768, Elapsed time =   0.011390 s, Result = 28640000, Performance =   5.66 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.012488 s, Result = 28780000, Performance =   6.88 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.014048 s, Result = 288c0000, Performance =   7.64 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.015633 s, Result = 28a00000, Performance =   8.24 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.017339 s, Result = 28b40000, Performance =   8.67 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.018602 s, Result = 28c80000, Performance =   9.24 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.020452 s, Result = 28dc0000, Performance =   9.45 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.022370 s, Result = 28f00000, Performance =   9.60 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.024222 s, Result = 29040000, Performance =   9.75 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.025880 s, Result = 29180000, Performance =   9.96 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.027586 s, Result = 292c0000, Performance =  10.12 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.029396 s, Result = 29400000, Performance =  10.23 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.031747 s, Result = 29540000, Performance =  10.15 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.033241 s, Result = 29680000, Performance =  10.34 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.035621 s, Result = 297c0000, Performance =  10.25 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.037166 s, Result = 29900000, Performance =  10.40 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.039094 s, Result = 29a40000, Performance =  10.44 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.041689 s, Result = 29b80000, Performance =  10.30 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.043611 s, Result = 29cc0000, Performance =  10.34 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.045412 s, Result = 29e00000, Performance =  10.40 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.047731 s, Result = 29f40000, Performance =  10.35 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.050393 s, Result = 2a080000, Performance =  10.23 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.052635 s, Result = 2a1c0000, Performance =  10.20 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.055815 s, Result = 2a300000, Performance =  10.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.057882 s, Result = 2a440000, Performance =  10.02 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.061298 s, Result = 2a580000, Performance =   9.81 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.063786 s, Result = 2a6c0000, Performance =   9.76 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.067330 s, Result = 2a800000, Performance =   9.57 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.069334 s, Result = 2a940000, Performance =   9.60 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.072950 s, Result = 2aa80000, Performance =   9.42 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.072624 s, Result = 2abc0000, Performance =   9.76 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.074321 s, Result = 2ad00000, Performance =   9.82 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.079462 s, Result = 2ae40000, Performance =   9.46 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.079439 s, Result = 2af80000, Performance =   9.73 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.082958 s, Result = 2b0c0000, Performance =   9.58 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.084890 s, Result = 2b200000, Performance =   9.61 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.088622 s, Result = 2b340000, Performance =   9.45 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.095796 s, Result = 2b480000, Performance =   8.97 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.100166 s, Result = 2b5c0000, Performance =   8.79 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.103173 s, Result = 2b700000, Performance =   8.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.106275 s, Result = 2b840000, Performance =   8.69 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.108325 s, Result = 2b980000, Performance =   8.72 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.111682 s, Result = 2bac0000, Performance =   8.65 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.112957 s, Result = 2bc00000, Performance =   8.75 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.116906 s, Result = 2bd40000, Performance =   8.63 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.118903 s, Result = 2be80000, Performance =   8.67 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.120828 s, Result = 2bfc0000, Performance =   8.71 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.124300 s, Result = 2c100000, Performance =   8.64 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.126665 s, Result = 2c240000, Performance =   8.65 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.128593 s, Result = 2c380000, Performance =   8.68 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.130928 s, Result = 2c4c0000, Performance =   8.69 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.131659 s, Result = 2c600000, Performance =   8.81 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.134226 s, Result = 2c740000, Performance =   8.80 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.135498 s, Result = 2c880000, Performance =   8.88 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.138536 s, Result = 2c9c0000, Performance =   8.84 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.142143 s, Result = 2cb00000, Performance =   8.76 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.141885 s, Result = 2cc40000, Performance =   8.93 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.148192 s, Result = 2cd80000, Performance =   8.69 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.147494 s, Result = 2cec0000, Performance =   8.88 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.147591 s, Result = 2d000000, Performance =   9.02 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.150628 s, Result = 2d140000, Performance =   8.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.189660 s, Result = 2d280000, Performance =   7.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   735  1581   192
Test passed: M N K =   478  1664   512
Test passed: M N K =   801   899  1216
Test passed: M N K =  1295  1407   640
Test passed: M N K =   434   352  1984
M N K =  2048  2048   256, Elapsed time =   0.001702 s, Result = 00140000, Performance =  12.62 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003586 s, Result = 00280000, Performance =  11.98 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005439 s, Result = 003c0000, Performance =  11.84 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006023 s, Result = 00500000, Performance =  14.26 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007557 s, Result = 00640000, Performance =  14.21 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009079 s, Result = 00780000, Performance =  14.19 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010619 s, Result = 008c0000, Performance =  14.16 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012047 s, Result = 00a00000, Performance =  14.26 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013575 s, Result = 00b40000, Performance =  14.24 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015228 s, Result = 00c80000, Performance =  14.10 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016639 s, Result = 00dc0000, Performance =  14.20 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018118 s, Result = 00f00000, Performance =  14.22 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019985 s, Result = 01040000, Performance =  13.97 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021556 s, Result = 01180000, Performance =  13.95 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023115 s, Result = 012c0000, Performance =  13.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024595 s, Result = 01400000, Performance =  13.97 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027037 s, Result = 01540000, Performance =  13.50 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.028745 s, Result = 01680000, Performance =  13.45 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030559 s, Result = 017c0000, Performance =  13.35 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032693 s, Result = 01900000, Performance =  13.14 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034948 s, Result = 01a40000, Performance =  12.90 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.036827 s, Result = 01b80000, Performance =  12.83 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.039689 s, Result = 01cc0000, Performance =  12.44 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.041626 s, Result = 01e00000, Performance =  12.38 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.043517 s, Result = 01f40000, Performance =  12.34 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.045789 s, Result = 02080000, Performance =  12.19 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.049130 s, Result = 021c0000, Performance =  11.80 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.052423 s, Result = 02300000, Performance =  11.47 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.053694 s, Result = 02440000, Performance =  11.60 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.058146 s, Result = 02580000, Performance =  11.08 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.060436 s, Result = 026c0000, Performance =  11.02 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.064986 s, Result = 02800000, Performance =  10.57 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.063443 s, Result = 02940000, Performance =  11.17 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.063888 s, Result = 02a80000, Performance =  11.43 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.067155 s, Result = 02bc0000, Performance =  11.19 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.069646 s, Result = 02d00000, Performance =  11.10 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.072917 s, Result = 02e40000, Performance =  10.90 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.074990 s, Result = 02f80000, Performance =  10.88 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.078523 s, Result = 030c0000, Performance =  10.67 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.081072 s, Result = 03200000, Performance =  10.60 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.085069 s, Result = 03340000, Performance =  10.35 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.086213 s, Result = 03480000, Performance =  10.46 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.090529 s, Result = 035c0000, Performance =  10.20 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.097158 s, Result = 03700000, Performance =   9.73 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.101706 s, Result = 03840000, Performance =   9.50 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.104267 s, Result = 03980000, Performance =   9.47 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.107228 s, Result = 03ac0000, Performance =   9.41 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.109323 s, Result = 03c00000, Performance =   9.43 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.112357 s, Result = 03d40000, Performance =   9.37 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.114564 s, Result = 03e80000, Performance =   9.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.117171 s, Result = 03fc0000, Performance =   9.35 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.119471 s, Result = 04100000, Performance =   9.35 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.121347 s, Result = 04240000, Performance =   9.38 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.124084 s, Result = 04380000, Performance =   9.35 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.126260 s, Result = 044c0000, Performance =   9.35 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.127606 s, Result = 04600000, Performance =   9.42 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.138713 s, Result = 04740000, Performance =   8.82 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.133119 s, Result = 04880000, Performance =   9.36 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.135067 s, Result = 049c0000, Performance =   9.38 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.139481 s, Result = 04b00000, Performance =   9.24 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.139662 s, Result = 04c40000, Performance =   9.38 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.139202 s, Result = 04d80000, Performance =   9.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.138722 s, Result = 04ec0000, Performance =   9.75 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.174771 s, Result = 05000000, Performance =   7.86 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2030   871   704
Test passed: M N K =  1802  1867   256
Test passed: M N K =  1315  1857  1664
Test passed: M N K =  1113  1626  1216
Test passed: M N K =   497  1050  1152
M N K =  2048  2048   256, Elapsed time =   0.006618 s, Result = 64180000, Performance =   3.25 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008672 s, Result = 842c0000, Performance =   4.95 TOPS
M N K =  2048  2048   768, Elapsed time =   0.011485 s, Result = a4400000, Performance =   5.61 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.012655 s, Result = c4540000, Performance =   6.79 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.014604 s, Result = e4680000, Performance =   7.35 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.016808 s, Result = 047c0000, Performance =   7.67 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.018354 s, Result = 24900000, Performance =   8.19 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.020270 s, Result = 44a40000, Performance =   8.48 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.022313 s, Result = 64b80000, Performance =   8.66 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.024187 s, Result = 84cc0000, Performance =   8.88 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.026026 s, Result = a4e00000, Performance =   9.08 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.027885 s, Result = c4f40000, Performance =   9.24 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.029925 s, Result = e5080000, Performance =   9.33 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.032019 s, Result = 051c0000, Performance =   9.39 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.033982 s, Result = 25300000, Performance =   9.48 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.035639 s, Result = 45440000, Performance =   9.64 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.038376 s, Result = 65580000, Performance =   9.51 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.040126 s, Result = 856c0000, Performance =   9.63 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.042246 s, Result = a5800000, Performance =   9.66 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.044483 s, Result = c5940000, Performance =   9.66 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.046775 s, Result = e5a80000, Performance =   9.64 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.049679 s, Result = 05bc0000, Performance =   9.51 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.051154 s, Result = 25d00000, Performance =   9.66 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.053640 s, Result = 45e40000, Performance =   9.61 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.056712 s, Result = 65f80000, Performance =   9.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.059180 s, Result = 860c0000, Performance =   9.43 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.061873 s, Result = a6200000, Performance =   9.37 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.063883 s, Result = c6340000, Performance =   9.41 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.066853 s, Result = e6480000, Performance =   9.32 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.069367 s, Result = 065c0000, Performance =   9.29 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.073759 s, Result = 26700000, Performance =   9.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.074577 s, Result = 46840000, Performance =   9.21 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.078593 s, Result = 66980000, Performance =   9.02 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.082051 s, Result = 86ac0000, Performance =   8.90 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.083878 s, Result = a6c00000, Performance =   8.96 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.085044 s, Result = c6d40000, Performance =   9.09 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.090875 s, Result = e6e80000, Performance =   8.74 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.093669 s, Result = 06fc0000, Performance =   8.71 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.096266 s, Result = 27100000, Performance =   8.70 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.097583 s, Result = 47240000, Performance =   8.80 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.100398 s, Result = 67380000, Performance =   8.77 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.102534 s, Result = 874c0000, Performance =   8.80 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.105268 s, Result = a7600000, Performance =   8.77 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.106507 s, Result = c7740000, Performance =   8.87 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.109619 s, Result = e7880000, Performance =   8.82 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.112164 s, Result = 079c0000, Performance =   8.81 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.115097 s, Result = 27b00000, Performance =   8.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.116229 s, Result = 47c40000, Performance =   8.87 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.119230 s, Result = 67d80000, Performance =   8.83 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.121637 s, Result = 87ec0000, Performance =   8.83 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.123637 s, Result = a8000000, Performance =   8.86 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.125530 s, Result = c8140000, Performance =   8.90 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.128095 s, Result = e8280000, Performance =   8.89 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.130526 s, Result = 083c0000, Performance =   8.88 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.133510 s, Result = 28500000, Performance =   8.85 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.134255 s, Result = 48640000, Performance =   8.96 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.136376 s, Result = 68780000, Performance =   8.98 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.139378 s, Result = 888c0000, Performance =   8.94 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.144313 s, Result = a8a00000, Performance =   8.78 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.141924 s, Result = c8b40000, Performance =   9.08 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.145555 s, Result = e8c80000, Performance =   9.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.149043 s, Result = 08dc0000, Performance =   8.93 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.147591 s, Result = 28f00000, Performance =   9.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.184489 s, Result = 49040000, Performance =   7.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1829  1374  1536
Test passed: M N K =  1809   655  1600
Test passed: M N K =   480   648   640
Test passed: M N K =  1162   361  1984
Test passed: M N K =   350   313   832
M N K =  2048  2048   256, Elapsed time =   0.009255 s, Result = 00140000, Performance =   2.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006414 s, Result = 00280000, Performance =   6.70 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008455 s, Result = 003c0000, Performance =   7.62 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009319 s, Result = 00500000, Performance =   9.22 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011293 s, Result = 00640000, Performance =   9.51 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013196 s, Result = 00780000, Performance =   9.76 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014659 s, Result = 008c0000, Performance =  10.25 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016504 s, Result = 00a00000, Performance =  10.41 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018284 s, Result = 00b40000, Performance =  10.57 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.019994 s, Result = 00c80000, Performance =  10.74 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022653 s, Result = 00dc0000, Performance =  10.43 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.023736 s, Result = 00f00000, Performance =  10.86 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.025650 s, Result = 01040000, Performance =  10.88 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.027518 s, Result = 01180000, Performance =  10.93 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.029586 s, Result = 012c0000, Performance =  10.89 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.031416 s, Result = 01400000, Performance =  10.94 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.033561 s, Result = 01540000, Performance =  10.88 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.035167 s, Result = 01680000, Performance =  10.99 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.037377 s, Result = 017c0000, Performance =  10.92 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.039390 s, Result = 01900000, Performance =  10.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.041401 s, Result = 01a40000, Performance =  10.89 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.043993 s, Result = 01b80000, Performance =  10.74 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.045966 s, Result = 01cc0000, Performance =  10.75 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.047753 s, Result = 01e00000, Performance =  10.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.050339 s, Result = 01f40000, Performance =  10.67 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.053277 s, Result = 02080000, Performance =  10.48 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.055822 s, Result = 021c0000, Performance =  10.39 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.057965 s, Result = 02300000, Performance =  10.37 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.060553 s, Result = 02440000, Performance =  10.28 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.063386 s, Result = 02580000, Performance =  10.16 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.066503 s, Result = 026c0000, Performance =  10.01 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.068426 s, Result = 02800000, Performance =  10.04 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.071686 s, Result = 02940000, Performance =   9.89 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.074559 s, Result = 02a80000, Performance =   9.79 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.075578 s, Result = 02bc0000, Performance =   9.94 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.076436 s, Result = 02d00000, Performance =  10.11 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.080011 s, Result = 02e40000, Performance =   9.93 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.082692 s, Result = 02f80000, Performance =   9.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.084710 s, Result = 030c0000, Performance =   9.89 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.087162 s, Result = 03200000, Performance =   9.86 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.090546 s, Result = 03340000, Performance =   9.72 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.093423 s, Result = 03480000, Performance =   9.65 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.095795 s, Result = 035c0000, Performance =   9.64 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.099784 s, Result = 03700000, Performance =   9.47 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.104195 s, Result = 03840000, Performance =   9.27 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.106313 s, Result = 03980000, Performance =   9.29 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.111192 s, Result = 03ac0000, Performance =   9.08 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.111852 s, Result = 03c00000, Performance =   9.22 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.115866 s, Result = 03d40000, Performance =   9.08 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.117163 s, Result = 03e80000, Performance =   9.16 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.120282 s, Result = 03fc0000, Performance =   9.11 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.121667 s, Result = 04100000, Performance =   9.18 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.125469 s, Result = 04240000, Performance =   9.07 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.126278 s, Result = 04380000, Performance =   9.18 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.129623 s, Result = 044c0000, Performance =   9.11 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.129979 s, Result = 04600000, Performance =   9.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.130469 s, Result = 04740000, Performance =   9.38 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.132068 s, Result = 04880000, Performance =   9.43 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.138635 s, Result = 049c0000, Performance =   9.14 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.137841 s, Result = 04b00000, Performance =   9.35 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.141639 s, Result = 04c40000, Performance =   9.25 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.143170 s, Result = 04d80000, Performance =   9.30 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.138788 s, Result = 04ec0000, Performance =   9.75 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.171999 s, Result = 05000000, Performance =   7.99 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   261   999    64
Test passed: M N K =  1203  1843  1472
Test passed: M N K =  1230  1171  1344
Test passed: M N K =   825   379  2048
Test passed: M N K =  1773  1727  2048
M N K =  2048  2048   256, Elapsed time =   0.005853 s, Result = 283c0000, Performance =   3.67 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007519 s, Result = 28500000, Performance =   5.71 TOPS
M N K =  2048  2048   768, Elapsed time =   0.011085 s, Result = 28640000, Performance =   5.81 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.012365 s, Result = 28780000, Performance =   6.95 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.013911 s, Result = 288c0000, Performance =   7.72 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.015432 s, Result = 28a00000, Performance =   8.35 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.017332 s, Result = 28b40000, Performance =   8.67 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.018879 s, Result = 28c80000, Performance =   9.10 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.020570 s, Result = 28dc0000, Performance =   9.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.022556 s, Result = 28f00000, Performance =   9.52 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.024246 s, Result = 29040000, Performance =   9.74 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.025762 s, Result = 29180000, Performance =  10.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.027530 s, Result = 292c0000, Performance =  10.14 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.029390 s, Result = 29400000, Performance =  10.23 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.031373 s, Result = 29540000, Performance =  10.27 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.032919 s, Result = 29680000, Performance =  10.44 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.035039 s, Result = 297c0000, Performance =  10.42 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.036692 s, Result = 29900000, Performance =  10.54 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.038702 s, Result = 29a40000, Performance =  10.54 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.040284 s, Result = 29b80000, Performance =  10.66 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.042321 s, Result = 29cc0000, Performance =  10.66 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.044486 s, Result = 29e00000, Performance =  10.62 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.046369 s, Result = 29f40000, Performance =  10.65 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.048245 s, Result = 2a080000, Performance =  10.68 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.050817 s, Result = 2a1c0000, Performance =  10.56 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.053165 s, Result = 2a300000, Performance =  10.50 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.055639 s, Result = 2a440000, Performance =  10.42 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.057909 s, Result = 2a580000, Performance =  10.38 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.060754 s, Result = 2a6c0000, Performance =  10.25 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.063361 s, Result = 2a800000, Performance =  10.17 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.066396 s, Result = 2a940000, Performance =  10.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.068074 s, Result = 2aa80000, Performance =  10.09 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.071723 s, Result = 2abc0000, Performance =   9.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.073872 s, Result = 2ad00000, Performance =   9.88 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.076806 s, Result = 2ae40000, Performance =   9.79 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.078105 s, Result = 2af80000, Performance =   9.90 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.080329 s, Result = 2b0c0000, Performance =   9.89 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.084897 s, Result = 2b200000, Performance =   9.61 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.090544 s, Result = 2b340000, Performance =   9.25 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.092887 s, Result = 2b480000, Performance =   9.25 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.092669 s, Result = 2b5c0000, Performance =   9.50 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.093251 s, Result = 2b700000, Performance =   9.67 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.096081 s, Result = 2b840000, Performance =   9.61 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.099602 s, Result = 2b980000, Performance =   9.49 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.106884 s, Result = 2bac0000, Performance =   9.04 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.108920 s, Result = 2bc00000, Performance =   9.07 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.111510 s, Result = 2bd40000, Performance =   9.05 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.112888 s, Result = 2be80000, Performance =   9.13 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.115580 s, Result = 2bfc0000, Performance =   9.10 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.118081 s, Result = 2c100000, Performance =   9.09 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.120445 s, Result = 2c240000, Performance =   9.09 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.122236 s, Result = 2c380000, Performance =   9.14 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.125584 s, Result = 2c4c0000, Performance =   9.06 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.127082 s, Result = 2c600000, Performance =   9.13 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.130874 s, Result = 2c740000, Performance =   9.02 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.131672 s, Result = 2c880000, Performance =   9.13 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.133735 s, Result = 2c9c0000, Performance =   9.15 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.136090 s, Result = 2cb00000, Performance =   9.15 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.140639 s, Result = 2cc40000, Performance =   9.01 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.138503 s, Result = 2cd80000, Performance =   9.30 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.142385 s, Result = 2cec0000, Performance =   9.20 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.146106 s, Result = 2d000000, Performance =   9.11 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.142368 s, Result = 2d140000, Performance =   9.50 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.178174 s, Result = 2d280000, Performance =   7.71 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   832   363   128
Test passed: M N K =  1516  1561  1600
Test passed: M N K =   629    83  1152
Test passed: M N K =  1788  1868  1024
Test passed: M N K =  1694  1372   320
M N K =  2048  2048   256, Elapsed time =   0.001730 s, Result = 00140000, Performance =  12.41 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003601 s, Result = 00280000, Performance =  11.93 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005663 s, Result = 003c0000, Performance =  11.38 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006898 s, Result = 00500000, Performance =  12.45 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007469 s, Result = 00640000, Performance =  14.38 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009055 s, Result = 00780000, Performance =  14.23 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010617 s, Result = 008c0000, Performance =  14.16 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012095 s, Result = 00a00000, Performance =  14.20 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013670 s, Result = 00b40000, Performance =  14.14 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015204 s, Result = 00c80000, Performance =  14.12 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016818 s, Result = 00dc0000, Performance =  14.05 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017941 s, Result = 00f00000, Performance =  14.36 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019679 s, Result = 01040000, Performance =  14.19 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021200 s, Result = 01180000, Performance =  14.18 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022750 s, Result = 012c0000, Performance =  14.16 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024128 s, Result = 01400000, Performance =  14.24 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.026410 s, Result = 01540000, Performance =  13.82 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.028012 s, Result = 01680000, Performance =  13.80 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.029780 s, Result = 017c0000, Performance =  13.70 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031390 s, Result = 01900000, Performance =  13.68 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033449 s, Result = 01a40000, Performance =  13.48 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035384 s, Result = 01b80000, Performance =  13.35 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.037398 s, Result = 01cc0000, Performance =  13.21 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039716 s, Result = 01e00000, Performance =  12.98 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.041661 s, Result = 01f40000, Performance =  12.89 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.043905 s, Result = 02080000, Performance =  12.72 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.046053 s, Result = 021c0000, Performance =  12.59 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.048082 s, Result = 02300000, Performance =  12.51 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051572 s, Result = 02440000, Performance =  12.08 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.054897 s, Result = 02580000, Performance =  11.74 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.057337 s, Result = 026c0000, Performance =  11.61 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.059854 s, Result = 02800000, Performance =  11.48 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.061668 s, Result = 02940000, Performance =  11.49 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.064061 s, Result = 02a80000, Performance =  11.40 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.065281 s, Result = 02bc0000, Performance =  11.51 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.066935 s, Result = 02d00000, Performance =  11.55 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.069955 s, Result = 02e40000, Performance =  11.36 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.072796 s, Result = 02f80000, Performance =  11.21 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.075783 s, Result = 030c0000, Performance =  11.05 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.077638 s, Result = 03200000, Performance =  11.06 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.080464 s, Result = 03340000, Performance =  10.94 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.083254 s, Result = 03480000, Performance =  10.83 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.086627 s, Result = 035c0000, Performance =  10.66 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.088754 s, Result = 03700000, Performance =  10.65 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.092316 s, Result = 03840000, Performance =  10.47 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.095136 s, Result = 03980000, Performance =  10.38 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.097581 s, Result = 03ac0000, Performance =  10.34 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.100171 s, Result = 03c00000, Performance =  10.29 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.104006 s, Result = 03d40000, Performance =  10.12 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.107127 s, Result = 03e80000, Performance =  10.02 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.109550 s, Result = 03fc0000, Performance =  10.00 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.113180 s, Result = 04100000, Performance =   9.87 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.114971 s, Result = 04240000, Performance =   9.90 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.116292 s, Result = 04380000, Performance =   9.97 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.120764 s, Result = 044c0000, Performance =   9.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.120511 s, Result = 04600000, Performance =   9.98 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.122560 s, Result = 04740000, Performance =   9.99 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.124385 s, Result = 04880000, Performance =  10.01 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.129591 s, Result = 049c0000, Performance =   9.78 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.129070 s, Result = 04b00000, Performance =   9.98 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.133897 s, Result = 04c40000, Performance =   9.78 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.136746 s, Result = 04d80000, Performance =   9.74 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.134231 s, Result = 04ec0000, Performance =  10.08 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.167438 s, Result = 05000000, Performance =   8.21 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   159   730  1536
Test passed: M N K =  1973   634  1024
Test passed: M N K =   728  2038   832
Test passed: M N K =   968   429  1280
Test passed: M N K =   416  1208  1728
M N K =  2048  2048   256, Elapsed time =   0.006025 s, Result = 34130000, Performance =   3.56 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007541 s, Result = e4220000, Performance =   5.70 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009778 s, Result = 94310000, Performance =   6.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011242 s, Result = 44400000, Performance =   7.64 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012482 s, Result = f44f0000, Performance =   8.60 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014469 s, Result = a45e0000, Performance =   8.91 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015957 s, Result = 546d0000, Performance =   9.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.018016 s, Result = 047c0000, Performance =   9.54 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.019657 s, Result = b48b0000, Performance =   9.83 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.021289 s, Result = 649a0000, Performance =  10.09 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022865 s, Result = 14a90000, Performance =  10.33 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.024927 s, Result = c4b80000, Performance =  10.34 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.026709 s, Result = 74c70000, Performance =  10.45 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.028534 s, Result = 24d60000, Performance =  10.54 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.030360 s, Result = d4e50000, Performance =  10.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.032191 s, Result = 84f40000, Performance =  10.67 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.034616 s, Result = 35030000, Performance =  10.55 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.036647 s, Result = e5120000, Performance =  10.55 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.038636 s, Result = 95210000, Performance =  10.56 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.040273 s, Result = 45300000, Performance =  10.66 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.042624 s, Result = f53f0000, Performance =  10.58 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.044786 s, Result = a54e0000, Performance =  10.55 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.046889 s, Result = 555d0000, Performance =  10.53 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.050122 s, Result = 056c0000, Performance =  10.28 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.052621 s, Result = b57b0000, Performance =  10.20 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.056387 s, Result = 658a0000, Performance =   9.90 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.058756 s, Result = 15990000, Performance =   9.87 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.061718 s, Result = c5a80000, Performance =   9.74 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.064521 s, Result = 75b70000, Performance =   9.65 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.068121 s, Result = 25c60000, Performance =   9.46 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.071349 s, Result = d5d50000, Performance =   9.33 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.071975 s, Result = 85e40000, Performance =   9.55 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.072290 s, Result = 35f30000, Performance =   9.80 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.075099 s, Result = e6020000, Performance =   9.72 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.077957 s, Result = 96110000, Performance =   9.64 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.080970 s, Result = 46200000, Performance =   9.55 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.083488 s, Result = f62f0000, Performance =   9.52 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.086410 s, Result = a63e0000, Performance =   9.44 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.090086 s, Result = 564d0000, Performance =   9.30 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.093015 s, Result = 065c0000, Performance =   9.23 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.095731 s, Result = b66b0000, Performance =   9.20 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.097679 s, Result = 667a0000, Performance =   9.23 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.098467 s, Result = 16890000, Performance =   9.38 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.102905 s, Result = c6980000, Performance =   9.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.106434 s, Result = 76a70000, Performance =   9.08 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.108963 s, Result = 26b60000, Performance =   9.07 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.111771 s, Result = d6c50000, Performance =   9.03 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.118345 s, Result = 86d40000, Performance =   8.71 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.119857 s, Result = 36e30000, Performance =   8.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.123125 s, Result = e6f20000, Performance =   8.72 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.124757 s, Result = 97010000, Performance =   8.78 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.127277 s, Result = 47100000, Performance =   8.77 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.129519 s, Result = f71f0000, Performance =   8.79 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.131793 s, Result = a72e0000, Performance =   8.80 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.134516 s, Result = 573d0000, Performance =   8.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.135439 s, Result = 074c0000, Performance =   8.88 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.136850 s, Result = b75b0000, Performance =   8.94 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.137703 s, Result = 676a0000, Performance =   9.05 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.139094 s, Result = 17790000, Performance =   9.11 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.141547 s, Result = c7880000, Performance =   9.10 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.144100 s, Result = 77970000, Performance =   9.09 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.144690 s, Result = 27a60000, Performance =   9.20 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.141402 s, Result = d7b50000, Performance =   9.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.179677 s, Result = 87c40000, Performance =   7.65 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   661  1081   256
Test passed: M N K =   588  1369  1856
Test passed: M N K =   378   589   768
Test passed: M N K =   857   821   896
Test passed: M N K =  1478   633  1664
M N K =  2048  2048   256, Elapsed time =   0.007812 s, Result = 000f0000, Performance =   2.75 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004815 s, Result = 001e0000, Performance =   8.92 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007170 s, Result = 002d0000, Performance =   8.99 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008295 s, Result = 003c0000, Performance =  10.36 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009529 s, Result = 004b0000, Performance =  11.27 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011245 s, Result = 005a0000, Performance =  11.46 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012305 s, Result = 00690000, Performance =  12.22 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013626 s, Result = 00780000, Performance =  12.61 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015713 s, Result = 00870000, Performance =  12.30 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017251 s, Result = 00960000, Performance =  12.45 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018918 s, Result = 00a50000, Performance =  12.49 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020648 s, Result = 00b40000, Performance =  12.48 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022564 s, Result = 00c30000, Performance =  12.37 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024498 s, Result = 00d20000, Performance =  12.27 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026148 s, Result = 00e10000, Performance =  12.32 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.027549 s, Result = 00f00000, Performance =  12.47 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.030000 s, Result = 00ff0000, Performance =  12.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.031584 s, Result = 010e0000, Performance =  12.24 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.034408 s, Result = 011d0000, Performance =  11.86 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.035395 s, Result = 012c0000, Performance =  12.13 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.037426 s, Result = 013b0000, Performance =  12.05 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.039976 s, Result = 014a0000, Performance =  11.82 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.042514 s, Result = 01590000, Performance =  11.62 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.044588 s, Result = 01680000, Performance =  11.56 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.046472 s, Result = 01770000, Performance =  11.55 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.050685 s, Result = 01860000, Performance =  11.02 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.052588 s, Result = 01950000, Performance =  11.03 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.055966 s, Result = 01a40000, Performance =  10.74 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.059447 s, Result = 01b30000, Performance =  10.48 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.060462 s, Result = 01c20000, Performance =  10.66 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.064248 s, Result = 01d10000, Performance =  10.36 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.064043 s, Result = 01e00000, Performance =  10.73 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.066543 s, Result = 01ef0000, Performance =  10.65 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.069674 s, Result = 01fe0000, Performance =  10.48 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.071649 s, Result = 020d0000, Performance =  10.49 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.074962 s, Result = 021c0000, Performance =  10.31 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.078031 s, Result = 022b0000, Performance =  10.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.080166 s, Result = 023a0000, Performance =  10.18 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.083124 s, Result = 02490000, Performance =  10.08 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.085261 s, Result = 02580000, Performance =  10.07 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.088046 s, Result = 02670000, Performance =  10.00 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.090738 s, Result = 02760000, Performance =   9.94 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.092524 s, Result = 02850000, Performance =   9.98 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.096300 s, Result = 02940000, Performance =   9.81 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.099696 s, Result = 02a30000, Performance =   9.69 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.101604 s, Result = 02b20000, Performance =   9.72 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.104395 s, Result = 02c10000, Performance =   9.67 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.107429 s, Result = 02d00000, Performance =   9.60 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.109915 s, Result = 02df0000, Performance =   9.57 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.112269 s, Result = 02ee0000, Performance =   9.56 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.114556 s, Result = 02fd0000, Performance =   9.56 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.117945 s, Result = 030c0000, Performance =   9.47 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.119717 s, Result = 031b0000, Performance =   9.51 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.124033 s, Result = 032a0000, Performance =   9.35 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.123839 s, Result = 03390000, Performance =   9.54 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.125349 s, Result = 03480000, Performance =   9.59 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.128009 s, Result = 03570000, Performance =   9.56 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.129601 s, Result = 03660000, Performance =   9.61 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.131620 s, Result = 03750000, Performance =   9.63 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.133862 s, Result = 03840000, Performance =   9.63 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.136526 s, Result = 03930000, Performance =   9.59 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.137020 s, Result = 03a20000, Performance =   9.72 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.133091 s, Result = 03b10000, Performance =  10.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.170225 s, Result = 03c00000, Performance =   8.07 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1440   947   320
Test passed: M N K =  1083   931  1536
Test passed: M N K =   630   392   192
Test passed: M N K =  1028  1047   960
Test passed: M N K =  1918   712  1856
M N K =  2048  2048   256, Elapsed time =   0.008954 s, Result = 28370000, Performance =   2.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008722 s, Result = 28460000, Performance =   4.92 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010648 s, Result = 28550000, Performance =   6.05 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011011 s, Result = 28640000, Performance =   7.80 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012131 s, Result = 28730000, Performance =   8.85 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013354 s, Result = 28820000, Performance =   9.65 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014563 s, Result = 28910000, Performance =  10.32 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.015700 s, Result = 28a00000, Performance =  10.94 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017195 s, Result = 28af0000, Performance =  11.24 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018498 s, Result = 28be0000, Performance =  11.61 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019840 s, Result = 28cd0000, Performance =  11.91 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.021474 s, Result = 28dc0000, Performance =  12.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.023172 s, Result = 28eb0000, Performance =  12.05 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024697 s, Result = 28fa0000, Performance =  12.17 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026065 s, Result = 29090000, Performance =  12.36 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.027307 s, Result = 29180000, Performance =  12.58 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.029342 s, Result = 29270000, Performance =  12.44 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.030864 s, Result = 29360000, Performance =  12.52 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.032717 s, Result = 29450000, Performance =  12.47 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034405 s, Result = 29540000, Performance =  12.48 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.036322 s, Result = 29630000, Performance =  12.42 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.038127 s, Result = 29720000, Performance =  12.39 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.040184 s, Result = 29810000, Performance =  12.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.041572 s, Result = 29900000, Performance =  12.40 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.044920 s, Result = 299f0000, Performance =  11.95 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.046529 s, Result = 29ae0000, Performance =  12.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.050929 s, Result = 29bd0000, Performance =  11.38 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.055168 s, Result = 29cc0000, Performance =  10.90 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.056099 s, Result = 29db0000, Performance =  11.10 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.058070 s, Result = 29ea0000, Performance =  11.09 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.061188 s, Result = 29f90000, Performance =  10.88 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.062396 s, Result = 2a080000, Performance =  11.01 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.062694 s, Result = 2a170000, Performance =  11.30 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.065802 s, Result = 2a260000, Performance =  11.10 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.069497 s, Result = 2a350000, Performance =  10.82 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.072190 s, Result = 2a440000, Performance =  10.71 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.074412 s, Result = 2a530000, Performance =  10.68 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.076586 s, Result = 2a620000, Performance =  10.66 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.079570 s, Result = 2a710000, Performance =  10.53 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.082447 s, Result = 2a800000, Performance =  10.42 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.085311 s, Result = 2a8f0000, Performance =  10.32 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.081463 s, Result = 2a9e0000, Performance =  11.07 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.090776 s, Result = 2aad0000, Performance =  10.17 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.092445 s, Result = 2abc0000, Performance =  10.22 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.096289 s, Result = 2acb0000, Performance =  10.04 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.098940 s, Result = 2ada0000, Performance =   9.98 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.101510 s, Result = 2ae90000, Performance =   9.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.104816 s, Result = 2af80000, Performance =   9.83 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.105983 s, Result = 2b070000, Performance =   9.93 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.109421 s, Result = 2b160000, Performance =   9.81 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.111626 s, Result = 2b250000, Performance =   9.81 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.114286 s, Result = 2b340000, Performance =   9.77 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.117194 s, Result = 2b430000, Performance =   9.71 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.119830 s, Result = 2b520000, Performance =   9.68 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.121992 s, Result = 2b610000, Performance =   9.68 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.123807 s, Result = 2b700000, Performance =   9.71 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.125890 s, Result = 2b7f0000, Performance =   9.72 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.127578 s, Result = 2b8e0000, Performance =   9.76 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.128947 s, Result = 2b9d0000, Performance =   9.83 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.131716 s, Result = 2bac0000, Performance =   9.78 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.135061 s, Result = 2bbb0000, Performance =   9.70 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.135969 s, Result = 2bca0000, Performance =   9.79 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.130311 s, Result = 2bd90000, Performance =  10.38 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.166991 s, Result = 2be80000, Performance =   8.23 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   364   370   576
Test passed: M N K =  1887  1113  1408
Test passed: M N K =   649   502  1984
Test passed: M N K =   475  1753   704
Test passed: M N K =  1474   698   896
M N K =  2048  2048   256, Elapsed time =   0.001064 s, Result = 000f0000, Performance =  20.18 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002189 s, Result = 001e0000, Performance =  19.62 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003468 s, Result = 002d0000, Performance =  18.58 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004594 s, Result = 003c0000, Performance =  18.70 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005808 s, Result = 004b0000, Performance =  18.49 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006943 s, Result = 005a0000, Performance =  18.56 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007986 s, Result = 00690000, Performance =  18.82 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009133 s, Result = 00780000, Performance =  18.81 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010505 s, Result = 00870000, Performance =  18.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011658 s, Result = 00960000, Performance =  18.42 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012894 s, Result = 00a50000, Performance =  18.32 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014110 s, Result = 00b40000, Performance =  18.26 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015570 s, Result = 00c30000, Performance =  17.93 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016831 s, Result = 00d20000, Performance =  17.86 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018303 s, Result = 00e10000, Performance =  17.60 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019524 s, Result = 00f00000, Performance =  17.60 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021333 s, Result = 00ff0000, Performance =  17.11 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022818 s, Result = 010e0000, Performance =  16.94 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.024631 s, Result = 011d0000, Performance =  16.57 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.026412 s, Result = 012c0000, Performance =  16.26 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028023 s, Result = 013b0000, Performance =  16.09 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030013 s, Result = 014a0000, Performance =  15.74 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032021 s, Result = 01590000, Performance =  15.42 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.034848 s, Result = 01680000, Performance =  14.79 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.036433 s, Result = 01770000, Performance =  14.74 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039070 s, Result = 01860000, Performance =  14.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041598 s, Result = 01950000, Performance =  13.94 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.043395 s, Result = 01a40000, Performance =  13.86 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.047380 s, Result = 01b30000, Performance =  13.14 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.050993 s, Result = 01c20000, Performance =  12.63 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.052264 s, Result = 01d10000, Performance =  12.74 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.054694 s, Result = 01e00000, Performance =  12.56 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.054644 s, Result = 01ef0000, Performance =  12.97 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058010 s, Result = 01fe0000, Performance =  12.59 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.060149 s, Result = 020d0000, Performance =  12.50 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.063322 s, Result = 021c0000, Performance =  12.21 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.065243 s, Result = 022b0000, Performance =  12.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.067650 s, Result = 023a0000, Performance =  12.06 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.071069 s, Result = 02490000, Performance =  11.78 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.073192 s, Result = 02580000, Performance =  11.74 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.075439 s, Result = 02670000, Performance =  11.67 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.078179 s, Result = 02760000, Performance =  11.54 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.081052 s, Result = 02850000, Performance =  11.39 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.084878 s, Result = 02940000, Performance =  11.13 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.088328 s, Result = 02a30000, Performance =  10.94 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.091421 s, Result = 02b20000, Performance =  10.81 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.093585 s, Result = 02c10000, Performance =  10.78 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.097934 s, Result = 02d00000, Performance =  10.53 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.098921 s, Result = 02df0000, Performance =  10.64 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.101224 s, Result = 02ee0000, Performance =  10.61 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.104214 s, Result = 02fd0000, Performance =  10.51 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.107116 s, Result = 030c0000, Performance =  10.43 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.110153 s, Result = 031b0000, Performance =  10.33 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.111901 s, Result = 032a0000, Performance =  10.36 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.114312 s, Result = 03390000, Performance =  10.33 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.117299 s, Result = 03480000, Performance =  10.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.119409 s, Result = 03570000, Performance =  10.25 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.121088 s, Result = 03660000, Performance =  10.29 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.123363 s, Result = 03750000, Performance =  10.27 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.124861 s, Result = 03840000, Performance =  10.32 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.127252 s, Result = 03930000, Performance =  10.29 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.129401 s, Result = 03a20000, Performance =  10.29 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.123216 s, Result = 03b10000, Performance =  10.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.158386 s, Result = 03c00000, Performance =   8.68 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1315   422   832
Test passed: M N K =   920    56  1536
Test passed: M N K =  1133  1011  1984
Test passed: M N K =   682    49  1856
Test passed: M N K =   558  1813   128
M N K =  2048  2048   256, Elapsed time =   0.006020 s, Result = 34130000, Performance =   3.57 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007405 s, Result = e4220000, Performance =   5.80 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009841 s, Result = 94310000, Performance =   6.55 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010900 s, Result = 44400000, Performance =   7.88 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012696 s, Result = f44f0000, Performance =   8.46 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014012 s, Result = a45e0000, Performance =   9.20 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015502 s, Result = 546d0000, Performance =   9.70 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.017253 s, Result = 047c0000, Performance =   9.96 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.019011 s, Result = b48b0000, Performance =  10.17 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.020504 s, Result = 649a0000, Performance =  10.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022237 s, Result = 14a90000, Performance =  10.62 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.023964 s, Result = c4b80000, Performance =  10.75 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.025721 s, Result = 74c70000, Performance =  10.85 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.027137 s, Result = 24d60000, Performance =  11.08 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.029064 s, Result = d4e50000, Performance =  11.08 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.030436 s, Result = 84f40000, Performance =  11.29 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.032405 s, Result = 35030000, Performance =  11.27 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.034686 s, Result = e5120000, Performance =  11.14 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.036166 s, Result = 95210000, Performance =  11.28 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.038199 s, Result = 45300000, Performance =  11.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.040269 s, Result = f53f0000, Performance =  11.20 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.042524 s, Result = a54e0000, Performance =  11.11 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.044315 s, Result = 555d0000, Performance =  11.15 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.047152 s, Result = 056c0000, Performance =  10.93 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.049423 s, Result = b57b0000, Performance =  10.86 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.052403 s, Result = 658a0000, Performance =  10.65 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.055180 s, Result = 15990000, Performance =  10.51 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.056745 s, Result = c5a80000, Performance =  10.60 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.059151 s, Result = 75b70000, Performance =  10.53 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.062292 s, Result = 25c60000, Performance =  10.34 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.064302 s, Result = d5d50000, Performance =  10.35 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.066866 s, Result = 85e40000, Performance =  10.28 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.066967 s, Result = 35f30000, Performance =  10.58 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.067893 s, Result = e6020000, Performance =  10.75 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.070866 s, Result = 96110000, Performance =  10.61 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.073075 s, Result = 46200000, Performance =  10.58 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.076680 s, Result = f62f0000, Performance =  10.36 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.081957 s, Result = a63e0000, Performance =   9.96 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.085938 s, Result = 564d0000, Performance =   9.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.087711 s, Result = 065c0000, Performance =   9.79 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.090957 s, Result = b66b0000, Performance =   9.68 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.092423 s, Result = 667a0000, Performance =   9.76 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.094898 s, Result = 16890000, Performance =   9.73 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.096647 s, Result = c6980000, Performance =   9.78 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.099575 s, Result = 76a70000, Performance =   9.70 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.102438 s, Result = 26b60000, Performance =   9.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.105135 s, Result = d6c50000, Performance =   9.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.105824 s, Result = 86d40000, Performance =   9.74 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.108711 s, Result = 36e30000, Performance =   9.68 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.110667 s, Result = e6f20000, Performance =   9.70 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.112815 s, Result = 97010000, Performance =   9.71 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.113919 s, Result = 47100000, Performance =   9.80 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.116216 s, Result = f71f0000, Performance =   9.79 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.117684 s, Result = a72e0000, Performance =   9.85 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.119053 s, Result = 573d0000, Performance =   9.92 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.119617 s, Result = 074c0000, Performance =  10.05 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.122884 s, Result = b75b0000, Performance =   9.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.125742 s, Result = 676a0000, Performance =   9.91 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.125750 s, Result = 17790000, Performance =  10.08 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.130855 s, Result = c7880000, Performance =   9.85 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.129620 s, Result = 77970000, Performance =  10.11 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.128994 s, Result = 27a60000, Performance =  10.32 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.132397 s, Result = d7b50000, Performance =  10.22 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.186755 s, Result = 87c40000, Performance =   7.36 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1348  1537  1792
Test passed: M N K =  1676  1660  1344
Test passed: M N K =  1044   783   320
Test passed: M N K =  1610   126  1856
Test passed: M N K =  1402   416   576
M N K =  2048  2048   256, Elapsed time =   0.007546 s, Result = 000f0000, Performance =   2.85 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004716 s, Result = 001e0000, Performance =   9.11 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007424 s, Result = 002d0000, Performance =   8.68 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008493 s, Result = 003c0000, Performance =  10.11 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009680 s, Result = 004b0000, Performance =  11.09 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010738 s, Result = 005a0000, Performance =  12.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011994 s, Result = 00690000, Performance =  12.53 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013385 s, Result = 00780000, Performance =  12.83 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015345 s, Result = 00870000, Performance =  12.60 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016522 s, Result = 00960000, Performance =  13.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018219 s, Result = 00a50000, Performance =  12.97 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019687 s, Result = 00b40000, Performance =  13.09 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021338 s, Result = 00c30000, Performance =  13.08 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023284 s, Result = 00d20000, Performance =  12.91 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.024969 s, Result = 00e10000, Performance =  12.90 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026070 s, Result = 00f00000, Performance =  13.18 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028460 s, Result = 00ff0000, Performance =  12.83 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029969 s, Result = 010e0000, Performance =  12.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031541 s, Result = 011d0000, Performance =  12.94 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.033665 s, Result = 012c0000, Performance =  12.76 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.035759 s, Result = 013b0000, Performance =  12.61 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.037383 s, Result = 014a0000, Performance =  12.64 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.039927 s, Result = 01590000, Performance =  12.37 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.041543 s, Result = 01680000, Performance =  12.41 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.043906 s, Result = 01770000, Performance =  12.23 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.045926 s, Result = 01860000, Performance =  12.16 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.048472 s, Result = 01950000, Performance =  11.96 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.051567 s, Result = 01a40000, Performance =  11.66 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.053590 s, Result = 01b30000, Performance =  11.62 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.056063 s, Result = 01c20000, Performance =  11.49 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.058510 s, Result = 01d10000, Performance =  11.38 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.061220 s, Result = 01e00000, Performance =  11.23 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.061141 s, Result = 01ef0000, Performance =  11.59 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.062075 s, Result = 01fe0000, Performance =  11.76 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.064804 s, Result = 020d0000, Performance =  11.60 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.066540 s, Result = 021c0000, Performance =  11.62 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.069144 s, Result = 022b0000, Performance =  11.49 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.071669 s, Result = 023a0000, Performance =  11.39 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.074542 s, Result = 02490000, Performance =  11.24 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.076427 s, Result = 02580000, Performance =  11.24 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.079144 s, Result = 02670000, Performance =  11.12 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.080423 s, Result = 02760000, Performance =  11.21 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.084126 s, Result = 02850000, Performance =  10.98 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.085184 s, Result = 02940000, Performance =  11.09 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.089366 s, Result = 02a30000, Performance =  10.81 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.091838 s, Result = 02b20000, Performance =  10.76 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.094971 s, Result = 02c10000, Performance =  10.63 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.096595 s, Result = 02d00000, Performance =  10.67 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.099815 s, Result = 02df0000, Performance =  10.54 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.101652 s, Result = 02ee0000, Performance =  10.56 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.104382 s, Result = 02fd0000, Performance =  10.49 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.105721 s, Result = 030c0000, Performance =  10.56 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.108367 s, Result = 031b0000, Performance =  10.50 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.109974 s, Result = 032a0000, Performance =  10.54 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.112492 s, Result = 03390000, Performance =  10.50 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.113816 s, Result = 03480000, Performance =  10.57 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.115982 s, Result = 03570000, Performance =  10.55 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.118666 s, Result = 03660000, Performance =  10.50 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.119163 s, Result = 03750000, Performance =  10.63 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.124590 s, Result = 03840000, Performance =  10.34 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.122015 s, Result = 03930000, Performance =  10.74 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.121610 s, Result = 03a20000, Performance =  10.95 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.125797 s, Result = 03b10000, Performance =  10.75 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.177216 s, Result = 03c00000, Performance =   7.76 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   440  1313  1920
Test passed: M N K =   699   698  1664
Test passed: M N K =  1031  1312   256
Test passed: M N K =  1087  1961   960
Test passed: M N K =  1279   472  1088
M N K =  2048  2048   256, Elapsed time =   0.005633 s, Result = 28370000, Performance =   3.81 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006332 s, Result = 28460000, Performance =   6.78 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009884 s, Result = 28550000, Performance =   6.52 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010955 s, Result = 28640000, Performance =   7.84 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012616 s, Result = 28730000, Performance =   8.51 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013423 s, Result = 28820000, Performance =   9.60 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014602 s, Result = 28910000, Performance =  10.29 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.015491 s, Result = 28a00000, Performance =  11.09 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016822 s, Result = 28af0000, Performance =  11.49 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018143 s, Result = 28be0000, Performance =  11.84 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019375 s, Result = 28cd0000, Performance =  12.19 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020418 s, Result = 28dc0000, Performance =  12.62 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021792 s, Result = 28eb0000, Performance =  12.81 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023196 s, Result = 28fa0000, Performance =  12.96 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.024788 s, Result = 29090000, Performance =  13.00 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025933 s, Result = 29180000, Performance =  13.25 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027990 s, Result = 29270000, Performance =  13.04 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029451 s, Result = 29360000, Performance =  13.13 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031100 s, Result = 29450000, Performance =  13.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032400 s, Result = 29540000, Performance =  13.26 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034341 s, Result = 29630000, Performance =  13.13 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.036024 s, Result = 29720000, Performance =  13.11 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038177 s, Result = 29810000, Performance =  12.94 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039363 s, Result = 29900000, Performance =  13.09 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.041439 s, Result = 299f0000, Performance =  12.96 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.044021 s, Result = 29ae0000, Performance =  12.68 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045662 s, Result = 29bd0000, Performance =  12.70 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.048982 s, Result = 29cc0000, Performance =  12.28 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.050489 s, Result = 29db0000, Performance =  12.33 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052966 s, Result = 29ea0000, Performance =  12.16 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054818 s, Result = 29f90000, Performance =  12.14 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.058054 s, Result = 2a080000, Performance =  11.84 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.058330 s, Result = 2a170000, Performance =  12.15 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058298 s, Result = 2a260000, Performance =  12.52 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.060953 s, Result = 2a350000, Performance =  12.33 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.063224 s, Result = 2a440000, Performance =  12.23 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.065717 s, Result = 2a530000, Performance =  12.09 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.068609 s, Result = 2a620000, Performance =  11.89 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.071029 s, Result = 2a710000, Performance =  11.79 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.073452 s, Result = 2a800000, Performance =  11.69 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.075594 s, Result = 2a8f0000, Performance =  11.65 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.082147 s, Result = 2a9e0000, Performance =  10.98 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.086763 s, Result = 2aad0000, Performance =  10.64 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.084162 s, Result = 2abc0000, Performance =  11.23 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.090191 s, Result = 2acb0000, Performance =  10.71 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.089916 s, Result = 2ada0000, Performance =  10.99 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.091024 s, Result = 2ae90000, Performance =  11.09 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.093114 s, Result = 2af80000, Performance =  11.07 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.095568 s, Result = 2b070000, Performance =  11.01 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.098217 s, Result = 2b160000, Performance =  10.93 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.103075 s, Result = 2b250000, Performance =  10.63 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.103680 s, Result = 2b340000, Performance =  10.77 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.105510 s, Result = 2b430000, Performance =  10.79 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.106100 s, Result = 2b520000, Performance =  10.93 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.109118 s, Result = 2b610000, Performance =  10.82 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.110140 s, Result = 2b700000, Performance =  10.92 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.112869 s, Result = 2b7f0000, Performance =  10.85 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.114966 s, Result = 2b8e0000, Performance =  10.83 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.115541 s, Result = 2b9d0000, Performance =  10.97 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.128205 s, Result = 2bac0000, Performance =  10.05 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.119707 s, Result = 2bbb0000, Performance =  10.94 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.120104 s, Result = 2bca0000, Performance =  11.09 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.123060 s, Result = 2bd90000, Performance =  10.99 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.175818 s, Result = 2be80000, Performance =   7.82 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   522   335  1088
Test passed: M N K =  2027   282   640
Test passed: M N K =    12   423   832
Test passed: M N K =  1461   253  1664
Test passed: M N K =   636   457   768
M N K =  2048  2048   256, Elapsed time =   0.001426 s, Result = 000f0000, Performance =  15.06 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002911 s, Result = 001e0000, Performance =  14.76 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004691 s, Result = 002d0000, Performance =  13.73 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006874 s, Result = 003c0000, Performance =  12.50 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006141 s, Result = 004b0000, Performance =  17.49 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008241 s, Result = 005a0000, Performance =  15.63 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009410 s, Result = 00690000, Performance =  15.97 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009031 s, Result = 00780000, Performance =  19.02 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010332 s, Result = 00870000, Performance =  18.71 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011643 s, Result = 00960000, Performance =  18.44 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012728 s, Result = 00a50000, Performance =  18.56 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015375 s, Result = 00b40000, Performance =  16.76 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016650 s, Result = 00c30000, Performance =  16.77 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017246 s, Result = 00d20000, Performance =  17.43 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018658 s, Result = 00e10000, Performance =  17.26 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019914 s, Result = 00f00000, Performance =  17.25 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021952 s, Result = 00ff0000, Performance =  16.63 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.023018 s, Result = 010e0000, Performance =  16.79 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.023233 s, Result = 011d0000, Performance =  17.56 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.026570 s, Result = 012c0000, Performance =  16.16 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.027762 s, Result = 013b0000, Performance =  16.24 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030102 s, Result = 014a0000, Performance =  15.70 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.031884 s, Result = 01590000, Performance =  15.49 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033416 s, Result = 01680000, Performance =  15.42 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.034150 s, Result = 01770000, Performance =  15.72 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037888 s, Result = 01860000, Performance =  14.74 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.039713 s, Result = 01950000, Performance =  14.60 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.041912 s, Result = 01a40000, Performance =  14.35 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.041973 s, Result = 01b30000, Performance =  14.84 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.047085 s, Result = 01c20000, Performance =  13.68 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.048178 s, Result = 01d10000, Performance =  13.82 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.051736 s, Result = 01e00000, Performance =  13.28 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.050768 s, Result = 01ef0000, Performance =  13.96 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.051488 s, Result = 01fe0000, Performance =  14.18 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.053827 s, Result = 020d0000, Performance =  13.96 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.055948 s, Result = 021c0000, Performance =  13.82 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.059245 s, Result = 022b0000, Performance =  13.41 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.061687 s, Result = 023a0000, Performance =  13.23 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.063952 s, Result = 02490000, Performance =  13.10 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.065683 s, Result = 02580000, Performance =  13.08 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.069084 s, Result = 02670000, Performance =  12.74 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.070714 s, Result = 02760000, Performance =  12.75 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.074125 s, Result = 02850000, Performance =  12.46 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.075200 s, Result = 02940000, Performance =  12.57 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.078289 s, Result = 02a30000, Performance =  12.34 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081320 s, Result = 02b20000, Performance =  12.15 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.084151 s, Result = 02c10000, Performance =  11.99 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.086929 s, Result = 02d00000, Performance =  11.86 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.090176 s, Result = 02df0000, Performance =  11.67 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.092145 s, Result = 02ee0000, Performance =  11.65 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.094352 s, Result = 02fd0000, Performance =  11.61 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.097056 s, Result = 030c0000, Performance =  11.51 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.099201 s, Result = 031b0000, Performance =  11.47 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.101626 s, Result = 032a0000, Performance =  11.41 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.103859 s, Result = 03390000, Performance =  11.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.105568 s, Result = 03480000, Performance =  11.39 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.108516 s, Result = 03570000, Performance =  11.28 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.109951 s, Result = 03660000, Performance =  11.33 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.110538 s, Result = 03750000, Performance =  11.46 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.116052 s, Result = 03840000, Performance =  11.10 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.113485 s, Result = 03930000, Performance =  11.54 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.115553 s, Result = 03a20000, Performance =  11.52 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.118730 s, Result = 03b10000, Performance =  11.39 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.166469 s, Result = 03c00000, Performance =   8.26 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    24  1788   640
Test passed: M N K =  1897  1773  1024
Test passed: M N K =  1295  2002  1280
Test passed: M N K =   165   210   896
Test passed: M N K =  1444  1643  1984
M N K =  2048  2048   256, Elapsed time =   0.006079 s, Result = 34130000, Performance =   3.53 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007887 s, Result = e4220000, Performance =   5.45 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010611 s, Result = 94310000, Performance =   6.07 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.012148 s, Result = 44400000, Performance =   7.07 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012359 s, Result = f44f0000, Performance =   8.69 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014021 s, Result = a45e0000, Performance =   9.19 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.017100 s, Result = 546d0000, Performance =   8.79 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.018490 s, Result = 047c0000, Performance =   9.29 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018953 s, Result = b48b0000, Performance =  10.20 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.021635 s, Result = 649a0000, Performance =   9.93 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022830 s, Result = 14a90000, Performance =  10.35 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.024671 s, Result = c4b80000, Performance =  10.45 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.025996 s, Result = 74c70000, Performance =  10.74 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.026868 s, Result = 24d60000, Performance =  11.19 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.029389 s, Result = d4e50000, Performance =  10.96 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.030528 s, Result = 84f40000, Performance =  11.26 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.033190 s, Result = 35030000, Performance =  11.00 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.034486 s, Result = e5120000, Performance =  11.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.036163 s, Result = 95210000, Performance =  11.28 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.037243 s, Result = 45300000, Performance =  11.53 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.039002 s, Result = f53f0000, Performance =  11.56 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.041755 s, Result = a54e0000, Performance =  11.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.043338 s, Result = 555d0000, Performance =  11.40 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.045745 s, Result = 056c0000, Performance =  11.27 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.046135 s, Result = b57b0000, Performance =  11.64 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.049286 s, Result = 658a0000, Performance =  11.33 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.051390 s, Result = 15990000, Performance =  11.28 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.054005 s, Result = c5a80000, Performance =  11.13 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.056123 s, Result = 75b70000, Performance =  11.10 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.058628 s, Result = 25c60000, Performance =  10.99 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.060546 s, Result = d5d50000, Performance =  11.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.063583 s, Result = 85e40000, Performance =  10.81 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.066376 s, Result = 35f30000, Performance =  10.68 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.071164 s, Result = e6020000, Performance =  10.26 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.075093 s, Result = 96110000, Performance =  10.01 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.075117 s, Result = 46200000, Performance =  10.29 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.077649 s, Result = f62f0000, Performance =  10.23 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.079776 s, Result = a63e0000, Performance =  10.23 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.082450 s, Result = 564d0000, Performance =  10.16 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.083484 s, Result = 065c0000, Performance =  10.29 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.085707 s, Result = b66b0000, Performance =  10.27 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.088181 s, Result = 667a0000, Performance =  10.23 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.091176 s, Result = 16890000, Performance =  10.13 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.092327 s, Result = c6980000, Performance =  10.23 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.094749 s, Result = 76a70000, Performance =  10.20 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.097059 s, Result = 26b60000, Performance =  10.18 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.099066 s, Result = d6c50000, Performance =  10.19 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.099829 s, Result = 86d40000, Performance =  10.33 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.102713 s, Result = 36e30000, Performance =  10.24 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.105063 s, Result = e6f20000, Performance =  10.22 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.107292 s, Result = 97010000, Performance =  10.21 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.108349 s, Result = 47100000, Performance =  10.31 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.111503 s, Result = f71f0000, Performance =  10.21 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.112980 s, Result = a72e0000, Performance =  10.26 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.116125 s, Result = 573d0000, Performance =  10.17 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.116872 s, Result = 074c0000, Performance =  10.29 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.118981 s, Result = b75b0000, Performance =  10.29 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.121837 s, Result = 676a0000, Performance =  10.22 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.126249 s, Result = 17790000, Performance =  10.04 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.124434 s, Result = c7880000, Performance =  10.35 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.127786 s, Result = 77970000, Performance =  10.25 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.129758 s, Result = 27a60000, Performance =  10.26 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.127758 s, Result = d7b50000, Performance =  10.59 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.163905 s, Result = 87c40000, Performance =   8.39 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   172   612   896
Test passed: M N K =  1965   268  1984
Test passed: M N K =  1868   716   192
Test passed: M N K =  1905   663   576
Test passed: M N K =   471    44  1472
M N K =  2048  2048   256, Elapsed time =   0.008193 s, Result = 000f0000, Performance =   2.62 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005048 s, Result = 001e0000, Performance =   8.51 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007499 s, Result = 002d0000, Performance =   8.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008038 s, Result = 003c0000, Performance =  10.69 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010101 s, Result = 004b0000, Performance =  10.63 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011952 s, Result = 005a0000, Performance =  10.78 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012672 s, Result = 00690000, Performance =  11.86 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013305 s, Result = 00780000, Performance =  12.91 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016440 s, Result = 00870000, Performance =  11.76 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018101 s, Result = 00960000, Performance =  11.86 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019419 s, Result = 00a50000, Performance =  12.16 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020354 s, Result = 00b40000, Performance =  12.66 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021596 s, Result = 00c30000, Performance =  12.93 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022959 s, Result = 00d20000, Performance =  13.09 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025452 s, Result = 00e10000, Performance =  12.66 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026538 s, Result = 00f00000, Performance =  12.95 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028421 s, Result = 00ff0000, Performance =  12.85 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.030362 s, Result = 010e0000, Performance =  12.73 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031048 s, Result = 011d0000, Performance =  13.14 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.033565 s, Result = 012c0000, Performance =  12.80 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.035258 s, Result = 013b0000, Performance =  12.79 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.037016 s, Result = 014a0000, Performance =  12.76 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038008 s, Result = 01590000, Performance =  13.00 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.040695 s, Result = 01680000, Performance =  12.66 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.042512 s, Result = 01770000, Performance =  12.63 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.044978 s, Result = 01860000, Performance =  12.41 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045880 s, Result = 01950000, Performance =  12.64 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.048177 s, Result = 01a40000, Performance =  12.48 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.050577 s, Result = 01b30000, Performance =  12.31 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052990 s, Result = 01c20000, Performance =  12.16 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054440 s, Result = 01d10000, Performance =  12.23 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.056694 s, Result = 01e00000, Performance =  12.12 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.058275 s, Result = 01ef0000, Performance =  12.16 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.060602 s, Result = 01fe0000, Performance =  12.05 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.061465 s, Result = 020d0000, Performance =  12.23 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.062951 s, Result = 021c0000, Performance =  12.28 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066036 s, Result = 022b0000, Performance =  12.03 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.068562 s, Result = 023a0000, Performance =  11.90 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.070634 s, Result = 02490000, Performance =  11.86 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.071654 s, Result = 02580000, Performance =  11.99 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.074719 s, Result = 02670000, Performance =  11.78 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.076813 s, Result = 02760000, Performance =  11.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.079694 s, Result = 02850000, Performance =  11.59 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.081287 s, Result = 02940000, Performance =  11.62 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.083986 s, Result = 02a30000, Performance =  11.51 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.086992 s, Result = 02b20000, Performance =  11.36 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.088498 s, Result = 02c10000, Performance =  11.40 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.090298 s, Result = 02d00000, Performance =  11.42 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.092667 s, Result = 02df0000, Performance =  11.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.095017 s, Result = 02ee0000, Performance =  11.30 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.098313 s, Result = 02fd0000, Performance =  11.14 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.099948 s, Result = 030c0000, Performance =  11.17 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.103312 s, Result = 031b0000, Performance =  11.02 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.104889 s, Result = 032a0000, Performance =  11.06 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.107822 s, Result = 03390000, Performance =  10.95 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.109303 s, Result = 03480000, Performance =  11.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.111764 s, Result = 03570000, Performance =  10.95 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.113918 s, Result = 03660000, Performance =  10.93 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.118288 s, Result = 03750000, Performance =  10.71 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.115918 s, Result = 03840000, Performance =  11.12 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.119123 s, Result = 03930000, Performance =  11.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.121297 s, Result = 03a20000, Performance =  10.98 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.121557 s, Result = 03b10000, Performance =  11.13 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.155310 s, Result = 03c00000, Performance =   8.85 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1231  1580   640
Test passed: M N K =   393   343   448
Test passed: M N K =   581   469    64
Test passed: M N K =   625   963  1536
Test passed: M N K =  1942  1093   832
M N K =  2048  2048   256, Elapsed time =   0.006750 s, Result = 28370000, Performance =   3.18 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007963 s, Result = 28460000, Performance =   5.39 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010302 s, Result = 28550000, Performance =   6.25 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010415 s, Result = 28640000, Performance =   8.25 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011586 s, Result = 28730000, Performance =   9.27 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012818 s, Result = 28820000, Performance =  10.05 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014076 s, Result = 28910000, Performance =  10.68 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016695 s, Result = 28a00000, Performance =  10.29 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017934 s, Result = 28af0000, Performance =  10.78 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018879 s, Result = 28be0000, Performance =  11.38 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019080 s, Result = 28cd0000, Performance =  12.38 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.021289 s, Result = 28dc0000, Performance =  12.10 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022635 s, Result = 28eb0000, Performance =  12.33 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024232 s, Result = 28fa0000, Performance =  12.41 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025439 s, Result = 29090000, Performance =  12.66 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026462 s, Result = 29180000, Performance =  12.98 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027363 s, Result = 29270000, Performance =  13.34 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029184 s, Result = 29360000, Performance =  13.25 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031096 s, Result = 29450000, Performance =  13.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032635 s, Result = 29540000, Performance =  13.16 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034252 s, Result = 29630000, Performance =  13.17 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035493 s, Result = 29720000, Performance =  13.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.037655 s, Result = 29810000, Performance =  13.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038970 s, Result = 29900000, Performance =  13.23 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040936 s, Result = 299f0000, Performance =  13.11 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042234 s, Result = 29ae0000, Performance =  13.22 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045340 s, Result = 29bd0000, Performance =  12.79 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.046417 s, Result = 29cc0000, Performance =  12.95 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.048671 s, Result = 29db0000, Performance =  12.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.050366 s, Result = 29ea0000, Performance =  12.79 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.052295 s, Result = 29f90000, Performance =  12.73 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.054561 s, Result = 2a080000, Performance =  12.59 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.056399 s, Result = 2a170000, Performance =  12.57 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058519 s, Result = 2a260000, Performance =  12.48 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059575 s, Result = 2a350000, Performance =  12.62 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.061713 s, Result = 2a440000, Performance =  12.53 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.064393 s, Result = 2a530000, Performance =  12.34 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.067370 s, Result = 2a620000, Performance =  12.11 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.068759 s, Result = 2a710000, Performance =  12.18 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.070485 s, Result = 2a800000, Performance =  12.19 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.073314 s, Result = 2a8f0000, Performance =  12.01 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.075810 s, Result = 2a9e0000, Performance =  11.90 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.077666 s, Result = 2aad0000, Performance =  11.89 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.079625 s, Result = 2abc0000, Performance =  11.87 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.082074 s, Result = 2acb0000, Performance =  11.77 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.084670 s, Result = 2ada0000, Performance =  11.67 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.087841 s, Result = 2ae90000, Performance =  11.49 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.088934 s, Result = 2af80000, Performance =  11.59 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.091470 s, Result = 2b070000, Performance =  11.50 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.094182 s, Result = 2b160000, Performance =  11.40 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.096513 s, Result = 2b250000, Performance =  11.35 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.097975 s, Result = 2b340000, Performance =  11.40 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.100964 s, Result = 2b430000, Performance =  11.27 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.102492 s, Result = 2b520000, Performance =  11.31 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.105920 s, Result = 2b610000, Performance =  11.15 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.109355 s, Result = 2b700000, Performance =  11.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.110338 s, Result = 2b7f0000, Performance =  11.09 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.112255 s, Result = 2b8e0000, Performance =  11.10 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.116659 s, Result = 2b9d0000, Performance =  10.86 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.115606 s, Result = 2bac0000, Performance =  11.15 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.117681 s, Result = 2bbb0000, Performance =  11.13 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.119934 s, Result = 2bca0000, Performance =  11.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.121197 s, Result = 2bd90000, Performance =  11.16 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.152417 s, Result = 2be80000, Performance =   9.02 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1774  1380  1280
Test passed: M N K =  1418   462  1536
Test passed: M N K =  1442   476    64
Test passed: M N K =  1219  1069   128
Test passed: M N K =  1916  1210    64
M N K =  2048  2048   256, Elapsed time =   0.001332 s, Result = 000f0000, Performance =  16.12 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002794 s, Result = 001e0000, Performance =  15.37 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004829 s, Result = 002d0000, Performance =  13.34 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006678 s, Result = 003c0000, Performance =  12.86 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006323 s, Result = 004b0000, Performance =  16.98 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006959 s, Result = 005a0000, Performance =  18.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008270 s, Result = 00690000, Performance =  18.18 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009061 s, Result = 00780000, Performance =  18.96 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010326 s, Result = 00870000, Performance =  18.72 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011608 s, Result = 00960000, Performance =  18.50 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012613 s, Result = 00a50000, Performance =  18.73 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015257 s, Result = 00b40000, Performance =  16.89 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016484 s, Result = 00c30000, Performance =  16.94 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017708 s, Result = 00d20000, Performance =  16.98 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017386 s, Result = 00e10000, Performance =  18.53 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019730 s, Result = 00f00000, Performance =  17.42 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021452 s, Result = 00ff0000, Performance =  17.02 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022693 s, Result = 010e0000, Performance =  17.03 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.024038 s, Result = 011d0000, Performance =  16.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.025162 s, Result = 012c0000, Performance =  17.07 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.027082 s, Result = 013b0000, Performance =  16.65 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.028734 s, Result = 014a0000, Performance =  16.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.030304 s, Result = 01590000, Performance =  16.30 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.031767 s, Result = 01680000, Performance =  16.22 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.033570 s, Result = 01770000, Performance =  15.99 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.034377 s, Result = 01860000, Performance =  16.24 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.037282 s, Result = 01950000, Performance =  15.55 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.038683 s, Result = 01a40000, Performance =  15.54 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.040857 s, Result = 01b30000, Performance =  15.24 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.042352 s, Result = 01c20000, Performance =  15.21 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.045632 s, Result = 01d10000, Performance =  14.59 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.046866 s, Result = 01e00000, Performance =  14.66 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.049360 s, Result = 01ef0000, Performance =  14.36 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.050822 s, Result = 01fe0000, Performance =  14.37 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.052259 s, Result = 020d0000, Performance =  14.38 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.053323 s, Result = 021c0000, Performance =  14.50 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.055870 s, Result = 022b0000, Performance =  14.22 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.054113 s, Result = 023a0000, Performance =  15.08 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.060382 s, Result = 02490000, Performance =  13.87 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.060812 s, Result = 02580000, Performance =  14.13 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064963 s, Result = 02670000, Performance =  13.55 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.071993 s, Result = 02760000, Performance =  12.53 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.075238 s, Result = 02850000, Performance =  12.27 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.076039 s, Result = 02940000, Performance =  12.43 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.079905 s, Result = 02a30000, Performance =  12.09 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.079388 s, Result = 02b20000, Performance =  12.44 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.080222 s, Result = 02c10000, Performance =  12.58 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.085302 s, Result = 02d00000, Performance =  12.08 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.088781 s, Result = 02df0000, Performance =  11.85 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.090790 s, Result = 02ee0000, Performance =  11.83 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.093760 s, Result = 02fd0000, Performance =  11.68 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.094221 s, Result = 030c0000, Performance =  11.85 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.098326 s, Result = 031b0000, Performance =  11.58 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.099641 s, Result = 032a0000, Performance =  11.64 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.101980 s, Result = 03390000, Performance =  11.58 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.103348 s, Result = 03480000, Performance =  11.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.106506 s, Result = 03570000, Performance =  11.49 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.107916 s, Result = 03660000, Performance =  11.54 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.112091 s, Result = 03750000, Performance =  11.30 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.111132 s, Result = 03840000, Performance =  11.59 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.114041 s, Result = 03930000, Performance =  11.49 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.116339 s, Result = 03a20000, Performance =  11.44 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.114800 s, Result = 03b10000, Performance =  11.79 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.145405 s, Result = 03c00000, Performance =   9.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1812   414  1280
Test passed: M N K =  1210   243   512
Test passed: M N K =  1055   675  1088
Test passed: M N K =   641  1025  1728
Test passed: M N K =  1142  1172  1344
M N K =  2048  2048   256, Elapsed time =   0.005692 s, Result = d4108000, Performance =   3.77 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007013 s, Result = a41d0000, Performance =   6.12 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009957 s, Result = 74298000, Performance =   6.47 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009722 s, Result = 44360000, Performance =   8.84 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011107 s, Result = 14428000, Performance =   9.67 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012369 s, Result = e44f0000, Performance =  10.42 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.014676 s, Result = b45b8000, Performance =  10.24 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014866 s, Result = 84680000, Performance =  11.56 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018482 s, Result = 54748000, Performance =  10.46 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.019896 s, Result = 24810000, Performance =  10.79 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.020713 s, Result = f48d8000, Performance =  11.40 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.022748 s, Result = c49a0000, Performance =  11.33 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.024747 s, Result = 94a68000, Performance =  11.28 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.026278 s, Result = 64b30000, Performance =  11.44 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.027579 s, Result = 34bf8000, Performance =  11.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.028626 s, Result = 04cc0000, Performance =  12.00 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.030424 s, Result = d4d88000, Performance =  12.00 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.032860 s, Result = a4e50000, Performance =  11.76 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.034142 s, Result = 74f18000, Performance =  11.95 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.035979 s, Result = 44fe0000, Performance =  11.94 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.037522 s, Result = 150a8000, Performance =  12.02 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.039895 s, Result = e5170000, Performance =  11.84 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.041730 s, Result = b5238000, Performance =  11.84 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.043664 s, Result = 85300000, Performance =  11.80 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.045170 s, Result = 553c8000, Performance =  11.89 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.048686 s, Result = 25490000, Performance =  11.47 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.050169 s, Result = f5558000, Performance =  11.56 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.053642 s, Result = c5620000, Performance =  11.21 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.054481 s, Result = 956e8000, Performance =  11.43 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.057168 s, Result = 657b0000, Performance =  11.27 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.060472 s, Result = 35878000, Performance =  11.01 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.061522 s, Result = 05940000, Performance =  11.17 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.062770 s, Result = d5a08000, Performance =  11.29 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.064968 s, Result = a5ad0000, Performance =  11.24 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.067830 s, Result = 75b98000, Performance =  11.08 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.070066 s, Result = 45c60000, Performance =  11.03 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.072122 s, Result = 15d28000, Performance =  11.02 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.075084 s, Result = e5df0000, Performance =  10.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.077405 s, Result = b5eb8000, Performance =  10.82 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.079160 s, Result = 85f80000, Performance =  10.85 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.080667 s, Result = 56048000, Performance =  10.91 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.081762 s, Result = 26110000, Performance =  11.03 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.084190 s, Result = f61d8000, Performance =  10.97 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.086413 s, Result = c62a0000, Performance =  10.93 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.089537 s, Result = 96368000, Performance =  10.79 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.091811 s, Result = 66430000, Performance =  10.76 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.093694 s, Result = 364f8000, Performance =  10.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.096957 s, Result = 065c0000, Performance =  10.63 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.098854 s, Result = d6688000, Performance =  10.64 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.099980 s, Result = a6750000, Performance =  10.74 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.104331 s, Result = 76818000, Performance =  10.50 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.106842 s, Result = 468e0000, Performance =  10.45 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.109638 s, Result = 169a8000, Performance =  10.38 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.111432 s, Result = e6a70000, Performance =  10.41 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.113661 s, Result = b6b38000, Performance =  10.39 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.115332 s, Result = 86c00000, Performance =  10.43 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.116604 s, Result = 56cc8000, Performance =  10.50 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.118235 s, Result = 26d90000, Performance =  10.53 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.119331 s, Result = f6e58000, Performance =  10.62 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.120979 s, Result = c6f20000, Performance =  10.65 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.123901 s, Result = 96fe8000, Performance =  10.57 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.124616 s, Result = 670b0000, Performance =  10.68 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.117220 s, Result = 37178000, Performance =  11.54 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.161531 s, Result = 07240000, Performance =   8.51 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1176  1886   960
Test passed: M N K =  1186   183  1664
Test passed: M N K =   687  1592  1472
Test passed: M N K =   865  1724   128
Test passed: M N K =  1098  1776   896
M N K =  2048  2048   256, Elapsed time =   0.005631 s, Result = 000c8000, Performance =   3.81 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004604 s, Result = 00190000, Performance =   9.33 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006343 s, Result = 00258000, Performance =  10.16 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007493 s, Result = 00320000, Performance =  11.46 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008268 s, Result = 003e8000, Performance =  12.99 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010078 s, Result = 004b0000, Performance =  12.79 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011003 s, Result = 00578000, Performance =  13.66 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012048 s, Result = 00640000, Performance =  14.26 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013827 s, Result = 00708000, Performance =  13.98 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017023 s, Result = 007d0000, Performance =  12.62 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018473 s, Result = 00898000, Performance =  12.79 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019707 s, Result = 00960000, Performance =  13.08 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020744 s, Result = 00a28000, Performance =  13.46 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021910 s, Result = 00af0000, Performance =  13.72 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023802 s, Result = 00bb8000, Performance =  13.53 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025823 s, Result = 00c80000, Performance =  13.31 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027287 s, Result = 00d48000, Performance =  13.38 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029252 s, Result = 00e10000, Performance =  13.21 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030725 s, Result = 00ed8000, Performance =  13.28 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032242 s, Result = 00fa0000, Performance =  13.32 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033918 s, Result = 01068000, Performance =  13.30 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035489 s, Result = 01130000, Performance =  13.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.037063 s, Result = 011f8000, Performance =  13.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039234 s, Result = 012c0000, Performance =  13.14 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040873 s, Result = 01388000, Performance =  13.14 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042777 s, Result = 01450000, Performance =  13.05 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.044655 s, Result = 01518000, Performance =  12.98 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.047686 s, Result = 015e0000, Performance =  12.61 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.049415 s, Result = 016a8000, Performance =  12.60 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052258 s, Result = 01770000, Performance =  12.33 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.053618 s, Result = 01838000, Performance =  12.42 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.055573 s, Result = 01900000, Performance =  12.37 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.055678 s, Result = 019c8000, Performance =  12.73 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.057984 s, Result = 01a90000, Performance =  12.59 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059967 s, Result = 01b58000, Performance =  12.53 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.063641 s, Result = 01c20000, Performance =  12.15 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066309 s, Result = 01ce8000, Performance =  11.98 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.069309 s, Result = 01db0000, Performance =  11.77 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.070391 s, Result = 01e78000, Performance =  11.90 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.073012 s, Result = 01f40000, Performance =  11.77 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.074862 s, Result = 02008000, Performance =  11.76 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.076013 s, Result = 020d0000, Performance =  11.87 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.078007 s, Result = 02198000, Performance =  11.84 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.081884 s, Result = 02260000, Performance =  11.54 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.083509 s, Result = 02328000, Performance =  11.57 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.086690 s, Result = 023f0000, Performance =  11.40 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.088463 s, Result = 024b8000, Performance =  11.41 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.091377 s, Result = 02580000, Performance =  11.28 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.092085 s, Result = 02648000, Performance =  11.43 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.094930 s, Result = 02710000, Performance =  11.31 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.097429 s, Result = 027d8000, Performance =  11.24 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.099907 s, Result = 028a0000, Performance =  11.18 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.102661 s, Result = 02968000, Performance =  11.09 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.105847 s, Result = 02a30000, Performance =  10.96 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.107672 s, Result = 02af8000, Performance =  10.97 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.108552 s, Result = 02bc0000, Performance =  11.08 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.110428 s, Result = 02c88000, Performance =  11.08 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.111969 s, Result = 02d50000, Performance =  11.12 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.113066 s, Result = 02e18000, Performance =  11.21 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.114735 s, Result = 02ee0000, Performance =  11.23 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.117908 s, Result = 02fa8000, Performance =  11.11 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.119378 s, Result = 03070000, Performance =  11.15 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.112266 s, Result = 03138000, Performance =  12.05 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.149739 s, Result = 03200000, Performance =   9.18 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   664   540   768
Test passed: M N K =   596   751   128
Test passed: M N K =  1389   391  1472
Test passed: M N K =   388   659   192
Test passed: M N K =  1737  1815  1024
M N K =  2048  2048   256, Elapsed time =   0.005782 s, Result = 28348000, Performance =   3.71 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006742 s, Result = 28410000, Performance =   6.37 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009383 s, Result = 284d8000, Performance =   6.87 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010606 s, Result = 285a0000, Performance =   8.10 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011152 s, Result = 28668000, Performance =   9.63 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011635 s, Result = 28730000, Performance =  11.07 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012636 s, Result = 287f8000, Performance =  11.90 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013708 s, Result = 288c0000, Performance =  12.53 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014922 s, Result = 28988000, Performance =  12.95 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017432 s, Result = 28a50000, Performance =  12.32 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018538 s, Result = 28b18000, Performance =  12.74 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019659 s, Result = 28be0000, Performance =  13.11 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019378 s, Result = 28ca8000, Performance =  14.41 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022013 s, Result = 28d70000, Performance =  13.66 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022112 s, Result = 28e38000, Performance =  14.57 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024044 s, Result = 28f00000, Performance =  14.29 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025521 s, Result = 28fc8000, Performance =  14.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.026604 s, Result = 29090000, Performance =  14.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.028464 s, Result = 29158000, Performance =  14.33 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.029734 s, Result = 29220000, Performance =  14.44 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.031896 s, Result = 292e8000, Performance =  14.14 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.033613 s, Result = 293b0000, Performance =  14.06 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034427 s, Result = 29478000, Performance =  14.35 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035979 s, Result = 29540000, Performance =  14.32 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037282 s, Result = 29608000, Performance =  14.40 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039739 s, Result = 296d0000, Performance =  14.05 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041882 s, Result = 29798000, Performance =  13.84 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.043848 s, Result = 29860000, Performance =  13.71 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.045572 s, Result = 29928000, Performance =  13.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.048561 s, Result = 299f0000, Performance =  13.27 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.049928 s, Result = 29ab8000, Performance =  13.33 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.051947 s, Result = 29b80000, Performance =  13.23 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.053538 s, Result = 29c48000, Performance =  13.24 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.054952 s, Result = 29d10000, Performance =  13.29 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.056472 s, Result = 29dd8000, Performance =  13.31 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.058721 s, Result = 29ea0000, Performance =  13.17 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.062934 s, Result = 29f68000, Performance =  12.63 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.064258 s, Result = 2a030000, Performance =  12.70 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.065802 s, Result = 2a0f8000, Performance =  12.73 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.067938 s, Result = 2a1c0000, Performance =  12.64 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.070615 s, Result = 2a288000, Performance =  12.47 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.070830 s, Result = 2a350000, Performance =  12.73 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.073907 s, Result = 2a418000, Performance =  12.49 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.077598 s, Result = 2a4e0000, Performance =  12.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.079143 s, Result = 2a5a8000, Performance =  12.21 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081870 s, Result = 2a670000, Performance =  12.07 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.083400 s, Result = 2a738000, Performance =  12.10 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.086935 s, Result = 2a800000, Performance =  11.86 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.087692 s, Result = 2a8c8000, Performance =  12.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.089469 s, Result = 2a990000, Performance =  12.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.092427 s, Result = 2aa58000, Performance =  11.85 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.094781 s, Result = 2ab20000, Performance =  11.78 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.097838 s, Result = 2abe8000, Performance =  11.63 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.101512 s, Result = 2acb0000, Performance =  11.42 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.103967 s, Result = 2ad78000, Performance =  11.36 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.105550 s, Result = 2ae40000, Performance =  11.39 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.107177 s, Result = 2af08000, Performance =  11.42 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.109783 s, Result = 2afd0000, Performance =  11.35 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.110925 s, Result = 2b098000, Performance =  11.42 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.112663 s, Result = 2b160000, Performance =  11.44 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.115678 s, Result = 2b228000, Performance =  11.32 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.119072 s, Result = 2b2f0000, Performance =  11.18 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.110248 s, Result = 2b3b8000, Performance =  12.27 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.146775 s, Result = 2b480000, Performance =   9.36 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1112  1278  1792
Test passed: M N K =   485  1080  1984
Test passed: M N K =  1102   394    64
Test passed: M N K =  1039  1746  1600
Test passed: M N K =   534  1614   896
M N K =  2048  2048   256, Elapsed time =   0.000891 s, Result = 000c8000, Performance =  24.11 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001837 s, Result = 00190000, Performance =  23.39 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002978 s, Result = 00258000, Performance =  21.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003813 s, Result = 00320000, Performance =  22.53 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005571 s, Result = 003e8000, Performance =  19.27 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005806 s, Result = 004b0000, Performance =  22.19 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007149 s, Result = 00578000, Performance =  21.03 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008212 s, Result = 00640000, Performance =  20.92 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009343 s, Result = 00708000, Performance =  20.69 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009911 s, Result = 007d0000, Performance =  21.67 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010974 s, Result = 00898000, Performance =  21.53 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011926 s, Result = 00960000, Performance =  21.61 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013208 s, Result = 00a28000, Performance =  21.14 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015054 s, Result = 00af0000, Performance =  19.97 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017091 s, Result = 00bb8000, Performance =  18.85 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017799 s, Result = 00c80000, Performance =  19.30 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019637 s, Result = 00d48000, Performance =  18.59 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019428 s, Result = 00e10000, Performance =  19.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021993 s, Result = 00ed8000, Performance =  18.55 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023441 s, Result = 00fa0000, Performance =  18.32 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025281 s, Result = 01068000, Performance =  17.84 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026354 s, Result = 01130000, Performance =  17.93 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.028932 s, Result = 011f8000, Performance =  17.07 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030141 s, Result = 012c0000, Performance =  17.10 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032080 s, Result = 01388000, Performance =  16.74 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.033490 s, Result = 01450000, Performance =  16.67 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.036224 s, Result = 01518000, Performance =  16.01 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.037735 s, Result = 015e0000, Performance =  15.93 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.039423 s, Result = 016a8000, Performance =  15.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.040709 s, Result = 01770000, Performance =  15.83 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.042975 s, Result = 01838000, Performance =  15.49 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.044505 s, Result = 01900000, Performance =  15.44 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.046873 s, Result = 019c8000, Performance =  15.12 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.049569 s, Result = 01a90000, Performance =  14.73 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051757 s, Result = 01b58000, Performance =  14.52 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.052843 s, Result = 01c20000, Performance =  14.63 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.054948 s, Result = 01ce8000, Performance =  14.46 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.057993 s, Result = 01db0000, Performance =  14.07 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.059693 s, Result = 01e78000, Performance =  14.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.063774 s, Result = 01f40000, Performance =  13.47 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064571 s, Result = 02008000, Performance =  13.64 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.066037 s, Result = 020d0000, Performance =  13.66 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.068917 s, Result = 02198000, Performance =  13.40 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.071256 s, Result = 02260000, Performance =  13.26 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.073616 s, Result = 02328000, Performance =  13.13 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.076269 s, Result = 023f0000, Performance =  12.95 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.077451 s, Result = 024b8000, Performance =  13.03 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.081021 s, Result = 02580000, Performance =  12.72 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.082056 s, Result = 02648000, Performance =  12.82 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.085016 s, Result = 02710000, Performance =  12.63 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.087407 s, Result = 027d8000, Performance =  12.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.089668 s, Result = 028a0000, Performance =  12.45 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.092298 s, Result = 02968000, Performance =  12.33 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.094504 s, Result = 02a30000, Performance =  12.27 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.097668 s, Result = 02af8000, Performance =  12.09 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.099438 s, Result = 02bc0000, Performance =  12.09 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.101628 s, Result = 02c88000, Performance =  12.04 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.103472 s, Result = 02d50000, Performance =  12.04 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.105313 s, Result = 02e18000, Performance =  12.03 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.106533 s, Result = 02ee0000, Performance =  12.09 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.109562 s, Result = 02fa8000, Performance =  11.96 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.113260 s, Result = 03070000, Performance =  11.76 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.104982 s, Result = 03138000, Performance =  12.89 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.139593 s, Result = 03200000, Performance =   9.85 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   655   421  1216
Test passed: M N K =  1135  1310  1024
Test passed: M N K =  1408  1858   832
Test passed: M N K =   177   852  1280
Test passed: M N K =   947   780   192
M N K =  2048  2048   256, Elapsed time =   0.005505 s, Result = d4108000, Performance =   3.90 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006937 s, Result = a41d0000, Performance =   6.19 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010091 s, Result = 74298000, Performance =   6.38 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011144 s, Result = 44360000, Performance =   7.71 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011505 s, Result = 14428000, Performance =   9.33 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012508 s, Result = e44f0000, Performance =  10.30 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013752 s, Result = b45b8000, Performance =  10.93 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014797 s, Result = 84680000, Performance =  11.61 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016999 s, Result = 54748000, Performance =  11.37 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.019237 s, Result = 24810000, Performance =  11.16 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.020458 s, Result = f48d8000, Performance =  11.55 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.022068 s, Result = c49a0000, Performance =  11.68 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.023412 s, Result = 94a68000, Performance =  11.92 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023831 s, Result = 64b30000, Performance =  12.62 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026340 s, Result = 34bf8000, Performance =  12.23 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.027034 s, Result = 04cc0000, Performance =  12.71 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.029533 s, Result = d4d88000, Performance =  12.36 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.031137 s, Result = a4e50000, Performance =  12.41 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.032664 s, Result = 74f18000, Performance =  12.49 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034289 s, Result = 44fe0000, Performance =  12.53 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.035931 s, Result = 150a8000, Performance =  12.55 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.037446 s, Result = e5170000, Performance =  12.62 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038135 s, Result = b5238000, Performance =  12.95 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.041046 s, Result = 85300000, Performance =  12.56 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.042879 s, Result = 553c8000, Performance =  12.52 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.045054 s, Result = 25490000, Performance =  12.39 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.046920 s, Result = f5558000, Performance =  12.36 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.049863 s, Result = c5620000, Performance =  12.06 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051308 s, Result = 956e8000, Performance =  12.14 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.053588 s, Result = 657b0000, Performance =  12.02 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.055013 s, Result = 35878000, Performance =  12.10 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.057021 s, Result = 05940000, Performance =  12.05 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.057860 s, Result = d5a08000, Performance =  12.25 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058925 s, Result = a5ad0000, Performance =  12.39 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.061100 s, Result = 75b98000, Performance =  12.30 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.062907 s, Result = 45c60000, Performance =  12.29 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066089 s, Result = 15d28000, Performance =  12.02 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.068293 s, Result = e5df0000, Performance =  11.95 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.070650 s, Result = b5eb8000, Performance =  11.85 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.071484 s, Result = 85f80000, Performance =  12.02 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.073922 s, Result = 56048000, Performance =  11.91 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.075378 s, Result = 26110000, Performance =  11.97 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.077856 s, Result = f61d8000, Performance =  11.86 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.078586 s, Result = c62a0000, Performance =  12.02 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.082008 s, Result = 96368000, Performance =  11.78 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.084641 s, Result = 66430000, Performance =  11.67 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.086995 s, Result = 364f8000, Performance =  11.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089064 s, Result = 065c0000, Performance =  11.57 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.091569 s, Result = d6688000, Performance =  11.49 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.093708 s, Result = a6750000, Performance =  11.46 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.095251 s, Result = 76818000, Performance =  11.50 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.098036 s, Result = 468e0000, Performance =  11.39 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.099923 s, Result = 169a8000, Performance =  11.39 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.101941 s, Result = e6a70000, Performance =  11.38 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.103929 s, Result = b6b38000, Performance =  11.36 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.105733 s, Result = 86c00000, Performance =  11.37 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.107975 s, Result = 56cc8000, Performance =  11.34 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.112284 s, Result = 26d90000, Performance =  11.09 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.112628 s, Result = f6e58000, Performance =  11.25 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.116688 s, Result = c6f20000, Performance =  11.04 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.114446 s, Result = 96fe8000, Performance =  11.45 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.114665 s, Result = 670b0000, Performance =  11.61 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.120723 s, Result = 37178000, Performance =  11.21 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.171349 s, Result = 07240000, Performance =   8.02 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   905   864   128
Test passed: M N K =  1263  2039  1152
Test passed: M N K =  1740   635   704
Test passed: M N K =  1977  1639  1792
Test passed: M N K =  1875   418   832
M N K =  2048  2048   256, Elapsed time =   0.006118 s, Result = 000c8000, Performance =   3.51 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004403 s, Result = 00190000, Performance =   9.75 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006036 s, Result = 00258000, Performance =  10.67 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008452 s, Result = 00320000, Performance =  10.16 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008364 s, Result = 003e8000, Performance =  12.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010112 s, Result = 004b0000, Performance =  12.74 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010542 s, Result = 00578000, Performance =  14.26 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012157 s, Result = 00640000, Performance =  14.13 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013751 s, Result = 00708000, Performance =  14.06 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014849 s, Result = 007d0000, Performance =  14.46 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016155 s, Result = 00898000, Performance =  14.62 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017935 s, Result = 00960000, Performance =  14.37 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019490 s, Result = 00a28000, Performance =  14.32 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020651 s, Result = 00af0000, Performance =  14.56 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022057 s, Result = 00bb8000, Performance =  14.60 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.023418 s, Result = 00c80000, Performance =  14.67 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025535 s, Result = 00d48000, Performance =  14.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.026526 s, Result = 00e10000, Performance =  14.57 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.028037 s, Result = 00ed8000, Performance =  14.55 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.029771 s, Result = 00fa0000, Performance =  14.43 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.031490 s, Result = 01068000, Performance =  14.32 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.033122 s, Result = 01130000, Performance =  14.26 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034865 s, Result = 011f8000, Performance =  14.17 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035891 s, Result = 012c0000, Performance =  14.36 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.038318 s, Result = 01388000, Performance =  14.01 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039468 s, Result = 01450000, Performance =  14.15 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041847 s, Result = 01518000, Performance =  13.86 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.044028 s, Result = 015e0000, Performance =  13.66 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.045144 s, Result = 016a8000, Performance =  13.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.047301 s, Result = 01770000, Performance =  13.62 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.050085 s, Result = 01838000, Performance =  13.29 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.052482 s, Result = 01900000, Performance =  13.09 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.052710 s, Result = 019c8000, Performance =  13.44 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.052907 s, Result = 01a90000, Performance =  13.80 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.055408 s, Result = 01b58000, Performance =  13.57 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.057476 s, Result = 01c20000, Performance =  13.45 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.058943 s, Result = 01ce8000, Performance =  13.48 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.061641 s, Result = 01db0000, Performance =  13.24 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.063796 s, Result = 01e78000, Performance =  13.13 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.065303 s, Result = 01f40000, Performance =  13.15 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.067305 s, Result = 02008000, Performance =  13.08 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.069167 s, Result = 020d0000, Performance =  13.04 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.071584 s, Result = 02198000, Performance =  12.90 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.072207 s, Result = 02260000, Performance =  13.09 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.082402 s, Result = 02328000, Performance =  11.73 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.078817 s, Result = 023f0000, Performance =  12.53 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.082070 s, Result = 024b8000, Performance =  12.30 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.082637 s, Result = 02580000, Performance =  12.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.085938 s, Result = 02648000, Performance =  12.24 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.087397 s, Result = 02710000, Performance =  12.29 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.090256 s, Result = 027d8000, Performance =  12.13 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.091375 s, Result = 028a0000, Performance =  12.22 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.093762 s, Result = 02968000, Performance =  12.14 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.095120 s, Result = 02a30000, Performance =  12.19 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.097115 s, Result = 02af8000, Performance =  12.16 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.099095 s, Result = 02bc0000, Performance =  12.14 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.101752 s, Result = 02c88000, Performance =  12.03 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.104038 s, Result = 02d50000, Performance =  11.97 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.104577 s, Result = 02e18000, Performance =  12.12 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.109021 s, Result = 02ee0000, Performance =  11.82 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.108856 s, Result = 02fa8000, Performance =  12.03 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.106670 s, Result = 03070000, Performance =  12.48 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.110267 s, Result = 03138000, Performance =  12.27 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.161348 s, Result = 03200000, Performance =   8.52 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   104   744  1152
Test passed: M N K =    92  1678  1152
Test passed: M N K =  1201   258   192
Test passed: M N K =    85  1109   256
Test passed: M N K =  1294  1128  1024
M N K =  2048  2048   256, Elapsed time =   0.006478 s, Result = 28348000, Performance =   3.31 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007385 s, Result = 28410000, Performance =   5.82 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008946 s, Result = 284d8000, Performance =   7.20 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009672 s, Result = 285a0000, Performance =   8.88 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010482 s, Result = 28668000, Performance =  10.24 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011735 s, Result = 28730000, Performance =  10.98 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012842 s, Result = 287f8000, Performance =  11.71 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013649 s, Result = 288c0000, Performance =  12.59 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014753 s, Result = 28988000, Performance =  13.10 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015881 s, Result = 28a50000, Performance =  13.52 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017011 s, Result = 28b18000, Performance =  13.89 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018028 s, Result = 28be0000, Performance =  14.29 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018932 s, Result = 28ca8000, Performance =  14.75 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020287 s, Result = 28d70000, Performance =  14.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.021307 s, Result = 28e38000, Performance =  15.12 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022852 s, Result = 28f00000, Performance =  15.04 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023638 s, Result = 28fc8000, Performance =  15.44 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.024788 s, Result = 29090000, Performance =  15.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.026173 s, Result = 29158000, Performance =  15.59 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.027689 s, Result = 29220000, Performance =  15.51 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.029270 s, Result = 292e8000, Performance =  15.41 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030680 s, Result = 293b0000, Performance =  15.40 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032582 s, Result = 29478000, Performance =  15.16 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.034245 s, Result = 29540000, Performance =  15.05 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.035104 s, Result = 29608000, Performance =  15.29 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037425 s, Result = 296d0000, Performance =  14.92 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.039255 s, Result = 29798000, Performance =  14.77 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.040659 s, Result = 29860000, Performance =  14.79 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.042138 s, Result = 29928000, Performance =  14.78 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.044238 s, Result = 299f0000, Performance =  14.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.045983 s, Result = 29ab8000, Performance =  14.48 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.048291 s, Result = 29b80000, Performance =  14.23 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.048485 s, Result = 29c48000, Performance =  14.62 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048829 s, Result = 29d10000, Performance =  14.95 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051268 s, Result = 29dd8000, Performance =  14.66 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.053700 s, Result = 29ea0000, Performance =  14.40 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.055472 s, Result = 29f68000, Performance =  14.32 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.057693 s, Result = 2a030000, Performance =  14.14 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.059775 s, Result = 2a0f8000, Performance =  14.01 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.061991 s, Result = 2a1c0000, Performance =  13.86 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064472 s, Result = 2a288000, Performance =  13.66 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.064449 s, Result = 2a350000, Performance =  13.99 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.068436 s, Result = 2a418000, Performance =  13.49 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.068675 s, Result = 2a4e0000, Performance =  13.76 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.072502 s, Result = 2a5a8000, Performance =  13.33 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.074355 s, Result = 2a670000, Performance =  13.29 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.077352 s, Result = 2a738000, Performance =  13.05 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.078963 s, Result = 2a800000, Performance =  13.05 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.083388 s, Result = 2a8c8000, Performance =  12.62 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.083590 s, Result = 2a990000, Performance =  12.85 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.086275 s, Result = 2aa58000, Performance =  12.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.088293 s, Result = 2ab20000, Performance =  12.65 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.090155 s, Result = 2abe8000, Performance =  12.62 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.091719 s, Result = 2acb0000, Performance =  12.64 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.093777 s, Result = 2ad78000, Performance =  12.59 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.095816 s, Result = 2ae40000, Performance =  12.55 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.098358 s, Result = 2af08000, Performance =  12.44 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.098900 s, Result = 2afd0000, Performance =  12.59 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.101628 s, Result = 2b098000, Performance =  12.47 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.108611 s, Result = 2b160000, Performance =  11.86 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.107024 s, Result = 2b228000, Performance =  12.24 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.105646 s, Result = 2b2f0000, Performance =  12.60 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.108532 s, Result = 2b3b8000, Performance =  12.47 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.156322 s, Result = 2b480000, Performance =   8.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   184  1216  1536
Test passed: M N K =  1992   456  2048
Test passed: M N K =    80   732  1152
Test passed: M N K =   140  1578   512
Test passed: M N K =  1388   533  1088
M N K =  2048  2048   256, Elapsed time =   0.001177 s, Result = 000c8000, Performance =  18.25 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002545 s, Result = 00190000, Performance =  16.88 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004278 s, Result = 00258000, Performance =  15.06 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005128 s, Result = 00320000, Performance =  16.75 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004834 s, Result = 003e8000, Performance =  22.21 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005849 s, Result = 004b0000, Performance =  22.03 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006685 s, Result = 00578000, Performance =  22.49 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007509 s, Result = 00640000, Performance =  22.88 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008557 s, Result = 00708000, Performance =  22.59 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009581 s, Result = 007d0000, Performance =  22.41 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010680 s, Result = 00898000, Performance =  22.12 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011637 s, Result = 00960000, Performance =  22.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012753 s, Result = 00a28000, Performance =  21.89 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013810 s, Result = 00af0000, Performance =  21.77 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015093 s, Result = 00bb8000, Performance =  21.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015898 s, Result = 00c80000, Performance =  21.61 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017423 s, Result = 00d48000, Performance =  20.95 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018851 s, Result = 00e10000, Performance =  20.51 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020078 s, Result = 00ed8000, Performance =  20.32 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021283 s, Result = 00fa0000, Performance =  20.18 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022617 s, Result = 01068000, Performance =  19.94 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024266 s, Result = 01130000, Performance =  19.47 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025900 s, Result = 011f8000, Performance =  19.07 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027299 s, Result = 012c0000, Performance =  18.88 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029131 s, Result = 01388000, Performance =  18.43 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.030550 s, Result = 01450000, Performance =  18.28 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.032747 s, Result = 01518000, Performance =  17.71 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.034491 s, Result = 015e0000, Performance =  17.43 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.036113 s, Result = 016a8000, Performance =  17.24 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.037789 s, Result = 01770000, Performance =  17.05 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040082 s, Result = 01838000, Performance =  16.61 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.041309 s, Result = 01900000, Performance =  16.64 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.043169 s, Result = 019c8000, Performance =  16.42 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.046325 s, Result = 01a90000, Performance =  15.76 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.053543 s, Result = 01b58000, Performance =  14.04 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.052076 s, Result = 01c20000, Performance =  14.85 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.058817 s, Result = 01ce8000, Performance =  13.51 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058759 s, Result = 01db0000, Performance =  13.89 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061791 s, Result = 01e78000, Performance =  13.55 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.061822 s, Result = 01f40000, Performance =  13.89 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064806 s, Result = 02008000, Performance =  13.59 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.067094 s, Result = 020d0000, Performance =  13.44 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.070359 s, Result = 02198000, Performance =  13.12 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.071487 s, Result = 02260000, Performance =  13.22 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.078641 s, Result = 02328000, Performance =  12.29 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.076368 s, Result = 023f0000, Performance =  12.94 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.078569 s, Result = 024b8000, Performance =  12.85 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.080294 s, Result = 02580000, Performance =  12.84 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.082214 s, Result = 02648000, Performance =  12.80 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.083477 s, Result = 02710000, Performance =  12.86 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.085883 s, Result = 027d8000, Performance =  12.75 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.086828 s, Result = 028a0000, Performance =  12.86 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.089133 s, Result = 02968000, Performance =  12.77 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.090621 s, Result = 02a30000, Performance =  12.80 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.092930 s, Result = 02af8000, Performance =  12.71 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.093673 s, Result = 02bc0000, Performance =  12.84 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.096933 s, Result = 02c88000, Performance =  12.63 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.099596 s, Result = 02d50000, Performance =  12.51 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.098783 s, Result = 02e18000, Performance =  12.83 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.101274 s, Result = 02ee0000, Performance =  12.72 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.103635 s, Result = 02fa8000, Performance =  12.64 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.105245 s, Result = 03070000, Performance =  12.65 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.108199 s, Result = 03138000, Performance =  12.50 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.154138 s, Result = 03200000, Performance =   8.92 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2020    26  1536
Test passed: M N K =  1813   264   256
Test passed: M N K =  1442  1368    64
Test passed: M N K =   112  1841  1600
Test passed: M N K =   423   105   256
M N K =  2048  2048   256, Elapsed time =   0.008748 s, Result = d4108000, Performance =   2.45 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006999 s, Result = a41d0000, Performance =   6.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008785 s, Result = 74298000, Performance =   7.33 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009981 s, Result = 44360000, Performance =   8.61 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011133 s, Result = 14428000, Performance =   9.64 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012498 s, Result = e44f0000, Performance =  10.31 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013575 s, Result = b45b8000, Performance =  11.07 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.015264 s, Result = 84680000, Performance =  11.26 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016801 s, Result = 54748000, Performance =  11.50 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018178 s, Result = 24810000, Performance =  11.81 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019318 s, Result = f48d8000, Performance =  12.23 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020662 s, Result = c49a0000, Performance =  12.47 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022101 s, Result = 94a68000, Performance =  12.63 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023451 s, Result = 64b30000, Performance =  12.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025111 s, Result = 34bf8000, Performance =  12.83 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026068 s, Result = 04cc0000, Performance =  13.18 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027579 s, Result = d4d88000, Performance =  13.24 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029588 s, Result = a4e50000, Performance =  13.06 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030875 s, Result = 74f18000, Performance =  13.22 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032144 s, Result = 44fe0000, Performance =  13.36 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034031 s, Result = 150a8000, Performance =  13.25 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035734 s, Result = e5170000, Performance =  13.22 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.037045 s, Result = b5238000, Performance =  13.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038731 s, Result = 85300000, Performance =  13.31 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040569 s, Result = 553c8000, Performance =  13.23 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042605 s, Result = 25490000, Performance =  13.11 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.044371 s, Result = f5558000, Performance =  13.07 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.045720 s, Result = c5620000, Performance =  13.15 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.048007 s, Result = 956e8000, Performance =  12.97 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.050316 s, Result = 657b0000, Performance =  12.80 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.052031 s, Result = 35878000, Performance =  12.79 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.054378 s, Result = 05940000, Performance =  12.64 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.056544 s, Result = d5a08000, Performance =  12.53 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058533 s, Result = a5ad0000, Performance =  12.47 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.060126 s, Result = 75b98000, Performance =  12.50 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.060486 s, Result = 45c60000, Performance =  12.78 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.062963 s, Result = 15d28000, Performance =  12.62 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.064954 s, Result = e5df0000, Performance =  12.56 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.067677 s, Result = b5eb8000, Performance =  12.38 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.068849 s, Result = 85f80000, Performance =  12.48 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.071448 s, Result = 56048000, Performance =  12.32 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.073307 s, Result = 26110000, Performance =  12.30 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.075160 s, Result = f61d8000, Performance =  12.29 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.076797 s, Result = c62a0000, Performance =  12.30 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.079139 s, Result = 96368000, Performance =  12.21 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081898 s, Result = 66430000, Performance =  12.06 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.084506 s, Result = 364f8000, Performance =  11.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.084997 s, Result = 065c0000, Performance =  12.13 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.088278 s, Result = d6688000, Performance =  11.92 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.090316 s, Result = a6750000, Performance =  11.89 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.091861 s, Result = 76818000, Performance =  11.92 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.092256 s, Result = 468e0000, Performance =  12.10 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.095773 s, Result = 169a8000, Performance =  11.88 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.096845 s, Result = e6a70000, Performance =  11.97 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.100865 s, Result = b6b38000, Performance =  11.71 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.101852 s, Result = 86c00000, Performance =  11.81 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.104039 s, Result = 56cc8000, Performance =  11.77 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.105783 s, Result = 26d90000, Performance =  11.77 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.111207 s, Result = f6e58000, Performance =  11.39 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.109213 s, Result = c6f20000, Performance =  11.80 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.114874 s, Result = 96fe8000, Performance =  11.40 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.123328 s, Result = 670b0000, Performance =  10.80 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.113313 s, Result = 37178000, Performance =  11.94 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.147472 s, Result = 07240000, Performance =   9.32 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1674  1803   128
Test passed: M N K =  1625  1894   960
Test passed: M N K =   743   334  1536
Test passed: M N K =  2003  1873   256
Test passed: M N K =   844   978  1024
M N K =  2048  2048   256, Elapsed time =   0.006543 s, Result = 000c8000, Performance =   3.28 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004278 s, Result = 00190000, Performance =  10.04 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005911 s, Result = 00258000, Performance =  10.90 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006766 s, Result = 00320000, Performance =  12.70 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008267 s, Result = 003e8000, Performance =  12.99 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009254 s, Result = 004b0000, Performance =  13.92 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010482 s, Result = 00578000, Performance =  14.34 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011945 s, Result = 00640000, Performance =  14.38 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013469 s, Result = 00708000, Performance =  14.35 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014659 s, Result = 007d0000, Performance =  14.65 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016370 s, Result = 00898000, Performance =  14.43 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017614 s, Result = 00960000, Performance =  14.63 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019166 s, Result = 00a28000, Performance =  14.57 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020335 s, Result = 00af0000, Performance =  14.78 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.021535 s, Result = 00bb8000, Performance =  14.96 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022598 s, Result = 00c80000, Performance =  15.21 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.024875 s, Result = 00d48000, Performance =  14.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025938 s, Result = 00e10000, Performance =  14.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.027168 s, Result = 00ed8000, Performance =  15.02 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028615 s, Result = 00fa0000, Performance =  15.01 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.030275 s, Result = 01068000, Performance =  14.90 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.031878 s, Result = 01130000, Performance =  14.82 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.033238 s, Result = 011f8000, Performance =  14.86 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.034898 s, Result = 012c0000, Performance =  14.77 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.036595 s, Result = 01388000, Performance =  14.67 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.038703 s, Result = 01450000, Performance =  14.43 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.039584 s, Result = 01518000, Performance =  14.65 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.041862 s, Result = 015e0000, Performance =  14.36 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.042870 s, Result = 016a8000, Performance =  14.53 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.046638 s, Result = 01770000, Performance =  13.81 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.052098 s, Result = 01838000, Performance =  12.78 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.053366 s, Result = 01900000, Performance =  12.88 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.053856 s, Result = 019c8000, Performance =  13.16 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.054704 s, Result = 01a90000, Performance =  13.35 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.056782 s, Result = 01b58000, Performance =  13.24 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.055480 s, Result = 01c20000, Performance =  13.93 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.065260 s, Result = 01ce8000, Performance =  12.18 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.062979 s, Result = 01db0000, Performance =  12.96 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.065848 s, Result = 01e78000, Performance =  12.72 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.064404 s, Result = 01f40000, Performance =  13.34 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.080488 s, Result = 02008000, Performance =  10.94 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.063471 s, Result = 020d0000, Performance =  14.21 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.067927 s, Result = 02198000, Performance =  13.59 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.079963 s, Result = 02260000, Performance =  11.82 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.070565 s, Result = 02328000, Performance =  13.69 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.074472 s, Result = 023f0000, Performance =  13.26 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.075472 s, Result = 024b8000, Performance =  13.37 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.076986 s, Result = 02580000, Performance =  13.39 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.079076 s, Result = 02648000, Performance =  13.31 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.081433 s, Result = 02710000, Performance =  13.19 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.087657 s, Result = 027d8000, Performance =  12.49 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.086083 s, Result = 028a0000, Performance =  12.97 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.091750 s, Result = 02968000, Performance =  12.41 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.089810 s, Result = 02a30000, Performance =  12.91 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.092257 s, Result = 02af8000, Performance =  12.80 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.094154 s, Result = 02bc0000, Performance =  12.77 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.111009 s, Result = 02c88000, Performance =  11.03 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.097696 s, Result = 02d50000, Performance =  12.75 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.103766 s, Result = 02e18000, Performance =  12.21 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.101200 s, Result = 02ee0000, Performance =  12.73 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.103467 s, Result = 02fa8000, Performance =  12.66 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.105426 s, Result = 03070000, Performance =  12.63 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.105478 s, Result = 03138000, Performance =  12.83 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.139615 s, Result = 03200000, Performance =   9.84 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   614  1445   640
Test passed: M N K =  1276   776   192
Test passed: M N K =  1710  1829  1984
Test passed: M N K =  1345  1753  1216
Test passed: M N K =    81   697   704
M N K =  2048  2048   256, Elapsed time =   0.007294 s, Result = 28348000, Performance =   2.94 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007558 s, Result = 28410000, Performance =   5.68 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008294 s, Result = 284d8000, Performance =   7.77 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008972 s, Result = 285a0000, Performance =   9.57 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009895 s, Result = 28668000, Performance =  10.85 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010929 s, Result = 28730000, Performance =  11.79 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011916 s, Result = 287f8000, Performance =  12.62 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012988 s, Result = 288c0000, Performance =  13.23 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014021 s, Result = 28988000, Performance =  13.78 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015033 s, Result = 28a50000, Performance =  14.29 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016223 s, Result = 28b18000, Performance =  14.56 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017433 s, Result = 28be0000, Performance =  14.78 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018440 s, Result = 28ca8000, Performance =  15.14 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019539 s, Result = 28d70000, Performance =  15.39 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020558 s, Result = 28e38000, Performance =  15.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021486 s, Result = 28f00000, Performance =  15.99 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.022974 s, Result = 28fc8000, Performance =  15.89 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.023962 s, Result = 29090000, Performance =  16.13 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.025134 s, Result = 29158000, Performance =  16.23 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.026067 s, Result = 29220000, Performance =  16.48 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.027511 s, Result = 292e8000, Performance =  16.39 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.028938 s, Result = 293b0000, Performance =  16.33 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.030239 s, Result = 29478000, Performance =  16.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.031788 s, Result = 29540000, Performance =  16.21 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.033101 s, Result = 29608000, Performance =  16.22 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.034661 s, Result = 296d0000, Performance =  16.11 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.036256 s, Result = 29798000, Performance =  15.99 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.037228 s, Result = 29860000, Performance =  16.15 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.039100 s, Result = 29928000, Performance =  15.93 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.040460 s, Result = 299f0000, Performance =  15.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.042698 s, Result = 29ab8000, Performance =  15.59 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043796 s, Result = 29b80000, Performance =  15.69 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.046270 s, Result = 29c48000, Performance =  15.32 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.047427 s, Result = 29d10000, Performance =  15.40 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.048627 s, Result = 29dd8000, Performance =  15.46 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.049222 s, Result = 29ea0000, Performance =  15.71 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.051873 s, Result = 29f68000, Performance =  15.32 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.053608 s, Result = 2a030000, Performance =  15.22 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.056090 s, Result = 2a0f8000, Performance =  14.93 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.057123 s, Result = 2a1c0000, Performance =  15.04 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.059727 s, Result = 2a288000, Performance =  14.74 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.060964 s, Result = 2a350000, Performance =  14.79 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.063523 s, Result = 2a418000, Performance =  14.54 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.064696 s, Result = 2a4e0000, Performance =  14.61 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.067529 s, Result = 2a5a8000, Performance =  14.31 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.070991 s, Result = 2a670000, Performance =  13.92 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.071909 s, Result = 2a738000, Performance =  14.04 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.074741 s, Result = 2a800000, Performance =  13.79 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.076748 s, Result = 2a8c8000, Performance =  13.71 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.086520 s, Result = 2a990000, Performance =  12.41 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.084922 s, Result = 2aa58000, Performance =  12.90 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.083205 s, Result = 2ab20000, Performance =  13.42 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.085889 s, Result = 2abe8000, Performance =  13.25 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.087020 s, Result = 2acb0000, Performance =  13.33 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.089826 s, Result = 2ad78000, Performance =  13.15 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.091911 s, Result = 2ae40000, Performance =  13.08 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.094551 s, Result = 2af08000, Performance =  12.95 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.096555 s, Result = 2afd0000, Performance =  12.90 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.100141 s, Result = 2b098000, Performance =  12.65 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.100866 s, Result = 2b160000, Performance =  12.77 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.101540 s, Result = 2b228000, Performance =  12.90 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.104941 s, Result = 2b2f0000, Performance =  12.69 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.105536 s, Result = 2b3b8000, Performance =  12.82 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.137544 s, Result = 2b480000, Performance =   9.99 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   915   540   960
Test passed: M N K =  1457  1712  1088
Test passed: M N K =  1766  1250   320
Test passed: M N K =   659  1747   192
Test passed: M N K =   273   865   256
M N K =  2048  2048   256, Elapsed time =   0.001246 s, Result = 000c8000, Performance =  17.24 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002573 s, Result = 00190000, Performance =  16.69 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003786 s, Result = 00258000, Performance =  17.02 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004980 s, Result = 00320000, Performance =  17.25 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005840 s, Result = 003e8000, Performance =  18.39 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005624 s, Result = 004b0000, Performance =  22.91 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.006576 s, Result = 00578000, Performance =  22.86 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007429 s, Result = 00640000, Performance =  23.12 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008393 s, Result = 00708000, Performance =  23.03 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.009341 s, Result = 007d0000, Performance =  22.99 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.010305 s, Result = 00898000, Performance =  22.92 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011238 s, Result = 00960000, Performance =  22.93 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012253 s, Result = 00a28000, Performance =  22.78 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013234 s, Result = 00af0000, Performance =  22.72 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014207 s, Result = 00bb8000, Performance =  22.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015048 s, Result = 00c80000, Performance =  22.83 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016386 s, Result = 00d48000, Performance =  22.28 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017775 s, Result = 00e10000, Performance =  21.75 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018708 s, Result = 00ed8000, Performance =  21.81 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019741 s, Result = 00fa0000, Performance =  21.76 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020962 s, Result = 01068000, Performance =  21.51 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024309 s, Result = 01130000, Performance =  19.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027668 s, Result = 011f8000, Performance =  17.85 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027483 s, Result = 012c0000, Performance =  18.75 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026497 s, Result = 01388000, Performance =  20.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028011 s, Result = 01450000, Performance =  19.93 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029427 s, Result = 01518000, Performance =  19.70 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.030568 s, Result = 015e0000, Performance =  19.67 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.032090 s, Result = 016a8000, Performance =  19.41 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.033930 s, Result = 01770000, Performance =  18.99 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035549 s, Result = 01838000, Performance =  18.73 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038115 s, Result = 01900000, Performance =  18.03 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.038382 s, Result = 019c8000, Performance =  18.46 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.039970 s, Result = 01a90000, Performance =  18.27 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.041298 s, Result = 01b58000, Performance =  18.20 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.041817 s, Result = 01c20000, Performance =  18.49 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.044458 s, Result = 01ce8000, Performance =  17.87 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.045716 s, Result = 01db0000, Performance =  17.85 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.047694 s, Result = 01e78000, Performance =  17.56 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.049172 s, Result = 01f40000, Performance =  17.47 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.051724 s, Result = 02008000, Performance =  17.02 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.066820 s, Result = 020d0000, Performance =  13.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.065240 s, Result = 02198000, Performance =  14.15 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.062451 s, Result = 02260000, Performance =  15.13 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.061806 s, Result = 02328000, Performance =  15.64 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081725 s, Result = 023f0000, Performance =  12.09 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.067114 s, Result = 024b8000, Performance =  15.04 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.067078 s, Result = 02580000, Performance =  15.37 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.084957 s, Result = 02648000, Performance =  12.39 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.073923 s, Result = 02710000, Performance =  14.53 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.074579 s, Result = 027d8000, Performance =  14.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.091721 s, Result = 028a0000, Performance =  12.17 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.078933 s, Result = 02968000, Performance =  14.42 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.081774 s, Result = 02a30000, Performance =  14.18 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.083249 s, Result = 02af8000, Performance =  14.19 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.097596 s, Result = 02bc0000, Performance =  12.32 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.093502 s, Result = 02c88000, Performance =  13.09 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.095363 s, Result = 02d50000, Performance =  13.06 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.095833 s, Result = 02e18000, Performance =  13.22 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.094508 s, Result = 02ee0000, Performance =  13.63 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.095596 s, Result = 02fa8000, Performance =  13.70 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.100893 s, Result = 03070000, Performance =  13.20 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.103697 s, Result = 03138000, Performance =  13.05 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.135302 s, Result = 03200000, Performance =  10.16 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1826   619    64
Test passed: M N K =  1829  1049  1728
Test passed: M N K =    34   719  1344
Test passed: M N K =   748  1485   256
Test passed: M N K =  1577  1853   448
M N K =  2048  2048   256, Elapsed time =   0.009359 s, Result = 34130000, Performance =   2.29 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008067 s, Result = e4220000, Performance =   5.32 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009098 s, Result = 94310000, Performance =   7.08 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010582 s, Result = 44400000, Performance =   8.12 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.013490 s, Result = f44f0000, Performance =   7.96 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014984 s, Result = a45e0000, Performance =   8.60 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.017644 s, Result = 546d0000, Performance =   8.52 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.018138 s, Result = 047c0000, Performance =   9.47 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018430 s, Result = b48b0000, Performance =  10.49 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.020302 s, Result = 649a0000, Performance =  10.58 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022175 s, Result = 14a90000, Performance =  10.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.024188 s, Result = c4b80000, Performance =  10.65 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.028238 s, Result = 74c70000, Performance =   9.89 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.033805 s, Result = 24d60000, Performance =   8.89 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.035647 s, Result = d4e50000, Performance =   9.04 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.035479 s, Result = 84f40000, Performance =   9.68 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.037275 s, Result = 35030000, Performance =   9.79 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.036697 s, Result = e5120000, Performance =  10.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.040357 s, Result = 95210000, Performance =  10.11 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.041432 s, Result = 45300000, Performance =  10.37 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.043649 s, Result = f53f0000, Performance =  10.33 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.049217 s, Result = a54e0000, Performance =   9.60 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.053499 s, Result = 555d0000, Performance =   9.23 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.055683 s, Result = 056c0000, Performance =   9.26 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.058492 s, Result = b57b0000, Performance =   9.18 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.060622 s, Result = 658a0000, Performance =   9.21 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.062990 s, Result = 15990000, Performance =   9.21 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.065039 s, Result = c5a80000, Performance =   9.25 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.066815 s, Result = 75b70000, Performance =   9.32 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.069306 s, Result = 25c60000, Performance =   9.30 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.071127 s, Result = d5d50000, Performance =   9.36 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.073864 s, Result = 85e40000, Performance =   9.30 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.073337 s, Result = 35f30000, Performance =   9.66 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.075978 s, Result = e6020000, Performance =   9.61 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.078251 s, Result = 96110000, Performance =   9.61 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.079995 s, Result = 46200000, Performance =   9.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.082251 s, Result = f62f0000, Performance =   9.66 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.085776 s, Result = a63e0000, Performance =   9.51 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.086061 s, Result = 564d0000, Performance =   9.73 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.089159 s, Result = 065c0000, Performance =   9.63 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.090334 s, Result = b66b0000, Performance =   9.75 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.091508 s, Result = 667a0000, Performance =   9.86 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.093521 s, Result = 16890000, Performance =   9.87 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.096493 s, Result = c6980000, Performance =   9.79 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.102187 s, Result = 76a70000, Performance =   9.46 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.101230 s, Result = 26b60000, Performance =   9.76 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.105245 s, Result = d6c50000, Performance =   9.59 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.109821 s, Result = 86d40000, Performance =   9.39 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.108190 s, Result = 36e30000, Performance =   9.73 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.111507 s, Result = e6f20000, Performance =   9.63 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.113883 s, Result = 97010000, Performance =   9.62 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.116810 s, Result = 47100000, Performance =   9.56 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.116731 s, Result = f71f0000, Performance =   9.75 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.119051 s, Result = a72e0000, Performance =   9.74 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.123818 s, Result = 573d0000, Performance =   9.54 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.124689 s, Result = 074c0000, Performance =   9.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.128035 s, Result = b75b0000, Performance =   9.56 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.125406 s, Result = 676a0000, Performance =   9.93 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.130273 s, Result = 17790000, Performance =   9.73 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.132329 s, Result = c7880000, Performance =   9.74 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.130877 s, Result = 77970000, Performance =  10.01 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.132845 s, Result = 27a60000, Performance =  10.02 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.135552 s, Result = d7b50000, Performance =   9.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.157535 s, Result = 87c40000, Performance =   8.72 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   718   155  1408
Test passed: M N K =  1401  1034  1216
Test passed: M N K =  2018   602  1152
Test passed: M N K =  1787  1079  1600
Test passed: M N K =   246   279  1600
M N K =  2048  2048   256, Elapsed time =   0.008616 s, Result = 000f0000, Performance =   2.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006388 s, Result = 001e0000, Performance =   6.72 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006062 s, Result = 002d0000, Performance =  10.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006953 s, Result = 003c0000, Performance =  12.35 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008165 s, Result = 004b0000, Performance =  13.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009284 s, Result = 005a0000, Performance =  13.88 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010579 s, Result = 00690000, Performance =  14.21 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011905 s, Result = 00780000, Performance =  14.43 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013419 s, Result = 00870000, Performance =  14.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014866 s, Result = 00960000, Performance =  14.45 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016467 s, Result = 00a50000, Performance =  14.35 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018172 s, Result = 00b40000, Performance =  14.18 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019908 s, Result = 00c30000, Performance =  14.02 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024784 s, Result = 00d20000, Performance =  12.13 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023879 s, Result = 00e10000, Performance =  13.49 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025617 s, Result = 00f00000, Performance =  13.41 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.029735 s, Result = 00ff0000, Performance =  12.28 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029981 s, Result = 010e0000, Performance =  12.89 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031911 s, Result = 011d0000, Performance =  12.79 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034113 s, Result = 012c0000, Performance =  12.59 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.036107 s, Result = 013b0000, Performance =  12.49 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.038443 s, Result = 014a0000, Performance =  12.29 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.044795 s, Result = 01590000, Performance =  11.03 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.043368 s, Result = 01680000, Performance =  11.88 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.045989 s, Result = 01770000, Performance =  11.67 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.050786 s, Result = 01860000, Performance =  10.99 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.051171 s, Result = 01950000, Performance =  11.33 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.054787 s, Result = 01a40000, Performance =  10.98 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.056588 s, Result = 01b30000, Performance =  11.01 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.059516 s, Result = 01c20000, Performance =  10.82 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.059883 s, Result = 01d10000, Performance =  11.12 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.062917 s, Result = 01e00000, Performance =  10.92 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.062378 s, Result = 01ef0000, Performance =  11.36 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.064655 s, Result = 01fe0000, Performance =  11.29 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.067097 s, Result = 020d0000, Performance =  11.20 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.069089 s, Result = 021c0000, Performance =  11.19 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.072878 s, Result = 022b0000, Performance =  10.90 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.074546 s, Result = 023a0000, Performance =  10.95 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.078109 s, Result = 02490000, Performance =  10.72 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.082079 s, Result = 02580000, Performance =  10.47 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.084037 s, Result = 02670000, Performance =  10.48 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.086886 s, Result = 02760000, Performance =  10.38 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.087651 s, Result = 02850000, Performance =  10.54 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.091216 s, Result = 02940000, Performance =  10.36 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.093639 s, Result = 02a30000, Performance =  10.32 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.100011 s, Result = 02b20000, Performance =   9.88 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.097885 s, Result = 02c10000, Performance =  10.31 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.100227 s, Result = 02d00000, Performance =  10.28 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.101696 s, Result = 02df0000, Performance =  10.35 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.104373 s, Result = 02ee0000, Performance =  10.29 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.107230 s, Result = 02fd0000, Performance =  10.21 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.108669 s, Result = 030c0000, Performance =  10.28 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.111258 s, Result = 031b0000, Performance =  10.23 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.113382 s, Result = 032a0000, Performance =  10.23 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.114288 s, Result = 03390000, Performance =  10.33 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.115861 s, Result = 03480000, Performance =  10.38 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.119970 s, Result = 03570000, Performance =  10.20 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.120931 s, Result = 03660000, Performance =  10.30 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.121089 s, Result = 03750000, Performance =  10.46 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.122281 s, Result = 03840000, Performance =  10.54 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.124924 s, Result = 03930000, Performance =  10.49 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.125213 s, Result = 03a20000, Performance =  10.63 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.126764 s, Result = 03b10000, Performance =  10.67 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.152406 s, Result = 03c00000, Performance =   9.02 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1454  1964   704
Test passed: M N K =   362  1885  1984
Test passed: M N K =  1394  1021   512
Test passed: M N K =  1248   387  1600
Test passed: M N K =   148   357  1536
M N K =  2048  2048   256, Elapsed time =   0.011101 s, Result = 28370000, Performance =   1.93 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009319 s, Result = 28460000, Performance =   4.61 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008640 s, Result = 28550000, Performance =   7.46 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010546 s, Result = 28640000, Performance =   8.15 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010965 s, Result = 28730000, Performance =   9.79 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011710 s, Result = 28820000, Performance =  11.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013721 s, Result = 28910000, Performance =  10.96 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014079 s, Result = 28a00000, Performance =  12.20 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015369 s, Result = 28af0000, Performance =  12.58 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016642 s, Result = 28be0000, Performance =  12.90 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018028 s, Result = 28cd0000, Performance =  13.10 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019631 s, Result = 28dc0000, Performance =  13.13 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021319 s, Result = 28eb0000, Performance =  13.09 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023677 s, Result = 28fa0000, Performance =  12.70 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.029040 s, Result = 29090000, Performance =  11.09 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.028718 s, Result = 29180000, Performance =  11.96 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028020 s, Result = 29270000, Performance =  13.03 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.030255 s, Result = 29360000, Performance =  12.78 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.031875 s, Result = 29450000, Performance =  12.80 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034138 s, Result = 29540000, Performance =  12.58 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.035902 s, Result = 29630000, Performance =  12.56 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.038274 s, Result = 29720000, Performance =  12.34 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.042577 s, Result = 29810000, Performance =  11.60 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.042433 s, Result = 29900000, Performance =  12.15 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.044843 s, Result = 299f0000, Performance =  11.97 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.047220 s, Result = 29ae0000, Performance =  11.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.049512 s, Result = 29bd0000, Performance =  11.71 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.052140 s, Result = 29cc0000, Performance =  11.53 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.054022 s, Result = 29db0000, Performance =  11.53 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.056429 s, Result = 29ea0000, Performance =  11.42 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.058564 s, Result = 29f90000, Performance =  11.37 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.060109 s, Result = 2a080000, Performance =  11.43 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.060638 s, Result = 2a170000, Performance =  11.69 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.062798 s, Result = 2a260000, Performance =  11.63 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.065179 s, Result = 2a350000, Performance =  11.53 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.068864 s, Result = 2a440000, Performance =  11.23 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.073562 s, Result = 2a530000, Performance =  10.80 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.076117 s, Result = 2a620000, Performance =  10.72 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.079554 s, Result = 2a710000, Performance =  10.53 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.082479 s, Result = 2a800000, Performance =  10.41 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.083957 s, Result = 2a8f0000, Performance =  10.49 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.085820 s, Result = 2a9e0000, Performance =  10.51 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.087152 s, Result = 2aad0000, Performance =  10.60 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.089913 s, Result = 2abc0000, Performance =  10.51 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.092934 s, Result = 2acb0000, Performance =  10.40 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.095300 s, Result = 2ada0000, Performance =  10.37 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.096370 s, Result = 2ae90000, Performance =  10.47 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.099306 s, Result = 2af80000, Performance =  10.38 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.099844 s, Result = 2b070000, Performance =  10.54 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.102609 s, Result = 2b160000, Performance =  10.46 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.106181 s, Result = 2b250000, Performance =  10.31 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.113781 s, Result = 2b340000, Performance =   9.81 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.121054 s, Result = 2b430000, Performance =   9.40 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.118269 s, Result = 2b520000, Performance =   9.81 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.119240 s, Result = 2b610000, Performance =   9.91 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.116022 s, Result = 2b700000, Performance =  10.37 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.116711 s, Result = 2b7f0000, Performance =  10.49 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.118578 s, Result = 2b8e0000, Performance =  10.50 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.119792 s, Result = 2b9d0000, Performance =  10.58 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.121878 s, Result = 2bac0000, Performance =  10.57 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.124012 s, Result = 2bbb0000, Performance =  10.56 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.126097 s, Result = 2bca0000, Performance =  10.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.126597 s, Result = 2bd90000, Performance =  10.69 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.150350 s, Result = 2be80000, Performance =   9.14 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1908   592  1728
Test passed: M N K =   351  1434  1984
Test passed: M N K =  1291  1782  1536
Test passed: M N K =    10   861  1024
Test passed: M N K =   244   102  1984
M N K =  2048  2048   256, Elapsed time =   0.001419 s, Result = 000f0000, Performance =  15.13 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002916 s, Result = 001e0000, Performance =  14.73 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003733 s, Result = 002d0000, Performance =  17.26 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004453 s, Result = 003c0000, Performance =  19.29 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005514 s, Result = 004b0000, Performance =  19.47 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006638 s, Result = 005a0000, Performance =  19.41 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007740 s, Result = 00690000, Performance =  19.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008941 s, Result = 00780000, Performance =  19.21 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010548 s, Result = 00870000, Performance =  18.32 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011926 s, Result = 00960000, Performance =  18.01 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012796 s, Result = 00a50000, Performance =  18.46 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013478 s, Result = 00b40000, Performance =  19.12 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014598 s, Result = 00c30000, Performance =  19.12 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015867 s, Result = 00d20000, Performance =  18.95 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017111 s, Result = 00e10000, Performance =  18.83 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018764 s, Result = 00f00000, Performance =  18.31 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.024033 s, Result = 00ff0000, Performance =  15.19 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.023263 s, Result = 010e0000, Performance =  16.62 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022997 s, Result = 011d0000, Performance =  17.74 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.025333 s, Result = 012c0000, Performance =  16.95 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.026739 s, Result = 013b0000, Performance =  16.87 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.028755 s, Result = 014a0000, Performance =  16.43 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.039602 s, Result = 01590000, Performance =  12.47 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039140 s, Result = 01680000, Performance =  13.17 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.035189 s, Result = 01770000, Performance =  15.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037850 s, Result = 01860000, Performance =  14.75 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.040209 s, Result = 01950000, Performance =  14.42 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.042735 s, Result = 01a40000, Performance =  14.07 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.045710 s, Result = 01b30000, Performance =  13.62 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.048000 s, Result = 01c20000, Performance =  13.42 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.050613 s, Result = 01d10000, Performance =  13.15 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.051001 s, Result = 01e00000, Performance =  13.47 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.052584 s, Result = 01ef0000, Performance =  13.48 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.054524 s, Result = 01fe0000, Performance =  13.39 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.056717 s, Result = 020d0000, Performance =  13.25 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.059124 s, Result = 021c0000, Performance =  13.08 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.061157 s, Result = 022b0000, Performance =  12.99 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.063024 s, Result = 023a0000, Performance =  12.95 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.064841 s, Result = 02490000, Performance =  12.92 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.066815 s, Result = 02580000, Performance =  12.86 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.069006 s, Result = 02670000, Performance =  12.76 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.074832 s, Result = 02760000, Performance =  12.05 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.079792 s, Result = 02850000, Performance =  11.57 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.083222 s, Result = 02940000, Performance =  11.35 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.084235 s, Result = 02a30000, Performance =  11.47 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.085853 s, Result = 02b20000, Performance =  11.51 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.087613 s, Result = 02c10000, Performance =  11.52 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089519 s, Result = 02d00000, Performance =  11.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.090333 s, Result = 02df0000, Performance =  11.65 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.093424 s, Result = 02ee0000, Performance =  11.49 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.095455 s, Result = 02fd0000, Performance =  11.47 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.098764 s, Result = 030c0000, Performance =  11.31 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.099410 s, Result = 031b0000, Performance =  11.45 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.100898 s, Result = 032a0000, Performance =  11.49 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.103948 s, Result = 03390000, Performance =  11.36 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.105809 s, Result = 03480000, Performance =  11.37 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.106206 s, Result = 03570000, Performance =  11.53 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.107210 s, Result = 03660000, Performance =  11.62 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.114982 s, Result = 03750000, Performance =  11.02 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.116684 s, Result = 03840000, Performance =  11.04 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.113892 s, Result = 03930000, Performance =  11.50 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.120823 s, Result = 03a20000, Performance =  11.02 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.118647 s, Result = 03b10000, Performance =  11.40 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.138080 s, Result = 03c00000, Performance =   9.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1657  1775   704
Test passed: M N K =   208  1767  1472
Test passed: M N K =  1591   295  1472
Test passed: M N K =   923   810   768
Test passed: M N K =   708    26   640
M N K =  2048  2048   256, Elapsed time =   0.010703 s, Result = 34130000, Performance =   2.01 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007052 s, Result = e4220000, Performance =   6.09 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008049 s, Result = 94310000, Performance =   8.00 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009334 s, Result = 44400000, Performance =   9.20 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010576 s, Result = f44f0000, Performance =  10.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011908 s, Result = a45e0000, Performance =  10.82 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013346 s, Result = 546d0000, Performance =  11.26 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014643 s, Result = 047c0000, Performance =  11.73 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016302 s, Result = b48b0000, Performance =  11.86 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017902 s, Result = 649a0000, Performance =  12.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019543 s, Result = 14a90000, Performance =  12.09 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.021197 s, Result = c4b80000, Performance =  12.16 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.023213 s, Result = 74c70000, Performance =  12.03 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.025132 s, Result = 24d60000, Performance =  11.96 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.027388 s, Result = d4e50000, Performance =  11.76 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.029095 s, Result = 84f40000, Performance =  11.81 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.032094 s, Result = 35030000, Performance =  11.38 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.034034 s, Result = e5120000, Performance =  11.36 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.036249 s, Result = 95210000, Performance =  11.26 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.038440 s, Result = 45300000, Performance =  11.17 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.040712 s, Result = f53f0000, Performance =  11.08 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.042956 s, Result = a54e0000, Performance =  11.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.045303 s, Result = 555d0000, Performance =  10.90 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.047647 s, Result = 056c0000, Performance =  10.82 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.051258 s, Result = b57b0000, Performance =  10.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.056111 s, Result = 658a0000, Performance =   9.95 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.058330 s, Result = 15990000, Performance =   9.94 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.060315 s, Result = c5a80000, Performance =   9.97 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.062171 s, Result = 75b70000, Performance =  10.02 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.063900 s, Result = 25c60000, Performance =  10.08 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.071057 s, Result = d5d50000, Performance =   9.37 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.070757 s, Result = 85e40000, Performance =   9.71 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.068731 s, Result = 35f30000, Performance =  10.31 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.068826 s, Result = e6020000, Performance =  10.61 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.070947 s, Result = 96110000, Performance =  10.59 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.072608 s, Result = 46200000, Performance =  10.65 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.074865 s, Result = f62f0000, Performance =  10.61 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.076315 s, Result = a63e0000, Performance =  10.69 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.078479 s, Result = 564d0000, Performance =  10.67 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.079786 s, Result = 065c0000, Performance =  10.77 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.081493 s, Result = b66b0000, Performance =  10.80 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.082646 s, Result = 667a0000, Performance =  10.91 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.085040 s, Result = 16890000, Performance =  10.86 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.086647 s, Result = c6980000, Performance =  10.91 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.088965 s, Result = 76a70000, Performance =  10.86 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.091157 s, Result = 26b60000, Performance =  10.84 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.095100 s, Result = d6c50000, Performance =  10.61 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.094635 s, Result = 86d40000, Performance =  10.89 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.097063 s, Result = 36e30000, Performance =  10.84 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.098736 s, Result = e6f20000, Performance =  10.87 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.101325 s, Result = 97010000, Performance =  10.81 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.104404 s, Result = 47100000, Performance =  10.70 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.104134 s, Result = f71f0000, Performance =  10.93 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.105038 s, Result = a72e0000, Performance =  11.04 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.106311 s, Result = 573d0000, Performance =  11.11 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.107405 s, Result = 074c0000, Performance =  11.20 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.110406 s, Result = b75b0000, Performance =  11.09 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.111700 s, Result = 676a0000, Performance =  11.15 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.113910 s, Result = 17790000, Performance =  11.12 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.115354 s, Result = c7880000, Performance =  11.17 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.117463 s, Result = 77970000, Performance =  11.15 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.115080 s, Result = 27a60000, Performance =  11.57 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.118388 s, Result = d7b50000, Performance =  11.43 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.153589 s, Result = 87c40000, Performance =   8.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1723  1047   896
Test passed: M N K =  1969     2   960
Test passed: M N K =  1834  1943  2048
Test passed: M N K =  1323   562   960
Test passed: M N K =  1282   698   384
M N K =  2048  2048   256, Elapsed time =   0.004093 s, Result = 000f0000, Performance =   5.25 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005069 s, Result = 001e0000, Performance =   8.47 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005613 s, Result = 002d0000, Performance =  11.48 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006768 s, Result = 003c0000, Performance =  12.69 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007918 s, Result = 004b0000, Performance =  13.56 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009137 s, Result = 005a0000, Performance =  14.10 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010388 s, Result = 00690000, Performance =  14.47 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011639 s, Result = 00780000, Performance =  14.76 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013070 s, Result = 00870000, Performance =  14.79 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014538 s, Result = 00960000, Performance =  14.77 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016018 s, Result = 00a50000, Performance =  14.75 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017523 s, Result = 00b40000, Performance =  14.71 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019249 s, Result = 00c30000, Performance =  14.50 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020973 s, Result = 00d20000, Performance =  14.33 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023593 s, Result = 00e10000, Performance =  13.65 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024452 s, Result = 00f00000, Performance =  14.05 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.026681 s, Result = 00ff0000, Performance =  13.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.028450 s, Result = 010e0000, Performance =  13.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030129 s, Result = 011d0000, Performance =  13.54 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032234 s, Result = 012c0000, Performance =  13.32 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034476 s, Result = 013b0000, Performance =  13.08 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.036406 s, Result = 014a0000, Performance =  12.98 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038438 s, Result = 01590000, Performance =  12.85 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.040921 s, Result = 01680000, Performance =  12.59 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.043060 s, Result = 01770000, Performance =  12.47 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.045445 s, Result = 01860000, Performance =  12.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.047230 s, Result = 01950000, Performance =  12.28 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.049598 s, Result = 01a40000, Performance =  12.12 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051619 s, Result = 01b30000, Performance =  12.06 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.053867 s, Result = 01c20000, Performance =  11.96 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.055635 s, Result = 01d10000, Performance =  11.97 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.058340 s, Result = 01e00000, Performance =  11.78 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.058350 s, Result = 01ef0000, Performance =  12.15 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.059709 s, Result = 01fe0000, Performance =  12.23 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.062760 s, Result = 020d0000, Performance =  11.98 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.066180 s, Result = 021c0000, Performance =  11.68 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.069783 s, Result = 022b0000, Performance =  11.39 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.072957 s, Result = 023a0000, Performance =  11.19 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.075633 s, Result = 02490000, Performance =  11.07 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.075775 s, Result = 02580000, Performance =  11.34 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.077405 s, Result = 02670000, Performance =  11.37 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.078063 s, Result = 02760000, Performance =  11.55 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.081136 s, Result = 02850000, Performance =  11.38 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.082539 s, Result = 02940000, Performance =  11.45 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.084654 s, Result = 02a30000, Performance =  11.42 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.087225 s, Result = 02b20000, Performance =  11.33 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.088720 s, Result = 02c10000, Performance =  11.38 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089875 s, Result = 02d00000, Performance =  11.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.092564 s, Result = 02df0000, Performance =  11.37 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.093452 s, Result = 02ee0000, Performance =  11.49 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.095314 s, Result = 02fd0000, Performance =  11.49 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.095491 s, Result = 030c0000, Performance =  11.69 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.094104 s, Result = 031b0000, Performance =  12.09 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.095538 s, Result = 032a0000, Performance =  12.14 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.097180 s, Result = 03390000, Performance =  12.15 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.098291 s, Result = 03480000, Performance =  12.23 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.100542 s, Result = 03570000, Performance =  12.17 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.103007 s, Result = 03660000, Performance =  12.09 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.104207 s, Result = 03750000, Performance =  12.16 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.108518 s, Result = 03840000, Performance =  11.87 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.108580 s, Result = 03930000, Performance =  12.06 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.108502 s, Result = 03a20000, Performance =  12.27 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.113553 s, Result = 03b10000, Performance =  11.91 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.147775 s, Result = 03c00000, Performance =   9.30 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   983   253  1920
Test passed: M N K =   272   820   320
Test passed: M N K =  1718  1121   768
Test passed: M N K =  1952  1253  1344
Test passed: M N K =  1227  1099  1600
M N K =  2048  2048   256, Elapsed time =   0.009402 s, Result = 28370000, Performance =   2.28 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008097 s, Result = 28460000, Performance =   5.30 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008082 s, Result = 28550000, Performance =   7.97 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008659 s, Result = 28640000, Performance =   9.92 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009606 s, Result = 28730000, Performance =  11.18 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010729 s, Result = 28820000, Performance =  12.01 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011916 s, Result = 28910000, Performance =  12.62 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013217 s, Result = 28a00000, Performance =  13.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014624 s, Result = 28af0000, Performance =  13.22 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015966 s, Result = 28be0000, Performance =  13.45 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017429 s, Result = 28cd0000, Performance =  13.55 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018849 s, Result = 28dc0000, Performance =  13.67 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020427 s, Result = 28eb0000, Performance =  13.67 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022007 s, Result = 28fa0000, Performance =  13.66 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023659 s, Result = 29090000, Performance =  13.62 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025037 s, Result = 29180000, Performance =  13.72 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027629 s, Result = 29270000, Performance =  13.21 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029285 s, Result = 29360000, Performance =  13.20 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030796 s, Result = 29450000, Performance =  13.25 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032863 s, Result = 29540000, Performance =  13.07 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034548 s, Result = 29630000, Performance =  13.05 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.036530 s, Result = 29720000, Performance =  12.93 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038259 s, Result = 29810000, Performance =  12.91 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.040335 s, Result = 29900000, Performance =  12.78 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.042784 s, Result = 299f0000, Performance =  12.55 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.044730 s, Result = 29ae0000, Performance =  12.48 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.046861 s, Result = 29bd0000, Performance =  12.37 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.048534 s, Result = 29cc0000, Performance =  12.39 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.050842 s, Result = 29db0000, Performance =  12.25 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052655 s, Result = 29ea0000, Performance =  12.24 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054799 s, Result = 29f90000, Performance =  12.15 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.057379 s, Result = 2a080000, Performance =  11.98 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.057363 s, Result = 2a170000, Performance =  12.35 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058098 s, Result = 2a260000, Performance =  12.57 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059753 s, Result = 2a350000, Performance =  12.58 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.062495 s, Result = 2a440000, Performance =  12.37 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066868 s, Result = 2a530000, Performance =  11.88 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.070902 s, Result = 2a620000, Performance =  11.51 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.073951 s, Result = 2a710000, Performance =  11.33 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.075438 s, Result = 2a800000, Performance =  11.39 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.077095 s, Result = 2a8f0000, Performance =  11.42 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.077705 s, Result = 2a9e0000, Performance =  11.61 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.080460 s, Result = 2aad0000, Performance =  11.48 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.081925 s, Result = 2abc0000, Performance =  11.53 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.083936 s, Result = 2acb0000, Performance =  11.51 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.087384 s, Result = 2ada0000, Performance =  11.30 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.088412 s, Result = 2ae90000, Performance =  11.42 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089519 s, Result = 2af80000, Performance =  11.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.093508 s, Result = 2b070000, Performance =  11.25 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.093672 s, Result = 2b160000, Performance =  11.46 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.095725 s, Result = 2b250000, Performance =  11.44 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.098923 s, Result = 2b340000, Performance =  11.29 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.098665 s, Result = 2b430000, Performance =  11.54 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.098981 s, Result = 2b520000, Performance =  11.72 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.100842 s, Result = 2b610000, Performance =  11.71 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.100842 s, Result = 2b700000, Performance =  11.93 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.101510 s, Result = 2b7f0000, Performance =  12.06 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.102444 s, Result = 2b8e0000, Performance =  12.16 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.102936 s, Result = 2b9d0000, Performance =  12.31 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.108178 s, Result = 2bac0000, Performance =  11.91 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.106640 s, Result = 2bbb0000, Performance =  12.28 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.107489 s, Result = 2bca0000, Performance =  12.39 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.111937 s, Result = 2bd90000, Performance =  12.09 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.144660 s, Result = 2be80000, Performance =   9.50 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1567   209   640
Test passed: M N K =  1536   487  2048
Test passed: M N K =   868   257   192
Test passed: M N K =  1067  1515  1600
Test passed: M N K =  1860  1959   256
M N K =  2048  2048   256, Elapsed time =   0.001160 s, Result = 000f0000, Performance =  18.51 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002772 s, Result = 001e0000, Performance =  15.49 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004327 s, Result = 002d0000, Performance =  14.89 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005830 s, Result = 003c0000, Performance =  14.73 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007355 s, Result = 004b0000, Performance =  14.60 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008784 s, Result = 005a0000, Performance =  14.67 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010275 s, Result = 00690000, Performance =  14.63 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009681 s, Result = 00780000, Performance =  17.75 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009933 s, Result = 00870000, Performance =  19.46 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011033 s, Result = 00960000, Performance =  19.46 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012117 s, Result = 00a50000, Performance =  19.50 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013233 s, Result = 00b40000, Performance =  19.47 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014355 s, Result = 00c30000, Performance =  19.45 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015476 s, Result = 00d20000, Performance =  19.43 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016702 s, Result = 00e10000, Performance =  19.29 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018397 s, Result = 00f00000, Performance =  18.68 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019227 s, Result = 00ff0000, Performance =  18.99 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020690 s, Result = 010e0000, Performance =  18.68 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022147 s, Result = 011d0000, Performance =  18.42 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023912 s, Result = 012c0000, Performance =  17.96 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025545 s, Result = 013b0000, Performance =  17.65 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026926 s, Result = 014a0000, Performance =  17.55 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.028920 s, Result = 01590000, Performance =  17.08 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030837 s, Result = 01680000, Performance =  16.71 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.033174 s, Result = 01770000, Performance =  16.18 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.035411 s, Result = 01860000, Performance =  15.77 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.037277 s, Result = 01950000, Performance =  15.55 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.039714 s, Result = 01a40000, Performance =  15.14 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.041616 s, Result = 01b30000, Performance =  14.96 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043952 s, Result = 01c20000, Performance =  14.66 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.047442 s, Result = 01d10000, Performance =  14.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.049113 s, Result = 01e00000, Performance =  13.99 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.048858 s, Result = 01ef0000, Performance =  14.50 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048957 s, Result = 01fe0000, Performance =  14.91 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051427 s, Result = 020d0000, Performance =  14.62 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.053171 s, Result = 021c0000, Performance =  14.54 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.055715 s, Result = 022b0000, Performance =  14.26 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058707 s, Result = 023a0000, Performance =  13.90 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.062276 s, Result = 02490000, Performance =  13.45 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.063747 s, Result = 02580000, Performance =  13.48 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.065818 s, Result = 02670000, Performance =  13.38 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.067200 s, Result = 02760000, Performance =  13.42 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.068931 s, Result = 02850000, Performance =  13.40 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.072438 s, Result = 02940000, Performance =  13.04 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.075942 s, Result = 02a30000, Performance =  12.73 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.076815 s, Result = 02b20000, Performance =  12.86 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.076594 s, Result = 02c10000, Performance =  13.18 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.078686 s, Result = 02d00000, Performance =  13.10 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.080133 s, Result = 02df0000, Performance =  13.13 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.086158 s, Result = 02ee0000, Performance =  12.46 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.086316 s, Result = 02fd0000, Performance =  12.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.089190 s, Result = 030c0000, Performance =  12.52 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.090444 s, Result = 031b0000, Performance =  12.58 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.091822 s, Result = 032a0000, Performance =  12.63 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.093067 s, Result = 03390000, Performance =  12.69 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.094054 s, Result = 03480000, Performance =  12.79 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.100080 s, Result = 03570000, Performance =  12.23 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.103573 s, Result = 03660000, Performance =  12.03 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.102066 s, Result = 03750000, Performance =  12.41 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.104385 s, Result = 03840000, Performance =  12.34 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.103005 s, Result = 03930000, Performance =  12.72 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.103220 s, Result = 03a20000, Performance =  12.90 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.107271 s, Result = 03b10000, Performance =  12.61 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.137082 s, Result = 03c00000, Performance =  10.03 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   464  1137   448
Test passed: M N K =  1203   413   896
Test passed: M N K =  1451  1724   256
Test passed: M N K =  1604  1873    64
Test passed: M N K =  1651   168  2048
M N K =  2048  2048   256, Elapsed time =   0.010151 s, Result = 34130000, Performance =   2.12 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007177 s, Result = e4220000, Performance =   5.98 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008086 s, Result = 94310000, Performance =   7.97 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009295 s, Result = 44400000, Performance =   9.24 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010620 s, Result = f44f0000, Performance =  10.11 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012096 s, Result = a45e0000, Performance =  10.65 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013507 s, Result = 546d0000, Performance =  11.13 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014846 s, Result = 047c0000, Performance =  11.57 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016317 s, Result = b48b0000, Performance =  11.84 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017755 s, Result = 649a0000, Performance =  12.09 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019345 s, Result = 14a90000, Performance =  12.21 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020899 s, Result = c4b80000, Performance =  12.33 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022866 s, Result = 74c70000, Performance =  12.21 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024580 s, Result = 24d60000, Performance =  12.23 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026433 s, Result = d4e50000, Performance =  12.19 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.028284 s, Result = 84f40000, Performance =  12.15 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.031148 s, Result = 35030000, Performance =  11.72 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.033049 s, Result = e5120000, Performance =  11.70 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.035147 s, Result = 95210000, Performance =  11.61 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.037002 s, Result = 45300000, Performance =  11.61 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.039731 s, Result = f53f0000, Performance =  11.35 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.041480 s, Result = a54e0000, Performance =  11.39 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.046245 s, Result = 555d0000, Performance =  10.68 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.049117 s, Result = 056c0000, Performance =  10.49 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.051957 s, Result = b57b0000, Performance =  10.33 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.054229 s, Result = 658a0000, Performance =  10.30 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.056045 s, Result = 15990000, Performance =  10.35 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.057606 s, Result = c5a80000, Performance =  10.44 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.062227 s, Result = 75b70000, Performance =  10.01 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.061266 s, Result = 25c60000, Performance =  10.52 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.062660 s, Result = d5d50000, Performance =  10.62 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.066459 s, Result = 85e40000, Performance =  10.34 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.066518 s, Result = 35f30000, Performance =  10.65 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.069928 s, Result = e6020000, Performance =  10.44 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.069317 s, Result = 96110000, Performance =  10.84 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.069120 s, Result = 46200000, Performance =  11.18 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.071385 s, Result = f62f0000, Performance =  11.13 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.072590 s, Result = a63e0000, Performance =  11.24 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.075413 s, Result = 564d0000, Performance =  11.11 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.076793 s, Result = 065c0000, Performance =  11.19 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.078088 s, Result = b66b0000, Performance =  11.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.079896 s, Result = 667a0000, Performance =  11.29 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.082062 s, Result = 16890000, Performance =  11.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.081077 s, Result = c6980000, Performance =  11.65 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.084926 s, Result = 76a70000, Performance =  11.38 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.086501 s, Result = 26b60000, Performance =  11.42 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.088516 s, Result = d6c50000, Performance =  11.40 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089144 s, Result = 86d40000, Performance =  11.56 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.092118 s, Result = 36e30000, Performance =  11.42 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.094317 s, Result = e6f20000, Performance =  11.38 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.096499 s, Result = 97010000, Performance =  11.35 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.097458 s, Result = 47100000, Performance =  11.46 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.100704 s, Result = f71f0000, Performance =  11.30 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.101876 s, Result = a72e0000, Performance =  11.38 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.104913 s, Result = 573d0000, Performance =  11.26 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.106039 s, Result = 074c0000, Performance =  11.34 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.111152 s, Result = b75b0000, Performance =  11.01 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.109905 s, Result = 676a0000, Performance =  11.33 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.113105 s, Result = 17790000, Performance =  11.20 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.110980 s, Result = c7880000, Performance =  11.61 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.115835 s, Result = 77970000, Performance =  11.31 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.117653 s, Result = 27a60000, Performance =  11.32 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.120668 s, Result = d7b50000, Performance =  11.21 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.144646 s, Result = 87c40000, Performance =   9.50 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   252  1076   384
Test passed: M N K =   704  1472   960
Test passed: M N K =  1154   471   832
Test passed: M N K =  1642    24  1856
Test passed: M N K =  1810  1379  1728
M N K =  2048  2048   256, Elapsed time =   0.009471 s, Result = 000f0000, Performance =   2.27 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006183 s, Result = 001e0000, Performance =   6.95 TOPS
M N K =  2048  2048   768, Elapsed time =   0.005648 s, Result = 002d0000, Performance =  11.41 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006603 s, Result = 003c0000, Performance =  13.01 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007733 s, Result = 004b0000, Performance =  13.89 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009045 s, Result = 005a0000, Performance =  14.25 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010322 s, Result = 00690000, Performance =  14.56 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011662 s, Result = 00780000, Performance =  14.73 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013086 s, Result = 00870000, Performance =  14.77 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014501 s, Result = 00960000, Performance =  14.81 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015945 s, Result = 00a50000, Performance =  14.81 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017306 s, Result = 00b40000, Performance =  14.89 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018979 s, Result = 00c30000, Performance =  14.71 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.024997 s, Result = 00d20000, Performance =  12.03 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025654 s, Result = 00e10000, Performance =  12.56 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026587 s, Result = 00f00000, Performance =  12.92 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.026120 s, Result = 00ff0000, Performance =  13.98 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.027940 s, Result = 010e0000, Performance =  13.83 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.029346 s, Result = 011d0000, Performance =  13.90 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031195 s, Result = 012c0000, Performance =  13.77 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033031 s, Result = 013b0000, Performance =  13.65 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035032 s, Result = 014a0000, Performance =  13.49 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.038534 s, Result = 01590000, Performance =  12.82 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038933 s, Result = 01680000, Performance =  13.24 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040857 s, Result = 01770000, Performance =  13.14 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042985 s, Result = 01860000, Performance =  12.99 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045219 s, Result = 01950000, Performance =  12.82 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.046876 s, Result = 01a40000, Performance =  12.83 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.049268 s, Result = 01b30000, Performance =  12.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.051311 s, Result = 01c20000, Performance =  12.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.053111 s, Result = 01d10000, Performance =  12.53 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.056320 s, Result = 01e00000, Performance =  12.20 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.057238 s, Result = 01ef0000, Performance =  12.38 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.061097 s, Result = 01fe0000, Performance =  11.95 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.062811 s, Result = 020d0000, Performance =  11.97 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.064007 s, Result = 021c0000, Performance =  12.08 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.067431 s, Result = 022b0000, Performance =  11.78 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.069265 s, Result = 023a0000, Performance =  11.78 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.071039 s, Result = 02490000, Performance =  11.79 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.071835 s, Result = 02580000, Performance =  11.96 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.073545 s, Result = 02670000, Performance =  11.97 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.074410 s, Result = 02760000, Performance =  12.12 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.076503 s, Result = 02850000, Performance =  12.07 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.076794 s, Result = 02940000, Performance =  12.30 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.079997 s, Result = 02a30000, Performance =  12.08 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081577 s, Result = 02b20000, Performance =  12.11 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.083955 s, Result = 02c10000, Performance =  12.02 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.084568 s, Result = 02d00000, Performance =  12.19 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.087390 s, Result = 02df0000, Performance =  12.04 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.088509 s, Result = 02ee0000, Performance =  12.13 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.091430 s, Result = 02fd0000, Performance =  11.98 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.092473 s, Result = 030c0000, Performance =  12.08 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.094383 s, Result = 031b0000, Performance =  12.06 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.095931 s, Result = 032a0000, Performance =  12.09 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.098991 s, Result = 03390000, Performance =  11.93 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.097015 s, Result = 03480000, Performance =  12.40 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.096974 s, Result = 03570000, Performance =  12.62 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.101352 s, Result = 03660000, Performance =  12.29 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.104971 s, Result = 03750000, Performance =  12.07 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.100777 s, Result = 03840000, Performance =  12.79 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.106822 s, Result = 03930000, Performance =  12.26 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.110077 s, Result = 03a20000, Performance =  12.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.111767 s, Result = 03b10000, Performance =  12.10 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.135465 s, Result = 03c00000, Performance =  10.15 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1876   955   512
Test passed: M N K =   101  1290  1600
Test passed: M N K =   547  1162  1344
Test passed: M N K =   649  1549  1280
Test passed: M N K =  1367   969  1024
M N K =  2048  2048   256, Elapsed time =   0.010002 s, Result = 28370000, Performance =   2.15 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007732 s, Result = 28460000, Performance =   5.55 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007838 s, Result = 28550000, Performance =   8.22 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008477 s, Result = 28640000, Performance =  10.13 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009605 s, Result = 28730000, Performance =  11.18 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010748 s, Result = 28820000, Performance =  11.99 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011925 s, Result = 28910000, Performance =  12.61 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013162 s, Result = 28a00000, Performance =  13.05 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014506 s, Result = 28af0000, Performance =  13.32 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015872 s, Result = 28be0000, Performance =  13.53 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017312 s, Result = 28cd0000, Performance =  13.64 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018682 s, Result = 28dc0000, Performance =  13.79 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020157 s, Result = 28eb0000, Performance =  13.85 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021707 s, Result = 28fa0000, Performance =  13.85 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023255 s, Result = 29090000, Performance =  13.85 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024635 s, Result = 29180000, Performance =  13.95 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027252 s, Result = 29270000, Performance =  13.40 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.028644 s, Result = 29360000, Performance =  13.49 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030189 s, Result = 29450000, Performance =  13.52 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031651 s, Result = 29540000, Performance =  13.57 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033519 s, Result = 29630000, Performance =  13.45 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035154 s, Result = 29720000, Performance =  13.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.036922 s, Result = 29810000, Performance =  13.38 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038772 s, Result = 29900000, Performance =  13.29 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040950 s, Result = 299f0000, Performance =  13.11 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042929 s, Result = 29ae0000, Performance =  13.01 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.044975 s, Result = 29bd0000, Performance =  12.89 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.046752 s, Result = 29cc0000, Performance =  12.86 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.048789 s, Result = 29db0000, Performance =  12.76 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.050620 s, Result = 29ea0000, Performance =  12.73 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.052843 s, Result = 29f90000, Performance =  12.60 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.055818 s, Result = 2a080000, Performance =  12.31 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.056584 s, Result = 2a170000, Performance =  12.52 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058362 s, Result = 2a260000, Performance =  12.51 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059444 s, Result = 2a350000, Performance =  12.64 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.060266 s, Result = 2a440000, Performance =  12.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.063099 s, Result = 2a530000, Performance =  12.59 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.065252 s, Result = 2a620000, Performance =  12.51 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.067358 s, Result = 2a710000, Performance =  12.43 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.069107 s, Result = 2a800000, Performance =  12.43 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.072575 s, Result = 2a8f0000, Performance =  12.13 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.075063 s, Result = 2a9e0000, Performance =  12.02 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.077086 s, Result = 2aad0000, Performance =  11.98 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.077561 s, Result = 2abc0000, Performance =  12.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.080426 s, Result = 2acb0000, Performance =  12.02 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081736 s, Result = 2ada0000, Performance =  12.09 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.084706 s, Result = 2ae90000, Performance =  11.92 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.085158 s, Result = 2af80000, Performance =  12.10 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.088260 s, Result = 2b070000, Performance =  11.92 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.089412 s, Result = 2b160000, Performance =  12.01 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.088127 s, Result = 2b250000, Performance =  12.43 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.089004 s, Result = 2b340000, Performance =  12.55 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.091476 s, Result = 2b430000, Performance =  12.44 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.100763 s, Result = 2b520000, Performance =  11.51 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.095710 s, Result = 2b610000, Performance =  12.34 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.096968 s, Result = 2b700000, Performance =  12.40 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.098462 s, Result = 2b7f0000, Performance =  12.43 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.099593 s, Result = 2b8e0000, Performance =  12.51 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.102507 s, Result = 2b9d0000, Performance =  12.36 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.101776 s, Result = 2bac0000, Performance =  12.66 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.104554 s, Result = 2bbb0000, Performance =  12.53 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.106853 s, Result = 2bca0000, Performance =  12.46 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.108361 s, Result = 2bd90000, Performance =  12.49 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.129698 s, Result = 2be80000, Performance =  10.60 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1805   649   256
Test passed: M N K =   757   513   768
Test passed: M N K =  1145  1013   832
Test passed: M N K =  1796  1869   192
Test passed: M N K =  1371   320  2048
M N K =  2048  2048   256, Elapsed time =   0.001070 s, Result = 000f0000, Performance =  20.07 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002169 s, Result = 001e0000, Performance =  19.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003259 s, Result = 002d0000, Performance =  19.77 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004280 s, Result = 003c0000, Performance =  20.07 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005438 s, Result = 004b0000, Performance =  19.74 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006571 s, Result = 005a0000, Performance =  19.61 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007682 s, Result = 00690000, Performance =  19.57 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008822 s, Result = 00780000, Performance =  19.47 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009870 s, Result = 00870000, Performance =  19.58 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011028 s, Result = 00960000, Performance =  19.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012228 s, Result = 00a50000, Performance =  19.32 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013514 s, Result = 00b40000, Performance =  19.07 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014658 s, Result = 00c30000, Performance =  19.05 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015877 s, Result = 00d20000, Performance =  18.94 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017287 s, Result = 00e10000, Performance =  18.63 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018292 s, Result = 00f00000, Performance =  18.78 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019679 s, Result = 00ff0000, Performance =  18.55 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020309 s, Result = 010e0000, Performance =  19.03 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021686 s, Result = 011d0000, Performance =  18.81 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023013 s, Result = 012c0000, Performance =  18.66 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024607 s, Result = 013b0000, Performance =  18.33 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025896 s, Result = 014a0000, Performance =  18.24 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027760 s, Result = 01590000, Performance =  17.79 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.029228 s, Result = 01680000, Performance =  17.63 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.031233 s, Result = 01770000, Performance =  17.19 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.033262 s, Result = 01860000, Performance =  16.79 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.036921 s, Result = 01950000, Performance =  15.70 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.038904 s, Result = 01a40000, Performance =  15.46 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.039677 s, Result = 01b30000, Performance =  15.70 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.041552 s, Result = 01c20000, Performance =  15.50 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.044860 s, Result = 01d10000, Performance =  14.84 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.047356 s, Result = 01e00000, Performance =  14.51 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.048216 s, Result = 01ef0000, Performance =  14.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.049590 s, Result = 01fe0000, Performance =  14.72 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.050155 s, Result = 020d0000, Performance =  14.99 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.051302 s, Result = 021c0000, Performance =  15.07 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.055169 s, Result = 022b0000, Performance =  14.40 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.056215 s, Result = 023a0000, Performance =  14.52 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.057387 s, Result = 02490000, Performance =  14.59 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.059947 s, Result = 02580000, Performance =  14.33 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.067628 s, Result = 02670000, Performance =  13.02 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.069697 s, Result = 02760000, Performance =  12.94 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.071186 s, Result = 02850000, Performance =  12.97 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.069511 s, Result = 02940000, Performance =  13.59 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.073598 s, Result = 02a30000, Performance =  13.13 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.073463 s, Result = 02b20000, Performance =  13.45 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.076493 s, Result = 02c10000, Performance =  13.19 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.076467 s, Result = 02d00000, Performance =  13.48 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.079446 s, Result = 02df0000, Performance =  13.25 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.080390 s, Result = 02ee0000, Performance =  13.36 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.083152 s, Result = 02fd0000, Performance =  13.17 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.083702 s, Result = 030c0000, Performance =  13.34 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.086536 s, Result = 031b0000, Performance =  13.15 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.087755 s, Result = 032a0000, Performance =  13.21 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.089427 s, Result = 03390000, Performance =  13.21 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.091760 s, Result = 03480000, Performance =  13.11 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.092463 s, Result = 03570000, Performance =  13.24 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.096417 s, Result = 03660000, Performance =  12.92 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.100138 s, Result = 03750000, Performance =  12.65 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.096834 s, Result = 03840000, Performance =  13.31 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.100737 s, Result = 03930000, Performance =  13.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.101960 s, Result = 03a20000, Performance =  13.06 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.102871 s, Result = 03b10000, Performance =  13.15 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.123502 s, Result = 03c00000, Performance =  11.13 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1138  1261   384
Test passed: M N K =  1810  1025  2048
Test passed: M N K =   803  1417  1408
Test passed: M N K =  1331  1423   384
Test passed: M N K =   538  1185  1792
M N K =  2048  2048   256, Elapsed time =   0.009940 s, Result = 440e0000, Performance =   2.16 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006555 s, Result = 84180000, Performance =   6.55 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007018 s, Result = c4220000, Performance =   9.18 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007877 s, Result = 042c0000, Performance =  10.90 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008800 s, Result = 44360000, Performance =  12.20 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009825 s, Result = 84400000, Performance =  13.11 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013565 s, Result = c44a0000, Performance =  11.08 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.015009 s, Result = 04540000, Performance =  11.45 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016435 s, Result = 445e0000, Performance =  11.76 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015499 s, Result = 84680000, Performance =  13.86 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019640 s, Result = c4720000, Performance =  12.03 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.024709 s, Result = 047c0000, Performance =  10.43 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.025953 s, Result = 44860000, Performance =  10.76 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.028695 s, Result = 84900000, Performance =  10.48 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.029601 s, Result = c49a0000, Performance =  10.88 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.031031 s, Result = 04a40000, Performance =  11.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.031499 s, Result = 44ae0000, Performance =  11.59 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.035119 s, Result = 84b80000, Performance =  11.01 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.035813 s, Result = c4c20000, Performance =  11.39 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.039692 s, Result = 04cc0000, Performance =  10.82 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.043251 s, Result = 44d60000, Performance =  10.43 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.045849 s, Result = 84e00000, Performance =  10.30 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.048182 s, Result = c4ea0000, Performance =  10.25 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.049448 s, Result = 04f40000, Performance =  10.42 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.051204 s, Result = 44fe0000, Performance =  10.49 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.053079 s, Result = 85080000, Performance =  10.52 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.055239 s, Result = c5120000, Performance =  10.50 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.057976 s, Result = 051c0000, Performance =  10.37 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.059480 s, Result = 45260000, Performance =  10.47 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.067406 s, Result = 85300000, Performance =   9.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.063207 s, Result = c53a0000, Performance =  10.53 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.064455 s, Result = 05440000, Performance =  10.66 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.064803 s, Result = 454e0000, Performance =  10.94 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.066414 s, Result = 85580000, Performance =  10.99 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.068770 s, Result = c5620000, Performance =  10.93 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.069992 s, Result = 056c0000, Performance =  11.05 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.071548 s, Result = 45760000, Performance =  11.11 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.073061 s, Result = 85800000, Performance =  11.17 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.074767 s, Result = c58a0000, Performance =  11.20 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.076059 s, Result = 05940000, Performance =  11.29 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.077404 s, Result = 459e0000, Performance =  11.38 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.078983 s, Result = 85a80000, Performance =  11.42 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.078852 s, Result = c5b20000, Performance =  11.71 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.081911 s, Result = 05bc0000, Performance =  11.54 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.084342 s, Result = 45c60000, Performance =  11.46 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.085689 s, Result = 85d00000, Performance =  11.53 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.086995 s, Result = c5da0000, Performance =  11.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.089047 s, Result = 05e40000, Performance =  11.58 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.090053 s, Result = 45ee0000, Performance =  11.68 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.091677 s, Result = 85f80000, Performance =  11.71 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.094747 s, Result = c6020000, Performance =  11.56 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.096040 s, Result = 060c0000, Performance =  11.63 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.097437 s, Result = 46160000, Performance =  11.68 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.099436 s, Result = 86200000, Performance =  11.66 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.100805 s, Result = c62a0000, Performance =  11.72 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.101985 s, Result = 06340000, Performance =  11.79 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.102712 s, Result = 463e0000, Performance =  11.92 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.103959 s, Result = 86480000, Performance =  11.98 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.104839 s, Result = c6520000, Performance =  12.09 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.104976 s, Result = 065c0000, Performance =  12.27 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.107230 s, Result = 46660000, Performance =  12.22 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.107555 s, Result = 86700000, Performance =  12.38 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.104262 s, Result = c67a0000, Performance =  12.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.134704 s, Result = 06840000, Performance =  10.20 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1420  1613   768
Test passed: M N K =   110  1425   896
Test passed: M N K =  1612   830   960
Test passed: M N K =  1879  1807  1344
Test passed: M N K =   918   154   512
M N K =  2048  2048   256, Elapsed time =   0.006929 s, Result = 000a0000, Performance =   3.10 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004176 s, Result = 00140000, Performance =  10.29 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004871 s, Result = 001e0000, Performance =  13.22 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006139 s, Result = 00280000, Performance =  13.99 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007405 s, Result = 00320000, Performance =  14.50 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008418 s, Result = 003c0000, Performance =  15.31 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010219 s, Result = 00460000, Performance =  14.71 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010984 s, Result = 00500000, Performance =  15.64 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012547 s, Result = 005a0000, Performance =  15.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013759 s, Result = 00640000, Performance =  15.61 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015148 s, Result = 006e0000, Performance =  15.59 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016613 s, Result = 00780000, Performance =  15.51 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018413 s, Result = 00820000, Performance =  15.16 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020263 s, Result = 008c0000, Performance =  14.84 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.021358 s, Result = 00960000, Performance =  15.08 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.023147 s, Result = 00a00000, Performance =  14.84 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025125 s, Result = 00aa0000, Performance =  14.53 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.026907 s, Result = 00b40000, Performance =  14.37 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.028741 s, Result = 00be0000, Performance =  14.20 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.030602 s, Result = 00c80000, Performance =  14.03 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.032512 s, Result = 00d20000, Performance =  13.87 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.034389 s, Result = 00dc0000, Performance =  13.74 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.036068 s, Result = 00e60000, Performance =  13.69 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.037820 s, Result = 00f00000, Performance =  13.63 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040015 s, Result = 00fa0000, Performance =  13.42 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.042075 s, Result = 01040000, Performance =  13.27 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.044281 s, Result = 010e0000, Performance =  13.09 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.046592 s, Result = 01180000, Performance =  12.91 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.050220 s, Result = 01220000, Performance =  12.40 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.054534 s, Result = 012c0000, Performance =  11.81 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.059182 s, Result = 01360000, Performance =  11.25 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.060429 s, Result = 01400000, Performance =  11.37 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.060350 s, Result = 014a0000, Performance =  11.74 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.062871 s, Result = 01540000, Performance =  11.61 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.064529 s, Result = 015e0000, Performance =  11.65 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.066129 s, Result = 01680000, Performance =  11.69 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.067764 s, Result = 01720000, Performance =  11.73 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.069531 s, Result = 017c0000, Performance =  11.74 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.070698 s, Result = 01860000, Performance =  11.85 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.072337 s, Result = 01900000, Performance =  11.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.073763 s, Result = 019a0000, Performance =  11.94 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.075263 s, Result = 01a40000, Performance =  11.98 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.075483 s, Result = 01ae0000, Performance =  12.23 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.077949 s, Result = 01b80000, Performance =  12.12 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.079558 s, Result = 01c20000, Performance =  12.15 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.081535 s, Result = 01cc0000, Performance =  12.12 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.082867 s, Result = 01d60000, Performance =  12.18 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.084723 s, Result = 01e00000, Performance =  12.17 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.086158 s, Result = 01ea0000, Performance =  12.21 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.087558 s, Result = 01f40000, Performance =  12.26 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.089446 s, Result = 01fe0000, Performance =  12.24 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.090419 s, Result = 02080000, Performance =  12.35 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.092713 s, Result = 02120000, Performance =  12.28 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.094136 s, Result = 021c0000, Performance =  12.32 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.095482 s, Result = 02260000, Performance =  12.37 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.096202 s, Result = 02300000, Performance =  12.50 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.096978 s, Result = 023a0000, Performance =  12.62 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.097486 s, Result = 02440000, Performance =  12.78 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.098341 s, Result = 024e0000, Performance =  12.88 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.100043 s, Result = 02580000, Performance =  12.88 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.101522 s, Result = 02620000, Performance =  12.90 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.108946 s, Result = 026c0000, Performance =  12.22 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.098658 s, Result = 02760000, Performance =  13.71 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.125826 s, Result = 02800000, Performance =  10.92 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1992  1303   384
Test passed: M N K =  1644  1285  1920
Test passed: M N K =    93   467  1664
Test passed: M N K =  1045   626  1408
Test passed: M N K =  1676   122  1408
M N K =  2048  2048   256, Elapsed time =   0.009363 s, Result = 28320000, Performance =   2.29 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008474 s, Result = 283c0000, Performance =   5.07 TOPS
M N K =  2048  2048   768, Elapsed time =   0.022221 s, Result = 28460000, Performance =   2.90 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009102 s, Result = 28500000, Performance =   9.44 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012065 s, Result = 285a0000, Performance =   8.90 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011739 s, Result = 28640000, Performance =  10.98 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013562 s, Result = 286e0000, Performance =  11.08 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013863 s, Result = 28780000, Performance =  12.39 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014867 s, Result = 28820000, Performance =  13.00 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015799 s, Result = 288c0000, Performance =  13.59 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017410 s, Result = 28960000, Performance =  13.57 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.023666 s, Result = 28a00000, Performance =  10.89 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020423 s, Result = 28aa0000, Performance =  13.67 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019696 s, Result = 28b40000, Performance =  15.26 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020951 s, Result = 28be0000, Performance =  15.37 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022115 s, Result = 28c80000, Performance =  15.54 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023859 s, Result = 28d20000, Performance =  15.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025392 s, Result = 28dc0000, Performance =  15.22 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.026892 s, Result = 28e60000, Performance =  15.17 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028717 s, Result = 28f00000, Performance =  14.96 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.030178 s, Result = 28fa0000, Performance =  14.94 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.031799 s, Result = 29040000, Performance =  14.86 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.033761 s, Result = 290e0000, Performance =  14.63 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035339 s, Result = 29180000, Performance =  14.58 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037614 s, Result = 29220000, Performance =  14.27 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039644 s, Result = 292c0000, Performance =  14.08 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041365 s, Result = 29360000, Performance =  14.02 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.043250 s, Result = 29400000, Performance =  13.90 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.045994 s, Result = 294a0000, Performance =  13.54 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.048995 s, Result = 29540000, Performance =  13.15 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.049134 s, Result = 295e0000, Performance =  13.55 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.049896 s, Result = 29680000, Performance =  13.77 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.050385 s, Result = 29720000, Performance =  14.07 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.052384 s, Result = 297c0000, Performance =  13.94 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.054002 s, Result = 29860000, Performance =  13.92 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.056080 s, Result = 29900000, Performance =  13.79 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.058403 s, Result = 299a0000, Performance =  13.60 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.060868 s, Result = 29a40000, Performance =  13.41 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.063300 s, Result = 29ae0000, Performance =  13.23 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.069407 s, Result = 29b80000, Performance =  12.38 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.071691 s, Result = 29c20000, Performance =  12.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.073127 s, Result = 29cc0000, Performance =  12.33 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.073771 s, Result = 29d60000, Performance =  12.52 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.075872 s, Result = 29e00000, Performance =  12.45 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.078165 s, Result = 29ea0000, Performance =  12.36 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.079684 s, Result = 29f40000, Performance =  12.40 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.080744 s, Result = 29fe0000, Performance =  12.50 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.082762 s, Result = 2a080000, Performance =  12.45 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.083929 s, Result = 2a120000, Performance =  12.54 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.085379 s, Result = 2a1c0000, Performance =  12.58 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.087295 s, Result = 2a260000, Performance =  12.55 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.089101 s, Result = 2a300000, Performance =  12.53 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.090932 s, Result = 2a3a0000, Performance =  12.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.092739 s, Result = 2a440000, Performance =  12.50 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.094537 s, Result = 2a4e0000, Performance =  12.49 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.094224 s, Result = 2a580000, Performance =  12.76 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.095697 s, Result = 2a620000, Performance =  12.79 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.096513 s, Result = 2a6c0000, Performance =  12.91 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.097472 s, Result = 2a760000, Performance =  13.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.098748 s, Result = 2a800000, Performance =  13.05 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.101599 s, Result = 2a8a0000, Performance =  12.89 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.102563 s, Result = 2a940000, Performance =  12.98 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.097121 s, Result = 2a9e0000, Performance =  13.93 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.122338 s, Result = 2aa80000, Performance =  11.23 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   640   418    64
Test passed: M N K =  1354  1532   576
Test passed: M N K =   584   441  1152
Test passed: M N K =   106  1326  1472
Test passed: M N K =   779  1362  1920
M N K =  2048  2048   256, Elapsed time =   0.001034 s, Result = 000a0000, Performance =  20.76 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002261 s, Result = 00140000, Performance =  18.99 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003835 s, Result = 001e0000, Performance =  16.80 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004985 s, Result = 00280000, Performance =  17.23 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004160 s, Result = 00320000, Performance =  25.81 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004636 s, Result = 003c0000, Performance =  27.79 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005509 s, Result = 00460000, Performance =  27.29 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006208 s, Result = 00500000, Performance =  27.68 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007073 s, Result = 005a0000, Performance =  27.32 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007858 s, Result = 00640000, Performance =  27.33 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008815 s, Result = 006e0000, Performance =  26.80 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009918 s, Result = 00780000, Performance =  25.98 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010896 s, Result = 00820000, Performance =  25.62 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012134 s, Result = 008c0000, Performance =  24.78 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013456 s, Result = 00960000, Performance =  23.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014179 s, Result = 00a00000, Performance =  24.23 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.015334 s, Result = 00aa0000, Performance =  23.81 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.016578 s, Result = 00b40000, Performance =  23.32 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018130 s, Result = 00be0000, Performance =  22.51 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020083 s, Result = 00c80000, Performance =  21.39 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021323 s, Result = 00d20000, Performance =  21.15 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023643 s, Result = 00dc0000, Performance =  19.98 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025239 s, Result = 00e60000, Performance =  19.57 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027026 s, Result = 00f00000, Performance =  19.07 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029054 s, Result = 00fa0000, Performance =  18.48 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031102 s, Result = 01040000, Performance =  17.95 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.033048 s, Result = 010e0000, Performance =  17.54 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.034774 s, Result = 01180000, Performance =  17.29 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037165 s, Result = 01220000, Performance =  16.76 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.039618 s, Result = 012c0000, Performance =  16.26 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.041067 s, Result = 01360000, Performance =  16.21 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.042183 s, Result = 01400000, Performance =  16.29 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.042802 s, Result = 014a0000, Performance =  16.56 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.044613 s, Result = 01540000, Performance =  16.37 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.046568 s, Result = 015e0000, Performance =  16.14 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.048762 s, Result = 01680000, Performance =  15.85 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.050439 s, Result = 01720000, Performance =  15.75 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.051814 s, Result = 017c0000, Performance =  15.75 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.053618 s, Result = 01860000, Performance =  15.62 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.055843 s, Result = 01900000, Performance =  15.38 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.057639 s, Result = 019a0000, Performance =  15.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.060071 s, Result = 01a40000, Performance =  15.01 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.060354 s, Result = 01ae0000, Performance =  15.30 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.063388 s, Result = 01b80000, Performance =  14.91 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.071427 s, Result = 01c20000, Performance =  13.53 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.066997 s, Result = 01cc0000, Performance =  14.74 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.068369 s, Result = 01d60000, Performance =  14.76 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.070036 s, Result = 01e00000, Performance =  14.72 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.071801 s, Result = 01ea0000, Performance =  14.66 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.073659 s, Result = 01f40000, Performance =  14.58 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.075680 s, Result = 01fe0000, Performance =  14.47 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.077550 s, Result = 02080000, Performance =  14.40 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.079211 s, Result = 02120000, Performance =  14.37 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.080871 s, Result = 021c0000, Performance =  14.34 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.082362 s, Result = 02260000, Performance =  14.34 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.083371 s, Result = 02300000, Performance =  14.42 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.084320 s, Result = 023a0000, Performance =  14.52 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.086229 s, Result = 02440000, Performance =  14.44 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.087346 s, Result = 024e0000, Performance =  14.51 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.088361 s, Result = 02580000, Performance =  14.58 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.090517 s, Result = 02620000, Performance =  14.47 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.091660 s, Result = 026c0000, Performance =  14.53 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.087344 s, Result = 02760000, Performance =  15.49 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.113168 s, Result = 02800000, Performance =  12.14 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    36  1087  1920
Test passed: M N K =   406    54   640
Test passed: M N K =   351  1786  1984
Test passed: M N K =   181   113  1088
Test passed: M N K =   541  1028   768
M N K =  2048  2048   256, Elapsed time =   0.006702 s, Result = 440e0000, Performance =   3.20 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006455 s, Result = 84180000, Performance =   6.65 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008320 s, Result = c4220000, Performance =   7.74 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009476 s, Result = 042c0000, Performance =   9.06 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010372 s, Result = 44360000, Performance =  10.35 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011811 s, Result = 84400000, Performance =  10.91 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013157 s, Result = c44a0000, Performance =  11.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014582 s, Result = 04540000, Performance =  11.78 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.016442 s, Result = 445e0000, Performance =  11.75 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017295 s, Result = 84680000, Performance =  12.42 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018904 s, Result = c4720000, Performance =  12.50 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020006 s, Result = 047c0000, Performance =  12.88 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022500 s, Result = 44860000, Performance =  12.41 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023547 s, Result = 84900000, Performance =  12.77 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025498 s, Result = c49a0000, Performance =  12.63 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.026956 s, Result = 04a40000, Performance =  12.75 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.029895 s, Result = 44ae0000, Performance =  12.21 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.031088 s, Result = 84b80000, Performance =  12.43 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.032968 s, Result = c4c20000, Performance =  12.38 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.034733 s, Result = 04cc0000, Performance =  12.37 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.036772 s, Result = 44d60000, Performance =  12.26 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.038655 s, Result = 84e00000, Performance =  12.22 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.040444 s, Result = c4ea0000, Performance =  12.21 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.042057 s, Result = 04f40000, Performance =  12.25 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.044923 s, Result = 44fe0000, Performance =  11.95 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.049200 s, Result = 85080000, Performance =  11.35 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.050701 s, Result = c5120000, Performance =  11.44 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.052388 s, Result = 051c0000, Performance =  11.48 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.054150 s, Result = 45260000, Performance =  11.50 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.055715 s, Result = 85300000, Performance =  11.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.057272 s, Result = c53a0000, Performance =  11.62 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.060594 s, Result = 05440000, Performance =  11.34 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.060129 s, Result = 454e0000, Performance =  11.79 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.059518 s, Result = 85580000, Performance =  12.27 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.062071 s, Result = c5620000, Performance =  12.11 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.063676 s, Result = 056c0000, Performance =  12.14 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.065679 s, Result = 45760000, Performance =  12.10 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.067462 s, Result = 85800000, Performance =  12.10 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.068404 s, Result = c58a0000, Performance =  12.24 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.069266 s, Result = 05940000, Performance =  12.40 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.071138 s, Result = 459e0000, Performance =  12.38 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.071569 s, Result = 85a80000, Performance =  12.60 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.073493 s, Result = c5b20000, Performance =  12.56 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.075027 s, Result = 05bc0000, Performance =  12.59 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.076606 s, Result = 45c60000, Performance =  12.61 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.078142 s, Result = 85d00000, Performance =  12.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.080184 s, Result = c5da0000, Performance =  12.59 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.081222 s, Result = 05e40000, Performance =  12.69 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.083224 s, Result = 45ee0000, Performance =  12.64 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.084213 s, Result = 85f80000, Performance =  12.75 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.086035 s, Result = c6020000, Performance =  12.73 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.086841 s, Result = 060c0000, Performance =  12.86 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.087980 s, Result = 46160000, Performance =  12.94 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.089152 s, Result = 86200000, Performance =  13.01 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.090585 s, Result = c62a0000, Performance =  13.04 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.091161 s, Result = 06340000, Performance =  13.19 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.093152 s, Result = 463e0000, Performance =  13.14 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.094887 s, Result = 86480000, Performance =  13.13 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.095724 s, Result = c6520000, Performance =  13.24 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.099072 s, Result = 065c0000, Performance =  13.01 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.098650 s, Result = 46660000, Performance =  13.28 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.097426 s, Result = 86700000, Performance =  13.67 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.099856 s, Result = c67a0000, Performance =  13.55 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.139667 s, Result = 06840000, Performance =   9.84 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1864   136   192
Test passed: M N K =   834  1663  1344
Test passed: M N K =  1285   419   384
Test passed: M N K =  1843  1729  1024
Test passed: M N K =  1974   303   576
M N K =  2048  2048   256, Elapsed time =   0.007290 s, Result = 000a0000, Performance =   2.95 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004268 s, Result = 00140000, Performance =  10.06 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004840 s, Result = 001e0000, Performance =  13.31 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006137 s, Result = 00280000, Performance =  14.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007171 s, Result = 00320000, Performance =  14.97 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008685 s, Result = 003c0000, Performance =  14.84 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009563 s, Result = 00460000, Performance =  15.72 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010288 s, Result = 00500000, Performance =  16.70 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011912 s, Result = 005a0000, Performance =  16.23 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013167 s, Result = 00640000, Performance =  16.31 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014463 s, Result = 006e0000, Performance =  16.33 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016122 s, Result = 00780000, Performance =  15.98 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.017200 s, Result = 00820000, Performance =  16.23 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018958 s, Result = 008c0000, Performance =  15.86 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020220 s, Result = 00960000, Performance =  15.93 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021937 s, Result = 00a00000, Performance =  15.66 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023569 s, Result = 00aa0000, Performance =  15.49 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025111 s, Result = 00b40000, Performance =  15.39 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.026624 s, Result = 00be0000, Performance =  15.33 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028256 s, Result = 00c80000, Performance =  15.20 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.030404 s, Result = 00d20000, Performance =  14.83 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.032529 s, Result = 00dc0000, Performance =  14.52 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034036 s, Result = 00e60000, Performance =  14.51 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035955 s, Result = 00f00000, Performance =  14.33 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037638 s, Result = 00fa0000, Performance =  14.26 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039872 s, Result = 01040000, Performance =  14.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041232 s, Result = 010e0000, Performance =  14.06 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.043393 s, Result = 01180000, Performance =  13.86 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.044772 s, Result = 01220000, Performance =  13.91 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.046898 s, Result = 012c0000, Performance =  13.74 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.048773 s, Result = 01360000, Performance =  13.65 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.050910 s, Result = 01400000, Performance =  13.50 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.050705 s, Result = 014a0000, Performance =  13.98 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.051246 s, Result = 01540000, Performance =  14.25 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.053029 s, Result = 015e0000, Performance =  14.17 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.054400 s, Result = 01680000, Performance =  14.21 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.056013 s, Result = 01720000, Performance =  14.19 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058490 s, Result = 017c0000, Performance =  13.95 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.059958 s, Result = 01860000, Performance =  13.97 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.061928 s, Result = 01900000, Performance =  13.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.065698 s, Result = 019a0000, Performance =  13.40 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.066826 s, Result = 01a40000, Performance =  13.50 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.069635 s, Result = 01ae0000, Performance =  13.26 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.070743 s, Result = 01b80000, Performance =  13.36 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.072157 s, Result = 01c20000, Performance =  13.39 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.073395 s, Result = 01cc0000, Performance =  13.46 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.075270 s, Result = 01d60000, Performance =  13.41 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.076160 s, Result = 01e00000, Performance =  13.53 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.077834 s, Result = 01ea0000, Performance =  13.52 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.078940 s, Result = 01f40000, Performance =  13.60 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.080900 s, Result = 01fe0000, Performance =  13.54 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.081267 s, Result = 02080000, Performance =  13.74 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.082827 s, Result = 02120000, Performance =  13.74 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.083768 s, Result = 021c0000, Performance =  13.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.085373 s, Result = 02260000, Performance =  13.83 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.086016 s, Result = 02300000, Performance =  13.98 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.088023 s, Result = 023a0000, Performance =  13.91 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.089171 s, Result = 02440000, Performance =  13.97 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.089802 s, Result = 024e0000, Performance =  14.11 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.093155 s, Result = 02580000, Performance =  13.83 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.092276 s, Result = 02620000, Performance =  14.20 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.091531 s, Result = 026c0000, Performance =  14.55 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.093891 s, Result = 02760000, Performance =  14.41 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.130261 s, Result = 02800000, Performance =  10.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   980    70  1152
Test passed: M N K =   299  1729  1536
Test passed: M N K =   509  1681  1344
Test passed: M N K =   393  1780   192
Test passed: M N K =   508  1691  1920
M N K =  2048  2048   256, Elapsed time =   0.008630 s, Result = 28320000, Performance =   2.49 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006911 s, Result = 283c0000, Performance =   6.21 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008656 s, Result = 28460000, Performance =   7.44 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009440 s, Result = 28500000, Performance =   9.10 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010062 s, Result = 285a0000, Performance =  10.67 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011019 s, Result = 28640000, Performance =  11.69 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012572 s, Result = 286e0000, Performance =  11.96 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013435 s, Result = 28780000, Performance =  12.79 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014426 s, Result = 28820000, Performance =  13.40 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014930 s, Result = 288c0000, Performance =  14.38 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016168 s, Result = 28960000, Performance =  14.61 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017021 s, Result = 28a00000, Performance =  15.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018192 s, Result = 28aa0000, Performance =  15.35 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019069 s, Result = 28b40000, Performance =  15.77 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020287 s, Result = 28be0000, Performance =  15.88 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.020998 s, Result = 28c80000, Performance =  16.36 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.022897 s, Result = 28d20000, Performance =  15.94 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.024187 s, Result = 28dc0000, Performance =  15.98 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.025675 s, Result = 28e60000, Performance =  15.89 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.026899 s, Result = 28f00000, Performance =  15.97 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028920 s, Result = 28fa0000, Performance =  15.59 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030323 s, Result = 29040000, Performance =  15.58 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032072 s, Result = 290e0000, Performance =  15.40 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033609 s, Result = 29180000, Performance =  15.33 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.035639 s, Result = 29220000, Performance =  15.06 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037652 s, Result = 292c0000, Performance =  14.83 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038870 s, Result = 29360000, Performance =  14.92 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.040411 s, Result = 29400000, Performance =  14.88 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.042562 s, Result = 294a0000, Performance =  14.63 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043874 s, Result = 29540000, Performance =  14.68 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.046061 s, Result = 295e0000, Performance =  14.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.048056 s, Result = 29680000, Performance =  14.30 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.047820 s, Result = 29720000, Performance =  14.82 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048083 s, Result = 297c0000, Performance =  15.18 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.049733 s, Result = 29860000, Performance =  15.11 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.051204 s, Result = 29900000, Performance =  15.10 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.053439 s, Result = 299a0000, Performance =  14.87 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.054455 s, Result = 29a40000, Performance =  14.99 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061313 s, Result = 29ae0000, Performance =  13.66 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.063271 s, Result = 29b80000, Performance =  13.58 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.065159 s, Result = 29c20000, Performance =  13.51 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.065704 s, Result = 29cc0000, Performance =  13.73 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.067887 s, Result = 29d60000, Performance =  13.60 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.069525 s, Result = 29e00000, Performance =  13.59 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.070847 s, Result = 29ea0000, Performance =  13.64 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.072349 s, Result = 29f40000, Performance =  13.65 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.073946 s, Result = 29fe0000, Performance =  13.65 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.074933 s, Result = 2a080000, Performance =  13.76 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.076318 s, Result = 2a120000, Performance =  13.79 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.077757 s, Result = 2a1c0000, Performance =  13.81 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.079129 s, Result = 2a260000, Performance =  13.84 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.080137 s, Result = 2a300000, Performance =  13.93 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.081339 s, Result = 2a3a0000, Performance =  13.99 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.082702 s, Result = 2a440000, Performance =  14.02 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.084007 s, Result = 2a4e0000, Performance =  14.06 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.084433 s, Result = 2a580000, Performance =  14.24 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.086477 s, Result = 2a620000, Performance =  14.15 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.087751 s, Result = 2a6c0000, Performance =  14.19 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.088606 s, Result = 2a760000, Performance =  14.30 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.092022 s, Result = 2a800000, Performance =  14.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.090363 s, Result = 2a8a0000, Performance =  14.50 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.091411 s, Result = 2a940000, Performance =  14.57 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.093935 s, Result = 2a9e0000, Performance =  14.40 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.136227 s, Result = 2aa80000, Performance =  10.09 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1267  1444  1024
Test passed: M N K =  1680  1849   768
Test passed: M N K =  2030  1222   896
Test passed: M N K =   366  1316   896
Test passed: M N K =  1699  1907   960
M N K =  2048  2048   256, Elapsed time =   0.001071 s, Result = 000a0000, Performance =  20.05 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002143 s, Result = 00140000, Performance =  20.04 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003810 s, Result = 001e0000, Performance =  16.91 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004665 s, Result = 00280000, Performance =  18.41 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003917 s, Result = 00320000, Performance =  27.41 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004648 s, Result = 003c0000, Performance =  27.72 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005420 s, Result = 00460000, Performance =  27.74 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.006163 s, Result = 00500000, Performance =  27.87 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006967 s, Result = 005a0000, Performance =  27.74 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007922 s, Result = 00640000, Performance =  27.11 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008745 s, Result = 006e0000, Performance =  27.01 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.009663 s, Result = 00780000, Performance =  26.67 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.010517 s, Result = 00820000, Performance =  26.54 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.011469 s, Result = 008c0000, Performance =  26.21 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.012358 s, Result = 00960000, Performance =  26.07 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.013194 s, Result = 00a00000, Performance =  26.04 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014809 s, Result = 00aa0000, Performance =  24.65 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015785 s, Result = 00b40000, Performance =  24.49 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016922 s, Result = 00be0000, Performance =  24.11 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018506 s, Result = 00c80000, Performance =  23.21 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019812 s, Result = 00d20000, Performance =  22.76 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021785 s, Result = 00dc0000, Performance =  21.69 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.023126 s, Result = 00e60000, Performance =  21.36 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024545 s, Result = 00f00000, Performance =  21.00 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026570 s, Result = 00fa0000, Performance =  20.21 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028692 s, Result = 01040000, Performance =  19.46 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.030403 s, Result = 010e0000, Performance =  19.07 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032047 s, Result = 01180000, Performance =  18.76 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.034305 s, Result = 01220000, Performance =  18.15 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.035982 s, Result = 012c0000, Performance =  17.90 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.038034 s, Result = 01360000, Performance =  17.50 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039974 s, Result = 01400000, Performance =  17.19 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039826 s, Result = 014a0000, Performance =  17.79 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.040046 s, Result = 01540000, Performance =  18.23 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.042170 s, Result = 015e0000, Performance =  17.82 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.044327 s, Result = 01680000, Performance =  17.44 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.046040 s, Result = 01720000, Performance =  17.26 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.047579 s, Result = 017c0000, Performance =  17.15 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.052727 s, Result = 01860000, Performance =  15.88 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.056119 s, Result = 01900000, Performance =  15.31 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.057507 s, Result = 019a0000, Performance =  15.31 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.057974 s, Result = 01a40000, Performance =  15.56 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.060183 s, Result = 01ae0000, Performance =  15.34 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.061203 s, Result = 01b80000, Performance =  15.44 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.063266 s, Result = 01c20000, Performance =  15.27 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.064465 s, Result = 01cc0000, Performance =  15.32 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.066551 s, Result = 01d60000, Performance =  15.17 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.067513 s, Result = 01e00000, Performance =  15.27 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.069309 s, Result = 01ea0000, Performance =  15.18 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.070231 s, Result = 01f40000, Performance =  15.29 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.072267 s, Result = 01fe0000, Performance =  15.16 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.073065 s, Result = 02080000, Performance =  15.28 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.074296 s, Result = 02120000, Performance =  15.32 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.075225 s, Result = 021c0000, Performance =  15.42 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.075964 s, Result = 02260000, Performance =  15.55 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.076704 s, Result = 02300000, Performance =  15.68 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.078964 s, Result = 023a0000, Performance =  15.50 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.079876 s, Result = 02440000, Performance =  15.59 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.080835 s, Result = 024e0000, Performance =  15.67 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.083365 s, Result = 02580000, Performance =  15.46 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.083132 s, Result = 02620000, Performance =  15.76 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.084231 s, Result = 026c0000, Performance =  15.81 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.087123 s, Result = 02760000, Performance =  15.53 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.120012 s, Result = 02800000, Performance =  11.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    80   210  1728
Test passed: M N K =  1861   948  1216
Test passed: M N K =  1338  1605  1536
Test passed: M N K =  1172  1242  1152
Test passed: M N K =   794   497  1152
M N K =  2048  2048   256, Elapsed time =   0.008203 s, Result = 440e0000, Performance =   2.62 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006544 s, Result = 84180000, Performance =   6.56 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008144 s, Result = c4220000, Performance =   7.91 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009623 s, Result = 042c0000, Performance =   8.93 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010858 s, Result = 44360000, Performance =   9.89 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012089 s, Result = 84400000, Performance =  10.66 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013471 s, Result = c44a0000, Performance =  11.16 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014854 s, Result = 04540000, Performance =  11.57 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015316 s, Result = 445e0000, Performance =  12.62 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016874 s, Result = 84680000, Performance =  12.73 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018133 s, Result = c4720000, Performance =  13.03 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019381 s, Result = 047c0000, Performance =  13.30 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021628 s, Result = 44860000, Performance =  12.91 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.023142 s, Result = 84900000, Performance =  12.99 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.024754 s, Result = c49a0000, Performance =  13.01 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025971 s, Result = 04a40000, Performance =  13.23 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028903 s, Result = 44ae0000, Performance =  12.63 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029963 s, Result = 84b80000, Performance =  12.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.032137 s, Result = c4c20000, Performance =  12.70 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.033301 s, Result = 04cc0000, Performance =  12.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.035257 s, Result = 44d60000, Performance =  12.79 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.037162 s, Result = 84e00000, Performance =  12.71 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.040479 s, Result = c4ea0000, Performance =  12.20 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.043024 s, Result = 04f40000, Performance =  11.98 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.044873 s, Result = 44fe0000, Performance =  11.96 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.047434 s, Result = 85080000, Performance =  11.77 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.048595 s, Result = c5120000, Performance =  11.93 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.049224 s, Result = 051c0000, Performance =  12.22 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051252 s, Result = 45260000, Performance =  12.15 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052693 s, Result = 85300000, Performance =  12.23 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054042 s, Result = c53a0000, Performance =  12.32 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.058149 s, Result = 05440000, Performance =  11.82 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.057596 s, Result = 454e0000, Performance =  12.30 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.059089 s, Result = 85580000, Performance =  12.36 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059680 s, Result = c5620000, Performance =  12.59 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.059408 s, Result = 056c0000, Performance =  13.01 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.061172 s, Result = 45760000, Performance =  12.99 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.062523 s, Result = 85800000, Performance =  13.05 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.064581 s, Result = c58a0000, Performance =  12.97 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.064826 s, Result = 05940000, Performance =  13.25 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.066947 s, Result = 459e0000, Performance =  13.15 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.068031 s, Result = 85a80000, Performance =  13.26 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.069696 s, Result = c5b20000, Performance =  13.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.069810 s, Result = 05bc0000, Performance =  13.54 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.072798 s, Result = 45c60000, Performance =  13.27 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.074075 s, Result = 85d00000, Performance =  13.34 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.083311 s, Result = c5da0000, Performance =  12.12 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.077271 s, Result = 05e40000, Performance =  13.34 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.079833 s, Result = 45ee0000, Performance =  13.18 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.080257 s, Result = 85f80000, Performance =  13.38 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.082280 s, Result = c6020000, Performance =  13.31 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.082785 s, Result = 060c0000, Performance =  13.49 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.084585 s, Result = 46160000, Performance =  13.46 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.086075 s, Result = 86200000, Performance =  13.47 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.087879 s, Result = c62a0000, Performance =  13.44 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.088801 s, Result = 06340000, Performance =  13.54 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.090713 s, Result = 463e0000, Performance =  13.49 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.092762 s, Result = 86480000, Performance =  13.43 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.095416 s, Result = c6520000, Performance =  13.28 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.092891 s, Result = 065c0000, Performance =  13.87 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.096045 s, Result = 46660000, Performance =  13.64 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.097544 s, Result = 86700000, Performance =  13.65 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.096018 s, Result = c67a0000, Performance =  14.09 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.120831 s, Result = 06840000, Performance =  11.37 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   501   431  1472
Test passed: M N K =   245    23   704
Test passed: M N K =  1264   458  1856
Test passed: M N K =   591  1324   704
Test passed: M N K =  2028  1897  1600
M N K =  2048  2048   256, Elapsed time =   0.007314 s, Result = 000a0000, Performance =   2.94 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004194 s, Result = 00140000, Performance =  10.24 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004797 s, Result = 001e0000, Performance =  13.43 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005970 s, Result = 00280000, Performance =  14.39 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007284 s, Result = 00320000, Performance =  14.74 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008619 s, Result = 003c0000, Performance =  14.95 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009351 s, Result = 00460000, Performance =  16.07 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010467 s, Result = 00500000, Performance =  16.41 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011925 s, Result = 005a0000, Performance =  16.21 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013105 s, Result = 00640000, Performance =  16.39 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014307 s, Result = 006e0000, Performance =  16.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015757 s, Result = 00780000, Performance =  16.35 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016566 s, Result = 00820000, Performance =  16.85 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018100 s, Result = 008c0000, Performance =  16.61 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.019472 s, Result = 00960000, Performance =  16.54 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.020606 s, Result = 00a00000, Performance =  16.67 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.022939 s, Result = 00aa0000, Performance =  15.92 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.023994 s, Result = 00b40000, Performance =  16.11 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.025345 s, Result = 00be0000, Performance =  16.10 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.027044 s, Result = 00c80000, Performance =  15.88 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028429 s, Result = 00d20000, Performance =  15.86 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030069 s, Result = 00dc0000, Performance =  15.71 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032247 s, Result = 00e60000, Performance =  15.32 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033483 s, Result = 00f00000, Performance =  15.39 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.035542 s, Result = 00fa0000, Performance =  15.11 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037007 s, Result = 01040000, Performance =  15.09 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038849 s, Result = 010e0000, Performance =  14.92 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.040161 s, Result = 01180000, Performance =  14.97 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.042231 s, Result = 01220000, Performance =  14.75 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043697 s, Result = 012c0000, Performance =  14.74 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.045365 s, Result = 01360000, Performance =  14.67 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.048404 s, Result = 01400000, Performance =  14.20 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.049101 s, Result = 014a0000, Performance =  14.43 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.050799 s, Result = 01540000, Performance =  14.37 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051510 s, Result = 015e0000, Performance =  14.59 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.051900 s, Result = 01680000, Performance =  14.90 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.053819 s, Result = 01720000, Performance =  14.76 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.055027 s, Result = 017c0000, Performance =  14.83 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.055871 s, Result = 01860000, Performance =  14.99 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.057348 s, Result = 01900000, Performance =  14.98 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.061007 s, Result = 019a0000, Performance =  14.43 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.061176 s, Result = 01a40000, Performance =  14.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.062858 s, Result = 01ae0000, Performance =  14.69 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.064505 s, Result = 01b80000, Performance =  14.65 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.068500 s, Result = 01c20000, Performance =  14.11 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.069283 s, Result = 01cc0000, Performance =  14.26 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.071440 s, Result = 01d60000, Performance =  14.13 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.071465 s, Result = 01e00000, Performance =  14.42 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.074105 s, Result = 01ea0000, Performance =  14.20 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.074774 s, Result = 01f40000, Performance =  14.36 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.076782 s, Result = 01fe0000, Performance =  14.26 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.077075 s, Result = 02080000, Performance =  14.49 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.078856 s, Result = 02120000, Performance =  14.43 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.080302 s, Result = 021c0000, Performance =  14.44 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.081868 s, Result = 02260000, Performance =  14.43 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.082157 s, Result = 02300000, Performance =  14.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.083920 s, Result = 023a0000, Performance =  14.59 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.085508 s, Result = 02440000, Performance =  14.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.088411 s, Result = 024e0000, Performance =  14.33 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.086365 s, Result = 02580000, Performance =  14.92 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.089342 s, Result = 02620000, Performance =  14.66 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.090833 s, Result = 026c0000, Performance =  14.66 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.089797 s, Result = 02760000, Performance =  15.07 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.114425 s, Result = 02800000, Performance =  12.01 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   966   282  1472
Test passed: M N K =   255  1203   448
Test passed: M N K =   490  1471  1792
Test passed: M N K =  1822   881   128
Test passed: M N K =  1354  1522   384
M N K =  2048  2048   256, Elapsed time =   0.008980 s, Result = 28320000, Performance =   2.39 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007390 s, Result = 283c0000, Performance =   5.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008959 s, Result = 28460000, Performance =   7.19 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009756 s, Result = 28500000, Performance =   8.81 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011432 s, Result = 285a0000, Performance =   9.39 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012587 s, Result = 28640000, Performance =  10.24 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013274 s, Result = 286e0000, Performance =  11.32 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014910 s, Result = 28780000, Performance =  11.52 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014633 s, Result = 28820000, Performance =  13.21 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016777 s, Result = 288c0000, Performance =  12.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017739 s, Result = 28960000, Performance =  13.32 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018068 s, Result = 28a00000, Performance =  14.26 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018655 s, Result = 28aa0000, Performance =  14.97 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018896 s, Result = 28b40000, Performance =  15.91 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020376 s, Result = 28be0000, Performance =  15.81 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021708 s, Result = 28c80000, Performance =  15.83 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.022224 s, Result = 28d20000, Performance =  16.43 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022935 s, Result = 28dc0000, Performance =  16.85 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.024586 s, Result = 28e60000, Performance =  16.60 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.026855 s, Result = 28f00000, Performance =  15.99 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028526 s, Result = 28fa0000, Performance =  15.81 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.029640 s, Result = 29040000, Performance =  15.94 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.031321 s, Result = 290e0000, Performance =  15.77 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.032569 s, Result = 29180000, Performance =  15.82 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.033732 s, Result = 29220000, Performance =  15.92 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.043193 s, Result = 292c0000, Performance =  12.93 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.037600 s, Result = 29360000, Performance =  15.42 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.038193 s, Result = 29400000, Performance =  15.74 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.041366 s, Result = 294a0000, Performance =  15.06 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.042714 s, Result = 29540000, Performance =  15.08 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.044146 s, Result = 295e0000, Performance =  15.08 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.046116 s, Result = 29680000, Performance =  14.90 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.046410 s, Result = 29720000, Performance =  15.27 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048269 s, Result = 297c0000, Performance =  15.13 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.049204 s, Result = 29860000, Performance =  15.28 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.052155 s, Result = 29900000, Performance =  14.82 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.056797 s, Result = 299a0000, Performance =  13.99 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058222 s, Result = 29a40000, Performance =  14.02 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.060356 s, Result = 29ae0000, Performance =  13.88 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.060950 s, Result = 29b80000, Performance =  14.09 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.061650 s, Result = 29c20000, Performance =  14.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.062719 s, Result = 29cc0000, Performance =  14.38 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.064568 s, Result = 29d60000, Performance =  14.30 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.065104 s, Result = 29e00000, Performance =  14.51 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.068040 s, Result = 29ea0000, Performance =  14.20 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.069219 s, Result = 29f40000, Performance =  14.27 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.071085 s, Result = 29fe0000, Performance =  14.20 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.071098 s, Result = 2a080000, Performance =  14.50 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.073231 s, Result = 2a120000, Performance =  14.37 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.074296 s, Result = 2a1c0000, Performance =  14.45 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.076241 s, Result = 2a260000, Performance =  14.37 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.076342 s, Result = 2a300000, Performance =  14.63 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.078343 s, Result = 2a3a0000, Performance =  14.53 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.080178 s, Result = 2a440000, Performance =  14.46 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.081363 s, Result = 2a4e0000, Performance =  14.52 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.082142 s, Result = 2a580000, Performance =  14.64 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.083772 s, Result = 2a620000, Performance =  14.61 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.085022 s, Result = 2a6c0000, Performance =  14.65 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.087792 s, Result = 2a760000, Performance =  14.43 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.086779 s, Result = 2a800000, Performance =  14.85 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.088673 s, Result = 2a8a0000, Performance =  14.77 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.091431 s, Result = 2a940000, Performance =  14.56 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.090832 s, Result = 2a9e0000, Performance =  14.89 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.112498 s, Result = 2aa80000, Performance =  12.22 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1366  2035  1984
Test passed: M N K =   359  1366   960
Test passed: M N K =  1184  1403  1792
Test passed: M N K =  1163   516  1280
Test passed: M N K =  1195  1834   704
M N K =  2048  2048   256, Elapsed time =   0.001030 s, Result = 000a0000, Performance =  20.85 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002121 s, Result = 00140000, Performance =  20.25 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003566 s, Result = 001e0000, Performance =  18.07 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004377 s, Result = 00280000, Performance =  19.63 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004817 s, Result = 00320000, Performance =  22.29 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005523 s, Result = 003c0000, Performance =  23.33 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005935 s, Result = 00460000, Performance =  25.33 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007153 s, Result = 00500000, Performance =  24.02 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.007798 s, Result = 005a0000, Performance =  24.79 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.008972 s, Result = 00640000, Performance =  23.94 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.008673 s, Result = 006e0000, Performance =  27.24 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.010674 s, Result = 00780000, Performance =  24.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.011591 s, Result = 00820000, Performance =  24.09 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.012035 s, Result = 008c0000, Performance =  24.98 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013602 s, Result = 00960000, Performance =  23.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014023 s, Result = 00a00000, Performance =  24.50 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014762 s, Result = 00aa0000, Performance =  24.73 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015276 s, Result = 00b40000, Performance =  25.30 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.016463 s, Result = 00be0000, Performance =  24.78 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017320 s, Result = 00c80000, Performance =  24.80 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018652 s, Result = 00d20000, Performance =  24.18 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.020011 s, Result = 00dc0000, Performance =  23.61 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.021757 s, Result = 00e60000, Performance =  22.70 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022921 s, Result = 00f00000, Performance =  22.49 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026104 s, Result = 00fa0000, Performance =  20.57 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.027554 s, Result = 01040000, Performance =  20.26 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.029419 s, Result = 010e0000, Performance =  19.71 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.031026 s, Result = 01180000, Performance =  19.38 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.032613 s, Result = 01220000, Performance =  19.10 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.033578 s, Result = 012c0000, Performance =  19.19 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.036108 s, Result = 01360000, Performance =  18.44 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038130 s, Result = 01400000, Performance =  18.02 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039093 s, Result = 014a0000, Performance =  18.13 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.041403 s, Result = 01540000, Performance =  17.64 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.041910 s, Result = 015e0000, Performance =  17.93 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.042697 s, Result = 01680000, Performance =  18.11 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.044643 s, Result = 01720000, Performance =  17.80 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.045047 s, Result = 017c0000, Performance =  18.12 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.046783 s, Result = 01860000, Performance =  17.90 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.048354 s, Result = 01900000, Performance =  17.76 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.052079 s, Result = 019a0000, Performance =  16.91 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.055000 s, Result = 01a40000, Performance =  16.40 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.057749 s, Result = 01ae0000, Performance =  15.99 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.057807 s, Result = 01b80000, Performance =  16.35 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.060143 s, Result = 01c20000, Performance =  16.07 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.060600 s, Result = 01cc0000, Performance =  16.30 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.062569 s, Result = 01d60000, Performance =  16.13 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.062606 s, Result = 01e00000, Performance =  16.46 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.065640 s, Result = 01ea0000, Performance =  16.03 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.066770 s, Result = 01f40000, Performance =  16.08 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.068257 s, Result = 01fe0000, Performance =  16.05 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.068334 s, Result = 02080000, Performance =  16.34 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.071084 s, Result = 02120000, Performance =  16.01 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.071961 s, Result = 021c0000, Performance =  16.11 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.073944 s, Result = 02260000, Performance =  15.97 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.074234 s, Result = 02300000, Performance =  16.20 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.076689 s, Result = 023a0000, Performance =  15.96 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.078092 s, Result = 02440000, Performance =  15.95 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.080181 s, Result = 024e0000, Performance =  15.80 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.078708 s, Result = 02580000, Performance =  16.37 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.080876 s, Result = 02620000, Performance =  16.20 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.082884 s, Result = 026c0000, Performance =  16.06 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.083425 s, Result = 02760000, Performance =  16.22 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.104619 s, Result = 02800000, Performance =  13.14 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   144   345  1600
Test passed: M N K =    96   967  1088
Test passed: M N K =  1560    61  1600
Test passed: M N K =   602  1875  1728
Test passed: M N K =   564   202   960
M N K =  2048  2048   256, Elapsed time =   0.008355 s, Result = 640b8000, Performance =   2.57 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006027 s, Result = c4130000, Performance =   7.13 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008628 s, Result = 241a8000, Performance =   7.47 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010092 s, Result = 84220000, Performance =   8.51 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010665 s, Result = e4298000, Performance =  10.07 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012133 s, Result = 44310000, Performance =  10.62 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013184 s, Result = a4388000, Performance =  11.40 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014335 s, Result = 04400000, Performance =  11.98 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014620 s, Result = 64478000, Performance =  13.22 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017071 s, Result = c44f0000, Performance =  12.58 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016277 s, Result = 24568000, Performance =  14.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019076 s, Result = 845e0000, Performance =  13.51 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019959 s, Result = e4658000, Performance =  13.99 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021735 s, Result = 446d0000, Performance =  13.83 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022829 s, Result = a4748000, Performance =  14.11 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024085 s, Result = 047c0000, Performance =  14.27 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027350 s, Result = 64838000, Performance =  13.35 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.027611 s, Result = c48b0000, Performance =  14.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030208 s, Result = 24928000, Performance =  13.51 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032056 s, Result = 849a0000, Performance =  13.40 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033469 s, Result = e4a18000, Performance =  13.47 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.034366 s, Result = 44a90000, Performance =  13.75 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.035944 s, Result = a4b08000, Performance =  13.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038120 s, Result = 04b80000, Performance =  13.52 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.039454 s, Result = 64bf8000, Performance =  13.61 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.041324 s, Result = c4c70000, Performance =  13.51 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.043561 s, Result = 24ce8000, Performance =  13.31 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.045019 s, Result = 84d60000, Performance =  13.36 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.048198 s, Result = e4dd8000, Performance =  12.92 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.049614 s, Result = 44e50000, Performance =  12.99 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.053564 s, Result = a4ec8000, Performance =  12.43 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.056591 s, Result = 04f40000, Performance =  12.14 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.057232 s, Result = 64fb8000, Performance =  12.38 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058009 s, Result = c5030000, Performance =  12.59 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.059897 s, Result = 250a8000, Performance =  12.55 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.061103 s, Result = 85120000, Performance =  12.65 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.062352 s, Result = e5198000, Performance =  12.74 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.063293 s, Result = 45210000, Performance =  12.89 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.064273 s, Result = a5288000, Performance =  13.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.065469 s, Result = 05300000, Performance =  13.12 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.066357 s, Result = 65378000, Performance =  13.27 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.067272 s, Result = c53f0000, Performance =  13.41 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.067455 s, Result = 25468000, Performance =  13.69 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.070218 s, Result = 854e0000, Performance =  13.46 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.072392 s, Result = e5558000, Performance =  13.35 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.073405 s, Result = 455d0000, Performance =  13.46 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.074303 s, Result = a5648000, Performance =  13.58 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.075336 s, Result = 056c0000, Performance =  13.68 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.075805 s, Result = 65738000, Performance =  13.88 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.077216 s, Result = c57b0000, Performance =  13.91 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.078302 s, Result = 25828000, Performance =  13.99 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.079386 s, Result = 858a0000, Performance =  14.07 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.080557 s, Result = e5918000, Performance =  14.13 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.081434 s, Result = 45990000, Performance =  14.24 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.082148 s, Result = a5a08000, Performance =  14.38 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.082338 s, Result = 05a80000, Performance =  14.61 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.082880 s, Result = 65af8000, Performance =  14.77 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.082979 s, Result = c5b70000, Performance =  15.01 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.083241 s, Result = 25be8000, Performance =  15.22 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.084331 s, Result = 85c60000, Performance =  15.28 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.085693 s, Result = e5cd8000, Performance =  15.29 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.085886 s, Result = 45d50000, Performance =  15.50 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.083930 s, Result = a5dc8000, Performance =  16.12 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.105641 s, Result = 05e40000, Performance =  13.01 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   434   108   320
Test passed: M N K =  2042  1459  1024
Test passed: M N K =   980  2047  1536
Test passed: M N K =   922   873   896
Test passed: M N K =  1065   903   896
M N K =  2048  2048   256, Elapsed time =   0.006260 s, Result = 00078000, Performance =   3.43 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004169 s, Result = 000f0000, Performance =  10.30 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004357 s, Result = 00168000, Performance =  14.79 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006411 s, Result = 001e0000, Performance =  13.40 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006221 s, Result = 00258000, Performance =  17.26 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007321 s, Result = 002d0000, Performance =  17.60 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009550 s, Result = 00348000, Performance =  15.74 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010419 s, Result = 003c0000, Performance =  16.49 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010921 s, Result = 00438000, Performance =  17.70 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013371 s, Result = 004b0000, Performance =  16.06 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013367 s, Result = 00528000, Performance =  17.67 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015627 s, Result = 005a0000, Performance =  16.49 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015924 s, Result = 00618000, Performance =  17.53 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017299 s, Result = 00690000, Performance =  17.38 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020301 s, Result = 00708000, Performance =  15.87 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019515 s, Result = 00780000, Performance =  17.61 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021502 s, Result = 007f8000, Performance =  16.98 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022405 s, Result = 00870000, Performance =  17.25 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.023690 s, Result = 008e8000, Performance =  17.22 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.025114 s, Result = 00960000, Performance =  17.10 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028011 s, Result = 009d8000, Performance =  16.10 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.029205 s, Result = 00a50000, Performance =  16.18 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.031446 s, Result = 00ac8000, Performance =  15.71 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.032384 s, Result = 00b40000, Performance =  15.92 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.034503 s, Result = 00bb8000, Performance =  15.56 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.036547 s, Result = 00c30000, Performance =  15.28 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038491 s, Result = 00ca8000, Performance =  15.06 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.040012 s, Result = 00d20000, Performance =  15.03 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.041965 s, Result = 00d98000, Performance =  14.84 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043589 s, Result = 00e10000, Performance =  14.78 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.045475 s, Result = 00e88000, Performance =  14.64 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.046315 s, Result = 00f00000, Performance =  14.84 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.046470 s, Result = 00f78000, Performance =  15.25 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048483 s, Result = 00ff0000, Performance =  15.06 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.049287 s, Result = 01068000, Performance =  15.25 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.051313 s, Result = 010e0000, Performance =  15.07 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.052985 s, Result = 01158000, Performance =  15.00 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.054866 s, Result = 011d0000, Performance =  14.87 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.055573 s, Result = 01248000, Performance =  15.07 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.056796 s, Result = 012c0000, Performance =  15.12 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.057743 s, Result = 01338000, Performance =  15.25 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.058289 s, Result = 013b0000, Performance =  15.47 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.057846 s, Result = 01428000, Performance =  15.96 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.060710 s, Result = 014a0000, Performance =  15.56 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.063657 s, Result = 01518000, Performance =  15.18 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.064519 s, Result = 01590000, Performance =  15.31 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.066049 s, Result = 01608000, Performance =  15.28 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.068002 s, Result = 01680000, Performance =  15.16 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.070241 s, Result = 016f8000, Performance =  14.98 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.072728 s, Result = 01770000, Performance =  14.76 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.074594 s, Result = 017e8000, Performance =  14.68 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.075577 s, Result = 01860000, Performance =  14.78 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.076650 s, Result = 018d8000, Performance =  14.85 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.077509 s, Result = 01950000, Performance =  14.96 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.085646 s, Result = 019c8000, Performance =  13.79 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.078583 s, Result = 01a40000, Performance =  15.30 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.079033 s, Result = 01ab8000, Performance =  15.49 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.079176 s, Result = 01b30000, Performance =  15.73 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.079021 s, Result = 01ba8000, Performance =  16.03 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.080001 s, Result = 01c20000, Performance =  16.11 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.081345 s, Result = 01c98000, Performance =  16.10 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.081575 s, Result = 01d10000, Performance =  16.32 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.079743 s, Result = 01d88000, Performance =  16.97 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.101762 s, Result = 01e00000, Performance =  13.51 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   895   386  1792
Test passed: M N K =   109  1820   704
Test passed: M N K =   691  1268   896
Test passed: M N K =   928  1399   896
Test passed: M N K =    61   896  1344
M N K =  2048  2048   256, Elapsed time =   0.007749 s, Result = 282f8000, Performance =   2.77 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008036 s, Result = 28370000, Performance =   5.34 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009723 s, Result = 283e8000, Performance =   6.63 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009788 s, Result = 28460000, Performance =   8.78 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010883 s, Result = 284d8000, Performance =   9.87 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010974 s, Result = 28550000, Performance =  11.74 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011979 s, Result = 285c8000, Performance =  12.55 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011609 s, Result = 28640000, Performance =  14.80 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013066 s, Result = 286b8000, Performance =  14.79 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014825 s, Result = 28730000, Performance =  14.49 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015653 s, Result = 287a8000, Performance =  15.09 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015128 s, Result = 28820000, Performance =  17.03 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016742 s, Result = 28898000, Performance =  16.67 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017626 s, Result = 28910000, Performance =  17.06 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018274 s, Result = 28988000, Performance =  17.63 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018348 s, Result = 28a00000, Performance =  18.73 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019101 s, Result = 28a78000, Performance =  19.11 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019085 s, Result = 28af0000, Performance =  20.25 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021873 s, Result = 28b68000, Performance =  18.65 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021876 s, Result = 28be0000, Performance =  19.63 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023509 s, Result = 28c58000, Performance =  19.18 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024467 s, Result = 28cd0000, Performance =  19.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027575 s, Result = 28d48000, Performance =  17.91 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.029801 s, Result = 28dc0000, Performance =  17.29 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030864 s, Result = 28e38000, Performance =  17.39 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.032514 s, Result = 28eb0000, Performance =  17.17 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.033358 s, Result = 28f28000, Performance =  17.38 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036149 s, Result = 28fa0000, Performance =  16.63 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037284 s, Result = 29018000, Performance =  16.70 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.039249 s, Result = 29090000, Performance =  16.41 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040653 s, Result = 29108000, Performance =  16.38 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.041837 s, Result = 29180000, Performance =  16.43 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.041976 s, Result = 291f8000, Performance =  16.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043769 s, Result = 29270000, Performance =  16.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.045120 s, Result = 292e8000, Performance =  16.66 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.046367 s, Result = 29360000, Performance =  16.67 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.047689 s, Result = 293d8000, Performance =  16.66 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.049784 s, Result = 29450000, Performance =  16.39 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.051156 s, Result = 294c8000, Performance =  16.37 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.052421 s, Result = 29540000, Performance =  16.39 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.053087 s, Result = 295b8000, Performance =  16.59 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.054102 s, Result = 29630000, Performance =  16.67 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.054423 s, Result = 296a8000, Performance =  16.97 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.056406 s, Result = 29720000, Performance =  16.75 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.060436 s, Result = 29798000, Performance =  15.99 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.061619 s, Result = 29810000, Performance =  16.03 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.062926 s, Result = 29888000, Performance =  16.04 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.066876 s, Result = 29900000, Performance =  15.41 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.067928 s, Result = 29978000, Performance =  15.49 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.069541 s, Result = 299f0000, Performance =  15.44 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.071246 s, Result = 29a68000, Performance =  15.37 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.072011 s, Result = 29ae0000, Performance =  15.51 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.073180 s, Result = 29b58000, Performance =  15.55 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.074251 s, Result = 29bd0000, Performance =  15.62 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.075535 s, Result = 29c48000, Performance =  15.64 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.076134 s, Result = 29cc0000, Performance =  15.80 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.076277 s, Result = 29d38000, Performance =  16.05 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.076833 s, Result = 29db0000, Performance =  16.21 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.077480 s, Result = 29e28000, Performance =  16.35 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.078169 s, Result = 29ea0000, Performance =  16.48 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.079483 s, Result = 29f18000, Performance =  16.48 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.079930 s, Result = 29f90000, Performance =  16.66 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.076497 s, Result = 2a008000, Performance =  17.69 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.098973 s, Result = 2a080000, Performance =  13.89 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1507  1833   576
Test passed: M N K =   743   551   256
Test passed: M N K =  1644  1309  2048
Test passed: M N K =   471   647  1920
Test passed: M N K =   564  1260  1600
M N K =  2048  2048   256, Elapsed time =   0.000895 s, Result = 00078000, Performance =  24.01 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001940 s, Result = 000f0000, Performance =  22.14 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003408 s, Result = 00168000, Performance =  18.91 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003660 s, Result = 001e0000, Performance =  23.47 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002966 s, Result = 00258000, Performance =  36.20 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004573 s, Result = 002d0000, Performance =  28.18 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004680 s, Result = 00348000, Performance =  32.12 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004743 s, Result = 003c0000, Performance =  36.22 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005995 s, Result = 00438000, Performance =  32.24 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006203 s, Result = 004b0000, Performance =  34.62 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006984 s, Result = 00528000, Performance =  33.82 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007547 s, Result = 005a0000, Performance =  34.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008789 s, Result = 00618000, Performance =  31.76 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010139 s, Result = 00690000, Performance =  29.65 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011548 s, Result = 00708000, Performance =  27.89 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011057 s, Result = 00780000, Performance =  31.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.013946 s, Result = 007f8000, Performance =  26.18 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.013130 s, Result = 00870000, Performance =  29.44 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014255 s, Result = 008e8000, Performance =  28.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015482 s, Result = 00960000, Performance =  27.74 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.016508 s, Result = 009d8000, Performance =  27.32 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018574 s, Result = 00a50000, Performance =  25.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019958 s, Result = 00ac8000, Performance =  24.75 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.020762 s, Result = 00b40000, Performance =  24.82 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024168 s, Result = 00bb8000, Performance =  22.21 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.025694 s, Result = 00c30000, Performance =  21.73 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.026683 s, Result = 00ca8000, Performance =  21.73 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028777 s, Result = 00d20000, Performance =  20.89 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.032297 s, Result = 00d98000, Performance =  19.28 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032789 s, Result = 00e10000, Performance =  19.65 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.034224 s, Result = 00e88000, Performance =  19.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.034057 s, Result = 00f00000, Performance =  20.18 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.035753 s, Result = 00f78000, Performance =  19.82 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.037001 s, Result = 00ff0000, Performance =  19.73 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.039918 s, Result = 01068000, Performance =  18.83 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.041522 s, Result = 010e0000, Performance =  18.62 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.042934 s, Result = 01158000, Performance =  18.51 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.043504 s, Result = 011d0000, Performance =  18.76 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.045219 s, Result = 01248000, Performance =  18.52 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.046915 s, Result = 012c0000, Performance =  18.31 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.048664 s, Result = 01338000, Performance =  18.09 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.049652 s, Result = 013b0000, Performance =  18.17 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.050712 s, Result = 01428000, Performance =  18.21 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.053131 s, Result = 014a0000, Performance =  17.78 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.054002 s, Result = 01518000, Performance =  17.89 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.054995 s, Result = 01590000, Performance =  17.96 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.063083 s, Result = 01608000, Performance =  16.00 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.057648 s, Result = 01680000, Performance =  17.88 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.057945 s, Result = 016f8000, Performance =  18.16 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.059936 s, Result = 01770000, Performance =  17.91 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.061242 s, Result = 017e8000, Performance =  17.88 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.062965 s, Result = 01860000, Performance =  17.74 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.066608 s, Result = 018d8000, Performance =  17.09 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.068253 s, Result = 01950000, Performance =  16.99 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.070087 s, Result = 019c8000, Performance =  16.85 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.071887 s, Result = 01a40000, Performance =  16.73 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.072548 s, Result = 01ab8000, Performance =  16.87 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.072906 s, Result = 01b30000, Performance =  17.08 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.073263 s, Result = 01ba8000, Performance =  17.29 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.074179 s, Result = 01c20000, Performance =  17.37 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.075939 s, Result = 01c98000, Performance =  17.25 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.075907 s, Result = 01d10000, Performance =  17.54 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.072086 s, Result = 01d88000, Performance =  18.77 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.093561 s, Result = 01e00000, Performance =  14.69 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1480    44   256
Test passed: M N K =  1577  1984   768
Test passed: M N K =  1346  1190  1408
Test passed: M N K =   595  1567  1408
Test passed: M N K =  1864  1138  1792
M N K =  2048  2048   256, Elapsed time =   0.007917 s, Result = 640b8000, Performance =   2.71 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006666 s, Result = c4130000, Performance =   6.44 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009041 s, Result = 241a8000, Performance =   7.13 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009861 s, Result = 84220000, Performance =   8.71 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009822 s, Result = e4298000, Performance =  10.93 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011193 s, Result = 44310000, Performance =  11.51 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012688 s, Result = a4388000, Performance =  11.85 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013577 s, Result = 04400000, Performance =  12.65 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015122 s, Result = 64478000, Performance =  12.78 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015774 s, Result = c44f0000, Performance =  13.61 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016967 s, Result = 24568000, Performance =  13.92 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019452 s, Result = 845e0000, Performance =  13.25 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018990 s, Result = e4658000, Performance =  14.70 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019446 s, Result = 446d0000, Performance =  15.46 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.021841 s, Result = a4748000, Performance =  14.75 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.023251 s, Result = 047c0000, Performance =  14.78 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023769 s, Result = 64838000, Performance =  15.36 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025153 s, Result = c48b0000, Performance =  15.37 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.027248 s, Result = 24928000, Performance =  14.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.029477 s, Result = 849a0000, Performance =  14.57 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.031294 s, Result = e4a18000, Performance =  14.41 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.032682 s, Result = 44a90000, Performance =  14.46 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034344 s, Result = a4b08000, Performance =  14.38 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035430 s, Result = 04b80000, Performance =  14.55 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037388 s, Result = 64bf8000, Performance =  14.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039147 s, Result = c4c70000, Performance =  14.26 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.040511 s, Result = 24ce8000, Performance =  14.31 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.042150 s, Result = 84d60000, Performance =  14.27 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.043633 s, Result = e4dd8000, Performance =  14.27 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.044959 s, Result = 44e50000, Performance =  14.33 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.047024 s, Result = a4ec8000, Performance =  14.16 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.048412 s, Result = 04f40000, Performance =  14.19 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.047628 s, Result = 64fb8000, Performance =  14.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048776 s, Result = c5030000, Performance =  14.97 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.052448 s, Result = 250a8000, Performance =  14.33 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.055493 s, Result = 85120000, Performance =  13.93 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.056927 s, Result = e5198000, Performance =  13.96 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058110 s, Result = 45210000, Performance =  14.04 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.059769 s, Result = a5288000, Performance =  14.01 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.060412 s, Result = 05300000, Performance =  14.22 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.061430 s, Result = 65378000, Performance =  14.33 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.060948 s, Result = c53f0000, Performance =  14.80 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.062781 s, Result = 25468000, Performance =  14.71 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.064471 s, Result = 854e0000, Performance =  14.66 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.065827 s, Result = e5558000, Performance =  14.68 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.066787 s, Result = 455d0000, Performance =  14.79 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.068409 s, Result = a5648000, Performance =  14.75 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.069184 s, Result = 056c0000, Performance =  14.90 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.070325 s, Result = 65738000, Performance =  14.96 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.071016 s, Result = c57b0000, Performance =  15.12 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.071943 s, Result = 25828000, Performance =  15.22 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.072377 s, Result = 858a0000, Performance =  15.43 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.072876 s, Result = e5918000, Performance =  15.62 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.073620 s, Result = 45990000, Performance =  15.75 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.074597 s, Result = a5a08000, Performance =  15.83 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.074860 s, Result = 05a80000, Performance =  16.06 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.076112 s, Result = 65af8000, Performance =  16.08 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.077312 s, Result = c5b70000, Performance =  16.11 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.077922 s, Result = 25be8000, Performance =  16.26 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.079406 s, Result = 85c60000, Performance =  16.23 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.080391 s, Result = e5cd8000, Performance =  16.29 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.077911 s, Result = 45d50000, Performance =  17.09 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.080675 s, Result = a5dc8000, Performance =  16.77 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.109049 s, Result = 05e40000, Performance =  12.60 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1012  1978  1664
Test passed: M N K =   295  2016   448
Test passed: M N K =  1031   422  1792
Test passed: M N K =  1618   734  1984
Test passed: M N K =   300  1036    64
M N K =  2048  2048   256, Elapsed time =   0.006392 s, Result = 00078000, Performance =   3.36 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003997 s, Result = 000f0000, Performance =  10.75 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004266 s, Result = 00168000, Performance =  15.10 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005244 s, Result = 001e0000, Performance =  16.38 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006220 s, Result = 00258000, Performance =  17.26 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007164 s, Result = 002d0000, Performance =  17.98 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008197 s, Result = 00348000, Performance =  18.34 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014939 s, Result = 003c0000, Performance =  11.50 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010194 s, Result = 00438000, Performance =  18.96 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012257 s, Result = 004b0000, Performance =  17.52 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013014 s, Result = 00528000, Performance =  18.15 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014820 s, Result = 005a0000, Performance =  17.39 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016048 s, Result = 00618000, Performance =  17.40 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015402 s, Result = 00690000, Performance =  19.52 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016743 s, Result = 00708000, Performance =  19.24 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017780 s, Result = 00780000, Performance =  19.32 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019896 s, Result = 007f8000, Performance =  18.35 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020429 s, Result = 00870000, Performance =  18.92 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022796 s, Result = 008e8000, Performance =  17.90 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023549 s, Result = 00960000, Performance =  18.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.026715 s, Result = 009d8000, Performance =  16.88 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.027728 s, Result = 00a50000, Performance =  17.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.029249 s, Result = 00ac8000, Performance =  16.89 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030575 s, Result = 00b40000, Performance =  16.86 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032337 s, Result = 00bb8000, Performance =  16.60 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.034086 s, Result = 00c30000, Performance =  16.38 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.035641 s, Result = 00ca8000, Performance =  16.27 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036740 s, Result = 00d20000, Performance =  16.37 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037639 s, Result = 00d98000, Performance =  16.55 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.039492 s, Result = 00e10000, Performance =  16.31 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.041217 s, Result = 00e88000, Performance =  16.15 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043094 s, Result = 00f00000, Performance =  15.95 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.042672 s, Result = 00f78000, Performance =  16.61 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043650 s, Result = 00ff0000, Performance =  16.73 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.045731 s, Result = 01068000, Performance =  16.44 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.046991 s, Result = 010e0000, Performance =  16.45 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.047960 s, Result = 01158000, Performance =  16.57 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.049796 s, Result = 011d0000, Performance =  16.39 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.051022 s, Result = 01248000, Performance =  16.41 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.053547 s, Result = 012c0000, Performance =  16.04 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.056521 s, Result = 01338000, Performance =  15.58 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.057112 s, Result = 013b0000, Performance =  15.79 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.058724 s, Result = 01428000, Performance =  15.72 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.059894 s, Result = 014a0000, Performance =  15.78 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.061412 s, Result = 01518000, Performance =  15.74 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.062096 s, Result = 01590000, Performance =  15.91 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.063479 s, Result = 01608000, Performance =  15.90 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.064191 s, Result = 01680000, Performance =  16.06 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.065590 s, Result = 016f8000, Performance =  16.04 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.066333 s, Result = 01770000, Performance =  16.19 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.067748 s, Result = 017e8000, Performance =  16.17 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.068060 s, Result = 01860000, Performance =  16.41 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.069123 s, Result = 018d8000, Performance =  16.47 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.069565 s, Result = 01950000, Performance =  16.67 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.070537 s, Result = 019c8000, Performance =  16.74 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.070721 s, Result = 01a40000, Performance =  17.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.072323 s, Result = 01ab8000, Performance =  16.93 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.073147 s, Result = 01b30000, Performance =  17.03 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.073700 s, Result = 01ba8000, Performance =  17.19 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.074763 s, Result = 01c20000, Performance =  17.23 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.076227 s, Result = 01c98000, Performance =  17.19 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.073936 s, Result = 01d10000, Performance =  18.01 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.076336 s, Result = 01d88000, Performance =  17.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.104362 s, Result = 01e00000, Performance =  13.17 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   908  1377   768
Test passed: M N K =   171   967   640
Test passed: M N K =  1842  1861  1152
Test passed: M N K =  1471  2047  1024
Test passed: M N K =   531  1684  1408
M N K =  2048  2048   256, Elapsed time =   0.008007 s, Result = 282f8000, Performance =   2.68 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008767 s, Result = 28370000, Performance =   4.90 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008848 s, Result = 283e8000, Performance =   7.28 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010223 s, Result = 28460000, Performance =   8.40 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010919 s, Result = 284d8000, Performance =   9.83 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010927 s, Result = 28550000, Performance =  11.79 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011990 s, Result = 285c8000, Performance =  12.54 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013098 s, Result = 28640000, Performance =  13.12 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012273 s, Result = 286b8000, Performance =  15.75 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014569 s, Result = 28730000, Performance =  14.74 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014188 s, Result = 287a8000, Performance =  16.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015161 s, Result = 28820000, Performance =  17.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015811 s, Result = 28898000, Performance =  17.66 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016861 s, Result = 28910000, Performance =  17.83 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017523 s, Result = 28988000, Performance =  18.38 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017902 s, Result = 28a00000, Performance =  19.19 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018892 s, Result = 28a78000, Performance =  19.32 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019413 s, Result = 28af0000, Performance =  19.91 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020521 s, Result = 28b68000, Performance =  19.88 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021549 s, Result = 28be0000, Performance =  19.93 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022799 s, Result = 28c58000, Performance =  19.78 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.024582 s, Result = 28cd0000, Performance =  19.22 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.026421 s, Result = 28d48000, Performance =  18.69 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027866 s, Result = 28dc0000, Performance =  18.50 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.028169 s, Result = 28e38000, Performance =  19.06 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.030090 s, Result = 28eb0000, Performance =  18.56 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031394 s, Result = 28f28000, Performance =  18.47 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032872 s, Result = 28fa0000, Performance =  18.29 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.034362 s, Result = 29018000, Performance =  18.12 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034791 s, Result = 29090000, Performance =  18.52 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.036580 s, Result = 29108000, Performance =  18.20 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039502 s, Result = 29180000, Performance =  17.40 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039119 s, Result = 291f8000, Performance =  18.12 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.039186 s, Result = 29270000, Performance =  18.63 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.041020 s, Result = 292e8000, Performance =  18.32 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.041969 s, Result = 29360000, Performance =  18.42 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.044388 s, Result = 293d8000, Performance =  17.90 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.044412 s, Result = 29450000, Performance =  18.37 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.047172 s, Result = 294c8000, Performance =  17.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.047604 s, Result = 29540000, Performance =  18.04 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.048959 s, Result = 295b8000, Performance =  17.98 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.050441 s, Result = 29630000, Performance =  17.88 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.052832 s, Result = 296a8000, Performance =  17.48 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.055477 s, Result = 29720000, Performance =  17.03 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.057576 s, Result = 29798000, Performance =  16.78 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.059468 s, Result = 29810000, Performance =  16.61 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.060815 s, Result = 29888000, Performance =  16.60 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.061792 s, Result = 29900000, Performance =  16.68 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.062668 s, Result = 29978000, Performance =  16.79 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.063446 s, Result = 299f0000, Performance =  16.92 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.064964 s, Result = 29a68000, Performance =  16.86 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.065414 s, Result = 29ae0000, Performance =  17.07 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.066041 s, Result = 29b58000, Performance =  17.23 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.067078 s, Result = 29bd0000, Performance =  17.29 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.067504 s, Result = 29c48000, Performance =  17.50 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.067814 s, Result = 29cc0000, Performance =  17.73 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.070133 s, Result = 29d38000, Performance =  17.45 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.071394 s, Result = 29db0000, Performance =  17.45 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.071416 s, Result = 29e28000, Performance =  17.74 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.073133 s, Result = 29ea0000, Performance =  17.62 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.073269 s, Result = 29f18000, Performance =  17.88 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.071428 s, Result = 29f90000, Performance =  18.64 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.073484 s, Result = 2a008000, Performance =  18.41 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.102787 s, Result = 2a080000, Performance =  13.37 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   800   312   128
Test passed: M N K =  1026   429   704
Test passed: M N K =   465   890   448
Test passed: M N K =   379  1224  1856
Test passed: M N K =   329  1738  1024
M N K =  2048  2048   256, Elapsed time =   0.000887 s, Result = 00078000, Performance =  24.20 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001764 s, Result = 000f0000, Performance =  24.35 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003265 s, Result = 00168000, Performance =  19.73 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004237 s, Result = 001e0000, Performance =  20.27 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.004938 s, Result = 00258000, Performance =  21.74 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003634 s, Result = 002d0000, Performance =  35.45 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004139 s, Result = 00348000, Performance =  36.32 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004623 s, Result = 003c0000, Performance =  37.17 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006418 s, Result = 00438000, Performance =  30.11 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.007005 s, Result = 004b0000, Performance =  30.66 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007123 s, Result = 00528000, Performance =  33.16 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.008194 s, Result = 005a0000, Performance =  31.45 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008601 s, Result = 00618000, Performance =  32.46 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010081 s, Result = 00690000, Performance =  29.82 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011056 s, Result = 00708000, Performance =  29.14 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.011379 s, Result = 00780000, Performance =  30.20 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.010995 s, Result = 007f8000, Performance =  33.20 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012072 s, Result = 00870000, Performance =  32.02 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013547 s, Result = 008e8000, Performance =  30.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014414 s, Result = 00960000, Performance =  29.80 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015698 s, Result = 009d8000, Performance =  28.73 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016819 s, Result = 00a50000, Performance =  28.09 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018029 s, Result = 00ac8000, Performance =  27.40 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019030 s, Result = 00b40000, Performance =  27.08 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020763 s, Result = 00bb8000, Performance =  25.86 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022697 s, Result = 00c30000, Performance =  24.60 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025045 s, Result = 00ca8000, Performance =  23.15 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.026372 s, Result = 00d20000, Performance =  22.80 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027471 s, Result = 00d98000, Performance =  22.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.029033 s, Result = 00e10000, Performance =  22.19 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030474 s, Result = 00e88000, Performance =  21.85 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.032440 s, Result = 00f00000, Performance =  21.18 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.031985 s, Result = 00f78000, Performance =  22.16 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.031865 s, Result = 00ff0000, Performance =  22.91 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.034458 s, Result = 01068000, Performance =  21.81 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035252 s, Result = 010e0000, Performance =  21.93 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.036427 s, Result = 01158000, Performance =  21.81 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.037834 s, Result = 011d0000, Performance =  21.57 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040151 s, Result = 01248000, Performance =  20.86 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.041033 s, Result = 012c0000, Performance =  20.93 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041639 s, Result = 01338000, Performance =  21.15 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042484 s, Result = 013b0000, Performance =  21.23 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.044614 s, Result = 01428000, Performance =  20.70 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045870 s, Result = 014a0000, Performance =  20.60 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.049545 s, Result = 01518000, Performance =  19.50 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.052287 s, Result = 01590000, Performance =  18.89 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.055417 s, Result = 01608000, Performance =  18.21 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.056587 s, Result = 01680000, Performance =  18.22 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.058387 s, Result = 016f8000, Performance =  18.02 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.059010 s, Result = 01770000, Performance =  18.20 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.059961 s, Result = 017e8000, Performance =  18.27 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.060192 s, Result = 01860000, Performance =  18.55 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.061356 s, Result = 018d8000, Performance =  18.55 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.061414 s, Result = 01950000, Performance =  18.88 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.062220 s, Result = 019c8000, Performance =  18.98 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.062359 s, Result = 01a40000, Performance =  19.28 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.064163 s, Result = 01ab8000, Performance =  19.08 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.065302 s, Result = 01b30000, Performance =  19.07 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.065968 s, Result = 01ba8000, Performance =  19.21 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.067602 s, Result = 01c20000, Performance =  19.06 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.069407 s, Result = 01c98000, Performance =  18.87 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.067169 s, Result = 01d10000, Performance =  19.82 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.069104 s, Result = 01d88000, Performance =  19.58 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.097897 s, Result = 01e00000, Performance =  14.04 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1944  1325  1216
Test passed: M N K =  1879  1440  1088
Test passed: M N K =  1657  1214   512
Test passed: M N K =  1330  1716   192
Test passed: M N K =  1635   419  1920
M N K =  2048  2048   256, Elapsed time =   0.008065 s, Result = 640b8000, Performance =   2.66 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006409 s, Result = c4130000, Performance =   6.70 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007545 s, Result = 241a8000, Performance =   8.54 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009717 s, Result = 84220000, Performance =   8.84 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009959 s, Result = e4298000, Performance =  10.78 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011657 s, Result = 44310000, Performance =  11.05 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012678 s, Result = a4388000, Performance =  11.86 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012745 s, Result = 04400000, Performance =  13.48 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015183 s, Result = 64478000, Performance =  12.73 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015088 s, Result = c44f0000, Performance =  14.23 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016902 s, Result = 24568000, Performance =  13.98 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016246 s, Result = 845e0000, Performance =  15.86 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019051 s, Result = e4658000, Performance =  14.65 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020438 s, Result = 446d0000, Performance =  14.71 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020558 s, Result = a4748000, Performance =  15.67 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021886 s, Result = 047c0000, Performance =  15.70 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023092 s, Result = 64838000, Performance =  15.81 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.024282 s, Result = c48b0000, Performance =  15.92 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.025880 s, Result = 24928000, Performance =  15.77 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.027060 s, Result = 849a0000, Performance =  15.87 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.030063 s, Result = e4a18000, Performance =  15.00 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.031133 s, Result = 44a90000, Performance =  15.18 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032841 s, Result = a4b08000, Performance =  15.04 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033673 s, Result = 04b80000, Performance =  15.31 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.035344 s, Result = 64bf8000, Performance =  15.19 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.036897 s, Result = c4c70000, Performance =  15.13 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038154 s, Result = 24ce8000, Performance =  15.20 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.039348 s, Result = 84d60000, Performance =  15.28 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.040924 s, Result = e4dd8000, Performance =  15.22 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043824 s, Result = 44e50000, Performance =  14.70 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.045924 s, Result = a4ec8000, Performance =  14.50 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.049632 s, Result = 04f40000, Performance =  13.85 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.050202 s, Result = 64fb8000, Performance =  14.12 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.051197 s, Result = c5030000, Performance =  14.26 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051956 s, Result = 250a8000, Performance =  14.47 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.051662 s, Result = 85120000, Performance =  14.96 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.053402 s, Result = e5198000, Performance =  14.88 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.054076 s, Result = 45210000, Performance =  15.09 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.055376 s, Result = a5288000, Performance =  15.12 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.055556 s, Result = 05300000, Performance =  15.46 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.057137 s, Result = 65378000, Performance =  15.41 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.057533 s, Result = c53f0000, Performance =  15.68 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.058798 s, Result = 25468000, Performance =  15.70 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.058636 s, Result = 854e0000, Performance =  16.11 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.061477 s, Result = e5558000, Performance =  15.72 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.061662 s, Result = 455d0000, Performance =  16.02 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.063265 s, Result = a5648000, Performance =  15.95 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.062510 s, Result = 056c0000, Performance =  16.49 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.064438 s, Result = 65738000, Performance =  16.33 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.065372 s, Result = c57b0000, Performance =  16.43 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.067524 s, Result = 25828000, Performance =  16.22 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.068643 s, Result = 858a0000, Performance =  16.27 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.069378 s, Result = e5918000, Performance =  16.41 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.070409 s, Result = 45990000, Performance =  16.47 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.071532 s, Result = a5a08000, Performance =  16.51 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.071368 s, Result = 05a80000, Performance =  16.85 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.072710 s, Result = 65af8000, Performance =  16.83 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.074005 s, Result = c5b70000, Performance =  16.83 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.076142 s, Result = 25be8000, Performance =  16.64 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.072596 s, Result = 85c60000, Performance =  17.75 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.075470 s, Result = e5cd8000, Performance =  17.36 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.075978 s, Result = 45d50000, Performance =  17.52 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.074424 s, Result = a5dc8000, Performance =  18.18 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.095122 s, Result = 05e40000, Performance =  14.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1872  1163   704
Test passed: M N K =   864  1874  1344
Test passed: M N K =   362   589  1216
Test passed: M N K =  1735   689  1792
Test passed: M N K =  1878  1643  1984
M N K =  2048  2048   256, Elapsed time =   0.006168 s, Result = 00078000, Performance =   3.48 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004088 s, Result = 000f0000, Performance =  10.51 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004140 s, Result = 00168000, Performance =  15.56 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005244 s, Result = 001e0000, Performance =  16.38 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007261 s, Result = 00258000, Performance =  14.79 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007075 s, Result = 002d0000, Performance =  18.21 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008689 s, Result = 00348000, Performance =  17.30 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009873 s, Result = 003c0000, Performance =  17.40 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010837 s, Result = 00438000, Performance =  17.83 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011855 s, Result = 004b0000, Performance =  18.11 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013029 s, Result = 00528000, Performance =  18.13 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013905 s, Result = 005a0000, Performance =  18.53 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015205 s, Result = 00618000, Performance =  18.36 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015477 s, Result = 00690000, Performance =  19.43 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017952 s, Result = 00708000, Performance =  17.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017983 s, Result = 00780000, Performance =  19.11 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018798 s, Result = 007f8000, Performance =  19.42 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020041 s, Result = 00870000, Performance =  19.29 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021035 s, Result = 008e8000, Performance =  19.40 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022242 s, Result = 00960000, Performance =  19.31 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023369 s, Result = 009d8000, Performance =  19.30 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025598 s, Result = 00a50000, Performance =  18.46 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027781 s, Result = 00ac8000, Performance =  17.78 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.028779 s, Result = 00b40000, Performance =  17.91 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029906 s, Result = 00bb8000, Performance =  17.95 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031588 s, Result = 00c30000, Performance =  17.68 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.032590 s, Result = 00ca8000, Performance =  17.79 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.033286 s, Result = 00d20000, Performance =  18.06 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.035282 s, Result = 00d98000, Performance =  17.65 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.036515 s, Result = 00e10000, Performance =  17.64 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.037432 s, Result = 00e88000, Performance =  17.78 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039570 s, Result = 00f00000, Performance =  17.37 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039669 s, Result = 00f78000, Performance =  17.86 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.041209 s, Result = 00ff0000, Performance =  17.72 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.043038 s, Result = 01068000, Performance =  17.46 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.045502 s, Result = 010e0000, Performance =  16.99 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.047946 s, Result = 01158000, Performance =  16.57 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.049150 s, Result = 011d0000, Performance =  16.60 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.050878 s, Result = 01248000, Performance =  16.46 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.050992 s, Result = 012c0000, Performance =  16.85 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.051969 s, Result = 01338000, Performance =  16.94 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.052375 s, Result = 013b0000, Performance =  17.22 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.053289 s, Result = 01428000, Performance =  17.33 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.052765 s, Result = 014a0000, Performance =  17.91 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.055388 s, Result = 01518000, Performance =  17.45 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.056071 s, Result = 01590000, Performance =  17.62 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.058537 s, Result = 01608000, Performance =  17.24 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.058666 s, Result = 01680000, Performance =  17.57 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.060750 s, Result = 016f8000, Performance =  17.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.061687 s, Result = 01770000, Performance =  17.41 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.062599 s, Result = 017e8000, Performance =  17.50 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.062505 s, Result = 01860000, Performance =  17.87 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.063247 s, Result = 018d8000, Performance =  18.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.064300 s, Result = 01950000, Performance =  18.03 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.065751 s, Result = 019c8000, Performance =  17.96 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.065534 s, Result = 01a40000, Performance =  18.35 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.067438 s, Result = 01ab8000, Performance =  18.15 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.069339 s, Result = 01b30000, Performance =  17.96 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.071036 s, Result = 01ba8000, Performance =  17.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.068739 s, Result = 01c20000, Performance =  18.74 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.071419 s, Result = 01c98000, Performance =  18.34 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.072281 s, Result = 01d10000, Performance =  18.42 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.070642 s, Result = 01d88000, Performance =  19.15 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.090290 s, Result = 01e00000, Performance =  15.22 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   215   734   256
Test passed: M N K =  1158  1986  1280
Test passed: M N K =  1744  1374  1344
Test passed: M N K =  1961  1475   256
Test passed: M N K =  1276  1934  1920
M N K =  2048  2048   256, Elapsed time =   0.008022 s, Result = 282f8000, Performance =   2.68 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008761 s, Result = 28370000, Performance =   4.90 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009328 s, Result = 283e8000, Performance =   6.91 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009894 s, Result = 28460000, Performance =   8.68 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009487 s, Result = 284d8000, Performance =  11.32 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010277 s, Result = 28550000, Performance =  12.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011439 s, Result = 285c8000, Performance =  13.14 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011979 s, Result = 28640000, Performance =  14.34 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012451 s, Result = 286b8000, Performance =  15.52 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013783 s, Result = 28730000, Performance =  15.58 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014602 s, Result = 287a8000, Performance =  16.18 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015258 s, Result = 28820000, Performance =  16.89 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014947 s, Result = 28898000, Performance =  18.68 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016150 s, Result = 28910000, Performance =  18.62 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017639 s, Result = 28988000, Performance =  18.26 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017692 s, Result = 28a00000, Performance =  19.42 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019254 s, Result = 28a78000, Performance =  18.96 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018829 s, Result = 28af0000, Performance =  20.53 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019274 s, Result = 28b68000, Performance =  21.17 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020148 s, Result = 28be0000, Performance =  21.32 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021135 s, Result = 28c58000, Performance =  21.34 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022132 s, Result = 28cd0000, Performance =  21.35 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.023222 s, Result = 28d48000, Performance =  21.27 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.025549 s, Result = 28dc0000, Performance =  20.17 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.026939 s, Result = 28e38000, Performance =  19.93 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.028173 s, Result = 28eb0000, Performance =  19.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.028499 s, Result = 28f28000, Performance =  20.35 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.030438 s, Result = 28fa0000, Performance =  19.75 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031901 s, Result = 29018000, Performance =  19.52 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032985 s, Result = 29090000, Performance =  19.53 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.034227 s, Result = 29108000, Performance =  19.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.036307 s, Result = 29180000, Performance =  18.93 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.036988 s, Result = 291f8000, Performance =  19.16 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.038378 s, Result = 29270000, Performance =  19.03 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.039070 s, Result = 292e8000, Performance =  19.24 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.039658 s, Result = 29360000, Performance =  19.49 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.040918 s, Result = 293d8000, Performance =  19.42 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.042866 s, Result = 29450000, Performance =  19.04 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.044011 s, Result = 294c8000, Performance =  19.03 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.044425 s, Result = 29540000, Performance =  19.34 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.047070 s, Result = 295b8000, Performance =  18.71 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.050106 s, Result = 29630000, Performance =  18.00 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.050920 s, Result = 296a8000, Performance =  18.13 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.052139 s, Result = 29720000, Performance =  18.12 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.055235 s, Result = 29798000, Performance =  17.50 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.055950 s, Result = 29810000, Performance =  17.66 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.057898 s, Result = 29888000, Performance =  17.43 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.057892 s, Result = 29900000, Performance =  17.81 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.059409 s, Result = 29978000, Performance =  17.71 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.060093 s, Result = 299f0000, Performance =  17.87 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.061154 s, Result = 29a68000, Performance =  17.91 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.061026 s, Result = 29ae0000, Performance =  18.30 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.062493 s, Result = 29b58000, Performance =  18.21 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.070950 s, Result = 29bd0000, Performance =  16.34 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.064397 s, Result = 29c48000, Performance =  18.34 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.065199 s, Result = 29cc0000, Performance =  18.44 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.066091 s, Result = 29d38000, Performance =  18.52 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.067162 s, Result = 29db0000, Performance =  18.55 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.069366 s, Result = 29e28000, Performance =  18.27 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.066951 s, Result = 29ea0000, Performance =  19.25 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.069428 s, Result = 29f18000, Performance =  18.87 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.070918 s, Result = 29f90000, Performance =  18.77 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.069164 s, Result = 2a008000, Performance =  19.56 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.089139 s, Result = 2a080000, Performance =  15.42 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1272  1228   832
Test passed: M N K =   613  2034  1024
Test passed: M N K =   351   530   448
Test passed: M N K =  1463   928   512
Test passed: M N K =   956  1732  1472
M N K =  2048  2048   256, Elapsed time =   0.000903 s, Result = 00078000, Performance =  23.79 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001806 s, Result = 000f0000, Performance =  23.78 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002881 s, Result = 00168000, Performance =  22.36 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003937 s, Result = 001e0000, Performance =  21.82 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003481 s, Result = 00258000, Performance =  30.84 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003513 s, Result = 002d0000, Performance =  36.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005355 s, Result = 00348000, Performance =  28.07 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005104 s, Result = 003c0000, Performance =  33.66 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005358 s, Result = 00438000, Performance =  36.07 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006666 s, Result = 004b0000, Performance =  32.22 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006654 s, Result = 00528000, Performance =  35.50 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012263 s, Result = 005a0000, Performance =  21.01 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008780 s, Result = 00618000, Performance =  31.80 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009035 s, Result = 00690000, Performance =  33.28 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009258 s, Result = 00708000, Performance =  34.79 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010346 s, Result = 00780000, Performance =  33.21 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011552 s, Result = 007f8000, Performance =  31.60 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.011377 s, Result = 00870000, Performance =  33.98 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.012646 s, Result = 008e8000, Performance =  32.27 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013413 s, Result = 00960000, Performance =  32.02 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.014431 s, Result = 009d8000, Performance =  31.25 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015694 s, Result = 00a50000, Performance =  30.10 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016812 s, Result = 00ac8000, Performance =  29.38 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017828 s, Result = 00b40000, Performance =  28.91 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018837 s, Result = 00bb8000, Performance =  28.50 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020328 s, Result = 00c30000, Performance =  27.47 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022087 s, Result = 00ca8000, Performance =  26.25 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.022994 s, Result = 00d20000, Performance =  26.15 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025848 s, Result = 00d98000, Performance =  24.09 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026941 s, Result = 00e10000, Performance =  23.91 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.027709 s, Result = 00e88000, Performance =  24.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.030282 s, Result = 00f00000, Performance =  22.69 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030676 s, Result = 00f78000, Performance =  23.10 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.031708 s, Result = 00ff0000, Performance =  23.03 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.032601 s, Result = 01068000, Performance =  23.06 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.032825 s, Result = 010e0000, Performance =  23.55 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035448 s, Result = 01158000, Performance =  22.42 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036219 s, Result = 011d0000, Performance =  22.53 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.037898 s, Result = 01248000, Performance =  22.10 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.038684 s, Result = 012c0000, Performance =  22.21 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.040358 s, Result = 01338000, Performance =  21.82 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.044317 s, Result = 013b0000, Performance =  20.35 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.046918 s, Result = 01428000, Performance =  19.68 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.046142 s, Result = 014a0000, Performance =  20.48 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.046076 s, Result = 01518000, Performance =  20.97 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045840 s, Result = 01590000, Performance =  21.55 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.047724 s, Result = 01608000, Performance =  21.15 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049288 s, Result = 01680000, Performance =  20.91 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.053554 s, Result = 016f8000, Performance =  19.65 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.054488 s, Result = 01770000, Performance =  19.71 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.056074 s, Result = 017e8000, Performance =  19.53 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.056462 s, Result = 01860000, Performance =  19.78 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.058272 s, Result = 018d8000, Performance =  19.53 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.058431 s, Result = 01950000, Performance =  19.85 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.059718 s, Result = 019c8000, Performance =  19.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.060072 s, Result = 01a40000, Performance =  20.02 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.061581 s, Result = 01ab8000, Performance =  19.88 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.063009 s, Result = 01b30000, Performance =  19.77 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.064336 s, Result = 01ba8000, Performance =  19.69 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.062442 s, Result = 01c20000, Performance =  20.64 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.065881 s, Result = 01c98000, Performance =  19.88 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.065767 s, Result = 01d10000, Performance =  20.24 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.064779 s, Result = 01d88000, Performance =  20.89 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.084893 s, Result = 01e00000, Performance =  16.19 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   372   710   576
Test passed: M N K =  1241  1279   192
Test passed: M N K =   140   153   384
Test passed: M N K =  1467  1026   256
Test passed: M N K =  1707  1252   960
M N K =  2048  2048   256, Elapsed time =   0.009383 s, Result = d4108000, Performance =   2.29 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007396 s, Result = a41d0000, Performance =   5.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010949 s, Result = 74298000, Performance =   5.88 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010927 s, Result = 44360000, Performance =   7.86 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.013142 s, Result = 14428000, Performance =   8.17 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014146 s, Result = e44f0000, Performance =   9.11 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.016362 s, Result = b45b8000, Performance =   9.19 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.017633 s, Result = 84680000, Performance =   9.74 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.019497 s, Result = 54748000, Performance =   9.91 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.020565 s, Result = 24810000, Performance =  10.44 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.022466 s, Result = f48d8000, Performance =  10.51 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.023068 s, Result = c49a0000, Performance =  11.17 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.026018 s, Result = 94a68000, Performance =  10.73 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.026964 s, Result = 64b30000, Performance =  11.15 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.028306 s, Result = 34bf8000, Performance =  11.38 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.030183 s, Result = 04cc0000, Performance =  11.38 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.032859 s, Result = d4d88000, Performance =  11.11 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.034335 s, Result = a4e50000, Performance =  11.26 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.035972 s, Result = 74f18000, Performance =  11.34 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.038240 s, Result = 44fe0000, Performance =  11.23 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.039621 s, Result = 150a8000, Performance =  11.38 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.041780 s, Result = e5170000, Performance =  11.31 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.044314 s, Result = b5238000, Performance =  11.15 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.046302 s, Result = 85300000, Performance =  11.13 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.048346 s, Result = 553c8000, Performance =  11.10 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.051638 s, Result = 25490000, Performance =  10.81 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.053720 s, Result = f5558000, Performance =  10.79 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.055669 s, Result = c5620000, Performance =  10.80 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.057656 s, Result = 956e8000, Performance =  10.80 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.061154 s, Result = 657b0000, Performance =  10.53 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.062818 s, Result = 35878000, Performance =  10.60 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.064272 s, Result = 05940000, Performance =  10.69 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.064902 s, Result = d5a08000, Performance =  10.92 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.068227 s, Result = a5ad0000, Performance =  10.70 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.070244 s, Result = 75b98000, Performance =  10.70 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.072148 s, Result = 45c60000, Performance =  10.72 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.074665 s, Result = 15d28000, Performance =  10.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.077877 s, Result = e5df0000, Performance =  10.48 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.080078 s, Result = b5eb8000, Performance =  10.46 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.082093 s, Result = 85f80000, Performance =  10.46 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.083536 s, Result = 56048000, Performance =  10.54 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.085220 s, Result = 26110000, Performance =  10.58 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.086667 s, Result = f61d8000, Performance =  10.65 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.089422 s, Result = c62a0000, Performance =  10.57 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.092241 s, Result = 96368000, Performance =  10.48 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.100126 s, Result = 66430000, Performance =   9.87 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.097151 s, Result = 364f8000, Performance =  10.39 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.100407 s, Result = 065c0000, Performance =  10.27 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.101571 s, Result = d6688000, Performance =  10.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.104219 s, Result = a6750000, Performance =  10.30 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.106464 s, Result = 76818000, Performance =  10.29 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.108854 s, Result = 468e0000, Performance =  10.26 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.111261 s, Result = 169a8000, Performance =  10.23 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.113353 s, Result = e6a70000, Performance =  10.23 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.115267 s, Result = b6b38000, Performance =  10.25 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.117199 s, Result = 86c00000, Performance =  10.26 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.119347 s, Result = 56cc8000, Performance =  10.26 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.122077 s, Result = 26d90000, Performance =  10.20 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.124084 s, Result = f6e58000, Performance =  10.21 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.126297 s, Result = c6f20000, Performance =  10.20 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.130702 s, Result = 96fe8000, Performance =  10.02 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.131850 s, Result = 670b0000, Performance =  10.10 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.127973 s, Result = 37178000, Performance =  10.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.166922 s, Result = 07240000, Performance =   8.23 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   271   762  1728
Test passed: M N K =   522    22   128
Test passed: M N K =  1432  1814  1600
Test passed: M N K =   856  1421  1408
Test passed: M N K =  1177  1801   768
M N K =  2048  2048   256, Elapsed time =   0.008886 s, Result = 000c8000, Performance =   2.42 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006548 s, Result = 00190000, Performance =   6.56 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006516 s, Result = 00258000, Performance =   9.89 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007734 s, Result = 00320000, Performance =  11.11 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009425 s, Result = 003e8000, Performance =  11.39 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011242 s, Result = 004b0000, Performance =  11.46 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012651 s, Result = 00578000, Performance =  11.88 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014121 s, Result = 00640000, Performance =  12.17 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014741 s, Result = 00708000, Performance =  13.11 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017527 s, Result = 007d0000, Performance =  12.25 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.018043 s, Result = 00898000, Performance =  13.09 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019701 s, Result = 00960000, Performance =  13.08 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021548 s, Result = 00a28000, Performance =  12.96 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022347 s, Result = 00af0000, Performance =  13.45 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.024892 s, Result = 00bb8000, Performance =  12.94 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024353 s, Result = 00c80000, Performance =  14.11 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028019 s, Result = 00d48000, Performance =  13.03 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.027875 s, Result = 00e10000, Performance =  13.87 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030613 s, Result = 00ed8000, Performance =  13.33 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031496 s, Result = 00fa0000, Performance =  13.64 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.034106 s, Result = 01068000, Performance =  13.22 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035436 s, Result = 01130000, Performance =  13.33 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.037064 s, Result = 011f8000, Performance =  13.33 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039245 s, Result = 012c0000, Performance =  13.13 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.041454 s, Result = 01388000, Performance =  12.95 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.043593 s, Result = 01450000, Performance =  12.81 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045917 s, Result = 01518000, Performance =  12.63 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.047410 s, Result = 015e0000, Performance =  12.68 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051005 s, Result = 016a8000, Performance =  12.21 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052459 s, Result = 01770000, Performance =  12.28 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054892 s, Result = 01838000, Performance =  12.13 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.054615 s, Result = 01900000, Performance =  12.58 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.058090 s, Result = 019c8000, Performance =  12.20 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.060439 s, Result = 01a90000, Performance =  12.08 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.062486 s, Result = 01b58000, Performance =  12.03 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.064623 s, Result = 01c20000, Performance =  11.96 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.068480 s, Result = 01ce8000, Performance =  11.60 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.071129 s, Result = 01db0000, Performance =  11.47 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.072383 s, Result = 01e78000, Performance =  11.57 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.074529 s, Result = 01f40000, Performance =  11.53 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.076619 s, Result = 02008000, Performance =  11.49 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.078187 s, Result = 020d0000, Performance =  11.54 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.080546 s, Result = 02198000, Performance =  11.46 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.082444 s, Result = 02260000, Performance =  11.46 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.085624 s, Result = 02328000, Performance =  11.29 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.087222 s, Result = 023f0000, Performance =  11.33 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.089521 s, Result = 024b8000, Performance =  11.27 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.092271 s, Result = 02580000, Performance =  11.17 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.093980 s, Result = 02648000, Performance =  11.20 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.096498 s, Result = 02710000, Performance =  11.13 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.098932 s, Result = 027d8000, Performance =  11.07 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.100952 s, Result = 028a0000, Performance =  11.06 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.103392 s, Result = 02968000, Performance =  11.01 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.106235 s, Result = 02a30000, Performance =  10.92 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.107607 s, Result = 02af8000, Performance =  10.98 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.109692 s, Result = 02bc0000, Performance =  10.96 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.111388 s, Result = 02c88000, Performance =  10.99 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.113036 s, Result = 02d50000, Performance =  11.02 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.114296 s, Result = 02e18000, Performance =  11.09 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.116112 s, Result = 02ee0000, Performance =  11.10 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.119011 s, Result = 02fa8000, Performance =  11.01 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.120830 s, Result = 03070000, Performance =  11.02 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.119314 s, Result = 03138000, Performance =  11.34 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.157647 s, Result = 03200000, Performance =   8.72 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   166  1266  1344
Test passed: M N K =  1844   509   192
Test passed: M N K =  1597   910  1024
Test passed: M N K =  1588   617   320
Test passed: M N K =  1734  1809  1216
M N K =  2048  2048   256, Elapsed time =   0.011156 s, Result = 28348000, Performance =   1.92 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008396 s, Result = 28410000, Performance =   5.12 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010485 s, Result = 284d8000, Performance =   6.14 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010252 s, Result = 285a0000, Performance =   8.38 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012497 s, Result = 28668000, Performance =   8.59 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013492 s, Result = 28730000, Performance =   9.55 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015763 s, Result = 287f8000, Performance =   9.54 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016408 s, Result = 288c0000, Performance =  10.47 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017960 s, Result = 28988000, Performance =  10.76 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018309 s, Result = 28a50000, Performance =  11.73 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.020114 s, Result = 28b18000, Performance =  11.74 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.021224 s, Result = 28be0000, Performance =  12.14 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021359 s, Result = 28ca8000, Performance =  13.07 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022715 s, Result = 28d70000, Performance =  13.24 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.025452 s, Result = 28e38000, Performance =  12.66 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025227 s, Result = 28f00000, Performance =  13.62 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.028134 s, Result = 28fc8000, Performance =  12.98 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.029139 s, Result = 29090000, Performance =  13.27 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030244 s, Result = 29158000, Performance =  13.49 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.032206 s, Result = 29220000, Performance =  13.34 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033570 s, Result = 292e8000, Performance =  13.43 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035305 s, Result = 293b0000, Performance =  13.38 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.035938 s, Result = 29478000, Performance =  13.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.039154 s, Result = 29540000, Performance =  13.16 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040462 s, Result = 29608000, Performance =  13.27 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.043815 s, Result = 296d0000, Performance =  12.74 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.045414 s, Result = 29798000, Performance =  12.77 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.047932 s, Result = 29860000, Performance =  12.54 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.050077 s, Result = 29928000, Performance =  12.44 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.052291 s, Result = 299f0000, Performance =  12.32 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.054495 s, Result = 29ab8000, Performance =  12.22 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.056282 s, Result = 29b80000, Performance =  12.21 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.056114 s, Result = 29c48000, Performance =  12.63 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.058959 s, Result = 29d10000, Performance =  12.38 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.061479 s, Result = 29dd8000, Performance =  12.23 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.065336 s, Result = 29ea0000, Performance =  11.83 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066718 s, Result = 29f68000, Performance =  11.91 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.069607 s, Result = 2a030000, Performance =  11.72 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.071102 s, Result = 2a0f8000, Performance =  11.78 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.073953 s, Result = 2a1c0000, Performance =  11.62 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.075704 s, Result = 2a288000, Performance =  11.63 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.076820 s, Result = 2a350000, Performance =  11.74 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.080472 s, Result = 2a418000, Performance =  11.47 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.082893 s, Result = 2a4e0000, Performance =  11.40 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.086622 s, Result = 2a5a8000, Performance =  11.16 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.090288 s, Result = 2a670000, Performance =  10.94 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.094148 s, Result = 2a738000, Performance =  10.72 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.097921 s, Result = 2a800000, Performance =  10.53 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.100781 s, Result = 2a8c8000, Performance =  10.44 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.102570 s, Result = 2a990000, Performance =  10.47 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.106375 s, Result = 2aa58000, Performance =  10.30 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.111070 s, Result = 2ab20000, Performance =  10.05 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.114159 s, Result = 2abe8000, Performance =   9.97 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.116117 s, Result = 2acb0000, Performance =   9.99 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.117691 s, Result = 2ad78000, Performance =  10.04 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.119127 s, Result = 2ae40000, Performance =  10.10 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.120451 s, Result = 2af08000, Performance =  10.16 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.121644 s, Result = 2afd0000, Performance =  10.24 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.122768 s, Result = 2b098000, Performance =  10.32 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.124307 s, Result = 2b160000, Performance =  10.37 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.126780 s, Result = 2b228000, Performance =  10.33 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.128207 s, Result = 2b2f0000, Performance =  10.39 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.120992 s, Result = 2b3b8000, Performance =  11.18 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.155840 s, Result = 2b480000, Performance =   8.82 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1180  1322   448
Test passed: M N K =   143   901   128
Test passed: M N K =   455  1367    64
Test passed: M N K =  1418   766   128
Test passed: M N K =  1308   660  2048
M N K =  2048  2048   256, Elapsed time =   0.001267 s, Result = 000c8000, Performance =  16.95 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002685 s, Result = 00190000, Performance =  16.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004309 s, Result = 00258000, Performance =  14.95 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005260 s, Result = 00320000, Performance =  16.33 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005332 s, Result = 003e8000, Performance =  20.14 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013127 s, Result = 004b0000, Performance =   9.82 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008165 s, Result = 00578000, Performance =  18.41 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008119 s, Result = 00640000, Performance =  21.16 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009944 s, Result = 00708000, Performance =  19.44 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010599 s, Result = 007d0000, Performance =  20.26 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011373 s, Result = 00898000, Performance =  20.77 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013153 s, Result = 00960000, Performance =  19.59 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014446 s, Result = 00a28000, Performance =  19.33 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015412 s, Result = 00af0000, Performance =  19.51 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017033 s, Result = 00bb8000, Performance =  18.91 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017360 s, Result = 00c80000, Performance =  19.79 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019041 s, Result = 00d48000, Performance =  19.17 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019516 s, Result = 00e10000, Performance =  19.81 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020563 s, Result = 00ed8000, Performance =  19.84 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022138 s, Result = 00fa0000, Performance =  19.40 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023551 s, Result = 01068000, Performance =  19.15 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026739 s, Result = 01130000, Performance =  17.67 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027515 s, Result = 011f8000, Performance =  17.95 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030272 s, Result = 012c0000, Performance =  17.03 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032289 s, Result = 01388000, Performance =  16.63 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.034436 s, Result = 01450000, Performance =  16.21 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.036596 s, Result = 01518000, Performance =  15.84 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.037720 s, Result = 015e0000, Performance =  15.94 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.040484 s, Result = 016a8000, Performance =  15.38 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.042419 s, Result = 01770000, Performance =  15.19 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.044324 s, Result = 01838000, Performance =  15.02 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.045296 s, Result = 01900000, Performance =  15.17 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.047610 s, Result = 019c8000, Performance =  14.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.050760 s, Result = 01a90000, Performance =  14.38 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051924 s, Result = 01b58000, Performance =  14.48 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.055211 s, Result = 01c20000, Performance =  14.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.057585 s, Result = 01ce8000, Performance =  13.80 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.059715 s, Result = 01db0000, Performance =  13.67 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061770 s, Result = 01e78000, Performance =  13.56 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.064147 s, Result = 01f40000, Performance =  13.39 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064955 s, Result = 02008000, Performance =  13.55 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.068032 s, Result = 020d0000, Performance =  13.26 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.069369 s, Result = 02198000, Performance =  13.31 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.072782 s, Result = 02260000, Performance =  12.98 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.074649 s, Result = 02328000, Performance =  12.95 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.077396 s, Result = 023f0000, Performance =  12.76 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.079036 s, Result = 024b8000, Performance =  12.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.082421 s, Result = 02580000, Performance =  12.51 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.085158 s, Result = 02648000, Performance =  12.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.086465 s, Result = 02710000, Performance =  12.42 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.090311 s, Result = 027d8000, Performance =  12.13 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.091840 s, Result = 028a0000, Performance =  12.16 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.094916 s, Result = 02968000, Performance =  11.99 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.097595 s, Result = 02a30000, Performance =  11.88 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.098360 s, Result = 02af8000, Performance =  12.01 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.100724 s, Result = 02bc0000, Performance =  11.94 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.102224 s, Result = 02c88000, Performance =  11.97 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.107619 s, Result = 02d50000, Performance =  11.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.111283 s, Result = 02e18000, Performance =  11.39 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.112959 s, Result = 02ee0000, Performance =  11.41 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.115748 s, Result = 02fa8000, Performance =  11.32 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.118937 s, Result = 03070000, Performance =  11.19 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.111155 s, Result = 03138000, Performance =  12.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.146154 s, Result = 03200000, Performance =   9.40 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   235  2037  1728
Test passed: M N K =   104  1017   512
Test passed: M N K =    54  1600  1280
Test passed: M N K =   989   728   512
Test passed: M N K =   762  1562   512
M N K =  2048  2048   256, Elapsed time =   0.010081 s, Result = d4108000, Performance =   2.13 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007048 s, Result = a41d0000, Performance =   6.09 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009411 s, Result = 74298000, Performance =   6.85 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011696 s, Result = 44360000, Performance =   7.34 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011754 s, Result = 14428000, Performance =   9.13 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013433 s, Result = e44f0000, Performance =   9.59 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.016382 s, Result = b45b8000, Performance =   9.18 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016386 s, Result = 84680000, Performance =  10.48 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018086 s, Result = 54748000, Performance =  10.69 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.019861 s, Result = 24810000, Performance =  10.81 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.021775 s, Result = f48d8000, Performance =  10.85 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.022922 s, Result = c49a0000, Performance =  11.24 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.024743 s, Result = 94a68000, Performance =  11.28 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.025600 s, Result = 64b30000, Performance =  11.74 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026956 s, Result = 34bf8000, Performance =  11.95 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.028178 s, Result = 04cc0000, Performance =  12.19 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.031530 s, Result = d4d88000, Performance =  11.58 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.033510 s, Result = a4e50000, Performance =  11.54 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.034293 s, Result = 74f18000, Performance =  11.90 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.036049 s, Result = 44fe0000, Performance =  11.91 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.037170 s, Result = 150a8000, Performance =  12.13 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.039992 s, Result = e5170000, Performance =  11.81 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.041688 s, Result = b5238000, Performance =  11.85 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.043894 s, Result = 85300000, Performance =  11.74 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.045555 s, Result = 553c8000, Performance =  11.79 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.047225 s, Result = 25490000, Performance =  11.82 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.049490 s, Result = f5558000, Performance =  11.72 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.050698 s, Result = c5620000, Performance =  11.86 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.053450 s, Result = 956e8000, Performance =  11.65 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.055723 s, Result = 657b0000, Performance =  11.56 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.057233 s, Result = 35878000, Performance =  11.63 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.060783 s, Result = 05940000, Performance =  11.31 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.060771 s, Result = d5a08000, Performance =  11.66 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.061667 s, Result = a5ad0000, Performance =  11.84 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.063858 s, Result = 75b98000, Performance =  11.77 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.066211 s, Result = 45c60000, Performance =  11.68 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.067760 s, Result = 15d28000, Performance =  11.73 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.069845 s, Result = e5df0000, Performance =  11.68 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.071569 s, Result = b5eb8000, Performance =  11.70 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.073257 s, Result = 85f80000, Performance =  11.73 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.076793 s, Result = 56048000, Performance =  11.47 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.078109 s, Result = 26110000, Performance =  11.55 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.080724 s, Result = f61d8000, Performance =  11.44 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.080972 s, Result = c62a0000, Performance =  11.67 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.084066 s, Result = 96368000, Performance =  11.50 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.088102 s, Result = 66430000, Performance =  11.21 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.089957 s, Result = 364f8000, Performance =  11.22 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.090671 s, Result = 065c0000, Performance =  11.37 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.092962 s, Result = d6688000, Performance =  11.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.094951 s, Result = a6750000, Performance =  11.31 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.097861 s, Result = 76818000, Performance =  11.19 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.100303 s, Result = 468e0000, Performance =  11.13 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.102146 s, Result = 169a8000, Performance =  11.14 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.103626 s, Result = e6a70000, Performance =  11.19 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.106137 s, Result = b6b38000, Performance =  11.13 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.108018 s, Result = 86c00000, Performance =  11.13 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.114585 s, Result = 56cc8000, Performance =  10.68 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.116915 s, Result = 26d90000, Performance =  10.65 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.118016 s, Result = f6e58000, Performance =  10.74 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.121920 s, Result = c6f20000, Performance =  10.57 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.122728 s, Result = 96fe8000, Performance =  10.67 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.118903 s, Result = 670b0000, Performance =  11.20 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.123251 s, Result = 37178000, Performance =  10.98 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.174535 s, Result = 07240000, Performance =   7.87 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1214   176  1792
Test passed: M N K =  1014  1759  1280
Test passed: M N K =   900   509   512
Test passed: M N K =   982   592  1280
Test passed: M N K =   474   727   832
M N K =  2048  2048   256, Elapsed time =   0.007943 s, Result = 000c8000, Performance =   2.70 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005779 s, Result = 00190000, Performance =   7.43 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006223 s, Result = 00258000, Performance =  10.35 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007449 s, Result = 00320000, Performance =  11.53 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008751 s, Result = 003e8000, Performance =  12.27 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011100 s, Result = 004b0000, Performance =  11.61 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011544 s, Result = 00578000, Performance =  13.02 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013659 s, Result = 00640000, Performance =  12.58 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015725 s, Result = 00708000, Performance =  12.29 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016746 s, Result = 007d0000, Performance =  12.82 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017789 s, Result = 00898000, Performance =  13.28 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018896 s, Result = 00960000, Performance =  13.64 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020082 s, Result = 00a28000, Performance =  13.90 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022239 s, Result = 00af0000, Performance =  13.52 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023306 s, Result = 00bb8000, Performance =  13.82 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.025123 s, Result = 00c80000, Performance =  13.68 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025271 s, Result = 00d48000, Performance =  14.45 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.026793 s, Result = 00e10000, Performance =  14.43 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.029538 s, Result = 00ed8000, Performance =  13.81 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031097 s, Result = 00fa0000, Performance =  13.81 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033173 s, Result = 01068000, Performance =  13.59 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.035581 s, Result = 01130000, Performance =  13.28 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.036249 s, Result = 011f8000, Performance =  13.63 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038542 s, Result = 012c0000, Performance =  13.37 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.039383 s, Result = 01388000, Performance =  13.63 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.041550 s, Result = 01450000, Performance =  13.44 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.042947 s, Result = 01518000, Performance =  13.50 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.044799 s, Result = 015e0000, Performance =  13.42 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.046753 s, Result = 016a8000, Performance =  13.32 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.048525 s, Result = 01770000, Performance =  13.28 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.049592 s, Result = 01838000, Performance =  13.42 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.056516 s, Result = 01900000, Performance =  12.16 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.053241 s, Result = 019c8000, Performance =  13.31 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.054152 s, Result = 01a90000, Performance =  13.48 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.056007 s, Result = 01b58000, Performance =  13.42 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.058422 s, Result = 01c20000, Performance =  13.23 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.060774 s, Result = 01ce8000, Performance =  13.07 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.062903 s, Result = 01db0000, Performance =  12.97 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.065126 s, Result = 01e78000, Performance =  12.86 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.066274 s, Result = 01f40000, Performance =  12.96 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.068349 s, Result = 02008000, Performance =  12.88 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.070745 s, Result = 020d0000, Performance =  12.75 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.072500 s, Result = 02198000, Performance =  12.74 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.073922 s, Result = 02260000, Performance =  12.78 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.076236 s, Result = 02328000, Performance =  12.68 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.078295 s, Result = 023f0000, Performance =  12.62 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.080712 s, Result = 024b8000, Performance =  12.51 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.082536 s, Result = 02580000, Performance =  12.49 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.085139 s, Result = 02648000, Performance =  12.36 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.087012 s, Result = 02710000, Performance =  12.34 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.088897 s, Result = 027d8000, Performance =  12.32 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.091519 s, Result = 028a0000, Performance =  12.20 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.093537 s, Result = 02968000, Performance =  12.17 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.094860 s, Result = 02a30000, Performance =  12.22 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.096738 s, Result = 02af8000, Performance =  12.21 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.098434 s, Result = 02bc0000, Performance =  12.22 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.103085 s, Result = 02c88000, Performance =  11.87 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.107483 s, Result = 02d50000, Performance =  11.59 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.111351 s, Result = 02e18000, Performance =  11.38 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.114330 s, Result = 02ee0000, Performance =  11.27 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.115044 s, Result = 02fa8000, Performance =  11.39 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.112126 s, Result = 03070000, Performance =  11.87 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.116111 s, Result = 03138000, Performance =  11.65 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.166688 s, Result = 03200000, Performance =   8.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   525   740  1984
Test passed: M N K =     2  1550  1664
Test passed: M N K =  1793  1719  1408
Test passed: M N K =  1889   703   320
Test passed: M N K =   360   536  1088
M N K =  2048  2048   256, Elapsed time =   0.010432 s, Result = 28348000, Performance =   2.06 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009592 s, Result = 28410000, Performance =   4.48 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010343 s, Result = 284d8000, Performance =   6.23 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011289 s, Result = 285a0000, Performance =   7.61 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012838 s, Result = 28668000, Performance =   8.36 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.013897 s, Result = 28730000, Performance =   9.27 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015126 s, Result = 287f8000, Performance =   9.94 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016814 s, Result = 288c0000, Performance =  10.22 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017363 s, Result = 28988000, Performance =  11.13 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.017889 s, Result = 28a50000, Performance =  12.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019023 s, Result = 28b18000, Performance =  12.42 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.020762 s, Result = 28be0000, Performance =  12.41 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.022336 s, Result = 28ca8000, Performance =  12.50 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022854 s, Result = 28d70000, Performance =  13.16 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023864 s, Result = 28e38000, Performance =  13.50 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024480 s, Result = 28f00000, Performance =  14.04 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027355 s, Result = 28fc8000, Performance =  13.35 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.028339 s, Result = 29090000, Performance =  13.64 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.029668 s, Result = 29158000, Performance =  13.75 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.030362 s, Result = 29220000, Performance =  14.15 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.032401 s, Result = 292e8000, Performance =  13.92 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.033427 s, Result = 293b0000, Performance =  14.13 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034978 s, Result = 29478000, Performance =  14.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.036649 s, Result = 29540000, Performance =  14.06 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.038405 s, Result = 29608000, Performance =  13.98 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.040166 s, Result = 296d0000, Performance =  13.90 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.041541 s, Result = 29798000, Performance =  13.96 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.043881 s, Result = 29860000, Performance =  13.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.045528 s, Result = 29928000, Performance =  13.68 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.047461 s, Result = 299f0000, Performance =  13.57 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.049292 s, Result = 29ab8000, Performance =  13.51 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.052071 s, Result = 29b80000, Performance =  13.20 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.051721 s, Result = 29c48000, Performance =  13.70 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.052241 s, Result = 29d10000, Performance =  13.98 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.053972 s, Result = 29dd8000, Performance =  13.93 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.056387 s, Result = 29ea0000, Performance =  13.71 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.059346 s, Result = 29f68000, Performance =  13.39 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.060627 s, Result = 2a030000, Performance =  13.46 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.063388 s, Result = 2a0f8000, Performance =  13.21 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.064370 s, Result = 2a1c0000, Performance =  13.34 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.066538 s, Result = 2a288000, Performance =  13.23 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.067209 s, Result = 2a350000, Performance =  13.42 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.071353 s, Result = 2a418000, Performance =  12.94 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.072611 s, Result = 2a4e0000, Performance =  13.01 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.075441 s, Result = 2a5a8000, Performance =  12.81 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.077859 s, Result = 2a670000, Performance =  12.69 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.080001 s, Result = 2a738000, Performance =  12.62 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.081535 s, Result = 2a800000, Performance =  12.64 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.084371 s, Result = 2a8c8000, Performance =  12.47 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.085914 s, Result = 2a990000, Performance =  12.50 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.088323 s, Result = 2aa58000, Performance =  12.40 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.092622 s, Result = 2ab20000, Performance =  12.06 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.097827 s, Result = 2abe8000, Performance =  11.63 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.098483 s, Result = 2acb0000, Performance =  11.78 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.100263 s, Result = 2ad78000, Performance =  11.78 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.101681 s, Result = 2ae40000, Performance =  11.83 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.104414 s, Result = 2af08000, Performance =  11.72 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.106028 s, Result = 2afd0000, Performance =  11.75 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.107487 s, Result = 2b098000, Performance =  11.79 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.112765 s, Result = 2b160000, Performance =  11.43 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.114179 s, Result = 2b228000, Performance =  11.47 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.113317 s, Result = 2b2f0000, Performance =  11.75 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.115750 s, Result = 2b3b8000, Performance =  11.69 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.164995 s, Result = 2b480000, Performance =   8.33 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   341    82  2048
Test passed: M N K =  1473  2042   960
Test passed: M N K =  1032   693  1280
Test passed: M N K =  1163   919   128
Test passed: M N K =   307  1582   384
M N K =  2048  2048   256, Elapsed time =   0.001212 s, Result = 000c8000, Performance =  17.72 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002454 s, Result = 00190000, Performance =  17.50 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004216 s, Result = 00258000, Performance =  15.28 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005614 s, Result = 00320000, Performance =  15.30 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005711 s, Result = 003e8000, Performance =  18.80 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.005778 s, Result = 004b0000, Performance =  22.30 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007071 s, Result = 00578000, Performance =  21.26 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008809 s, Result = 00640000, Performance =  19.50 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.010131 s, Result = 00708000, Performance =  19.08 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011089 s, Result = 007d0000, Performance =  19.37 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011540 s, Result = 00898000, Performance =  20.47 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013048 s, Result = 00960000, Performance =  19.75 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012972 s, Result = 00a28000, Performance =  21.52 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014281 s, Result = 00af0000, Performance =  21.05 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016292 s, Result = 00bb8000, Performance =  19.77 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017281 s, Result = 00c80000, Performance =  19.88 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017491 s, Result = 00d48000, Performance =  20.87 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018450 s, Result = 00e10000, Performance =  20.95 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019931 s, Result = 00ed8000, Performance =  20.47 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021256 s, Result = 00fa0000, Performance =  20.21 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022594 s, Result = 01068000, Performance =  19.96 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025622 s, Result = 01130000, Performance =  18.44 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027161 s, Result = 011f8000, Performance =  18.18 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027290 s, Result = 012c0000, Performance =  18.89 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030524 s, Result = 01388000, Performance =  17.59 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031978 s, Result = 01450000, Performance =  17.46 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.033869 s, Result = 01518000, Performance =  17.12 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.035642 s, Result = 015e0000, Performance =  16.87 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037328 s, Result = 016a8000, Performance =  16.68 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.039529 s, Result = 01770000, Performance =  16.30 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040940 s, Result = 01838000, Performance =  16.26 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043198 s, Result = 01900000, Performance =  15.91 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.044592 s, Result = 019c8000, Performance =  15.89 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043553 s, Result = 01a90000, Performance =  16.76 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.047088 s, Result = 01b58000, Performance =  15.96 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.048668 s, Result = 01c20000, Performance =  15.89 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.050995 s, Result = 01ce8000, Performance =  15.58 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.051767 s, Result = 01db0000, Performance =  15.76 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.054931 s, Result = 01e78000, Performance =  15.25 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.056518 s, Result = 01f40000, Performance =  15.20 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.058240 s, Result = 02008000, Performance =  15.12 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.060229 s, Result = 020d0000, Performance =  14.98 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.062259 s, Result = 02198000, Performance =  14.83 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.063854 s, Result = 02260000, Performance =  14.80 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.065897 s, Result = 02328000, Performance =  14.66 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.068505 s, Result = 023f0000, Performance =  14.42 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.072196 s, Result = 024b8000, Performance =  13.98 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.074081 s, Result = 02580000, Performance =  13.91 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.076387 s, Result = 02648000, Performance =  13.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.077668 s, Result = 02710000, Performance =  13.82 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.080250 s, Result = 027d8000, Performance =  13.65 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.081818 s, Result = 028a0000, Performance =  13.65 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.084177 s, Result = 02968000, Performance =  13.52 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.085451 s, Result = 02a30000, Performance =  13.57 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.087952 s, Result = 02af8000, Performance =  13.43 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.088847 s, Result = 02bc0000, Performance =  13.54 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.092297 s, Result = 02c88000, Performance =  13.26 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.093767 s, Result = 02d50000, Performance =  13.28 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.095252 s, Result = 02e18000, Performance =  13.30 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.101329 s, Result = 02ee0000, Performance =  12.72 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.100372 s, Result = 02fa8000, Performance =  13.05 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.101373 s, Result = 03070000, Performance =  13.13 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.103897 s, Result = 03138000, Performance =  13.02 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.149379 s, Result = 03200000, Performance =   9.20 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   954   255  1600
Test passed: M N K =  1854   908  1792
Test passed: M N K =  1338   879   896
Test passed: M N K =   874  1887    64
Test passed: M N K =  1221   436  2048
M N K =  2048  2048   256, Elapsed time =   0.006165 s, Result = d4108000, Performance =   3.48 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007068 s, Result = a41d0000, Performance =   6.08 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010216 s, Result = 74298000, Performance =   6.31 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.011342 s, Result = 44360000, Performance =   7.57 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.013246 s, Result = 14428000, Performance =   8.11 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014805 s, Result = e44f0000, Performance =   8.70 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.016341 s, Result = b45b8000, Performance =   9.20 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.015869 s, Result = 84680000, Performance =  10.83 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.018961 s, Result = 54748000, Performance =  10.19 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.019170 s, Result = 24810000, Performance =  11.20 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.020899 s, Result = f48d8000, Performance =  11.30 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.022039 s, Result = c49a0000, Performance =  11.69 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.023944 s, Result = 94a68000, Performance =  11.66 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.025946 s, Result = 64b30000, Performance =  11.59 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.026108 s, Result = 34bf8000, Performance =  12.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.028632 s, Result = 04cc0000, Performance =  12.00 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.030467 s, Result = d4d88000, Performance =  11.98 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.031617 s, Result = a4e50000, Performance =  12.23 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.033744 s, Result = 74f18000, Performance =  12.09 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.035082 s, Result = 44fe0000, Performance =  12.24 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.036930 s, Result = 150a8000, Performance =  12.21 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.038066 s, Result = e5170000, Performance =  12.41 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.040251 s, Result = b5238000, Performance =  12.27 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.041136 s, Result = 85300000, Performance =  12.53 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.044112 s, Result = 553c8000, Performance =  12.17 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.045937 s, Result = 25490000, Performance =  12.15 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.047679 s, Result = f5558000, Performance =  12.16 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.049011 s, Result = c5620000, Performance =  12.27 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.051631 s, Result = 956e8000, Performance =  12.06 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.053150 s, Result = 657b0000, Performance =  12.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.055005 s, Result = 35878000, Performance =  12.10 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.057001 s, Result = 05940000, Performance =  12.06 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.058878 s, Result = d5a08000, Performance =  12.04 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.061310 s, Result = a5ad0000, Performance =  11.91 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.062786 s, Result = 75b98000, Performance =  11.97 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.063832 s, Result = 45c60000, Performance =  12.11 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.066523 s, Result = 15d28000, Performance =  11.94 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.067632 s, Result = e5df0000, Performance =  12.07 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.069970 s, Result = b5eb8000, Performance =  11.97 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.070921 s, Result = 85f80000, Performance =  12.11 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.073030 s, Result = 56048000, Performance =  12.06 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.075746 s, Result = 26110000, Performance =  11.91 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.077499 s, Result = f61d8000, Performance =  11.92 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.078597 s, Result = c62a0000, Performance =  12.02 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.081784 s, Result = 96368000, Performance =  11.82 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.083121 s, Result = 66430000, Performance =  11.88 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.085759 s, Result = 364f8000, Performance =  11.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.086485 s, Result = 065c0000, Performance =  11.92 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.089364 s, Result = d6688000, Performance =  11.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.090938 s, Result = a6750000, Performance =  11.81 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.093671 s, Result = 76818000, Performance =  11.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.094649 s, Result = 468e0000, Performance =  11.80 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.097793 s, Result = 169a8000, Performance =  11.64 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.099678 s, Result = e6a70000, Performance =  11.63 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.103199 s, Result = b6b38000, Performance =  11.45 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.104955 s, Result = 86c00000, Performance =  11.46 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.107844 s, Result = 56cc8000, Performance =  11.35 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.111553 s, Result = 26d90000, Performance =  11.17 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.116900 s, Result = f6e58000, Performance =  10.84 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.112943 s, Result = c6f20000, Performance =  11.41 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.117076 s, Result = 96fe8000, Performance =  11.19 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.118108 s, Result = 670b0000, Performance =  11.27 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.116982 s, Result = 37178000, Performance =  11.57 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.150216 s, Result = 07240000, Performance =   9.15 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   547   778  2048
Test passed: M N K =   701  1779   896
Test passed: M N K =  1936   304  1856
Test passed: M N K =   428  1914   960
Test passed: M N K =   868  1072   384
M N K =  2048  2048   256, Elapsed time =   0.009257 s, Result = 000c8000, Performance =   2.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005977 s, Result = 00190000, Performance =   7.19 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006160 s, Result = 00258000, Performance =  10.46 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007437 s, Result = 00320000, Performance =  11.55 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008493 s, Result = 003e8000, Performance =  12.64 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011059 s, Result = 004b0000, Performance =  11.65 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012276 s, Result = 00578000, Performance =  12.25 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013678 s, Result = 00640000, Performance =  12.56 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015118 s, Result = 00708000, Performance =  12.78 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.016683 s, Result = 007d0000, Performance =  12.87 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017559 s, Result = 00898000, Performance =  13.45 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019025 s, Result = 00960000, Performance =  13.55 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020325 s, Result = 00a28000, Performance =  13.74 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.021978 s, Result = 00af0000, Performance =  13.68 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022098 s, Result = 00bb8000, Performance =  14.58 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.023839 s, Result = 00c80000, Performance =  14.41 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025341 s, Result = 00d48000, Performance =  14.41 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025945 s, Result = 00e10000, Performance =  14.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.027640 s, Result = 00ed8000, Performance =  14.76 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028840 s, Result = 00fa0000, Performance =  14.89 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.031712 s, Result = 01068000, Performance =  14.22 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.033205 s, Result = 01130000, Performance =  14.23 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034571 s, Result = 011f8000, Performance =  14.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035524 s, Result = 012c0000, Performance =  14.51 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037448 s, Result = 01388000, Performance =  14.34 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039349 s, Result = 01450000, Performance =  14.19 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.040692 s, Result = 01518000, Performance =  14.25 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.042191 s, Result = 015e0000, Performance =  14.25 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.044675 s, Result = 016a8000, Performance =  13.94 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.046289 s, Result = 01770000, Performance =  13.92 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.047854 s, Result = 01838000, Performance =  13.91 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.049508 s, Result = 01900000, Performance =  13.88 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.051708 s, Result = 019c8000, Performance =  13.71 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.053558 s, Result = 01a90000, Performance =  13.63 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.054106 s, Result = 01b58000, Performance =  13.89 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.054837 s, Result = 01c20000, Performance =  14.10 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.056946 s, Result = 01ce8000, Performance =  13.95 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.060302 s, Result = 01db0000, Performance =  13.53 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061440 s, Result = 01e78000, Performance =  13.63 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.062901 s, Result = 01f40000, Performance =  13.66 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064620 s, Result = 02008000, Performance =  13.63 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.067054 s, Result = 020d0000, Performance =  13.45 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.068452 s, Result = 02198000, Performance =  13.49 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.069865 s, Result = 02260000, Performance =  13.52 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.073250 s, Result = 02328000, Performance =  13.19 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.075534 s, Result = 023f0000, Performance =  13.08 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.078000 s, Result = 024b8000, Performance =  12.94 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.078814 s, Result = 02580000, Performance =  13.08 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.081582 s, Result = 02648000, Performance =  12.90 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.083872 s, Result = 02710000, Performance =  12.80 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.086293 s, Result = 027d8000, Performance =  12.69 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.087781 s, Result = 028a0000, Performance =  12.72 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.089900 s, Result = 02968000, Performance =  12.66 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.091634 s, Result = 02a30000, Performance =  12.66 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.094109 s, Result = 02af8000, Performance =  12.55 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.095989 s, Result = 02bc0000, Performance =  12.53 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.097683 s, Result = 02c88000, Performance =  12.53 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.099695 s, Result = 02d50000, Performance =  12.49 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.105681 s, Result = 02e18000, Performance =  11.99 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.102706 s, Result = 02ee0000, Performance =  12.55 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.106476 s, Result = 02fa8000, Performance =  12.30 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.108597 s, Result = 03070000, Performance =  12.26 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.107952 s, Result = 03138000, Performance =  12.53 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.145431 s, Result = 03200000, Performance =   9.45 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   505  1070  1088
Test passed: M N K =   611  1321   320
Test passed: M N K =   795   871   960
Test passed: M N K =   559  1426  1600
Test passed: M N K =   167   655   704
M N K =  2048  2048   256, Elapsed time =   0.006793 s, Result = 28348000, Performance =   3.16 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009182 s, Result = 28410000, Performance =   4.68 TOPS
M N K =  2048  2048   768, Elapsed time =   0.010144 s, Result = 284d8000, Performance =   6.35 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.010828 s, Result = 285a0000, Performance =   7.93 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.012735 s, Result = 28668000, Performance =   8.43 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.014657 s, Result = 28730000, Performance =   8.79 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.015635 s, Result = 287f8000, Performance =   9.61 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.016608 s, Result = 288c0000, Performance =  10.34 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.017198 s, Result = 28988000, Performance =  11.24 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.018724 s, Result = 28a50000, Performance =  11.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019659 s, Result = 28b18000, Performance =  12.02 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.019827 s, Result = 28be0000, Performance =  13.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.021597 s, Result = 28ca8000, Performance =  12.93 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022858 s, Result = 28d70000, Performance =  13.15 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.023669 s, Result = 28e38000, Performance =  13.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024564 s, Result = 28f00000, Performance =  13.99 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025521 s, Result = 28fc8000, Performance =  14.30 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.027907 s, Result = 29090000, Performance =  13.85 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.029128 s, Result = 29158000, Performance =  14.01 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.030296 s, Result = 29220000, Performance =  14.18 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.030497 s, Result = 292e8000, Performance =  14.79 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.032977 s, Result = 293b0000, Performance =  14.33 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.033970 s, Result = 29478000, Performance =  14.54 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.035275 s, Result = 29540000, Performance =  14.61 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.036642 s, Result = 29608000, Performance =  14.65 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.038705 s, Result = 296d0000, Performance =  14.43 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.039901 s, Result = 29798000, Performance =  14.53 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.041668 s, Result = 29860000, Performance =  14.43 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.043834 s, Result = 29928000, Performance =  14.21 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.045095 s, Result = 299f0000, Performance =  14.29 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.047094 s, Result = 29ab8000, Performance =  14.14 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.048534 s, Result = 29b80000, Performance =  14.16 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.050903 s, Result = 29c48000, Performance =  13.92 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.052866 s, Result = 29d10000, Performance =  13.81 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.054048 s, Result = 29dd8000, Performance =  13.91 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.054296 s, Result = 29ea0000, Performance =  14.24 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.055917 s, Result = 29f68000, Performance =  14.21 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058860 s, Result = 2a030000, Performance =  13.86 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061806 s, Result = 2a0f8000, Performance =  13.55 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.062041 s, Result = 2a1c0000, Performance =  13.85 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.064749 s, Result = 2a288000, Performance =  13.60 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.066434 s, Result = 2a350000, Performance =  13.58 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.067774 s, Result = 2a418000, Performance =  13.63 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.069329 s, Result = 2a4e0000, Performance =  13.63 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.072757 s, Result = 2a5a8000, Performance =  13.28 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.074840 s, Result = 2a670000, Performance =  13.20 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.077205 s, Result = 2a738000, Performance =  13.07 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.078659 s, Result = 2a800000, Performance =  13.10 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.081138 s, Result = 2a8c8000, Performance =  12.97 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.086817 s, Result = 2a990000, Performance =  12.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.089031 s, Result = 2aa58000, Performance =  12.30 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.088099 s, Result = 2ab20000, Performance =  12.68 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.091129 s, Result = 2abe8000, Performance =  12.49 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.093774 s, Result = 2acb0000, Performance =  12.37 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.099214 s, Result = 2ad78000, Performance =  11.90 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.100493 s, Result = 2ae40000, Performance =  11.97 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.103221 s, Result = 2af08000, Performance =  11.86 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.106986 s, Result = 2afd0000, Performance =  11.64 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.110027 s, Result = 2b098000, Performance =  11.52 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.107408 s, Result = 2b160000, Performance =  12.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.109747 s, Result = 2b228000, Performance =  11.94 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.111447 s, Result = 2b2f0000, Performance =  11.95 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.111021 s, Result = 2b3b8000, Performance =  12.19 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.142161 s, Result = 2b480000, Performance =   9.67 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   793  1626    64
Test passed: M N K =  1856  1502  1600
Test passed: M N K =   737   156  1152
Test passed: M N K =   871  1832   960
Test passed: M N K =  1376   972   512
M N K =  2048  2048   256, Elapsed time =   0.001214 s, Result = 000c8000, Performance =  17.69 TOPS
M N K =  2048  2048   512, Elapsed time =   0.002463 s, Result = 00190000, Performance =  17.44 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003988 s, Result = 00258000, Performance =  16.16 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005620 s, Result = 00320000, Performance =  15.28 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007288 s, Result = 003e8000, Performance =  14.73 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008347 s, Result = 004b0000, Performance =  15.44 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008672 s, Result = 00578000, Performance =  17.33 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007602 s, Result = 00640000, Performance =  22.60 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.008610 s, Result = 00708000, Performance =  22.45 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010620 s, Result = 007d0000, Performance =  20.22 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012023 s, Result = 00898000, Performance =  19.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011777 s, Result = 00960000, Performance =  21.88 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014020 s, Result = 00a28000, Performance =  19.91 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013981 s, Result = 00af0000, Performance =  21.50 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016074 s, Result = 00bb8000, Performance =  20.04 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.016304 s, Result = 00c80000, Performance =  21.07 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017287 s, Result = 00d48000, Performance =  21.12 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018283 s, Result = 00e10000, Performance =  21.14 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019118 s, Result = 00ed8000, Performance =  21.34 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.020599 s, Result = 00fa0000, Performance =  20.85 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.021774 s, Result = 01068000, Performance =  20.71 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023084 s, Result = 01130000, Performance =  20.47 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025633 s, Result = 011f8000, Performance =  19.27 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027238 s, Result = 012c0000, Performance =  18.92 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.028707 s, Result = 01388000, Performance =  18.70 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.030508 s, Result = 01450000, Performance =  18.30 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.032022 s, Result = 01518000, Performance =  18.11 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.033199 s, Result = 015e0000, Performance =  18.11 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.035111 s, Result = 016a8000, Performance =  17.74 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.036905 s, Result = 01770000, Performance =  17.46 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.038142 s, Result = 01838000, Performance =  17.45 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.040157 s, Result = 01900000, Performance =  17.11 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.042144 s, Result = 019c8000, Performance =  16.82 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.044020 s, Result = 01a90000, Performance =  16.59 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.043959 s, Result = 01b58000, Performance =  17.10 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.045627 s, Result = 01c20000, Performance =  16.94 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.047125 s, Result = 01ce8000, Performance =  16.86 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.049627 s, Result = 01db0000, Performance =  16.44 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.051667 s, Result = 01e78000, Performance =  16.21 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.052690 s, Result = 01f40000, Performance =  16.30 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.055085 s, Result = 02008000, Performance =  15.98 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.056730 s, Result = 020d0000, Performance =  15.90 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.058778 s, Result = 02198000, Performance =  15.71 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.061011 s, Result = 02260000, Performance =  15.49 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.063047 s, Result = 02328000, Performance =  15.33 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.065756 s, Result = 023f0000, Performance =  15.02 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.067443 s, Result = 024b8000, Performance =  14.97 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.068904 s, Result = 02580000, Performance =  14.96 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.071268 s, Result = 02648000, Performance =  14.76 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.080840 s, Result = 02710000, Performance =  13.28 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.081525 s, Result = 027d8000, Performance =  13.43 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.079295 s, Result = 028a0000, Performance =  14.08 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.080198 s, Result = 02968000, Performance =  14.19 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.082947 s, Result = 02a30000, Performance =  13.98 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.084069 s, Result = 02af8000, Performance =  14.05 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.088941 s, Result = 02bc0000, Performance =  13.52 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.093254 s, Result = 02c88000, Performance =  13.13 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.094268 s, Result = 02d50000, Performance =  13.21 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.098296 s, Result = 02e18000, Performance =  12.89 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.097269 s, Result = 02ee0000, Performance =  13.25 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.099814 s, Result = 02fa8000, Performance =  13.12 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.104539 s, Result = 03070000, Performance =  12.74 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.103184 s, Result = 03138000, Performance =  13.11 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.132900 s, Result = 03200000, Performance =  10.34 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1065  2046  1408
Test passed: M N K =  1096  1538   576
Test passed: M N K =   488  1269  1152
Test passed: M N K =  1286  1863   832
Test passed: M N K =  1180   567   448
M N K =  2048  2048   256, Elapsed time =   0.008930 s, Result = 640b8000, Performance =   2.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006675 s, Result = c4130000, Performance =   6.43 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008483 s, Result = 241a8000, Performance =   7.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009244 s, Result = 84220000, Performance =   9.29 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010634 s, Result = e4298000, Performance =  10.10 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011710 s, Result = 44310000, Performance =  11.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.013089 s, Result = a4388000, Performance =  11.49 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014340 s, Result = 04400000, Performance =  11.98 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.015857 s, Result = 64478000, Performance =  12.19 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015566 s, Result = c44f0000, Performance =  13.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.019127 s, Result = 24568000, Performance =  12.35 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017401 s, Result = 845e0000, Performance =  14.81 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.020308 s, Result = e4658000, Performance =  13.75 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.022746 s, Result = 446d0000, Performance =  13.22 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.024312 s, Result = a4748000, Performance =  13.25 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.024353 s, Result = 047c0000, Performance =  14.11 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.027006 s, Result = 64838000, Performance =  13.52 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.027562 s, Result = c48b0000, Performance =  14.02 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.030644 s, Result = 24928000, Performance =  13.32 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.031841 s, Result = 849a0000, Performance =  13.49 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.033558 s, Result = e4a18000, Performance =  13.44 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.034992 s, Result = 44a90000, Performance =  13.50 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.036376 s, Result = a4b08000, Performance =  13.58 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.038422 s, Result = 04b80000, Performance =  13.41 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.040013 s, Result = 64bf8000, Performance =  13.42 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.041511 s, Result = c4c70000, Performance =  13.45 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.043647 s, Result = 24ce8000, Performance =  13.28 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.045359 s, Result = 84d60000, Performance =  13.26 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.046861 s, Result = e4dd8000, Performance =  13.29 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.048366 s, Result = 44e50000, Performance =  13.32 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.050333 s, Result = a4ec8000, Performance =  13.23 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.051302 s, Result = 04f40000, Performance =  13.40 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.051664 s, Result = 64fb8000, Performance =  13.72 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.053391 s, Result = c5030000, Performance =  13.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.055096 s, Result = 250a8000, Performance =  13.64 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.056600 s, Result = 85120000, Performance =  13.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.057746 s, Result = e5198000, Performance =  13.76 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.058984 s, Result = 45210000, Performance =  13.83 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.060661 s, Result = a5288000, Performance =  13.81 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.062296 s, Result = 05300000, Performance =  13.79 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.063109 s, Result = 65378000, Performance =  13.95 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.064127 s, Result = c53f0000, Performance =  14.06 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.062787 s, Result = 25468000, Performance =  14.71 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.065768 s, Result = 854e0000, Performance =  14.37 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.067143 s, Result = e5558000, Performance =  14.39 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.068091 s, Result = 455d0000, Performance =  14.51 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.069444 s, Result = a5648000, Performance =  14.53 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.070952 s, Result = 056c0000, Performance =  14.53 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.072005 s, Result = 65738000, Performance =  14.61 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.073255 s, Result = c57b0000, Performance =  14.66 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.074939 s, Result = 25828000, Performance =  14.61 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.076466 s, Result = 858a0000, Performance =  14.60 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.079213 s, Result = e5918000, Performance =  14.37 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.081630 s, Result = 45990000, Performance =  14.21 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.083718 s, Result = a5a08000, Performance =  14.11 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.084259 s, Result = 05a80000, Performance =  14.27 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.084895 s, Result = 65af8000, Performance =  14.42 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.084655 s, Result = c5b70000, Performance =  14.71 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.084892 s, Result = 25be8000, Performance =  14.92 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.085446 s, Result = 85c60000, Performance =  15.08 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.086663 s, Result = e5cd8000, Performance =  15.12 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.086271 s, Result = 45d50000, Performance =  15.43 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.085112 s, Result = a5dc8000, Performance =  15.90 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.107991 s, Result = 05e40000, Performance =  12.73 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =     6  1789   448
Test passed: M N K =  1092   913  2048
Test passed: M N K =   696  1224   256
Test passed: M N K =   847   976   448
Test passed: M N K =   638   253  1024
M N K =  2048  2048   256, Elapsed time =   0.006950 s, Result = 00078000, Performance =   3.09 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004345 s, Result = 000f0000, Performance =   9.89 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004579 s, Result = 00168000, Performance =  14.07 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006543 s, Result = 001e0000, Performance =  13.13 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007192 s, Result = 00258000, Performance =  14.93 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008193 s, Result = 002d0000, Performance =  15.73 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008935 s, Result = 00348000, Performance =  16.82 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010387 s, Result = 003c0000, Performance =  16.54 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011868 s, Result = 00438000, Performance =  16.28 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013254 s, Result = 004b0000, Performance =  16.20 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014316 s, Result = 00528000, Performance =  16.50 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015488 s, Result = 005a0000, Performance =  16.64 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016624 s, Result = 00618000, Performance =  16.79 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018680 s, Result = 00690000, Performance =  16.09 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018175 s, Result = 00708000, Performance =  17.72 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.020581 s, Result = 00780000, Performance =  16.70 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.021888 s, Result = 007f8000, Performance =  16.68 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.023062 s, Result = 00870000, Performance =  16.76 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.024543 s, Result = 008e8000, Performance =  16.62 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.025818 s, Result = 00960000, Performance =  16.64 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028841 s, Result = 009d8000, Performance =  15.64 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.030183 s, Result = 00a50000, Performance =  15.65 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.031293 s, Result = 00ac8000, Performance =  15.78 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033428 s, Result = 00b40000, Performance =  15.42 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.034821 s, Result = 00bb8000, Performance =  15.42 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.036852 s, Result = 00c30000, Performance =  15.15 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038360 s, Result = 00ca8000, Performance =  15.12 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.039721 s, Result = 00d20000, Performance =  15.14 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.040785 s, Result = 00d98000, Performance =  15.27 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.043134 s, Result = 00e10000, Performance =  14.94 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.044364 s, Result = 00e88000, Performance =  15.01 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.045020 s, Result = 00f00000, Performance =  15.26 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.045605 s, Result = 00f78000, Performance =  15.54 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.047275 s, Result = 00ff0000, Performance =  15.44 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.049057 s, Result = 01068000, Performance =  15.32 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.050418 s, Result = 010e0000, Performance =  15.33 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.052362 s, Result = 01158000, Performance =  15.17 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.053338 s, Result = 011d0000, Performance =  15.30 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.054615 s, Result = 01248000, Performance =  15.33 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.055920 s, Result = 012c0000, Performance =  15.36 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.056310 s, Result = 01338000, Performance =  15.64 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.057387 s, Result = 013b0000, Performance =  15.72 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.056714 s, Result = 01428000, Performance =  16.28 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.060276 s, Result = 014a0000, Performance =  15.68 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.061857 s, Result = 01518000, Performance =  15.62 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.063330 s, Result = 01590000, Performance =  15.60 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.064236 s, Result = 01608000, Performance =  15.71 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.065741 s, Result = 01680000, Performance =  15.68 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.065996 s, Result = 016f8000, Performance =  15.94 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.067948 s, Result = 01770000, Performance =  15.80 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.070209 s, Result = 017e8000, Performance =  15.60 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.072833 s, Result = 01860000, Performance =  15.33 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.076524 s, Result = 018d8000, Performance =  14.87 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.078146 s, Result = 01950000, Performance =  14.84 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.078747 s, Result = 019c8000, Performance =  15.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.079066 s, Result = 01a40000, Performance =  15.21 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.079208 s, Result = 01ab8000, Performance =  15.45 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.079010 s, Result = 01b30000, Performance =  15.76 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.079202 s, Result = 01ba8000, Performance =  16.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.080122 s, Result = 01c20000, Performance =  16.08 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.081385 s, Result = 01c98000, Performance =  16.10 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.081720 s, Result = 01d10000, Performance =  16.29 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.080396 s, Result = 01d88000, Performance =  16.83 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.101870 s, Result = 01e00000, Performance =  13.49 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   614  1621   704
Test passed: M N K =  1418  1367  1408
Test passed: M N K =  1754  1150   896
Test passed: M N K =  1017    26   576
Test passed: M N K =  1780   395  1600
M N K =  2048  2048   256, Elapsed time =   0.009136 s, Result = 282f8000, Performance =   2.35 TOPS
M N K =  2048  2048   512, Elapsed time =   0.009302 s, Result = 28370000, Performance =   4.62 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009805 s, Result = 283e8000, Performance =   6.57 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009990 s, Result = 28460000, Performance =   8.60 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011242 s, Result = 284d8000, Performance =   9.55 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.012068 s, Result = 28550000, Performance =  10.68 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012833 s, Result = 285c8000, Performance =  11.71 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012790 s, Result = 28640000, Performance =  13.43 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014106 s, Result = 286b8000, Performance =  13.70 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014668 s, Result = 28730000, Performance =  14.64 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015105 s, Result = 287a8000, Performance =  15.64 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016081 s, Result = 28820000, Performance =  16.03 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.017280 s, Result = 28898000, Performance =  16.16 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.018124 s, Result = 28910000, Performance =  16.59 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.019032 s, Result = 28988000, Performance =  16.93 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019926 s, Result = 28a00000, Performance =  17.24 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019990 s, Result = 28a78000, Performance =  18.26 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020994 s, Result = 28af0000, Performance =  18.41 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021763 s, Result = 28b68000, Performance =  18.75 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023731 s, Result = 28be0000, Performance =  18.10 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025087 s, Result = 28c58000, Performance =  17.98 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.027304 s, Result = 28cd0000, Performance =  17.30 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.028265 s, Result = 28d48000, Performance =  17.47 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.029530 s, Result = 28dc0000, Performance =  17.45 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.031665 s, Result = 28e38000, Performance =  16.95 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.033185 s, Result = 28eb0000, Performance =  16.83 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.034732 s, Result = 28f28000, Performance =  16.69 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036274 s, Result = 28fa0000, Performance =  16.58 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037418 s, Result = 29018000, Performance =  16.64 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.038501 s, Result = 29090000, Performance =  16.73 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040682 s, Result = 29108000, Performance =  16.36 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.041417 s, Result = 29180000, Performance =  16.59 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.041570 s, Result = 291f8000, Performance =  17.05 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043765 s, Result = 29270000, Performance =  16.68 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.045059 s, Result = 292e8000, Performance =  16.68 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.046397 s, Result = 29360000, Performance =  16.66 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.048705 s, Result = 293d8000, Performance =  16.31 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.049785 s, Result = 29450000, Performance =  16.39 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.050945 s, Result = 294c8000, Performance =  16.44 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.052238 s, Result = 29540000, Performance =  16.44 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.053099 s, Result = 295b8000, Performance =  16.58 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.054041 s, Result = 29630000, Performance =  16.69 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.053697 s, Result = 296a8000, Performance =  17.20 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.055832 s, Result = 29720000, Performance =  16.92 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.057911 s, Result = 29798000, Performance =  16.69 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.059532 s, Result = 29810000, Performance =  16.59 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.060748 s, Result = 29888000, Performance =  16.61 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.062386 s, Result = 29900000, Performance =  16.52 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.063339 s, Result = 29978000, Performance =  16.61 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.064386 s, Result = 299f0000, Performance =  16.68 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.065531 s, Result = 29a68000, Performance =  16.71 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.066891 s, Result = 29ae0000, Performance =  16.69 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.068171 s, Result = 29b58000, Performance =  16.70 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.069329 s, Result = 29bd0000, Performance =  16.73 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.070891 s, Result = 29c48000, Performance =  16.66 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.072304 s, Result = 29cc0000, Performance =  16.63 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.074613 s, Result = 29d38000, Performance =  16.41 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.077058 s, Result = 29db0000, Performance =  16.16 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.077799 s, Result = 29e28000, Performance =  16.29 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.078557 s, Result = 29ea0000, Performance =  16.40 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.080353 s, Result = 29f18000, Performance =  16.30 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.080439 s, Result = 29f90000, Performance =  16.55 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.077946 s, Result = 2a008000, Performance =  17.36 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.100726 s, Result = 2a080000, Performance =  13.64 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   666   654   384
Test passed: M N K =   498  2038  1728
Test passed: M N K =   832  1125  1984
Test passed: M N K =  1606  1036    64
Test passed: M N K =    10  1047   832
M N K =  2048  2048   256, Elapsed time =   0.000907 s, Result = 00078000, Performance =  23.67 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001903 s, Result = 000f0000, Performance =  22.57 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003207 s, Result = 00168000, Performance =  20.09 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.004358 s, Result = 001e0000, Performance =  19.71 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003708 s, Result = 00258000, Performance =  28.96 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003931 s, Result = 002d0000, Performance =  32.77 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004211 s, Result = 00348000, Performance =  35.70 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005927 s, Result = 003c0000, Performance =  28.99 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.006034 s, Result = 00438000, Performance =  32.03 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006178 s, Result = 004b0000, Performance =  34.76 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.006903 s, Result = 00528000, Performance =  34.22 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007951 s, Result = 005a0000, Performance =  32.41 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008760 s, Result = 00618000, Performance =  31.87 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.010596 s, Result = 00690000, Performance =  28.37 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.011347 s, Result = 00708000, Performance =  28.39 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.012188 s, Result = 00780000, Performance =  28.19 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.012031 s, Result = 007f8000, Performance =  30.34 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012970 s, Result = 00870000, Performance =  29.80 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.014362 s, Result = 008e8000, Performance =  28.41 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.015689 s, Result = 00960000, Performance =  27.38 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.016952 s, Result = 009d8000, Performance =  26.60 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.018006 s, Result = 00a50000, Performance =  26.24 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.019752 s, Result = 00ac8000, Performance =  25.01 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.021343 s, Result = 00b40000, Performance =  24.15 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023351 s, Result = 00bb8000, Performance =  22.99 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.026002 s, Result = 00c30000, Performance =  21.47 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027235 s, Result = 00ca8000, Performance =  21.29 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.028488 s, Result = 00d20000, Performance =  21.11 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.030609 s, Result = 00d98000, Performance =  20.35 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032512 s, Result = 00e10000, Performance =  19.82 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.033798 s, Result = 00e88000, Performance =  19.70 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.034390 s, Result = 00f00000, Performance =  19.98 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.034673 s, Result = 00f78000, Performance =  20.44 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036933 s, Result = 00ff0000, Performance =  19.77 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.038512 s, Result = 01068000, Performance =  19.52 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.040424 s, Result = 010e0000, Performance =  19.12 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.042078 s, Result = 01158000, Performance =  18.88 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.043124 s, Result = 011d0000, Performance =  18.92 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.044067 s, Result = 01248000, Performance =  19.01 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.045322 s, Result = 012c0000, Performance =  18.95 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.046700 s, Result = 01338000, Performance =  18.85 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.048480 s, Result = 013b0000, Performance =  18.60 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.048197 s, Result = 01428000, Performance =  19.16 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.050561 s, Result = 014a0000, Performance =  18.69 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.052153 s, Result = 01518000, Performance =  18.53 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.053080 s, Result = 01590000, Performance =  18.61 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.054355 s, Result = 01608000, Performance =  18.57 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.056119 s, Result = 01680000, Performance =  18.37 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.056920 s, Result = 016f8000, Performance =  18.49 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.058378 s, Result = 01770000, Performance =  18.39 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.059767 s, Result = 017e8000, Performance =  18.32 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.061434 s, Result = 01860000, Performance =  18.18 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.062460 s, Result = 018d8000, Performance =  18.22 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.063835 s, Result = 01950000, Performance =  18.17 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.066943 s, Result = 019c8000, Performance =  17.64 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.069700 s, Result = 01a40000, Performance =  17.25 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.072277 s, Result = 01ab8000, Performance =  16.94 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.071918 s, Result = 01b30000, Performance =  17.32 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.072426 s, Result = 01ba8000, Performance =  17.49 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.073492 s, Result = 01c20000, Performance =  17.53 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.074961 s, Result = 01c98000, Performance =  17.48 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.075322 s, Result = 01d10000, Performance =  17.68 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.072379 s, Result = 01d88000, Performance =  18.69 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.093478 s, Result = 01e00000, Performance =  14.70 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   218   889   576
Test passed: M N K =   192    23  1728
Test passed: M N K =   731    48  1856
Test passed: M N K =   763   826  1664
Test passed: M N K =   880  1543  1024
M N K =  2048  2048   256, Elapsed time =   0.008567 s, Result = 640b8000, Performance =   2.51 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006193 s, Result = c4130000, Performance =   6.94 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008430 s, Result = 241a8000, Performance =   7.64 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009415 s, Result = 84220000, Performance =   9.12 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.011102 s, Result = e4298000, Performance =   9.67 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011867 s, Result = 44310000, Performance =  10.86 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012099 s, Result = a4388000, Performance =  12.42 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013710 s, Result = 04400000, Performance =  12.53 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014286 s, Result = 64478000, Performance =  13.53 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014261 s, Result = c44f0000, Performance =  15.06 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.017940 s, Result = 24568000, Performance =  13.17 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.018267 s, Result = 845e0000, Performance =  14.11 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019595 s, Result = e4658000, Performance =  14.25 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020725 s, Result = 446d0000, Performance =  14.51 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022392 s, Result = a4748000, Performance =  14.39 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021991 s, Result = 047c0000, Performance =  15.62 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.025064 s, Result = 64838000, Performance =  14.57 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.026663 s, Result = c48b0000, Performance =  14.50 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.028779 s, Result = 24928000, Performance =  14.18 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.030253 s, Result = 849a0000, Performance =  14.20 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.031628 s, Result = e4a18000, Performance =  14.26 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.033323 s, Result = 44a90000, Performance =  14.18 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.034796 s, Result = a4b08000, Performance =  14.19 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.036539 s, Result = 04b80000, Performance =  14.11 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.037992 s, Result = 64bf8000, Performance =  14.13 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.039066 s, Result = c4c70000, Performance =  14.29 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.040590 s, Result = 24ce8000, Performance =  14.28 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.042539 s, Result = 84d60000, Performance =  14.14 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.043542 s, Result = e4dd8000, Performance =  14.30 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.044906 s, Result = 44e50000, Performance =  14.35 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.046546 s, Result = a4ec8000, Performance =  14.30 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.049498 s, Result = 04f40000, Performance =  13.88 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.048798 s, Result = 64fb8000, Performance =  14.52 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.049039 s, Result = c5030000, Performance =  14.89 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.051154 s, Result = 250a8000, Performance =  14.69 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.053323 s, Result = 85120000, Performance =  14.50 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.057302 s, Result = e5198000, Performance =  13.87 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.059655 s, Result = 45210000, Performance =  13.68 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.061317 s, Result = a5288000, Performance =  13.66 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.062264 s, Result = 05300000, Performance =  13.80 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.063255 s, Result = 65378000, Performance =  13.92 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.063169 s, Result = c53f0000, Performance =  14.28 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.064329 s, Result = 25468000, Performance =  14.35 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.065589 s, Result = 854e0000, Performance =  14.41 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.066755 s, Result = e5558000, Performance =  14.48 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.068222 s, Result = 455d0000, Performance =  14.48 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.069200 s, Result = a5648000, Performance =  14.59 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.070146 s, Result = 056c0000, Performance =  14.69 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.071186 s, Result = 65738000, Performance =  14.78 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.072087 s, Result = c57b0000, Performance =  14.90 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.073335 s, Result = 25828000, Performance =  14.93 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.073799 s, Result = 858a0000, Performance =  15.13 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.075193 s, Result = e5918000, Performance =  15.14 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.075794 s, Result = 45990000, Performance =  15.30 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.076052 s, Result = a5a08000, Performance =  15.53 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.076534 s, Result = 05a80000, Performance =  15.71 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.077570 s, Result = 65af8000, Performance =  15.78 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.079023 s, Result = c5b70000, Performance =  15.76 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.079327 s, Result = 25be8000, Performance =  15.97 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.081046 s, Result = 85c60000, Performance =  15.90 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.082333 s, Result = e5cd8000, Performance =  15.91 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.079901 s, Result = 45d50000, Performance =  16.66 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.082451 s, Result = a5dc8000, Performance =  16.41 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.112979 s, Result = 05e40000, Performance =  12.17 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   805  1299   512
Test passed: M N K =   721   424   896
Test passed: M N K =   609   939  2048
Test passed: M N K =   155   610  1152
Test passed: M N K =  1792   340   192
M N K =  2048  2048   256, Elapsed time =   0.008452 s, Result = 00078000, Performance =   2.54 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004361 s, Result = 000f0000, Performance =   9.85 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004641 s, Result = 00168000, Performance =  13.88 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.006355 s, Result = 001e0000, Performance =  13.52 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006857 s, Result = 00258000, Performance =  15.66 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.008283 s, Result = 002d0000, Performance =  15.56 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008833 s, Result = 00348000, Performance =  17.02 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009664 s, Result = 003c0000, Performance =  17.78 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011326 s, Result = 00438000, Performance =  17.06 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.012482 s, Result = 004b0000, Performance =  17.20 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012806 s, Result = 00528000, Performance =  18.45 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014915 s, Result = 005a0000, Performance =  17.28 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015694 s, Result = 00618000, Performance =  17.79 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016677 s, Result = 00690000, Performance =  18.03 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017730 s, Result = 00708000, Performance =  18.17 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.019838 s, Result = 00780000, Performance =  17.32 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019906 s, Result = 007f8000, Performance =  18.34 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.021817 s, Result = 00870000, Performance =  17.72 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.022740 s, Result = 008e8000, Performance =  17.94 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.024041 s, Result = 00960000, Performance =  17.87 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.025372 s, Result = 009d8000, Performance =  17.77 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.028022 s, Result = 00a50000, Performance =  16.86 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.029674 s, Result = 00ac8000, Performance =  16.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030973 s, Result = 00b40000, Performance =  16.64 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032002 s, Result = 00bb8000, Performance =  16.78 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.033802 s, Result = 00c30000, Performance =  16.52 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.034963 s, Result = 00ca8000, Performance =  16.58 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036877 s, Result = 00d20000, Performance =  16.31 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037942 s, Result = 00d98000, Performance =  16.41 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.039448 s, Result = 00e10000, Performance =  16.33 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040834 s, Result = 00e88000, Performance =  16.30 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.043156 s, Result = 00f00000, Performance =  15.92 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.042368 s, Result = 00f78000, Performance =  16.73 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.042393 s, Result = 00ff0000, Performance =  17.22 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.044518 s, Result = 01068000, Performance =  16.88 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.045805 s, Result = 010e0000, Performance =  16.88 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.047367 s, Result = 01158000, Performance =  16.77 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.048660 s, Result = 011d0000, Performance =  16.77 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.050097 s, Result = 01248000, Performance =  16.72 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.051362 s, Result = 012c0000, Performance =  16.72 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.052236 s, Result = 01338000, Performance =  16.86 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.052831 s, Result = 013b0000, Performance =  17.07 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.054295 s, Result = 01428000, Performance =  17.01 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.055648 s, Result = 014a0000, Performance =  16.98 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.056594 s, Result = 01518000, Performance =  17.08 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.057325 s, Result = 01590000, Performance =  17.23 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.058914 s, Result = 01608000, Performance =  17.13 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.060229 s, Result = 01680000, Performance =  17.11 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.061471 s, Result = 016f8000, Performance =  17.12 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.062084 s, Result = 01770000, Performance =  17.29 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.063951 s, Result = 017e8000, Performance =  17.13 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.065056 s, Result = 01860000, Performance =  17.17 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.066810 s, Result = 018d8000, Performance =  17.04 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.069254 s, Result = 01950000, Performance =  16.74 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.069872 s, Result = 019c8000, Performance =  16.90 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.070815 s, Result = 01a40000, Performance =  16.98 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.071731 s, Result = 01ab8000, Performance =  17.06 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.072252 s, Result = 01b30000, Performance =  17.24 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.072931 s, Result = 01ba8000, Performance =  17.37 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.074103 s, Result = 01c20000, Performance =  17.39 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.075783 s, Result = 01c98000, Performance =  17.29 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.072980 s, Result = 01d10000, Performance =  18.24 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.076144 s, Result = 01d88000, Performance =  17.77 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.105546 s, Result = 01e00000, Performance =  13.02 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   233  1176   768
Test passed: M N K =   978   954  1920
Test passed: M N K =  1321  1407  1472
Test passed: M N K =  1416  1791  1984
Test passed: M N K =  1498   899   320
M N K =  2048  2048   256, Elapsed time =   0.008683 s, Result = 282f8000, Performance =   2.47 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007398 s, Result = 28370000, Performance =   5.81 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009117 s, Result = 283e8000, Performance =   7.07 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008803 s, Result = 28460000, Performance =   9.76 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010063 s, Result = 284d8000, Performance =  10.67 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009965 s, Result = 28550000, Performance =  12.93 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010671 s, Result = 285c8000, Performance =  14.09 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012845 s, Result = 28640000, Performance =  13.37 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013231 s, Result = 286b8000, Performance =  14.61 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013232 s, Result = 28730000, Performance =  16.23 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014759 s, Result = 287a8000, Performance =  16.01 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014620 s, Result = 28820000, Performance =  17.63 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015768 s, Result = 28898000, Performance =  17.70 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016627 s, Result = 28910000, Performance =  18.08 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018152 s, Result = 28988000, Performance =  17.75 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018990 s, Result = 28a00000, Performance =  18.09 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.019749 s, Result = 28a78000, Performance =  18.49 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019662 s, Result = 28af0000, Performance =  19.66 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021060 s, Result = 28b68000, Performance =  19.37 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022120 s, Result = 28be0000, Performance =  19.42 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.023574 s, Result = 28c58000, Performance =  19.13 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025747 s, Result = 28cd0000, Performance =  18.35 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027020 s, Result = 28d48000, Performance =  18.28 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.028028 s, Result = 28dc0000, Performance =  18.39 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029773 s, Result = 28e38000, Performance =  18.03 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.030482 s, Result = 28eb0000, Performance =  18.32 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031834 s, Result = 28f28000, Performance =  18.21 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.033570 s, Result = 28fa0000, Performance =  17.91 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.034691 s, Result = 29018000, Performance =  17.95 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.035836 s, Result = 29090000, Performance =  17.98 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.038020 s, Result = 29108000, Performance =  17.51 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039660 s, Result = 29180000, Performance =  17.33 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039140 s, Result = 291f8000, Performance =  18.11 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.039021 s, Result = 29270000, Performance =  18.71 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.041281 s, Result = 292e8000, Performance =  18.21 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.042572 s, Result = 29360000, Performance =  18.16 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.043820 s, Result = 293d8000, Performance =  18.13 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.045459 s, Result = 29450000, Performance =  17.95 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.047116 s, Result = 294c8000, Performance =  17.78 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.047997 s, Result = 29540000, Performance =  17.90 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.048743 s, Result = 295b8000, Performance =  18.06 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.049278 s, Result = 29630000, Performance =  18.30 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.050594 s, Result = 296a8000, Performance =  18.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.052285 s, Result = 29720000, Performance =  18.07 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.053866 s, Result = 29798000, Performance =  17.94 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.055249 s, Result = 29810000, Performance =  17.88 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.056320 s, Result = 29888000, Performance =  17.92 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.057608 s, Result = 29900000, Performance =  17.89 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.058759 s, Result = 29978000, Performance =  17.91 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.059931 s, Result = 299f0000, Performance =  17.92 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.061772 s, Result = 29a68000, Performance =  17.73 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.063028 s, Result = 29ae0000, Performance =  17.72 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.064843 s, Result = 29b58000, Performance =  17.55 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.066207 s, Result = 29bd0000, Performance =  17.52 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.068853 s, Result = 29c48000, Performance =  17.15 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.069152 s, Result = 29cc0000, Performance =  17.39 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.070141 s, Result = 29d38000, Performance =  17.45 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.071277 s, Result = 29db0000, Performance =  17.47 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.071677 s, Result = 29e28000, Performance =  17.68 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.073919 s, Result = 29ea0000, Performance =  17.43 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.081694 s, Result = 29f18000, Performance =  16.03 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.072440 s, Result = 29f90000, Performance =  18.38 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.074510 s, Result = 2a008000, Performance =  18.16 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.105092 s, Result = 2a080000, Performance =  13.08 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   996  1956  1344
Test passed: M N K =  1211   859  1792
Test passed: M N K =  1751  1088   512
Test passed: M N K =  2013   310  1280
Test passed: M N K =   224  1763   256
M N K =  2048  2048   256, Elapsed time =   0.000912 s, Result = 00078000, Performance =  23.54 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001780 s, Result = 000f0000, Performance =  24.13 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002988 s, Result = 00168000, Performance =  21.56 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003266 s, Result = 001e0000, Performance =  26.30 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002890 s, Result = 00258000, Performance =  37.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.004379 s, Result = 002d0000, Performance =  29.42 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.004783 s, Result = 00348000, Performance =  31.43 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.005639 s, Result = 003c0000, Performance =  30.47 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005303 s, Result = 00438000, Performance =  36.44 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.005888 s, Result = 004b0000, Performance =  36.47 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007297 s, Result = 00528000, Performance =  32.37 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007197 s, Result = 005a0000, Performance =  35.80 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.008125 s, Result = 00618000, Performance =  34.36 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009088 s, Result = 00690000, Performance =  33.08 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.010500 s, Result = 00708000, Performance =  30.68 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010804 s, Result = 00780000, Performance =  31.80 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011563 s, Result = 007f8000, Performance =  31.57 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012146 s, Result = 00870000, Performance =  31.83 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013005 s, Result = 008e8000, Performance =  31.37 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.014111 s, Result = 00960000, Performance =  30.44 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015465 s, Result = 009d8000, Performance =  29.16 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.016676 s, Result = 00a50000, Performance =  28.33 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.018215 s, Result = 00ac8000, Performance =  27.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.019339 s, Result = 00b40000, Performance =  26.65 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.020644 s, Result = 00bb8000, Performance =  26.01 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.022277 s, Result = 00c30000, Performance =  25.06 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.024641 s, Result = 00ca8000, Performance =  23.53 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.026225 s, Result = 00d20000, Performance =  22.93 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.027377 s, Result = 00d98000, Performance =  22.75 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.027864 s, Result = 00e10000, Performance =  23.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.030112 s, Result = 00e88000, Performance =  22.11 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.032192 s, Result = 00f00000, Performance =  21.35 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.031646 s, Result = 00f78000, Performance =  22.39 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032175 s, Result = 00ff0000, Performance =  22.69 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.033652 s, Result = 01068000, Performance =  22.33 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035161 s, Result = 010e0000, Performance =  21.99 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.037176 s, Result = 01158000, Performance =  21.37 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.038122 s, Result = 011d0000, Performance =  21.41 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.039852 s, Result = 01248000, Performance =  21.02 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040639 s, Result = 012c0000, Performance =  21.14 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041648 s, Result = 01338000, Performance =  21.14 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042798 s, Result = 013b0000, Performance =  21.07 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.044865 s, Result = 01428000, Performance =  20.58 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045560 s, Result = 014a0000, Performance =  20.74 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.047015 s, Result = 01518000, Performance =  20.55 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.048055 s, Result = 01590000, Performance =  20.56 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.049949 s, Result = 01608000, Performance =  20.21 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.050345 s, Result = 01680000, Performance =  20.47 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.051789 s, Result = 016f8000, Performance =  20.32 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.052996 s, Result = 01770000, Performance =  20.26 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.055813 s, Result = 017e8000, Performance =  19.62 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.057041 s, Result = 01860000, Performance =  19.58 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.056753 s, Result = 018d8000, Performance =  20.05 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.057697 s, Result = 01950000, Performance =  20.10 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.061698 s, Result = 019c8000, Performance =  19.14 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.063997 s, Result = 01a40000, Performance =  18.79 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.065228 s, Result = 01ab8000, Performance =  18.77 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.066150 s, Result = 01b30000, Performance =  18.83 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.066542 s, Result = 01ba8000, Performance =  19.04 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.068037 s, Result = 01c20000, Performance =  18.94 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.068619 s, Result = 01c98000, Performance =  19.09 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.066904 s, Result = 01d10000, Performance =  19.90 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.068479 s, Result = 01d88000, Performance =  19.76 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.099653 s, Result = 01e00000, Performance =  13.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1574   936  1536
Test passed: M N K =   424  1308  1856
Test passed: M N K =  1794   178  1152
Test passed: M N K =    27   303  1664
Test passed: M N K =  1733  2001  1152
M N K =  2048  2048   256, Elapsed time =   0.007714 s, Result = 640b8000, Performance =   2.78 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006266 s, Result = c4130000, Performance =   6.85 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007421 s, Result = 241a8000, Performance =   8.68 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009443 s, Result = 84220000, Performance =   9.10 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009642 s, Result = e4298000, Performance =  11.14 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.011193 s, Result = 44310000, Performance =  11.51 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.012314 s, Result = a4388000, Performance =  12.21 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.014008 s, Result = 04400000, Performance =  12.26 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.014166 s, Result = 64478000, Performance =  13.64 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015764 s, Result = c44f0000, Performance =  13.62 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.016085 s, Result = 24568000, Performance =  14.69 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.017151 s, Result = 845e0000, Performance =  15.03 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019290 s, Result = e4658000, Performance =  14.47 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.020175 s, Result = 446d0000, Performance =  14.90 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.021453 s, Result = a4748000, Performance =  15.02 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022441 s, Result = 047c0000, Performance =  15.31 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.024628 s, Result = 64838000, Performance =  14.82 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025684 s, Result = c48b0000, Performance =  15.05 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.027586 s, Result = 24928000, Performance =  14.79 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028833 s, Result = 849a0000, Performance =  14.90 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.029502 s, Result = e4a18000, Performance =  15.29 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.031906 s, Result = 44a90000, Performance =  14.81 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.033300 s, Result = a4b08000, Performance =  14.83 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033788 s, Result = 04b80000, Performance =  15.25 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.036057 s, Result = 64bf8000, Performance =  14.89 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.037323 s, Result = c4c70000, Performance =  14.96 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.038650 s, Result = 24ce8000, Performance =  15.00 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.039774 s, Result = 84d60000, Performance =  15.12 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.041605 s, Result = e4dd8000, Performance =  14.97 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.042964 s, Result = 44e50000, Performance =  15.00 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.044303 s, Result = a4ec8000, Performance =  15.03 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.046678 s, Result = 04f40000, Performance =  14.72 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.046660 s, Result = 64fb8000, Performance =  15.19 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.048695 s, Result = c5030000, Performance =  14.99 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.049861 s, Result = 250a8000, Performance =  15.07 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.049923 s, Result = 85120000, Performance =  15.49 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.051421 s, Result = e5198000, Performance =  15.45 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.053395 s, Result = 45210000, Performance =  15.28 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.055598 s, Result = a5288000, Performance =  15.06 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.056614 s, Result = 05300000, Performance =  15.17 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.059443 s, Result = 65378000, Performance =  14.81 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.059471 s, Result = c53f0000, Performance =  15.17 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.060012 s, Result = 25468000, Performance =  15.39 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.059871 s, Result = 854e0000, Performance =  15.78 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.063162 s, Result = e5558000, Performance =  15.30 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.064638 s, Result = 455d0000, Performance =  15.28 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.066309 s, Result = a5648000, Performance =  15.22 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.065812 s, Result = 056c0000, Performance =  15.66 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.067356 s, Result = 65738000, Performance =  15.62 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.068139 s, Result = c57b0000, Performance =  15.76 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.069176 s, Result = 25828000, Performance =  15.83 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.069246 s, Result = 858a0000, Performance =  16.13 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.077726 s, Result = e5918000, Performance =  14.64 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.071450 s, Result = 45990000, Performance =  16.23 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.072593 s, Result = a5a08000, Performance =  16.27 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.072670 s, Result = 05a80000, Performance =  16.55 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.073900 s, Result = 65af8000, Performance =  16.56 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.075373 s, Result = c5b70000, Performance =  16.52 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.077468 s, Result = 25be8000, Performance =  16.36 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.074302 s, Result = 85c60000, Performance =  17.34 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.077492 s, Result = e5cd8000, Performance =  16.90 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.078088 s, Result = 45d50000, Performance =  17.05 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.076339 s, Result = a5dc8000, Performance =  17.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.097271 s, Result = 05e40000, Performance =  14.13 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    56   364   192
Test passed: M N K =   652  1679  1792
Test passed: M N K =  1733   573  1856
Test passed: M N K =   518  1746   192
Test passed: M N K =  1331  1316  1280
M N K =  2048  2048   256, Elapsed time =   0.006910 s, Result = 00078000, Performance =   3.11 TOPS
M N K =  2048  2048   512, Elapsed time =   0.004509 s, Result = 000f0000, Performance =   9.52 TOPS
M N K =  2048  2048   768, Elapsed time =   0.004429 s, Result = 00168000, Performance =  14.55 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005698 s, Result = 001e0000, Performance =  15.08 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.007201 s, Result = 00258000, Performance =  14.91 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.007161 s, Result = 002d0000, Performance =  17.99 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.008336 s, Result = 00348000, Performance =  18.03 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.009377 s, Result = 003c0000, Performance =  18.32 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011362 s, Result = 00438000, Performance =  17.01 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011040 s, Result = 004b0000, Performance =  19.45 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.013098 s, Result = 00528000, Performance =  18.04 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014657 s, Result = 005a0000, Performance =  17.58 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.015529 s, Result = 00618000, Performance =  17.98 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.016805 s, Result = 00690000, Performance =  17.89 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.017107 s, Result = 00708000, Performance =  18.83 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018320 s, Result = 00780000, Performance =  18.76 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.020563 s, Result = 007f8000, Performance =  17.75 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020463 s, Result = 00870000, Performance =  18.89 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021337 s, Result = 008e8000, Performance =  19.12 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.023084 s, Result = 00960000, Performance =  18.61 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024515 s, Result = 009d8000, Performance =  18.40 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.026184 s, Result = 00a50000, Performance =  18.04 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.028153 s, Result = 00ac8000, Performance =  17.54 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.029101 s, Result = 00b40000, Performance =  17.71 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030585 s, Result = 00bb8000, Performance =  17.55 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031904 s, Result = 00c30000, Performance =  17.50 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.032838 s, Result = 00ca8000, Performance =  17.66 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.033971 s, Result = 00d20000, Performance =  17.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.035663 s, Result = 00d98000, Performance =  17.46 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.036891 s, Result = 00e10000, Performance =  17.46 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.038018 s, Result = 00e88000, Performance =  17.51 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.040072 s, Result = 00f00000, Performance =  17.15 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.040396 s, Result = 00f78000, Performance =  17.54 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.041154 s, Result = 00ff0000, Performance =  17.74 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.042625 s, Result = 01068000, Performance =  17.63 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.043198 s, Result = 010e0000, Performance =  17.90 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.044952 s, Result = 01158000, Performance =  17.68 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.046784 s, Result = 011d0000, Performance =  17.44 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.051007 s, Result = 01248000, Performance =  16.42 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.050903 s, Result = 012c0000, Performance =  16.88 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.053777 s, Result = 01338000, Performance =  16.37 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.054606 s, Result = 013b0000, Performance =  16.52 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.054988 s, Result = 01428000, Performance =  16.79 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.054993 s, Result = 014a0000, Performance =  17.18 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.057353 s, Result = 01518000, Performance =  16.85 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.058067 s, Result = 01590000, Performance =  17.01 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.059171 s, Result = 01608000, Performance =  17.06 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.059254 s, Result = 01680000, Performance =  17.40 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.061112 s, Result = 016f8000, Performance =  17.22 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.061829 s, Result = 01770000, Performance =  17.37 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.063766 s, Result = 017e8000, Performance =  17.18 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.063605 s, Result = 01860000, Performance =  17.56 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.065398 s, Result = 018d8000, Performance =  17.40 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.066581 s, Result = 01950000, Performance =  17.42 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.067654 s, Result = 019c8000, Performance =  17.46 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.067468 s, Result = 01a40000, Performance =  17.82 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.068859 s, Result = 01ab8000, Performance =  17.78 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.070309 s, Result = 01b30000, Performance =  17.72 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.071632 s, Result = 01ba8000, Performance =  17.69 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.068904 s, Result = 01c20000, Performance =  18.70 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.072343 s, Result = 01c98000, Performance =  18.11 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.072735 s, Result = 01d10000, Performance =  18.31 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.070591 s, Result = 01d88000, Performance =  19.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.090239 s, Result = 01e00000, Performance =  15.23 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    13  1318  1792
Test passed: M N K =   971  1167  1600
Test passed: M N K =   511   638   960
Test passed: M N K =  1350  1861  1856
Test passed: M N K =  1599  1164  2048
M N K =  2048  2048   256, Elapsed time =   0.009261 s, Result = 282f8000, Performance =   2.32 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008336 s, Result = 28370000, Performance =   5.15 TOPS
M N K =  2048  2048   768, Elapsed time =   0.009038 s, Result = 283e8000, Performance =   7.13 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.009485 s, Result = 28460000, Performance =   9.06 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.009484 s, Result = 284d8000, Performance =  11.32 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.010761 s, Result = 28550000, Performance =  11.97 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011918 s, Result = 285c8000, Performance =  12.61 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012749 s, Result = 28640000, Performance =  13.48 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012481 s, Result = 286b8000, Performance =  15.49 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013671 s, Result = 28730000, Performance =  15.71 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014188 s, Result = 287a8000, Performance =  16.65 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015654 s, Result = 28820000, Performance =  16.46 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.016081 s, Result = 28898000, Performance =  17.36 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017050 s, Result = 28910000, Performance =  17.63 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.018028 s, Result = 28988000, Performance =  17.87 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.017544 s, Result = 28a00000, Performance =  19.59 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018688 s, Result = 28a78000, Performance =  19.53 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.019254 s, Result = 28af0000, Performance =  20.08 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020433 s, Result = 28b68000, Performance =  19.97 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021328 s, Result = 28be0000, Performance =  20.14 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022492 s, Result = 28c58000, Performance =  20.05 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023656 s, Result = 28cd0000, Performance =  19.97 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025839 s, Result = 28d48000, Performance =  19.12 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.027129 s, Result = 28dc0000, Performance =  19.00 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.027916 s, Result = 28e38000, Performance =  19.23 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.029727 s, Result = 28eb0000, Performance =  18.78 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.030792 s, Result = 28f28000, Performance =  18.83 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.031488 s, Result = 28fa0000, Performance =  19.10 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033710 s, Result = 29018000, Performance =  18.47 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034557 s, Result = 29090000, Performance =  18.64 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035735 s, Result = 29108000, Performance =  18.63 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.040396 s, Result = 29180000, Performance =  17.01 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.041995 s, Result = 291f8000, Performance =  16.88 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043581 s, Result = 29270000, Performance =  16.75 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.044454 s, Result = 292e8000, Performance =  16.91 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.045014 s, Result = 29360000, Performance =  17.17 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.048224 s, Result = 293d8000, Performance =  16.48 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.048969 s, Result = 29450000, Performance =  16.66 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.049769 s, Result = 294c8000, Performance =  16.83 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.050909 s, Result = 29540000, Performance =  16.87 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.052610 s, Result = 295b8000, Performance =  16.74 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.054504 s, Result = 29630000, Performance =  16.55 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.055564 s, Result = 296a8000, Performance =  16.62 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.054343 s, Result = 29720000, Performance =  17.39 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.056271 s, Result = 29798000, Performance =  17.17 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.056880 s, Result = 29810000, Performance =  17.37 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.058136 s, Result = 29888000, Performance =  17.36 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.058328 s, Result = 29900000, Performance =  17.67 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.060234 s, Result = 29978000, Performance =  17.47 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.061234 s, Result = 299f0000, Performance =  17.54 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.063317 s, Result = 29a68000, Performance =  17.30 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.063671 s, Result = 29ae0000, Performance =  17.54 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.065186 s, Result = 29b58000, Performance =  17.46 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.065931 s, Result = 29bd0000, Performance =  17.59 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.067014 s, Result = 29c48000, Performance =  17.62 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.067263 s, Result = 29cc0000, Performance =  17.88 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.068118 s, Result = 29d38000, Performance =  17.97 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.069288 s, Result = 29db0000, Performance =  17.98 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.070950 s, Result = 29e28000, Performance =  17.86 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.068643 s, Result = 29ea0000, Performance =  18.77 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.070950 s, Result = 29f18000, Performance =  18.46 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.071663 s, Result = 29f90000, Performance =  18.58 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.070432 s, Result = 2a008000, Performance =  19.21 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.089905 s, Result = 2a080000, Performance =  15.29 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1622  1413   448
Test passed: M N K =   700  1892  2048
Test passed: M N K =   807  1963  1408
Test passed: M N K =  1858  1355  1216
Test passed: M N K =   937   140   128
M N K =  2048  2048   256, Elapsed time =   0.000918 s, Result = 00078000, Performance =  23.40 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001802 s, Result = 000f0000, Performance =  23.83 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002948 s, Result = 00168000, Performance =  21.85 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003682 s, Result = 001e0000, Performance =  23.33 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002924 s, Result = 00258000, Performance =  36.72 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003470 s, Result = 002d0000, Performance =  37.13 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.005744 s, Result = 00348000, Performance =  26.17 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.004674 s, Result = 003c0000, Performance =  36.75 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.005207 s, Result = 00438000, Performance =  37.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.006267 s, Result = 004b0000, Performance =  34.27 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.007023 s, Result = 00528000, Performance =  33.64 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.007435 s, Result = 005a0000, Performance =  34.66 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.007987 s, Result = 00618000, Performance =  34.95 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.009539 s, Result = 00690000, Performance =  31.52 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.009912 s, Result = 00708000, Performance =  32.50 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.010859 s, Result = 00780000, Performance =  31.64 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.011370 s, Result = 007f8000, Performance =  32.11 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.012291 s, Result = 00870000, Performance =  31.45 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.013340 s, Result = 008e8000, Performance =  30.59 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.013939 s, Result = 00960000, Performance =  30.81 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.015074 s, Result = 009d8000, Performance =  29.92 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.015705 s, Result = 00a50000, Performance =  30.08 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.016777 s, Result = 00ac8000, Performance =  29.44 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.017632 s, Result = 00b40000, Performance =  29.23 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.019049 s, Result = 00bb8000, Performance =  28.18 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.020642 s, Result = 00c30000, Performance =  27.05 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.022183 s, Result = 00ca8000, Performance =  26.14 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023856 s, Result = 00d20000, Performance =  25.21 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.025701 s, Result = 00d98000, Performance =  24.23 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.026706 s, Result = 00e10000, Performance =  24.12 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.028589 s, Result = 00e88000, Performance =  23.29 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.029498 s, Result = 00f00000, Performance =  23.30 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.030637 s, Result = 00f78000, Performance =  23.13 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032274 s, Result = 00ff0000, Performance =  22.62 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.033059 s, Result = 01068000, Performance =  22.74 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.033517 s, Result = 010e0000, Performance =  23.07 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.034863 s, Result = 01158000, Performance =  22.79 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.036323 s, Result = 011d0000, Performance =  22.47 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040360 s, Result = 01248000, Performance =  20.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.044365 s, Result = 012c0000, Performance =  19.36 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.045081 s, Result = 01338000, Performance =  19.53 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.045841 s, Result = 013b0000, Performance =  19.68 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.047043 s, Result = 01428000, Performance =  19.63 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.046966 s, Result = 014a0000, Performance =  20.12 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.050319 s, Result = 01518000, Performance =  19.20 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.051245 s, Result = 01590000, Performance =  19.28 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.051924 s, Result = 01608000, Performance =  19.44 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.052154 s, Result = 01680000, Performance =  19.76 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.053700 s, Result = 016f8000, Performance =  19.60 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.054783 s, Result = 01770000, Performance =  19.60 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.056236 s, Result = 017e8000, Performance =  19.48 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.056402 s, Result = 01860000, Performance =  19.80 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.057936 s, Result = 018d8000, Performance =  19.65 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.058665 s, Result = 01950000, Performance =  19.77 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.060672 s, Result = 019c8000, Performance =  19.47 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.060633 s, Result = 01a40000, Performance =  19.83 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.062653 s, Result = 01ab8000, Performance =  19.54 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.063659 s, Result = 01b30000, Performance =  19.57 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.064917 s, Result = 01ba8000, Performance =  19.52 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.063193 s, Result = 01c20000, Performance =  20.39 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.065616 s, Result = 01c98000, Performance =  19.96 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.066032 s, Result = 01d10000, Performance =  20.16 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.065288 s, Result = 01d88000, Performance =  20.72 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.083301 s, Result = 01e00000, Performance =  16.50 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1169   109   640
Test passed: M N K =  1272  1525  1984
Test passed: M N K =   741  1356  1600
Test passed: M N K =  1347   888  1728
Test passed: M N K =   884   278  1856
M N K =  2048  2048   256, Elapsed time =   0.008535 s, Result = 84090000, Performance =   2.52 TOPS
M N K =  2048  2048   512, Elapsed time =   0.006394 s, Result = 040e0000, Performance =   6.72 TOPS
M N K =  2048  2048   768, Elapsed time =   0.006960 s, Result = 84130000, Performance =   9.26 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008218 s, Result = 04180000, Performance =  10.45 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008997 s, Result = 841d0000, Performance =  11.94 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009526 s, Result = 04220000, Performance =  13.53 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011155 s, Result = 84270000, Performance =  13.48 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.013093 s, Result = 042c0000, Performance =  13.12 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.013225 s, Result = 84310000, Performance =  14.61 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.015764 s, Result = 04360000, Performance =  13.62 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.015818 s, Result = 843b0000, Performance =  14.93 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.016916 s, Result = 04400000, Performance =  15.23 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.019081 s, Result = 84450000, Performance =  14.63 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.019179 s, Result = 044a0000, Performance =  15.68 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.020635 s, Result = 844f0000, Performance =  15.61 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.022862 s, Result = 04540000, Performance =  15.03 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.023255 s, Result = 84590000, Performance =  15.70 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.025942 s, Result = 045e0000, Performance =  14.90 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.027592 s, Result = 84630000, Performance =  14.79 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.028445 s, Result = 04680000, Performance =  15.10 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.029856 s, Result = 846d0000, Performance =  15.10 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.031050 s, Result = 04720000, Performance =  15.22 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.032307 s, Result = 84770000, Performance =  15.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.033518 s, Result = 047c0000, Performance =  15.38 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.034926 s, Result = 84810000, Performance =  15.37 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.036033 s, Result = 04860000, Performance =  15.50 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.037203 s, Result = 848b0000, Performance =  15.59 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.038199 s, Result = 04900000, Performance =  15.74 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.038564 s, Result = 84950000, Performance =  16.15 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.047237 s, Result = 049a0000, Performance =  13.64 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.040943 s, Result = 849f0000, Performance =  16.26 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.042380 s, Result = 04a40000, Performance =  16.22 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.042313 s, Result = 84a90000, Performance =  16.75 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.043720 s, Result = 04ae0000, Performance =  16.70 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.044454 s, Result = 84b30000, Performance =  16.91 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.044456 s, Result = 04b80000, Performance =  17.39 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.046302 s, Result = 84bd0000, Performance =  17.16 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.046640 s, Result = 04c20000, Performance =  17.50 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.047142 s, Result = 84c70000, Performance =  17.77 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.047964 s, Result = 04cc0000, Performance =  17.91 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.048529 s, Result = 84d10000, Performance =  18.14 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.050007 s, Result = 04d60000, Performance =  18.04 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.051925 s, Result = 84db0000, Performance =  17.78 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.052360 s, Result = 04e00000, Performance =  18.05 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.052559 s, Result = 84e50000, Performance =  18.39 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.053262 s, Result = 04ea0000, Performance =  18.55 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.053616 s, Result = 84ef0000, Performance =  18.82 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.054559 s, Result = 04f40000, Performance =  18.89 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.054699 s, Result = 84f90000, Performance =  19.24 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.055290 s, Result = 04fe0000, Performance =  19.42 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.056308 s, Result = 85030000, Performance =  19.45 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.056184 s, Result = 05080000, Performance =  19.88 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.056623 s, Result = 850d0000, Performance =  20.10 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.059121 s, Result = 05120000, Performance =  19.61 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.059780 s, Result = 85170000, Performance =  19.76 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.060008 s, Result = 051c0000, Performance =  20.04 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.060460 s, Result = 85210000, Performance =  20.25 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.060427 s, Result = 05260000, Performance =  20.61 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.060534 s, Result = 852b0000, Performance =  20.93 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.060647 s, Result = 05300000, Performance =  21.25 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.061604 s, Result = 85350000, Performance =  21.26 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.061384 s, Result = 053a0000, Performance =  21.69 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.061258 s, Result = 853f0000, Performance =  22.09 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.076183 s, Result = 05440000, Performance =  18.04 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   117  1842  1152
Test passed: M N K =   497  1760   576
Test passed: M N K =    15   527  1344
Test passed: M N K =   362  1496  1152
Test passed: M N K =  1114  1513  1280
M N K =  2048  2048   256, Elapsed time =   0.007244 s, Result = 00050000, Performance =   2.96 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003994 s, Result = 000a0000, Performance =  10.75 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003769 s, Result = 000f0000, Performance =  17.09 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005225 s, Result = 00140000, Performance =  16.44 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.006391 s, Result = 00190000, Performance =  16.80 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006280 s, Result = 001e0000, Performance =  20.52 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007657 s, Result = 00230000, Performance =  19.63 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008606 s, Result = 00280000, Performance =  19.96 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011065 s, Result = 002d0000, Performance =  17.47 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011423 s, Result = 00320000, Performance =  18.80 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012522 s, Result = 00370000, Performance =  18.86 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.014108 s, Result = 003c0000, Performance =  18.27 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014545 s, Result = 00410000, Performance =  19.19 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015624 s, Result = 00460000, Performance =  19.24 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.016850 s, Result = 004b0000, Performance =  19.12 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018707 s, Result = 00500000, Performance =  18.37 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.018809 s, Result = 00550000, Performance =  19.41 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.020484 s, Result = 005a0000, Performance =  18.87 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.021516 s, Result = 005f0000, Performance =  18.96 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.022600 s, Result = 00640000, Performance =  19.00 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.024662 s, Result = 00690000, Performance =  18.29 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.025687 s, Result = 006e0000, Performance =  18.39 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.027965 s, Result = 00730000, Performance =  17.66 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.030239 s, Result = 00780000, Performance =  17.04 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032756 s, Result = 007d0000, Performance =  16.39 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.034509 s, Result = 00820000, Performance =  16.18 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.035294 s, Result = 00870000, Performance =  16.43 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036003 s, Result = 008c0000, Performance =  16.70 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037555 s, Result = 00910000, Performance =  16.58 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.038299 s, Result = 00960000, Performance =  16.82 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.039257 s, Result = 009b0000, Performance =  16.96 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.039766 s, Result = 00a00000, Performance =  17.28 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.039619 s, Result = 00a50000, Performance =  17.89 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.040475 s, Result = 00aa0000, Performance =  18.04 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.041176 s, Result = 00af0000, Performance =  18.25 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.042094 s, Result = 00b40000, Performance =  18.37 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.042595 s, Result = 00b90000, Performance =  18.65 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.043697 s, Result = 00be0000, Performance =  18.67 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.044459 s, Result = 00c30000, Performance =  18.84 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.046428 s, Result = 00c80000, Performance =  18.50 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.046696 s, Result = 00cd0000, Performance =  18.86 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.047297 s, Result = 00d20000, Performance =  19.07 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.047594 s, Result = 00d70000, Performance =  19.40 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.048922 s, Result = 00dc0000, Performance =  19.31 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.049871 s, Result = 00e10000, Performance =  19.38 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.050349 s, Result = 00e60000, Performance =  19.62 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.050790 s, Result = 00eb0000, Performance =  19.87 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.051936 s, Result = 00f00000, Performance =  19.85 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.052999 s, Result = 00f50000, Performance =  19.85 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.053900 s, Result = 00fa0000, Performance =  19.92 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.055030 s, Result = 00ff0000, Performance =  19.90 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.055424 s, Result = 01040000, Performance =  20.15 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.055682 s, Result = 01090000, Performance =  20.44 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.056404 s, Result = 010e0000, Performance =  20.56 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.056500 s, Result = 01130000, Performance =  20.90 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.056551 s, Result = 01180000, Performance =  21.27 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.056737 s, Result = 011d0000, Performance =  21.57 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.056271 s, Result = 01220000, Performance =  22.13 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.056500 s, Result = 01270000, Performance =  22.43 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.057044 s, Result = 012c0000, Performance =  22.59 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.057815 s, Result = 01310000, Performance =  22.66 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.058255 s, Result = 01360000, Performance =  22.86 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057589 s, Result = 013b0000, Performance =  23.49 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.070766 s, Result = 01400000, Performance =  19.42 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1367   621   640
Test passed: M N K =  1593   917  1536
Test passed: M N K =  1502  1662  1920
Test passed: M N K =  1078  1908  1728
Test passed: M N K =  1805  1318  1664
M N K =  2048  2048   256, Elapsed time =   0.007815 s, Result = 282d0000, Performance =   2.75 TOPS
M N K =  2048  2048   512, Elapsed time =   0.007150 s, Result = 28320000, Performance =   6.01 TOPS
M N K =  2048  2048   768, Elapsed time =   0.008167 s, Result = 28370000, Performance =   7.89 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008466 s, Result = 283c0000, Performance =  10.15 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008354 s, Result = 28410000, Performance =  12.85 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009189 s, Result = 28460000, Performance =  14.02 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.009942 s, Result = 284b0000, Performance =  15.12 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.010702 s, Result = 28500000, Performance =  16.05 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.011139 s, Result = 28550000, Performance =  17.35 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.011433 s, Result = 285a0000, Performance =  18.78 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.012608 s, Result = 285f0000, Performance =  18.74 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013076 s, Result = 28640000, Performance =  19.71 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.014630 s, Result = 28690000, Performance =  19.08 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013602 s, Result = 286e0000, Performance =  22.10 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015097 s, Result = 28730000, Performance =  21.34 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015884 s, Result = 28780000, Performance =  21.63 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016148 s, Result = 287d0000, Performance =  22.61 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017416 s, Result = 28820000, Performance =  22.19 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.018465 s, Result = 28870000, Performance =  22.10 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.018878 s, Result = 288c0000, Performance =  22.75 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.019968 s, Result = 28910000, Performance =  22.58 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.021382 s, Result = 28960000, Performance =  22.10 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.022656 s, Result = 289b0000, Performance =  21.80 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.024081 s, Result = 28a00000, Performance =  21.40 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.024846 s, Result = 28a50000, Performance =  21.61 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.027185 s, Result = 28aa0000, Performance =  20.54 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.027682 s, Result = 28af0000, Performance =  20.95 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.029919 s, Result = 28b40000, Performance =  20.10 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031105 s, Result = 28b90000, Performance =  20.02 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.032262 s, Result = 28be0000, Performance =  19.97 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.036236 s, Result = 28c30000, Performance =  18.37 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.037913 s, Result = 28c80000, Performance =  18.13 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037835 s, Result = 28cd0000, Performance =  18.73 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.038545 s, Result = 28d20000, Performance =  18.94 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.039206 s, Result = 28d70000, Performance =  19.17 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.040027 s, Result = 28dc0000, Performance =  19.31 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.040452 s, Result = 28e10000, Performance =  19.64 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.041283 s, Result = 28e60000, Performance =  19.77 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.042284 s, Result = 28eb0000, Performance =  19.81 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.043172 s, Result = 28f00000, Performance =  19.90 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.044656 s, Result = 28f50000, Performance =  19.72 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.045221 s, Result = 28fa0000, Performance =  19.95 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.045051 s, Result = 28ff0000, Performance =  20.50 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.046459 s, Result = 29040000, Performance =  20.34 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.047443 s, Result = 29090000, Performance =  20.37 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.048010 s, Result = 290e0000, Performance =  20.58 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.048715 s, Result = 29130000, Performance =  20.72 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049946 s, Result = 29180000, Performance =  20.64 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.049874 s, Result = 291d0000, Performance =  21.10 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.050959 s, Result = 29220000, Performance =  21.07 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.052169 s, Result = 29270000, Performance =  20.99 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.052815 s, Result = 292c0000, Performance =  21.14 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.053238 s, Result = 29310000, Performance =  21.38 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.053725 s, Result = 29360000, Performance =  21.58 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.054321 s, Result = 293b0000, Performance =  21.74 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.054456 s, Result = 29400000, Performance =  22.08 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054775 s, Result = 29450000, Performance =  22.35 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.054831 s, Result = 294a0000, Performance =  22.72 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055170 s, Result = 294f0000, Performance =  22.97 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.055450 s, Result = 29540000, Performance =  23.24 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.056626 s, Result = 29590000, Performance =  23.13 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.056620 s, Result = 295e0000, Performance =  23.52 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.055787 s, Result = 29630000, Performance =  24.25 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.070199 s, Result = 29680000, Performance =  19.58 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   499  1789  1728
Test passed: M N K =  1562   712  1984
Test passed: M N K =   378  1704  1920
Test passed: M N K =  1446  1897   576
Test passed: M N K =   678  1337   640
M N K =  2048  2048   256, Elapsed time =   0.000728 s, Result = 00050000, Performance =  29.48 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001572 s, Result = 000a0000, Performance =  27.33 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002736 s, Result = 000f0000, Performance =  23.55 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003415 s, Result = 00140000, Performance =  25.15 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.002495 s, Result = 00190000, Performance =  43.03 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.003010 s, Result = 001e0000, Performance =  42.81 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002859 s, Result = 00230000, Performance =  52.58 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003918 s, Result = 00280000, Performance =  43.85 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003781 s, Result = 002d0000, Performance =  51.12 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.004835 s, Result = 00320000, Performance =  44.41 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.004556 s, Result = 00370000, Performance =  51.85 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.005398 s, Result = 003c0000, Performance =  47.74 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.006439 s, Result = 00410000, Performance =  43.36 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.007325 s, Result = 00460000, Performance =  41.04 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.008073 s, Result = 004b0000, Performance =  39.90 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.008055 s, Result = 00500000, Performance =  42.66 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.009957 s, Result = 00550000, Performance =  36.66 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.009523 s, Result = 005a0000, Performance =  40.59 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.010533 s, Result = 005f0000, Performance =  38.74 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.011439 s, Result = 00640000, Performance =  37.55 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.012847 s, Result = 00690000, Performance =  35.10 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.013602 s, Result = 006e0000, Performance =  34.73 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.015610 s, Result = 00730000, Performance =  31.64 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.016871 s, Result = 00780000, Performance =  30.55 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.018286 s, Result = 007d0000, Performance =  29.36 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.019413 s, Result = 00820000, Performance =  28.76 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.021395 s, Result = 00870000, Performance =  27.10 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.023172 s, Result = 008c0000, Performance =  25.95 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.024277 s, Result = 00910000, Performance =  25.65 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.025924 s, Result = 00960000, Performance =  24.85 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.027499 s, Result = 009b0000, Performance =  24.21 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.028231 s, Result = 00a00000, Performance =  24.34 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.028296 s, Result = 00a50000, Performance =  25.04 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.032497 s, Result = 00aa0000, Performance =  22.47 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.036307 s, Result = 00af0000, Performance =  20.70 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.037382 s, Result = 00b40000, Performance =  20.68 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.038297 s, Result = 00b90000, Performance =  20.75 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.038545 s, Result = 00be0000, Performance =  21.17 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.039500 s, Result = 00c30000, Performance =  21.20 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.040746 s, Result = 00c80000, Performance =  21.08 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.041199 s, Result = 00cd0000, Performance =  21.37 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.041983 s, Result = 00d20000, Performance =  21.48 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.041048 s, Result = 00d70000, Performance =  22.50 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.040836 s, Result = 00dc0000, Performance =  23.14 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.041264 s, Result = 00e10000, Performance =  23.42 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.041270 s, Result = 00e60000, Performance =  23.94 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.041552 s, Result = 00eb0000, Performance =  24.29 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.042228 s, Result = 00f00000, Performance =  24.41 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.042376 s, Result = 00f50000, Performance =  24.83 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043089 s, Result = 00fa0000, Performance =  24.92 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.044907 s, Result = 00ff0000, Performance =  24.39 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.045520 s, Result = 01040000, Performance =  24.53 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.047109 s, Result = 01090000, Performance =  24.16 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.048772 s, Result = 010e0000, Performance =  23.78 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050889 s, Result = 01130000, Performance =  23.21 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.052684 s, Result = 01180000, Performance =  22.83 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.052322 s, Result = 011d0000, Performance =  23.39 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052062 s, Result = 01220000, Performance =  23.92 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052199 s, Result = 01270000, Performance =  24.27 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052542 s, Result = 012c0000, Performance =  24.52 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053276 s, Result = 01310000, Performance =  24.59 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.053789 s, Result = 01360000, Performance =  24.75 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.053225 s, Result = 013b0000, Performance =  25.42 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.066781 s, Result = 01400000, Performance =  20.58 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   491  1424  1024
Test passed: M N K =   258  1296  2048
Test passed: M N K =  1885  1135  1216
Test passed: M N K =   490   812    64
Test passed: M N K =  1053  2039  1216
M N K =  2048  2048   256, Elapsed time =   0.008537 s, Result = 84090000, Performance =   2.52 TOPS
M N K =  2048  2048   512, Elapsed time =   0.005853 s, Result = 040e0000, Performance =   7.34 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007502 s, Result = 84130000, Performance =   8.59 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.008682 s, Result = 04180000, Performance =   9.89 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.008218 s, Result = 841d0000, Performance =  13.07 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009712 s, Result = 04220000, Performance =  13.27 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.010747 s, Result = 84270000, Performance =  13.99 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.011383 s, Result = 042c0000, Performance =  15.09 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012663 s, Result = 84310000, Performance =  15.26 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.013694 s, Result = 04360000, Performance =  15.68 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.014902 s, Result = 843b0000, Performance =  15.85 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.015718 s, Result = 04400000, Performance =  16.40 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.018202 s, Result = 84450000, Performance =  15.34 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.017702 s, Result = 044a0000, Performance =  16.98 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.022295 s, Result = 844f0000, Performance =  14.45 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.021199 s, Result = 04540000, Performance =  16.21 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.022083 s, Result = 84590000, Performance =  16.53 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.022360 s, Result = 045e0000, Performance =  17.29 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.025333 s, Result = 84630000, Performance =  16.11 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.033210 s, Result = 04680000, Performance =  12.93 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.028949 s, Result = 846d0000, Performance =  15.58 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.029341 s, Result = 04720000, Performance =  16.10 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.030320 s, Result = 84770000, Performance =  16.29 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.031418 s, Result = 047c0000, Performance =  16.40 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.032752 s, Result = 84810000, Performance =  16.39 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.033954 s, Result = 04860000, Performance =  16.44 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.035116 s, Result = 848b0000, Performance =  16.51 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.036382 s, Result = 04900000, Performance =  16.53 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.037098 s, Result = 84950000, Performance =  16.79 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.038207 s, Result = 049a0000, Performance =  16.86 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.039312 s, Result = 849f0000, Performance =  16.93 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.041564 s, Result = 04a40000, Performance =  16.53 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.041142 s, Result = 84a90000, Performance =  17.22 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.040364 s, Result = 04ae0000, Performance =  18.09 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.040885 s, Result = 84b30000, Performance =  18.38 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.041153 s, Result = 04b80000, Performance =  18.79 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.041916 s, Result = 84bd0000, Performance =  18.96 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.042448 s, Result = 04c20000, Performance =  19.22 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.043285 s, Result = 84c70000, Performance =  19.35 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.043716 s, Result = 04cc0000, Performance =  19.65 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.045520 s, Result = 84d10000, Performance =  19.34 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.044815 s, Result = 04d60000, Performance =  20.13 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.045592 s, Result = 84db0000, Performance =  20.25 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.046379 s, Result = 04e00000, Performance =  20.37 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.046911 s, Result = 84e50000, Performance =  20.60 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.047937 s, Result = 04ea0000, Performance =  20.61 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.048595 s, Result = 84ef0000, Performance =  20.77 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.049815 s, Result = 04f40000, Performance =  20.69 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.050416 s, Result = 84f90000, Performance =  20.87 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.051082 s, Result = 04fe0000, Performance =  21.02 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.052028 s, Result = 85030000, Performance =  21.05 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.052365 s, Result = 05080000, Performance =  21.33 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.053015 s, Result = 850d0000, Performance =  21.47 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.053301 s, Result = 05120000, Performance =  21.76 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.053880 s, Result = 85170000, Performance =  21.92 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.054155 s, Result = 051c0000, Performance =  22.21 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.054604 s, Result = 85210000, Performance =  22.42 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.055016 s, Result = 05260000, Performance =  22.64 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.055315 s, Result = 852b0000, Performance =  22.91 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.056769 s, Result = 05300000, Performance =  22.70 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.056964 s, Result = 85350000, Performance =  23.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.055738 s, Result = 053a0000, Performance =  23.89 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.057473 s, Result = 853f0000, Performance =  23.54 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.077788 s, Result = 05440000, Performance =  17.67 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   625   142   896
Test passed: M N K =    24  1308  1856
Test passed: M N K =  2025  1389  1920
Test passed: M N K =   679  1554   448
Test passed: M N K =   476  1121  1536
M N K =  2048  2048   256, Elapsed time =   0.005882 s, Result = 00050000, Performance =   3.65 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003301 s, Result = 000a0000, Performance =  13.01 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003848 s, Result = 000f0000, Performance =  16.74 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005658 s, Result = 00140000, Performance =  15.18 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005752 s, Result = 00190000, Performance =  18.67 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006078 s, Result = 001e0000, Performance =  21.20 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007177 s, Result = 00230000, Performance =  20.94 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008926 s, Result = 00280000, Performance =  19.25 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009809 s, Result = 002d0000, Performance =  19.70 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010730 s, Result = 00320000, Performance =  20.01 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011331 s, Result = 00370000, Performance =  20.85 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013046 s, Result = 003c0000, Performance =  19.75 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013548 s, Result = 00410000, Performance =  20.61 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015279 s, Result = 00460000, Performance =  19.68 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014785 s, Result = 004b0000, Performance =  21.79 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018515 s, Result = 00500000, Performance =  18.56 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017259 s, Result = 00550000, Performance =  21.15 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018433 s, Result = 005a0000, Performance =  20.97 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020130 s, Result = 005f0000, Performance =  20.27 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021164 s, Result = 00640000, Performance =  20.29 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022594 s, Result = 00690000, Performance =  19.96 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023556 s, Result = 006e0000, Performance =  20.06 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025027 s, Result = 00730000, Performance =  19.74 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026557 s, Result = 00780000, Performance =  19.41 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030510 s, Result = 007d0000, Performance =  17.60 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031661 s, Result = 00820000, Performance =  17.64 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031738 s, Result = 00870000, Performance =  18.27 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032427 s, Result = 008c0000, Performance =  18.54 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033830 s, Result = 00910000, Performance =  18.41 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034524 s, Result = 00960000, Performance =  18.66 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035363 s, Result = 009b0000, Performance =  18.83 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038438 s, Result = 00a00000, Performance =  17.88 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037056 s, Result = 00a50000, Performance =  19.12 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036355 s, Result = 00aa0000, Performance =  20.08 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.037918 s, Result = 00af0000, Performance =  19.82 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038517 s, Result = 00b40000, Performance =  20.07 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.039270 s, Result = 00b90000, Performance =  20.23 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040003 s, Result = 00be0000, Performance =  20.40 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040896 s, Result = 00c30000, Performance =  20.48 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.041043 s, Result = 00c80000, Performance =  20.93 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.042004 s, Result = 00cd0000, Performance =  20.96 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042537 s, Result = 00d20000, Performance =  21.20 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043943 s, Result = 00d70000, Performance =  21.01 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045246 s, Result = 00dc0000, Performance =  20.88 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045180 s, Result = 00e10000, Performance =  21.39 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045719 s, Result = 00e60000, Performance =  21.61 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046215 s, Result = 00eb0000, Performance =  21.84 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046671 s, Result = 00f00000, Performance =  22.09 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047350 s, Result = 00f50000, Performance =  22.22 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047788 s, Result = 00fa0000, Performance =  22.47 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047953 s, Result = 00ff0000, Performance =  22.84 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048816 s, Result = 01040000, Performance =  22.88 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048876 s, Result = 01090000, Performance =  23.29 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049860 s, Result = 010e0000, Performance =  23.26 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050631 s, Result = 01130000, Performance =  23.33 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050844 s, Result = 01180000, Performance =  23.65 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.051814 s, Result = 011d0000, Performance =  23.62 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052266 s, Result = 01220000, Performance =  23.83 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052057 s, Result = 01270000, Performance =  24.34 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052751 s, Result = 012c0000, Performance =  24.43 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053663 s, Result = 01310000, Performance =  24.41 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.052504 s, Result = 01360000, Performance =  25.36 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.053749 s, Result = 013b0000, Performance =  25.17 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.073089 s, Result = 01400000, Performance =  18.80 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   625   142   896
Test passed: M N K =    24  1308  1856
Test passed: M N K =  2025  1389  1920
Test passed: M N K =   679  1554   448
Test passed: M N K =   476  1121  1536
M N K =  2048  2048   256, Elapsed time =   0.005882 s, Result = 00050000, Performance =  0.00 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003301 s, Result = 000a0000, Performance =  0.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003848 s, Result = 000f0000, Performance =  0.00 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005658 s, Result = 00140000, Performance =  0.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005752 s, Result = 00190000, Performance =  0.00 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006078 s, Result = 001e0000, Performance =  0.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007177 s, Result = 00230000, Performance =  0.00 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008926 s, Result = 00280000, Performance =  0.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009809 s, Result = 002d0000, Performance =  0.00 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010730 s, Result = 00320000, Performance =  0.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011331 s, Result = 00370000, Performance =  0.00 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013046 s, Result = 003c0000, Performance =  0.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013548 s, Result = 00410000, Performance =  0.00 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015279 s, Result = 00460000, Performance =  0.00 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014785 s, Result = 004b0000, Performance =  0.00 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018515 s, Result = 00500000, Performance =  0.00 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017259 s, Result = 00550000, Performance =  0.00 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018433 s, Result = 005a0000, Performance =  0.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020130 s, Result = 005f0000, Performance =  0.00 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021164 s, Result = 00640000, Performance =  0.00 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022594 s, Result = 00690000, Performance =  0.00 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023556 s, Result = 006e0000, Performance =  0.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025027 s, Result = 00730000, Performance =  0.00 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026557 s, Result = 00780000, Performance =  0.00 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030510 s, Result = 007d0000, Performance =  0.00 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031661 s, Result = 00820000, Performance =  0.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031738 s, Result = 00870000, Performance =  0.00 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032427 s, Result = 008c0000, Performance =  0.00 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033830 s, Result = 00910000, Performance =  0.00 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034524 s, Result = 00960000, Performance =  0.00 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035363 s, Result = 009b0000, Performance =  0.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038438 s, Result = 00a00000, Performance =  0.00 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037056 s, Result = 00a50000, Performance =  0.00 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036355 s, Result = 00aa0000, Performance =  0.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.037918 s, Result = 00af0000, Performance =  0.00 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038517 s, Result = 00b40000, Performance =  0.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.039270 s, Result = 00b90000, Performance =  0.00 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040003 s, Result = 00be0000, Performance =  0.00 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040896 s, Result = 00c30000, Performance =  0.00 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.041043 s, Result = 00c80000, Performance =  0.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.042004 s, Result = 00cd0000, Performance =  0.00 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042537 s, Result = 00d20000, Performance =  0.00 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043943 s, Result = 00d70000, Performance =  0.00 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045246 s, Result = 00dc0000, Performance =  0.00 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045180 s, Result = 00e10000, Performance =  0.00 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045719 s, Result = 00e60000, Performance =  0.00 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046215 s, Result = 00eb0000, Performance =  0.00 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046671 s, Result = 00f00000, Performance =  0.00 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047350 s, Result = 00f50000, Performance =  0.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047788 s, Result = 00fa0000, Performance =  0.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047953 s, Result = 00ff0000, Performance =  0.00 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048816 s, Result = 01040000, Performance =  0.00 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048876 s, Result = 01090000, Performance =  0.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049860 s, Result = 010e0000, Performance =  0.00 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050631 s, Result = 01130000, Performance =  0.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050844 s, Result = 01180000, Performance =  0.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.051814 s, Result = 011d0000, Performance =  0.00 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052266 s, Result = 01220000, Performance =  0.00 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052057 s, Result = 01270000, Performance =  0.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052751 s, Result = 012c0000, Performance =  0.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053663 s, Result = 01310000, Performance =  0.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.052504 s, Result = 01360000, Performance =  0.00 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.053749 s, Result = 013b0000, Performance =  0.00 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.073089 s, Result = 01400000, Performance =  0.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   625   142   896
Test passed: M N K =    24  1308  1856
Test passed: M N K =  2025  1389  1920
Test passed: M N K =   679  1554   448
Test passed: M N K =   476  1121  1536
M N K =  2048  2048   256, Elapsed time =   0.005882 s, Result = 00050000, Performance =  0.00 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003301 s, Result = 000a0000, Performance =  0.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003848 s, Result = 000f0000, Performance =  0.00 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005658 s, Result = 00140000, Performance =  0.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005752 s, Result = 00190000, Performance =  0.00 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006078 s, Result = 001e0000, Performance =  0.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007177 s, Result = 00230000, Performance =  0.00 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008926 s, Result = 00280000, Performance =  0.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009809 s, Result = 002d0000, Performance =  0.00 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010730 s, Result = 00320000, Performance =  0.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011331 s, Result = 00370000, Performance =  0.00 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013046 s, Result = 003c0000, Performance =  0.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013548 s, Result = 00410000, Performance =  0.00 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015279 s, Result = 00460000, Performance =  0.00 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014785 s, Result = 004b0000, Performance =  0.00 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018515 s, Result = 00500000, Performance =  0.00 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017259 s, Result = 00550000, Performance =  0.00 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018433 s, Result = 005a0000, Performance =  0.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020130 s, Result = 005f0000, Performance =  0.00 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021164 s, Result = 00640000, Performance =  0.00 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022594 s, Result = 00690000, Performance =  0.00 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023556 s, Result = 006e0000, Performance =  0.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025027 s, Result = 00730000, Performance =  0.00 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026557 s, Result = 00780000, Performance =  0.00 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030510 s, Result = 007d0000, Performance =  0.00 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031661 s, Result = 00820000, Performance =  0.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031738 s, Result = 00870000, Performance =  0.00 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032427 s, Result = 008c0000, Performance =  0.00 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033830 s, Result = 00910000, Performance =  0.00 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034524 s, Result = 00960000, Performance =  0.00 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035363 s, Result = 009b0000, Performance =  0.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038438 s, Result = 00a00000, Performance =  0.00 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037056 s, Result = 00a50000, Performance =  0.00 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036355 s, Result = 00aa0000, Performance =  0.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.037918 s, Result = 00af0000, Performance =  0.00 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038517 s, Result = 00b40000, Performance =  0.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.039270 s, Result = 00b90000, Performance =  0.00 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040003 s, Result = 00be0000, Performance =  0.00 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040896 s, Result = 00c30000, Performance =  0.00 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.041043 s, Result = 00c80000, Performance =  0.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.042004 s, Result = 00cd0000, Performance =  0.00 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042537 s, Result = 00d20000, Performance =  0.00 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043943 s, Result = 00d70000, Performance =  0.00 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045246 s, Result = 00dc0000, Performance =  0.00 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045180 s, Result = 00e10000, Performance =  0.00 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045719 s, Result = 00e60000, Performance =  0.00 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046215 s, Result = 00eb0000, Performance =  0.00 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046671 s, Result = 00f00000, Performance =  0.00 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047350 s, Result = 00f50000, Performance =  0.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047788 s, Result = 00fa0000, Performance =  0.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047953 s, Result = 00ff0000, Performance =  0.00 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048816 s, Result = 01040000, Performance =  0.00 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048876 s, Result = 01090000, Performance =  0.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049860 s, Result = 010e0000, Performance =  0.00 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050631 s, Result = 01130000, Performance =  0.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050844 s, Result = 01180000, Performance =  0.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.051814 s, Result = 011d0000, Performance =  0.00 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052266 s, Result = 01220000, Performance =  0.00 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052057 s, Result = 01270000, Performance =  0.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052751 s, Result = 012c0000, Performance =  0.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053663 s, Result = 01310000, Performance =  0.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.052504 s, Result = 01360000, Performance =  0.00 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.053749 s, Result = 013b0000, Performance =  0.00 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.073089 s, Result = 01400000, Performance =  0.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   625   142   896
Test passed: M N K =    24  1308  1856
Test passed: M N K =  2025  1389  1920
Test passed: M N K =   679  1554   448
Test passed: M N K =   476  1121  1536
M N K =  2048  2048   256, Elapsed time =   0.005882 s, Result = 00050000, Performance =  0.00 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003301 s, Result = 000a0000, Performance =  0.00 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003848 s, Result = 000f0000, Performance =  0.00 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005658 s, Result = 00140000, Performance =  0.00 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005752 s, Result = 00190000, Performance =  0.00 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006078 s, Result = 001e0000, Performance =  0.00 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007177 s, Result = 00230000, Performance =  0.00 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.008926 s, Result = 00280000, Performance =  0.00 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009809 s, Result = 002d0000, Performance =  0.00 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010730 s, Result = 00320000, Performance =  0.00 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011331 s, Result = 00370000, Performance =  0.00 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.013046 s, Result = 003c0000, Performance =  0.00 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.013548 s, Result = 00410000, Performance =  0.00 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.015279 s, Result = 00460000, Performance =  0.00 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.014785 s, Result = 004b0000, Performance =  0.00 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.018515 s, Result = 00500000, Performance =  0.00 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.017259 s, Result = 00550000, Performance =  0.00 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.018433 s, Result = 005a0000, Performance =  0.00 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.020130 s, Result = 005f0000, Performance =  0.00 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.021164 s, Result = 00640000, Performance =  0.00 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.022594 s, Result = 00690000, Performance =  0.00 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.023556 s, Result = 006e0000, Performance =  0.00 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.025027 s, Result = 00730000, Performance =  0.00 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026557 s, Result = 00780000, Performance =  0.00 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.030510 s, Result = 007d0000, Performance =  0.00 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.031661 s, Result = 00820000, Performance =  0.00 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.031738 s, Result = 00870000, Performance =  0.00 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.032427 s, Result = 008c0000, Performance =  0.00 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.033830 s, Result = 00910000, Performance =  0.00 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.034524 s, Result = 00960000, Performance =  0.00 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.035363 s, Result = 009b0000, Performance =  0.00 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.038438 s, Result = 00a00000, Performance =  0.00 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.037056 s, Result = 00a50000, Performance =  0.00 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.036355 s, Result = 00aa0000, Performance =  0.00 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.037918 s, Result = 00af0000, Performance =  0.00 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.038517 s, Result = 00b40000, Performance =  0.00 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.039270 s, Result = 00b90000, Performance =  0.00 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.040003 s, Result = 00be0000, Performance =  0.00 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.040896 s, Result = 00c30000, Performance =  0.00 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.041043 s, Result = 00c80000, Performance =  0.00 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.042004 s, Result = 00cd0000, Performance =  0.00 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.042537 s, Result = 00d20000, Performance =  0.00 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.043943 s, Result = 00d70000, Performance =  0.00 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.045246 s, Result = 00dc0000, Performance =  0.00 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.045180 s, Result = 00e10000, Performance =  0.00 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.045719 s, Result = 00e60000, Performance =  0.00 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.046215 s, Result = 00eb0000, Performance =  0.00 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.046671 s, Result = 00f00000, Performance =  0.00 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.047350 s, Result = 00f50000, Performance =  0.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.047788 s, Result = 00fa0000, Performance =  0.00 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.047953 s, Result = 00ff0000, Performance =  0.00 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.048816 s, Result = 01040000, Performance =  0.00 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.048876 s, Result = 01090000, Performance =  0.00 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.049860 s, Result = 010e0000, Performance =  0.00 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.050631 s, Result = 01130000, Performance =  0.00 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.050844 s, Result = 01180000, Performance =  0.00 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.051814 s, Result = 011d0000, Performance =  0.00 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.052266 s, Result = 01220000, Performance =  0.00 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.052057 s, Result = 01270000, Performance =  0.00 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.052751 s, Result = 012c0000, Performance =  0.00 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.053663 s, Result = 01310000, Performance =  0.00 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.052504 s, Result = 01360000, Performance =  0.00 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.053749 s, Result = 013b0000, Performance =  0.00 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.073089 s, Result = 01400000, Performance =  0.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1466  1368  1536
Test passed: M N K =  1908   661  1536
Test passed: M N K =   472   732  1984
Test passed: M N K =  1598   719    64
Test passed: M N K =  1674   752  1152
M N K =  2048  2048   256, Elapsed time =   0.007112 s, Result = 00050000, Performance =   3.02 TOPS
M N K =  2048  2048   512, Elapsed time =   0.003621 s, Result = 000a0000, Performance =  11.86 TOPS
M N K =  2048  2048   768, Elapsed time =   0.003621 s, Result = 000f0000, Performance =  17.79 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.005086 s, Result = 00140000, Performance =  16.89 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.005771 s, Result = 00190000, Performance =  18.60 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.006169 s, Result = 001e0000, Performance =  20.89 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.007038 s, Result = 00230000, Performance =  21.36 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.007443 s, Result = 00280000, Performance =  23.08 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.009470 s, Result = 002d0000, Performance =  20.41 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.010967 s, Result = 00320000, Performance =  19.58 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011786 s, Result = 00370000, Performance =  20.04 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.012824 s, Result = 003c0000, Performance =  20.09 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012447 s, Result = 00410000, Performance =  22.43 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.014611 s, Result = 00460000, Performance =  20.58 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.015917 s, Result = 004b0000, Performance =  20.24 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.015334 s, Result = 00500000, Performance =  22.41 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.016864 s, Result = 00550000, Performance =  21.65 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.017804 s, Result = 005a0000, Performance =  21.71 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.019642 s, Result = 005f0000, Performance =  20.77 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.019979 s, Result = 00640000, Performance =  21.50 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.020765 s, Result = 00690000, Performance =  21.72 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.022583 s, Result = 006e0000, Performance =  20.92 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.023190 s, Result = 00730000, Performance =  21.30 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.026346 s, Result = 00780000, Performance =  19.56 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.029127 s, Result = 007d0000, Performance =  18.43 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.029749 s, Result = 00820000, Performance =  18.77 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.030059 s, Result = 00870000, Performance =  19.29 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.030439 s, Result = 008c0000, Performance =  19.75 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.031324 s, Result = 00910000, Performance =  19.88 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031886 s, Result = 00960000, Performance =  20.20 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.033435 s, Result = 009b0000, Performance =  19.91 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.035389 s, Result = 00a00000, Performance =  19.42 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.034323 s, Result = 00a50000, Performance =  20.65 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.035991 s, Result = 00aa0000, Performance =  20.29 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.036053 s, Result = 00af0000, Performance =  20.85 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.035592 s, Result = 00b40000, Performance =  21.72 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.036337 s, Result = 00b90000, Performance =  21.87 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.037466 s, Result = 00be0000, Performance =  21.78 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.038127 s, Result = 00c30000, Performance =  21.97 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.038168 s, Result = 00c80000, Performance =  22.51 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.039356 s, Result = 00cd0000, Performance =  22.37 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.039808 s, Result = 00d20000, Performance =  22.66 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.040083 s, Result = 00d70000, Performance =  23.04 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.039706 s, Result = 00dc0000, Performance =  23.80 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.041778 s, Result = 00e10000, Performance =  23.13 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.042984 s, Result = 00e60000, Performance =  22.98 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.043655 s, Result = 00eb0000, Performance =  23.12 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.043681 s, Result = 00f00000, Performance =  23.60 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.043853 s, Result = 00f50000, Performance =  24.00 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.044042 s, Result = 00fa0000, Performance =  24.38 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.044922 s, Result = 00ff0000, Performance =  24.38 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.044729 s, Result = 01040000, Performance =  24.97 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.045747 s, Result = 01090000, Performance =  24.88 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.046657 s, Result = 010e0000, Performance =  24.85 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.047260 s, Result = 01130000, Performance =  24.99 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047107 s, Result = 01180000, Performance =  25.53 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.048416 s, Result = 011d0000, Performance =  25.28 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.049342 s, Result = 01220000, Performance =  25.24 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.049665 s, Result = 01270000, Performance =  25.51 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048676 s, Result = 012c0000, Performance =  26.47 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.051313 s, Result = 01310000, Performance =  25.53 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.052299 s, Result = 01360000, Performance =  25.46 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.049825 s, Result = 013b0000, Performance =  27.15 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.063458 s, Result = 01400000, Performance =  21.66 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   235   632  1280
Test passed: M N K =    24   331   832
Test passed: M N K =   323  1676  1088
Test passed: M N K =  1320   687  1536
Test passed: M N K =   405  1050  1536
M N K =  2048  2048   256, Elapsed time =   0.007998 s, Result = 282d0000, Performance =   2.68 TOPS
M N K =  2048  2048   512, Elapsed time =   0.008027 s, Result = 28320000, Performance =   5.35 TOPS
M N K =  2048  2048   768, Elapsed time =   0.007807 s, Result = 28370000, Performance =   8.25 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.007543 s, Result = 283c0000, Performance =  11.39 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.010575 s, Result = 28410000, Performance =  10.15 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.009016 s, Result = 28460000, Performance =  14.29 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.011441 s, Result = 284b0000, Performance =  13.14 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.012088 s, Result = 28500000, Performance =  14.21 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.012258 s, Result = 28550000, Performance =  15.77 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.014330 s, Result = 285a0000, Performance =  14.99 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.011477 s, Result = 285f0000, Performance =  20.58 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.011973 s, Result = 28640000, Performance =  21.52 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.012495 s, Result = 28690000, Performance =  22.34 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.013571 s, Result = 286e0000, Performance =  22.15 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.013795 s, Result = 28730000, Performance =  23.35 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.014556 s, Result = 28780000, Performance =  23.61 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.014389 s, Result = 287d0000, Performance =  25.37 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.015422 s, Result = 28820000, Performance =  25.06 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.015994 s, Result = 28870000, Performance =  25.51 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.017438 s, Result = 288c0000, Performance =  24.63 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.018438 s, Result = 28910000, Performance =  24.46 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.019384 s, Result = 28960000, Performance =  24.37 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020407 s, Result = 289b0000, Performance =  24.20 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.022179 s, Result = 28a00000, Performance =  23.24 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.023090 s, Result = 28a50000, Performance =  23.25 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.024196 s, Result = 28aa0000, Performance =  23.08 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.025734 s, Result = 28af0000, Performance =  22.53 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.027798 s, Result = 28b40000, Performance =  21.63 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.030133 s, Result = 28b90000, Performance =  20.67 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.031321 s, Result = 28be0000, Performance =  20.57 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.031900 s, Result = 28c30000, Performance =  20.87 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.034228 s, Result = 28c80000, Performance =  20.08 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.033578 s, Result = 28cd0000, Performance =  21.11 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.034589 s, Result = 28d20000, Performance =  21.11 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.035160 s, Result = 28d70000, Performance =  21.38 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.034251 s, Result = 28dc0000, Performance =  22.57 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.035531 s, Result = 28e10000, Performance =  22.36 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.035959 s, Result = 28e60000, Performance =  22.69 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.036807 s, Result = 28eb0000, Performance =  22.75 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.036950 s, Result = 28f00000, Performance =  23.25 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.038015 s, Result = 28f50000, Performance =  23.16 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.038562 s, Result = 28fa0000, Performance =  23.39 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.038982 s, Result = 28ff0000, Performance =  23.69 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.039031 s, Result = 29040000, Performance =  24.21 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.040490 s, Result = 29090000, Performance =  23.87 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.041003 s, Result = 290e0000, Performance =  24.09 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.042144 s, Result = 29130000, Performance =  23.95 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.041931 s, Result = 29180000, Performance =  24.58 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.043329 s, Result = 291d0000, Performance =  24.29 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.043656 s, Result = 29220000, Performance =  24.60 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.044486 s, Result = 29270000, Performance =  24.62 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.044651 s, Result = 292c0000, Performance =  25.01 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.045595 s, Result = 29310000, Performance =  24.96 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.046355 s, Result = 29360000, Performance =  25.02 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.047079 s, Result = 293b0000, Performance =  25.09 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.047444 s, Result = 29400000, Performance =  25.35 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.047849 s, Result = 29450000, Performance =  25.58 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.048492 s, Result = 294a0000, Performance =  25.69 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.049690 s, Result = 294f0000, Performance =  25.50 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.048840 s, Result = 29540000, Performance =  26.38 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.049716 s, Result = 29590000, Performance =  26.35 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.050459 s, Result = 295e0000, Performance =  26.39 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.049706 s, Result = 29630000, Performance =  27.22 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.063077 s, Result = 29680000, Performance =  21.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=2048 -DTEST_N=2048 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=2 -DCORES_N=2 -DCORE_START=0 -DCORE_STRIDE=8 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 4 CPU Cores (2 Cores x 2 Cores)(Core 0 - Core 3 per 8 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   826   995   512
Test passed: M N K =   540  1292   320
Test passed: M N K =   123   733  1280
Test passed: M N K =   384  1911  1472
Test passed: M N K =    71  1316  1600
M N K =  2048  2048   256, Elapsed time =   0.000716 s, Result = 00050000, Performance =  29.98 TOPS
M N K =  2048  2048   512, Elapsed time =   0.001418 s, Result = 000a0000, Performance =  30.29 TOPS
M N K =  2048  2048   768, Elapsed time =   0.002429 s, Result = 000f0000, Performance =  26.53 TOPS
M N K =  2048  2048  1024, Elapsed time =   0.003355 s, Result = 00140000, Performance =  25.60 TOPS
M N K =  2048  2048  1280, Elapsed time =   0.003037 s, Result = 00190000, Performance =  35.36 TOPS
M N K =  2048  2048  1536, Elapsed time =   0.002363 s, Result = 001e0000, Performance =  54.54 TOPS
M N K =  2048  2048  1792, Elapsed time =   0.002843 s, Result = 00230000, Performance =  52.88 TOPS
M N K =  2048  2048  2048, Elapsed time =   0.003174 s, Result = 00280000, Performance =  54.12 TOPS
M N K =  2048  2048  2304, Elapsed time =   0.003624 s, Result = 002d0000, Performance =  53.33 TOPS
M N K =  2048  2048  2560, Elapsed time =   0.003999 s, Result = 00320000, Performance =  53.70 TOPS
M N K =  2048  2048  2816, Elapsed time =   0.004521 s, Result = 00370000, Performance =  52.25 TOPS
M N K =  2048  2048  3072, Elapsed time =   0.004929 s, Result = 003c0000, Performance =  52.28 TOPS
M N K =  2048  2048  3328, Elapsed time =   0.005732 s, Result = 00410000, Performance =  48.71 TOPS
M N K =  2048  2048  3584, Elapsed time =   0.006032 s, Result = 00460000, Performance =  49.84 TOPS
M N K =  2048  2048  3840, Elapsed time =   0.006604 s, Result = 004b0000, Performance =  48.78 TOPS
M N K =  2048  2048  4096, Elapsed time =   0.007192 s, Result = 00500000, Performance =  47.77 TOPS
M N K =  2048  2048  4352, Elapsed time =   0.007931 s, Result = 00550000, Performance =  46.03 TOPS
M N K =  2048  2048  4608, Elapsed time =   0.008356 s, Result = 005a0000, Performance =  46.26 TOPS
M N K =  2048  2048  4864, Elapsed time =   0.009617 s, Result = 005f0000, Performance =  42.43 TOPS
M N K =  2048  2048  5120, Elapsed time =   0.009895 s, Result = 00640000, Performance =  43.40 TOPS
M N K =  2048  2048  5376, Elapsed time =   0.010670 s, Result = 00690000, Performance =  42.26 TOPS
M N K =  2048  2048  5632, Elapsed time =   0.011396 s, Result = 006e0000, Performance =  41.46 TOPS
M N K =  2048  2048  5888, Elapsed time =   0.020371 s, Result = 00730000, Performance =  24.25 TOPS
M N K =  2048  2048  6144, Elapsed time =   0.013682 s, Result = 00780000, Performance =  37.67 TOPS
M N K =  2048  2048  6400, Elapsed time =   0.014539 s, Result = 007d0000, Performance =  36.93 TOPS
M N K =  2048  2048  6656, Elapsed time =   0.015959 s, Result = 00820000, Performance =  34.99 TOPS
M N K =  2048  2048  6912, Elapsed time =   0.017112 s, Result = 00870000, Performance =  33.88 TOPS
M N K =  2048  2048  7168, Elapsed time =   0.018112 s, Result = 008c0000, Performance =  33.20 TOPS
M N K =  2048  2048  7424, Elapsed time =   0.019127 s, Result = 00910000, Performance =  32.56 TOPS
M N K =  2048  2048  7680, Elapsed time =   0.020734 s, Result = 00960000, Performance =  31.07 TOPS
M N K =  2048  2048  7936, Elapsed time =   0.021544 s, Result = 009b0000, Performance =  30.90 TOPS
M N K =  2048  2048  8192, Elapsed time =   0.023456 s, Result = 00a00000, Performance =  29.30 TOPS
M N K =  2048  2048  8448, Elapsed time =   0.023725 s, Result = 00a50000, Performance =  29.87 TOPS
M N K =  2048  2048  8704, Elapsed time =   0.025662 s, Result = 00aa0000, Performance =  28.45 TOPS
M N K =  2048  2048  8960, Elapsed time =   0.028239 s, Result = 00af0000, Performance =  26.62 TOPS
M N K =  2048  2048  9216, Elapsed time =   0.030048 s, Result = 00b40000, Performance =  25.73 TOPS
M N K =  2048  2048  9472, Elapsed time =   0.031029 s, Result = 00b90000, Performance =  25.61 TOPS
M N K =  2048  2048  9728, Elapsed time =   0.031511 s, Result = 00be0000, Performance =  25.90 TOPS
M N K =  2048  2048  9984, Elapsed time =   0.032410 s, Result = 00c30000, Performance =  25.84 TOPS
M N K =  2048  2048 10240, Elapsed time =   0.032321 s, Result = 00c80000, Performance =  26.58 TOPS
M N K =  2048  2048 10496, Elapsed time =   0.033506 s, Result = 00cd0000, Performance =  26.28 TOPS
M N K =  2048  2048 10752, Elapsed time =   0.034092 s, Result = 00d20000, Performance =  26.46 TOPS
M N K =  2048  2048 11008, Elapsed time =   0.034829 s, Result = 00d70000, Performance =  26.51 TOPS
M N K =  2048  2048 11264, Elapsed time =   0.034694 s, Result = 00dc0000, Performance =  27.24 TOPS
M N K =  2048  2048 11520, Elapsed time =   0.036435 s, Result = 00e10000, Performance =  26.52 TOPS
M N K =  2048  2048 11776, Elapsed time =   0.037081 s, Result = 00e60000, Performance =  26.64 TOPS
M N K =  2048  2048 12032, Elapsed time =   0.038224 s, Result = 00eb0000, Performance =  26.41 TOPS
M N K =  2048  2048 12288, Elapsed time =   0.038288 s, Result = 00f00000, Performance =  26.92 TOPS
M N K =  2048  2048 12544, Elapsed time =   0.039587 s, Result = 00f50000, Performance =  26.58 TOPS
M N K =  2048  2048 12800, Elapsed time =   0.039584 s, Result = 00fa0000, Performance =  27.13 TOPS
M N K =  2048  2048 13056, Elapsed time =   0.040294 s, Result = 00ff0000, Performance =  27.18 TOPS
M N K =  2048  2048 13312, Elapsed time =   0.040342 s, Result = 01040000, Performance =  27.68 TOPS
M N K =  2048  2048 13568, Elapsed time =   0.041462 s, Result = 01090000, Performance =  27.45 TOPS
M N K =  2048  2048 13824, Elapsed time =   0.042190 s, Result = 010e0000, Performance =  27.49 TOPS
M N K =  2048  2048 14080, Elapsed time =   0.043079 s, Result = 01130000, Performance =  27.42 TOPS
M N K =  2048  2048 14336, Elapsed time =   0.042851 s, Result = 01180000, Performance =  28.06 TOPS
M N K =  2048  2048 14592, Elapsed time =   0.044110 s, Result = 011d0000, Performance =  27.75 TOPS
M N K =  2048  2048 14848, Elapsed time =   0.044835 s, Result = 01220000, Performance =  27.78 TOPS
M N K =  2048  2048 15104, Elapsed time =   0.045644 s, Result = 01270000, Performance =  27.76 TOPS
M N K =  2048  2048 15360, Elapsed time =   0.044195 s, Result = 012c0000, Performance =  29.15 TOPS
M N K =  2048  2048 15616, Elapsed time =   0.046162 s, Result = 01310000, Performance =  28.38 TOPS
M N K =  2048  2048 15872, Elapsed time =   0.046688 s, Result = 01360000, Performance =  28.52 TOPS
M N K =  2048  2048 16128, Elapsed time =   0.045481 s, Result = 013b0000, Performance =  29.75 TOPS
M N K =  2048  2048 16384, Elapsed time =   0.058370 s, Result = 01400000, Performance =  23.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1258  1903  1792
Test passed: M N K =   455   863   768
Test passed: M N K =   622  1465   896
Test passed: M N K =  1939  1728  1728
Test passed: M N K =  1038   872   640
M N K =  4096  4096   256, Elapsed time =   0.033067 s, Result = 90600000, Performance =   2.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.040131 s, Result = 10b00000, Performance =   4.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.040708 s, Result = 91000000, Performance =   6.33 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.047454 s, Result = 11500000, Performance =   7.24 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.049217 s, Result = 91a00000, Performance =   8.73 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.050999 s, Result = 11f00000, Performance =  10.11 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.062170 s, Result = 92400000, Performance =   9.67 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.066989 s, Result = 12900000, Performance =  10.26 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.070525 s, Result = 92e00000, Performance =  10.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.067899 s, Result = 13300000, Performance =  12.65 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.068450 s, Result = 93800000, Performance =  13.80 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.074062 s, Result = 13d00000, Performance =  13.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.081405 s, Result = 94200000, Performance =  13.72 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.078818 s, Result = 14700000, Performance =  15.26 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.083339 s, Result = 94c00000, Performance =  15.46 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.086755 s, Result = 15100000, Performance =  15.84 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.093066 s, Result = 95600000, Performance =  15.69 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.095940 s, Result = 15b00000, Performance =  16.12 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.099628 s, Result = 96000000, Performance =  16.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.103293 s, Result = 16500000, Performance =  16.63 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.107708 s, Result = 96a00000, Performance =  16.75 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.110674 s, Result = 16f00000, Performance =  17.08 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.116414 s, Result = 97400000, Performance =  16.97 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.119580 s, Result = 17900000, Performance =  17.24 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.124937 s, Result = 97e00000, Performance =  17.19 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.128738 s, Result = 18300000, Performance =  17.35 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.136620 s, Result = 98800000, Performance =  16.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.140230 s, Result = 18d00000, Performance =  17.15 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.143174 s, Result = 99200000, Performance =  17.40 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.146700 s, Result = 19700000, Performance =  17.57 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.152970 s, Result = 99c00000, Performance =  17.41 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.162650 s, Result = 1a100000, Performance =  16.90 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.149395 s, Result = 9a600000, Performance =  18.97 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.156826 s, Result = 1ab00000, Performance =  18.62 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.162388 s, Result = 9b000000, Performance =  18.51 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.161943 s, Result = 1b500000, Performance =  19.10 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.165733 s, Result = 9ba00000, Performance =  19.18 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.174492 s, Result = 1bf00000, Performance =  18.71 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.174976 s, Result = 9c400000, Performance =  19.15 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.178989 s, Result = 1c900000, Performance =  19.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.182800 s, Result = 9ce00000, Performance =  19.27 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.200820 s, Result = 1d300000, Performance =  17.97 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.206183 s, Result = 9d800000, Performance =  17.91 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.208708 s, Result = 1dd00000, Performance =  18.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.204591 s, Result = 9e200000, Performance =  18.89 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.209372 s, Result = 1e700000, Performance =  18.87 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.213212 s, Result = 9ec00000, Performance =  18.94 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.216888 s, Result = 1f100000, Performance =  19.01 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.222348 s, Result = 9f600000, Performance =  18.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.228312 s, Result = 1fb00000, Performance =  18.81 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.235256 s, Result = a0000000, Performance =  18.62 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.240302 s, Result = 20500000, Performance =  18.59 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.244134 s, Result = a0a00000, Performance =  18.65 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.244037 s, Result = 20f00000, Performance =  19.01 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.240919 s, Result = a1400000, Performance =  19.61 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.243440 s, Result = 21900000, Performance =  19.76 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.245901 s, Result = a1e00000, Performance =  19.91 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.255988 s, Result = 22300000, Performance =  19.46 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.251084 s, Result = a2800000, Performance =  20.18 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.254476 s, Result = 22d00000, Performance =  20.25 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.256331 s, Result = a3200000, Performance =  20.44 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.269213 s, Result = 23700000, Performance =  19.78 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.268166 s, Result = a3c00000, Performance =  20.18 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.340628 s, Result = 24100000, Performance =  16.14 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1281   427  1536
Test passed: M N K =  1705  1315   704
Test passed: M N K =   551   357  1344
Test passed: M N K =  1145  1765   704
Test passed: M N K =  1689   962   832
M N K =  4096  4096   256, Elapsed time =   0.026543 s, Result = 00500000, Performance =   3.24 TOPS
M N K =  4096  4096   512, Elapsed time =   0.030186 s, Result = 00a00000, Performance =   5.69 TOPS
M N K =  4096  4096   768, Elapsed time =   0.032780 s, Result = 00f00000, Performance =   7.86 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.033163 s, Result = 01400000, Performance =  10.36 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.046749 s, Result = 01900000, Performance =   9.19 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.042062 s, Result = 01e00000, Performance =  12.25 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.042134 s, Result = 02300000, Performance =  14.27 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.048380 s, Result = 02800000, Performance =  14.20 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.051511 s, Result = 02d00000, Performance =  15.01 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.053574 s, Result = 03200000, Performance =  16.03 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.056297 s, Result = 03700000, Performance =  16.78 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.061359 s, Result = 03c00000, Performance =  16.80 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.063653 s, Result = 04100000, Performance =  17.54 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.067286 s, Result = 04600000, Performance =  17.87 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.073095 s, Result = 04b00000, Performance =  17.63 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.077383 s, Result = 05000000, Performance =  17.76 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.080388 s, Result = 05500000, Performance =  18.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.085058 s, Result = 05a00000, Performance =  18.18 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.089475 s, Result = 05f00000, Performance =  18.24 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.093747 s, Result = 06400000, Performance =  18.33 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.098920 s, Result = 06900000, Performance =  18.24 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.105382 s, Result = 06e00000, Performance =  17.93 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.108468 s, Result = 07300000, Performance =  18.21 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.111890 s, Result = 07800000, Performance =  18.43 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.122080 s, Result = 07d00000, Performance =  17.59 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.119377 s, Result = 08200000, Performance =  18.71 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.125430 s, Result = 08700000, Performance =  18.49 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.129935 s, Result = 08c00000, Performance =  18.51 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.132813 s, Result = 09100000, Performance =  18.76 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.135888 s, Result = 09600000, Performance =  18.96 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.140598 s, Result = 09b00000, Performance =  18.94 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.149372 s, Result = 0a000000, Performance =  18.40 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.137209 s, Result = 0a500000, Performance =  20.66 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.138342 s, Result = 0aa00000, Performance =  21.11 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.143271 s, Result = 0af00000, Performance =  20.98 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.146933 s, Result = 0b400000, Performance =  21.05 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.150982 s, Result = 0b900000, Performance =  21.05 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.154813 s, Result = 0be00000, Performance =  21.08 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.160814 s, Result = 0c300000, Performance =  20.83 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.164356 s, Result = 0c800000, Performance =  20.91 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.168676 s, Result = 0cd00000, Performance =  20.88 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.171877 s, Result = 0d200000, Performance =  20.99 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.177411 s, Result = 0d700000, Performance =  20.82 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.180198 s, Result = 0dc00000, Performance =  20.97 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.182162 s, Result = 0e100000, Performance =  21.22 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.184974 s, Result = 0e600000, Performance =  21.36 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.188855 s, Result = 0eb00000, Performance =  21.38 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.190654 s, Result = 0f000000, Performance =  21.63 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.195794 s, Result = 0f500000, Performance =  21.50 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.201089 s, Result = 0fa00000, Performance =  21.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.206495 s, Result = 0ff00000, Performance =  21.22 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.211413 s, Result = 10400000, Performance =  21.13 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.216954 s, Result = 10900000, Performance =  20.98 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.223021 s, Result = 10e00000, Performance =  20.80 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.223166 s, Result = 11300000, Performance =  21.17 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.224847 s, Result = 11800000, Performance =  21.39 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.226368 s, Result = 11d00000, Performance =  21.63 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.229530 s, Result = 12200000, Performance =  21.71 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.227425 s, Result = 12700000, Performance =  22.28 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.230047 s, Result = 12c00000, Performance =  22.40 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.232473 s, Result = 13100000, Performance =  22.54 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.245883 s, Result = 13600000, Performance =  21.66 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.243662 s, Result = 13b00000, Performance =  22.21 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.309192 s, Result = 14000000, Performance =  17.78 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1850  1266   320
Test passed: M N K =  1135  2015   128
Test passed: M N K =  1989   628  1280
Test passed: M N K =  1201  1533   832
Test passed: M N K =  1877  1422  1536
M N K =  4096  4096   256, Elapsed time =   0.021825 s, Result = a0f00000, Performance =   3.94 TOPS
M N K =  4096  4096   512, Elapsed time =   0.021802 s, Result = a1400000, Performance =   7.88 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023793 s, Result = a1900000, Performance =  10.83 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034447 s, Result = a1e00000, Performance =   9.97 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.039366 s, Result = a2300000, Performance =  10.91 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.042311 s, Result = a2800000, Performance =  12.18 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.044912 s, Result = a2d00000, Performance =  13.39 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.044838 s, Result = a3200000, Performance =  15.33 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.039293 s, Result = a3700000, Performance =  19.68 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041090 s, Result = a3c00000, Performance =  20.91 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.044505 s, Result = a4100000, Performance =  21.23 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.048555 s, Result = a4600000, Performance =  21.23 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.051999 s, Result = a4b00000, Performance =  21.48 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.055505 s, Result = a5000000, Performance =  21.67 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.059847 s, Result = a5500000, Performance =  21.53 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.063014 s, Result = a5a00000, Performance =  21.81 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.066716 s, Result = a5f00000, Performance =  21.89 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.072453 s, Result = a6400000, Performance =  21.34 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.077578 s, Result = a6900000, Performance =  21.04 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.080631 s, Result = a6e00000, Performance =  21.31 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.090725 s, Result = a7300000, Performance =  19.88 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.093729 s, Result = a7800000, Performance =  20.16 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.097620 s, Result = a7d00000, Performance =  20.24 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.099811 s, Result = a8200000, Performance =  20.65 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.105430 s, Result = a8700000, Performance =  20.37 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.108441 s, Result = a8c00000, Performance =  20.60 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.112543 s, Result = a9100000, Performance =  20.61 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.115865 s, Result = a9600000, Performance =  20.76 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.118460 s, Result = a9b00000, Performance =  21.03 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.121481 s, Result = aa000000, Performance =  21.21 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.126482 s, Result = aa500000, Performance =  21.05 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.136170 s, Result = aaa00000, Performance =  20.19 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.125202 s, Result = aaf00000, Performance =  22.64 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.128188 s, Result = ab400000, Performance =  22.78 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.132889 s, Result = ab900000, Performance =  22.62 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.135439 s, Result = abe00000, Performance =  22.83 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.140169 s, Result = ac300000, Performance =  22.67 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.143431 s, Result = ac800000, Performance =  22.76 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.149066 s, Result = acd00000, Performance =  22.47 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.152522 s, Result = ad200000, Performance =  22.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.155240 s, Result = ad700000, Performance =  22.69 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.161876 s, Result = adc00000, Performance =  22.29 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.168153 s, Result = ae100000, Performance =  21.97 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.169927 s, Result = ae600000, Performance =  22.24 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.170762 s, Result = aeb00000, Performance =  22.64 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.173673 s, Result = af000000, Performance =  22.75 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.176794 s, Result = af500000, Performance =  22.84 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.178645 s, Result = afa00000, Performance =  23.08 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.183145 s, Result = aff00000, Performance =  22.98 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.188543 s, Result = b0400000, Performance =  22.78 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.193885 s, Result = b0900000, Performance =  22.60 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.197260 s, Result = b0e00000, Performance =  22.64 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.202039 s, Result = b1300000, Performance =  22.53 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.207847 s, Result = b1800000, Performance =  22.32 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.210999 s, Result = b1d00000, Performance =  22.39 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.211527 s, Result = b2200000, Performance =  22.74 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.214801 s, Result = b2700000, Performance =  22.79 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.223383 s, Result = b2c00000, Performance =  22.30 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.217693 s, Result = b3100000, Performance =  23.28 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.222386 s, Result = b3600000, Performance =  23.18 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.231121 s, Result = b3b00000, Performance =  22.67 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.235360 s, Result = b4000000, Performance =  22.63 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.238859 s, Result = b4500000, Performance =  22.66 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.304886 s, Result = b4a00000, Performance =  18.03 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1888   597  1152
Test passed: M N K =  1440  1038  1920
Test passed: M N K =   510  1209  2048
Test passed: M N K =  2028  1223   704
Test passed: M N K =   918   285  1920
M N K =  4096  4096   256, Elapsed time =   0.002039 s, Result = 00500000, Performance =  42.13 TOPS
M N K =  4096  4096   512, Elapsed time =   0.004141 s, Result = 00a00000, Performance =  41.48 TOPS
M N K =  4096  4096   768, Elapsed time =   0.005470 s, Result = 00f00000, Performance =  47.11 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.006806 s, Result = 01400000, Performance =  50.49 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.007713 s, Result = 01900000, Performance =  55.69 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009276 s, Result = 01e00000, Performance =  55.56 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011131 s, Result = 02300000, Performance =  54.02 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013840 s, Result = 02800000, Performance =  49.65 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014941 s, Result = 02d00000, Performance =  51.74 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016669 s, Result = 03200000, Performance =  51.53 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.019491 s, Result = 03700000, Performance =  48.48 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.022086 s, Result = 03c00000, Performance =  46.67 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.025258 s, Result = 04100000, Performance =  44.21 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.028434 s, Result = 04600000, Performance =  42.29 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.033264 s, Result = 04b00000, Performance =  38.74 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.039224 s, Result = 05000000, Performance =  35.04 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.041825 s, Result = 05500000, Performance =  34.91 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.044386 s, Result = 05a00000, Performance =  34.84 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.054697 s, Result = 05f00000, Performance =  29.84 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060181 s, Result = 06400000, Performance =  28.55 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.064636 s, Result = 06900000, Performance =  27.91 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.067337 s, Result = 06e00000, Performance =  28.06 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.071278 s, Result = 07300000, Performance =  27.72 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.073939 s, Result = 07800000, Performance =  27.88 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.079756 s, Result = 07d00000, Performance =  26.93 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.083219 s, Result = 08200000, Performance =  26.84 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.088070 s, Result = 08700000, Performance =  26.33 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.091605 s, Result = 08c00000, Performance =  26.26 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.094907 s, Result = 09100000, Performance =  26.25 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.098868 s, Result = 09600000, Performance =  26.06 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.103246 s, Result = 09b00000, Performance =  25.79 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.108195 s, Result = 0a000000, Performance =  25.41 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.102002 s, Result = 0a500000, Performance =  27.79 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.104466 s, Result = 0aa00000, Performance =  27.96 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.108776 s, Result = 0af00000, Performance =  27.64 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.111251 s, Result = 0b400000, Performance =  27.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.114742 s, Result = 0b900000, Performance =  27.70 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.118764 s, Result = 0be00000, Performance =  27.48 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.123700 s, Result = 0c300000, Performance =  27.08 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.126134 s, Result = 0c800000, Performance =  27.24 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.130766 s, Result = 0cd00000, Performance =  26.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.134857 s, Result = 0d200000, Performance =  26.75 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.139916 s, Result = 0d700000, Performance =  26.40 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.143882 s, Result = 0dc00000, Performance =  26.27 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.144753 s, Result = 0e100000, Performance =  26.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.148567 s, Result = 0e600000, Performance =  26.60 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.149885 s, Result = 0eb00000, Performance =  26.94 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.152754 s, Result = 0f000000, Performance =  26.99 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.157079 s, Result = 0f500000, Performance =  26.80 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.162108 s, Result = 0fa00000, Performance =  26.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.168529 s, Result = 0ff00000, Performance =  25.99 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.171519 s, Result = 10400000, Performance =  26.04 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.177006 s, Result = 10900000, Performance =  25.72 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.183076 s, Result = 10e00000, Performance =  25.34 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.185363 s, Result = 11300000, Performance =  25.49 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.186139 s, Result = 11800000, Performance =  25.84 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.189709 s, Result = 11d00000, Performance =  25.81 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.193666 s, Result = 12200000, Performance =  25.73 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.197896 s, Result = 12700000, Performance =  25.61 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.194097 s, Result = 12c00000, Performance =  26.55 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.196587 s, Result = 13100000, Performance =  26.65 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.211111 s, Result = 13600000, Performance =  25.23 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.208219 s, Result = 13b00000, Performance =  25.99 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.271505 s, Result = 14000000, Performance =  20.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1902  1341   960
Test passed: M N K =   947   764  1536
Test passed: M N K =  1124  1299   384
Test passed: M N K =    83  1404  1600
Test passed: M N K =   997   963  1856
M N K =  4096  4096   256, Elapsed time =   0.032372 s, Result = 90600000, Performance =   2.65 TOPS
M N K =  4096  4096   512, Elapsed time =   0.039690 s, Result = 10b00000, Performance =   4.33 TOPS
M N K =  4096  4096   768, Elapsed time =   0.040579 s, Result = 91000000, Performance =   6.35 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.041603 s, Result = 11500000, Performance =   8.26 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.047927 s, Result = 91a00000, Performance =   8.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.049391 s, Result = 11f00000, Performance =  10.43 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.051631 s, Result = 92400000, Performance =  11.65 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.054657 s, Result = 12900000, Performance =  12.57 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.060321 s, Result = 92e00000, Performance =  12.82 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.061471 s, Result = 13300000, Performance =  13.97 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.066243 s, Result = 93800000, Performance =  14.26 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.068539 s, Result = 13d00000, Performance =  15.04 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.073858 s, Result = 94200000, Performance =  15.12 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.074146 s, Result = 14700000, Performance =  16.22 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.079437 s, Result = 94c00000, Performance =  16.22 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.082593 s, Result = 15100000, Performance =  16.64 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.087094 s, Result = 95600000, Performance =  16.77 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.090817 s, Result = 15b00000, Performance =  17.03 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.093545 s, Result = 96000000, Performance =  17.45 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.097255 s, Result = 16500000, Performance =  17.66 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.101632 s, Result = 96a00000, Performance =  17.75 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.105417 s, Result = 16f00000, Performance =  17.93 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.107608 s, Result = 97400000, Performance =  18.36 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.113397 s, Result = 17900000, Performance =  18.18 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.117233 s, Result = 97e00000, Performance =  18.32 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.119602 s, Result = 18300000, Performance =  18.67 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.122742 s, Result = 98800000, Performance =  18.90 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.127623 s, Result = 18d00000, Performance =  18.85 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.130776 s, Result = 99200000, Performance =  19.05 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.135632 s, Result = 19700000, Performance =  19.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.139589 s, Result = 99c00000, Performance =  19.08 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.162021 s, Result = 1a100000, Performance =  16.97 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.144649 s, Result = 9a600000, Performance =  19.60 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.137277 s, Result = 1ab00000, Performance =  21.28 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.142148 s, Result = 9b000000, Performance =  21.15 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.147509 s, Result = 1b500000, Performance =  20.96 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.153914 s, Result = 9ba00000, Performance =  20.65 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.158856 s, Result = 1bf00000, Performance =  20.55 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.163718 s, Result = 9c400000, Performance =  20.46 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.165761 s, Result = 1c900000, Performance =  20.73 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.168261 s, Result = 9ce00000, Performance =  20.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.174542 s, Result = 1d300000, Performance =  20.67 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.180667 s, Result = 9d800000, Performance =  20.44 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.180804 s, Result = 1dd00000, Performance =  20.90 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.182591 s, Result = 9e200000, Performance =  21.17 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.189971 s, Result = 1e700000, Performance =  20.80 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.194030 s, Result = 9ec00000, Performance =  20.81 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.194128 s, Result = 1f100000, Performance =  21.24 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.199697 s, Result = 9f600000, Performance =  21.08 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.201297 s, Result = 1fb00000, Performance =  21.34 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.207841 s, Result = a0000000, Performance =  21.08 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.209777 s, Result = 20500000, Performance =  21.29 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.215123 s, Result = a0a00000, Performance =  21.16 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.221465 s, Result = 20f00000, Performance =  20.94 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.223245 s, Result = a1400000, Performance =  21.16 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.222925 s, Result = 21900000, Performance =  21.58 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.226982 s, Result = a1e00000, Performance =  21.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.232533 s, Result = 22300000, Performance =  21.43 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.232125 s, Result = a2800000, Performance =  21.83 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.229590 s, Result = 22d00000, Performance =  22.45 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.238588 s, Result = a3200000, Performance =  21.96 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.245289 s, Result = 23700000, Performance =  21.71 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.255639 s, Result = a3c00000, Performance =  21.17 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.340222 s, Result = 24100000, Performance =  16.16 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   197  1371  1536
Test passed: M N K =  1008   373  2048
Test passed: M N K =  1098  1507  1792
Test passed: M N K =  1647  1915  1408
Test passed: M N K =  2016  1354  1216
M N K =  4096  4096   256, Elapsed time =   0.029471 s, Result = 00500000, Performance =   2.91 TOPS
M N K =  4096  4096   512, Elapsed time =   0.027497 s, Result = 00a00000, Performance =   6.25 TOPS
M N K =  4096  4096   768, Elapsed time =   0.031023 s, Result = 00f00000, Performance =   8.31 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034084 s, Result = 01400000, Performance =  10.08 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.035449 s, Result = 01900000, Performance =  12.12 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.041226 s, Result = 01e00000, Performance =  12.50 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.043560 s, Result = 02300000, Performance =  13.80 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.042140 s, Result = 02800000, Performance =  16.31 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.048165 s, Result = 02d00000, Performance =  16.05 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.052168 s, Result = 03200000, Performance =  16.47 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.053266 s, Result = 03700000, Performance =  17.74 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.056136 s, Result = 03c00000, Performance =  18.36 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.062492 s, Result = 04100000, Performance =  17.87 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.064635 s, Result = 04600000, Performance =  18.61 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.069596 s, Result = 04b00000, Performance =  18.51 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.073583 s, Result = 05000000, Performance =  18.68 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.076875 s, Result = 05500000, Performance =  19.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.080291 s, Result = 05a00000, Performance =  19.26 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.084764 s, Result = 05f00000, Performance =  19.25 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.089502 s, Result = 06400000, Performance =  19.19 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.093233 s, Result = 06900000, Performance =  19.35 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.097215 s, Result = 06e00000, Performance =  19.44 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.102384 s, Result = 07300000, Performance =  19.30 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.105277 s, Result = 07800000, Performance =  19.58 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.108539 s, Result = 07d00000, Performance =  19.79 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.112428 s, Result = 08200000, Performance =  19.86 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.115951 s, Result = 08700000, Performance =  20.00 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.120075 s, Result = 08c00000, Performance =  20.03 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.123274 s, Result = 09100000, Performance =  20.21 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.126366 s, Result = 09600000, Performance =  20.39 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.129648 s, Result = 09b00000, Performance =  20.54 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.148493 s, Result = 0a000000, Performance =  18.51 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.134347 s, Result = 0a500000, Performance =  21.10 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.130164 s, Result = 0aa00000, Performance =  22.44 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.132106 s, Result = 0af00000, Performance =  22.76 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.142608 s, Result = 0b400000, Performance =  21.68 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.141115 s, Result = 0b900000, Performance =  22.52 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.144875 s, Result = 0be00000, Performance =  22.53 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.147584 s, Result = 0c300000, Performance =  22.70 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.149584 s, Result = 0c800000, Performance =  22.97 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.154281 s, Result = 0cd00000, Performance =  22.83 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.158248 s, Result = 0d200000, Performance =  22.80 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.162780 s, Result = 0d700000, Performance =  22.69 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.164697 s, Result = 0dc00000, Performance =  22.95 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.166214 s, Result = 0e100000, Performance =  23.26 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.170403 s, Result = 0e600000, Performance =  23.19 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.174366 s, Result = 0eb00000, Performance =  23.15 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.176234 s, Result = 0f000000, Performance =  23.40 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.180356 s, Result = 0f500000, Performance =  23.34 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.184255 s, Result = 0fa00000, Performance =  23.31 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.188474 s, Result = 0ff00000, Performance =  23.24 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.187786 s, Result = 10400000, Performance =  23.79 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.192392 s, Result = 10900000, Performance =  23.66 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.196405 s, Result = 10e00000, Performance =  23.62 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.197012 s, Result = 11300000, Performance =  23.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.197288 s, Result = 11800000, Performance =  24.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.202220 s, Result = 11d00000, Performance =  24.21 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.207750 s, Result = 12200000, Performance =  23.98 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.206767 s, Result = 12700000, Performance =  24.51 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.207327 s, Result = 12c00000, Performance =  24.86 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.216054 s, Result = 13100000, Performance =  24.25 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.219354 s, Result = 13600000, Performance =  24.28 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.231636 s, Result = 13b00000, Performance =  23.36 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.315699 s, Result = 14000000, Performance =  17.41 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   986   514  1024
Test passed: M N K =  1813  1604  1408
Test passed: M N K =  1579   496  2048
Test passed: M N K =  1391   440  1792
Test passed: M N K =  1988  1494   512
M N K =  4096  4096   256, Elapsed time =   0.026416 s, Result = a0f00000, Performance =   3.25 TOPS
M N K =  4096  4096   512, Elapsed time =   0.022096 s, Result = a1400000, Performance =   7.78 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023699 s, Result = a1900000, Performance =  10.87 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.025610 s, Result = a1e00000, Performance =  13.42 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029046 s, Result = a2300000, Performance =  14.79 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031645 s, Result = a2800000, Performance =  16.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.034284 s, Result = a2d00000, Performance =  17.54 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.034196 s, Result = a3200000, Performance =  20.10 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.039339 s, Result = a3700000, Performance =  19.65 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041042 s, Result = a3c00000, Performance =  20.93 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.043512 s, Result = a4100000, Performance =  21.72 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.046413 s, Result = a4600000, Performance =  22.21 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.050306 s, Result = a4b00000, Performance =  22.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.053216 s, Result = a5000000, Performance =  22.60 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.057426 s, Result = a5500000, Performance =  22.44 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.060613 s, Result = a5a00000, Performance =  22.67 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.065193 s, Result = a5f00000, Performance =  22.40 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067399 s, Result = a6400000, Performance =  22.94 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071187 s, Result = a6900000, Performance =  22.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074672 s, Result = a6e00000, Performance =  23.01 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.078954 s, Result = a7300000, Performance =  22.85 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.081984 s, Result = a7800000, Performance =  23.05 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.092335 s, Result = a7d00000, Performance =  21.40 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.095800 s, Result = a8200000, Performance =  21.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.106777 s, Result = a8700000, Performance =  20.11 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.102887 s, Result = a8c00000, Performance =  21.71 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.106075 s, Result = a9100000, Performance =  21.86 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.109056 s, Result = a9600000, Performance =  22.05 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.110087 s, Result = a9b00000, Performance =  22.63 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.114623 s, Result = aa000000, Performance =  22.48 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.117675 s, Result = aa500000, Performance =  22.63 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.137012 s, Result = aaa00000, Performance =  20.06 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.123004 s, Result = aaf00000, Performance =  23.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.119105 s, Result = ab400000, Performance =  24.52 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.122039 s, Result = ab900000, Performance =  24.64 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.124362 s, Result = abe00000, Performance =  24.87 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.129697 s, Result = ac300000, Performance =  24.51 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.132734 s, Result = ac800000, Performance =  24.59 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.136647 s, Result = acd00000, Performance =  24.52 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.139833 s, Result = ad200000, Performance =  24.57 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.144832 s, Result = ad700000, Performance =  24.32 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.147201 s, Result = adc00000, Performance =  24.51 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.153722 s, Result = ae100000, Performance =  24.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.152271 s, Result = ae600000, Performance =  24.82 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.154954 s, Result = aeb00000, Performance =  24.95 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.158994 s, Result = af000000, Performance =  24.85 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.163271 s, Result = af500000, Performance =  24.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.162883 s, Result = afa00000, Performance =  25.31 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.167148 s, Result = aff00000, Performance =  25.18 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.173520 s, Result = b0400000, Performance =  24.75 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.176741 s, Result = b0900000, Performance =  24.79 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.180336 s, Result = b0e00000, Performance =  24.77 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.180182 s, Result = b1300000, Performance =  25.27 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.185763 s, Result = b1800000, Performance =  24.97 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.190199 s, Result = b1d00000, Performance =  24.84 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.189512 s, Result = b2200000, Performance =  25.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.196301 s, Result = b2700000, Performance =  24.94 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.200839 s, Result = b2c00000, Performance =  24.81 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.199916 s, Result = b3100000, Performance =  25.35 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.199161 s, Result = b3600000, Performance =  25.88 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.207301 s, Result = b3b00000, Performance =  25.28 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.212220 s, Result = b4000000, Performance =  25.10 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.225202 s, Result = b4500000, Performance =  24.03 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.308979 s, Result = b4a00000, Performance =  17.79 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   986   514  1024
Test passed: M N K =  1813  1604  1408
Test passed: M N K =  1579   496  2048
Test passed: M N K =  1391   440  1792
Test passed: M N K =  1988  1494   512
M N K =  4096  4096   256, Elapsed time =   0.026416 s, Result = a0f00000, Performance =  0.00 TOPS
M N K =  4096  4096   512, Elapsed time =   0.022096 s, Result = a1400000, Performance =  0.00 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023699 s, Result = a1900000, Performance =  0.00 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.025610 s, Result = a1e00000, Performance =  0.00 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029046 s, Result = a2300000, Performance =  0.00 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031645 s, Result = a2800000, Performance =  0.00 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.034284 s, Result = a2d00000, Performance =  0.00 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.034196 s, Result = a3200000, Performance =  0.00 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.039339 s, Result = a3700000, Performance =  0.00 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041042 s, Result = a3c00000, Performance =  0.00 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.043512 s, Result = a4100000, Performance =  0.00 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.046413 s, Result = a4600000, Performance =  0.00 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.050306 s, Result = a4b00000, Performance =  0.00 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.053216 s, Result = a5000000, Performance =  0.00 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.057426 s, Result = a5500000, Performance =  0.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.060613 s, Result = a5a00000, Performance =  0.00 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.065193 s, Result = a5f00000, Performance =  0.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067399 s, Result = a6400000, Performance =  0.00 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071187 s, Result = a6900000, Performance =  0.00 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074672 s, Result = a6e00000, Performance =  0.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.078954 s, Result = a7300000, Performance =  0.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.081984 s, Result = a7800000, Performance =  0.00 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.092335 s, Result = a7d00000, Performance =  0.00 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.095800 s, Result = a8200000, Performance =  0.00 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.106777 s, Result = a8700000, Performance =  0.00 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.102887 s, Result = a8c00000, Performance =  0.00 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.106075 s, Result = a9100000, Performance =  0.00 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.109056 s, Result = a9600000, Performance =  0.00 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.110087 s, Result = a9b00000, Performance =  0.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.114623 s, Result = aa000000, Performance =  0.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.117675 s, Result = aa500000, Performance =  0.00 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.137012 s, Result = aaa00000, Performance =  0.00 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.123004 s, Result = aaf00000, Performance =  0.00 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.119105 s, Result = ab400000, Performance =  0.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.122039 s, Result = ab900000, Performance =  0.00 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.124362 s, Result = abe00000, Performance =  0.00 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.129697 s, Result = ac300000, Performance =  0.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.132734 s, Result = ac800000, Performance =  0.00 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.136647 s, Result = acd00000, Performance =  0.00 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.139833 s, Result = ad200000, Performance =  0.00 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.144832 s, Result = ad700000, Performance =  0.00 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.147201 s, Result = adc00000, Performance =  0.00 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.153722 s, Result = ae100000, Performance =  0.00 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.152271 s, Result = ae600000, Performance =  0.00 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.154954 s, Result = aeb00000, Performance =  0.00 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.158994 s, Result = af000000, Performance =  0.00 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.163271 s, Result = af500000, Performance =  0.00 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.162883 s, Result = afa00000, Performance =  0.00 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.167148 s, Result = aff00000, Performance =  0.00 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.173520 s, Result = b0400000, Performance =  0.00 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.176741 s, Result = b0900000, Performance =  0.00 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.180336 s, Result = b0e00000, Performance =  0.00 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.180182 s, Result = b1300000, Performance =  0.00 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.185763 s, Result = b1800000, Performance =  0.00 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.190199 s, Result = b1d00000, Performance =  0.00 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.189512 s, Result = b2200000, Performance =  0.00 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.196301 s, Result = b2700000, Performance =  0.00 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.200839 s, Result = b2c00000, Performance =  0.00 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.199916 s, Result = b3100000, Performance =  0.00 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.199161 s, Result = b3600000, Performance =  0.00 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.207301 s, Result = b3b00000, Performance =  0.00 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.212220 s, Result = b4000000, Performance =  0.00 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.225202 s, Result = b4500000, Performance =  0.00 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.308979 s, Result = b4a00000, Performance =  0.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   986   514  1024
Test passed: M N K =  1813  1604  1408
Test passed: M N K =  1579   496  2048
Test passed: M N K =  1391   440  1792
Test passed: M N K =  1988  1494   512
M N K =  4096  4096   256, Elapsed time =   0.026416 s, Result = a0f00000, Performance =  0.00 TOPS
M N K =  4096  4096   512, Elapsed time =   0.022096 s, Result = a1400000, Performance =  0.00 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023699 s, Result = a1900000, Performance =  0.00 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.025610 s, Result = a1e00000, Performance =  0.00 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029046 s, Result = a2300000, Performance =  0.00 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031645 s, Result = a2800000, Performance =  0.00 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.034284 s, Result = a2d00000, Performance =  0.00 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.034196 s, Result = a3200000, Performance =  0.00 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.039339 s, Result = a3700000, Performance =  0.00 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041042 s, Result = a3c00000, Performance =  0.00 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.043512 s, Result = a4100000, Performance =  0.00 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.046413 s, Result = a4600000, Performance =  0.00 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.050306 s, Result = a4b00000, Performance =  0.00 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.053216 s, Result = a5000000, Performance =  0.00 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.057426 s, Result = a5500000, Performance =  0.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.060613 s, Result = a5a00000, Performance =  0.00 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.065193 s, Result = a5f00000, Performance =  0.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067399 s, Result = a6400000, Performance =  0.00 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071187 s, Result = a6900000, Performance =  0.00 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074672 s, Result = a6e00000, Performance =  0.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.078954 s, Result = a7300000, Performance =  0.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.081984 s, Result = a7800000, Performance =  0.00 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.092335 s, Result = a7d00000, Performance =  0.00 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.095800 s, Result = a8200000, Performance =  0.00 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.106777 s, Result = a8700000, Performance =  0.00 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.102887 s, Result = a8c00000, Performance =  0.00 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.106075 s, Result = a9100000, Performance =  0.00 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.109056 s, Result = a9600000, Performance =  0.00 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.110087 s, Result = a9b00000, Performance =  0.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.114623 s, Result = aa000000, Performance =  0.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.117675 s, Result = aa500000, Performance =  0.00 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.137012 s, Result = aaa00000, Performance =  0.00 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.123004 s, Result = aaf00000, Performance =  0.00 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.119105 s, Result = ab400000, Performance =  0.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.122039 s, Result = ab900000, Performance =  0.00 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.124362 s, Result = abe00000, Performance =  0.00 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.129697 s, Result = ac300000, Performance =  0.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.132734 s, Result = ac800000, Performance =  0.00 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.136647 s, Result = acd00000, Performance =  0.00 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.139833 s, Result = ad200000, Performance =  0.00 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.144832 s, Result = ad700000, Performance =  0.00 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.147201 s, Result = adc00000, Performance =  0.00 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.153722 s, Result = ae100000, Performance =  0.00 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.152271 s, Result = ae600000, Performance =  0.00 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.154954 s, Result = aeb00000, Performance =  0.00 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.158994 s, Result = af000000, Performance =  0.00 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.163271 s, Result = af500000, Performance =  0.00 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.162883 s, Result = afa00000, Performance =  0.00 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.167148 s, Result = aff00000, Performance =  0.00 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.173520 s, Result = b0400000, Performance =  0.00 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.176741 s, Result = b0900000, Performance =  0.00 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.180336 s, Result = b0e00000, Performance =  0.00 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.180182 s, Result = b1300000, Performance =  0.00 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.185763 s, Result = b1800000, Performance =  0.00 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.190199 s, Result = b1d00000, Performance =  0.00 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.189512 s, Result = b2200000, Performance =  0.00 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.196301 s, Result = b2700000, Performance =  0.00 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.200839 s, Result = b2c00000, Performance =  0.00 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.199916 s, Result = b3100000, Performance =  0.00 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.199161 s, Result = b3600000, Performance =  0.00 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.207301 s, Result = b3b00000, Performance =  0.00 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.212220 s, Result = b4000000, Performance =  0.00 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.225202 s, Result = b4500000, Performance =  0.00 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.308979 s, Result = b4a00000, Performance =  0.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1661   454   704
Test passed: M N K =  2031   691  1152
Test passed: M N K =   935  1577  1024
Test passed: M N K =  1276  1099   128
Test passed: M N K =   107   242  1408
M N K =  4096  4096   256, Elapsed time =   0.031611 s, Result = 00500000, Performance =   2.72 TOPS
M N K =  4096  4096   512, Elapsed time =   0.029215 s, Result = 00a00000, Performance =   5.88 TOPS
M N K =  4096  4096   768, Elapsed time =   0.033271 s, Result = 00f00000, Performance =   7.75 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.036747 s, Result = 01400000, Performance =   9.35 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.039875 s, Result = 01900000, Performance =  10.77 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.054473 s, Result = 01e00000, Performance =   9.46 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.042607 s, Result = 02300000, Performance =  14.11 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.041830 s, Result = 02800000, Performance =  16.43 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.046677 s, Result = 02d00000, Performance =  16.56 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.050033 s, Result = 03200000, Performance =  17.17 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.055845 s, Result = 03700000, Performance =  16.92 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.057274 s, Result = 03c00000, Performance =  18.00 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.058126 s, Result = 04100000, Performance =  19.21 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.063062 s, Result = 04600000, Performance =  19.07 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.066001 s, Result = 04b00000, Performance =  19.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.069902 s, Result = 05000000, Performance =  19.66 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.074655 s, Result = 05500000, Performance =  19.56 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.081815 s, Result = 05a00000, Performance =  18.90 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.086975 s, Result = 05f00000, Performance =  18.77 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.088666 s, Result = 06400000, Performance =  19.38 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.093895 s, Result = 06900000, Performance =  19.21 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.095674 s, Result = 06e00000, Performance =  19.75 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.099507 s, Result = 07300000, Performance =  19.85 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.103297 s, Result = 07800000, Performance =  19.96 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.106122 s, Result = 07d00000, Performance =  20.24 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.109232 s, Result = 08200000, Performance =  20.45 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.112681 s, Result = 08700000, Performance =  20.58 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.113924 s, Result = 08c00000, Performance =  21.11 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.117719 s, Result = 09100000, Performance =  21.16 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.120011 s, Result = 09600000, Performance =  21.47 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.123529 s, Result = 09b00000, Performance =  21.56 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.141186 s, Result = 0a000000, Performance =  19.47 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.128470 s, Result = 0a500000, Performance =  22.06 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.132680 s, Result = 0aa00000, Performance =  22.01 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.133426 s, Result = 0af00000, Performance =  22.53 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.132115 s, Result = 0b400000, Performance =  23.41 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.135198 s, Result = 0b900000, Performance =  23.51 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.138409 s, Result = 0be00000, Performance =  23.58 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.141562 s, Result = 0c300000, Performance =  23.67 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.143987 s, Result = 0c800000, Performance =  23.86 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.147658 s, Result = 0cd00000, Performance =  23.85 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.154435 s, Result = 0d200000, Performance =  23.36 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.161625 s, Result = 0d700000, Performance =  22.85 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.156117 s, Result = 0dc00000, Performance =  24.21 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.160449 s, Result = 0e100000, Performance =  24.09 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.163258 s, Result = 0e600000, Performance =  24.20 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.166978 s, Result = 0eb00000, Performance =  24.18 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.169719 s, Result = 0f000000, Performance =  24.29 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.171054 s, Result = 0f500000, Performance =  24.61 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.174939 s, Result = 0fa00000, Performance =  24.55 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.185454 s, Result = 0ff00000, Performance =  23.62 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.182255 s, Result = 10400000, Performance =  24.51 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.188676 s, Result = 10900000, Performance =  24.13 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.194180 s, Result = 10e00000, Performance =  23.89 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.201729 s, Result = 11300000, Performance =  23.42 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.204642 s, Result = 11800000, Performance =  23.51 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.212034 s, Result = 11d00000, Performance =  23.09 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.213420 s, Result = 12200000, Performance =  23.34 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.213036 s, Result = 12700000, Performance =  23.79 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.209353 s, Result = 12c00000, Performance =  24.62 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.219725 s, Result = 13100000, Performance =  23.85 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.226441 s, Result = 13600000, Performance =  23.52 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.229240 s, Result = 13b00000, Performance =  23.61 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.315599 s, Result = 14000000, Performance =  17.42 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1233   683   832
Test passed: M N K =   907   766   896
Test passed: M N K =   264   770   896
Test passed: M N K =   320   910   960
Test passed: M N K =   644   158  1408
M N K =  4096  4096   256, Elapsed time =   0.025469 s, Result = a0f00000, Performance =   3.37 TOPS
M N K =  4096  4096   512, Elapsed time =   0.022505 s, Result = a1400000, Performance =   7.63 TOPS
M N K =  4096  4096   768, Elapsed time =   0.024402 s, Result = a1900000, Performance =  10.56 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034784 s, Result = a1e00000, Performance =   9.88 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038613 s, Result = a2300000, Performance =  11.12 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040121 s, Result = a2800000, Performance =  12.85 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.042161 s, Result = a2d00000, Performance =  14.26 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.043441 s, Result = a3200000, Performance =  15.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037594 s, Result = a3700000, Performance =  20.56 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.040204 s, Result = a3c00000, Performance =  21.37 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.042985 s, Result = a4100000, Performance =  21.98 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.045464 s, Result = a4600000, Performance =  22.67 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.049080 s, Result = a4b00000, Performance =  22.75 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.051089 s, Result = a5000000, Performance =  23.54 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.055707 s, Result = a5500000, Performance =  23.13 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.057285 s, Result = a5a00000, Performance =  23.99 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.062769 s, Result = a5f00000, Performance =  23.26 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.066747 s, Result = a6400000, Performance =  23.17 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071285 s, Result = a6900000, Performance =  22.90 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.077602 s, Result = a6e00000, Performance =  22.14 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.083436 s, Result = a7300000, Performance =  21.62 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.087206 s, Result = a7800000, Performance =  21.67 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.091571 s, Result = a7d00000, Performance =  21.58 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.095457 s, Result = a8200000, Performance =  21.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.098295 s, Result = a8700000, Performance =  21.85 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.100693 s, Result = a8c00000, Performance =  22.18 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.104018 s, Result = a9100000, Performance =  22.30 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.106077 s, Result = a9600000, Performance =  22.67 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.109328 s, Result = a9b00000, Performance =  22.79 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.111302 s, Result = aa000000, Performance =  23.15 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.114503 s, Result = aa500000, Performance =  23.26 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.131732 s, Result = aaa00000, Performance =  20.87 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.121223 s, Result = aaf00000, Performance =  23.38 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.124860 s, Result = ab400000, Performance =  23.39 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.125724 s, Result = ab900000, Performance =  23.91 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.123853 s, Result = abe00000, Performance =  24.97 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.127510 s, Result = ac300000, Performance =  24.93 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.130430 s, Result = ac800000, Performance =  25.03 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.134226 s, Result = acd00000, Performance =  24.96 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.135808 s, Result = ad200000, Performance =  25.30 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.140786 s, Result = ad700000, Performance =  25.02 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.146092 s, Result = adc00000, Performance =  24.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.154790 s, Result = ae100000, Performance =  23.86 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.142892 s, Result = ae600000, Performance =  26.45 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.146854 s, Result = aeb00000, Performance =  26.32 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.149086 s, Result = af000000, Performance =  26.50 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.155598 s, Result = af500000, Performance =  25.95 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.156079 s, Result = afa00000, Performance =  26.42 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.159785 s, Result = aff00000, Performance =  26.34 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.167210 s, Result = b0400000, Performance =  25.69 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.176640 s, Result = b0900000, Performance =  24.80 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.174520 s, Result = b0e00000, Performance =  25.59 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.176747 s, Result = b1300000, Performance =  25.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.181974 s, Result = b1800000, Performance =  25.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.187820 s, Result = b1d00000, Performance =  25.15 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.188654 s, Result = b2200000, Performance =  25.50 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.199569 s, Result = b2700000, Performance =  24.53 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.200608 s, Result = b2c00000, Performance =  24.84 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.204309 s, Result = b3100000, Performance =  24.81 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.196074 s, Result = b3600000, Performance =  26.29 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.213623 s, Result = b3b00000, Performance =  24.53 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.213959 s, Result = b4000000, Performance =  24.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.220930 s, Result = b4500000, Performance =  24.49 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.296655 s, Result = b4a00000, Performance =  18.53 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1225  1786   704
Test passed: M N K =    70  1874   640
Test passed: M N K =   436   952  1536
Test passed: M N K =  1574   528  1856
Test passed: M N K =  1001  1906  1536
M N K =  4096  4096   256, Elapsed time =   0.002016 s, Result = 00500000, Performance =  42.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003974 s, Result = 00a00000, Performance =  43.23 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012337 s, Result = 00f00000, Performance =  20.89 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.006168 s, Result = 01400000, Performance =  55.71 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.013905 s, Result = 01900000, Performance =  30.89 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.010383 s, Result = 01e00000, Performance =  49.64 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011195 s, Result = 02300000, Performance =  53.71 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.030247 s, Result = 02800000, Performance =  22.72 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.024196 s, Result = 02d00000, Performance =  31.95 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.026345 s, Result = 03200000, Performance =  32.61 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.028075 s, Result = 03700000, Performance =  33.66 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.022329 s, Result = 03c00000, Performance =  46.16 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.032954 s, Result = 04100000, Performance =  33.89 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.025267 s, Result = 04600000, Performance =  47.59 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.028525 s, Result = 04b00000, Performance =  45.17 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.031666 s, Result = 05000000, Performance =  43.40 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.038784 s, Result = 05500000, Performance =  37.65 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.044466 s, Result = 05a00000, Performance =  34.77 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.045407 s, Result = 05f00000, Performance =  35.94 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.046532 s, Result = 06400000, Performance =  36.92 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.051229 s, Result = 06900000, Performance =  35.21 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.057960 s, Result = 06e00000, Performance =  32.61 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.063670 s, Result = 07300000, Performance =  31.03 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.068416 s, Result = 07800000, Performance =  30.13 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069775 s, Result = 07d00000, Performance =  30.78 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.074413 s, Result = 08200000, Performance =  30.01 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.076646 s, Result = 08700000, Performance =  30.26 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.080101 s, Result = 08c00000, Performance =  30.03 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.082365 s, Result = 09100000, Performance =  30.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.085110 s, Result = 09600000, Performance =  30.28 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.087887 s, Result = 09b00000, Performance =  30.30 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.102574 s, Result = 0a000000, Performance =  26.80 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.094780 s, Result = 0a500000, Performance =  29.91 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.098168 s, Result = 0aa00000, Performance =  29.75 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.098969 s, Result = 0af00000, Performance =  30.38 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.097739 s, Result = 0b400000, Performance =  31.64 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.100658 s, Result = 0b900000, Performance =  31.58 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.103093 s, Result = 0be00000, Performance =  31.66 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.107047 s, Result = 0c300000, Performance =  31.30 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.108415 s, Result = 0c800000, Performance =  31.69 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.112197 s, Result = 0cd00000, Performance =  31.39 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.116791 s, Result = 0d200000, Performance =  30.89 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.123957 s, Result = 0d700000, Performance =  29.80 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.117832 s, Result = 0dc00000, Performance =  32.08 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.122375 s, Result = 0e100000, Performance =  31.59 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.125559 s, Result = 0e600000, Performance =  31.47 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.128598 s, Result = 0eb00000, Performance =  31.39 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.130733 s, Result = 0f000000, Performance =  31.54 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.132980 s, Result = 0f500000, Performance =  31.65 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.138777 s, Result = 0fa00000, Performance =  30.95 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.148574 s, Result = 0ff00000, Performance =  29.49 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.144130 s, Result = 10400000, Performance =  30.99 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.152001 s, Result = 10900000, Performance =  29.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.157339 s, Result = 10e00000, Performance =  29.48 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.162245 s, Result = 11300000, Performance =  29.12 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.165255 s, Result = 11800000, Performance =  29.11 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.174767 s, Result = 11d00000, Performance =  28.02 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.176030 s, Result = 12200000, Performance =  28.30 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.175989 s, Result = 12700000, Performance =  28.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.174302 s, Result = 12c00000, Performance =  29.57 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.179646 s, Result = 13100000, Performance =  29.17 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.204603 s, Result = 13600000, Performance =  26.03 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.190454 s, Result = 13b00000, Performance =  28.41 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.262290 s, Result = 14000000, Performance =  20.96 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   525   189   960
Test passed: M N K =   800  1354  1984
Test passed: M N K =  1076   645    64
Test passed: M N K =   712   382   960
Test passed: M N K =   940  1456  1216
M N K =  4096  4096   256, Elapsed time =   0.028184 s, Result = d04c0000, Performance =   3.05 TOPS
M N K =  4096  4096   512, Elapsed time =   0.030128 s, Result = 90880000, Performance =   5.70 TOPS
M N K =  4096  4096   768, Elapsed time =   0.032332 s, Result = 50c40000, Performance =   7.97 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034942 s, Result = 11000000, Performance =   9.83 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.037063 s, Result = d13c0000, Performance =  11.59 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.039851 s, Result = 91780000, Performance =  12.93 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.043111 s, Result = 51b40000, Performance =  13.95 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.047812 s, Result = 11f00000, Performance =  14.37 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.050456 s, Result = d22c0000, Performance =  15.32 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.060792 s, Result = 92680000, Performance =  14.13 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.060107 s, Result = 52a40000, Performance =  15.72 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.061573 s, Result = 12e00000, Performance =  16.74 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.065159 s, Result = d31c0000, Performance =  17.14 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.068920 s, Result = 93580000, Performance =  17.45 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.073211 s, Result = 53940000, Performance =  17.60 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.077507 s, Result = 13d00000, Performance =  17.73 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.080324 s, Result = d40c0000, Performance =  18.18 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.084769 s, Result = 94480000, Performance =  18.24 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.089269 s, Result = 54840000, Performance =  18.28 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.092777 s, Result = 14c00000, Performance =  18.52 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.097350 s, Result = d4fc0000, Performance =  18.53 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.102112 s, Result = 95380000, Performance =  18.51 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.106981 s, Result = 55740000, Performance =  18.47 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.110065 s, Result = 15b00000, Performance =  18.73 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.115660 s, Result = d5ec0000, Performance =  18.57 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.120087 s, Result = 96280000, Performance =  18.60 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.124991 s, Result = 56640000, Performance =  18.56 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.128952 s, Result = 16a00000, Performance =  18.65 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.134004 s, Result = d6dc0000, Performance =  18.59 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.136463 s, Result = 97180000, Performance =  18.88 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.142946 s, Result = 57540000, Performance =  18.63 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.151313 s, Result = 17900000, Performance =  18.17 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.137446 s, Result = d7cc0000, Performance =  20.62 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.138916 s, Result = 98080000, Performance =  21.02 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.144853 s, Result = 58440000, Performance =  20.76 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.147210 s, Result = 18800000, Performance =  21.01 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.152003 s, Result = d8bc0000, Performance =  20.91 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.154856 s, Result = 98f80000, Performance =  21.08 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.157181 s, Result = 59340000, Performance =  21.31 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.158944 s, Result = 19700000, Performance =  21.62 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.163800 s, Result = d9ac0000, Performance =  21.50 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.167861 s, Result = 99e80000, Performance =  21.49 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.172923 s, Result = 5a240000, Performance =  21.36 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.175387 s, Result = 1a600000, Performance =  21.55 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.179604 s, Result = da9c0000, Performance =  21.52 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.183283 s, Result = 9ad80000, Performance =  21.56 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.185597 s, Result = 5b140000, Performance =  21.75 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.187226 s, Result = 1b500000, Performance =  22.02 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.190084 s, Result = db8c0000, Performance =  22.14 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.193661 s, Result = 9bc80000, Performance =  22.18 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.198683 s, Result = 5c040000, Performance =  22.05 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.199409 s, Result = 1c400000, Performance =  22.40 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.202771 s, Result = dc7c0000, Performance =  22.45 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.217218 s, Result = 9cb80000, Performance =  21.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.208897 s, Result = 5cf40000, Performance =  22.62 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.208288 s, Result = 1d300000, Performance =  23.09 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.209958 s, Result = dd6c0000, Performance =  23.32 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.213589 s, Result = 9da80000, Performance =  23.33 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.206805 s, Result = 5de40000, Performance =  24.51 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.208338 s, Result = 1e200000, Performance =  24.74 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.209266 s, Result = de5c0000, Performance =  25.04 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.221651 s, Result = 9e980000, Performance =  24.03 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.215945 s, Result = 5ed40000, Performance =  25.06 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.287518 s, Result = 1f100000, Performance =  19.12 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   519  1622  1152
Test passed: M N K =  1828   820  1984
Test passed: M N K =  1544   572  1344
Test passed: M N K =  1973  1731  1536
Test passed: M N K =  1681   124  1920
M N K =  4096  4096   256, Elapsed time =   0.025080 s, Result = 003c0000, Performance =   3.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024282 s, Result = 00780000, Performance =   7.08 TOPS
M N K =  4096  4096   768, Elapsed time =   0.030728 s, Result = 00b40000, Performance =   8.39 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.029920 s, Result = 00f00000, Performance =  11.48 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028461 s, Result = 012c0000, Performance =  15.09 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.035811 s, Result = 01680000, Performance =  14.39 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.033039 s, Result = 01a40000, Performance =  18.20 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.035267 s, Result = 01e00000, Performance =  19.49 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037331 s, Result = 021c0000, Performance =  20.71 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.039156 s, Result = 02580000, Performance =  21.94 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.042363 s, Result = 02940000, Performance =  22.30 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.045936 s, Result = 02d00000, Performance =  22.44 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.048900 s, Result = 030c0000, Performance =  22.84 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.053417 s, Result = 03480000, Performance =  22.51 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.056882 s, Result = 03840000, Performance =  22.65 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.061670 s, Result = 03c00000, Performance =  22.29 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.063886 s, Result = 03fc0000, Performance =  22.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067449 s, Result = 04380000, Performance =  22.92 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.072368 s, Result = 04740000, Performance =  22.55 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.075103 s, Result = 04b00000, Performance =  22.88 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.079624 s, Result = 04ec0000, Performance =  22.66 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.084997 s, Result = 05280000, Performance =  22.23 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.093647 s, Result = 05640000, Performance =  21.10 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.099077 s, Result = 05a00000, Performance =  20.81 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.104308 s, Result = 05dc0000, Performance =  20.59 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.108282 s, Result = 06180000, Performance =  20.63 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.112960 s, Result = 06540000, Performance =  20.53 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.116839 s, Result = 06900000, Performance =  20.59 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.120296 s, Result = 06cc0000, Performance =  20.71 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.122996 s, Result = 07080000, Performance =  20.95 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.128843 s, Result = 07440000, Performance =  20.67 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.136687 s, Result = 07800000, Performance =  20.11 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.122900 s, Result = 07bc0000, Performance =  23.07 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.117044 s, Result = 07f80000, Performance =  24.95 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.122744 s, Result = 08340000, Performance =  24.49 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.127062 s, Result = 08700000, Performance =  24.34 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.134939 s, Result = 08ac0000, Performance =  23.55 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.138368 s, Result = 08e80000, Performance =  23.59 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.142374 s, Result = 09240000, Performance =  23.53 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.146081 s, Result = 09600000, Performance =  23.52 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.151101 s, Result = 099c0000, Performance =  23.31 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.153532 s, Result = 09d80000, Performance =  23.50 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.162600 s, Result = 0a140000, Performance =  22.72 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.160469 s, Result = 0a500000, Performance =  23.55 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.158336 s, Result = 0a8c0000, Performance =  24.41 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.167255 s, Result = 0ac80000, Performance =  23.62 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.169486 s, Result = 0b040000, Performance =  23.82 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.171288 s, Result = 0b400000, Performance =  24.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.174961 s, Result = 0b7c0000, Performance =  24.06 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.171204 s, Result = 0bb80000, Performance =  25.09 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.181893 s, Result = 0bf40000, Performance =  24.08 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.181530 s, Result = 0c300000, Performance =  24.61 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.186676 s, Result = 0c6c0000, Performance =  24.39 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.192861 s, Result = 0ca80000, Performance =  24.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.190742 s, Result = 0ce40000, Performance =  24.77 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.190964 s, Result = 0d200000, Performance =  25.19 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.193231 s, Result = 0d5c0000, Performance =  25.34 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.197687 s, Result = 0d980000, Performance =  25.20 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.191488 s, Result = 0dd40000, Performance =  26.47 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.192041 s, Result = 0e100000, Performance =  26.84 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.193836 s, Result = 0e4c0000, Performance =  27.03 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.205421 s, Result = 0e880000, Performance =  25.93 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.201135 s, Result = 0ec40000, Performance =  26.91 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.267741 s, Result = 0f000000, Performance =  20.53 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1783   532   704
Test passed: M N K =   355  1967   384
Test passed: M N K =  1193  1281   576
Test passed: M N K =   150   353    64
Test passed: M N K =  1967   421   128
M N K =  4096  4096   256, Elapsed time =   0.018894 s, Result = a0dc0000, Performance =   4.55 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017361 s, Result = a1180000, Performance =   9.90 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018987 s, Result = a1540000, Performance =  13.57 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.020155 s, Result = a1900000, Performance =  17.05 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.021799 s, Result = a1cc0000, Performance =  19.70 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.023704 s, Result = a2080000, Performance =  21.74 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.024718 s, Result = a2440000, Performance =  24.33 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.027285 s, Result = a2800000, Performance =  25.19 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.028936 s, Result = a2bc0000, Performance =  26.72 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031231 s, Result = a2f80000, Performance =  27.50 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.033096 s, Result = a3340000, Performance =  28.55 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.036014 s, Result = a3700000, Performance =  28.62 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.038363 s, Result = a3ac0000, Performance =  29.11 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.041441 s, Result = a3e80000, Performance =  29.02 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.045473 s, Result = a4240000, Performance =  28.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.048575 s, Result = a4600000, Performance =  28.29 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.051215 s, Result = a49c0000, Performance =  28.51 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.055027 s, Result = a4d80000, Performance =  28.10 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.058714 s, Result = a5140000, Performance =  27.80 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.062427 s, Result = a5500000, Performance =  27.52 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.066183 s, Result = a58c0000, Performance =  27.26 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.070311 s, Result = a5c80000, Performance =  26.88 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.074705 s, Result = a6040000, Performance =  26.45 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.079324 s, Result = a6400000, Performance =  25.99 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.097268 s, Result = a67c0000, Performance =  22.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.100345 s, Result = a6b80000, Performance =  22.26 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.101956 s, Result = a6f40000, Performance =  22.75 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.105220 s, Result = a7300000, Performance =  22.86 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.128349 s, Result = a76c0000, Performance =  19.41 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.112523 s, Result = a7a80000, Performance =  22.90 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.110432 s, Result = a7e40000, Performance =  24.11 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.120171 s, Result = a8200000, Performance =  22.87 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.118073 s, Result = a85c0000, Performance =  24.01 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.132783 s, Result = a8980000, Performance =  22.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.119395 s, Result = a8d40000, Performance =  25.18 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.123751 s, Result = a9100000, Performance =  24.99 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.124383 s, Result = a94c0000, Performance =  25.55 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.126999 s, Result = a9880000, Performance =  25.70 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.132445 s, Result = a9c40000, Performance =  25.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.134132 s, Result = aa000000, Performance =  25.62 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.137620 s, Result = aa3c0000, Performance =  25.59 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.152942 s, Result = aa780000, Performance =  23.59 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.154597 s, Result = aab40000, Performance =  23.89 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.154910 s, Result = aaf00000, Performance =  24.40 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.155126 s, Result = ab2c0000, Performance =  24.92 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.153910 s, Result = ab680000, Performance =  25.67 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.156475 s, Result = aba40000, Performance =  25.80 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.158474 s, Result = abe00000, Performance =  26.02 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.160069 s, Result = ac1c0000, Performance =  26.30 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.160330 s, Result = ac580000, Performance =  26.79 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.163637 s, Result = ac940000, Performance =  26.77 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.282835 s, Result = acd00000, Performance =  15.79 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.332856 s, Result = ad0c0000, Performance =  13.68 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.289130 s, Result = ad480000, Performance =  16.04 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.179497 s, Result = ad840000, Performance =  26.32 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.178631 s, Result = adc00000, Performance =  26.93 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.182639 s, Result = adfc0000, Performance =  26.81 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.190162 s, Result = ae380000, Performance =  26.20 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.182590 s, Result = ae740000, Performance =  27.76 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.182821 s, Result = aeb00000, Performance =  28.19 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.185336 s, Result = aeec0000, Performance =  28.27 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.206693 s, Result = af280000, Performance =  25.77 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.193079 s, Result = af640000, Performance =  28.03 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.275363 s, Result = afa00000, Performance =  19.96 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1998  1051  1664
Test passed: M N K =   361   797  1408
Test passed: M N K =   494  1664   256
Test passed: M N K =  1656   202   704
Test passed: M N K =  1591   620   512
M N K =  4096  4096   256, Elapsed time =   0.001734 s, Result = 003c0000, Performance =  49.53 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003472 s, Result = 00780000, Performance =  49.48 TOPS
M N K =  4096  4096   768, Elapsed time =   0.005038 s, Result = 00b40000, Performance =  51.15 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004995 s, Result = 00f00000, Performance =  68.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.009706 s, Result = 012c0000, Performance =  44.25 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007029 s, Result = 01680000, Performance =  73.32 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013655 s, Result = 01a40000, Performance =  44.03 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010334 s, Result = 01e00000, Performance =  66.50 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011239 s, Result = 021c0000, Performance =  68.79 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.018846 s, Result = 02580000, Performance =  45.58 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.016076 s, Result = 02940000, Performance =  58.78 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.021959 s, Result = 02d00000, Performance =  46.94 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.019592 s, Result = 030c0000, Performance =  57.00 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.031150 s, Result = 03480000, Performance =  38.61 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.029281 s, Result = 03840000, Performance =  44.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.033702 s, Result = 03c00000, Performance =  40.78 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.038761 s, Result = 03fc0000, Performance =  37.67 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.048314 s, Result = 04380000, Performance =  32.00 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.044195 s, Result = 04740000, Performance =  36.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060089 s, Result = 04b00000, Performance =  28.59 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.055738 s, Result = 04ec0000, Performance =  32.36 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.059133 s, Result = 05280000, Performance =  31.96 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.061611 s, Result = 05640000, Performance =  32.07 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.068621 s, Result = 05a00000, Performance =  30.04 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.070738 s, Result = 05dc0000, Performance =  30.36 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.074357 s, Result = 06180000, Performance =  30.04 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.076969 s, Result = 06540000, Performance =  30.13 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.083775 s, Result = 06900000, Performance =  28.71 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.123899 s, Result = 06cc0000, Performance =  20.11 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.098916 s, Result = 07080000, Performance =  26.05 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.093491 s, Result = 07440000, Performance =  28.48 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.103120 s, Result = 07800000, Performance =  26.66 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.102067 s, Result = 07bc0000, Performance =  27.77 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.099863 s, Result = 07f80000, Performance =  29.25 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.099680 s, Result = 08340000, Performance =  30.16 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.113354 s, Result = 08700000, Performance =  27.28 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.104263 s, Result = 08ac0000, Performance =  30.48 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.117585 s, Result = 08e80000, Performance =  27.76 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.128563 s, Result = 09240000, Performance =  26.06 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.130255 s, Result = 09600000, Performance =  26.38 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.194167 s, Result = 099c0000, Performance =  18.14 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.129836 s, Result = 09d80000, Performance =  27.79 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.125882 s, Result = 0a140000, Performance =  29.34 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.127486 s, Result = 0a500000, Performance =  29.65 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.130350 s, Result = 0a8c0000, Performance =  29.65 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.133019 s, Result = 0ac80000, Performance =  29.71 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.137975 s, Result = 0b040000, Performance =  29.26 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.142439 s, Result = 0b400000, Performance =  28.95 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.145218 s, Result = 0b7c0000, Performance =  28.98 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.146759 s, Result = 0bb80000, Performance =  29.27 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.151187 s, Result = 0bf40000, Performance =  28.98 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.153937 s, Result = 0c300000, Performance =  29.02 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.156063 s, Result = 0c6c0000, Performance =  29.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.160121 s, Result = 0ca80000, Performance =  28.97 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.160590 s, Result = 0ce40000, Performance =  29.42 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.157702 s, Result = 0d200000, Performance =  30.50 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.160349 s, Result = 0d5c0000, Performance =  30.53 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.167275 s, Result = 0d980000, Performance =  29.78 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.161394 s, Result = 0dd40000, Performance =  31.40 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.162659 s, Result = 0e100000, Performance =  31.69 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.165413 s, Result = 0e4c0000, Performance =  31.68 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.175517 s, Result = 0e880000, Performance =  30.34 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.172005 s, Result = 0ec40000, Performance =  31.46 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.246918 s, Result = 0f000000, Performance =  22.26 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1882   994  1216
Test passed: M N K =  1393   529   960
Test passed: M N K =  1472   147  1856
Test passed: M N K =   735   652  1088
Test passed: M N K =  1770  1141  1088
M N K =  4096  4096   256, Elapsed time =   0.028748 s, Result = d04c0000, Performance =   2.99 TOPS
M N K =  4096  4096   512, Elapsed time =   0.030464 s, Result = 90880000, Performance =   5.64 TOPS
M N K =  4096  4096   768, Elapsed time =   0.042601 s, Result = 50c40000, Performance =   6.05 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034629 s, Result = 11000000, Performance =   9.92 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.043632 s, Result = d13c0000, Performance =   9.84 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.039647 s, Result = 91780000, Performance =  13.00 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.045838 s, Result = 51b40000, Performance =  13.12 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.046070 s, Result = 11f00000, Performance =  14.92 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.050373 s, Result = d22c0000, Performance =  15.35 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.057643 s, Result = 92680000, Performance =  14.90 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.059855 s, Result = 52a40000, Performance =  15.79 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.063641 s, Result = 12e00000, Performance =  16.20 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.066636 s, Result = d31c0000, Performance =  16.76 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.069863 s, Result = 93580000, Performance =  17.21 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.074351 s, Result = 53940000, Performance =  17.33 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.078675 s, Result = 13d00000, Performance =  17.47 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.078450 s, Result = d40c0000, Performance =  18.61 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.081064 s, Result = 94480000, Performance =  19.07 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.084910 s, Result = 54840000, Performance =  19.22 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.088576 s, Result = 14c00000, Performance =  19.40 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.091740 s, Result = d4fc0000, Performance =  19.66 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.095891 s, Result = 95380000, Performance =  19.71 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.101507 s, Result = 55740000, Performance =  19.46 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.106020 s, Result = 15b00000, Performance =  19.45 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.108486 s, Result = d5ec0000, Performance =  19.79 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.111461 s, Result = 96280000, Performance =  20.04 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.115056 s, Result = 56640000, Performance =  20.16 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.119387 s, Result = 16a00000, Performance =  20.15 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.123463 s, Result = d6dc0000, Performance =  20.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.126796 s, Result = 97180000, Performance =  20.32 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.130202 s, Result = 57540000, Performance =  20.45 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.152874 s, Result = 17900000, Performance =  17.98 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.141333 s, Result = d7cc0000, Performance =  20.06 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.127601 s, Result = 98080000, Performance =  22.89 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.131114 s, Result = 58440000, Performance =  22.93 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.134194 s, Result = 18800000, Performance =  23.04 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.139010 s, Result = d8bc0000, Performance =  22.86 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.142201 s, Result = 98f80000, Performance =  22.95 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.145224 s, Result = 59340000, Performance =  23.07 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.147235 s, Result = 19700000, Performance =  23.34 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.151528 s, Result = d9ac0000, Performance =  23.24 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.156429 s, Result = 99e80000, Performance =  23.06 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.162669 s, Result = 5a240000, Performance =  22.71 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.160276 s, Result = 1a600000, Performance =  23.58 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.163350 s, Result = da9c0000, Performance =  23.66 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.167149 s, Result = 9ad80000, Performance =  23.64 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.169292 s, Result = 5b140000, Performance =  23.85 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.172631 s, Result = 1b500000, Performance =  23.88 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.174522 s, Result = db8c0000, Performance =  24.12 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.178502 s, Result = 9bc80000, Performance =  24.06 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.181867 s, Result = 5c040000, Performance =  24.09 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.181074 s, Result = 1c400000, Performance =  24.67 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.182891 s, Result = dc7c0000, Performance =  24.89 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.188456 s, Result = 9cb80000, Performance =  24.61 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.188400 s, Result = 5cf40000, Performance =  25.08 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.190651 s, Result = 1d300000, Performance =  25.23 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.193980 s, Result = dd6c0000, Performance =  25.24 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.196221 s, Result = 9da80000, Performance =  25.39 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.196150 s, Result = 5de40000, Performance =  25.84 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.194214 s, Result = 1e200000, Performance =  26.54 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.199260 s, Result = de5c0000, Performance =  26.30 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.202822 s, Result = 9e980000, Performance =  26.26 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.211395 s, Result = 5ed40000, Performance =  25.60 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.271982 s, Result = 1f100000, Performance =  20.21 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   191   797  2048
Test passed: M N K =   619  1105  1280
Test passed: M N K =  1646  1737   704
Test passed: M N K =  1431   806   896
Test passed: M N K =  1905  1821  1600
M N K =  4096  4096   256, Elapsed time =   0.024510 s, Result = 003c0000, Performance =   3.50 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024176 s, Result = 00780000, Performance =   7.11 TOPS
M N K =  4096  4096   768, Elapsed time =   0.033870 s, Result = 00b40000, Performance =   7.61 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.035763 s, Result = 00f00000, Performance =   9.61 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029724 s, Result = 012c0000, Performance =  14.45 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.030194 s, Result = 01680000, Performance =  17.07 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.032160 s, Result = 01a40000, Performance =  18.70 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.033493 s, Result = 01e00000, Performance =  20.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037025 s, Result = 021c0000, Performance =  20.88 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.037779 s, Result = 02580000, Performance =  22.74 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.039831 s, Result = 02940000, Performance =  23.72 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.042692 s, Result = 02d00000, Performance =  24.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.046157 s, Result = 030c0000, Performance =  24.19 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.050527 s, Result = 03480000, Performance =  23.80 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.054256 s, Result = 03840000, Performance =  23.75 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.059096 s, Result = 03c00000, Performance =  23.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.061822 s, Result = 03fc0000, Performance =  23.62 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.064600 s, Result = 04380000, Performance =  23.93 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.068376 s, Result = 04740000, Performance =  23.87 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.071701 s, Result = 04b00000, Performance =  23.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.075236 s, Result = 04ec0000, Performance =  23.98 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.079103 s, Result = 05280000, Performance =  23.89 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.088285 s, Result = 05640000, Performance =  22.38 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.092451 s, Result = 05a00000, Performance =  22.30 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.095624 s, Result = 05dc0000, Performance =  22.46 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.092840 s, Result = 06180000, Performance =  24.06 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.095735 s, Result = 06540000, Performance =  24.23 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.099845 s, Result = 06900000, Performance =  24.09 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.105428 s, Result = 06cc0000, Performance =  23.63 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.109030 s, Result = 07080000, Performance =  23.64 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.112479 s, Result = 07440000, Performance =  23.67 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.134667 s, Result = 07800000, Performance =  20.41 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.116160 s, Result = 07bc0000, Performance =  24.40 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.110323 s, Result = 07f80000, Performance =  26.47 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.114466 s, Result = 08340000, Performance =  26.27 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.120184 s, Result = 08700000, Performance =  25.73 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.127016 s, Result = 08ac0000, Performance =  25.02 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.127276 s, Result = 08e80000, Performance =  25.65 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.129792 s, Result = 09240000, Performance =  25.81 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.131140 s, Result = 09600000, Performance =  26.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.134951 s, Result = 099c0000, Performance =  26.10 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.139056 s, Result = 09d80000, Performance =  25.94 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.144456 s, Result = 0a140000, Performance =  25.57 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.143698 s, Result = 0a500000, Performance =  26.30 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.146419 s, Result = 0a8c0000, Performance =  26.40 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.150227 s, Result = 0ac80000, Performance =  26.30 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.153095 s, Result = 0b040000, Performance =  26.37 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.154776 s, Result = 0b400000, Performance =  26.64 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.158261 s, Result = 0b7c0000, Performance =  26.60 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.162694 s, Result = 0bb80000, Performance =  26.40 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.166690 s, Result = 0bf40000, Performance =  26.28 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.166854 s, Result = 0c300000, Performance =  26.77 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.168925 s, Result = 0c6c0000, Performance =  26.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.173197 s, Result = 0ca80000, Performance =  26.78 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.173754 s, Result = 0ce40000, Performance =  27.19 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.173225 s, Result = 0d200000, Performance =  27.77 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.178093 s, Result = 0d5c0000, Performance =  27.49 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.180618 s, Result = 0d980000, Performance =  27.58 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.180258 s, Result = 0dd40000, Performance =  28.12 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.178371 s, Result = 0e100000, Performance =  28.89 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.182760 s, Result = 0e4c0000, Performance =  28.67 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.186048 s, Result = 0e880000, Performance =  28.63 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.193234 s, Result = 0ec40000, Performance =  28.01 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.258783 s, Result = 0f000000, Performance =  21.24 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   256   742  1792
Test passed: M N K =  1443  1537   512
Test passed: M N K =   402  1322  1280
Test passed: M N K =   238  1313   640
Test passed: M N K =   741   338   832
M N K =  4096  4096   256, Elapsed time =   0.019140 s, Result = a0dc0000, Performance =   4.49 TOPS
M N K =  4096  4096   512, Elapsed time =   0.018012 s, Result = a1180000, Performance =   9.54 TOPS
M N K =  4096  4096   768, Elapsed time =   0.020680 s, Result = a1540000, Performance =  12.46 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.022083 s, Result = a1900000, Performance =  15.56 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.022458 s, Result = a1cc0000, Performance =  19.12 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040144 s, Result = a2080000, Performance =  12.84 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.025532 s, Result = a2440000, Performance =  23.55 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.025818 s, Result = a2800000, Performance =  26.62 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.028851 s, Result = a2bc0000, Performance =  26.80 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.030628 s, Result = a2f80000, Performance =  28.05 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.032223 s, Result = a3340000, Performance =  29.32 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.034947 s, Result = a3700000, Performance =  29.50 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.037702 s, Result = a3ac0000, Performance =  29.62 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.040752 s, Result = a3e80000, Performance =  29.51 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.044569 s, Result = a4240000, Performance =  28.91 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.048391 s, Result = a4600000, Performance =  28.40 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.052020 s, Result = a49c0000, Performance =  28.07 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.054510 s, Result = a4d80000, Performance =  28.37 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.058050 s, Result = a5140000, Performance =  28.11 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060911 s, Result = a5500000, Performance =  28.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.076191 s, Result = a58c0000, Performance =  23.68 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.067129 s, Result = a5c80000, Performance =  28.15 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.078216 s, Result = a6040000, Performance =  25.26 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.081621 s, Result = a6400000, Performance =  25.26 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.084307 s, Result = a67c0000, Performance =  25.47 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.086340 s, Result = a6b80000, Performance =  25.87 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.089680 s, Result = a6f40000, Performance =  25.86 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.092420 s, Result = a7300000, Performance =  26.02 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.094932 s, Result = a76c0000, Performance =  26.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.097354 s, Result = a7a80000, Performance =  26.47 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.100771 s, Result = a7e40000, Performance =  26.43 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.124045 s, Result = a8200000, Performance =  22.16 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.105569 s, Result = a85c0000, Performance =  26.85 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.099365 s, Result = a8980000, Performance =  29.39 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.102615 s, Result = a8d40000, Performance =  29.30 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.105076 s, Result = a9100000, Performance =  29.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.109192 s, Result = a94c0000, Performance =  29.11 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.111699 s, Result = a9880000, Performance =  29.22 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.114590 s, Result = a9c40000, Performance =  29.24 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.116661 s, Result = aa000000, Performance =  29.45 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.120131 s, Result = aa3c0000, Performance =  29.32 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.122934 s, Result = aa780000, Performance =  29.35 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.128826 s, Result = aab40000, Performance =  28.67 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.127598 s, Result = aaf00000, Performance =  29.62 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.130224 s, Result = ab2c0000, Performance =  29.68 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.133238 s, Result = ab680000, Performance =  29.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.137432 s, Result = aba40000, Performance =  29.38 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.139891 s, Result = abe00000, Performance =  29.47 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.141755 s, Result = ac1c0000, Performance =  29.69 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.145629 s, Result = ac580000, Performance =  29.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.151399 s, Result = ac940000, Performance =  28.94 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.149172 s, Result = acd00000, Performance =  29.94 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.153471 s, Result = ad0c0000, Performance =  29.66 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.157938 s, Result = ad480000, Performance =  29.37 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.159272 s, Result = ad840000, Performance =  29.66 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.158742 s, Result = adc00000, Performance =  30.30 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.163693 s, Result = adfc0000, Performance =  29.91 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.166337 s, Result = ae380000, Performance =  29.95 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.167583 s, Result = ae740000, Performance =  30.24 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.163170 s, Result = aeb00000, Performance =  31.59 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.172304 s, Result = aeec0000, Performance =  30.41 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.172675 s, Result = af280000, Performance =  30.84 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.180640 s, Result = af640000, Performance =  29.96 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.255343 s, Result = afa00000, Performance =  21.53 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1349   756   256
Test passed: M N K =   516  1910   448
Test passed: M N K =   675   302   128
Test passed: M N K =  1172  2007  2048
Test passed: M N K =  1309  1817   704
M N K =  4096  4096   256, Elapsed time =   0.001698 s, Result = 003c0000, Performance =  50.58 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003326 s, Result = 00780000, Performance =  51.65 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003859 s, Result = 00b40000, Performance =  66.77 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.005105 s, Result = 00f00000, Performance =  67.31 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012538 s, Result = 012c0000, Performance =  34.26 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.008536 s, Result = 01680000, Performance =  60.38 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.016284 s, Result = 01a40000, Performance =  36.92 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010409 s, Result = 01e00000, Performance =  66.02 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.020909 s, Result = 021c0000, Performance =  36.97 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012617 s, Result = 02580000, Performance =  68.08 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015481 s, Result = 02940000, Performance =  61.03 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016456 s, Result = 02d00000, Performance =  62.64 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018369 s, Result = 030c0000, Performance =  60.79 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021007 s, Result = 03480000, Performance =  57.25 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.024017 s, Result = 03840000, Performance =  53.65 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.027055 s, Result = 03c00000, Performance =  50.80 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.030027 s, Result = 03fc0000, Performance =  48.63 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.033285 s, Result = 04380000, Performance =  46.45 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.037375 s, Result = 04740000, Performance =  43.67 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043233 s, Result = 04b00000, Performance =  39.74 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.048303 s, Result = 04ec0000, Performance =  37.35 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.053090 s, Result = 05280000, Performance =  35.60 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057738 s, Result = 05640000, Performance =  34.22 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061510 s, Result = 05a00000, Performance =  33.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069836 s, Result = 05dc0000, Performance =  30.75 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.067053 s, Result = 06180000, Performance =  33.31 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.077747 s, Result = 06540000, Performance =  29.83 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.079146 s, Result = 06900000, Performance =  30.39 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.083034 s, Result = 06cc0000, Performance =  30.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.086015 s, Result = 07080000, Performance =  29.96 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.088824 s, Result = 07440000, Performance =  29.98 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.105206 s, Result = 07800000, Performance =  26.13 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.088592 s, Result = 07bc0000, Performance =  32.00 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.081280 s, Result = 07f80000, Performance =  35.93 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.085610 s, Result = 08340000, Performance =  35.12 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.088858 s, Result = 08700000, Performance =  34.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.093589 s, Result = 08ac0000, Performance =  33.96 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.096301 s, Result = 08e80000, Performance =  33.90 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.099517 s, Result = 09240000, Performance =  33.66 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.101487 s, Result = 09600000, Performance =  33.86 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.104815 s, Result = 099c0000, Performance =  33.60 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.107798 s, Result = 09d80000, Performance =  33.47 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.112321 s, Result = 0a140000, Performance =  32.88 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.111654 s, Result = 0a500000, Performance =  33.85 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.115349 s, Result = 0a8c0000, Performance =  33.51 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.118799 s, Result = 0ac80000, Performance =  33.26 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.122453 s, Result = 0b040000, Performance =  32.97 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.124681 s, Result = 0b400000, Performance =  33.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.127557 s, Result = 0b7c0000, Performance =  33.00 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.132067 s, Result = 0bb80000, Performance =  32.52 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.135434 s, Result = 0bf40000, Performance =  32.35 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.135663 s, Result = 0c300000, Performance =  32.93 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.140266 s, Result = 0c6c0000, Performance =  32.46 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.144396 s, Result = 0ca80000, Performance =  32.12 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.146330 s, Result = 0ce40000, Performance =  32.29 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.145480 s, Result = 0d200000, Performance =  33.07 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.149420 s, Result = 0d5c0000, Performance =  32.77 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.152672 s, Result = 0d980000, Performance =  32.63 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.153970 s, Result = 0dd40000, Performance =  32.92 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.150282 s, Result = 0e100000, Performance =  34.30 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.158542 s, Result = 0e4c0000, Performance =  33.05 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.159297 s, Result = 0e880000, Performance =  33.43 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.167867 s, Result = 0ec40000, Performance =  32.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.236922 s, Result = 0f000000, Performance =  23.20 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1577  1756   896
Test passed: M N K =  1154   862  1088
Test passed: M N K =   976   447  1920
Test passed: M N K =  1136   394  1344
Test passed: M N K =  1907  1548   384
M N K =  4096  4096   256, Elapsed time =   0.028502 s, Result = d04c0000, Performance =   3.01 TOPS
M N K =  4096  4096   512, Elapsed time =   0.029994 s, Result = 90880000, Performance =   5.73 TOPS
M N K =  4096  4096   768, Elapsed time =   0.030826 s, Result = 50c40000, Performance =   8.36 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.032728 s, Result = 11000000, Performance =  10.50 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.035241 s, Result = d13c0000, Performance =  12.19 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.038076 s, Result = 91780000, Performance =  13.54 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.041230 s, Result = 51b40000, Performance =  14.58 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.043636 s, Result = 11f00000, Performance =  15.75 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.046669 s, Result = d22c0000, Performance =  16.57 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.051172 s, Result = 92680000, Performance =  16.79 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.054262 s, Result = 52a40000, Performance =  17.41 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.056032 s, Result = 12e00000, Performance =  18.40 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.059335 s, Result = d31c0000, Performance =  18.82 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.062571 s, Result = 93580000, Performance =  19.22 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.065925 s, Result = 53940000, Performance =  19.54 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.068905 s, Result = 13d00000, Performance =  19.95 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.072394 s, Result = d40c0000, Performance =  20.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.076879 s, Result = 94480000, Performance =  20.11 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.079426 s, Result = 54840000, Performance =  20.55 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.081809 s, Result = 14c00000, Performance =  21.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.084611 s, Result = d4fc0000, Performance =  21.32 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.089220 s, Result = 95380000, Performance =  21.18 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.094923 s, Result = 55740000, Performance =  20.81 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.099289 s, Result = 15b00000, Performance =  20.76 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.101801 s, Result = d5ec0000, Performance =  21.09 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.119872 s, Result = 96280000, Performance =  18.63 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.108518 s, Result = 56640000, Performance =  21.37 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.111572 s, Result = 16a00000, Performance =  21.56 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.116301 s, Result = d6dc0000, Performance =  21.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.118694 s, Result = 97180000, Performance =  21.71 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.121381 s, Result = 57540000, Performance =  21.94 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.139858 s, Result = 17900000, Performance =  19.65 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.126768 s, Result = d7cc0000, Performance =  22.36 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.130720 s, Result = 98080000, Performance =  22.34 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.131277 s, Result = 58440000, Performance =  22.90 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.129300 s, Result = 18800000, Performance =  23.92 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.133321 s, Result = d8bc0000, Performance =  23.84 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.140417 s, Result = 98f80000, Performance =  23.25 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.142774 s, Result = 59340000, Performance =  23.46 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.142137 s, Result = 19700000, Performance =  24.17 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.145586 s, Result = d9ac0000, Performance =  24.19 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.151627 s, Result = 99e80000, Performance =  23.79 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.157408 s, Result = 5a240000, Performance =  23.47 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.151153 s, Result = 1a600000, Performance =  25.00 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.155013 s, Result = da9c0000, Performance =  24.94 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.157575 s, Result = 9ad80000, Performance =  25.08 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.159468 s, Result = 5b140000, Performance =  25.32 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.160814 s, Result = 1b500000, Performance =  25.64 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.162848 s, Result = db8c0000, Performance =  25.85 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.166993 s, Result = 9bc80000, Performance =  25.72 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.174545 s, Result = 5c040000, Performance =  25.10 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.172360 s, Result = 1c400000, Performance =  25.92 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.176541 s, Result = dc7c0000, Performance =  25.79 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.181840 s, Result = 9cb80000, Performance =  25.51 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.188591 s, Result = 5cf40000, Performance =  25.05 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.187186 s, Result = 1d300000, Performance =  25.70 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.193008 s, Result = dd6c0000, Performance =  25.37 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.193152 s, Result = 9da80000, Performance =  25.79 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.191649 s, Result = 5de40000, Performance =  26.44 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.189671 s, Result = 1e200000, Performance =  27.17 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.197797 s, Result = de5c0000, Performance =  26.49 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.202837 s, Result = 9e980000, Performance =  26.26 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.202007 s, Result = 5ed40000, Performance =  26.79 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.267239 s, Result = 1f100000, Performance =  20.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   798   723   896
Test passed: M N K =  1880    78   384
Test passed: M N K =  1417  1109   640
Test passed: M N K =  2014  1435  1216
Test passed: M N K =   545   546   192
M N K =  4096  4096   256, Elapsed time =   0.023950 s, Result = 003c0000, Performance =   3.59 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024004 s, Result = 00780000, Performance =   7.16 TOPS
M N K =  4096  4096   768, Elapsed time =   0.026432 s, Result = 00b40000, Performance =   9.75 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.028098 s, Result = 00f00000, Performance =  12.23 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.036468 s, Result = 012c0000, Performance =  11.78 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.030569 s, Result = 01680000, Performance =  16.86 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.032100 s, Result = 01a40000, Performance =  18.73 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.033680 s, Result = 01e00000, Performance =  20.40 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037091 s, Result = 021c0000, Performance =  20.84 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.045116 s, Result = 02580000, Performance =  19.04 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.040682 s, Result = 02940000, Performance =  23.23 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.049727 s, Result = 02d00000, Performance =  20.73 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.045449 s, Result = 030c0000, Performance =  24.57 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.048649 s, Result = 03480000, Performance =  24.72 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.052524 s, Result = 03840000, Performance =  24.53 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.055313 s, Result = 03c00000, Performance =  24.85 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.059319 s, Result = 03fc0000, Performance =  24.62 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.070972 s, Result = 04380000, Performance =  21.79 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.065368 s, Result = 04740000, Performance =  24.97 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.068058 s, Result = 04b00000, Performance =  25.24 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.071516 s, Result = 04ec0000, Performance =  25.22 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.075729 s, Result = 05280000, Performance =  24.95 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.078485 s, Result = 05640000, Performance =  25.17 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.083813 s, Result = 05a00000, Performance =  24.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.086813 s, Result = 05dc0000, Performance =  24.74 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.089267 s, Result = 06180000, Performance =  25.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.092497 s, Result = 06540000, Performance =  25.07 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.094600 s, Result = 06900000, Performance =  25.42 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.097972 s, Result = 06cc0000, Performance =  25.43 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.101114 s, Result = 07080000, Performance =  25.49 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.105739 s, Result = 07440000, Performance =  25.18 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.123999 s, Result = 07800000, Performance =  22.17 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.113995 s, Result = 07bc0000, Performance =  24.87 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.114196 s, Result = 07f80000, Performance =  25.58 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.115100 s, Result = 08340000, Performance =  26.12 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.111387 s, Result = 08700000, Performance =  27.76 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.115049 s, Result = 08ac0000, Performance =  27.63 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.118827 s, Result = 08e80000, Performance =  27.47 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.123973 s, Result = 09240000, Performance =  27.02 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.125143 s, Result = 09600000, Performance =  27.46 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.127352 s, Result = 099c0000, Performance =  27.65 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.132891 s, Result = 09d80000, Performance =  27.15 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.139089 s, Result = 0a140000, Performance =  26.56 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.134460 s, Result = 0a500000, Performance =  28.11 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.137280 s, Result = 0a8c0000, Performance =  28.16 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.140199 s, Result = 0ac80000, Performance =  28.18 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.142656 s, Result = 0b040000, Performance =  28.30 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.143130 s, Result = 0b400000, Performance =  28.81 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.147572 s, Result = 0b7c0000, Performance =  28.52 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.152366 s, Result = 0bb80000, Performance =  28.19 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.159520 s, Result = 0bf40000, Performance =  27.46 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.156410 s, Result = 0c300000, Performance =  28.56 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.161632 s, Result = 0c6c0000, Performance =  28.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.164795 s, Result = 0ca80000, Performance =  28.15 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.169876 s, Result = 0ce40000, Performance =  27.81 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.168127 s, Result = 0d200000, Performance =  28.61 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.174234 s, Result = 0d5c0000, Performance =  28.10 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.176243 s, Result = 0d980000, Performance =  28.27 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.176275 s, Result = 0dd40000, Performance =  28.75 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.171550 s, Result = 0e100000, Performance =  30.04 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.181420 s, Result = 0e4c0000, Performance =  28.88 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.184553 s, Result = 0e880000, Performance =  28.86 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.183784 s, Result = 0ec40000, Performance =  29.45 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.251788 s, Result = 0f000000, Performance =  21.83 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1062  1564   384
Test passed: M N K =  1552   196  1792
Test passed: M N K =  1668   719   512
Test passed: M N K =  1087   333   512
Test passed: M N K =  1390   934   448
M N K =  4096  4096   256, Elapsed time =   0.019743 s, Result = a0dc0000, Performance =   4.35 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017330 s, Result = a1180000, Performance =   9.91 TOPS
M N K =  4096  4096   768, Elapsed time =   0.019862 s, Result = a1540000, Performance =  12.97 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.020250 s, Result = a1900000, Performance =  16.97 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.021933 s, Result = a1cc0000, Performance =  19.58 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.023409 s, Result = a2080000, Performance =  22.02 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.024759 s, Result = a2440000, Performance =  24.29 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.026540 s, Result = a2800000, Performance =  25.89 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.028207 s, Result = a2bc0000, Performance =  27.41 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.030762 s, Result = a2f80000, Performance =  27.92 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.032545 s, Result = a3340000, Performance =  29.03 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.034074 s, Result = a3700000, Performance =  30.25 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.037397 s, Result = a3ac0000, Performance =  29.86 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.039477 s, Result = a3e80000, Performance =  30.46 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.042883 s, Result = a4240000, Performance =  30.05 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.045287 s, Result = a4600000, Performance =  30.35 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.055304 s, Result = a49c0000, Performance =  26.40 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.052529 s, Result = a4d80000, Performance =  29.43 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.056468 s, Result = a5140000, Performance =  28.90 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.058641 s, Result = a5500000, Performance =  29.30 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.061952 s, Result = a58c0000, Performance =  29.12 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.065617 s, Result = a5c80000, Performance =  28.80 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.069549 s, Result = a6040000, Performance =  28.41 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.073868 s, Result = a6400000, Performance =  27.91 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.076222 s, Result = a67c0000, Performance =  28.17 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.081041 s, Result = a6b80000, Performance =  27.56 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.086594 s, Result = a6f40000, Performance =  26.78 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.090454 s, Result = a7300000, Performance =  26.59 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.093265 s, Result = a76c0000, Performance =  26.71 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.095442 s, Result = a7a80000, Performance =  27.00 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.098828 s, Result = a7e40000, Performance =  26.94 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.115739 s, Result = a8200000, Performance =  23.75 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.103776 s, Result = a85c0000, Performance =  27.32 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.106674 s, Result = a8980000, Performance =  27.38 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.107512 s, Result = a8d40000, Performance =  27.96 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.105530 s, Result = a9100000, Performance =  29.30 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.108490 s, Result = a94c0000, Performance =  29.30 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.110238 s, Result = a9880000, Performance =  29.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.113620 s, Result = a9c40000, Performance =  29.48 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.114674 s, Result = aa000000, Performance =  29.96 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.117804 s, Result = aa3c0000, Performance =  29.90 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.123404 s, Result = aa780000, Performance =  29.24 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.132031 s, Result = aab40000, Performance =  27.98 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.121734 s, Result = aaf00000, Performance =  31.05 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.128367 s, Result = ab2c0000, Performance =  30.11 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.130032 s, Result = ab680000, Performance =  30.39 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.133665 s, Result = aba40000, Performance =  30.20 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.135169 s, Result = abe00000, Performance =  30.50 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.136844 s, Result = ac1c0000, Performance =  30.76 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.141092 s, Result = ac580000, Performance =  30.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.148995 s, Result = ac940000, Performance =  29.40 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.144396 s, Result = acd00000, Performance =  30.93 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.148850 s, Result = ad0c0000, Performance =  30.59 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.152790 s, Result = ad480000, Performance =  30.36 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.156398 s, Result = ad840000, Performance =  30.21 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.157302 s, Result = adc00000, Performance =  30.58 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.163605 s, Result = adfc0000, Performance =  29.93 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.169383 s, Result = ae380000, Performance =  29.41 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.166478 s, Result = ae740000, Performance =  30.44 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.162594 s, Result = aeb00000, Performance =  31.70 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.173052 s, Result = aeec0000, Performance =  30.28 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.174256 s, Result = af280000, Performance =  30.56 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.176355 s, Result = af640000, Performance =  30.69 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.239968 s, Result = afa00000, Performance =  22.91 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   741   846   576
Test passed: M N K =   459  1436  1856
Test passed: M N K =   489  1388  1408
Test passed: M N K =   146  1314   640
Test passed: M N K =  1666   277  1664
M N K =  4096  4096   256, Elapsed time =   0.001731 s, Result = 003c0000, Performance =  49.63 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003378 s, Result = 00780000, Performance =  50.86 TOPS
M N K =  4096  4096   768, Elapsed time =   0.005312 s, Result = 00b40000, Performance =  48.51 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.008861 s, Result = 00f00000, Performance =  38.78 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005820 s, Result = 012c0000, Performance =  73.79 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.014612 s, Result = 01680000, Performance =  35.27 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008407 s, Result = 01a40000, Performance =  71.52 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010106 s, Result = 01e00000, Performance =  68.00 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.011646 s, Result = 021c0000, Performance =  66.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013047 s, Result = 02580000, Performance =  65.84 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.014525 s, Result = 02940000, Performance =  65.05 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015989 s, Result = 02d00000, Performance =  64.47 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017789 s, Result = 030c0000, Performance =  62.78 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.020064 s, Result = 03480000, Performance =  59.94 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.022540 s, Result = 03840000, Performance =  57.16 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.025568 s, Result = 03c00000, Performance =  53.76 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.028801 s, Result = 03fc0000, Performance =  50.70 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.031604 s, Result = 04380000, Performance =  48.92 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.035532 s, Result = 04740000, Performance =  45.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.038236 s, Result = 04b00000, Performance =  44.93 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.042119 s, Result = 04ec0000, Performance =  42.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.046059 s, Result = 05280000, Performance =  41.03 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.049892 s, Result = 05640000, Performance =  39.60 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061308 s, Result = 05a00000, Performance =  33.63 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.061600 s, Result = 05dc0000, Performance =  34.86 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.066569 s, Result = 06180000, Performance =  33.55 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.069590 s, Result = 06540000, Performance =  33.33 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.071799 s, Result = 06900000, Performance =  33.50 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.075626 s, Result = 06cc0000, Performance =  32.94 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.077485 s, Result = 07080000, Performance =  33.26 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.080932 s, Result = 07440000, Performance =  32.90 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.096217 s, Result = 07800000, Performance =  28.57 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.086206 s, Result = 07bc0000, Performance =  32.88 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.089926 s, Result = 07f80000, Performance =  32.48 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.089858 s, Result = 08340000, Performance =  33.46 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.088074 s, Result = 08700000, Performance =  35.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.091322 s, Result = 08ac0000, Performance =  34.80 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.093764 s, Result = 08e80000, Performance =  34.81 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.097174 s, Result = 09240000, Performance =  34.47 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.098408 s, Result = 09600000, Performance =  34.92 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.101468 s, Result = 099c0000, Performance =  34.71 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.104855 s, Result = 09d80000, Performance =  34.41 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.111681 s, Result = 0a140000, Performance =  33.07 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.106310 s, Result = 0a500000, Performance =  35.55 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.110954 s, Result = 0a8c0000, Performance =  34.84 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.114421 s, Result = 0ac80000, Performance =  34.53 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.117984 s, Result = 0b040000, Performance =  34.22 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.119433 s, Result = 0b400000, Performance =  34.52 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.121882 s, Result = 0b7c0000, Performance =  34.53 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.125518 s, Result = 0bb80000, Performance =  34.22 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.131130 s, Result = 0bf40000, Performance =  33.41 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.129904 s, Result = 0c300000, Performance =  34.39 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.134869 s, Result = 0c6c0000, Performance =  33.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.138703 s, Result = 0ca80000, Performance =  33.44 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.145352 s, Result = 0ce40000, Performance =  32.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.146205 s, Result = 0d200000, Performance =  32.90 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.154804 s, Result = 0d5c0000, Performance =  31.63 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.154081 s, Result = 0d980000, Performance =  32.33 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.150802 s, Result = 0dd40000, Performance =  33.61 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.147513 s, Result = 0e100000, Performance =  34.94 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.157547 s, Result = 0e4c0000, Performance =  33.26 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.160864 s, Result = 0e880000, Performance =  33.11 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.160186 s, Result = 0ec40000, Performance =  33.78 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.226809 s, Result = 0f000000, Performance =  24.24 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    23  1508  1280
Test passed: M N K =   829   934  1408
Test passed: M N K =   681   416    64
Test passed: M N K =  1610  1555  1152
Test passed: M N K =     2  1025  1088
M N K =  4096  4096   256, Elapsed time =   0.025726 s, Result = 50420000, Performance =   3.34 TOPS
M N K =  4096  4096   512, Elapsed time =   0.028313 s, Result = 90740000, Performance =   6.07 TOPS
M N K =  4096  4096   768, Elapsed time =   0.031103 s, Result = d0a60000, Performance =   8.29 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034346 s, Result = 10d80000, Performance =  10.00 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.036939 s, Result = 510a0000, Performance =  11.63 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040312 s, Result = 913c0000, Performance =  12.79 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.044540 s, Result = d16e0000, Performance =  13.50 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.049583 s, Result = 11a00000, Performance =  13.86 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.053387 s, Result = 51d20000, Performance =  14.48 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.056536 s, Result = 92040000, Performance =  15.19 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.054563 s, Result = d2360000, Performance =  17.32 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.057038 s, Result = 12680000, Performance =  18.07 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.060424 s, Result = 529a0000, Performance =  18.48 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.063882 s, Result = 92cc0000, Performance =  18.83 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.066929 s, Result = d2fe0000, Performance =  19.25 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.073119 s, Result = 13300000, Performance =  18.80 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.074621 s, Result = 53620000, Performance =  19.57 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.076517 s, Result = 93940000, Performance =  20.21 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.077353 s, Result = d3c60000, Performance =  21.10 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.080726 s, Result = 13f80000, Performance =  21.28 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.085578 s, Result = 542a0000, Performance =  21.08 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.088309 s, Result = 945c0000, Performance =  21.40 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.092693 s, Result = d48e0000, Performance =  21.31 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.095920 s, Result = 14c00000, Performance =  21.49 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.101084 s, Result = 54f20000, Performance =  21.24 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.103865 s, Result = 95240000, Performance =  21.50 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.124791 s, Result = d5560000, Performance =  18.59 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.112330 s, Result = 15880000, Performance =  21.41 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.112938 s, Result = 55ba0000, Performance =  22.06 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.117639 s, Result = 95ec0000, Performance =  21.91 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.125043 s, Result = d61e0000, Performance =  21.30 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.131917 s, Result = 16500000, Performance =  20.84 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.121588 s, Result = 56820000, Performance =  23.31 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.123581 s, Result = 96b40000, Performance =  23.63 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.127260 s, Result = d6e60000, Performance =  23.62 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.129949 s, Result = 17180000, Performance =  23.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.134590 s, Result = 574a0000, Performance =  23.61 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.138503 s, Result = 977c0000, Performance =  23.57 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.144357 s, Result = d7ae0000, Performance =  23.21 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.146255 s, Result = 17e00000, Performance =  23.49 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.151084 s, Result = 58120000, Performance =  23.31 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.154196 s, Result = 98440000, Performance =  23.40 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.161826 s, Result = d8760000, Performance =  22.82 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.159263 s, Result = 18a80000, Performance =  23.73 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.158299 s, Result = 58da0000, Performance =  24.42 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.158340 s, Result = 990c0000, Performance =  24.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.159293 s, Result = d93e0000, Performance =  25.34 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.160366 s, Result = 19700000, Performance =  25.71 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.159783 s, Result = 59a20000, Performance =  26.34 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.169346 s, Result = 99d40000, Performance =  25.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.173730 s, Result = da060000, Performance =  25.22 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.172818 s, Result = 1a380000, Performance =  25.85 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.173983 s, Result = 5a6a0000, Performance =  26.17 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.177864 s, Result = 9a9c0000, Performance =  26.08 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.178370 s, Result = dace0000, Performance =  26.49 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.177324 s, Result = 1b000000, Performance =  27.13 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.180173 s, Result = 5b320000, Performance =  27.18 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.183173 s, Result = 9b640000, Performance =  27.20 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.178887 s, Result = db960000, Performance =  28.33 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.179823 s, Result = 1bc80000, Performance =  28.66 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.181652 s, Result = 5bfa0000, Performance =  28.85 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.192009 s, Result = 9c2c0000, Performance =  27.74 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.186507 s, Result = dc5e0000, Performance =  29.02 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.237128 s, Result = 1c900000, Performance =  23.18 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1187  1606   960
Test passed: M N K =  1316   905  1216
Test passed: M N K =   465  1288   192
Test passed: M N K =  1022   537   960
Test passed: M N K =  1906   174   832
M N K =  4096  4096   256, Elapsed time =   0.020011 s, Result = 00320000, Performance =   4.29 TOPS
M N K =  4096  4096   512, Elapsed time =   0.020296 s, Result = 00640000, Performance =   8.46 TOPS
M N K =  4096  4096   768, Elapsed time =   0.029530 s, Result = 00960000, Performance =   8.73 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.023713 s, Result = 00c80000, Performance =  14.49 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028882 s, Result = 00fa0000, Performance =  14.87 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.028109 s, Result = 012c0000, Performance =  18.34 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.028550 s, Result = 015e0000, Performance =  21.06 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.048191 s, Result = 01900000, Performance =  14.26 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.032446 s, Result = 01c20000, Performance =  23.83 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.034507 s, Result = 01f40000, Performance =  24.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.037097 s, Result = 02260000, Performance =  25.47 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.040401 s, Result = 02580000, Performance =  25.51 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.044064 s, Result = 028a0000, Performance =  25.34 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.049158 s, Result = 02bc0000, Performance =  24.46 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051222 s, Result = 02ee0000, Performance =  25.16 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.054783 s, Result = 03200000, Performance =  25.09 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.057338 s, Result = 03520000, Performance =  25.47 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.061009 s, Result = 03840000, Performance =  25.34 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.064290 s, Result = 03b60000, Performance =  25.39 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.068088 s, Result = 03e80000, Performance =  25.23 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.075594 s, Result = 041a0000, Performance =  23.86 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.080318 s, Result = 044c0000, Performance =  23.53 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.084283 s, Result = 047e0000, Performance =  23.44 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.091484 s, Result = 04b00000, Performance =  22.53 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.095485 s, Result = 04e20000, Performance =  22.49 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.100191 s, Result = 05140000, Performance =  22.29 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.103775 s, Result = 05460000, Performance =  22.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.105829 s, Result = 05780000, Performance =  22.73 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.108288 s, Result = 05aa0000, Performance =  23.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.110858 s, Result = 05dc0000, Performance =  23.25 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.115572 s, Result = 060e0000, Performance =  23.04 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.122699 s, Result = 06400000, Performance =  22.40 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.112208 s, Result = 06720000, Performance =  25.26 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.113867 s, Result = 06a40000, Performance =  25.65 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.117032 s, Result = 06d60000, Performance =  25.69 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.120358 s, Result = 07080000, Performance =  25.69 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.124583 s, Result = 073a0000, Performance =  25.51 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.128092 s, Result = 076c0000, Performance =  25.48 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.135191 s, Result = 079e0000, Performance =  24.78 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.139281 s, Result = 07d00000, Performance =  24.67 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.144621 s, Result = 08020000, Performance =  24.35 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.147904 s, Result = 08340000, Performance =  24.39 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.154488 s, Result = 08660000, Performance =  23.91 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.154093 s, Result = 08980000, Performance =  24.53 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.149785 s, Result = 08ca0000, Performance =  25.81 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.148046 s, Result = 08fc0000, Performance =  26.69 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.148918 s, Result = 092e0000, Performance =  27.11 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.149901 s, Result = 09600000, Performance =  27.51 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.149523 s, Result = 09920000, Performance =  28.15 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.151344 s, Result = 09c40000, Performance =  28.38 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.153446 s, Result = 09f60000, Performance =  28.55 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.152905 s, Result = 0a280000, Performance =  29.21 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.156188 s, Result = 0a5a0000, Performance =  29.15 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.159419 s, Result = 0a8c0000, Performance =  29.10 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.169087 s, Result = 0abe0000, Performance =  27.94 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.168193 s, Result = 0af00000, Performance =  28.60 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.169953 s, Result = 0b220000, Performance =  28.81 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.172088 s, Result = 0b540000, Performance =  28.95 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.172312 s, Result = 0b860000, Performance =  29.41 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.169222 s, Result = 0bb80000, Performance =  30.46 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.171648 s, Result = 0bea0000, Performance =  30.53 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.182025 s, Result = 0c1c0000, Performance =  29.26 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.176565 s, Result = 0c4e0000, Performance =  30.65 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.221882 s, Result = 0c800000, Performance =  24.78 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   137   491   128
Test passed: M N K =  1479  1611  1408
Test passed: M N K =     9    93  1152
Test passed: M N K =   443   648  1216
Test passed: M N K =  1851    28   768
M N K =  4096  4096   256, Elapsed time =   0.015769 s, Result = a0d20000, Performance =   5.45 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015914 s, Result = a1040000, Performance =  10.80 TOPS
M N K =  4096  4096   768, Elapsed time =   0.017415 s, Result = a1360000, Performance =  14.80 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.018007 s, Result = a1680000, Performance =  19.08 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.019486 s, Result = a19a0000, Performance =  22.04 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.020867 s, Result = a1cc0000, Performance =  24.70 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023216 s, Result = a1fe0000, Performance =  25.90 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.024034 s, Result = a2300000, Performance =  28.59 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.025904 s, Result = a2620000, Performance =  29.84 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.027318 s, Result = a2940000, Performance =  31.44 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.029408 s, Result = a2c60000, Performance =  32.13 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.031433 s, Result = a2f80000, Performance =  32.79 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.034185 s, Result = a32a0000, Performance =  32.67 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.037565 s, Result = a35c0000, Performance =  32.01 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.042112 s, Result = a38e0000, Performance =  30.60 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.045717 s, Result = a3c00000, Performance =  30.06 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.047759 s, Result = a3f20000, Performance =  30.58 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.050700 s, Result = a4240000, Performance =  30.50 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.052381 s, Result = a4560000, Performance =  31.16 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.057534 s, Result = a4880000, Performance =  29.86 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.058500 s, Result = a4ba0000, Performance =  30.84 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.061692 s, Result = a4ec0000, Performance =  30.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.065978 s, Result = a51e0000, Performance =  29.94 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.069178 s, Result = a5500000, Performance =  29.80 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.072926 s, Result = a5820000, Performance =  29.45 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.076265 s, Result = a5b40000, Performance =  29.28 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.079740 s, Result = a5e60000, Performance =  29.09 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.083009 s, Result = a6180000, Performance =  28.97 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.090497 s, Result = a64a0000, Performance =  27.53 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.094890 s, Result = a67c0000, Performance =  27.16 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.099106 s, Result = a6ae0000, Performance =  26.87 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.106416 s, Result = a6e00000, Performance =  25.83 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.095343 s, Result = a7120000, Performance =  29.73 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.096644 s, Result = a7440000, Performance =  30.22 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.099806 s, Result = a7760000, Performance =  30.12 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.102708 s, Result = a7a80000, Performance =  30.11 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.107022 s, Result = a7da0000, Performance =  29.70 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.111357 s, Result = a80c0000, Performance =  29.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.118043 s, Result = a83e0000, Performance =  28.38 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.122138 s, Result = a8700000, Performance =  28.13 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.124450 s, Result = a8a20000, Performance =  28.30 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.125868 s, Result = a8d40000, Performance =  28.66 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.135341 s, Result = a9060000, Performance =  27.29 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.132002 s, Result = a9380000, Performance =  28.63 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.132082 s, Result = a96a0000, Performance =  29.27 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.131992 s, Result = a99c0000, Performance =  29.94 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.131918 s, Result = a9ce0000, Performance =  30.60 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.135691 s, Result = aa000000, Performance =  30.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.132806 s, Result = aa320000, Performance =  31.69 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.135094 s, Result = aa640000, Performance =  31.79 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.138545 s, Result = aa960000, Performance =  31.62 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.139523 s, Result = aac80000, Performance =  32.01 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.142129 s, Result = aafa0000, Performance =  32.03 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.153199 s, Result = ab2c0000, Performance =  30.28 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.149927 s, Result = ab5e0000, Performance =  31.51 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.150253 s, Result = ab900000, Performance =  32.02 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.151484 s, Result = abc20000, Performance =  32.32 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.154303 s, Result = abf40000, Performance =  32.29 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.150484 s, Result = ac260000, Performance =  33.68 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.151669 s, Result = ac580000, Performance =  33.98 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.153940 s, Result = ac8a0000, Performance =  34.04 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.164647 s, Result = acbc0000, Performance =  32.35 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.159270 s, Result = acee0000, Performance =  33.98 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.211551 s, Result = ad200000, Performance =  25.99 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1407  1853  1088
Test passed: M N K =   634  1076   576
Test passed: M N K =  1875  1239  1792
Test passed: M N K =   467   144   384
Test passed: M N K =   225    60  1472
M N K =  4096  4096   256, Elapsed time =   0.001545 s, Result = 00320000, Performance =  55.61 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003185 s, Result = 00640000, Performance =  53.95 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011687 s, Result = 00960000, Performance =  22.05 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.011670 s, Result = 00c80000, Performance =  29.44 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.012130 s, Result = 00fa0000, Performance =  35.41 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.013149 s, Result = 012c0000, Performance =  39.20 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007462 s, Result = 015e0000, Performance =  80.58 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.017085 s, Result = 01900000, Performance =  40.22 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009736 s, Result = 01c20000, Performance =  79.41 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011469 s, Result = 01f40000, Performance =  74.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.013026 s, Result = 02260000, Performance =  72.54 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.015416 s, Result = 02580000, Performance =  66.87 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017168 s, Result = 028a0000, Performance =  65.05 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019691 s, Result = 02bc0000, Performance =  61.07 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.023224 s, Result = 02ee0000, Performance =  55.48 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.026029 s, Result = 03200000, Performance =  52.80 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.027788 s, Result = 03520000, Performance =  52.55 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.030465 s, Result = 03840000, Performance =  50.75 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.034278 s, Result = 03b60000, Performance =  47.61 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.037987 s, Result = 03e80000, Performance =  45.23 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.041592 s, Result = 041a0000, Performance =  43.37 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.048937 s, Result = 044c0000, Performance =  38.62 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057391 s, Result = 047e0000, Performance =  34.42 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.062153 s, Result = 04b00000, Performance =  33.17 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.067218 s, Result = 04e20000, Performance =  31.95 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.070194 s, Result = 05140000, Performance =  31.82 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.086057 s, Result = 05460000, Performance =  26.95 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.076675 s, Result = 05780000, Performance =  31.37 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.080266 s, Result = 05aa0000, Performance =  31.04 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.082164 s, Result = 05dc0000, Performance =  31.36 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.088727 s, Result = 060e0000, Performance =  30.01 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.095179 s, Result = 06400000, Performance =  28.88 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.085582 s, Result = 06720000, Performance =  33.12 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.086640 s, Result = 06a40000, Performance =  33.71 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.089600 s, Result = 06d60000, Performance =  33.55 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.091822 s, Result = 07080000, Performance =  33.68 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.096129 s, Result = 073a0000, Performance =  33.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.100527 s, Result = 076c0000, Performance =  32.47 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.104364 s, Result = 079e0000, Performance =  32.10 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.111800 s, Result = 07d00000, Performance =  30.73 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.114145 s, Result = 08020000, Performance =  30.85 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.120820 s, Result = 08340000, Performance =  29.86 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.130849 s, Result = 08660000, Performance =  28.23 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.127916 s, Result = 08980000, Performance =  29.55 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.123781 s, Result = 08ca0000, Performance =  31.23 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.131137 s, Result = 08fc0000, Performance =  30.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.131422 s, Result = 092e0000, Performance =  30.72 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.132510 s, Result = 09600000, Performance =  31.12 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.132803 s, Result = 09920000, Performance =  31.69 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.134464 s, Result = 09c40000, Performance =  31.94 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.137179 s, Result = 09f60000, Performance =  31.94 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.136563 s, Result = 0a280000, Performance =  32.71 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.139295 s, Result = 0a5a0000, Performance =  32.68 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.141438 s, Result = 0a8c0000, Performance =  32.80 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.141635 s, Result = 0abe0000, Performance =  33.36 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.142287 s, Result = 0af00000, Performance =  33.81 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.143493 s, Result = 0b220000, Performance =  34.12 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.146723 s, Result = 0b540000, Performance =  33.96 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.142991 s, Result = 0b860000, Performance =  35.44 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.143059 s, Result = 0bb80000, Performance =  36.03 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.146479 s, Result = 0bea0000, Performance =  35.77 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.156953 s, Result = 0c1c0000, Performance =  33.93 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.151754 s, Result = 0c4e0000, Performance =  35.66 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.205277 s, Result = 0c800000, Performance =  26.78 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    46  1002  1408
Test passed: M N K =  1154  2035  2048
Test passed: M N K =  1715  1875  1984
Test passed: M N K =  1909  1701   192
Test passed: M N K =  1384  1599  1664
M N K =  4096  4096   256, Elapsed time =   0.025882 s, Result = 50420000, Performance =   3.32 TOPS
M N K =  4096  4096   512, Elapsed time =   0.027787 s, Result = 90740000, Performance =   6.18 TOPS
M N K =  4096  4096   768, Elapsed time =   0.030053 s, Result = d0a60000, Performance =   8.57 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.033873 s, Result = 10d80000, Performance =  10.14 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.036702 s, Result = 510a0000, Performance =  11.70 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.038855 s, Result = 913c0000, Performance =  13.26 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.041842 s, Result = d16e0000, Performance =  14.37 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.052890 s, Result = 11a00000, Performance =  12.99 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.057361 s, Result = 51d20000, Performance =  13.48 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.058919 s, Result = 92040000, Performance =  14.58 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.049604 s, Result = d2360000, Performance =  19.05 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.054554 s, Result = 12680000, Performance =  18.89 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.062470 s, Result = 529a0000, Performance =  17.88 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.060099 s, Result = 92cc0000, Performance =  20.01 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.062014 s, Result = d2fe0000, Performance =  20.78 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.066633 s, Result = 13300000, Performance =  20.63 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.069396 s, Result = 53620000, Performance =  21.04 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.076105 s, Result = 93940000, Performance =  20.32 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.079502 s, Result = d3c60000, Performance =  20.53 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.082529 s, Result = 13f80000, Performance =  20.82 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.086117 s, Result = 542a0000, Performance =  20.95 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.088842 s, Result = 945c0000, Performance =  21.27 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.096683 s, Result = d48e0000, Performance =  20.43 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.091262 s, Result = 14c00000, Performance =  22.59 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.097466 s, Result = 54f20000, Performance =  22.03 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.101607 s, Result = 95240000, Performance =  21.98 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.103241 s, Result = d5560000, Performance =  22.46 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.105838 s, Result = 15880000, Performance =  22.73 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.107448 s, Result = 55ba0000, Performance =  23.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.109208 s, Result = 95ec0000, Performance =  23.60 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.111943 s, Result = d61e0000, Performance =  23.79 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.131975 s, Result = 16500000, Performance =  20.83 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.116039 s, Result = 56820000, Performance =  24.43 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.112283 s, Result = 96b40000, Performance =  26.01 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.117113 s, Result = d6e60000, Performance =  25.67 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.118533 s, Result = 17180000, Performance =  26.09 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.123177 s, Result = 574a0000, Performance =  25.80 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.123377 s, Result = 977c0000, Performance =  26.46 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.126066 s, Result = d7ae0000, Performance =  26.57 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.129191 s, Result = 17e00000, Performance =  26.60 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.132205 s, Result = 58120000, Performance =  26.64 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.135213 s, Result = 98440000, Performance =  26.68 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.141650 s, Result = d8760000, Performance =  26.08 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.140265 s, Result = 18a80000, Performance =  26.95 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.143250 s, Result = 58da0000, Performance =  26.98 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.144481 s, Result = 990c0000, Performance =  27.35 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.146494 s, Result = d93e0000, Performance =  27.56 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.147338 s, Result = 19700000, Performance =  27.98 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.149723 s, Result = 59a20000, Performance =  28.11 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.151988 s, Result = 99d40000, Performance =  28.26 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.154930 s, Result = da060000, Performance =  28.28 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.153070 s, Result = 1a380000, Performance =  29.18 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.155829 s, Result = 5a6a0000, Performance =  29.22 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.158926 s, Result = 9a9c0000, Performance =  29.19 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.159819 s, Result = dace0000, Performance =  29.56 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.160118 s, Result = 1b000000, Performance =  30.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.163220 s, Result = 5b320000, Performance =  30.00 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.164970 s, Result = 9b640000, Performance =  30.20 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.165544 s, Result = db960000, Performance =  30.61 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.162438 s, Result = 1bc80000, Performance =  31.73 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.168372 s, Result = 5bfa0000, Performance =  31.12 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.168868 s, Result = 9c2c0000, Performance =  31.54 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.176366 s, Result = dc5e0000, Performance =  30.68 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.229082 s, Result = 1c900000, Performance =  24.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   276  1507   960
Test passed: M N K =   685    49   960
Test passed: M N K =  1486   601  1152
Test passed: M N K =    16   906  1280
Test passed: M N K =   232  1272   896
M N K =  4096  4096   256, Elapsed time =   0.020052 s, Result = 00320000, Performance =   4.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.020256 s, Result = 00640000, Performance =   8.48 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023504 s, Result = 00960000, Performance =  10.96 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.024268 s, Result = 00c80000, Performance =  14.16 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028175 s, Result = 00fa0000, Performance =  15.24 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.028091 s, Result = 012c0000, Performance =  18.35 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.028876 s, Result = 015e0000, Performance =  20.82 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029886 s, Result = 01900000, Performance =  22.99 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.032375 s, Result = 01c20000, Performance =  23.88 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.033622 s, Result = 01f40000, Performance =  25.55 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.035116 s, Result = 02260000, Performance =  26.91 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.036941 s, Result = 02580000, Performance =  27.90 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.039240 s, Result = 028a0000, Performance =  28.46 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.041801 s, Result = 02bc0000, Performance =  28.77 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.044883 s, Result = 02ee0000, Performance =  28.71 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.055825 s, Result = 03200000, Performance =  24.62 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.059022 s, Result = 03520000, Performance =  24.74 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.062017 s, Result = 03840000, Performance =  24.93 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.060981 s, Result = 03b60000, Performance =  26.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060886 s, Result = 03e80000, Performance =  28.22 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.064934 s, Result = 041a0000, Performance =  27.78 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.068516 s, Result = 044c0000, Performance =  27.58 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.076330 s, Result = 047e0000, Performance =  25.88 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.077761 s, Result = 04b00000, Performance =  26.51 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.084046 s, Result = 04e20000, Performance =  25.55 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.088392 s, Result = 05140000, Performance =  25.27 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.091408 s, Result = 05460000, Performance =  25.37 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.095029 s, Result = 05780000, Performance =  25.31 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.097700 s, Result = 05aa0000, Performance =  25.50 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.099514 s, Result = 05dc0000, Performance =  25.90 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.102379 s, Result = 060e0000, Performance =  26.01 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.121743 s, Result = 06400000, Performance =  22.58 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.106704 s, Result = 06720000, Performance =  26.57 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.100986 s, Result = 06a40000, Performance =  28.92 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.103711 s, Result = 06d60000, Performance =  28.99 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.105770 s, Result = 07080000, Performance =  29.24 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.109798 s, Result = 073a0000, Performance =  28.95 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.112087 s, Result = 076c0000, Performance =  29.12 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.116519 s, Result = 079e0000, Performance =  28.75 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.118524 s, Result = 07d00000, Performance =  28.99 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.122504 s, Result = 08020000, Performance =  28.75 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.126026 s, Result = 08340000, Performance =  28.63 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.133345 s, Result = 08660000, Performance =  27.70 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.130611 s, Result = 08980000, Performance =  28.94 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.134231 s, Result = 08ca0000, Performance =  28.80 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.133798 s, Result = 08fc0000, Performance =  29.53 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.132746 s, Result = 092e0000, Performance =  30.41 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.137284 s, Result = 09600000, Performance =  30.03 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.135525 s, Result = 09920000, Performance =  31.06 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.141056 s, Result = 09c40000, Performance =  30.45 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.141945 s, Result = 09f60000, Performance =  30.86 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.138985 s, Result = 0a280000, Performance =  32.14 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.144993 s, Result = 0a5a0000, Performance =  31.40 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.146747 s, Result = 0a8c0000, Performance =  31.61 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.148387 s, Result = 0abe0000, Performance =  31.84 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.147945 s, Result = 0af00000, Performance =  32.51 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.150755 s, Result = 0b220000, Performance =  32.48 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.152370 s, Result = 0b540000, Performance =  32.70 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.154411 s, Result = 0b860000, Performance =  32.82 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.151789 s, Result = 0bb80000, Performance =  33.95 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.156095 s, Result = 0bea0000, Performance =  33.57 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.158526 s, Result = 0c1c0000, Performance =  33.60 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.166294 s, Result = 0c4e0000, Performance =  32.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.218416 s, Result = 0c800000, Performance =  25.17 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   295   648  1920
Test passed: M N K =  1857  1506   768
Test passed: M N K =   575   706   704
Test passed: M N K =  1700   617  2048
Test passed: M N K =  1369  1836  1152
M N K =  4096  4096   256, Elapsed time =   0.016277 s, Result = a0d20000, Performance =   5.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015940 s, Result = a1040000, Performance =  10.78 TOPS
M N K =  4096  4096   768, Elapsed time =   0.017553 s, Result = a1360000, Performance =  14.68 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017818 s, Result = a1680000, Performance =  19.28 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.020245 s, Result = a19a0000, Performance =  21.22 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.020632 s, Result = a1cc0000, Performance =  24.98 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.022643 s, Result = a1fe0000, Performance =  26.56 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.031332 s, Result = a2300000, Performance =  21.93 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.025722 s, Result = a2620000, Performance =  30.06 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.027193 s, Result = a2940000, Performance =  31.59 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.028351 s, Result = a2c60000, Performance =  33.33 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.029992 s, Result = a2f80000, Performance =  34.37 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.033209 s, Result = a32a0000, Performance =  33.63 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.033788 s, Result = a35c0000, Performance =  35.59 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.037098 s, Result = a38e0000, Performance =  34.73 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.040599 s, Result = a3c00000, Performance =  33.85 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.044147 s, Result = a3f20000, Performance =  33.08 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.045913 s, Result = a4240000, Performance =  33.68 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.048770 s, Result = a4560000, Performance =  33.47 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.051753 s, Result = a4880000, Performance =  33.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.055719 s, Result = a4ba0000, Performance =  32.37 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.059359 s, Result = a4ec0000, Performance =  31.84 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.062980 s, Result = a51e0000, Performance =  31.37 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.074707 s, Result = a5500000, Performance =  27.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069318 s, Result = a5820000, Performance =  30.98 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.072498 s, Result = a5b40000, Performance =  30.81 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.075228 s, Result = a5e60000, Performance =  30.83 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.082685 s, Result = a6180000, Performance =  29.09 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.084990 s, Result = a64a0000, Performance =  29.31 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.086902 s, Result = a67c0000, Performance =  29.65 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.089106 s, Result = a6ae0000, Performance =  29.88 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.109411 s, Result = a6e00000, Performance =  25.12 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.092666 s, Result = a7120000, Performance =  30.59 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.088724 s, Result = a7440000, Performance =  32.92 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.090880 s, Result = a7760000, Performance =  33.08 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.093006 s, Result = a7a80000, Performance =  33.25 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.097431 s, Result = a7da0000, Performance =  32.62 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.099721 s, Result = a80c0000, Performance =  32.73 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.103601 s, Result = a83e0000, Performance =  32.34 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.107722 s, Result = a8700000, Performance =  31.90 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.111206 s, Result = a8a20000, Performance =  31.67 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.112680 s, Result = a8d40000, Performance =  32.02 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.116844 s, Result = a9060000, Performance =  31.61 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.117140 s, Result = a9380000, Performance =  32.27 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.118765 s, Result = a96a0000, Performance =  32.55 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.119456 s, Result = a99c0000, Performance =  33.08 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.121526 s, Result = a9ce0000, Performance =  33.22 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.123856 s, Result = aa000000, Performance =  33.29 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.124834 s, Result = aa320000, Performance =  33.72 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.128126 s, Result = aa640000, Performance =  33.52 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.132042 s, Result = aa960000, Performance =  33.18 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.129949 s, Result = aac80000, Performance =  34.37 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.131704 s, Result = aafa0000, Performance =  34.57 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.134469 s, Result = ab2c0000, Performance =  34.50 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.136571 s, Result = ab5e0000, Performance =  34.59 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.137284 s, Result = ab900000, Performance =  35.04 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.140914 s, Result = abc20000, Performance =  34.75 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.141922 s, Result = abf40000, Performance =  35.10 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.142960 s, Result = ac260000, Performance =  35.45 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.138340 s, Result = ac580000, Performance =  37.26 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.146892 s, Result = ac8a0000, Performance =  35.67 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.146092 s, Result = acbc0000, Performance =  36.45 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.152519 s, Result = acee0000, Performance =  35.48 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.206080 s, Result = ad200000, Performance =  26.68 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   619   698  1024
Test passed: M N K =  1339  1936   960
Test passed: M N K =  1077   567   640
Test passed: M N K =  1004   903  1088
Test passed: M N K =   671   235   960
M N K =  4096  4096   256, Elapsed time =   0.001568 s, Result = 00320000, Performance =  54.79 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003068 s, Result = 00640000, Performance =  55.99 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011668 s, Result = 00960000, Performance =  22.09 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004436 s, Result = 00c80000, Performance =  77.45 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005663 s, Result = 00fa0000, Performance =  75.84 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.006517 s, Result = 012c0000, Performance =  79.09 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013823 s, Result = 015e0000, Performance =  43.50 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.009298 s, Result = 01900000, Performance =  73.91 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.018988 s, Result = 01c20000, Performance =  40.71 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011775 s, Result = 01f40000, Performance =  72.95 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012049 s, Result = 02260000, Performance =  78.42 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013921 s, Result = 02580000, Performance =  74.05 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.025067 s, Result = 028a0000, Performance =  44.55 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018856 s, Result = 02bc0000, Performance =  63.78 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.021589 s, Result = 02ee0000, Performance =  59.68 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022398 s, Result = 03200000, Performance =  61.36 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.025748 s, Result = 03520000, Performance =  56.71 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.029680 s, Result = 03840000, Performance =  52.10 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.031532 s, Result = 03b60000, Performance =  51.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.035557 s, Result = 03e80000, Performance =  48.32 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.043564 s, Result = 041a0000, Performance =  41.41 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.049864 s, Result = 044c0000, Performance =  37.90 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.054196 s, Result = 047e0000, Performance =  36.45 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.053850 s, Result = 04b00000, Performance =  38.28 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.054056 s, Result = 04e20000, Performance =  39.73 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.061975 s, Result = 05140000, Performance =  36.04 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.065591 s, Result = 05460000, Performance =  35.36 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.069707 s, Result = 05780000, Performance =  34.50 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.071506 s, Result = 05aa0000, Performance =  34.84 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.073609 s, Result = 05dc0000, Performance =  35.01 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.076778 s, Result = 060e0000, Performance =  34.68 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.095085 s, Result = 06400000, Performance =  28.91 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.080175 s, Result = 06720000, Performance =  35.36 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.076474 s, Result = 06a40000, Performance =  38.19 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.078477 s, Result = 06d60000, Performance =  38.31 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.093739 s, Result = 07080000, Performance =  32.99 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.089675 s, Result = 073a0000, Performance =  35.44 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.091707 s, Result = 076c0000, Performance =  35.59 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.095973 s, Result = 079e0000, Performance =  34.91 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.096982 s, Result = 07d00000, Performance =  35.43 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.096795 s, Result = 08020000, Performance =  36.38 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.099872 s, Result = 08340000, Performance =  36.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.105688 s, Result = 08660000, Performance =  34.95 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.104970 s, Result = 08980000, Performance =  36.01 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.108172 s, Result = 08ca0000, Performance =  35.73 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.109954 s, Result = 08fc0000, Performance =  35.94 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.106946 s, Result = 092e0000, Performance =  37.75 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.110790 s, Result = 09600000, Performance =  37.22 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.111380 s, Result = 09920000, Performance =  37.79 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.115053 s, Result = 09c40000, Performance =  37.33 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.117879 s, Result = 09f60000, Performance =  37.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.117344 s, Result = 0a280000, Performance =  38.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.119946 s, Result = 0a5a0000, Performance =  37.96 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.121296 s, Result = 0a8c0000, Performance =  38.24 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.124809 s, Result = 0abe0000, Performance =  37.85 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.126900 s, Result = 0af00000, Performance =  37.91 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.130079 s, Result = 0b220000, Performance =  37.64 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.132068 s, Result = 0b540000, Performance =  37.72 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.130645 s, Result = 0b860000, Performance =  38.79 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.128160 s, Result = 0bb80000, Performance =  40.22 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.136042 s, Result = 0bea0000, Performance =  38.52 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.134151 s, Result = 0c1c0000, Performance =  39.70 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.141439 s, Result = 0c4e0000, Performance =  38.26 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.194189 s, Result = 0c800000, Performance =  28.31 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   655   970   448
Test passed: M N K =  1385   817  1920
Test passed: M N K =  1337  1578  1600
Test passed: M N K =  1742   582   192
Test passed: M N K =  1958   601  1984
M N K =  4096  4096   256, Elapsed time =   0.025864 s, Result = 50420000, Performance =   3.32 TOPS
M N K =  4096  4096   512, Elapsed time =   0.027814 s, Result = 90740000, Performance =   6.18 TOPS
M N K =  4096  4096   768, Elapsed time =   0.029930 s, Result = d0a60000, Performance =   8.61 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.032208 s, Result = 10d80000, Performance =  10.67 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.035166 s, Result = 510a0000, Performance =  12.21 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.037860 s, Result = 913c0000, Performance =  13.61 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.040342 s, Result = d16e0000, Performance =  14.90 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.042917 s, Result = 11a00000, Performance =  16.01 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.046616 s, Result = 51d20000, Performance =  16.58 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.050998 s, Result = 92040000, Performance =  16.84 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.052028 s, Result = d2360000, Performance =  18.16 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.053858 s, Result = 12680000, Performance =  19.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.061548 s, Result = 529a0000, Performance =  18.14 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.063613 s, Result = 92cc0000, Performance =  18.90 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.066024 s, Result = d2fe0000, Performance =  19.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.061457 s, Result = 13300000, Performance =  22.36 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.066946 s, Result = 53620000, Performance =  21.81 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.070292 s, Result = 93940000, Performance =  22.00 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.072920 s, Result = d3c60000, Performance =  22.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074387 s, Result = 13f80000, Performance =  23.10 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.078657 s, Result = 542a0000, Performance =  22.93 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.081261 s, Result = 945c0000, Performance =  23.26 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.084976 s, Result = d48e0000, Performance =  23.25 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.089118 s, Result = 14c00000, Performance =  23.13 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.091503 s, Result = 54f20000, Performance =  23.47 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.094016 s, Result = 95240000, Performance =  23.76 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.096703 s, Result = d5560000, Performance =  23.98 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.100241 s, Result = 15880000, Performance =  23.99 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.104400 s, Result = 55ba0000, Performance =  23.86 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.106155 s, Result = 95ec0000, Performance =  24.28 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.108976 s, Result = d61e0000, Performance =  24.44 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.122251 s, Result = 16500000, Performance =  22.48 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.112798 s, Result = 56820000, Performance =  25.13 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.116300 s, Result = 96b40000, Performance =  25.11 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.116668 s, Result = d6e60000, Performance =  25.77 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.113956 s, Result = 17180000, Performance =  27.14 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.126445 s, Result = 574a0000, Performance =  25.14 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.119519 s, Result = 977c0000, Performance =  27.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.122570 s, Result = d7ae0000, Performance =  27.33 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.123616 s, Result = 17e00000, Performance =  27.80 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.126388 s, Result = 58120000, Performance =  27.87 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.131185 s, Result = 98440000, Performance =  27.50 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.137750 s, Result = d8760000, Performance =  26.81 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.131337 s, Result = 18a80000, Performance =  28.78 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.135608 s, Result = 58da0000, Performance =  28.50 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.137905 s, Result = 990c0000, Performance =  28.65 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.139770 s, Result = d93e0000, Performance =  28.89 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.140962 s, Result = 19700000, Performance =  29.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.141037 s, Result = 59a20000, Performance =  29.84 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.145539 s, Result = 99d40000, Performance =  29.51 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.150373 s, Result = da060000, Performance =  29.13 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.146873 s, Result = 1a380000, Performance =  30.41 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.150480 s, Result = 5a6a0000, Performance =  30.25 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.152045 s, Result = 9a9c0000, Performance =  30.51 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.154619 s, Result = dace0000, Performance =  30.56 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.154194 s, Result = 1b000000, Performance =  31.20 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.157199 s, Result = 5b320000, Performance =  31.15 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.163486 s, Result = 9b640000, Performance =  30.47 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.163623 s, Result = db960000, Performance =  30.97 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.160065 s, Result = 1bc80000, Performance =  32.20 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.166434 s, Result = 5bfa0000, Performance =  31.48 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.168974 s, Result = 9c2c0000, Performance =  31.52 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.166263 s, Result = dc5e0000, Performance =  32.55 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.221848 s, Result = 1c900000, Performance =  24.78 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   269  1188   576
Test passed: M N K =  1704  1633  1856
Test passed: M N K =  2015   426  1536
Test passed: M N K =  1048  1259  1152
Test passed: M N K =   306   406    64
M N K =  4096  4096   256, Elapsed time =   0.020076 s, Result = 00320000, Performance =   4.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.020470 s, Result = 00640000, Performance =   8.39 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023801 s, Result = 00960000, Performance =  10.83 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.025186 s, Result = 00c80000, Performance =  13.64 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.040475 s, Result = 00fa0000, Performance =  10.61 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.026779 s, Result = 012c0000, Performance =  19.25 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.038092 s, Result = 015e0000, Performance =  15.79 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029801 s, Result = 01900000, Performance =  23.06 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.033239 s, Result = 01c20000, Performance =  23.26 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.033354 s, Result = 01f40000, Performance =  25.75 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.036596 s, Result = 02260000, Performance =  25.82 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.045406 s, Result = 02580000, Performance =  22.70 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.038665 s, Result = 028a0000, Performance =  28.88 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.040586 s, Result = 02bc0000, Performance =  29.63 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.042709 s, Result = 02ee0000, Performance =  30.17 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.044995 s, Result = 03200000, Performance =  30.55 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.051218 s, Result = 03520000, Performance =  28.51 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.054276 s, Result = 03840000, Performance =  28.49 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.055993 s, Result = 03b60000, Performance =  29.15 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.058543 s, Result = 03e80000, Performance =  29.35 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.062198 s, Result = 041a0000, Performance =  29.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.066060 s, Result = 044c0000, Performance =  28.61 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.069539 s, Result = 047e0000, Performance =  28.41 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.073806 s, Result = 04b00000, Performance =  27.93 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.075533 s, Result = 04e20000, Performance =  28.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.084712 s, Result = 05140000, Performance =  26.36 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.088631 s, Result = 05460000, Performance =  26.17 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.090481 s, Result = 05780000, Performance =  26.58 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.092475 s, Result = 05aa0000, Performance =  26.94 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.094822 s, Result = 05dc0000, Performance =  27.18 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.094711 s, Result = 060e0000, Performance =  28.12 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.108295 s, Result = 06400000, Performance =  25.38 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.098689 s, Result = 06720000, Performance =  28.72 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.101203 s, Result = 06a40000, Performance =  28.86 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.101708 s, Result = 06d60000, Performance =  29.56 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.100074 s, Result = 07080000, Performance =  30.90 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.102762 s, Result = 073a0000, Performance =  30.93 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.105570 s, Result = 076c0000, Performance =  30.92 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.108893 s, Result = 079e0000, Performance =  30.76 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.109578 s, Result = 07d00000, Performance =  31.36 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.112595 s, Result = 08020000, Performance =  31.28 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.115734 s, Result = 08340000, Performance =  31.17 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.122153 s, Result = 08660000, Performance =  30.24 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.118398 s, Result = 08980000, Performance =  31.92 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.120759 s, Result = 08ca0000, Performance =  32.01 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.123218 s, Result = 08fc0000, Performance =  32.07 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.124881 s, Result = 092e0000, Performance =  32.33 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.127358 s, Result = 09600000, Performance =  32.37 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.127391 s, Result = 09920000, Performance =  33.04 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.130384 s, Result = 09c40000, Performance =  32.94 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.134821 s, Result = 09f60000, Performance =  32.49 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.132082 s, Result = 0a280000, Performance =  33.82 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.136941 s, Result = 0a5a0000, Performance =  33.25 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.139475 s, Result = 0a8c0000, Performance =  33.26 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.144634 s, Result = 0abe0000, Performance =  32.66 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.145186 s, Result = 0af00000, Performance =  33.13 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.150590 s, Result = 0b220000, Performance =  32.51 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.149256 s, Result = 0b540000, Performance =  33.38 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.148373 s, Result = 0b860000, Performance =  34.16 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.144718 s, Result = 0bb80000, Performance =  35.61 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.152381 s, Result = 0bea0000, Performance =  34.39 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.155138 s, Result = 0c1c0000, Performance =  34.33 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.151231 s, Result = 0c4e0000, Performance =  35.78 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.206896 s, Result = 0c800000, Performance =  26.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1406   613  1216
Test passed: M N K =  2016   124   256
Test passed: M N K =    20   652  1856
Test passed: M N K =  1288   236   320
Test passed: M N K =   100  1564  1408
M N K =  4096  4096   256, Elapsed time =   0.015839 s, Result = a0d20000, Performance =   5.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015894 s, Result = a1040000, Performance =  10.81 TOPS
M N K =  4096  4096   768, Elapsed time =   0.017227 s, Result = a1360000, Performance =  14.96 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017724 s, Result = a1680000, Performance =  19.39 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.019229 s, Result = a19a0000, Performance =  22.34 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.020873 s, Result = a1cc0000, Performance =  24.69 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.024332 s, Result = a1fe0000, Performance =  24.71 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.024701 s, Result = a2300000, Performance =  27.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.026419 s, Result = a2620000, Performance =  29.26 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.036652 s, Result = a2940000, Performance =  23.44 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.037759 s, Result = a2c60000, Performance =  25.02 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.030042 s, Result = a2f80000, Performance =  34.31 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.040712 s, Result = a32a0000, Performance =  27.43 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.033001 s, Result = a35c0000, Performance =  36.44 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.034938 s, Result = a38e0000, Performance =  36.88 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.037245 s, Result = a3c00000, Performance =  36.90 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.039329 s, Result = a3f20000, Performance =  37.13 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.042744 s, Result = a4240000, Performance =  36.17 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.045301 s, Result = a4560000, Performance =  36.03 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.047107 s, Result = a4880000, Performance =  36.47 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.051016 s, Result = a4ba0000, Performance =  35.36 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.054405 s, Result = a4ec0000, Performance =  34.74 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057498 s, Result = a51e0000, Performance =  34.36 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061553 s, Result = a5500000, Performance =  33.49 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.063772 s, Result = a5820000, Performance =  33.67 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.070271 s, Result = a5b40000, Performance =  31.78 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.076530 s, Result = a5e60000, Performance =  30.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.078032 s, Result = a6180000, Performance =  30.82 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.081055 s, Result = a64a0000, Performance =  30.73 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.082206 s, Result = a67c0000, Performance =  31.35 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.084361 s, Result = a6ae0000, Performance =  31.57 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.098684 s, Result = a6e00000, Performance =  27.85 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.088107 s, Result = a7120000, Performance =  32.17 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.090443 s, Result = a7440000, Performance =  32.29 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.091127 s, Result = a7760000, Performance =  32.99 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.089259 s, Result = a7a80000, Performance =  34.64 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.097442 s, Result = a7da0000, Performance =  32.62 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.097946 s, Result = a80c0000, Performance =  33.33 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.100417 s, Result = a83e0000, Performance =  33.36 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.100913 s, Result = a8700000, Performance =  34.05 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.100305 s, Result = a8a20000, Performance =  35.11 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.104111 s, Result = a8d40000, Performance =  34.65 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.108643 s, Result = a9060000, Performance =  34.00 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.121850 s, Result = a9380000, Performance =  31.02 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.109165 s, Result = a96a0000, Performance =  35.41 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.111424 s, Result = a99c0000, Performance =  35.46 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.113180 s, Result = a9ce0000, Performance =  35.67 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.114316 s, Result = aa000000, Performance =  36.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.115969 s, Result = aa320000, Performance =  36.29 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.118972 s, Result = aa640000, Performance =  36.10 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.124557 s, Result = aa960000, Performance =  35.17 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.120508 s, Result = aac80000, Performance =  37.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.126702 s, Result = aafa0000, Performance =  35.93 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.127885 s, Result = ab2c0000, Performance =  36.27 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.132328 s, Result = ab5e0000, Performance =  35.70 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.132169 s, Result = ab900000, Performance =  36.40 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.138068 s, Result = abc20000, Performance =  35.46 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.139514 s, Result = abf40000, Performance =  35.71 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.137715 s, Result = ac260000, Performance =  36.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.134038 s, Result = ac580000, Performance =  38.45 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.143255 s, Result = ac8a0000, Performance =  36.58 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.144355 s, Result = acbc0000, Performance =  36.89 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.140959 s, Result = acee0000, Performance =  38.39 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.199863 s, Result = ad200000, Performance =  27.51 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=256 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 256 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   658   239  1792
Test passed: M N K =   952  1312    64
Test passed: M N K =  1795   568   896
Test passed: M N K =  1761   956  1792
Test passed: M N K =   443  1655  1984
M N K =  4096  4096   256, Elapsed time =   0.001541 s, Result = 00320000, Performance =  55.73 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003053 s, Result = 00640000, Performance =  56.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.013211 s, Result = 00960000, Performance =  19.51 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.012638 s, Result = 00c80000, Performance =  27.19 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004874 s, Result = 00fa0000, Performance =  88.11 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.015104 s, Result = 012c0000, Performance =  34.12 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007101 s, Result = 015e0000, Performance =  84.68 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010459 s, Result = 01900000, Performance =  65.70 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.009787 s, Result = 01c20000, Performance =  78.99 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011170 s, Result = 01f40000, Performance =  76.90 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012519 s, Result = 02260000, Performance =  75.47 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.013471 s, Result = 02580000, Performance =  76.52 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015054 s, Result = 028a0000, Performance =  74.18 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016963 s, Result = 02bc0000, Performance =  70.90 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018997 s, Result = 02ee0000, Performance =  67.83 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020843 s, Result = 03200000, Performance =  65.94 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023683 s, Result = 03520000, Performance =  61.66 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.026509 s, Result = 03840000, Performance =  58.33 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.028994 s, Result = 03b60000, Performance =  56.29 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.032039 s, Result = 03e80000, Performance =  53.62 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.035049 s, Result = 041a0000, Performance =  51.47 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.039358 s, Result = 044c0000, Performance =  48.02 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.042803 s, Result = 047e0000, Performance =  46.16 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.046358 s, Result = 04b00000, Performance =  44.47 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.050136 s, Result = 04e20000, Performance =  42.83 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.053879 s, Result = 05140000, Performance =  41.45 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.057153 s, Result = 05460000, Performance =  40.58 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.060341 s, Result = 05780000, Performance =  39.86 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.066799 s, Result = 05aa0000, Performance =  37.29 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.069536 s, Result = 05dc0000, Performance =  37.06 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.072546 s, Result = 060e0000, Performance =  36.71 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.085682 s, Result = 06400000, Performance =  32.08 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.078193 s, Result = 06720000, Performance =  36.25 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.080172 s, Result = 06a40000, Performance =  36.43 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.081048 s, Result = 06d60000, Performance =  37.10 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.079726 s, Result = 07080000, Performance =  38.79 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.087069 s, Result = 073a0000, Performance =  36.50 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.087463 s, Result = 076c0000, Performance =  37.32 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.089542 s, Result = 079e0000, Performance =  37.41 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.089937 s, Result = 07d00000, Performance =  38.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.090434 s, Result = 08020000, Performance =  38.94 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.093885 s, Result = 08340000, Performance =  38.43 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.099389 s, Result = 08660000, Performance =  37.16 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.095779 s, Result = 08980000, Performance =  39.46 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.098998 s, Result = 08ca0000, Performance =  39.05 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.100900 s, Result = 08fc0000, Performance =  39.16 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.103264 s, Result = 092e0000, Performance =  39.10 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.104280 s, Result = 09600000, Performance =  39.54 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.105825 s, Result = 09920000, Performance =  39.77 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.109016 s, Result = 09c40000, Performance =  39.40 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.115961 s, Result = 09f60000, Performance =  37.78 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.111471 s, Result = 0a280000, Performance =  40.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.116720 s, Result = 0a5a0000, Performance =  39.01 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.119028 s, Result = 0a8c0000, Performance =  38.97 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.130565 s, Result = 0abe0000, Performance =  36.18 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.123705 s, Result = 0af00000, Performance =  38.89 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.128985 s, Result = 0b220000, Performance =  37.96 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.130679 s, Result = 0b540000, Performance =  38.13 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.128893 s, Result = 0b860000, Performance =  39.32 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.124335 s, Result = 0bb80000, Performance =  41.45 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.133020 s, Result = 0bea0000, Performance =  39.39 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.135307 s, Result = 0c1c0000, Performance =  39.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.132419 s, Result = 0c4e0000, Performance =  40.87 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.192055 s, Result = 0c800000, Performance =  28.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1125  1921  1152
Test passed: M N K =  1316   182  1408
Test passed: M N K =  1805   889  1344
Test passed: M N K =  1404   821  1856
Test passed: M N K =   763  1228  1024
M N K =  4096  4096   256, Elapsed time =   0.033679 s, Result = d04c0000, Performance =   2.55 TOPS
M N K =  4096  4096   512, Elapsed time =   0.041750 s, Result = 90880000, Performance =   4.11 TOPS
M N K =  4096  4096   768, Elapsed time =   0.043869 s, Result = 50c40000, Performance =   5.87 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.042309 s, Result = 11000000, Performance =   8.12 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.057169 s, Result = d13c0000, Performance =   7.51 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.053613 s, Result = 91780000, Performance =   9.61 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.060316 s, Result = 51b40000, Performance =   9.97 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.067779 s, Result = 11f00000, Performance =  10.14 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.066592 s, Result = d22c0000, Performance =  11.61 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.073026 s, Result = 92680000, Performance =  11.76 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.068242 s, Result = 52a40000, Performance =  13.85 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.070469 s, Result = 12e00000, Performance =  14.63 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.074678 s, Result = d31c0000, Performance =  14.95 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.078070 s, Result = 93580000, Performance =  15.40 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.087006 s, Result = 53940000, Performance =  14.81 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.086878 s, Result = 13d00000, Performance =  15.82 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.089761 s, Result = d40c0000, Performance =  16.27 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.092774 s, Result = 94480000, Performance =  16.67 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.097520 s, Result = 54840000, Performance =  16.74 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.101055 s, Result = 14c00000, Performance =  17.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.101180 s, Result = d4fc0000, Performance =  17.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.104211 s, Result = 95380000, Performance =  18.13 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.110272 s, Result = 55740000, Performance =  17.92 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.116339 s, Result = 15b00000, Performance =  17.72 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.119775 s, Result = d5ec0000, Performance =  17.93 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.125597 s, Result = 96280000, Performance =  17.78 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.128580 s, Result = 56640000, Performance =  18.04 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.135119 s, Result = 16a00000, Performance =  17.80 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.137351 s, Result = d6dc0000, Performance =  18.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.139626 s, Result = 97180000, Performance =  18.46 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.144805 s, Result = 57540000, Performance =  18.39 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.151259 s, Result = 17900000, Performance =  18.17 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.142192 s, Result = d7cc0000, Performance =  19.94 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.144888 s, Result = 98080000, Performance =  20.16 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.150867 s, Result = 58440000, Performance =  19.93 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.155172 s, Result = 18800000, Performance =  19.93 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.161065 s, Result = d8bc0000, Performance =  19.73 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.165897 s, Result = 98f80000, Performance =  19.68 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.173243 s, Result = 59340000, Performance =  19.34 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.171607 s, Result = 19700000, Performance =  20.02 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.175372 s, Result = d9ac0000, Performance =  20.08 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.177140 s, Result = 99e80000, Performance =  20.37 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.183196 s, Result = 5a240000, Performance =  20.16 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.185685 s, Result = 1a600000, Performance =  20.35 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.185605 s, Result = da9c0000, Performance =  20.83 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.201003 s, Result = 9ad80000, Performance =  19.66 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.191940 s, Result = 5b140000, Performance =  21.03 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.193200 s, Result = 1b500000, Performance =  21.34 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.196254 s, Result = db8c0000, Performance =  21.45 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.198984 s, Result = 9bc80000, Performance =  21.58 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.203177 s, Result = 5c040000, Performance =  21.56 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.206668 s, Result = 1c400000, Performance =  21.61 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.210169 s, Result = dc7c0000, Performance =  21.66 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.214986 s, Result = 9cb80000, Performance =  21.58 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.219554 s, Result = 5cf40000, Performance =  21.52 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.226309 s, Result = 1d300000, Performance =  21.26 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.229072 s, Result = dd6c0000, Performance =  21.37 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.231526 s, Result = 9da80000, Performance =  21.52 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.228692 s, Result = 5de40000, Performance =  22.16 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.229972 s, Result = 1e200000, Performance =  22.41 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.232717 s, Result = de5c0000, Performance =  22.52 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.243039 s, Result = 9e980000, Performance =  21.91 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.237807 s, Result = 5ed40000, Performance =  22.76 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.298549 s, Result = 1f100000, Performance =  18.41 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   174  1109  1856
Test passed: M N K =   836   351   832
Test passed: M N K =  1475  1391  1536
Test passed: M N K =  1294   477  1984
Test passed: M N K =    21   743  1216
M N K =  4096  4096   256, Elapsed time =   0.032520 s, Result = 003c0000, Performance =   2.64 TOPS
M N K =  4096  4096   512, Elapsed time =   0.032486 s, Result = 00780000, Performance =   5.29 TOPS
M N K =  4096  4096   768, Elapsed time =   0.034387 s, Result = 00b40000, Performance =   7.49 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.037376 s, Result = 00f00000, Performance =   9.19 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038739 s, Result = 012c0000, Performance =  11.09 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.041406 s, Result = 01680000, Performance =  12.45 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.046289 s, Result = 01a40000, Performance =  12.99 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.047769 s, Result = 01e00000, Performance =  14.39 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.050911 s, Result = 021c0000, Performance =  15.19 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.053333 s, Result = 02580000, Performance =  16.11 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.056400 s, Result = 02940000, Performance =  16.75 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.060172 s, Result = 02d00000, Performance =  17.13 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.062064 s, Result = 030c0000, Performance =  17.99 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.064342 s, Result = 03480000, Performance =  18.69 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.067731 s, Result = 03840000, Performance =  19.02 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.069684 s, Result = 03c00000, Performance =  19.72 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.072185 s, Result = 03fc0000, Performance =  20.23 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.075197 s, Result = 04380000, Performance =  20.56 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.077633 s, Result = 04740000, Performance =  21.02 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.080835 s, Result = 04b00000, Performance =  21.25 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.084054 s, Result = 04ec0000, Performance =  21.46 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.085882 s, Result = 05280000, Performance =  22.00 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.089981 s, Result = 05640000, Performance =  21.96 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.094874 s, Result = 05a00000, Performance =  21.73 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.099173 s, Result = 05dc0000, Performance =  21.65 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.103198 s, Result = 06180000, Performance =  21.64 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.108859 s, Result = 06540000, Performance =  21.31 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.111870 s, Result = 06900000, Performance =  21.50 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.115457 s, Result = 06cc0000, Performance =  21.58 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.119582 s, Result = 07080000, Performance =  21.55 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.125077 s, Result = 07440000, Performance =  21.29 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.128636 s, Result = 07800000, Performance =  21.37 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.122778 s, Result = 07bc0000, Performance =  23.09 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.127395 s, Result = 07f80000, Performance =  22.93 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.144870 s, Result = 08340000, Performance =  20.75 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.137151 s, Result = 08700000, Performance =  22.55 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.140120 s, Result = 08ac0000, Performance =  22.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.143603 s, Result = 08e80000, Performance =  22.73 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.148312 s, Result = 09240000, Performance =  22.59 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.157275 s, Result = 09600000, Performance =  21.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.161579 s, Result = 099c0000, Performance =  21.80 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.165013 s, Result = 09d80000, Performance =  21.86 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.171623 s, Result = 0a140000, Performance =  21.52 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.173837 s, Result = 0a500000, Performance =  21.74 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.176188 s, Result = 0a8c0000, Performance =  21.94 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.177670 s, Result = 0ac80000, Performance =  22.24 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.176270 s, Result = 0b040000, Performance =  22.90 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.175505 s, Result = 0b400000, Performance =  23.49 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.178605 s, Result = 0b7c0000, Performance =  23.57 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.182205 s, Result = 0bb80000, Performance =  23.57 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.186800 s, Result = 0bf40000, Performance =  23.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.191133 s, Result = 0c300000, Performance =  23.37 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.196582 s, Result = 0c6c0000, Performance =  23.16 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.202905 s, Result = 0ca80000, Performance =  22.86 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.204299 s, Result = 0ce40000, Performance =  23.13 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.202970 s, Result = 0d200000, Performance =  23.70 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.206356 s, Result = 0d5c0000, Performance =  23.73 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.209538 s, Result = 0d980000, Performance =  23.78 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.207452 s, Result = 0dd40000, Performance =  24.43 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.208093 s, Result = 0e100000, Performance =  24.77 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.210589 s, Result = 0e4c0000, Performance =  24.88 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.222169 s, Result = 0e880000, Performance =  23.97 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.217827 s, Result = 0ec40000, Performance =  24.84 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.275939 s, Result = 0f000000, Performance =  19.92 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   608   568   704
Test passed: M N K =  1945  1821  1536
Test passed: M N K =  1411   881  1664
Test passed: M N K =   650   986  1408
Test passed: M N K =  1123  1750   128
M N K =  4096  4096   256, Elapsed time =   0.024608 s, Result = a0dc0000, Performance =   3.49 TOPS
M N K =  4096  4096   512, Elapsed time =   0.023295 s, Result = a1180000, Performance =   7.37 TOPS
M N K =  4096  4096   768, Elapsed time =   0.024590 s, Result = a1540000, Performance =  10.48 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.026679 s, Result = a1900000, Performance =  12.88 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029439 s, Result = a1cc0000, Performance =  14.59 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031420 s, Result = a2080000, Performance =  16.40 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.034116 s, Result = a2440000, Performance =  17.62 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.036555 s, Result = a2800000, Performance =  18.80 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.039213 s, Result = a2bc0000, Performance =  19.72 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041133 s, Result = a2f80000, Performance =  20.88 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.044024 s, Result = a3340000, Performance =  21.46 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.046150 s, Result = a3700000, Performance =  22.34 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.048723 s, Result = a3ac0000, Performance =  22.92 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.051377 s, Result = a3e80000, Performance =  23.41 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.053695 s, Result = a4240000, Performance =  24.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.056930 s, Result = a4600000, Performance =  24.14 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.058590 s, Result = a49c0000, Performance =  24.92 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.061578 s, Result = a4d80000, Performance =  25.11 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.064139 s, Result = a5140000, Performance =  25.45 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.066318 s, Result = a5500000, Performance =  25.91 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.068998 s, Result = a58c0000, Performance =  26.14 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.072358 s, Result = a5c80000, Performance =  26.12 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.075937 s, Result = a6040000, Performance =  26.02 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.080082 s, Result = a6400000, Performance =  25.74 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.091216 s, Result = a67c0000, Performance =  23.54 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.086457 s, Result = a6b80000, Performance =  25.83 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.091500 s, Result = a6f40000, Performance =  25.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.094520 s, Result = a7300000, Performance =  25.45 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.097992 s, Result = a76c0000, Performance =  25.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.102019 s, Result = a7a80000, Performance =  25.26 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.107033 s, Result = a7e40000, Performance =  24.88 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.112419 s, Result = a8200000, Performance =  24.45 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.105717 s, Result = a85c0000, Performance =  26.81 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.109053 s, Result = a8980000, Performance =  26.78 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.114348 s, Result = a8d40000, Performance =  26.29 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.123126 s, Result = a9100000, Performance =  25.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.127133 s, Result = a94c0000, Performance =  25.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.129569 s, Result = a9880000, Performance =  25.19 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.131636 s, Result = a9c40000, Performance =  25.45 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.134577 s, Result = aa000000, Performance =  25.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.137090 s, Result = aa3c0000, Performance =  25.69 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.141997 s, Result = aa780000, Performance =  25.41 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.145508 s, Result = aab40000, Performance =  25.38 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.148764 s, Result = aaf00000, Performance =  25.41 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.147261 s, Result = ab2c0000, Performance =  26.25 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.149998 s, Result = ab680000, Performance =  26.34 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.154837 s, Result = aba40000, Performance =  26.07 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.156969 s, Result = abe00000, Performance =  26.27 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.160585 s, Result = ac1c0000, Performance =  26.21 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.163595 s, Result = ac580000, Performance =  26.25 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.167845 s, Result = ac940000, Performance =  26.10 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.169649 s, Result = acd00000, Performance =  26.33 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.173860 s, Result = ad0c0000, Performance =  26.19 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.179171 s, Result = ad480000, Performance =  25.89 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.179693 s, Result = ad840000, Performance =  26.29 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.179317 s, Result = adc00000, Performance =  26.83 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.181604 s, Result = adfc0000, Performance =  26.96 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.187834 s, Result = ae380000, Performance =  26.52 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.184721 s, Result = ae740000, Performance =  27.44 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.185449 s, Result = aeb00000, Performance =  27.79 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.187719 s, Result = aeec0000, Performance =  27.91 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.198236 s, Result = af280000, Performance =  26.87 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.193756 s, Result = af640000, Performance =  27.93 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.265242 s, Result = afa00000, Performance =  20.73 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   132   466  1856
Test passed: M N K =  1162   219  1536
Test passed: M N K =   118  1332   704
Test passed: M N K =  1015  1217  1024
Test passed: M N K =   969  1505  1728
M N K =  4096  4096   256, Elapsed time =   0.001693 s, Result = 003c0000, Performance =  50.75 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003506 s, Result = 00780000, Performance =  49.00 TOPS
M N K =  4096  4096   768, Elapsed time =   0.012412 s, Result = 00b40000, Performance =  20.76 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004976 s, Result = 00f00000, Performance =  69.05 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011327 s, Result = 012c0000, Performance =  37.92 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007505 s, Result = 01680000, Performance =  68.67 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008659 s, Result = 01a40000, Performance =  69.44 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010495 s, Result = 01e00000, Performance =  65.48 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012477 s, Result = 021c0000, Performance =  61.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.014844 s, Result = 02580000, Performance =  57.87 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.025820 s, Result = 02940000, Performance =  36.60 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.028402 s, Result = 02d00000, Performance =  36.29 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.030505 s, Result = 030c0000, Performance =  36.61 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.026312 s, Result = 03480000, Performance =  45.70 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.036624 s, Result = 03840000, Performance =  35.18 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.032415 s, Result = 03c00000, Performance =  42.40 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.034528 s, Result = 03fc0000, Performance =  42.29 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.037177 s, Result = 04380000, Performance =  41.59 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.041405 s, Result = 04740000, Performance =  39.42 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043459 s, Result = 04b00000, Performance =  39.53 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.045868 s, Result = 04ec0000, Performance =  39.33 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.047964 s, Result = 05280000, Performance =  39.40 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.051713 s, Result = 05640000, Performance =  38.20 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.055646 s, Result = 05a00000, Performance =  37.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.075058 s, Result = 05dc0000, Performance =  28.61 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.065130 s, Result = 06180000, Performance =  34.29 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.067299 s, Result = 06540000, Performance =  34.46 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.069489 s, Result = 06900000, Performance =  34.61 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.072750 s, Result = 06cc0000, Performance =  34.24 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.076602 s, Result = 07080000, Performance =  33.64 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.080967 s, Result = 07440000, Performance =  32.89 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.084090 s, Result = 07800000, Performance =  32.69 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.080227 s, Result = 07bc0000, Performance =  35.33 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.083364 s, Result = 07f80000, Performance =  35.03 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.088938 s, Result = 08340000, Performance =  33.80 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.093333 s, Result = 08700000, Performance =  33.13 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.097952 s, Result = 08ac0000, Performance =  32.45 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.102983 s, Result = 08e80000, Performance =  31.70 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.105885 s, Result = 09240000, Performance =  31.64 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.106006 s, Result = 09600000, Performance =  32.41 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.111026 s, Result = 099c0000, Performance =  31.72 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.114501 s, Result = 09d80000, Performance =  31.51 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.115082 s, Result = 0a140000, Performance =  32.10 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.118648 s, Result = 0a500000, Performance =  31.86 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.121184 s, Result = 0a8c0000, Performance =  31.90 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.124296 s, Result = 0ac80000, Performance =  31.79 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.125501 s, Result = 0b040000, Performance =  32.17 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.128480 s, Result = 0b400000, Performance =  32.09 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.132409 s, Result = 0b7c0000, Performance =  31.79 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.135702 s, Result = 0bb80000, Performance =  31.65 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.140281 s, Result = 0bf40000, Performance =  31.23 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.142626 s, Result = 0c300000, Performance =  31.32 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.147502 s, Result = 0c6c0000, Performance =  30.87 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.152332 s, Result = 0ca80000, Performance =  30.45 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.153756 s, Result = 0ce40000, Performance =  30.73 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.152757 s, Result = 0d200000, Performance =  31.49 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.156999 s, Result = 0d5c0000, Performance =  31.19 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.164153 s, Result = 0d980000, Performance =  30.35 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.158749 s, Result = 0dd40000, Performance =  31.93 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.161003 s, Result = 0e100000, Performance =  32.01 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.167616 s, Result = 0e4c0000, Performance =  31.26 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.175006 s, Result = 0e880000, Performance =  30.43 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.170275 s, Result = 0ec40000, Performance =  31.78 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.243535 s, Result = 0f000000, Performance =  22.57 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   667     3   448
Test passed: M N K =   150  1995  1664
Test passed: M N K =   816   715   128
Test passed: M N K =  1928  1150  1344
Test passed: M N K =   640   842  1536
M N K =  4096  4096   256, Elapsed time =   0.041380 s, Result = d04c0000, Performance =   2.08 TOPS
M N K =  4096  4096   512, Elapsed time =   0.037726 s, Result = 90880000, Performance =   4.55 TOPS
M N K =  4096  4096   768, Elapsed time =   0.041318 s, Result = 50c40000, Performance =   6.24 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.047408 s, Result = 11000000, Performance =   7.25 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.045799 s, Result = d13c0000, Performance =   9.38 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.050352 s, Result = 91780000, Performance =  10.24 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.053022 s, Result = 51b40000, Performance =  11.34 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.054170 s, Result = 11f00000, Performance =  12.69 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.059918 s, Result = d22c0000, Performance =  12.90 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.055084 s, Result = 92680000, Performance =  15.59 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.066336 s, Result = 52a40000, Performance =  14.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.069104 s, Result = 12e00000, Performance =  14.92 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.067595 s, Result = d31c0000, Performance =  16.52 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.069358 s, Result = 93580000, Performance =  17.34 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.074930 s, Result = 53940000, Performance =  17.20 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.079620 s, Result = 13d00000, Performance =  17.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.090452 s, Result = d40c0000, Performance =  16.14 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.089041 s, Result = 94480000, Performance =  17.36 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.089940 s, Result = 54840000, Performance =  18.15 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.093912 s, Result = 14c00000, Performance =  18.29 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.098941 s, Result = d4fc0000, Performance =  18.23 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.105078 s, Result = 95380000, Performance =  17.98 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.106965 s, Result = 55740000, Performance =  18.47 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.122100 s, Result = 15b00000, Performance =  16.88 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.118879 s, Result = d5ec0000, Performance =  18.06 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.121751 s, Result = 96280000, Performance =  18.34 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.119944 s, Result = 56640000, Performance =  19.34 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.124138 s, Result = 16a00000, Performance =  19.38 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.128119 s, Result = d6dc0000, Performance =  19.44 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.131230 s, Result = 97180000, Performance =  19.64 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.132843 s, Result = 57540000, Performance =  20.05 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.152804 s, Result = 17900000, Performance =  17.99 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.137955 s, Result = d7cc0000, Performance =  20.55 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.131304 s, Result = 98080000, Performance =  22.24 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.138237 s, Result = 58440000, Performance =  21.75 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.141827 s, Result = 18800000, Performance =  21.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.152224 s, Result = d8bc0000, Performance =  20.88 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.154326 s, Result = 98f80000, Performance =  21.15 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.158565 s, Result = 59340000, Performance =  21.13 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.159982 s, Result = 19700000, Performance =  21.48 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.164700 s, Result = d9ac0000, Performance =  21.38 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.168237 s, Result = 99e80000, Performance =  21.44 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.173779 s, Result = 5a240000, Performance =  21.26 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.174383 s, Result = 1a600000, Performance =  21.67 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.178175 s, Result = da9c0000, Performance =  21.69 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.183590 s, Result = 9ad80000, Performance =  21.52 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.182722 s, Result = 5b140000, Performance =  22.10 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.186321 s, Result = 1b500000, Performance =  22.13 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.189029 s, Result = db8c0000, Performance =  22.27 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.192921 s, Result = 9bc80000, Performance =  22.26 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.196116 s, Result = 5c040000, Performance =  22.34 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.195043 s, Result = 1c400000, Performance =  22.90 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.198393 s, Result = dc7c0000, Performance =  22.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.201300 s, Result = 9cb80000, Performance =  23.04 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.203245 s, Result = 5cf40000, Performance =  23.25 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.203418 s, Result = 1d300000, Performance =  23.65 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.206750 s, Result = dd6c0000, Performance =  23.68 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.209854 s, Result = 9da80000, Performance =  23.74 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.209470 s, Result = 5de40000, Performance =  24.19 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.208943 s, Result = 1e200000, Performance =  24.67 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.214414 s, Result = de5c0000, Performance =  24.44 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.217861 s, Result = 9e980000, Performance =  24.45 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.224218 s, Result = 5ed40000, Performance =  24.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.290951 s, Result = 1f100000, Performance =  18.90 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   916  1722   896
Test passed: M N K =   741  1055   576
Test passed: M N K =  1686     9   512
Test passed: M N K =    64  1596   512
Test passed: M N K =   671  1243   448
M N K =  4096  4096   256, Elapsed time =   0.031541 s, Result = 003c0000, Performance =   2.72 TOPS
M N K =  4096  4096   512, Elapsed time =   0.030400 s, Result = 00780000, Performance =   5.65 TOPS
M N K =  4096  4096   768, Elapsed time =   0.033915 s, Result = 00b40000, Performance =   7.60 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.035900 s, Result = 00f00000, Performance =   9.57 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.040338 s, Result = 012c0000, Performance =  10.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.041424 s, Result = 01680000, Performance =  12.44 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.045193 s, Result = 01a40000, Performance =  13.31 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.049224 s, Result = 01e00000, Performance =  13.96 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.050517 s, Result = 021c0000, Performance =  15.30 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.051894 s, Result = 02580000, Performance =  16.55 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.055455 s, Result = 02940000, Performance =  17.04 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.056543 s, Result = 02d00000, Performance =  18.23 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.060039 s, Result = 030c0000, Performance =  18.60 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.062241 s, Result = 03480000, Performance =  19.32 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.066327 s, Result = 03840000, Performance =  19.43 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.068028 s, Result = 03c00000, Performance =  20.20 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.071816 s, Result = 03fc0000, Performance =  20.33 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.073598 s, Result = 04380000, Performance =  21.01 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.075026 s, Result = 04740000, Performance =  21.75 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.077409 s, Result = 04b00000, Performance =  22.19 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.079703 s, Result = 04ec0000, Performance =  22.63 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.082598 s, Result = 05280000, Performance =  22.88 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.085310 s, Result = 05640000, Performance =  23.16 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.089124 s, Result = 05a00000, Performance =  23.13 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.091650 s, Result = 05dc0000, Performance =  23.43 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.094477 s, Result = 06180000, Performance =  23.64 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.096596 s, Result = 06540000, Performance =  24.01 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.100856 s, Result = 06900000, Performance =  23.85 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.104710 s, Result = 06cc0000, Performance =  23.79 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.108142 s, Result = 07080000, Performance =  23.83 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.113180 s, Result = 07440000, Performance =  23.53 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.129681 s, Result = 07800000, Performance =  21.20 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.116634 s, Result = 07bc0000, Performance =  24.30 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.111758 s, Result = 07f80000, Performance =  26.13 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.115221 s, Result = 08340000, Performance =  26.09 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.118803 s, Result = 08700000, Performance =  26.03 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.118768 s, Result = 08ac0000, Performance =  26.76 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.122924 s, Result = 08e80000, Performance =  26.55 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.127938 s, Result = 09240000, Performance =  26.19 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.129741 s, Result = 09600000, Performance =  26.48 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.133933 s, Result = 099c0000, Performance =  26.30 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.136893 s, Result = 09d80000, Performance =  26.35 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.141376 s, Result = 0a140000, Performance =  26.13 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.142131 s, Result = 0a500000, Performance =  26.59 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.145942 s, Result = 0a8c0000, Performance =  26.49 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.150803 s, Result = 0ac80000, Performance =  26.20 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.155192 s, Result = 0b040000, Performance =  26.01 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.158363 s, Result = 0b400000, Performance =  26.04 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.162853 s, Result = 0b7c0000, Performance =  25.85 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.167238 s, Result = 0bb80000, Performance =  25.68 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.171933 s, Result = 0bf40000, Performance =  25.48 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.170214 s, Result = 0c300000, Performance =  26.24 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.173581 s, Result = 0c6c0000, Performance =  26.23 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.178221 s, Result = 0ca80000, Performance =  26.03 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.180486 s, Result = 0ce40000, Performance =  26.18 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.179656 s, Result = 0d200000, Performance =  26.78 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.185841 s, Result = 0d5c0000, Performance =  26.35 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.188836 s, Result = 0d980000, Performance =  26.38 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.189129 s, Result = 0dd40000, Performance =  26.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.187803 s, Result = 0e100000, Performance =  27.44 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.192546 s, Result = 0e4c0000, Performance =  27.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.195373 s, Result = 0e880000, Performance =  27.26 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.202354 s, Result = 0ec40000, Performance =  26.74 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.274064 s, Result = 0f000000, Performance =  20.06 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   942  1376  2048
Test passed: M N K =  1628  1195  1024
Test passed: M N K =  2033   770  1280
Test passed: M N K =   581  1479   896
Test passed: M N K =   615   727   512
M N K =  4096  4096   256, Elapsed time =   0.024958 s, Result = a0dc0000, Performance =   3.44 TOPS
M N K =  4096  4096   512, Elapsed time =   0.023564 s, Result = a1180000, Performance =   7.29 TOPS
M N K =  4096  4096   768, Elapsed time =   0.025406 s, Result = a1540000, Performance =  10.14 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.027089 s, Result = a1900000, Performance =  12.68 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029389 s, Result = a1cc0000, Performance =  14.61 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031238 s, Result = a2080000, Performance =  16.50 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.033238 s, Result = a2440000, Performance =  18.09 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.035066 s, Result = a2800000, Performance =  19.60 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.038469 s, Result = a2bc0000, Performance =  20.10 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.039896 s, Result = a2f80000, Performance =  21.53 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.042491 s, Result = a3340000, Performance =  22.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.044509 s, Result = a3700000, Performance =  23.16 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.047119 s, Result = a3ac0000, Performance =  23.70 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.048916 s, Result = a3e80000, Performance =  24.58 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.052419 s, Result = a4240000, Performance =  24.58 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.054000 s, Result = a4600000, Performance =  25.45 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.057485 s, Result = a49c0000, Performance =  25.40 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.058514 s, Result = a4d80000, Performance =  26.42 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.060820 s, Result = a5140000, Performance =  26.83 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.063887 s, Result = a5500000, Performance =  26.89 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.066738 s, Result = a58c0000, Performance =  27.03 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.068752 s, Result = a5c80000, Performance =  27.49 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.072673 s, Result = a6040000, Performance =  27.19 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.075934 s, Result = a6400000, Performance =  27.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.078138 s, Result = a67c0000, Performance =  27.48 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.079872 s, Result = a6b80000, Performance =  27.96 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.082860 s, Result = a6f40000, Performance =  27.99 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.086026 s, Result = a7300000, Performance =  27.96 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.088392 s, Result = a76c0000, Performance =  28.18 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.091390 s, Result = a7a80000, Performance =  28.20 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.095407 s, Result = a7e40000, Performance =  27.91 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.112750 s, Result = a8200000, Performance =  24.38 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.098661 s, Result = a85c0000, Performance =  28.73 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.094753 s, Result = a8980000, Performance =  30.82 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.099093 s, Result = a8d40000, Performance =  30.34 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.101794 s, Result = a9100000, Performance =  30.38 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.107069 s, Result = a94c0000, Performance =  29.68 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.109875 s, Result = a9880000, Performance =  29.71 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.114972 s, Result = a9c40000, Performance =  29.14 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.117142 s, Result = aa000000, Performance =  29.33 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.121151 s, Result = aa3c0000, Performance =  29.07 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.123834 s, Result = aa780000, Performance =  29.13 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.132111 s, Result = aab40000, Performance =  27.96 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.132507 s, Result = aaf00000, Performance =  28.52 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.133682 s, Result = ab2c0000, Performance =  28.92 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.136497 s, Result = ab680000, Performance =  28.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.142960 s, Result = aba40000, Performance =  28.24 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.143726 s, Result = abe00000, Performance =  28.69 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.146277 s, Result = ac1c0000, Performance =  28.77 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.149497 s, Result = ac580000, Performance =  28.73 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.154414 s, Result = ac940000, Performance =  28.37 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.153284 s, Result = acd00000, Performance =  29.14 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.157667 s, Result = ad0c0000, Performance =  28.88 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.162471 s, Result = ad480000, Performance =  28.55 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.165150 s, Result = ad840000, Performance =  28.61 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.164163 s, Result = adc00000, Performance =  29.30 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.171042 s, Result = adfc0000, Performance =  28.63 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.174712 s, Result = ae380000, Performance =  28.52 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.176066 s, Result = ae740000, Performance =  28.78 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.171882 s, Result = aeb00000, Performance =  29.99 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.182393 s, Result = aeec0000, Performance =  28.73 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.179660 s, Result = af280000, Performance =  29.64 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.189844 s, Result = af640000, Performance =  28.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.260167 s, Result = afa00000, Performance =  21.13 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2026  1023   704
Test passed: M N K =  1042  1175  1792
Test passed: M N K =   808  1404  1664
Test passed: M N K =   918   342  2048
Test passed: M N K =   993  1703   832
M N K =  4096  4096   256, Elapsed time =   0.001669 s, Result = 003c0000, Performance =  51.48 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003379 s, Result = 00780000, Performance =  50.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.004740 s, Result = 00b40000, Performance =  54.37 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.005120 s, Result = 00f00000, Performance =  67.11 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.006140 s, Result = 012c0000, Performance =  69.95 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007360 s, Result = 01680000, Performance =  70.03 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008767 s, Result = 01a40000, Performance =  68.59 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010325 s, Result = 01e00000, Performance =  66.56 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.012255 s, Result = 021c0000, Performance =  63.08 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013244 s, Result = 02580000, Performance =  64.86 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015186 s, Result = 02940000, Performance =  62.22 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017835 s, Result = 02d00000, Performance =  57.80 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020067 s, Result = 030c0000, Performance =  55.65 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.023070 s, Result = 03480000, Performance =  52.13 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.025882 s, Result = 03840000, Performance =  49.78 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.028804 s, Result = 03c00000, Performance =  47.72 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.034564 s, Result = 03fc0000, Performance =  42.25 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.039770 s, Result = 04380000, Performance =  38.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.040955 s, Result = 04740000, Performance =  39.85 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043411 s, Result = 04b00000, Performance =  39.57 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.045638 s, Result = 04ec0000, Performance =  39.53 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.048391 s, Result = 05280000, Performance =  39.05 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.051368 s, Result = 05640000, Performance =  38.46 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.053016 s, Result = 05a00000, Performance =  38.89 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.057177 s, Result = 05dc0000, Performance =  37.56 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.059118 s, Result = 06180000, Performance =  37.78 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.062305 s, Result = 06540000, Performance =  37.22 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.064908 s, Result = 06900000, Performance =  37.06 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.068538 s, Result = 06cc0000, Performance =  36.35 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.071599 s, Result = 07080000, Performance =  35.99 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.075623 s, Result = 07440000, Performance =  35.21 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.091569 s, Result = 07800000, Performance =  30.02 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.075365 s, Result = 07bc0000, Performance =  37.61 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.069776 s, Result = 07f80000, Performance =  41.86 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.073729 s, Result = 08340000, Performance =  40.78 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.077843 s, Result = 08700000, Performance =  39.73 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.084631 s, Result = 08ac0000, Performance =  37.55 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.088810 s, Result = 08e80000, Performance =  36.75 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.092995 s, Result = 09240000, Performance =  36.02 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.096219 s, Result = 09600000, Performance =  35.71 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.099244 s, Result = 099c0000, Performance =  35.49 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.100532 s, Result = 09d80000, Performance =  35.89 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.106493 s, Result = 0a140000, Performance =  34.68 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.107244 s, Result = 0a500000, Performance =  35.24 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.111175 s, Result = 0a8c0000, Performance =  34.77 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.114104 s, Result = 0ac80000, Performance =  34.63 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.118023 s, Result = 0b040000, Performance =  34.21 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.120833 s, Result = 0b400000, Performance =  34.12 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.124760 s, Result = 0b7c0000, Performance =  33.74 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.128435 s, Result = 0bb80000, Performance =  33.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.132414 s, Result = 0bf40000, Performance =  33.08 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.133099 s, Result = 0c300000, Performance =  33.56 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.136684 s, Result = 0c6c0000, Performance =  33.31 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.141178 s, Result = 0ca80000, Performance =  32.86 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.144923 s, Result = 0ce40000, Performance =  32.60 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.142788 s, Result = 0d200000, Performance =  33.69 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.149303 s, Result = 0d5c0000, Performance =  32.79 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.151101 s, Result = 0d980000, Performance =  32.97 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.152811 s, Result = 0dd40000, Performance =  33.17 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.149884 s, Result = 0e100000, Performance =  34.39 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.159323 s, Result = 0e4c0000, Performance =  32.89 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.158616 s, Result = 0e880000, Performance =  33.58 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.168554 s, Result = 0ec40000, Performance =  32.11 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.233136 s, Result = 0f000000, Performance =  23.58 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1020   138   896
Test passed: M N K =   403   682  1600
Test passed: M N K =   620  1586   256
Test passed: M N K =  1096   636  1664
Test passed: M N K =   980  2040   896
M N K =  4096  4096   256, Elapsed time =   0.036917 s, Result = d04c0000, Performance =   2.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.039906 s, Result = 90880000, Performance =   4.31 TOPS
M N K =  4096  4096   768, Elapsed time =   0.042437 s, Result = 50c40000, Performance =   6.07 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.041207 s, Result = 11000000, Performance =   8.34 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.045177 s, Result = d13c0000, Performance =   9.51 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.045082 s, Result = 91780000, Performance =  11.43 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.052659 s, Result = 51b40000, Performance =  11.42 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.049826 s, Result = 11f00000, Performance =  13.79 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.057281 s, Result = d22c0000, Performance =  13.50 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.056447 s, Result = 92680000, Performance =  15.22 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.063142 s, Result = 52a40000, Performance =  14.96 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.062814 s, Result = 12e00000, Performance =  16.41 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.070395 s, Result = d31c0000, Performance =  15.86 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.072779 s, Result = 93580000, Performance =  16.52 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.071650 s, Result = 53940000, Performance =  17.98 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.080054 s, Result = 13d00000, Performance =  17.17 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.080400 s, Result = d40c0000, Performance =  18.16 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.083031 s, Result = 94480000, Performance =  18.62 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.086217 s, Result = 54840000, Performance =  18.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.094045 s, Result = 14c00000, Performance =  18.27 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.098446 s, Result = d4fc0000, Performance =  18.32 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.097466 s, Result = 95380000, Performance =  19.39 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.102203 s, Result = 55740000, Performance =  19.33 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.106394 s, Result = 15b00000, Performance =  19.38 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.110853 s, Result = d5ec0000, Performance =  19.37 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.114105 s, Result = 96280000, Performance =  19.57 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.116366 s, Result = 56640000, Performance =  19.93 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.117296 s, Result = 16a00000, Performance =  20.51 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.121152 s, Result = d6dc0000, Performance =  20.56 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.125289 s, Result = 97180000, Performance =  20.57 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.128970 s, Result = 57540000, Performance =  20.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.141136 s, Result = 17900000, Performance =  19.48 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.135660 s, Result = d7cc0000, Performance =  20.90 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.138254 s, Result = 98080000, Performance =  21.12 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.138962 s, Result = 58440000, Performance =  21.64 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.138599 s, Result = 18800000, Performance =  22.31 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.142082 s, Result = d8bc0000, Performance =  22.37 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.145072 s, Result = 98f80000, Performance =  22.50 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.150906 s, Result = 59340000, Performance =  22.20 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.152683 s, Result = 19700000, Performance =  22.50 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.158816 s, Result = d9ac0000, Performance =  22.18 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.166382 s, Result = 99e80000, Performance =  21.68 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.171942 s, Result = 5a240000, Performance =  21.48 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.166881 s, Result = 1a600000, Performance =  22.65 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.170681 s, Result = da9c0000, Performance =  22.65 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.173633 s, Result = 9ad80000, Performance =  22.76 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.176202 s, Result = 5b140000, Performance =  22.91 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.176642 s, Result = 1b500000, Performance =  23.34 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.180575 s, Result = db8c0000, Performance =  23.31 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.182859 s, Result = 9bc80000, Performance =  23.49 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.190952 s, Result = 5c040000, Performance =  22.94 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.187579 s, Result = 1c400000, Performance =  23.81 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.193872 s, Result = dc7c0000, Performance =  23.48 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.194980 s, Result = 9cb80000, Performance =  23.79 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.201201 s, Result = 5cf40000, Performance =  23.48 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.201891 s, Result = 1d300000, Performance =  23.83 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.210971 s, Result = dd6c0000, Performance =  23.21 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.212481 s, Result = 9da80000, Performance =  23.45 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.210154 s, Result = 5de40000, Performance =  24.12 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.205597 s, Result = 1e200000, Performance =  25.07 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.214718 s, Result = de5c0000, Performance =  24.40 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.229921 s, Result = 9e980000, Performance =  23.16 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.219619 s, Result = 5ed40000, Performance =  24.64 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.281682 s, Result = 1f100000, Performance =  19.52 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   878  1685   576
Test passed: M N K =  1417   351   832
Test passed: M N K =  1038  1473   768
Test passed: M N K =   322   605  1728
Test passed: M N K =  1260   886  2048
M N K =  4096  4096   256, Elapsed time =   0.032324 s, Result = 003c0000, Performance =   2.66 TOPS
M N K =  4096  4096   512, Elapsed time =   0.028735 s, Result = 00780000, Performance =   5.98 TOPS
M N K =  4096  4096   768, Elapsed time =   0.032651 s, Result = 00b40000, Performance =   7.89 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.038257 s, Result = 00f00000, Performance =   8.98 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.035686 s, Result = 012c0000, Performance =  12.04 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.044457 s, Result = 01680000, Performance =  11.59 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.044740 s, Result = 01a40000, Performance =  13.44 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.047804 s, Result = 01e00000, Performance =  14.38 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.049913 s, Result = 021c0000, Performance =  15.49 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.052343 s, Result = 02580000, Performance =  16.41 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.053077 s, Result = 02940000, Performance =  17.80 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.055473 s, Result = 02d00000, Performance =  18.58 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.058151 s, Result = 030c0000, Performance =  19.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.066795 s, Result = 03480000, Performance =  18.00 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.065156 s, Result = 03840000, Performance =  19.78 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.066356 s, Result = 03c00000, Performance =  20.71 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.069753 s, Result = 03fc0000, Performance =  20.94 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.072692 s, Result = 04380000, Performance =  21.27 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.074851 s, Result = 04740000, Performance =  21.80 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.077004 s, Result = 04b00000, Performance =  22.31 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.079275 s, Result = 04ec0000, Performance =  22.75 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.080511 s, Result = 05280000, Performance =  23.47 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.082484 s, Result = 05640000, Performance =  23.95 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.085057 s, Result = 05a00000, Performance =  24.24 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.087874 s, Result = 05dc0000, Performance =  24.44 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.090084 s, Result = 06180000, Performance =  24.79 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.092448 s, Result = 06540000, Performance =  25.09 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.095504 s, Result = 06900000, Performance =  25.18 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.097954 s, Result = 06cc0000, Performance =  25.43 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.100887 s, Result = 07080000, Performance =  25.54 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.105137 s, Result = 07440000, Performance =  25.33 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.117639 s, Result = 07800000, Performance =  23.37 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.111599 s, Result = 07bc0000, Performance =  25.40 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.116649 s, Result = 07f80000, Performance =  25.04 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.117981 s, Result = 08340000, Performance =  25.48 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.115541 s, Result = 08700000, Performance =  26.76 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.121148 s, Result = 08ac0000, Performance =  26.23 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.124546 s, Result = 08e80000, Performance =  26.21 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.128177 s, Result = 09240000, Performance =  26.14 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.132771 s, Result = 09600000, Performance =  25.88 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.135429 s, Result = 099c0000, Performance =  26.01 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.140785 s, Result = 09d80000, Performance =  25.63 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.146469 s, Result = 0a140000, Performance =  25.22 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.143007 s, Result = 0a500000, Performance =  26.43 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.145256 s, Result = 0a8c0000, Performance =  26.61 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.149871 s, Result = 0ac80000, Performance =  26.37 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.150790 s, Result = 0b040000, Performance =  26.77 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.152690 s, Result = 0b400000, Performance =  27.00 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.157216 s, Result = 0b7c0000, Performance =  26.77 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.161429 s, Result = 0bb80000, Performance =  26.61 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.167321 s, Result = 0bf40000, Performance =  26.18 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.165280 s, Result = 0c300000, Performance =  27.03 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.169203 s, Result = 0c6c0000, Performance =  26.91 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.172623 s, Result = 0ca80000, Performance =  26.87 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.179034 s, Result = 0ce40000, Performance =  26.39 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.178091 s, Result = 0d200000, Performance =  27.01 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.185093 s, Result = 0d5c0000, Performance =  26.45 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.192026 s, Result = 0d980000, Performance =  25.95 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.185633 s, Result = 0dd40000, Performance =  27.30 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.182628 s, Result = 0e100000, Performance =  28.22 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.191724 s, Result = 0e4c0000, Performance =  27.33 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.193616 s, Result = 0e880000, Performance =  27.51 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.195434 s, Result = 0ec40000, Performance =  27.69 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.260658 s, Result = 0f000000, Performance =  21.09 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   210   221   832
Test passed: M N K =   141  1838  1792
Test passed: M N K =    24  1707   576
Test passed: M N K =   566   215   384
Test passed: M N K =   795   743  1280
M N K =  4096  4096   256, Elapsed time =   0.025474 s, Result = a0dc0000, Performance =   3.37 TOPS
M N K =  4096  4096   512, Elapsed time =   0.022051 s, Result = a1180000, Performance =   7.79 TOPS
M N K =  4096  4096   768, Elapsed time =   0.024189 s, Result = a1540000, Performance =  10.65 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.026355 s, Result = a1900000, Performance =  13.04 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029213 s, Result = a1cc0000, Performance =  14.70 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031446 s, Result = a2080000, Performance =  16.39 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.033082 s, Result = a2440000, Performance =  18.18 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.035035 s, Result = a2800000, Performance =  19.61 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037480 s, Result = a2bc0000, Performance =  20.63 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.039252 s, Result = a2f80000, Performance =  21.88 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.041545 s, Result = a3340000, Performance =  22.74 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.043660 s, Result = a3700000, Performance =  23.61 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.046142 s, Result = a3ac0000, Performance =  24.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.047952 s, Result = a3e80000, Performance =  25.08 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051054 s, Result = a4240000, Performance =  25.24 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.052287 s, Result = a4600000, Performance =  26.29 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.055420 s, Result = a49c0000, Performance =  26.35 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.057637 s, Result = a4d80000, Performance =  26.83 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.060628 s, Result = a5140000, Performance =  26.92 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.061372 s, Result = a5500000, Performance =  27.99 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.064814 s, Result = a58c0000, Performance =  27.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.066891 s, Result = a5c80000, Performance =  28.25 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.069688 s, Result = a6040000, Performance =  28.35 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.072730 s, Result = a6400000, Performance =  28.35 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.075044 s, Result = a67c0000, Performance =  28.62 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.077594 s, Result = a6b80000, Performance =  28.78 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.079802 s, Result = a6f40000, Performance =  29.06 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.082132 s, Result = a7300000, Performance =  29.28 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.085986 s, Result = a76c0000, Performance =  28.97 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.088491 s, Result = a7a80000, Performance =  29.12 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.091363 s, Result = a7e40000, Performance =  29.15 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.104692 s, Result = a8200000, Performance =  26.26 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.098699 s, Result = a85c0000, Performance =  28.72 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.102446 s, Result = a8980000, Performance =  28.51 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.102337 s, Result = a8d40000, Performance =  29.38 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.101769 s, Result = a9100000, Performance =  30.39 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.105737 s, Result = a94c0000, Performance =  30.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.110977 s, Result = a9880000, Performance =  29.41 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.113760 s, Result = a9c40000, Performance =  29.45 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.115502 s, Result = aa000000, Performance =  29.75 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.123079 s, Result = aa3c0000, Performance =  28.61 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.126009 s, Result = aa780000, Performance =  28.63 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.130632 s, Result = aab40000, Performance =  28.28 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.121907 s, Result = aaf00000, Performance =  31.00 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.128393 s, Result = ab2c0000, Performance =  30.11 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.132976 s, Result = ab680000, Performance =  29.71 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.137782 s, Result = aba40000, Performance =  29.30 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.139994 s, Result = abe00000, Performance =  29.45 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.143330 s, Result = ac1c0000, Performance =  29.37 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.146926 s, Result = ac580000, Performance =  29.23 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.154744 s, Result = ac940000, Performance =  28.31 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.151773 s, Result = acd00000, Performance =  29.43 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.156779 s, Result = ad0c0000, Performance =  29.04 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.161673 s, Result = ad480000, Performance =  28.69 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.167113 s, Result = ad840000, Performance =  28.27 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.167476 s, Result = adc00000, Performance =  28.72 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.174445 s, Result = adfc0000, Performance =  28.07 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.177205 s, Result = ae380000, Performance =  28.12 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.181344 s, Result = ae740000, Performance =  27.95 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.172501 s, Result = aeb00000, Performance =  29.88 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.183282 s, Result = aeec0000, Performance =  28.59 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.183377 s, Result = af280000, Performance =  29.04 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.185398 s, Result = af640000, Performance =  29.19 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.250177 s, Result = afa00000, Performance =  21.97 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   384   172  1472
Test passed: M N K =  1647  1660   128
Test passed: M N K =   695  1916  1024
Test passed: M N K =   137  1848   640
Test passed: M N K =  1416   540  1728
M N K =  4096  4096   256, Elapsed time =   0.001713 s, Result = 003c0000, Performance =  50.13 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003426 s, Result = 00780000, Performance =  50.14 TOPS
M N K =  4096  4096   768, Elapsed time =   0.006973 s, Result = 00b40000, Performance =  36.96 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.005594 s, Result = 00f00000, Performance =  61.42 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.011016 s, Result = 012c0000, Performance =  38.99 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.007057 s, Result = 01680000, Performance =  73.03 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.008626 s, Result = 01a40000, Performance =  69.70 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.010066 s, Result = 01e00000, Performance =  68.27 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.016762 s, Result = 021c0000, Performance =  46.12 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.013053 s, Result = 02580000, Performance =  65.81 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015060 s, Result = 02940000, Performance =  62.74 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.016924 s, Result = 02d00000, Performance =  60.91 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.018988 s, Result = 030c0000, Performance =  58.81 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021653 s, Result = 03480000, Performance =  55.54 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.024006 s, Result = 03840000, Performance =  53.67 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.026582 s, Result = 03c00000, Performance =  51.70 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.029984 s, Result = 03fc0000, Performance =  48.70 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.032530 s, Result = 04380000, Performance =  47.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.037149 s, Result = 04740000, Performance =  43.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.041006 s, Result = 04b00000, Performance =  41.90 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.043682 s, Result = 04ec0000, Performance =  41.30 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.046371 s, Result = 05280000, Performance =  40.75 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.049118 s, Result = 05640000, Performance =  40.22 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.051956 s, Result = 05a00000, Performance =  39.68 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.054409 s, Result = 05dc0000, Performance =  39.47 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.056727 s, Result = 06180000, Performance =  39.37 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.059170 s, Result = 06540000, Performance =  39.20 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.061204 s, Result = 06900000, Performance =  39.30 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.064293 s, Result = 06cc0000, Performance =  38.75 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.066444 s, Result = 07080000, Performance =  38.78 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.069544 s, Result = 07440000, Performance =  38.29 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.081654 s, Result = 07800000, Performance =  33.66 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.076021 s, Result = 07bc0000, Performance =  37.29 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.076606 s, Result = 07f80000, Performance =  38.12 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.078189 s, Result = 08340000, Performance =  38.45 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.078430 s, Result = 08700000, Performance =  39.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.083644 s, Result = 08ac0000, Performance =  38.00 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.085818 s, Result = 08e80000, Performance =  38.04 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.090567 s, Result = 09240000, Performance =  36.99 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.091554 s, Result = 09600000, Performance =  37.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.094724 s, Result = 099c0000, Performance =  37.18 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.099189 s, Result = 09d80000, Performance =  36.37 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.103925 s, Result = 0a140000, Performance =  35.54 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.101057 s, Result = 0a500000, Performance =  37.40 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.104239 s, Result = 0a8c0000, Performance =  37.08 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.108365 s, Result = 0ac80000, Performance =  36.46 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.112802 s, Result = 0b040000, Performance =  35.79 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.114240 s, Result = 0b400000, Performance =  36.09 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.117524 s, Result = 0b7c0000, Performance =  35.81 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.121886 s, Result = 0bb80000, Performance =  35.24 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.130356 s, Result = 0bf40000, Performance =  33.61 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.126224 s, Result = 0c300000, Performance =  35.39 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.132037 s, Result = 0c6c0000, Performance =  34.48 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.136028 s, Result = 0ca80000, Performance =  34.10 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.141139 s, Result = 0ce40000, Performance =  33.47 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.141241 s, Result = 0d200000, Performance =  34.06 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.146178 s, Result = 0d5c0000, Performance =  33.50 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.148198 s, Result = 0d980000, Performance =  33.62 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.149475 s, Result = 0dd40000, Performance =  33.91 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.146553 s, Result = 0e100000, Performance =  35.17 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.156373 s, Result = 0e4c0000, Performance =  33.51 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.160222 s, Result = 0e880000, Performance =  33.24 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.162329 s, Result = 0ec40000, Performance =  33.34 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.230096 s, Result = 0f000000, Performance =  23.89 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1920  1666  2048
Test passed: M N K =   579   841   576
Test passed: M N K =   962   782  1024
Test passed: M N K =   471   300  1856
Test passed: M N K =  1981   879  1152
M N K =  4096  4096   256, Elapsed time =   0.031001 s, Result = 10380000, Performance =   2.77 TOPS
M N K =  4096  4096   512, Elapsed time =   0.032876 s, Result = 10600000, Performance =   5.23 TOPS
M N K =  4096  4096   768, Elapsed time =   0.033864 s, Result = 10880000, Performance =   7.61 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.038853 s, Result = 10b00000, Performance =   8.84 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038899 s, Result = 10d80000, Performance =  11.04 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.041266 s, Result = 11000000, Performance =  12.49 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.045465 s, Result = 11280000, Performance =  13.23 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.049476 s, Result = 11500000, Performance =  13.89 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.050083 s, Result = 11780000, Performance =  15.44 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.054577 s, Result = 11a00000, Performance =  15.74 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.057710 s, Result = 11c80000, Performance =  16.37 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.059947 s, Result = 11f00000, Performance =  17.19 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.063246 s, Result = 12180000, Performance =  17.66 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.066303 s, Result = 12400000, Performance =  18.14 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.069018 s, Result = 12680000, Performance =  18.67 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.073237 s, Result = 12900000, Performance =  18.77 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.074777 s, Result = 12b80000, Performance =  19.53 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.077376 s, Result = 12e00000, Performance =  19.98 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.080428 s, Result = 13080000, Performance =  20.29 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.082850 s, Result = 13300000, Performance =  20.74 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.085843 s, Result = 13580000, Performance =  21.01 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.088123 s, Result = 13800000, Performance =  21.44 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.090933 s, Result = 13a80000, Performance =  21.73 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.093717 s, Result = 13d00000, Performance =  22.00 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.096494 s, Result = 13f80000, Performance =  22.26 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.099387 s, Result = 14200000, Performance =  22.47 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.102221 s, Result = 14480000, Performance =  22.69 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.104862 s, Result = 14700000, Performance =  22.94 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.106508 s, Result = 14980000, Performance =  23.39 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.108292 s, Result = 14c00000, Performance =  23.80 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.111723 s, Result = 14e80000, Performance =  23.83 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.118132 s, Result = 15100000, Performance =  23.27 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.109920 s, Result = 15380000, Performance =  25.79 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.111196 s, Result = 15600000, Performance =  26.27 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.114046 s, Result = 15880000, Performance =  26.36 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.116053 s, Result = 15b00000, Performance =  26.65 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.118159 s, Result = 15d80000, Performance =  26.90 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.120904 s, Result = 16000000, Performance =  27.00 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.123586 s, Result = 16280000, Performance =  27.11 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.125646 s, Result = 16500000, Performance =  27.35 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.131764 s, Result = 16780000, Performance =  26.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.134395 s, Result = 16a00000, Performance =  26.84 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.139847 s, Result = 16c80000, Performance =  26.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.140566 s, Result = 16f00000, Performance =  26.89 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.140574 s, Result = 17180000, Performance =  27.50 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.143137 s, Result = 17400000, Performance =  27.61 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.145616 s, Result = 17680000, Performance =  27.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.145421 s, Result = 17900000, Performance =  28.35 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.147243 s, Result = 17b80000, Performance =  28.59 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.148490 s, Result = 17e00000, Performance =  28.92 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.150235 s, Result = 18080000, Performance =  29.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.150475 s, Result = 18300000, Performance =  29.68 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.152704 s, Result = 18580000, Performance =  29.81 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.155313 s, Result = 18800000, Performance =  29.87 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.155453 s, Result = 18a80000, Performance =  30.39 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.155061 s, Result = 18d00000, Performance =  31.02 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.156992 s, Result = 18f80000, Performance =  31.19 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.158633 s, Result = 19200000, Performance =  31.41 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.155611 s, Result = 19480000, Performance =  32.57 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.155972 s, Result = 19700000, Performance =  33.04 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.156859 s, Result = 19980000, Performance =  33.40 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.164468 s, Result = 19c00000, Performance =  32.38 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.168380 s, Result = 19e80000, Performance =  32.14 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.201729 s, Result = 1a100000, Performance =  27.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   297  1558  1024
Test passed: M N K =   737  1375  1408
Test passed: M N K =  1773  2018   320
Test passed: M N K =   358   255  2048
Test passed: M N K =   755  1689   448
M N K =  4096  4096   256, Elapsed time =   0.025085 s, Result = 00280000, Performance =   3.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.023839 s, Result = 00500000, Performance =   7.21 TOPS
M N K =  4096  4096   768, Elapsed time =   0.027505 s, Result = 00780000, Performance =   9.37 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.027708 s, Result = 00a00000, Performance =  12.40 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028881 s, Result = 00c80000, Performance =  14.87 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.029599 s, Result = 00f00000, Performance =  17.41 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.031904 s, Result = 01180000, Performance =  18.85 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.034940 s, Result = 01400000, Performance =  19.67 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.036228 s, Result = 01680000, Performance =  21.34 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.038705 s, Result = 01900000, Performance =  22.19 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.040665 s, Result = 01b80000, Performance =  23.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.043662 s, Result = 01e00000, Performance =  23.61 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.045501 s, Result = 02080000, Performance =  24.54 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.048492 s, Result = 02300000, Performance =  24.80 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051240 s, Result = 02580000, Performance =  25.15 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.054696 s, Result = 02800000, Performance =  25.13 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.056462 s, Result = 02a80000, Performance =  25.86 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.059257 s, Result = 02d00000, Performance =  26.09 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.061264 s, Result = 02f80000, Performance =  26.64 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.063247 s, Result = 03200000, Performance =  27.16 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.065570 s, Result = 03480000, Performance =  27.51 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.067826 s, Result = 03700000, Performance =  27.86 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.071181 s, Result = 03980000, Performance =  27.76 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.075537 s, Result = 03c00000, Performance =  27.29 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.082389 s, Result = 03e80000, Performance =  26.07 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.085414 s, Result = 04100000, Performance =  26.15 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.088024 s, Result = 04380000, Performance =  26.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.090449 s, Result = 04600000, Performance =  26.59 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.093049 s, Result = 04880000, Performance =  26.77 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.094579 s, Result = 04b00000, Performance =  27.25 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.098638 s, Result = 04d80000, Performance =  27.00 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.105169 s, Result = 05000000, Performance =  26.14 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.096290 s, Result = 05280000, Performance =  29.44 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.098445 s, Result = 05500000, Performance =  29.67 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.101129 s, Result = 05780000, Performance =  29.73 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.101803 s, Result = 05a00000, Performance =  30.38 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.105832 s, Result = 05c80000, Performance =  30.03 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.107330 s, Result = 05f00000, Performance =  30.41 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.111052 s, Result = 06180000, Performance =  30.17 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.112727 s, Result = 06400000, Performance =  30.48 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.117156 s, Result = 06680000, Performance =  30.06 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.120406 s, Result = 06900000, Performance =  29.96 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.123941 s, Result = 06b80000, Performance =  29.80 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.122795 s, Result = 06e00000, Performance =  30.78 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.121106 s, Result = 07080000, Performance =  31.92 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.124100 s, Result = 07300000, Performance =  31.84 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.125597 s, Result = 07580000, Performance =  32.14 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.125179 s, Result = 07800000, Performance =  32.94 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.127758 s, Result = 07a80000, Performance =  32.95 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.130063 s, Result = 07d00000, Performance =  33.02 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.133977 s, Result = 07f80000, Performance =  32.70 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.135747 s, Result = 08200000, Performance =  32.91 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.139290 s, Result = 08480000, Performance =  32.68 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.142008 s, Result = 08700000, Performance =  32.66 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.142279 s, Result = 08980000, Performance =  33.21 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.141544 s, Result = 08c00000, Performance =  33.99 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.144101 s, Result = 08e80000, Performance =  33.98 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.145568 s, Result = 09100000, Performance =  34.23 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.141801 s, Result = 09380000, Performance =  35.74 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.142695 s, Result = 09600000, Performance =  36.12 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.143104 s, Result = 09880000, Performance =  36.62 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.150741 s, Result = 09b00000, Performance =  35.33 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.147203 s, Result = 09d80000, Performance =  36.76 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.188518 s, Result = 0a000000, Performance =  29.16 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   928   826  1472
Test passed: M N K =   312   616   192
Test passed: M N K =   720   729   896
Test passed: M N K =  1732  1376   832
Test passed: M N K =  1908   993  1856
M N K =  4096  4096   256, Elapsed time =   0.019644 s, Result = a0c80000, Performance =   4.37 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017476 s, Result = a0f00000, Performance =   9.83 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018667 s, Result = a1180000, Performance =  13.81 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.020149 s, Result = a1400000, Performance =  17.05 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.020825 s, Result = a1680000, Performance =  20.62 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.022782 s, Result = a1900000, Performance =  22.62 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023777 s, Result = a1b80000, Performance =  25.29 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.025832 s, Result = a1e00000, Performance =  26.60 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.027394 s, Result = a2080000, Performance =  28.22 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.029359 s, Result = a2300000, Performance =  29.26 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.031174 s, Result = a2580000, Performance =  30.31 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.033958 s, Result = a2800000, Performance =  30.36 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.035717 s, Result = a2a80000, Performance =  31.27 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.038110 s, Result = a2d00000, Performance =  31.56 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.040901 s, Result = a2f80000, Performance =  31.50 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.043793 s, Result = a3200000, Performance =  31.38 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.045291 s, Result = a3480000, Performance =  32.24 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.048403 s, Result = a3700000, Performance =  31.94 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.054040 s, Result = a3980000, Performance =  30.20 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.058056 s, Result = a3c00000, Performance =  29.59 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.060856 s, Result = a3e80000, Performance =  29.64 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.063180 s, Result = a4100000, Performance =  29.91 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.064820 s, Result = a4380000, Performance =  30.48 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.067000 s, Result = a4600000, Performance =  30.77 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.070067 s, Result = a4880000, Performance =  30.65 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.072656 s, Result = a4b00000, Performance =  30.74 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.075102 s, Result = a4d80000, Performance =  30.88 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.077249 s, Result = a5000000, Performance =  31.14 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.078823 s, Result = a5280000, Performance =  31.60 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.081466 s, Result = a5500000, Performance =  31.63 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.084065 s, Result = a5780000, Performance =  31.68 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.090330 s, Result = a5a00000, Performance =  30.43 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.082479 s, Result = a5c80000, Performance =  34.37 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.082561 s, Result = a5f00000, Performance =  35.37 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.085207 s, Result = a6180000, Performance =  35.28 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.087479 s, Result = a6400000, Performance =  35.35 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.091114 s, Result = a6680000, Performance =  34.88 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.094411 s, Result = a6900000, Performance =  34.57 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.098177 s, Result = a6b80000, Performance =  34.12 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.099612 s, Result = a6e00000, Performance =  34.49 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.105335 s, Result = a7080000, Performance =  33.44 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.108799 s, Result = a7300000, Performance =  33.16 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.115348 s, Result = a7580000, Performance =  32.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.114225 s, Result = a7800000, Performance =  33.09 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.113594 s, Result = a7a80000, Performance =  34.03 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.115280 s, Result = a7d00000, Performance =  34.28 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.116029 s, Result = a7f80000, Performance =  34.80 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.118082 s, Result = a8200000, Performance =  34.92 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.117957 s, Result = a8480000, Performance =  35.68 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.120383 s, Result = a8700000, Performance =  35.68 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.122332 s, Result = a8980000, Performance =  35.81 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.122151 s, Result = a8c00000, Performance =  36.57 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.123633 s, Result = a8e80000, Performance =  36.82 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.126916 s, Result = a9100000, Performance =  36.55 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.126732 s, Result = a9380000, Performance =  37.28 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.127023 s, Result = a9600000, Performance =  37.87 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.129775 s, Result = a9880000, Performance =  37.73 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.133235 s, Result = a9b00000, Performance =  37.39 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.129732 s, Result = a9d80000, Performance =  39.07 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.127323 s, Result = aa000000, Performance =  40.48 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.129374 s, Result = aa280000, Performance =  40.50 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.137612 s, Result = aa500000, Performance =  38.70 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.133708 s, Result = aa780000, Performance =  40.47 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.179553 s, Result = aaa00000, Performance =  30.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   566   526   192
Test passed: M N K =  1209  1614   704
Test passed: M N K =   866   175   896
Test passed: M N K =  1662   710  1216
Test passed: M N K =  1458   614   768
M N K =  4096  4096   256, Elapsed time =   0.001372 s, Result = 00280000, Performance =  62.62 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002824 s, Result = 00500000, Performance =  60.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.004698 s, Result = 00780000, Performance =  54.85 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004418 s, Result = 00a00000, Performance =  77.76 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.006194 s, Result = 00c80000, Performance =  69.34 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.009766 s, Result = 00f00000, Performance =  52.78 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.005780 s, Result = 01180000, Performance = 104.02 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013049 s, Result = 01400000, Performance =  52.66 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008202 s, Result = 01680000, Performance =  94.26 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.010202 s, Result = 01900000, Performance =  84.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012595 s, Result = 01b80000, Performance =  75.02 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014531 s, Result = 01e00000, Performance =  70.94 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017332 s, Result = 02080000, Performance =  64.43 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019884 s, Result = 02300000, Performance =  60.48 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.022227 s, Result = 02580000, Performance =  57.97 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.025103 s, Result = 02800000, Performance =  54.75 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.026680 s, Result = 02a80000, Performance =  54.73 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.034937 s, Result = 02d00000, Performance =  44.26 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.040065 s, Result = 02f80000, Performance =  40.74 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.048942 s, Result = 03200000, Performance =  35.10 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.051697 s, Result = 03480000, Performance =  34.89 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.053731 s, Result = 03700000, Performance =  35.17 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.056796 s, Result = 03980000, Performance =  34.79 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.058835 s, Result = 03c00000, Performance =  35.04 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.062612 s, Result = 03e80000, Performance =  34.30 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.064816 s, Result = 04100000, Performance =  34.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.067326 s, Result = 04380000, Performance =  34.45 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.070480 s, Result = 04600000, Performance =  34.13 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.072645 s, Result = 04880000, Performance =  34.29 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.075176 s, Result = 04b00000, Performance =  34.28 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.077979 s, Result = 04d80000, Performance =  34.15 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.083705 s, Result = 05000000, Performance =  32.84 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.075587 s, Result = 05280000, Performance =  37.50 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.077387 s, Result = 05500000, Performance =  37.74 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.080407 s, Result = 05780000, Performance =  37.39 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.074505 s, Result = 05a00000, Performance =  41.51 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.076667 s, Result = 05c80000, Performance =  41.46 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.078865 s, Result = 05f00000, Performance =  41.39 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.082869 s, Result = 06180000, Performance =  40.43 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.085437 s, Result = 06400000, Performance =  40.22 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.089759 s, Result = 06680000, Performance =  39.24 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.092401 s, Result = 06900000, Performance =  39.04 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.093609 s, Result = 06b80000, Performance =  39.46 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.092375 s, Result = 06e00000, Performance =  40.92 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.094449 s, Result = 07080000, Performance =  40.93 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.098903 s, Result = 07300000, Performance =  39.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.101432 s, Result = 07580000, Performance =  39.80 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.103116 s, Result = 07800000, Performance =  39.99 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.103193 s, Result = 07a80000, Performance =  40.79 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.104303 s, Result = 07d00000, Performance =  41.18 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.107973 s, Result = 07f80000, Performance =  40.57 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.107265 s, Result = 08200000, Performance =  41.64 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.109849 s, Result = 08480000, Performance =  41.44 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.112379 s, Result = 08700000, Performance =  41.28 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.113323 s, Result = 08980000, Performance =  41.69 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.112749 s, Result = 08c00000, Performance =  42.66 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.114786 s, Result = 08e80000, Performance =  42.66 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.116471 s, Result = 09100000, Performance =  42.78 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.114144 s, Result = 09380000, Performance =  44.40 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.114268 s, Result = 09600000, Performance =  45.10 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.116275 s, Result = 09880000, Performance =  45.06 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.123464 s, Result = 09b00000, Performance =  43.14 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.120172 s, Result = 09d80000, Performance =  45.03 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.165692 s, Result = 0a000000, Performance =  33.18 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   465  1984  1472
Test passed: M N K =  1109   964    64
Test passed: M N K =   664   910  1536
Test passed: M N K =   723  1210   832
Test passed: M N K =  1676  1260   576
M N K =  4096  4096   256, Elapsed time =   0.030751 s, Result = 10380000, Performance =   2.79 TOPS
M N K =  4096  4096   512, Elapsed time =   0.031965 s, Result = 10600000, Performance =   5.37 TOPS
M N K =  4096  4096   768, Elapsed time =   0.036382 s, Result = 10880000, Performance =   7.08 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.037883 s, Result = 10b00000, Performance =   9.07 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.041346 s, Result = 10d80000, Performance =  10.39 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.042082 s, Result = 11000000, Performance =  12.25 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.045214 s, Result = 11280000, Performance =  13.30 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.046084 s, Result = 11500000, Performance =  14.91 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.048833 s, Result = 11780000, Performance =  15.83 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.051212 s, Result = 11a00000, Performance =  16.77 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.054049 s, Result = 11c80000, Performance =  17.48 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.063572 s, Result = 11f00000, Performance =  16.21 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.066686 s, Result = 12180000, Performance =  16.75 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.069894 s, Result = 12400000, Performance =  17.21 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.073447 s, Result = 12680000, Performance =  17.54 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.070605 s, Result = 12900000, Performance =  19.47 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.070678 s, Result = 12b80000, Performance =  20.66 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.073063 s, Result = 12e00000, Performance =  21.16 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.075251 s, Result = 13080000, Performance =  21.69 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.077449 s, Result = 13300000, Performance =  22.18 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.079966 s, Result = 13580000, Performance =  22.56 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.082783 s, Result = 13800000, Performance =  22.83 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.085000 s, Result = 13a80000, Performance =  23.24 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.087361 s, Result = 13d00000, Performance =  23.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.098703 s, Result = 13f80000, Performance =  21.76 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.092196 s, Result = 14200000, Performance =  24.22 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.093605 s, Result = 14480000, Performance =  24.78 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.096345 s, Result = 14700000, Performance =  24.96 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.097825 s, Result = 14980000, Performance =  25.46 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.100279 s, Result = 14c00000, Performance =  25.70 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.102797 s, Result = 14e80000, Performance =  25.90 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.118331 s, Result = 15100000, Performance =  23.23 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.105092 s, Result = 15380000, Performance =  26.97 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.101400 s, Result = 15600000, Performance =  28.80 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.102533 s, Result = 15880000, Performance =  29.32 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.104590 s, Result = 15b00000, Performance =  29.57 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.107473 s, Result = 15d80000, Performance =  29.57 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.109331 s, Result = 16000000, Performance =  29.86 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.111892 s, Result = 16280000, Performance =  29.94 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.113609 s, Result = 16500000, Performance =  30.24 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.115887 s, Result = 16780000, Performance =  30.39 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.118578 s, Result = 16a00000, Performance =  30.43 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.122869 s, Result = 16c80000, Performance =  30.06 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.121533 s, Result = 16f00000, Performance =  31.10 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.123334 s, Result = 17180000, Performance =  31.34 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.126199 s, Result = 17400000, Performance =  31.31 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.128549 s, Result = 17680000, Performance =  31.41 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.128905 s, Result = 17900000, Performance =  31.99 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.130305 s, Result = 17b80000, Performance =  32.30 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.135814 s, Result = 17e00000, Performance =  31.62 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.133823 s, Result = 18080000, Performance =  32.74 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.133965 s, Result = 18300000, Performance =  33.34 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.134706 s, Result = 18580000, Performance =  33.80 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.137337 s, Result = 18800000, Performance =  33.78 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.138383 s, Result = 18a80000, Performance =  34.14 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.138860 s, Result = 18d00000, Performance =  34.64 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.142146 s, Result = 18f80000, Performance =  34.45 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.142401 s, Result = 19200000, Performance =  34.99 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.143131 s, Result = 19480000, Performance =  35.41 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.142273 s, Result = 19700000, Performance =  36.23 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.145692 s, Result = 19980000, Performance =  35.97 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.146539 s, Result = 19c00000, Performance =  36.34 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.151947 s, Result = 19e80000, Performance =  35.62 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.199016 s, Result = 1a100000, Performance =  27.62 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1885  2018  1920
Test passed: M N K =  2047  1898  1664
Test passed: M N K =   568  1999   192
Test passed: M N K =   193  1862   896
Test passed: M N K =  1414  1465   640
M N K =  4096  4096   256, Elapsed time =   0.024932 s, Result = 00280000, Performance =   3.45 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024001 s, Result = 00500000, Performance =   7.16 TOPS
M N K =  4096  4096   768, Elapsed time =   0.026211 s, Result = 00780000, Performance =   9.83 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.029140 s, Result = 00a00000, Performance =  11.79 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028031 s, Result = 00c80000, Performance =  15.32 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.029495 s, Result = 00f00000, Performance =  17.47 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.030803 s, Result = 01180000, Performance =  19.52 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.032656 s, Result = 01400000, Performance =  21.04 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.036332 s, Result = 01680000, Performance =  21.28 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.035463 s, Result = 01900000, Performance =  24.22 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.038085 s, Result = 01b80000, Performance =  24.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.040536 s, Result = 01e00000, Performance =  25.43 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.042351 s, Result = 02080000, Performance =  26.37 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.044518 s, Result = 02300000, Performance =  27.01 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.047494 s, Result = 02580000, Performance =  27.13 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.050507 s, Result = 02800000, Performance =  27.21 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.052910 s, Result = 02a80000, Performance =  27.60 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.055035 s, Result = 02d00000, Performance =  28.09 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.059062 s, Result = 02f80000, Performance =  27.63 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.064957 s, Result = 03200000, Performance =  26.45 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.066800 s, Result = 03480000, Performance =  27.00 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.067924 s, Result = 03700000, Performance =  27.82 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.070096 s, Result = 03980000, Performance =  28.19 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.072777 s, Result = 03c00000, Performance =  28.33 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.074691 s, Result = 03e80000, Performance =  28.75 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.077238 s, Result = 04100000, Performance =  28.92 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.078890 s, Result = 04380000, Performance =  29.40 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.082041 s, Result = 04600000, Performance =  29.32 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.082838 s, Result = 04880000, Performance =  30.07 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.085376 s, Result = 04b00000, Performance =  30.18 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.087660 s, Result = 04d80000, Performance =  30.38 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.102975 s, Result = 05000000, Performance =  26.69 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.091728 s, Result = 05280000, Performance =  30.90 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.087247 s, Result = 05500000, Performance =  33.47 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.089525 s, Result = 05780000, Performance =  33.58 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.091154 s, Result = 05a00000, Performance =  33.92 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.094262 s, Result = 05c80000, Performance =  33.72 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.095551 s, Result = 05f00000, Performance =  34.16 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.098611 s, Result = 06180000, Performance =  33.97 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.099586 s, Result = 06400000, Performance =  34.50 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.102385 s, Result = 06680000, Performance =  34.40 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.105383 s, Result = 06900000, Performance =  34.23 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.109410 s, Result = 06b80000, Performance =  33.76 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.108753 s, Result = 06e00000, Performance =  34.75 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.110385 s, Result = 07080000, Performance =  35.02 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.112200 s, Result = 07300000, Performance =  35.22 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.114988 s, Result = 07580000, Performance =  35.11 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.116953 s, Result = 07800000, Performance =  35.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.117822 s, Result = 07a80000, Performance =  35.72 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.119836 s, Result = 07d00000, Performance =  35.84 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.121072 s, Result = 07f80000, Performance =  36.18 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.120635 s, Result = 08200000, Performance =  37.03 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.121676 s, Result = 08480000, Performance =  37.42 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.124098 s, Result = 08700000, Performance =  37.38 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.125277 s, Result = 08980000, Performance =  37.71 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.124964 s, Result = 08c00000, Performance =  38.49 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.127790 s, Result = 08e80000, Performance =  38.31 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.129140 s, Result = 09100000, Performance =  38.58 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.128146 s, Result = 09380000, Performance =  39.55 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.128052 s, Result = 09600000, Performance =  40.25 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.129997 s, Result = 09880000, Performance =  40.31 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.133309 s, Result = 09b00000, Performance =  39.95 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.139179 s, Result = 09d80000, Performance =  38.88 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.183345 s, Result = 0a000000, Performance =  29.98 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   105  1509   640
Test passed: M N K =  1042  1981   640
Test passed: M N K =  2013  1385   896
Test passed: M N K =   473   390  1856
Test passed: M N K =   921  1494  1984
M N K =  4096  4096   256, Elapsed time =   0.020067 s, Result = a0c80000, Performance =   4.28 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017895 s, Result = a0f00000, Performance =   9.60 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018956 s, Result = a1180000, Performance =  13.59 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.019920 s, Result = a1400000, Performance =  17.25 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.020916 s, Result = a1680000, Performance =  20.53 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.022758 s, Result = a1900000, Performance =  22.65 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023415 s, Result = a1b80000, Performance =  25.68 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.025073 s, Result = a1e00000, Performance =  27.41 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.026719 s, Result = a2080000, Performance =  28.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.027647 s, Result = a2300000, Performance =  31.07 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.029639 s, Result = a2580000, Performance =  31.88 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.030927 s, Result = a2800000, Performance =  33.33 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.032946 s, Result = a2a80000, Performance =  33.89 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.034826 s, Result = a2d00000, Performance =  34.53 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.037179 s, Result = a2f80000, Performance =  34.66 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.039831 s, Result = a3200000, Performance =  34.51 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.041718 s, Result = a3480000, Performance =  35.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.043619 s, Result = a3700000, Performance =  35.45 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.045970 s, Result = a3980000, Performance =  35.50 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.047833 s, Result = a3c00000, Performance =  35.92 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.051138 s, Result = a3e80000, Performance =  35.28 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.053358 s, Result = a4100000, Performance =  35.42 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.055740 s, Result = a4380000, Performance =  35.44 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.058016 s, Result = a4600000, Performance =  35.53 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.059949 s, Result = a4880000, Performance =  35.82 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.061763 s, Result = a4b00000, Performance =  36.16 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.063810 s, Result = a4d80000, Performance =  36.35 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.067017 s, Result = a5000000, Performance =  35.89 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.068406 s, Result = a5280000, Performance =  36.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.070804 s, Result = a5500000, Performance =  36.40 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.073643 s, Result = a5780000, Performance =  36.16 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.090376 s, Result = a5a00000, Performance =  30.41 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.076485 s, Result = a5c80000, Performance =  37.06 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.074564 s, Result = a5f00000, Performance =  39.17 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.077099 s, Result = a6180000, Performance =  38.99 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.079107 s, Result = a6400000, Performance =  39.09 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.081934 s, Result = a6680000, Performance =  38.79 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.083603 s, Result = a6900000, Performance =  39.04 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.085880 s, Result = a6b80000, Performance =  39.01 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.087684 s, Result = a6e00000, Performance =  39.19 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.090176 s, Result = a7080000, Performance =  39.06 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.091727 s, Result = a7300000, Performance =  39.33 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.096237 s, Result = a7580000, Performance =  38.38 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.095201 s, Result = a7800000, Performance =  39.70 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.097236 s, Result = a7a80000, Performance =  39.75 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.099121 s, Result = a7d00000, Performance =  39.86 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.101851 s, Result = a7f80000, Performance =  39.64 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.102898 s, Result = a8200000, Performance =  40.07 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.103788 s, Result = a8480000, Performance =  40.55 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.106159 s, Result = a8700000, Performance =  40.46 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.108592 s, Result = a8980000, Performance =  40.34 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.108010 s, Result = a8c00000, Performance =  41.35 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.109244 s, Result = a8e80000, Performance =  41.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.112004 s, Result = a9100000, Performance =  41.41 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.114126 s, Result = a9380000, Performance =  41.40 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.113803 s, Result = a9600000, Performance =  42.27 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.117119 s, Result = a9880000, Performance =  41.81 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.117592 s, Result = a9b00000, Performance =  42.37 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.118732 s, Result = a9d80000, Performance =  42.68 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.116036 s, Result = aa000000, Performance =  44.42 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.122115 s, Result = aa280000, Performance =  42.91 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.120858 s, Result = aa500000, Performance =  44.07 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.126403 s, Result = aa780000, Performance =  42.81 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.172854 s, Result = aaa00000, Performance =  31.80 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1132  1602   192
Test passed: M N K =  1784   185   448
Test passed: M N K =  1670  1179  1728
Test passed: M N K =   942   256  1344
Test passed: M N K =   936   889   704
M N K =  4096  4096   256, Elapsed time =   0.001357 s, Result = 00280000, Performance =  63.29 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002626 s, Result = 00500000, Performance =  65.42 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003030 s, Result = 00780000, Performance =  85.04 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003497 s, Result = 00a00000, Performance =  98.25 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.004477 s, Result = 00c80000, Performance =  95.93 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005314 s, Result = 00f00000, Performance =  96.99 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.014240 s, Result = 01180000, Performance =  42.23 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008469 s, Result = 01400000, Performance =  81.14 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015567 s, Result = 01680000, Performance =  49.66 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009176 s, Result = 01900000, Performance =  93.61 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.020702 s, Result = 01b80000, Performance =  45.64 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011742 s, Result = 01e00000, Performance =  87.78 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013872 s, Result = 02080000, Performance =  80.50 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018235 s, Result = 02300000, Performance =  65.95 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.019203 s, Result = 02580000, Performance =  67.10 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022004 s, Result = 02800000, Performance =  62.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.024737 s, Result = 02a80000, Performance =  59.03 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.029171 s, Result = 02d00000, Performance =  53.01 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.034114 s, Result = 02f80000, Performance =  47.84 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.037190 s, Result = 03200000, Performance =  46.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.039179 s, Result = 03480000, Performance =  46.04 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.041587 s, Result = 03700000, Performance =  45.44 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.044211 s, Result = 03980000, Performance =  44.69 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.046664 s, Result = 03c00000, Performance =  44.18 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.048171 s, Result = 03e80000, Performance =  44.58 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.050541 s, Result = 04100000, Performance =  44.19 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.052388 s, Result = 04380000, Performance =  44.27 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.054690 s, Result = 04600000, Performance =  43.98 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.056568 s, Result = 04880000, Performance =  44.04 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.058763 s, Result = 04b00000, Performance =  43.85 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.061348 s, Result = 04d80000, Performance =  43.41 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.075764 s, Result = 05000000, Performance =  36.28 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.063756 s, Result = 05280000, Performance =  44.46 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.059538 s, Result = 05500000, Performance =  49.05 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.062174 s, Result = 05780000, Performance =  48.36 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.063884 s, Result = 05a00000, Performance =  48.41 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.067777 s, Result = 05c80000, Performance =  46.89 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.069168 s, Result = 05f00000, Performance =  47.19 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.070837 s, Result = 06180000, Performance =  47.29 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.071979 s, Result = 06400000, Performance =  47.74 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.074977 s, Result = 06680000, Performance =  46.97 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.077166 s, Result = 06900000, Performance =  46.75 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.081503 s, Result = 06b80000, Performance =  45.32 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.080477 s, Result = 06e00000, Performance =  46.96 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.082117 s, Result = 07080000, Performance =  47.07 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.084424 s, Result = 07300000, Performance =  46.80 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.086677 s, Result = 07580000, Performance =  46.58 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.087672 s, Result = 07800000, Performance =  47.03 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.089423 s, Result = 07a80000, Performance =  47.07 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.092132 s, Result = 07d00000, Performance =  46.62 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.108654 s, Result = 07f80000, Performance =  40.32 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.092998 s, Result = 08200000, Performance =  48.03 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.095517 s, Result = 08480000, Performance =  47.66 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.098506 s, Result = 08700000, Performance =  47.09 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.099821 s, Result = 08980000, Performance =  47.33 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.099171 s, Result = 08c00000, Performance =  48.51 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.102680 s, Result = 08e80000, Performance =  47.68 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.104092 s, Result = 09100000, Performance =  47.86 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.104956 s, Result = 09380000, Performance =  48.29 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.101548 s, Result = 09600000, Performance =  50.75 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.106983 s, Result = 09880000, Performance =  48.98 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.107093 s, Result = 09b00000, Performance =  49.73 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.112210 s, Result = 09d80000, Performance =  48.23 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.161714 s, Result = 0a000000, Performance =  34.00 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1287   793  1280
Test passed: M N K =  1323  1094  1344
Test passed: M N K =   637  1233  1792
Test passed: M N K =   271  1821  1984
Test passed: M N K =  1779   787   320
M N K =  4096  4096   256, Elapsed time =   0.030756 s, Result = 10380000, Performance =   2.79 TOPS
M N K =  4096  4096   512, Elapsed time =   0.032622 s, Result = 10600000, Performance =   5.27 TOPS
M N K =  4096  4096   768, Elapsed time =   0.033882 s, Result = 10880000, Performance =   7.61 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.034007 s, Result = 10b00000, Performance =  10.10 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.039681 s, Result = 10d80000, Performance =  10.82 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.039205 s, Result = 11000000, Performance =  13.15 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.051273 s, Result = 11280000, Performance =  11.73 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.044043 s, Result = 11500000, Performance =  15.60 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.056157 s, Result = 11780000, Performance =  13.77 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.050296 s, Result = 11a00000, Performance =  17.08 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.054811 s, Result = 11c80000, Performance =  17.24 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.056134 s, Result = 11f00000, Performance =  18.36 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.064164 s, Result = 12180000, Performance =  17.40 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.067089 s, Result = 12400000, Performance =  17.93 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.063483 s, Result = 12680000, Performance =  20.30 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.064440 s, Result = 12900000, Performance =  21.33 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.067053 s, Result = 12b80000, Performance =  21.78 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.071061 s, Result = 12e00000, Performance =  21.76 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.073374 s, Result = 13080000, Performance =  22.24 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074335 s, Result = 13300000, Performance =  23.11 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.076597 s, Result = 13580000, Performance =  23.55 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.079689 s, Result = 13800000, Performance =  23.71 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.081850 s, Result = 13a80000, Performance =  24.14 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.086071 s, Result = 13d00000, Performance =  23.95 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.086284 s, Result = 13f80000, Performance =  24.89 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.088912 s, Result = 14200000, Performance =  25.12 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.090759 s, Result = 14480000, Performance =  25.55 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.092509 s, Result = 14700000, Performance =  26.00 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.093923 s, Result = 14980000, Performance =  26.52 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.095704 s, Result = 14c00000, Performance =  26.93 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.097800 s, Result = 14e80000, Performance =  27.23 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.108924 s, Result = 15100000, Performance =  25.24 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.101272 s, Result = 15380000, Performance =  27.99 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.103150 s, Result = 15600000, Performance =  28.31 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.103620 s, Result = 15880000, Performance =  29.01 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.101613 s, Result = 15b00000, Performance =  30.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.104159 s, Result = 15d80000, Performance =  30.51 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.106304 s, Result = 16000000, Performance =  30.71 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.108941 s, Result = 16280000, Performance =  30.75 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.110117 s, Result = 16500000, Performance =  31.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.111809 s, Result = 16780000, Performance =  31.50 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.115577 s, Result = 16a00000, Performance =  31.22 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.119866 s, Result = 16c80000, Performance =  30.82 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.115712 s, Result = 16f00000, Performance =  32.66 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.117291 s, Result = 17180000, Performance =  32.96 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.120191 s, Result = 17400000, Performance =  32.88 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.121098 s, Result = 17680000, Performance =  33.34 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.122034 s, Result = 17900000, Performance =  33.79 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.123318 s, Result = 17b80000, Performance =  34.13 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.126013 s, Result = 17e00000, Performance =  34.08 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.131310 s, Result = 18080000, Performance =  33.36 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.127890 s, Result = 18300000, Performance =  34.93 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.131415 s, Result = 18580000, Performance =  34.64 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.141272 s, Result = 18800000, Performance =  32.83 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.135870 s, Result = 18a80000, Performance =  34.77 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.138770 s, Result = 18d00000, Performance =  34.66 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.142724 s, Result = 18f80000, Performance =  34.31 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.142388 s, Result = 19200000, Performance =  34.99 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.141351 s, Result = 19480000, Performance =  35.85 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.139081 s, Result = 19700000, Performance =  37.06 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.144094 s, Result = 19980000, Performance =  36.36 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.146441 s, Result = 19c00000, Performance =  36.37 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.145159 s, Result = 19e80000, Performance =  37.28 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.191099 s, Result = 1a100000, Performance =  28.77 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   300  1888  1856
Test passed: M N K =    94  1853  1472
Test passed: M N K =  1950   732  1920
Test passed: M N K =   831   528  1536
Test passed: M N K =   519  1413  1472
M N K =  4096  4096   256, Elapsed time =   0.023977 s, Result = 00280000, Performance =   3.58 TOPS
M N K =  4096  4096   512, Elapsed time =   0.023237 s, Result = 00500000, Performance =   7.39 TOPS
M N K =  4096  4096   768, Elapsed time =   0.027161 s, Result = 00780000, Performance =   9.49 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.027846 s, Result = 00a00000, Performance =  12.34 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.037110 s, Result = 00c80000, Performance =  11.57 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.029551 s, Result = 00f00000, Performance =  17.44 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.030552 s, Result = 01180000, Performance =  19.68 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.031690 s, Result = 01400000, Performance =  21.69 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.034517 s, Result = 01680000, Performance =  22.40 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.035122 s, Result = 01900000, Performance =  24.46 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.038084 s, Result = 01b80000, Performance =  24.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.039444 s, Result = 01e00000, Performance =  26.13 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.041185 s, Result = 02080000, Performance =  27.11 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.043362 s, Result = 02300000, Performance =  27.73 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.045916 s, Result = 02580000, Performance =  28.06 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.048146 s, Result = 02800000, Performance =  28.55 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.050478 s, Result = 02a80000, Performance =  28.93 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.053917 s, Result = 02d00000, Performance =  28.68 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.057163 s, Result = 02f80000, Performance =  28.55 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060320 s, Result = 03200000, Performance =  28.48 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.063242 s, Result = 03480000, Performance =  28.52 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.065414 s, Result = 03700000, Performance =  28.89 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.067764 s, Result = 03980000, Performance =  29.16 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.069924 s, Result = 03c00000, Performance =  29.48 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.071699 s, Result = 03e80000, Performance =  29.95 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.074394 s, Result = 04100000, Performance =  30.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.076127 s, Result = 04380000, Performance =  30.47 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.077018 s, Result = 04600000, Performance =  31.23 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.079291 s, Result = 04880000, Performance =  31.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.081117 s, Result = 04b00000, Performance =  31.77 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.084031 s, Result = 04d80000, Performance =  31.69 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.094273 s, Result = 05000000, Performance =  29.16 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.088678 s, Result = 05280000, Performance =  31.97 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.089930 s, Result = 05500000, Performance =  32.48 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.090852 s, Result = 05780000, Performance =  33.09 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.089445 s, Result = 05a00000, Performance =  34.57 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.092390 s, Result = 05c80000, Performance =  34.40 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.094049 s, Result = 05f00000, Performance =  34.71 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.095271 s, Result = 06180000, Performance =  35.16 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.095011 s, Result = 06400000, Performance =  36.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.097129 s, Result = 06680000, Performance =  36.26 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.101258 s, Result = 06900000, Performance =  35.63 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.104877 s, Result = 06b80000, Performance =  35.22 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.101766 s, Result = 06e00000, Performance =  37.14 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.104306 s, Result = 07080000, Performance =  37.06 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.105966 s, Result = 07300000, Performance =  37.29 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.108126 s, Result = 07580000, Performance =  37.34 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.108948 s, Result = 07800000, Performance =  37.85 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.110700 s, Result = 07a80000, Performance =  38.02 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.112865 s, Result = 07d00000, Performance =  38.05 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.119380 s, Result = 07f80000, Performance =  36.70 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.114548 s, Result = 08200000, Performance =  38.99 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.118372 s, Result = 08480000, Performance =  38.46 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.119626 s, Result = 08700000, Performance =  38.78 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.124058 s, Result = 08980000, Performance =  38.08 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.123422 s, Result = 08c00000, Performance =  38.97 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.127746 s, Result = 08e80000, Performance =  38.33 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.135403 s, Result = 09100000, Performance =  36.79 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.127253 s, Result = 09380000, Performance =  39.83 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.124119 s, Result = 09600000, Performance =  41.52 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.129787 s, Result = 09880000, Performance =  40.37 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.141994 s, Result = 09b00000, Performance =  37.51 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.140395 s, Result = 09d80000, Performance =  38.55 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.185653 s, Result = 0a000000, Performance =  29.61 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1023  1505  1216
Test passed: M N K =   926   359  1280
Test passed: M N K =   291  1865   704
Test passed: M N K =  1991   710  1792
Test passed: M N K =   283  1352  1216
M N K =  4096  4096   256, Elapsed time =   0.019364 s, Result = a0c80000, Performance =   4.44 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017557 s, Result = a0f00000, Performance =   9.79 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018970 s, Result = a1180000, Performance =  13.58 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.019571 s, Result = a1400000, Performance =  17.56 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.036765 s, Result = a1680000, Performance =  11.68 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.021372 s, Result = a1900000, Performance =  24.12 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023032 s, Result = a1b80000, Performance =  26.11 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.024213 s, Result = a1e00000, Performance =  28.38 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.026213 s, Result = a2080000, Performance =  29.49 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.027681 s, Result = a2300000, Performance =  31.03 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.029217 s, Result = a2580000, Performance =  32.34 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.030807 s, Result = a2800000, Performance =  33.46 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.032533 s, Result = a2a80000, Performance =  34.33 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.034986 s, Result = a2d00000, Performance =  34.37 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.036785 s, Result = a2f80000, Performance =  35.03 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.038737 s, Result = a3200000, Performance =  35.48 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.048880 s, Result = a3480000, Performance =  29.88 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.050338 s, Result = a3700000, Performance =  30.72 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.047250 s, Result = a3980000, Performance =  34.54 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.049079 s, Result = a3c00000, Performance =  35.00 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.053102 s, Result = a3e80000, Performance =  33.97 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.055478 s, Result = a4100000, Performance =  34.06 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057399 s, Result = a4380000, Performance =  34.42 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.060364 s, Result = a4600000, Performance =  34.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.062558 s, Result = a4880000, Performance =  34.33 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.065419 s, Result = a4b00000, Performance =  34.14 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.067103 s, Result = a4d80000, Performance =  34.56 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.068354 s, Result = a5000000, Performance =  35.19 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.069915 s, Result = a5280000, Performance =  35.63 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.071273 s, Result = a5500000, Performance =  36.16 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.072915 s, Result = a5780000, Performance =  36.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.084510 s, Result = a5a00000, Performance =  32.53 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.076157 s, Result = a5c80000, Performance =  37.22 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.079010 s, Result = a5f00000, Performance =  36.96 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.078975 s, Result = a6180000, Performance =  38.07 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.079824 s, Result = a6400000, Performance =  38.74 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.082695 s, Result = a6680000, Performance =  38.43 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.083530 s, Result = a6900000, Performance =  39.08 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.085305 s, Result = a6b80000, Performance =  39.27 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.084630 s, Result = a6e00000, Performance =  40.60 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.086613 s, Result = a7080000, Performance =  40.66 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.089927 s, Result = a7300000, Performance =  40.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.094083 s, Result = a7580000, Performance =  39.26 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.089688 s, Result = a7800000, Performance =  42.14 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.092968 s, Result = a7a80000, Performance =  41.58 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.094126 s, Result = a7d00000, Performance =  41.98 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.096055 s, Result = a7f80000, Performance =  42.03 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.096826 s, Result = a8200000, Performance =  42.58 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.098415 s, Result = a8480000, Performance =  42.77 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.100908 s, Result = a8700000, Performance =  42.56 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.106231 s, Result = a8980000, Performance =  41.24 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.103712 s, Result = a8c00000, Performance =  43.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.107386 s, Result = a8e80000, Performance =  42.40 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.109099 s, Result = a9100000, Performance =  42.52 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.112411 s, Result = a9380000, Performance =  42.03 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.110960 s, Result = a9600000, Performance =  43.35 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.116185 s, Result = a9880000, Performance =  42.14 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.118626 s, Result = a9b00000, Performance =  42.00 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.117057 s, Result = a9d80000, Performance =  43.30 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.114502 s, Result = aa000000, Performance =  45.01 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.121150 s, Result = aa280000, Performance =  43.25 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.121316 s, Result = aa500000, Performance =  43.90 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.120493 s, Result = aa780000, Performance =  44.91 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.166776 s, Result = aaa00000, Performance =  32.96 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   175   540  1600
Test passed: M N K =   313  1047   832
Test passed: M N K =   736   243   768
Test passed: M N K =   888  1030  1024
Test passed: M N K =  1518   969  1792
M N K =  4096  4096   256, Elapsed time =   0.001374 s, Result = 00280000, Performance =  62.54 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002758 s, Result = 00500000, Performance =  62.29 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003983 s, Result = 00780000, Performance =  64.70 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003228 s, Result = 00a00000, Performance = 106.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.010093 s, Result = 00c80000, Performance =  42.55 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.005247 s, Result = 00f00000, Performance =  98.22 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.011838 s, Result = 01180000, Performance =  50.79 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.006901 s, Result = 01400000, Performance =  99.58 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010943 s, Result = 01680000, Performance =  70.65 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.009101 s, Result = 01900000, Performance =  94.39 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.010509 s, Result = 01b80000, Performance =  89.91 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011504 s, Result = 01e00000, Performance =  89.60 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013372 s, Result = 02080000, Performance =  83.51 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.015729 s, Result = 02300000, Performance =  76.45 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017896 s, Result = 02580000, Performance =  72.00 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020416 s, Result = 02800000, Performance =  67.32 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022560 s, Result = 02a80000, Performance =  64.73 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.025610 s, Result = 02d00000, Performance =  60.38 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.027643 s, Result = 02f80000, Performance =  59.04 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.029505 s, Result = 03200000, Performance =  58.23 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.031760 s, Result = 03480000, Performance =  56.80 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.033821 s, Result = 03700000, Performance =  55.88 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.036795 s, Result = 03980000, Performance =  53.69 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.039155 s, Result = 03c00000, Performance =  52.65 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.041112 s, Result = 03e80000, Performance =  52.23 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.043760 s, Result = 04100000, Performance =  51.04 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.045714 s, Result = 04380000, Performance =  50.74 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.047347 s, Result = 04600000, Performance =  50.80 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.049450 s, Result = 04880000, Performance =  50.38 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.051448 s, Result = 04b00000, Performance =  50.09 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.053659 s, Result = 04d80000, Performance =  49.63 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.065867 s, Result = 05000000, Performance =  41.73 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.061013 s, Result = 05280000, Performance =  46.46 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.061946 s, Result = 05500000, Performance =  47.15 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.062851 s, Result = 05780000, Performance =  47.83 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.062883 s, Result = 05a00000, Performance =  49.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.066772 s, Result = 05c80000, Performance =  47.60 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.068166 s, Result = 05f00000, Performance =  47.89 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.069738 s, Result = 06180000, Performance =  48.04 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.069428 s, Result = 06400000, Performance =  49.49 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.071816 s, Result = 06680000, Performance =  49.04 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.074417 s, Result = 06900000, Performance =  48.48 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.078771 s, Result = 06b80000, Performance =  46.89 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.074549 s, Result = 06e00000, Performance =  50.70 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.077825 s, Result = 07080000, Performance =  49.67 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.079679 s, Result = 07300000, Performance =  49.59 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.081605 s, Result = 07580000, Performance =  49.47 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.082900 s, Result = 07800000, Performance =  49.74 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.084420 s, Result = 07a80000, Performance =  49.86 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.086196 s, Result = 07d00000, Performance =  49.83 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.091600 s, Result = 07f80000, Performance =  47.83 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.088702 s, Result = 08200000, Performance =  50.36 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.092941 s, Result = 08480000, Performance =  48.98 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.094572 s, Result = 08700000, Performance =  49.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.099484 s, Result = 08980000, Performance =  47.49 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.099066 s, Result = 08c00000, Performance =  48.56 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.104313 s, Result = 08e80000, Performance =  46.94 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.105254 s, Result = 09100000, Performance =  47.33 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.103729 s, Result = 09380000, Performance =  48.86 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.100031 s, Result = 09600000, Performance =  51.52 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.107267 s, Result = 09880000, Performance =  48.85 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.108945 s, Result = 09b00000, Performance =  48.88 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.106439 s, Result = 09d80000, Performance =  50.84 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.159544 s, Result = 0a000000, Performance =  34.46 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   454   491  2048
Test passed: M N K =   125   278  1024
Test passed: M N K =   797  1425   896
Test passed: M N K =  1902  1346  1408
Test passed: M N K =  1753  1950  1984
M N K =  4096  4096   256, Elapsed time =   0.030298 s, Result = 902e0000, Performance =   2.84 TOPS
M N K =  4096  4096   512, Elapsed time =   0.035401 s, Result = 104c0000, Performance =   4.85 TOPS
M N K =  4096  4096   768, Elapsed time =   0.035746 s, Result = 906a0000, Performance =   7.21 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.038019 s, Result = 10880000, Performance =   9.04 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038362 s, Result = 90a60000, Performance =  11.20 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040347 s, Result = 10c40000, Performance =  12.77 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.041894 s, Result = 90e20000, Performance =  14.35 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.044541 s, Result = 11000000, Performance =  15.43 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.046198 s, Result = 911e0000, Performance =  16.73 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.047980 s, Result = 113c0000, Performance =  17.90 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.050014 s, Result = 915a0000, Performance =  18.89 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.051666 s, Result = 11780000, Performance =  19.95 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.053975 s, Result = 91960000, Performance =  20.69 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.056910 s, Result = 11b40000, Performance =  21.13 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.058630 s, Result = 91d20000, Performance =  21.98 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.060042 s, Result = 11f00000, Performance =  22.89 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.059925 s, Result = 920e0000, Performance =  24.37 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.061101 s, Result = 122c0000, Performance =  25.31 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.063255 s, Result = 924a0000, Performance =  25.80 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.064735 s, Result = 12680000, Performance =  26.54 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.066486 s, Result = 92860000, Performance =  27.13 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.068005 s, Result = 12a40000, Performance =  27.79 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.070004 s, Result = 92c20000, Performance =  28.22 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.076795 s, Result = 12e00000, Performance =  26.85 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.073911 s, Result = 92fe0000, Performance =  29.05 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.076207 s, Result = 131c0000, Performance =  29.31 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.078202 s, Result = 933a0000, Performance =  29.66 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.080386 s, Result = 13580000, Performance =  29.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.080668 s, Result = 93760000, Performance =  30.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.082213 s, Result = 13940000, Performance =  31.35 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.084794 s, Result = 93b20000, Performance =  31.40 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.087703 s, Result = 13d00000, Performance =  31.34 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.082305 s, Result = 93ee0000, Performance =  34.44 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.083227 s, Result = 140c0000, Performance =  35.09 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.085568 s, Result = 942a0000, Performance =  35.14 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.087288 s, Result = 14480000, Performance =  35.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.090296 s, Result = 94660000, Performance =  35.20 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.093524 s, Result = 14840000, Performance =  34.90 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.098019 s, Result = 94a20000, Performance =  34.18 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.100205 s, Result = 14c00000, Performance =  34.29 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.102246 s, Result = 94de0000, Performance =  34.45 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.103917 s, Result = 14fc0000, Performance =  34.72 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.109256 s, Result = 951a0000, Performance =  33.81 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.108284 s, Result = 15380000, Performance =  34.90 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.109162 s, Result = 95560000, Performance =  35.41 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.109836 s, Result = 15740000, Performance =  35.98 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.110311 s, Result = 95920000, Performance =  36.60 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.112507 s, Result = 15b00000, Performance =  36.65 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.110964 s, Result = 95ce0000, Performance =  37.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.111803 s, Result = 15ec0000, Performance =  38.42 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.113896 s, Result = 960a0000, Performance =  38.46 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.112945 s, Result = 16280000, Performance =  39.55 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.114087 s, Result = 96460000, Performance =  39.91 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.114697 s, Result = 16640000, Performance =  40.44 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.115274 s, Result = 96820000, Performance =  40.98 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.114539 s, Result = 16a00000, Performance =  42.00 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.115489 s, Result = 96be0000, Performance =  42.40 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.116499 s, Result = 16dc0000, Performance =  42.77 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.115656 s, Result = 96fa0000, Performance =  43.82 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.115678 s, Result = 17180000, Performance =  44.55 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.116879 s, Result = 97360000, Performance =  44.83 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.122630 s, Result = 17540000, Performance =  43.43 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.119795 s, Result = 97720000, Performance =  45.17 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.151981 s, Result = 17900000, Performance =  36.17 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   129  1613  1600
Test passed: M N K =   296   825   768
Test passed: M N K =   372  1644  1664
Test passed: M N K =   274  1726   320
Test passed: M N K =  1067  1049   320
M N K =  4096  4096   256, Elapsed time =   0.019883 s, Result = 001e0000, Performance =   4.32 TOPS
M N K =  4096  4096   512, Elapsed time =   0.019914 s, Result = 003c0000, Performance =   8.63 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023195 s, Result = 005a0000, Performance =  11.11 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.022962 s, Result = 00780000, Performance =  14.96 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.024312 s, Result = 00960000, Performance =  17.67 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.026631 s, Result = 00b40000, Performance =  19.35 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.028488 s, Result = 00d20000, Performance =  21.11 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029072 s, Result = 00f00000, Performance =  23.64 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.032222 s, Result = 010e0000, Performance =  23.99 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.041378 s, Result = 012c0000, Performance =  20.76 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.035852 s, Result = 014a0000, Performance =  26.36 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.045520 s, Result = 01680000, Performance =  22.64 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.047186 s, Result = 01860000, Performance =  23.67 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.049173 s, Result = 01a40000, Performance =  24.46 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.045269 s, Result = 01c20000, Performance =  28.46 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.047907 s, Result = 01e00000, Performance =  28.69 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.050082 s, Result = 01fe0000, Performance =  29.16 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.052188 s, Result = 021c0000, Performance =  29.63 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.054153 s, Result = 023a0000, Performance =  30.14 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.055859 s, Result = 02580000, Performance =  30.76 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.058513 s, Result = 02760000, Performance =  30.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.060484 s, Result = 02940000, Performance =  31.24 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.063328 s, Result = 02b20000, Performance =  31.20 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.065719 s, Result = 02d00000, Performance =  31.37 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.068462 s, Result = 02ee0000, Performance =  31.37 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.070701 s, Result = 030c0000, Performance =  31.59 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.072266 s, Result = 032a0000, Performance =  32.09 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.074331 s, Result = 03480000, Performance =  32.36 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.075244 s, Result = 03660000, Performance =  33.11 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.076379 s, Result = 03840000, Performance =  33.74 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.079600 s, Result = 03a20000, Performance =  33.45 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.083654 s, Result = 03c00000, Performance =  32.86 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.077609 s, Result = 03de0000, Performance =  36.53 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.079347 s, Result = 03fc0000, Performance =  36.81 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.080390 s, Result = 041a0000, Performance =  37.40 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.083385 s, Result = 04380000, Performance =  37.09 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.086992 s, Result = 04560000, Performance =  36.54 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.089976 s, Result = 04740000, Performance =  36.28 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.093585 s, Result = 04920000, Performance =  35.80 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.097474 s, Result = 04b00000, Performance =  35.25 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.099240 s, Result = 04ce0000, Performance =  35.49 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.100836 s, Result = 04ec0000, Performance =  35.78 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.104057 s, Result = 050a0000, Performance =  35.50 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.104569 s, Result = 05280000, Performance =  36.14 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.105318 s, Result = 05460000, Performance =  36.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.106421 s, Result = 05640000, Performance =  37.13 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.106826 s, Result = 05820000, Performance =  37.79 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.108686 s, Result = 05a00000, Performance =  37.94 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.106353 s, Result = 05be0000, Performance =  39.58 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.106778 s, Result = 05dc0000, Performance =  40.22 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.106183 s, Result = 05fa0000, Performance =  41.26 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.106564 s, Result = 06180000, Performance =  41.92 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.106650 s, Result = 06360000, Performance =  42.69 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.109925 s, Result = 06540000, Performance =  42.20 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.110315 s, Result = 06720000, Performance =  42.83 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.113512 s, Result = 06900000, Performance =  42.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.113238 s, Result = 06ae0000, Performance =  43.24 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.114765 s, Result = 06cc0000, Performance =  43.41 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.112623 s, Result = 06ea0000, Performance =  45.00 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.113297 s, Result = 07080000, Performance =  45.49 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.114593 s, Result = 07260000, Performance =  45.73 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.117569 s, Result = 07440000, Performance =  45.30 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.115107 s, Result = 07620000, Performance =  47.01 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.148314 s, Result = 07800000, Performance =  37.07 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1398  1591  1536
Test passed: M N K =   836  1931  1600
Test passed: M N K =  1714  1900   512
Test passed: M N K =   204   871  1984
Test passed: M N K =   797   952   512
M N K =  4096  4096   256, Elapsed time =   0.015648 s, Result = a0be0000, Performance =   5.49 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015963 s, Result = a0dc0000, Performance =  10.76 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016989 s, Result = a0fa0000, Performance =  15.17 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017640 s, Result = a1180000, Performance =  19.48 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.018364 s, Result = a1360000, Performance =  23.39 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.019501 s, Result = a1540000, Performance =  26.43 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.020702 s, Result = a1720000, Performance =  29.05 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.022296 s, Result = a1900000, Performance =  30.82 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.022908 s, Result = a1ae0000, Performance =  33.75 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.024326 s, Result = a1cc0000, Performance =  35.31 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.025869 s, Result = a1ea0000, Performance =  36.53 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.027775 s, Result = a2080000, Performance =  37.11 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.030169 s, Result = a2260000, Performance =  37.01 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.031634 s, Result = a2440000, Performance =  38.02 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.034371 s, Result = a2620000, Performance =  37.49 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.036916 s, Result = a2800000, Performance =  37.23 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.038587 s, Result = a29e0000, Performance =  37.84 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.041254 s, Result = a2bc0000, Performance =  37.48 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.043207 s, Result = a2da0000, Performance =  37.77 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.045254 s, Result = a2f80000, Performance =  37.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.047403 s, Result = a3160000, Performance =  38.05 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.049335 s, Result = a3340000, Performance =  38.30 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.052406 s, Result = a3520000, Performance =  37.70 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.054811 s, Result = a3700000, Performance =  37.61 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.057382 s, Result = a38e0000, Performance =  37.42 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.059768 s, Result = a3ac0000, Performance =  37.37 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.061573 s, Result = a3ca0000, Performance =  37.67 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.063428 s, Result = a3e80000, Performance =  37.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.063859 s, Result = a4060000, Performance =  39.01 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.064900 s, Result = a4240000, Performance =  39.71 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.067065 s, Result = a4420000, Performance =  39.71 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.071321 s, Result = a4600000, Performance =  38.54 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.065706 s, Result = a47e0000, Performance =  43.14 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.066829 s, Result = a49c0000, Performance =  43.70 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.069523 s, Result = a4ba0000, Performance =  43.24 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.071578 s, Result = a4d80000, Performance =  43.20 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.074967 s, Result = a4f60000, Performance =  42.40 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.078487 s, Result = a5140000, Performance =  41.59 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.082522 s, Result = a5320000, Performance =  40.60 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.085261 s, Result = a5500000, Performance =  40.30 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.087210 s, Result = a56e0000, Performance =  40.38 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.089246 s, Result = a58c0000, Performance =  40.42 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.092903 s, Result = a5aa0000, Performance =  39.76 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.092937 s, Result = a5c80000, Performance =  40.67 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.093722 s, Result = a5e60000, Performance =  41.24 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.102010 s, Result = a6040000, Performance =  38.74 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.095022 s, Result = a6220000, Performance =  42.49 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.096487 s, Result = a6400000, Performance =  42.73 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.095245 s, Result = a65e0000, Performance =  44.19 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.097122 s, Result = a67c0000, Performance =  44.22 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.095797 s, Result = a69a0000, Performance =  45.73 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.096924 s, Result = a6b80000, Performance =  46.09 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.098448 s, Result = a6d60000, Performance =  46.24 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.099373 s, Result = a6f40000, Performance =  46.68 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.099273 s, Result = a7120000, Performance =  47.59 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.100056 s, Result = a7300000, Performance =  48.08 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.100905 s, Result = a74e0000, Performance =  48.52 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.102861 s, Result = a76c0000, Performance =  48.44 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.101129 s, Result = a78a0000, Performance =  50.11 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.100906 s, Result = a7a80000, Performance =  51.08 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.102693 s, Result = a7c60000, Performance =  51.02 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.107357 s, Result = a7e40000, Performance =  49.61 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.103501 s, Result = a8020000, Performance =  52.29 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.135649 s, Result = a8200000, Performance =  40.53 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   624   837  1600
Test passed: M N K =   206   219  2048
Test passed: M N K =   982  1528  1792
Test passed: M N K =    94   752   128
Test passed: M N K =   278   110  1920
M N K =  4096  4096   256, Elapsed time =   0.001213 s, Result = 001e0000, Performance =  70.79 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002533 s, Result = 003c0000, Performance =  67.82 TOPS
M N K =  4096  4096   768, Elapsed time =   0.011057 s, Result = 005a0000, Performance =  23.31 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004525 s, Result = 00780000, Performance =  75.93 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003652 s, Result = 00960000, Performance = 117.59 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003833 s, Result = 00b40000, Performance = 134.45 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.012161 s, Result = 00d20000, Performance =  49.45 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005794 s, Result = 00f00000, Performance = 118.60 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.008278 s, Result = 010e0000, Performance =  93.40 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007624 s, Result = 012c0000, Performance = 112.67 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009549 s, Result = 014a0000, Performance =  98.95 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011458 s, Result = 01680000, Performance =  89.96 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.014096 s, Result = 01860000, Performance =  79.22 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016300 s, Result = 01a40000, Performance =  73.78 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.018751 s, Result = 01c20000, Performance =  68.71 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.028295 s, Result = 01e00000, Performance =  48.57 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.030290 s, Result = 01fe0000, Performance =  48.21 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024152 s, Result = 021c0000, Performance =  64.02 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.027460 s, Result = 023a0000, Performance =  59.43 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.029715 s, Result = 02580000, Performance =  57.81 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.033108 s, Result = 02760000, Performance =  54.49 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.036663 s, Result = 02940000, Performance =  51.55 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.041755 s, Result = 02b20000, Performance =  47.32 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.043727 s, Result = 02d00000, Performance =  47.15 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.046620 s, Result = 02ee0000, Performance =  46.06 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.048760 s, Result = 030c0000, Performance =  45.80 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.051001 s, Result = 032a0000, Performance =  45.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.052554 s, Result = 03480000, Performance =  45.77 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.053671 s, Result = 03660000, Performance =  46.41 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.055205 s, Result = 03840000, Performance =  46.68 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.058028 s, Result = 03a20000, Performance =  45.89 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.061296 s, Result = 03c00000, Performance =  44.84 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.055522 s, Result = 03de0000, Performance =  51.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.056457 s, Result = 03fc0000, Performance =  51.73 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.058694 s, Result = 041a0000, Performance =  51.22 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.061414 s, Result = 04380000, Performance =  50.35 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.064580 s, Result = 04560000, Performance =  49.21 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.067957 s, Result = 04740000, Performance =  48.03 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.073343 s, Result = 04920000, Performance =  45.68 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.074668 s, Result = 04b00000, Performance =  46.02 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.077026 s, Result = 04ce0000, Performance =  45.72 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.078847 s, Result = 04ec0000, Performance =  45.76 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.083457 s, Result = 050a0000, Performance =  44.26 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.082335 s, Result = 05280000, Performance =  45.90 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.083892 s, Result = 05460000, Performance =  46.08 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.084730 s, Result = 05640000, Performance =  46.63 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.085416 s, Result = 05820000, Performance =  47.27 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.086666 s, Result = 05a00000, Performance =  47.58 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.085678 s, Result = 05be0000, Performance =  49.13 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.085303 s, Result = 05dc0000, Performance =  50.35 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.087335 s, Result = 05fa0000, Performance =  50.16 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.084896 s, Result = 06180000, Performance =  52.61 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.086912 s, Result = 06360000, Performance =  52.38 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.089018 s, Result = 06540000, Performance =  52.11 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.090360 s, Result = 06720000, Performance =  52.28 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.090618 s, Result = 06900000, Performance =  53.08 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.091245 s, Result = 06ae0000, Performance =  53.66 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.092090 s, Result = 06cc0000, Performance =  54.10 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.090898 s, Result = 06ea0000, Performance =  55.76 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.091268 s, Result = 07080000, Performance =  56.47 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.092116 s, Result = 07260000, Performance =  56.88 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.097594 s, Result = 07440000, Performance =  54.57 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.093918 s, Result = 07620000, Performance =  57.62 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.126821 s, Result = 07800000, Performance =  43.35 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   487  1491   576
Test passed: M N K =    82  1246   320
Test passed: M N K =  1948  1659  1024
Test passed: M N K =  1269  1805  1664
Test passed: M N K =  1898   429  1344
M N K =  4096  4096   256, Elapsed time =   0.029720 s, Result = 902e0000, Performance =   2.89 TOPS
M N K =  4096  4096   512, Elapsed time =   0.034525 s, Result = 104c0000, Performance =   4.98 TOPS
M N K =  4096  4096   768, Elapsed time =   0.037889 s, Result = 906a0000, Performance =   6.80 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.037708 s, Result = 10880000, Performance =   9.11 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038916 s, Result = 90a60000, Performance =  11.04 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040548 s, Result = 10c40000, Performance =  12.71 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.042117 s, Result = 90e20000, Performance =  14.28 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.043611 s, Result = 11000000, Performance =  15.76 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.045668 s, Result = 911e0000, Performance =  16.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.046732 s, Result = 113c0000, Performance =  18.38 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.049480 s, Result = 915a0000, Performance =  19.10 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.051294 s, Result = 11780000, Performance =  20.10 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.053618 s, Result = 91960000, Performance =  20.83 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.056396 s, Result = 11b40000, Performance =  21.32 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.057553 s, Result = 91d20000, Performance =  22.39 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.058575 s, Result = 11f00000, Performance =  23.46 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.060297 s, Result = 920e0000, Performance =  24.22 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.060621 s, Result = 122c0000, Performance =  25.51 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.061961 s, Result = 924a0000, Performance =  26.34 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.064261 s, Result = 12680000, Performance =  26.73 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.065276 s, Result = 92860000, Performance =  27.63 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.066630 s, Result = 12a40000, Performance =  28.36 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.068120 s, Result = 92c20000, Performance =  29.00 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.069891 s, Result = 12e00000, Performance =  29.50 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.071390 s, Result = 92fe0000, Performance =  30.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.072464 s, Result = 131c0000, Performance =  30.82 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.073666 s, Result = 933a0000, Performance =  31.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.076054 s, Result = 13580000, Performance =  31.62 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.076199 s, Result = 93760000, Performance =  32.69 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.077803 s, Result = 13940000, Performance =  33.12 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.078869 s, Result = 93b20000, Performance =  33.76 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.089982 s, Result = 13d00000, Performance =  30.55 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.080386 s, Result = 93ee0000, Performance =  35.26 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.078200 s, Result = 140c0000, Performance =  37.35 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.079730 s, Result = 942a0000, Performance =  37.71 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.082109 s, Result = 14480000, Performance =  37.66 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.084864 s, Result = 94660000, Performance =  37.45 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.088116 s, Result = 14840000, Performance =  37.04 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.090056 s, Result = 94a20000, Performance =  37.20 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.092467 s, Result = 14c00000, Performance =  37.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.093987 s, Result = 94de0000, Performance =  37.47 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.094580 s, Result = 14fc0000, Performance =  38.15 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.098482 s, Result = 951a0000, Performance =  37.51 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.096460 s, Result = 15380000, Performance =  39.18 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.098686 s, Result = 95560000, Performance =  39.17 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.099505 s, Result = 15740000, Performance =  39.71 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.100650 s, Result = 95920000, Performance =  40.11 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.099975 s, Result = 15b00000, Performance =  41.24 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.101666 s, Result = 95ce0000, Performance =  41.40 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.103070 s, Result = 15ec0000, Performance =  41.67 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.103770 s, Result = 960a0000, Performance =  42.22 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.102401 s, Result = 16280000, Performance =  43.62 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.102930 s, Result = 96460000, Performance =  44.23 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.105301 s, Result = 16640000, Performance =  44.05 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.106384 s, Result = 96820000, Performance =  44.41 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.106552 s, Result = 16a00000, Performance =  45.15 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.108281 s, Result = 96be0000, Performance =  45.22 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.109795 s, Result = 16dc0000, Performance =  45.38 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.111357 s, Result = 96fa0000, Performance =  45.51 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.109639 s, Result = 17180000, Performance =  47.01 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.113003 s, Result = 97360000, Performance =  46.37 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.112221 s, Result = 17540000, Performance =  47.46 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.114219 s, Result = 97720000, Performance =  47.38 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.149028 s, Result = 17900000, Performance =  36.89 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2043  1325  1088
Test passed: M N K =  1542   992  1728
Test passed: M N K =  1666   734   640
Test passed: M N K =  1481   176  1088
Test passed: M N K =   728  1807  1024
M N K =  4096  4096   256, Elapsed time =   0.020350 s, Result = 001e0000, Performance =   4.22 TOPS
M N K =  4096  4096   512, Elapsed time =   0.019715 s, Result = 003c0000, Performance =   8.71 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023221 s, Result = 005a0000, Performance =  11.10 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.022864 s, Result = 00780000, Performance =  15.03 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.023873 s, Result = 00960000, Performance =  17.99 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.025205 s, Result = 00b40000, Performance =  20.45 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.027189 s, Result = 00d20000, Performance =  22.12 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.028059 s, Result = 00f00000, Performance =  24.49 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.029916 s, Result = 010e0000, Performance =  25.84 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031072 s, Result = 012c0000, Performance =  27.65 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.033033 s, Result = 014a0000, Performance =  28.60 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.034810 s, Result = 01680000, Performance =  29.61 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.037122 s, Result = 01860000, Performance =  30.08 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.038463 s, Result = 01a40000, Performance =  31.27 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.040525 s, Result = 01c20000, Performance =  31.80 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.043058 s, Result = 01e00000, Performance =  31.92 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.047398 s, Result = 01fe0000, Performance =  30.81 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.049591 s, Result = 021c0000, Performance =  31.18 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.052275 s, Result = 023a0000, Performance =  31.22 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.053559 s, Result = 02580000, Performance =  32.08 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.055146 s, Result = 02760000, Performance =  32.71 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.057694 s, Result = 02940000, Performance =  32.76 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.058890 s, Result = 02b20000, Performance =  33.55 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.060711 s, Result = 02d00000, Performance =  33.96 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.061483 s, Result = 02ee0000, Performance =  34.93 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.063362 s, Result = 030c0000, Performance =  35.25 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.064211 s, Result = 032a0000, Performance =  36.12 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.065856 s, Result = 03480000, Performance =  36.52 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.067078 s, Result = 03660000, Performance =  37.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.068154 s, Result = 03840000, Performance =  37.81 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.070330 s, Result = 03a20000, Performance =  37.86 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.081164 s, Result = 03c00000, Performance =  33.87 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.072307 s, Result = 03de0000, Performance =  39.20 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.070038 s, Result = 03fc0000, Performance =  41.70 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.073068 s, Result = 041a0000, Performance =  41.15 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.073813 s, Result = 04380000, Performance =  41.89 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.077374 s, Result = 04560000, Performance =  41.08 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.078635 s, Result = 04740000, Performance =  41.51 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.080589 s, Result = 04920000, Performance =  41.57 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.082105 s, Result = 04b00000, Performance =  41.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.084392 s, Result = 04ce0000, Performance =  41.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.085854 s, Result = 04ec0000, Performance =  42.02 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.088763 s, Result = 050a0000, Performance =  41.61 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.087246 s, Result = 05280000, Performance =  43.32 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.089221 s, Result = 05460000, Performance =  43.32 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.090675 s, Result = 05640000, Performance =  43.58 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.091884 s, Result = 05820000, Performance =  43.94 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.092616 s, Result = 05a00000, Performance =  44.52 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.093854 s, Result = 05be0000, Performance =  44.85 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.095955 s, Result = 05dc0000, Performance =  44.76 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.096797 s, Result = 05fa0000, Performance =  45.26 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.095563 s, Result = 06180000, Performance =  46.74 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.097278 s, Result = 06360000, Performance =  46.80 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.098726 s, Result = 06540000, Performance =  46.98 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.098868 s, Result = 06720000, Performance =  47.79 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.098335 s, Result = 06900000, Performance =  48.92 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.099497 s, Result = 06ae0000, Performance =  49.21 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.101216 s, Result = 06cc0000, Performance =  49.22 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.102757 s, Result = 06ea0000, Performance =  49.32 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.101602 s, Result = 07080000, Performance =  50.73 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.102167 s, Result = 07260000, Performance =  51.29 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.103633 s, Result = 07440000, Performance =  51.39 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.106422 s, Result = 07620000, Performance =  50.85 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.139170 s, Result = 07800000, Performance =  39.50 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1815  1764   256
Test passed: M N K =  1271   138  1536
Test passed: M N K =   241  1773  1280
Test passed: M N K =   527  1055  1472
Test passed: M N K =  1965  1008  1600
M N K =  4096  4096   256, Elapsed time =   0.016091 s, Result = a0be0000, Performance =   5.34 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015426 s, Result = a0dc0000, Performance =  11.14 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016871 s, Result = a0fa0000, Performance =  15.27 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017727 s, Result = a1180000, Performance =  19.38 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.018182 s, Result = a1360000, Performance =  23.62 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.020053 s, Result = a1540000, Performance =  25.70 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.019963 s, Result = a1720000, Performance =  30.12 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.021430 s, Result = a1900000, Performance =  32.07 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.022805 s, Result = a1ae0000, Performance =  33.90 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.023619 s, Result = a1cc0000, Performance =  36.37 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.024918 s, Result = a1ea0000, Performance =  37.92 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.026165 s, Result = a2080000, Performance =  39.40 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.028215 s, Result = a2260000, Performance =  39.58 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.029508 s, Result = a2440000, Performance =  40.76 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.032436 s, Result = a2620000, Performance =  39.72 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.034203 s, Result = a2800000, Performance =  40.18 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.036780 s, Result = a29e0000, Performance =  39.70 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.038171 s, Result = a2bc0000, Performance =  40.51 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.040489 s, Result = a2da0000, Performance =  40.31 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.042504 s, Result = a2f80000, Performance =  40.42 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.046031 s, Result = a3160000, Performance =  39.19 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.047695 s, Result = a3340000, Performance =  39.62 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.050478 s, Result = a3520000, Performance =  39.14 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.051526 s, Result = a3700000, Performance =  40.01 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.053746 s, Result = a38e0000, Performance =  39.96 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.054239 s, Result = a3ac0000, Performance =  41.18 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.062625 s, Result = a3ca0000, Performance =  37.03 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.058078 s, Result = a3e80000, Performance =  41.41 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.059161 s, Result = a4060000, Performance =  42.11 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.059525 s, Result = a4240000, Performance =  43.29 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.061217 s, Result = a4420000, Performance =  43.50 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.072887 s, Result = a4600000, Performance =  37.71 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.062933 s, Result = a47e0000, Performance =  45.04 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.061206 s, Result = a49c0000, Performance =  47.72 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.064019 s, Result = a4ba0000, Performance =  46.96 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.064196 s, Result = a4d80000, Performance =  48.17 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.066957 s, Result = a4f60000, Performance =  47.47 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.068833 s, Result = a5140000, Performance =  47.42 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.071268 s, Result = a5320000, Performance =  47.01 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.072644 s, Result = a5500000, Performance =  47.30 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.075844 s, Result = a56e0000, Performance =  46.44 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.078669 s, Result = a58c0000, Performance =  45.86 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.081908 s, Result = a5aa0000, Performance =  45.10 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.080281 s, Result = a5c80000, Performance =  47.08 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.082054 s, Result = a5e60000, Performance =  47.11 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.082276 s, Result = a6040000, Performance =  48.03 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.083509 s, Result = a6220000, Performance =  48.35 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.083907 s, Result = a6400000, Performance =  49.14 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.084540 s, Result = a65e0000, Performance =  49.79 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.085758 s, Result = a67c0000, Performance =  50.08 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.087775 s, Result = a69a0000, Performance =  49.91 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.086294 s, Result = a6b80000, Performance =  51.76 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.086914 s, Result = a6d60000, Performance =  52.38 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.088909 s, Result = a6f40000, Performance =  52.17 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.089936 s, Result = a7120000, Performance =  52.53 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.089383 s, Result = a7300000, Performance =  53.82 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.092354 s, Result = a74e0000, Performance =  53.02 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.092774 s, Result = a76c0000, Performance =  53.70 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.093967 s, Result = a78a0000, Performance =  53.93 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.092363 s, Result = a7a80000, Performance =  55.80 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.096777 s, Result = a7c60000, Performance =  54.14 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.095661 s, Result = a7e40000, Performance =  55.67 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.099050 s, Result = a8020000, Performance =  54.64 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.132150 s, Result = a8200000, Performance =  41.60 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1242   576   448
Test passed: M N K =   837   808   192
Test passed: M N K =   905  1033  2048
Test passed: M N K =  2016  1010  1920
Test passed: M N K =  1974   323   256
M N K =  4096  4096   256, Elapsed time =   0.001232 s, Result = 001e0000, Performance =  69.73 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002343 s, Result = 003c0000, Performance =  73.32 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003888 s, Result = 005a0000, Performance =  66.28 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003032 s, Result = 00780000, Performance = 113.31 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.006337 s, Result = 00960000, Performance =  67.77 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004065 s, Result = 00b40000, Performance = 126.79 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.006246 s, Result = 00d20000, Performance =  96.27 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.013114 s, Result = 00f00000, Performance =  52.40 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006516 s, Result = 010e0000, Performance = 118.65 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.016605 s, Result = 012c0000, Performance =  51.73 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.007770 s, Result = 014a0000, Performance = 121.61 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010103 s, Result = 01680000, Performance = 102.03 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011023 s, Result = 01860000, Performance = 101.30 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.012456 s, Result = 01a40000, Performance =  96.55 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015193 s, Result = 01c20000, Performance =  84.81 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017340 s, Result = 01e00000, Performance =  79.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020035 s, Result = 01fe0000, Performance =  72.89 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.022260 s, Result = 021c0000, Performance =  69.46 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025007 s, Result = 023a0000, Performance =  65.26 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.027195 s, Result = 02580000, Performance =  63.17 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.028992 s, Result = 02760000, Performance =  62.22 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.031376 s, Result = 02940000, Performance =  60.23 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.037254 s, Result = 02b20000, Performance =  53.03 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.039926 s, Result = 02d00000, Performance =  51.64 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.041185 s, Result = 02ee0000, Performance =  52.14 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.042779 s, Result = 030c0000, Performance =  52.21 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.043861 s, Result = 032a0000, Performance =  52.88 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.045448 s, Result = 03480000, Performance =  52.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.047145 s, Result = 03660000, Performance =  52.84 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.048556 s, Result = 03840000, Performance =  53.07 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.050190 s, Result = 03a20000, Performance =  53.06 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.060694 s, Result = 03c00000, Performance =  45.29 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.051527 s, Result = 03de0000, Performance =  55.01 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.048953 s, Result = 03fc0000, Performance =  59.66 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.050703 s, Result = 041a0000, Performance =  59.30 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.051845 s, Result = 04380000, Performance =  59.65 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.054632 s, Result = 04560000, Performance =  58.18 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.056530 s, Result = 04740000, Performance =  57.74 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.059504 s, Result = 04920000, Performance =  56.30 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.062180 s, Result = 04b00000, Performance =  55.26 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.064429 s, Result = 04ce0000, Performance =  54.66 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.066012 s, Result = 04ec0000, Performance =  54.65 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.069884 s, Result = 050a0000, Performance =  52.85 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.068505 s, Result = 05280000, Performance =  55.17 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.070324 s, Result = 05460000, Performance =  54.97 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.070048 s, Result = 05640000, Performance =  56.41 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.071349 s, Result = 05820000, Performance =  56.58 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.071846 s, Result = 05a00000, Performance =  57.39 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.072758 s, Result = 05be0000, Performance =  57.85 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.074417 s, Result = 05dc0000, Performance =  57.72 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.075453 s, Result = 05fa0000, Performance =  58.06 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.074481 s, Result = 06180000, Performance =  59.97 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.075991 s, Result = 06360000, Performance =  59.91 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.093192 s, Result = 06540000, Performance =  49.77 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.078258 s, Result = 06720000, Performance =  60.37 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.078824 s, Result = 06900000, Performance =  61.03 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.080623 s, Result = 06ae0000, Performance =  60.73 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.081055 s, Result = 06cc0000, Performance =  61.47 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.082185 s, Result = 06ea0000, Performance =  61.67 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.080671 s, Result = 07080000, Performance =  63.89 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.084579 s, Result = 07260000, Performance =  61.95 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.084613 s, Result = 07440000, Performance =  62.94 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.086996 s, Result = 07620000, Performance =  62.21 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.120786 s, Result = 07800000, Performance =  45.51 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1967   953  1472
Test passed: M N K =   791  1416  1216
Test passed: M N K =   870  1527  1728
Test passed: M N K =   729  1583    64
Test passed: M N K =   872  1328   576
M N K =  4096  4096   256, Elapsed time =   0.030011 s, Result = 902e0000, Performance =   2.86 TOPS
M N K =  4096  4096   512, Elapsed time =   0.034603 s, Result = 104c0000, Performance =   4.96 TOPS
M N K =  4096  4096   768, Elapsed time =   0.036899 s, Result = 906a0000, Performance =   6.98 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.036898 s, Result = 10880000, Performance =   9.31 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.040772 s, Result = 90a60000, Performance =  10.53 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040053 s, Result = 10c40000, Performance =  12.87 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.041831 s, Result = 90e20000, Performance =  14.37 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.043389 s, Result = 11000000, Performance =  15.84 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.044986 s, Result = 911e0000, Performance =  17.19 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.046439 s, Result = 113c0000, Performance =  18.50 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.049171 s, Result = 915a0000, Performance =  19.22 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.050444 s, Result = 11780000, Performance =  20.43 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.051719 s, Result = 91960000, Performance =  21.59 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.053675 s, Result = 11b40000, Performance =  22.41 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.057668 s, Result = 91d20000, Performance =  22.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.058728 s, Result = 11f00000, Performance =  23.40 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.059757 s, Result = 920e0000, Performance =  24.44 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.061924 s, Result = 122c0000, Performance =  24.97 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.063245 s, Result = 924a0000, Performance =  25.81 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.062265 s, Result = 12680000, Performance =  27.59 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.064686 s, Result = 92860000, Performance =  27.89 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.065700 s, Result = 12a40000, Performance =  28.76 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.067473 s, Result = 92c20000, Performance =  29.28 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.069439 s, Result = 12e00000, Performance =  29.69 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069654 s, Result = 92fe0000, Performance =  30.83 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.071117 s, Result = 131c0000, Performance =  31.40 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.072501 s, Result = 933a0000, Performance =  31.99 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.074003 s, Result = 13580000, Performance =  32.50 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.074484 s, Result = 93760000, Performance =  33.44 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.075903 s, Result = 13940000, Performance =  33.95 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.077002 s, Result = 93b20000, Performance =  34.58 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.085167 s, Result = 13d00000, Performance =  32.27 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.079138 s, Result = 93ee0000, Performance =  35.82 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.080986 s, Result = 140c0000, Performance =  36.06 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.082718 s, Result = 942a0000, Performance =  36.35 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.081810 s, Result = 14480000, Performance =  37.80 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.083745 s, Result = 94660000, Performance =  37.95 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.084537 s, Result = 14840000, Performance =  38.61 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.086482 s, Result = 94a20000, Performance =  38.74 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.087877 s, Result = 14c00000, Performance =  39.10 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.088210 s, Result = 94de0000, Performance =  39.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.089852 s, Result = 14fc0000, Performance =  40.15 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.094432 s, Result = 951a0000, Performance =  39.11 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.091580 s, Result = 15380000, Performance =  41.27 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.093306 s, Result = 95560000, Performance =  41.43 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.094949 s, Result = 15740000, Performance =  41.62 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.096914 s, Result = 95920000, Performance =  41.66 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.097474 s, Result = 15b00000, Performance =  42.30 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.098144 s, Result = 95ce0000, Performance =  42.89 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.100023 s, Result = 15ec0000, Performance =  42.94 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.103632 s, Result = 960a0000, Performance =  42.27 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.100927 s, Result = 16280000, Performance =  44.26 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.102252 s, Result = 96460000, Performance =  44.52 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.103478 s, Result = 16640000, Performance =  44.83 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.104672 s, Result = 96820000, Performance =  45.14 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.105856 s, Result = 16a00000, Performance =  45.44 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.108452 s, Result = 96be0000, Performance =  45.15 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.110401 s, Result = 16dc0000, Performance =  45.13 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.111334 s, Result = 96fa0000, Performance =  45.52 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.108718 s, Result = 17180000, Performance =  47.41 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.113403 s, Result = 97360000, Performance =  46.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.113104 s, Result = 17540000, Performance =  47.09 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.118883 s, Result = 97720000, Performance =  45.52 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.149807 s, Result = 17900000, Performance =  36.70 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1751   172   768
Test passed: M N K =  1830  1671  1792
Test passed: M N K =   102   389   320
Test passed: M N K =  1417  1579   128
Test passed: M N K =  1521  1851   128
M N K =  4096  4096   256, Elapsed time =   0.019745 s, Result = 001e0000, Performance =   4.35 TOPS
M N K =  4096  4096   512, Elapsed time =   0.019901 s, Result = 003c0000, Performance =   8.63 TOPS
M N K =  4096  4096   768, Elapsed time =   0.022768 s, Result = 005a0000, Performance =  11.32 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.023835 s, Result = 00780000, Performance =  14.42 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.023573 s, Result = 00960000, Performance =  18.22 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.025101 s, Result = 00b40000, Performance =  20.53 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.026170 s, Result = 00d20000, Performance =  22.98 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.027323 s, Result = 00f00000, Performance =  25.15 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.029233 s, Result = 010e0000, Performance =  26.45 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031108 s, Result = 012c0000, Performance =  27.61 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.032493 s, Result = 014a0000, Performance =  29.08 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.034223 s, Result = 01680000, Performance =  30.12 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.035440 s, Result = 01860000, Performance =  31.51 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.038375 s, Result = 01a40000, Performance =  31.34 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.039348 s, Result = 01c20000, Performance =  32.75 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.041384 s, Result = 01e00000, Performance =  33.21 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.044178 s, Result = 01fe0000, Performance =  33.05 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.047001 s, Result = 021c0000, Performance =  32.90 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.048891 s, Result = 023a0000, Performance =  33.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.054756 s, Result = 02580000, Performance =  31.38 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.057548 s, Result = 02760000, Performance =  31.35 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.060688 s, Result = 02940000, Performance =  31.14 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.062740 s, Result = 02b20000, Performance =  31.49 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.059197 s, Result = 02d00000, Performance =  34.83 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.059625 s, Result = 02ee0000, Performance =  36.02 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.061090 s, Result = 030c0000, Performance =  36.56 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.062629 s, Result = 032a0000, Performance =  37.03 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.063417 s, Result = 03480000, Performance =  37.93 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.063975 s, Result = 03660000, Performance =  38.94 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.065462 s, Result = 03840000, Performance =  39.37 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.066541 s, Result = 03a20000, Performance =  40.02 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.074826 s, Result = 03c00000, Performance =  36.74 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.068842 s, Result = 03de0000, Performance =  41.18 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.071204 s, Result = 03fc0000, Performance =  41.02 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.071615 s, Result = 041a0000, Performance =  41.98 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.070719 s, Result = 04380000, Performance =  43.73 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.075239 s, Result = 04560000, Performance =  42.24 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.076200 s, Result = 04740000, Performance =  42.84 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.078057 s, Result = 04920000, Performance =  42.92 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.078751 s, Result = 04b00000, Performance =  43.63 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.079502 s, Result = 04ce0000, Performance =  44.30 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.081644 s, Result = 04ec0000, Performance =  44.19 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.085069 s, Result = 050a0000, Performance =  43.42 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.081955 s, Result = 05280000, Performance =  46.12 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.083372 s, Result = 05460000, Performance =  46.36 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.085998 s, Result = 05640000, Performance =  45.95 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.086475 s, Result = 05820000, Performance =  46.69 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.087472 s, Result = 05a00000, Performance =  47.14 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.087857 s, Result = 05be0000, Performance =  47.91 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.089140 s, Result = 05dc0000, Performance =  48.18 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.092808 s, Result = 05fa0000, Performance =  47.20 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.090870 s, Result = 06180000, Performance =  49.16 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.094420 s, Result = 06360000, Performance =  48.22 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.095465 s, Result = 06540000, Performance =  48.59 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.096127 s, Result = 06720000, Performance =  49.15 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.096178 s, Result = 06900000, Performance =  50.02 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.098483 s, Result = 06ae0000, Performance =  49.72 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.099404 s, Result = 06cc0000, Performance =  50.12 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.099866 s, Result = 06ea0000, Performance =  50.75 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.099250 s, Result = 07080000, Performance =  51.93 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.102370 s, Result = 07260000, Performance =  51.19 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.103765 s, Result = 07440000, Performance =  51.33 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.101428 s, Result = 07620000, Performance =  53.35 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.137837 s, Result = 07800000, Performance =  39.88 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   913   855   576
Test passed: M N K =  1302  1453   640
Test passed: M N K =   644  1982  1088
Test passed: M N K =  1853   703   832
Test passed: M N K =  1474   740  1984
M N K =  4096  4096   256, Elapsed time =   0.016621 s, Result = a0be0000, Performance =   5.17 TOPS
M N K =  4096  4096   512, Elapsed time =   0.015691 s, Result = a0dc0000, Performance =  10.95 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016711 s, Result = a0fa0000, Performance =  15.42 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017554 s, Result = a1180000, Performance =  19.57 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.018229 s, Result = a1360000, Performance =  23.56 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.019403 s, Result = a1540000, Performance =  26.56 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.020535 s, Result = a1720000, Performance =  29.28 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.021308 s, Result = a1900000, Performance =  32.25 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.022645 s, Result = a1ae0000, Performance =  34.14 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.023622 s, Result = a1cc0000, Performance =  36.36 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.024901 s, Result = a1ea0000, Performance =  37.95 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.026104 s, Result = a2080000, Performance =  39.49 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.027440 s, Result = a2260000, Performance =  40.70 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.029161 s, Result = a2440000, Performance =  41.24 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.031483 s, Result = a2620000, Performance =  40.93 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.033043 s, Result = a2800000, Performance =  41.59 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.035604 s, Result = a29e0000, Performance =  41.01 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.038549 s, Result = a2bc0000, Performance =  40.11 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.042581 s, Result = a2da0000, Performance =  38.33 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043602 s, Result = a2f80000, Performance =  39.40 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.046075 s, Result = a3160000, Performance =  39.15 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.047991 s, Result = a3340000, Performance =  39.38 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.049591 s, Result = a3520000, Performance =  39.84 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.052167 s, Result = a3700000, Performance =  39.52 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.052175 s, Result = a38e0000, Performance =  41.16 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.053779 s, Result = a3ac0000, Performance =  41.53 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.055072 s, Result = a3ca0000, Performance =  42.11 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.055952 s, Result = a3e80000, Performance =  42.99 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.056998 s, Result = a4060000, Performance =  43.71 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.057976 s, Result = a4240000, Performance =  44.45 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.059267 s, Result = a4420000, Performance =  44.93 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.067669 s, Result = a4600000, Performance =  40.62 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.061892 s, Result = a47e0000, Performance =  45.80 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.063774 s, Result = a49c0000, Performance =  45.80 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.063823 s, Result = a4ba0000, Performance =  47.11 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.062558 s, Result = a4d80000, Performance =  49.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.064781 s, Result = a4f60000, Performance =  49.06 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.065559 s, Result = a5140000, Performance =  49.79 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.067866 s, Result = a5320000, Performance =  49.36 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.069030 s, Result = a5500000, Performance =  49.77 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.070446 s, Result = a56e0000, Performance =  49.99 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.073011 s, Result = a58c0000, Performance =  49.41 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.075961 s, Result = a5aa0000, Performance =  48.63 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.074017 s, Result = a5c80000, Performance =  51.06 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.076882 s, Result = a5e60000, Performance =  50.28 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.077131 s, Result = a6040000, Performance =  51.23 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.078400 s, Result = a6220000, Performance =  51.50 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.079598 s, Result = a6400000, Performance =  51.80 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.079460 s, Result = a65e0000, Performance =  52.97 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.081192 s, Result = a67c0000, Performance =  52.90 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.084615 s, Result = a69a0000, Performance =  51.77 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.083050 s, Result = a6b80000, Performance =  53.78 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.085974 s, Result = a6d60000, Performance =  52.95 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.086608 s, Result = a6f40000, Performance =  53.56 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.088907 s, Result = a7120000, Performance =  53.14 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.088975 s, Result = a7300000, Performance =  54.06 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.092046 s, Result = a74e0000, Performance =  53.19 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.092815 s, Result = a76c0000, Performance =  53.68 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.092424 s, Result = a78a0000, Performance =  54.84 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.090922 s, Result = a7a80000, Performance =  56.69 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.096532 s, Result = a7c60000, Performance =  54.28 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.095527 s, Result = a7e40000, Performance =  55.75 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.093770 s, Result = a8020000, Performance =  57.71 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.127644 s, Result = a8200000, Performance =  43.07 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=512 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 512 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1736   144   960
Test passed: M N K =  1675  1243  2048
Test passed: M N K =    18  1822   256
Test passed: M N K =   436  1266  1728
Test passed: M N K =   828  1035  1024
M N K =  4096  4096   256, Elapsed time =   0.001199 s, Result = 001e0000, Performance =  71.63 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002395 s, Result = 003c0000, Performance =  71.73 TOPS
M N K =  4096  4096   768, Elapsed time =   0.010624 s, Result = 005a0000, Performance =  24.26 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004291 s, Result = 00780000, Performance =  80.07 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005454 s, Result = 00960000, Performance =  78.75 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003759 s, Result = 00b40000, Performance = 137.11 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.013494 s, Result = 00d20000, Performance =  44.56 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005319 s, Result = 00f00000, Performance = 129.19 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.014311 s, Result = 010e0000, Performance =  54.02 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006939 s, Result = 012c0000, Performance = 123.78 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008923 s, Result = 014a0000, Performance = 105.89 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008861 s, Result = 01680000, Performance = 116.33 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.010406 s, Result = 01860000, Performance = 107.31 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.011904 s, Result = 01a40000, Performance = 101.02 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.015925 s, Result = 01c20000, Performance =  80.91 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.017628 s, Result = 01e00000, Performance =  77.97 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.020299 s, Result = 01fe0000, Performance =  71.94 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.023032 s, Result = 021c0000, Performance =  67.13 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.024796 s, Result = 023a0000, Performance =  65.82 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.028120 s, Result = 02580000, Performance =  61.10 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.033909 s, Result = 02760000, Performance =  53.20 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.035913 s, Result = 02940000, Performance =  52.62 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.037574 s, Result = 02b20000, Performance =  52.58 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.040311 s, Result = 02d00000, Performance =  51.14 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.041133 s, Result = 02ee0000, Performance =  52.21 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.041079 s, Result = 030c0000, Performance =  54.37 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.042818 s, Result = 032a0000, Performance =  54.17 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.043629 s, Result = 03480000, Performance =  55.13 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.044581 s, Result = 03660000, Performance =  55.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.046337 s, Result = 03840000, Performance =  55.61 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.047701 s, Result = 03a20000, Performance =  55.82 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.055385 s, Result = 03c00000, Performance =  49.63 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.049554 s, Result = 03de0000, Performance =  57.20 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.051405 s, Result = 03fc0000, Performance =  56.82 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.051628 s, Result = 041a0000, Performance =  58.23 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.050400 s, Result = 04380000, Performance =  61.36 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.052236 s, Result = 04560000, Performance =  60.84 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.053627 s, Result = 04740000, Performance =  60.87 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.055375 s, Result = 04920000, Performance =  60.50 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.056070 s, Result = 04b00000, Performance =  61.28 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.058091 s, Result = 04ce0000, Performance =  60.63 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.060486 s, Result = 04ec0000, Performance =  59.65 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.064164 s, Result = 050a0000, Performance =  57.57 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.077261 s, Result = 05280000, Performance =  48.92 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.063100 s, Result = 05460000, Performance =  61.26 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.064952 s, Result = 05640000, Performance =  60.83 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.065461 s, Result = 05820000, Performance =  61.67 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.066786 s, Result = 05a00000, Performance =  61.74 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.067216 s, Result = 05be0000, Performance =  62.62 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.068922 s, Result = 05dc0000, Performance =  62.32 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.072739 s, Result = 05fa0000, Performance =  60.23 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.070118 s, Result = 06180000, Performance =  63.70 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.073207 s, Result = 06360000, Performance =  62.19 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.074861 s, Result = 06540000, Performance =  61.96 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.076451 s, Result = 06720000, Performance =  61.80 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.077002 s, Result = 06900000, Performance =  62.47 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.079433 s, Result = 06ae0000, Performance =  61.64 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.080663 s, Result = 06cc0000, Performance =  61.77 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.079671 s, Result = 06ea0000, Performance =  63.61 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.078020 s, Result = 07080000, Performance =  66.06 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.082747 s, Result = 07260000, Performance =  63.32 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.083793 s, Result = 07440000, Performance =  63.56 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.082171 s, Result = 07620000, Performance =  65.86 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.124606 s, Result = 07800000, Performance =  44.12 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1566  1575   512
Test passed: M N K =  1486  1056   832
Test passed: M N K =    20  1563  1280
Test passed: M N K =   787  1623   832
Test passed: M N K =   413  1391  1728
M N K =  4096  4096   256, Elapsed time =   0.050118 s, Result = 50420000, Performance =   1.71 TOPS
M N K =  4096  4096   512, Elapsed time =   0.058133 s, Result = 90740000, Performance =   2.96 TOPS
M N K =  4096  4096   768, Elapsed time =   0.052961 s, Result = d0a60000, Performance =   4.87 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.051323 s, Result = 10d80000, Performance =   6.69 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.054222 s, Result = 510a0000, Performance =   7.92 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.061349 s, Result = 913c0000, Performance =   8.40 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.065235 s, Result = d16e0000, Performance =   9.22 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.068950 s, Result = 11a00000, Performance =   9.97 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.069666 s, Result = 51d20000, Performance =  11.10 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.073474 s, Result = 92040000, Performance =  11.69 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.075160 s, Result = d2360000, Performance =  12.57 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.078359 s, Result = 12680000, Performance =  13.15 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.081091 s, Result = 529a0000, Performance =  13.77 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.084261 s, Result = 92cc0000, Performance =  14.27 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.088615 s, Result = d2fe0000, Performance =  14.54 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.092544 s, Result = 13300000, Performance =  14.85 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.094790 s, Result = 53620000, Performance =  15.41 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.098379 s, Result = 93940000, Performance =  15.72 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.102183 s, Result = d3c60000, Performance =  15.97 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.106660 s, Result = 13f80000, Performance =  16.11 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.109471 s, Result = 542a0000, Performance =  16.48 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.113548 s, Result = 945c0000, Performance =  16.64 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.118716 s, Result = d48e0000, Performance =  16.64 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.126574 s, Result = 14c00000, Performance =  16.29 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.129226 s, Result = 54f20000, Performance =  16.62 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.130505 s, Result = 95240000, Performance =  17.11 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.132710 s, Result = d5560000, Performance =  17.48 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.137890 s, Result = 15880000, Performance =  17.44 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.137852 s, Result = 55ba0000, Performance =  18.07 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.143632 s, Result = 95ec0000, Performance =  17.94 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.149562 s, Result = d61e0000, Performance =  17.80 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.156531 s, Result = 16500000, Performance =  17.56 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.146457 s, Result = 56820000, Performance =  19.36 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.144398 s, Result = 96b40000, Performance =  20.23 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.151868 s, Result = d6e60000, Performance =  19.80 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.152996 s, Result = 17180000, Performance =  20.21 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.158792 s, Result = 574a0000, Performance =  20.02 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.155806 s, Result = 977c0000, Performance =  20.95 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.169088 s, Result = d7ae0000, Performance =  19.81 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.172586 s, Result = 17e00000, Performance =  19.91 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.179522 s, Result = 58120000, Performance =  19.62 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.179347 s, Result = 98440000, Performance =  20.12 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.198615 s, Result = d8760000, Performance =  18.60 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.189346 s, Result = 18a80000, Performance =  19.96 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.186719 s, Result = 58da0000, Performance =  20.70 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.186816 s, Result = 990c0000, Performance =  21.15 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.185874 s, Result = d93e0000, Performance =  21.72 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.189748 s, Result = 19700000, Performance =  21.73 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.187147 s, Result = 59a20000, Performance =  22.49 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.190319 s, Result = 99d40000, Performance =  22.57 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.194040 s, Result = da060000, Performance =  22.58 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.190935 s, Result = 1a380000, Performance =  23.39 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.194767 s, Result = 5a6a0000, Performance =  23.37 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.197660 s, Result = 9a9c0000, Performance =  23.47 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.198213 s, Result = dace0000, Performance =  23.84 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.224698 s, Result = 1b000000, Performance =  21.41 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.203465 s, Result = 5b320000, Performance =  24.06 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.210633 s, Result = 9b640000, Performance =  23.65 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.204553 s, Result = db960000, Performance =  24.78 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.197602 s, Result = 1bc80000, Performance =  26.08 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.221458 s, Result = 5bfa0000, Performance =  23.66 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.217741 s, Result = 9c2c0000, Performance =  24.46 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.207685 s, Result = dc5e0000, Performance =  26.06 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.257055 s, Result = 1c900000, Performance =  21.39 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1313  1136  1088
Test passed: M N K =   279  1517  2048
Test passed: M N K =   435   367   256
Test passed: M N K =  1385    75   768
Test passed: M N K =  1836   814   128
M N K =  4096  4096   256, Elapsed time =   0.031121 s, Result = 00320000, Performance =   2.76 TOPS
M N K =  4096  4096   512, Elapsed time =   0.034876 s, Result = 00640000, Performance =   4.93 TOPS
M N K =  4096  4096   768, Elapsed time =   0.036504 s, Result = 00960000, Performance =   7.06 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.050166 s, Result = 00c80000, Performance =   6.85 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.041307 s, Result = 00fa0000, Performance =  10.40 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.048521 s, Result = 012c0000, Performance =  10.62 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.049346 s, Result = 015e0000, Performance =  12.19 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.054461 s, Result = 01900000, Performance =  12.62 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.055171 s, Result = 01c20000, Performance =  14.01 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.053542 s, Result = 01f40000, Performance =  16.04 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.053390 s, Result = 02260000, Performance =  17.70 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.066139 s, Result = 02580000, Performance =  15.59 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.064175 s, Result = 028a0000, Performance =  17.40 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.076105 s, Result = 02bc0000, Performance =  15.80 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.076438 s, Result = 02ee0000, Performance =  16.86 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.077943 s, Result = 03200000, Performance =  17.63 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.073572 s, Result = 03520000, Performance =  19.85 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.077590 s, Result = 03840000, Performance =  19.93 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.081094 s, Result = 03b60000, Performance =  20.13 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.085157 s, Result = 03e80000, Performance =  20.17 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.088943 s, Result = 041a0000, Performance =  20.28 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.095962 s, Result = 044c0000, Performance =  19.69 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.096568 s, Result = 047e0000, Performance =  20.46 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.103285 s, Result = 04b00000, Performance =  19.96 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.115866 s, Result = 04e20000, Performance =  18.53 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.104536 s, Result = 05140000, Performance =  21.36 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.110156 s, Result = 05460000, Performance =  21.05 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.125989 s, Result = 05780000, Performance =  19.09 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.118998 s, Result = 05aa0000, Performance =  20.93 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.129471 s, Result = 05dc0000, Performance =  19.90 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.136405 s, Result = 060e0000, Performance =  19.52 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.134527 s, Result = 06400000, Performance =  20.43 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.145543 s, Result = 06720000, Performance =  19.48 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.129578 s, Result = 06a40000, Performance =  22.54 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.130913 s, Result = 06d60000, Performance =  22.97 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.139028 s, Result = 07080000, Performance =  22.24 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.136433 s, Result = 073a0000, Performance =  23.30 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.181603 s, Result = 076c0000, Performance =  17.97 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.181062 s, Result = 079e0000, Performance =  18.50 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.170516 s, Result = 07d00000, Performance =  20.15 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.161282 s, Result = 08020000, Performance =  21.84 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.162341 s, Result = 08340000, Performance =  22.22 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.177539 s, Result = 08660000, Performance =  20.80 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.175816 s, Result = 08980000, Performance =  21.50 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.165938 s, Result = 08ca0000, Performance =  23.29 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.165423 s, Result = 08fc0000, Performance =  23.89 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.166303 s, Result = 092e0000, Performance =  24.28 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.167296 s, Result = 09600000, Performance =  24.65 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.166062 s, Result = 09920000, Performance =  25.35 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.168375 s, Result = 09c40000, Performance =  25.51 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.171146 s, Result = 09f60000, Performance =  25.60 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.170006 s, Result = 0a280000, Performance =  26.27 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.172670 s, Result = 0a5a0000, Performance =  26.37 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.176493 s, Result = 0a8c0000, Performance =  26.28 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.178134 s, Result = 0abe0000, Performance =  26.52 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.180172 s, Result = 0af00000, Performance =  26.70 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.180256 s, Result = 0b220000, Performance =  27.16 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.185030 s, Result = 0b540000, Performance =  26.93 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.182690 s, Result = 0b860000, Performance =  27.74 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.185028 s, Result = 0bb80000, Performance =  27.86 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.186693 s, Result = 0bea0000, Performance =  28.07 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.197705 s, Result = 0c1c0000, Performance =  26.94 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.192480 s, Result = 0c4e0000, Performance =  28.12 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.233124 s, Result = 0c800000, Performance =  23.58 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1889   213   448
Test passed: M N K =  1915   552  1088
Test passed: M N K =   504  1664  1216
Test passed: M N K =   657  1435   192
Test passed: M N K =  1282   846   576
M N K =  4096  4096   256, Elapsed time =   0.024193 s, Result = a0d20000, Performance =   3.55 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024900 s, Result = a1040000, Performance =   6.90 TOPS
M N K =  4096  4096   768, Elapsed time =   0.026903 s, Result = a1360000, Performance =   9.58 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.028581 s, Result = a1680000, Performance =  12.02 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.030550 s, Result = a19a0000, Performance =  14.06 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.032269 s, Result = a1cc0000, Performance =  15.97 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.033724 s, Result = a1fe0000, Performance =  17.83 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.036169 s, Result = a2300000, Performance =  19.00 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037457 s, Result = a2620000, Performance =  20.64 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.038572 s, Result = a2940000, Performance =  22.27 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.041566 s, Result = a2c60000, Performance =  22.73 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.044274 s, Result = a2f80000, Performance =  23.28 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.046071 s, Result = a32a0000, Performance =  24.24 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.049467 s, Result = a35c0000, Performance =  24.31 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051986 s, Result = a38e0000, Performance =  24.79 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.056637 s, Result = a3c00000, Performance =  24.27 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.057972 s, Result = a3f20000, Performance =  25.19 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.062403 s, Result = a4240000, Performance =  24.78 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.064117 s, Result = a4560000, Performance =  25.45 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.066858 s, Result = a4880000, Performance =  25.70 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.071397 s, Result = a4ba0000, Performance =  25.27 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.074729 s, Result = a4ec0000, Performance =  25.29 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.079917 s, Result = a51e0000, Performance =  24.72 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.083875 s, Result = a5500000, Performance =  24.58 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.087212 s, Result = a5820000, Performance =  24.62 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.098010 s, Result = a5b40000, Performance =  22.79 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.094666 s, Result = a5e60000, Performance =  24.50 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.098206 s, Result = a6180000, Performance =  24.49 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.101517 s, Result = a64a0000, Performance =  24.54 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.105555 s, Result = a67c0000, Performance =  24.41 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.110207 s, Result = a6ae0000, Performance =  24.16 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.115013 s, Result = a6e00000, Performance =  23.90 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.106759 s, Result = a7120000, Performance =  26.55 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.111584 s, Result = a7440000, Performance =  26.17 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.113706 s, Result = a7760000, Performance =  26.44 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.116164 s, Result = a7a80000, Performance =  26.62 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.116435 s, Result = a7da0000, Performance =  27.30 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.120842 s, Result = a80c0000, Performance =  27.01 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.129247 s, Result = a83e0000, Performance =  25.92 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.134156 s, Result = a8700000, Performance =  25.61 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.133251 s, Result = a8a20000, Performance =  26.43 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.137261 s, Result = a8d40000, Performance =  26.28 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.145955 s, Result = a9060000, Performance =  25.31 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.144245 s, Result = a9380000, Performance =  26.20 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.144727 s, Result = a96a0000, Performance =  26.71 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.144974 s, Result = a99c0000, Performance =  27.26 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.146393 s, Result = a9ce0000, Performance =  27.58 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.149179 s, Result = aa000000, Performance =  27.64 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.147084 s, Result = aa320000, Performance =  28.62 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.148939 s, Result = aa640000, Performance =  28.84 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.151836 s, Result = aa960000, Performance =  28.85 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.150348 s, Result = aac80000, Performance =  29.71 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.154099 s, Result = aafa0000, Performance =  29.54 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.157318 s, Result = ab2c0000, Performance =  29.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.160166 s, Result = ab5e0000, Performance =  29.50 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.161954 s, Result = ab900000, Performance =  29.70 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.163846 s, Result = abc20000, Performance =  29.88 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.166703 s, Result = abf40000, Performance =  29.89 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.163947 s, Result = ac260000, Performance =  30.91 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.165789 s, Result = ac580000, Performance =  31.09 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.169999 s, Result = ac8a0000, Performance =  30.82 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.178228 s, Result = acbc0000, Performance =  29.88 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.174956 s, Result = acee0000, Performance =  30.93 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.223919 s, Result = ad200000, Performance =  24.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   607  1203  1600
Test passed: M N K =   865    37  1216
Test passed: M N K =  1534   653   192
Test passed: M N K =   785   659   128
Test passed: M N K =  1188   285  2048
M N K =  4096  4096   256, Elapsed time =   0.001546 s, Result = 00320000, Performance =  55.55 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003239 s, Result = 00640000, Performance =  53.04 TOPS
M N K =  4096  4096   768, Elapsed time =   0.004924 s, Result = 00960000, Performance =  52.34 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004623 s, Result = 00c80000, Performance =  74.32 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005141 s, Result = 00fa0000, Performance =  83.54 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.006118 s, Result = 012c0000, Performance =  84.24 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007585 s, Result = 015e0000, Performance =  79.28 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008961 s, Result = 01900000, Performance =  76.68 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010507 s, Result = 01c20000, Performance =  73.58 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.012210 s, Result = 01f40000, Performance =  70.35 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.022832 s, Result = 02260000, Performance =  41.38 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.024752 s, Result = 02580000, Performance =  41.64 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.026959 s, Result = 028a0000, Performance =  41.42 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.028531 s, Result = 02bc0000, Performance =  42.15 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.031804 s, Result = 02ee0000, Performance =  40.51 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.035379 s, Result = 03200000, Performance =  38.85 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.036277 s, Result = 03520000, Performance =  40.25 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.039794 s, Result = 03840000, Performance =  38.86 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.043406 s, Result = 03b60000, Performance =  37.60 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.040262 s, Result = 03e80000, Performance =  42.67 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.048457 s, Result = 041a0000, Performance =  37.23 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.052759 s, Result = 044c0000, Performance =  35.82 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057806 s, Result = 047e0000, Performance =  34.18 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061880 s, Result = 04b00000, Performance =  33.32 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.063677 s, Result = 04e20000, Performance =  33.72 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.065644 s, Result = 05140000, Performance =  34.02 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.072464 s, Result = 05460000, Performance =  32.01 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.076653 s, Result = 05780000, Performance =  31.38 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.080359 s, Result = 05aa0000, Performance =  31.00 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.094056 s, Result = 05dc0000, Performance =  27.40 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.089141 s, Result = 060e0000, Performance =  29.87 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.093776 s, Result = 06400000, Performance =  29.31 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.085523 s, Result = 06720000, Performance =  33.15 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.088511 s, Result = 06a40000, Performance =  33.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.090455 s, Result = 06d60000, Performance =  33.24 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.092395 s, Result = 07080000, Performance =  33.47 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.095155 s, Result = 073a0000, Performance =  33.40 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.099386 s, Result = 076c0000, Performance =  32.84 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.105641 s, Result = 079e0000, Performance =  31.71 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.110294 s, Result = 07d00000, Performance =  31.15 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.116256 s, Result = 08020000, Performance =  30.29 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.114481 s, Result = 08340000, Performance =  31.51 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.121476 s, Result = 08660000, Performance =  30.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.119649 s, Result = 08980000, Performance =  31.59 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.120491 s, Result = 08ca0000, Performance =  32.08 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.121190 s, Result = 08fc0000, Performance =  32.60 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.121727 s, Result = 092e0000, Performance =  33.17 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.124014 s, Result = 09600000, Performance =  33.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.122843 s, Result = 09920000, Performance =  34.26 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.125351 s, Result = 09c40000, Performance =  34.26 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.129270 s, Result = 09f60000, Performance =  33.89 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.127361 s, Result = 0a280000, Performance =  35.07 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.131210 s, Result = 0a5a0000, Performance =  34.70 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.136042 s, Result = 0a8c0000, Performance =  34.10 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.140475 s, Result = 0abe0000, Performance =  33.63 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.140224 s, Result = 0af00000, Performance =  34.30 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.143122 s, Result = 0b220000, Performance =  34.21 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.146189 s, Result = 0b540000, Performance =  34.08 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.143081 s, Result = 0b860000, Performance =  35.42 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.142903 s, Result = 0bb80000, Performance =  36.07 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.148641 s, Result = 0bea0000, Performance =  35.25 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.157228 s, Result = 0c1c0000, Performance =  33.87 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.152266 s, Result = 0c4e0000, Performance =  35.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.206254 s, Result = 0c800000, Performance =  26.65 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1691   523   896
Test passed: M N K =  1155   822   768
Test passed: M N K =   326   505  1344
Test passed: M N K =  1225   505  1536
Test passed: M N K =   212   488  1152
M N K =  4096  4096   256, Elapsed time =   0.046197 s, Result = 50420000, Performance =   1.86 TOPS
M N K =  4096  4096   512, Elapsed time =   0.042526 s, Result = 90740000, Performance =   4.04 TOPS
M N K =  4096  4096   768, Elapsed time =   0.047408 s, Result = d0a60000, Performance =   5.44 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.049787 s, Result = 10d80000, Performance =   6.90 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.052220 s, Result = 510a0000, Performance =   8.22 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.060736 s, Result = 913c0000, Performance =   8.49 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.067202 s, Result = d16e0000, Performance =   8.95 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.069040 s, Result = 11a00000, Performance =   9.95 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.070325 s, Result = 51d20000, Performance =  10.99 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.071671 s, Result = 92040000, Performance =  11.99 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.072598 s, Result = d2360000, Performance =  13.02 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.075196 s, Result = 12680000, Performance =  13.71 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.078158 s, Result = 529a0000, Performance =  14.29 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.080482 s, Result = 92cc0000, Performance =  14.94 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.085195 s, Result = d2fe0000, Performance =  15.12 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.087535 s, Result = 13300000, Performance =  15.70 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.091948 s, Result = 53620000, Performance =  15.88 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.095529 s, Result = 93940000, Performance =  16.19 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.096671 s, Result = d3c60000, Performance =  16.88 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.100137 s, Result = 13f80000, Performance =  17.16 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.104075 s, Result = 542a0000, Performance =  17.33 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.107671 s, Result = 945c0000, Performance =  17.55 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.110835 s, Result = d48e0000, Performance =  17.83 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.114723 s, Result = 14c00000, Performance =  17.97 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.118070 s, Result = 54f20000, Performance =  18.19 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.120924 s, Result = 95240000, Performance =  18.47 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.125175 s, Result = d5560000, Performance =  18.53 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.128356 s, Result = 15880000, Performance =  18.74 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.137407 s, Result = 55ba0000, Performance =  18.13 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.132606 s, Result = 95ec0000, Performance =  19.43 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.135542 s, Result = d61e0000, Performance =  19.65 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.157528 s, Result = 16500000, Performance =  17.45 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.137307 s, Result = 56820000, Performance =  20.64 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.136074 s, Result = 96b40000, Performance =  21.46 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.134709 s, Result = d6e60000, Performance =  22.32 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.137709 s, Result = 17180000, Performance =  22.46 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.141466 s, Result = 574a0000, Performance =  22.47 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.146062 s, Result = 977c0000, Performance =  22.35 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.144485 s, Result = d7ae0000, Performance =  23.19 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.152477 s, Result = 17e00000, Performance =  22.53 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.159960 s, Result = 58120000, Performance =  22.02 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.161767 s, Result = 98440000, Performance =  22.30 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.165573 s, Result = d8760000, Performance =  22.31 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.164388 s, Result = 18a80000, Performance =  22.99 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.164862 s, Result = 58da0000, Performance =  23.45 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.166210 s, Result = 990c0000, Performance =  23.77 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.168909 s, Result = d93e0000, Performance =  23.90 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.172974 s, Result = 19700000, Performance =  23.84 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.170433 s, Result = 59a20000, Performance =  24.70 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.172040 s, Result = 99d40000, Performance =  24.96 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.176467 s, Result = da060000, Performance =  24.83 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.174063 s, Result = 1a380000, Performance =  25.66 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.177321 s, Result = 5a6a0000, Performance =  25.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.180281 s, Result = 9a9c0000, Performance =  25.73 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.182242 s, Result = dace0000, Performance =  25.92 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.183874 s, Result = 1b000000, Performance =  26.16 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.185067 s, Result = 5b320000, Performance =  26.46 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.188059 s, Result = 9b640000, Performance =  26.49 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.187425 s, Result = db960000, Performance =  27.04 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.186501 s, Result = 1bc80000, Performance =  27.64 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.193247 s, Result = 5bfa0000, Performance =  27.11 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.192630 s, Result = 9c2c0000, Performance =  27.65 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.193477 s, Result = dc5e0000, Performance =  27.97 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.251477 s, Result = 1c900000, Performance =  21.86 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1709   627  1600
Test passed: M N K =  1842  1551   704
Test passed: M N K =   821   187  1024
Test passed: M N K =  1643   358   768
Test passed: M N K =   589   863  1216
M N K =  4096  4096   256, Elapsed time =   0.033610 s, Result = 00320000, Performance =   2.56 TOPS
M N K =  4096  4096   512, Elapsed time =   0.034842 s, Result = 00640000, Performance =   4.93 TOPS
M N K =  4096  4096   768, Elapsed time =   0.038731 s, Result = 00960000, Performance =   6.65 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.040125 s, Result = 00c80000, Performance =   8.56 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.042735 s, Result = 00fa0000, Performance =  10.05 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.044283 s, Result = 012c0000, Performance =  11.64 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.046402 s, Result = 015e0000, Performance =  12.96 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.055636 s, Result = 01900000, Performance =  12.35 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.057833 s, Result = 01c20000, Performance =  13.37 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.052361 s, Result = 01f40000, Performance =  16.41 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.052097 s, Result = 02260000, Performance =  18.14 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.060420 s, Result = 02580000, Performance =  17.06 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.056916 s, Result = 028a0000, Performance =  19.62 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.059041 s, Result = 02bc0000, Performance =  20.37 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.061286 s, Result = 02ee0000, Performance =  21.02 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.064273 s, Result = 03200000, Performance =  21.38 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.076126 s, Result = 03520000, Performance =  19.18 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.072149 s, Result = 03840000, Performance =  21.43 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.073278 s, Result = 03b60000, Performance =  22.27 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.077320 s, Result = 03e80000, Performance =  22.22 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.080828 s, Result = 041a0000, Performance =  22.32 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.085042 s, Result = 044c0000, Performance =  22.22 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.087756 s, Result = 047e0000, Performance =  22.51 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.092468 s, Result = 04b00000, Performance =  22.30 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.095144 s, Result = 04e20000, Performance =  22.57 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.097336 s, Result = 05140000, Performance =  22.95 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.100553 s, Result = 05460000, Performance =  23.07 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.103519 s, Result = 05780000, Performance =  23.23 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.106896 s, Result = 05aa0000, Performance =  23.30 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.109154 s, Result = 05dc0000, Performance =  23.61 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.113983 s, Result = 060e0000, Performance =  23.36 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.135491 s, Result = 06400000, Performance =  20.29 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.116269 s, Result = 06720000, Performance =  24.38 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.115166 s, Result = 06a40000, Performance =  25.36 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.118014 s, Result = 06d60000, Performance =  25.48 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.118287 s, Result = 07080000, Performance =  26.14 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.121620 s, Result = 073a0000, Performance =  26.13 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.124665 s, Result = 076c0000, Performance =  26.18 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.127869 s, Result = 079e0000, Performance =  26.20 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.130542 s, Result = 07d00000, Performance =  26.32 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.135954 s, Result = 08020000, Performance =  25.90 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.138948 s, Result = 08340000, Performance =  25.96 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.141934 s, Result = 08660000, Performance =  26.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.143296 s, Result = 08980000, Performance =  26.38 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.142988 s, Result = 08ca0000, Performance =  27.03 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.147285 s, Result = 08fc0000, Performance =  26.83 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.148538 s, Result = 092e0000, Performance =  27.18 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.150204 s, Result = 09600000, Performance =  27.45 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.148125 s, Result = 09920000, Performance =  28.42 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.152950 s, Result = 09c40000, Performance =  28.08 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.153987 s, Result = 09f60000, Performance =  28.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.151558 s, Result = 0a280000, Performance =  29.47 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.154013 s, Result = 0a5a0000, Performance =  29.56 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.157073 s, Result = 0a8c0000, Performance =  29.53 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.159240 s, Result = 0abe0000, Performance =  29.67 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.160858 s, Result = 0af00000, Performance =  29.90 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.163331 s, Result = 0b220000, Performance =  29.98 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.164870 s, Result = 0b540000, Performance =  30.22 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.164525 s, Result = 0b860000, Performance =  30.80 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.162138 s, Result = 0bb80000, Performance =  31.79 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.166131 s, Result = 0bea0000, Performance =  31.54 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.169276 s, Result = 0c1c0000, Performance =  31.46 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.175184 s, Result = 0c4e0000, Performance =  30.89 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.229549 s, Result = 0c800000, Performance =  23.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   736    76  1024
Test passed: M N K =   114   583  1216
Test passed: M N K =  1789    30  1408
Test passed: M N K =   570   807   896
Test passed: M N K =  1693  1643  1664
M N K =  4096  4096   256, Elapsed time =   0.024718 s, Result = a0d20000, Performance =   3.48 TOPS
M N K =  4096  4096   512, Elapsed time =   0.025108 s, Result = a1040000, Performance =   6.84 TOPS
M N K =  4096  4096   768, Elapsed time =   0.027017 s, Result = a1360000, Performance =   9.54 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.028229 s, Result = a1680000, Performance =  12.17 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.029796 s, Result = a19a0000, Performance =  14.41 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.031478 s, Result = a1cc0000, Performance =  16.37 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.033712 s, Result = a1fe0000, Performance =  17.84 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.035176 s, Result = a2300000, Performance =  19.54 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.037771 s, Result = a2620000, Performance =  20.47 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.038037 s, Result = a2940000, Performance =  22.58 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.046945 s, Result = a2c60000, Performance =  20.13 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.041410 s, Result = a2f80000, Performance =  24.89 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.043006 s, Result = a32a0000, Performance =  25.97 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.044782 s, Result = a35c0000, Performance =  26.85 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.048055 s, Result = a38e0000, Performance =  26.81 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.050918 s, Result = a3c00000, Performance =  26.99 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.054453 s, Result = a3f20000, Performance =  26.82 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.055732 s, Result = a4240000, Performance =  27.74 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.059345 s, Result = a4560000, Performance =  27.50 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.061965 s, Result = a4880000, Performance =  27.72 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.066168 s, Result = a4ba0000, Performance =  27.26 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.068997 s, Result = a4ec0000, Performance =  27.39 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.074004 s, Result = a51e0000, Performance =  26.70 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.077067 s, Result = a5500000, Performance =  26.75 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.080537 s, Result = a5820000, Performance =  26.66 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.082891 s, Result = a5b40000, Performance =  26.94 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.085611 s, Result = a5e60000, Performance =  27.09 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.088340 s, Result = a6180000, Performance =  27.23 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.091779 s, Result = a64a0000, Performance =  27.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.092675 s, Result = a67c0000, Performance =  27.81 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.098279 s, Result = a6ae0000, Performance =  27.10 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.120280 s, Result = a6e00000, Performance =  22.85 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.101487 s, Result = a7120000, Performance =  27.93 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.097164 s, Result = a7440000, Performance =  30.06 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.101616 s, Result = a7760000, Performance =  29.59 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.103156 s, Result = a7a80000, Performance =  29.98 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.107767 s, Result = a7da0000, Performance =  29.49 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.109750 s, Result = a80c0000, Performance =  29.74 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.113459 s, Result = a83e0000, Performance =  29.53 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.115904 s, Result = a8700000, Performance =  29.65 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.119175 s, Result = a8a20000, Performance =  29.55 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.121560 s, Result = a8d40000, Performance =  29.68 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.126133 s, Result = a9060000, Performance =  29.28 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.125470 s, Result = a9380000, Performance =  30.12 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.126560 s, Result = a96a0000, Performance =  30.54 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.127466 s, Result = a99c0000, Performance =  31.00 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.130536 s, Result = a9ce0000, Performance =  30.93 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.132185 s, Result = aa000000, Performance =  31.19 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.131213 s, Result = aa320000, Performance =  32.08 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.135734 s, Result = aa640000, Performance =  31.64 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.138417 s, Result = aa960000, Performance =  31.65 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.136722 s, Result = aac80000, Performance =  32.67 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.140069 s, Result = aafa0000, Performance =  32.50 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.143888 s, Result = ab2c0000, Performance =  32.24 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.145876 s, Result = ab5e0000, Performance =  32.39 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.145636 s, Result = ab900000, Performance =  33.03 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.149526 s, Result = abc20000, Performance =  32.75 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.151124 s, Result = abf40000, Performance =  32.97 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.151341 s, Result = ac260000, Performance =  33.49 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.147953 s, Result = ac580000, Performance =  34.84 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.156820 s, Result = ac8a0000, Performance =  33.41 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.155098 s, Result = acbc0000, Performance =  34.34 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.160959 s, Result = acee0000, Performance =  33.62 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.221537 s, Result = ad200000, Performance =  24.82 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1352  1543  1792
Test passed: M N K =  1163  1128  1472
Test passed: M N K =  1778   783  1536
Test passed: M N K =   214  1234   320
Test passed: M N K =  1734  1450   832
M N K =  4096  4096   256, Elapsed time =   0.001571 s, Result = 00320000, Performance =  54.69 TOPS
M N K =  4096  4096   512, Elapsed time =   0.003025 s, Result = 00640000, Performance =  56.80 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003381 s, Result = 00960000, Performance =  76.22 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004448 s, Result = 00c80000, Performance =  77.25 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005194 s, Result = 00fa0000, Performance =  82.69 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.006298 s, Result = 012c0000, Performance =  81.84 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007584 s, Result = 015e0000, Performance =  79.29 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008641 s, Result = 01900000, Performance =  79.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.010313 s, Result = 01c20000, Performance =  74.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.011377 s, Result = 01f40000, Performance =  75.50 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.012556 s, Result = 02260000, Performance =  75.25 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.014181 s, Result = 02580000, Performance =  72.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.015914 s, Result = 028a0000, Performance =  70.17 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.018090 s, Result = 02bc0000, Performance =  66.48 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.029424 s, Result = 02ee0000, Performance =  43.79 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.031044 s, Result = 03200000, Performance =  44.27 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.033905 s, Result = 03520000, Performance =  43.07 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.036205 s, Result = 03840000, Performance =  42.71 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.037826 s, Result = 03b60000, Performance =  43.15 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.048963 s, Result = 03e80000, Performance =  35.09 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.051727 s, Result = 041a0000, Performance =  34.87 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.053811 s, Result = 044c0000, Performance =  35.12 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057433 s, Result = 047e0000, Performance =  34.40 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061093 s, Result = 04b00000, Performance =  33.74 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.056773 s, Result = 04e20000, Performance =  37.83 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.061669 s, Result = 05140000, Performance =  36.22 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.064559 s, Result = 05460000, Performance =  35.93 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.066747 s, Result = 05780000, Performance =  36.03 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.070881 s, Result = 05aa0000, Performance =  35.14 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.072566 s, Result = 05dc0000, Performance =  35.51 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.076730 s, Result = 060e0000, Performance =  34.70 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.095446 s, Result = 06400000, Performance =  28.80 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.080073 s, Result = 06720000, Performance =  35.40 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.075438 s, Result = 06a40000, Performance =  38.72 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.084207 s, Result = 06d60000, Performance =  35.70 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.088918 s, Result = 07080000, Performance =  34.78 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.087932 s, Result = 073a0000, Performance =  36.14 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.085585 s, Result = 076c0000, Performance =  38.14 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.089190 s, Result = 079e0000, Performance =  37.56 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.091930 s, Result = 07d00000, Performance =  37.38 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.095885 s, Result = 08020000, Performance =  36.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.098175 s, Result = 08340000, Performance =  36.75 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.103215 s, Result = 08660000, Performance =  35.79 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.103271 s, Result = 08980000, Performance =  36.60 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.105501 s, Result = 08ca0000, Performance =  36.64 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.106182 s, Result = 08fc0000, Performance =  37.21 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.108793 s, Result = 092e0000, Performance =  37.11 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.109924 s, Result = 09600000, Performance =  37.51 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.112221 s, Result = 09920000, Performance =  37.51 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.113963 s, Result = 09c40000, Performance =  37.69 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.116968 s, Result = 09f60000, Performance =  37.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.116084 s, Result = 0a280000, Performance =  38.48 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.118323 s, Result = 0a5a0000, Performance =  38.48 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.120987 s, Result = 0a8c0000, Performance =  38.34 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.123245 s, Result = 0abe0000, Performance =  38.33 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.125661 s, Result = 0af00000, Performance =  38.28 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.129059 s, Result = 0b220000, Performance =  37.94 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.129913 s, Result = 0b540000, Performance =  38.35 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.131350 s, Result = 0b860000, Performance =  38.58 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.134088 s, Result = 0bb80000, Performance =  38.44 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.140333 s, Result = 0bea0000, Performance =  37.34 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.145869 s, Result = 0c1c0000, Performance =  36.51 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.143042 s, Result = 0c4e0000, Performance =  37.83 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.196260 s, Result = 0c800000, Performance =  28.01 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1110  1790   192
Test passed: M N K =  1758   283   704
Test passed: M N K =  1217   228   320
Test passed: M N K =  1551   889  1728
Test passed: M N K =  1714  1348  1600
M N K =  4096  4096   256, Elapsed time =   0.040846 s, Result = 50420000, Performance =   2.10 TOPS
M N K =  4096  4096   512, Elapsed time =   0.050553 s, Result = 90740000, Performance =   3.40 TOPS
M N K =  4096  4096   768, Elapsed time =   0.045208 s, Result = d0a60000, Performance =   5.70 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.047370 s, Result = 10d80000, Performance =   7.25 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.057057 s, Result = 510a0000, Performance =   7.53 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.062431 s, Result = 913c0000, Performance =   8.26 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.065014 s, Result = d16e0000, Performance =   9.25 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.065430 s, Result = 11a00000, Performance =  10.50 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.068233 s, Result = 51d20000, Performance =  11.33 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.071118 s, Result = 92040000, Performance =  12.08 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.071899 s, Result = d2360000, Performance =  13.14 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.073481 s, Result = 12680000, Performance =  14.03 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.077380 s, Result = 529a0000, Performance =  14.43 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.079307 s, Result = 92cc0000, Performance =  15.16 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.081594 s, Result = d2fe0000, Performance =  15.79 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.083534 s, Result = 13300000, Performance =  16.45 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.088526 s, Result = 53620000, Performance =  16.50 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.091189 s, Result = 93940000, Performance =  16.96 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.093936 s, Result = d3c60000, Performance =  17.37 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.096697 s, Result = 13f80000, Performance =  17.77 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.100022 s, Result = 542a0000, Performance =  18.03 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.113667 s, Result = 945c0000, Performance =  16.63 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.109585 s, Result = d48e0000, Performance =  18.03 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.112908 s, Result = 14c00000, Performance =  18.26 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.112651 s, Result = 54f20000, Performance =  19.06 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.117287 s, Result = 95240000, Performance =  19.04 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.121377 s, Result = d5560000, Performance =  19.11 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.122899 s, Result = 15880000, Performance =  19.57 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.124405 s, Result = 55ba0000, Performance =  20.02 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.129124 s, Result = 95ec0000, Performance =  19.96 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.129192 s, Result = d61e0000, Performance =  20.61 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.147111 s, Result = 16500000, Performance =  18.69 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.137853 s, Result = 56820000, Performance =  20.56 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.139345 s, Result = 96b40000, Performance =  20.96 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.139830 s, Result = d6e60000, Performance =  21.50 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.138045 s, Result = 17180000, Performance =  22.40 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.135768 s, Result = 574a0000, Performance =  23.41 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.148147 s, Result = 977c0000, Performance =  22.03 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.144519 s, Result = d7ae0000, Performance =  23.18 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.146106 s, Result = 17e00000, Performance =  23.52 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.151420 s, Result = 58120000, Performance =  23.26 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.148621 s, Result = 98440000, Performance =  24.28 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.160452 s, Result = d8760000, Performance =  23.02 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.158386 s, Result = 18a80000, Performance =  23.86 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.161820 s, Result = 58da0000, Performance =  23.89 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.163596 s, Result = 990c0000, Performance =  24.15 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.161723 s, Result = d93e0000, Performance =  24.96 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.158399 s, Result = 19700000, Performance =  26.03 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.166104 s, Result = 59a20000, Performance =  25.34 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.166308 s, Result = 99d40000, Performance =  25.83 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.171616 s, Result = da060000, Performance =  25.53 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.167182 s, Result = 1a380000, Performance =  26.72 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.176966 s, Result = 5a6a0000, Performance =  25.73 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.174990 s, Result = 9a9c0000, Performance =  26.51 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.176586 s, Result = dace0000, Performance =  26.75 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.177111 s, Result = 1b000000, Performance =  27.16 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.187355 s, Result = 5b320000, Performance =  26.13 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.183121 s, Result = 9b640000, Performance =  27.21 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.184628 s, Result = db960000, Performance =  27.45 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.182344 s, Result = 1bc80000, Performance =  28.26 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.189243 s, Result = 5bfa0000, Performance =  27.69 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.188434 s, Result = 9c2c0000, Performance =  28.26 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.187603 s, Result = dc5e0000, Performance =  28.85 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.245604 s, Result = 1c900000, Performance =  22.38 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1674   275   576
Test passed: M N K =   192  1079   576
Test passed: M N K =   583  1495  1024
Test passed: M N K =  1118   664  1664
Test passed: M N K =  2017   704   384
M N K =  4096  4096   256, Elapsed time =   0.031808 s, Result = 00320000, Performance =   2.70 TOPS
M N K =  4096  4096   512, Elapsed time =   0.034464 s, Result = 00640000, Performance =   4.98 TOPS
M N K =  4096  4096   768, Elapsed time =   0.038159 s, Result = 00960000, Performance =   6.75 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.039857 s, Result = 00c80000, Performance =   8.62 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.043509 s, Result = 00fa0000, Performance =   9.87 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.044367 s, Result = 012c0000, Performance =  11.62 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.051884 s, Result = 015e0000, Performance =  11.59 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.047600 s, Result = 01900000, Performance =  14.44 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.064682 s, Result = 01c20000, Performance =  11.95 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.057485 s, Result = 01f40000, Performance =  14.94 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.057504 s, Result = 02260000, Performance =  16.43 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.060141 s, Result = 02580000, Performance =  17.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.055917 s, Result = 028a0000, Performance =  19.97 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.058515 s, Result = 02bc0000, Performance =  20.55 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.059722 s, Result = 02ee0000, Performance =  21.57 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.061999 s, Result = 03200000, Performance =  22.17 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.064971 s, Result = 03520000, Performance =  22.48 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067906 s, Result = 03840000, Performance =  22.77 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071394 s, Result = 03b60000, Performance =  22.86 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.074604 s, Result = 03e80000, Performance =  23.03 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.076913 s, Result = 041a0000, Performance =  23.45 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.080396 s, Result = 044c0000, Performance =  23.51 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.083477 s, Result = 047e0000, Performance =  23.67 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.086402 s, Result = 04b00000, Performance =  23.86 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.089996 s, Result = 04e20000, Performance =  23.86 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.094041 s, Result = 05140000, Performance =  23.75 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.096986 s, Result = 05460000, Performance =  23.91 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.098942 s, Result = 05780000, Performance =  24.31 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.101470 s, Result = 05aa0000, Performance =  24.55 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.105236 s, Result = 05dc0000, Performance =  24.49 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.107876 s, Result = 060e0000, Performance =  24.68 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.122472 s, Result = 06400000, Performance =  22.44 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.114005 s, Result = 06720000, Performance =  24.86 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.117951 s, Result = 06a40000, Performance =  24.76 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.119283 s, Result = 06d60000, Performance =  25.20 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.117490 s, Result = 07080000, Performance =  26.32 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.120753 s, Result = 073a0000, Performance =  26.32 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.121033 s, Result = 076c0000, Performance =  26.97 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.122959 s, Result = 079e0000, Performance =  27.25 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.126808 s, Result = 07d00000, Performance =  27.10 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.128572 s, Result = 08020000, Performance =  27.39 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.132351 s, Result = 08340000, Performance =  27.26 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.136132 s, Result = 08660000, Performance =  27.13 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.134542 s, Result = 08980000, Performance =  28.09 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.138420 s, Result = 08ca0000, Performance =  27.93 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.140969 s, Result = 08fc0000, Performance =  28.03 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.143205 s, Result = 092e0000, Performance =  28.19 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.144866 s, Result = 09600000, Performance =  28.46 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.145977 s, Result = 09920000, Performance =  28.83 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.148012 s, Result = 09c40000, Performance =  29.02 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.153992 s, Result = 09f60000, Performance =  28.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.151628 s, Result = 0a280000, Performance =  29.46 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.154409 s, Result = 0a5a0000, Performance =  29.48 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.155024 s, Result = 0a8c0000, Performance =  29.92 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.158756 s, Result = 0abe0000, Performance =  29.76 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.161725 s, Result = 0af00000, Performance =  29.74 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.165821 s, Result = 0b220000, Performance =  29.53 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.165539 s, Result = 0b540000, Performance =  30.10 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.164630 s, Result = 0b860000, Performance =  30.78 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.161604 s, Result = 0bb80000, Performance =  31.89 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.167905 s, Result = 0bea0000, Performance =  31.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.171035 s, Result = 0c1c0000, Performance =  31.14 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.168485 s, Result = 0c4e0000, Performance =  32.12 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.223219 s, Result = 0c800000, Performance =  24.63 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   143   559   896
Test passed: M N K =   392   542   960
Test passed: M N K =  1924   266   960
Test passed: M N K =  1806   159   768
Test passed: M N K =   707   786   448
M N K =  4096  4096   256, Elapsed time =   0.022756 s, Result = a0d20000, Performance =   3.77 TOPS
M N K =  4096  4096   512, Elapsed time =   0.025050 s, Result = a1040000, Performance =   6.86 TOPS
M N K =  4096  4096   768, Elapsed time =   0.026488 s, Result = a1360000, Performance =   9.73 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.031200 s, Result = a1680000, Performance =  11.01 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.037487 s, Result = a19a0000, Performance =  11.46 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040159 s, Result = a1cc0000, Performance =  12.83 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.048929 s, Result = a1fe0000, Performance =  12.29 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.041546 s, Result = a2300000, Performance =  16.54 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.043734 s, Result = a2620000, Performance =  17.68 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.044925 s, Result = a2940000, Performance =  19.12 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.038526 s, Result = a2c60000, Performance =  24.53 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.043852 s, Result = a2f80000, Performance =  23.51 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.048802 s, Result = a32a0000, Performance =  22.88 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.051411 s, Result = a35c0000, Performance =  23.39 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.046825 s, Result = a38e0000, Performance =  27.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.048748 s, Result = a3c00000, Performance =  28.19 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.052153 s, Result = a3f20000, Performance =  28.00 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.053896 s, Result = a4240000, Performance =  28.69 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.057339 s, Result = a4560000, Performance =  28.46 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.059511 s, Result = a4880000, Performance =  28.87 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.065796 s, Result = a4ba0000, Performance =  27.42 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.065182 s, Result = a4ec0000, Performance =  28.99 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.068707 s, Result = a51e0000, Performance =  28.76 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.071815 s, Result = a5500000, Performance =  28.71 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.079554 s, Result = a5820000, Performance =  26.99 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.081328 s, Result = a5b40000, Performance =  27.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.084756 s, Result = a5e60000, Performance =  27.36 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.086613 s, Result = a6180000, Performance =  27.77 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.088899 s, Result = a64a0000, Performance =  28.02 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.091886 s, Result = a67c0000, Performance =  28.05 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.094236 s, Result = a6ae0000, Performance =  28.26 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.109565 s, Result = a6e00000, Performance =  25.09 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.098092 s, Result = a7120000, Performance =  28.90 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.101401 s, Result = a7440000, Performance =  28.80 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.100923 s, Result = a7760000, Performance =  29.79 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.100648 s, Result = a7a80000, Performance =  30.72 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.102597 s, Result = a7da0000, Performance =  30.98 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.104251 s, Result = a80c0000, Performance =  31.31 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.108707 s, Result = a83e0000, Performance =  30.82 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.108548 s, Result = a8700000, Performance =  31.65 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.110696 s, Result = a8a20000, Performance =  31.82 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.114798 s, Result = a8d40000, Performance =  31.43 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.119036 s, Result = a9060000, Performance =  31.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.117678 s, Result = a9380000, Performance =  32.12 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.120712 s, Result = a96a0000, Performance =  32.02 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.123005 s, Result = a99c0000, Performance =  32.12 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.125427 s, Result = a9ce0000, Performance =  32.19 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.127863 s, Result = aa000000, Performance =  32.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.127830 s, Result = aa320000, Performance =  32.93 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.130019 s, Result = aa640000, Performance =  33.03 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.134376 s, Result = aa960000, Performance =  32.60 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.132420 s, Result = aac80000, Performance =  33.73 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.137701 s, Result = aafa0000, Performance =  33.06 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.139921 s, Result = ab2c0000, Performance =  33.15 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.144691 s, Result = ab5e0000, Performance =  32.65 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.144985 s, Result = ab900000, Performance =  33.18 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.150315 s, Result = abc20000, Performance =  32.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.151632 s, Result = abf40000, Performance =  32.86 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.149073 s, Result = ac260000, Performance =  34.00 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.146365 s, Result = ac580000, Performance =  35.21 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.156312 s, Result = ac8a0000, Performance =  33.52 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.156525 s, Result = acbc0000, Performance =  34.02 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.153364 s, Result = acee0000, Performance =  35.29 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.213976 s, Result = ad200000, Performance =  25.69 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=256 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 256 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   805    47   256
Test passed: M N K =   189  1384   960
Test passed: M N K =   260   479  1088
Test passed: M N K =  1706   697   704
Test passed: M N K =  1904  1354  1536
M N K =  4096  4096   256, Elapsed time =   0.001542 s, Result = 00320000, Performance =  55.72 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002898 s, Result = 00640000, Performance =  59.28 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003172 s, Result = 00960000, Performance =  81.24 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003957 s, Result = 00c80000, Performance =  86.83 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.005045 s, Result = 00fa0000, Performance =  85.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.006179 s, Result = 012c0000, Performance =  83.40 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.007409 s, Result = 015e0000, Performance =  81.15 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.008563 s, Result = 01900000, Performance =  80.25 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.017616 s, Result = 01c20000, Performance =  43.89 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.019701 s, Result = 01f40000, Performance =  43.60 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.021186 s, Result = 02260000, Performance =  44.60 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.022341 s, Result = 02580000, Performance =  46.14 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.023917 s, Result = 028a0000, Performance =  46.69 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.025889 s, Result = 02bc0000, Performance =  46.45 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.027765 s, Result = 02ee0000, Performance =  46.41 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.029758 s, Result = 03200000, Performance =  46.19 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.032149 s, Result = 03520000, Performance =  45.42 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.026903 s, Result = 03840000, Performance =  57.47 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.033424 s, Result = 03b60000, Performance =  48.83 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.039988 s, Result = 03e80000, Performance =  42.96 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.034789 s, Result = 041a0000, Performance =  51.85 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.037343 s, Result = 044c0000, Performance =  50.61 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.043751 s, Result = 047e0000, Performance =  45.16 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.048011 s, Result = 04b00000, Performance =  42.94 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.051957 s, Result = 04e20000, Performance =  41.33 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.056208 s, Result = 05140000, Performance =  39.73 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.058968 s, Result = 05460000, Performance =  39.33 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.061053 s, Result = 05780000, Performance =  39.39 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.063750 s, Result = 05aa0000, Performance =  39.08 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.065917 s, Result = 05dc0000, Performance =  39.09 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.069771 s, Result = 060e0000, Performance =  38.17 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.085019 s, Result = 06400000, Performance =  32.33 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.075306 s, Result = 06720000, Performance =  37.64 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.077834 s, Result = 06a40000, Performance =  37.52 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.078528 s, Result = 06d60000, Performance =  38.29 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.077353 s, Result = 07080000, Performance =  39.98 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.079632 s, Result = 073a0000, Performance =  39.91 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.084784 s, Result = 076c0000, Performance =  38.50 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.087136 s, Result = 079e0000, Performance =  38.45 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.087563 s, Result = 07d00000, Performance =  39.24 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.088590 s, Result = 08020000, Performance =  39.75 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.091930 s, Result = 08340000, Performance =  39.24 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.096752 s, Result = 08660000, Performance =  38.18 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.093598 s, Result = 08980000, Performance =  40.38 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.097923 s, Result = 08ca0000, Performance =  39.47 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.098807 s, Result = 08fc0000, Performance =  39.99 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.101902 s, Result = 092e0000, Performance =  39.62 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.102923 s, Result = 09600000, Performance =  40.06 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.105129 s, Result = 09920000, Performance =  40.04 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.107227 s, Result = 09c40000, Performance =  40.05 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.113106 s, Result = 09f60000, Performance =  38.73 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.109477 s, Result = 0a280000, Performance =  40.80 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.114448 s, Result = 0a5a0000, Performance =  39.78 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.116290 s, Result = 0a8c0000, Performance =  39.89 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.120676 s, Result = 0abe0000, Performance =  39.15 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.122034 s, Result = 0af00000, Performance =  39.42 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.126939 s, Result = 0b220000, Performance =  38.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.128567 s, Result = 0b540000, Performance =  38.75 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.125882 s, Result = 0b860000, Performance =  40.26 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.122920 s, Result = 0bb80000, Performance =  41.93 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.132913 s, Result = 0bea0000, Performance =  39.42 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.132835 s, Result = 0c1c0000, Performance =  40.09 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.130261 s, Result = 0c4e0000, Performance =  41.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.188279 s, Result = 0c800000, Performance =  29.20 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =     3  1549   384
Test passed: M N K =   814   902   384
Test passed: M N K =   888   547  1152
Test passed: M N K =  1557   386    64
Test passed: M N K =    34  1145   832
M N K =  4096  4096   256, Elapsed time =   0.037476 s, Result = 902e0000, Performance =   2.29 TOPS
M N K =  4096  4096   512, Elapsed time =   0.041318 s, Result = 104c0000, Performance =   4.16 TOPS
M N K =  4096  4096   768, Elapsed time =   0.043658 s, Result = 906a0000, Performance =   5.90 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.044738 s, Result = 10880000, Performance =   7.68 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.046370 s, Result = 90a60000, Performance =   9.26 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.047949 s, Result = 10c40000, Performance =  10.75 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.049019 s, Result = 90e20000, Performance =  12.27 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.050825 s, Result = 11000000, Performance =  13.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.052994 s, Result = 911e0000, Performance =  14.59 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.055669 s, Result = 113c0000, Performance =  15.43 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.057405 s, Result = 915a0000, Performance =  16.46 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.058263 s, Result = 11780000, Performance =  17.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.060217 s, Result = 91960000, Performance =  18.54 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.062337 s, Result = 11b40000, Performance =  19.29 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.064113 s, Result = 91d20000, Performance =  20.10 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.065621 s, Result = 11f00000, Performance =  20.94 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.066593 s, Result = 920e0000, Performance =  21.93 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.067978 s, Result = 122c0000, Performance =  22.75 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.071702 s, Result = 924a0000, Performance =  22.76 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.073206 s, Result = 12680000, Performance =  23.47 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.074806 s, Result = 92860000, Performance =  24.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.075404 s, Result = 12a40000, Performance =  25.06 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.077656 s, Result = 92c20000, Performance =  25.44 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.078956 s, Result = 12e00000, Performance =  26.11 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.083038 s, Result = 92fe0000, Performance =  25.86 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.084654 s, Result = 131c0000, Performance =  26.38 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.085454 s, Result = 933a0000, Performance =  27.14 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.088945 s, Result = 13580000, Performance =  27.04 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.090233 s, Result = 93760000, Performance =  27.61 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.091497 s, Result = 13940000, Performance =  28.16 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.092862 s, Result = 93b20000, Performance =  28.68 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.112044 s, Result = 13d00000, Performance =  24.53 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.092713 s, Result = 93ee0000, Performance =  30.57 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.094277 s, Result = 140c0000, Performance =  30.98 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.094374 s, Result = 942a0000, Performance =  31.86 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.095387 s, Result = 14480000, Performance =  32.42 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.098512 s, Result = 94660000, Performance =  32.26 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.102903 s, Result = 14840000, Performance =  31.72 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.105800 s, Result = 94a20000, Performance =  31.66 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.109665 s, Result = 14c00000, Performance =  31.33 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.111591 s, Result = 94de0000, Performance =  31.56 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.114423 s, Result = 14fc0000, Performance =  31.53 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.119020 s, Result = 951a0000, Performance =  31.03 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.117161 s, Result = 15380000, Performance =  32.26 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.118396 s, Result = 95560000, Performance =  32.65 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.118730 s, Result = 15740000, Performance =  33.28 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.120118 s, Result = 95920000, Performance =  33.61 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.122944 s, Result = 15b00000, Performance =  33.54 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.121709 s, Result = 95ce0000, Performance =  34.58 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.122058 s, Result = 15ec0000, Performance =  35.19 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.123322 s, Result = 960a0000, Performance =  35.52 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.120085 s, Result = 16280000, Performance =  37.20 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.122839 s, Result = 96460000, Performance =  37.06 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.124912 s, Result = 16640000, Performance =  37.13 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.125338 s, Result = 96820000, Performance =  37.69 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.125880 s, Result = 16a00000, Performance =  38.21 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.126529 s, Result = 96be0000, Performance =  38.70 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.128333 s, Result = 16dc0000, Performance =  38.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.126258 s, Result = 96fa0000, Performance =  40.14 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.126661 s, Result = 17180000, Performance =  40.69 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.128411 s, Result = 97360000, Performance =  40.81 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.133263 s, Result = 17540000, Performance =  39.96 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.131093 s, Result = 97720000, Performance =  41.28 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.162123 s, Result = 17900000, Performance =  33.91 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1555  1966  1088
Test passed: M N K =  1224   634   448
Test passed: M N K =   709  1507  1856
Test passed: M N K =   225  1142   896
Test passed: M N K =   481  1665  1728
M N K =  4096  4096   256, Elapsed time =   0.023195 s, Result = 001e0000, Performance =   3.70 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024391 s, Result = 003c0000, Performance =   7.04 TOPS
M N K =  4096  4096   768, Elapsed time =   0.025519 s, Result = 005a0000, Performance =  10.10 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.027586 s, Result = 00780000, Performance =  12.46 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028420 s, Result = 00960000, Performance =  15.11 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.030186 s, Result = 00b40000, Performance =  17.07 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.031409 s, Result = 00d20000, Performance =  19.14 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.033310 s, Result = 00f00000, Performance =  20.63 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.035260 s, Result = 010e0000, Performance =  21.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.037112 s, Result = 012c0000, Performance =  23.15 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.039449 s, Result = 014a0000, Performance =  23.95 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.041408 s, Result = 01680000, Performance =  24.89 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.043211 s, Result = 01860000, Performance =  25.84 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.045199 s, Result = 01a40000, Performance =  26.61 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.047551 s, Result = 01c20000, Performance =  27.10 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.049957 s, Result = 01e00000, Performance =  27.51 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.051087 s, Result = 01fe0000, Performance =  28.58 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.053418 s, Result = 021c0000, Performance =  28.95 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.055120 s, Result = 023a0000, Performance =  29.61 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.057195 s, Result = 02580000, Performance =  30.04 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.059078 s, Result = 02760000, Performance =  30.53 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.060008 s, Result = 02940000, Performance =  31.49 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.065334 s, Result = 02b20000, Performance =  30.24 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.067177 s, Result = 02d00000, Performance =  30.69 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069698 s, Result = 02ee0000, Performance =  30.81 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.071829 s, Result = 030c0000, Performance =  31.09 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.073866 s, Result = 032a0000, Performance =  31.40 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.075737 s, Result = 03480000, Performance =  31.76 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.077103 s, Result = 03660000, Performance =  32.31 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.078400 s, Result = 03840000, Performance =  32.87 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.081897 s, Result = 03a20000, Performance =  32.51 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.086231 s, Result = 03c00000, Performance =  31.88 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.079567 s, Result = 03de0000, Performance =  35.63 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.081144 s, Result = 03fc0000, Performance =  35.99 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.083706 s, Result = 041a0000, Performance =  35.92 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.085869 s, Result = 04380000, Performance =  36.01 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.089218 s, Result = 04560000, Performance =  35.62 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.098929 s, Result = 04740000, Performance =  33.00 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.096571 s, Result = 04920000, Performance =  34.69 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.098286 s, Result = 04b00000, Performance =  34.96 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.101038 s, Result = 04ce0000, Performance =  34.86 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.102520 s, Result = 04ec0000, Performance =  35.19 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.105851 s, Result = 050a0000, Performance =  34.89 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.105563 s, Result = 05280000, Performance =  35.80 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.107125 s, Result = 05460000, Performance =  36.08 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.109235 s, Result = 05640000, Performance =  36.17 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.110053 s, Result = 05820000, Performance =  36.68 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.111343 s, Result = 05a00000, Performance =  37.03 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.110549 s, Result = 05be0000, Performance =  38.07 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.111148 s, Result = 05dc0000, Performance =  38.64 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.111616 s, Result = 05fa0000, Performance =  39.25 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.112210 s, Result = 06180000, Performance =  39.81 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.112170 s, Result = 06360000, Performance =  40.59 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.114039 s, Result = 06540000, Performance =  40.68 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.113162 s, Result = 06720000, Performance =  41.75 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.113633 s, Result = 06900000, Performance =  42.33 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.115524 s, Result = 06ae0000, Performance =  42.38 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.116478 s, Result = 06cc0000, Performance =  42.77 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.115067 s, Result = 06ea0000, Performance =  44.04 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.115862 s, Result = 07080000, Performance =  44.48 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.116576 s, Result = 07260000, Performance =  44.95 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.121018 s, Result = 07440000, Performance =  44.01 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.119415 s, Result = 07620000, Performance =  45.32 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.148764 s, Result = 07800000, Performance =  36.95 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   396   957  1344
Test passed: M N K =   200  1237   512
Test passed: M N K =  1490  1936  1984
Test passed: M N K =  2034  1219  1664
Test passed: M N K =  1505  1333   256
M N K =  4096  4096   256, Elapsed time =   0.018656 s, Result = a0be0000, Performance =   4.60 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017599 s, Result = a0dc0000, Performance =   9.76 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018550 s, Result = a0fa0000, Performance =  13.89 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.020028 s, Result = a1180000, Performance =  17.16 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.021217 s, Result = a1360000, Performance =  20.24 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.022206 s, Result = a1540000, Performance =  23.21 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023572 s, Result = a1720000, Performance =  25.51 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.024975 s, Result = a1900000, Performance =  27.52 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.026313 s, Result = a1ae0000, Performance =  29.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.027965 s, Result = a1cc0000, Performance =  30.72 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.029392 s, Result = a1ea0000, Performance =  32.15 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.031403 s, Result = a2080000, Performance =  32.82 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.033177 s, Result = a2260000, Performance =  33.66 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.035045 s, Result = a2440000, Performance =  34.32 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.037028 s, Result = a2620000, Performance =  34.80 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.039551 s, Result = a2800000, Performance =  34.75 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.040658 s, Result = a29e0000, Performance =  35.92 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.042307 s, Result = a2bc0000, Performance =  36.55 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.044663 s, Result = a2da0000, Performance =  36.54 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.046275 s, Result = a2f80000, Performance =  37.13 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.048174 s, Result = a3160000, Performance =  37.45 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.050021 s, Result = a3340000, Performance =  37.78 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.055619 s, Result = a3520000, Performance =  35.52 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.058059 s, Result = a3700000, Performance =  35.51 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.059785 s, Result = a38e0000, Performance =  35.92 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.061438 s, Result = a3ac0000, Performance =  36.35 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.063310 s, Result = a3ca0000, Performance =  36.63 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.065441 s, Result = a3e80000, Performance =  36.75 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.066904 s, Result = a4060000, Performance =  37.23 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.068511 s, Result = a4240000, Performance =  37.61 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.071797 s, Result = a4420000, Performance =  37.09 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.075702 s, Result = a4600000, Performance =  36.31 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.069529 s, Result = a47e0000, Performance =  40.77 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.070885 s, Result = a49c0000, Performance =  41.20 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.072576 s, Result = a4ba0000, Performance =  41.43 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.075208 s, Result = a4d80000, Performance =  41.12 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.077799 s, Result = a4f60000, Performance =  40.85 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.081430 s, Result = a5140000, Performance =  40.09 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.084696 s, Result = a5320000, Performance =  39.55 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.087550 s, Result = a5500000, Performance =  39.25 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.089780 s, Result = a56e0000, Performance =  39.23 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.091256 s, Result = a58c0000, Performance =  39.53 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.094773 s, Result = a5aa0000, Performance =  38.97 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.094545 s, Result = a5c80000, Performance =  39.98 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.096202 s, Result = a5e60000, Performance =  40.18 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.097329 s, Result = a6040000, Performance =  40.60 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.112715 s, Result = a6220000, Performance =  35.82 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.095264 s, Result = a6400000, Performance =  43.28 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.094732 s, Result = a65e0000, Performance =  44.43 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.095830 s, Result = a67c0000, Performance =  44.82 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.096166 s, Result = a69a0000, Performance =  45.56 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.095909 s, Result = a6b80000, Performance =  46.57 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.096924 s, Result = a6d60000, Performance =  46.97 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.097789 s, Result = a6f40000, Performance =  47.43 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.097533 s, Result = a7120000, Performance =  48.44 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.098551 s, Result = a7300000, Performance =  48.81 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.102773 s, Result = a74e0000, Performance =  47.64 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.104724 s, Result = a76c0000, Performance =  47.57 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.104242 s, Result = a78a0000, Performance =  48.62 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.103831 s, Result = a7a80000, Performance =  49.64 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.106139 s, Result = a7c60000, Performance =  49.37 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.109946 s, Result = a7e40000, Performance =  48.44 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.107713 s, Result = a8020000, Performance =  50.24 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.137343 s, Result = a8200000, Performance =  40.03 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  2043   342  2048
Test passed: M N K =   877  1121  1216
Test passed: M N K =  1409  1462   640
Test passed: M N K =   474   944  1664
Test passed: M N K =   864  1666  1920
M N K =  4096  4096   256, Elapsed time =   0.001215 s, Result = 001e0000, Performance =  70.73 TOPS
M N K =  4096  4096   512, Elapsed time =   0.001989 s, Result = 003c0000, Performance =  86.36 TOPS
M N K =  4096  4096   768, Elapsed time =   0.002049 s, Result = 005a0000, Performance = 125.74 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002833 s, Result = 00780000, Performance = 121.30 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003322 s, Result = 00960000, Performance = 129.30 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.004013 s, Result = 00b40000, Performance = 128.43 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004826 s, Result = 00d20000, Performance = 124.59 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005994 s, Result = 00f00000, Performance = 114.65 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006947 s, Result = 010e0000, Performance = 111.29 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.008279 s, Result = 012c0000, Performance = 103.76 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.009897 s, Result = 014a0000, Performance =  95.48 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.011734 s, Result = 01680000, Performance =  87.85 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.013927 s, Result = 01860000, Performance =  80.18 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.016536 s, Result = 01a40000, Performance =  72.73 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.017924 s, Result = 01c20000, Performance =  71.89 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.020427 s, Result = 01e00000, Performance =  67.28 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023024 s, Result = 01fe0000, Performance =  63.42 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.028411 s, Result = 021c0000, Performance =  54.42 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.032663 s, Result = 023a0000, Performance =  49.97 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.034965 s, Result = 02580000, Performance =  49.14 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.036671 s, Result = 02760000, Performance =  49.19 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.038272 s, Result = 02940000, Performance =  49.38 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.040317 s, Result = 02b20000, Performance =  49.00 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.042086 s, Result = 02d00000, Performance =  48.98 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.044198 s, Result = 02ee0000, Performance =  48.59 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.046229 s, Result = 030c0000, Performance =  48.31 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.048707 s, Result = 032a0000, Performance =  47.62 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.050563 s, Result = 03480000, Performance =  47.57 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.051796 s, Result = 03660000, Performance =  48.09 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.053417 s, Result = 03840000, Performance =  48.24 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.055921 s, Result = 03a20000, Performance =  47.62 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.060201 s, Result = 03c00000, Performance =  45.66 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.053883 s, Result = 03de0000, Performance =  52.61 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.054907 s, Result = 03fc0000, Performance =  53.19 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.056733 s, Result = 041a0000, Performance =  52.99 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.058847 s, Result = 04380000, Performance =  52.55 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.061419 s, Result = 04560000, Performance =  51.75 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.065387 s, Result = 04740000, Performance =  49.92 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.069818 s, Result = 04920000, Performance =  47.98 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.072781 s, Result = 04b00000, Performance =  47.21 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.074787 s, Result = 04ce0000, Performance =  47.09 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.076580 s, Result = 04ec0000, Performance =  47.11 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.079748 s, Result = 050a0000, Performance =  46.32 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.079190 s, Result = 05280000, Performance =  47.73 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.081475 s, Result = 05460000, Performance =  47.44 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.082856 s, Result = 05640000, Performance =  47.69 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.083489 s, Result = 05820000, Performance =  48.36 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.085127 s, Result = 05a00000, Performance =  48.44 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.084037 s, Result = 05be0000, Performance =  50.09 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.085399 s, Result = 05dc0000, Performance =  50.29 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.085759 s, Result = 05fa0000, Performance =  51.08 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.085586 s, Result = 06180000, Performance =  52.19 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.086585 s, Result = 06360000, Performance =  52.58 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.087363 s, Result = 06540000, Performance =  53.10 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.087355 s, Result = 06720000, Performance =  54.08 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.087226 s, Result = 06900000, Performance =  55.15 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.088282 s, Result = 06ae0000, Performance =  55.46 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.089219 s, Result = 06cc0000, Performance =  55.84 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.088349 s, Result = 06ea0000, Performance =  57.36 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.088723 s, Result = 07080000, Performance =  58.09 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.090638 s, Result = 07260000, Performance =  57.81 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.097400 s, Result = 07440000, Performance =  54.68 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.092565 s, Result = 07620000, Performance =  58.46 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.125578 s, Result = 07800000, Performance =  43.78 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1081  2020  2048
Test passed: M N K =   445  1739   128
Test passed: M N K =  1918  1090  1472
Test passed: M N K =  1045   228  1984
Test passed: M N K =   622   828  2048
M N K =  4096  4096   256, Elapsed time =   0.036447 s, Result = 902e0000, Performance =   2.36 TOPS
M N K =  4096  4096   512, Elapsed time =   0.042104 s, Result = 104c0000, Performance =   4.08 TOPS
M N K =  4096  4096   768, Elapsed time =   0.043553 s, Result = 906a0000, Performance =   5.92 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.049987 s, Result = 10880000, Performance =   6.87 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.044749 s, Result = 90a60000, Performance =   9.60 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.052565 s, Result = 10c40000, Performance =   9.80 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.053748 s, Result = 90e20000, Performance =  11.19 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.053747 s, Result = 11000000, Performance =  12.79 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.051502 s, Result = 911e0000, Performance =  15.01 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.052560 s, Result = 113c0000, Performance =  16.34 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.053903 s, Result = 915a0000, Performance =  17.53 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.057188 s, Result = 11780000, Performance =  18.02 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.057646 s, Result = 91960000, Performance =  19.37 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.059637 s, Result = 11b40000, Performance =  20.17 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.062799 s, Result = 91d20000, Performance =  20.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.063542 s, Result = 11f00000, Performance =  21.63 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.064765 s, Result = 920e0000, Performance =  22.55 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.064745 s, Result = 122c0000, Performance =  23.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.066783 s, Result = 924a0000, Performance =  24.44 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.067125 s, Result = 12680000, Performance =  25.59 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.069130 s, Result = 92860000, Performance =  26.09 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.071520 s, Result = 12a40000, Performance =  26.42 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.071608 s, Result = 92c20000, Performance =  27.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.075040 s, Result = 12e00000, Performance =  27.47 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.076015 s, Result = 92fe0000, Performance =  28.25 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.077097 s, Result = 131c0000, Performance =  28.97 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.079262 s, Result = 933a0000, Performance =  29.26 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.080129 s, Result = 13580000, Performance =  30.02 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.081290 s, Result = 93760000, Performance =  30.64 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.082514 s, Result = 13940000, Performance =  31.23 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.084082 s, Result = 93b20000, Performance =  31.67 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.097094 s, Result = 13d00000, Performance =  28.31 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.086474 s, Result = 93ee0000, Performance =  32.78 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.082756 s, Result = 140c0000, Performance =  35.29 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.084242 s, Result = 942a0000, Performance =  35.69 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.087292 s, Result = 14480000, Performance =  35.43 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.089910 s, Result = 94660000, Performance =  35.35 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.091538 s, Result = 14840000, Performance =  35.66 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.092214 s, Result = 94a20000, Performance =  36.33 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.095646 s, Result = 14c00000, Performance =  35.92 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.098676 s, Result = 94de0000, Performance =  35.69 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.100759 s, Result = 14fc0000, Performance =  35.81 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.104805 s, Result = 951a0000, Performance =  35.24 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.101532 s, Result = 15380000, Performance =  37.23 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.104194 s, Result = 95560000, Performance =  37.10 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.104942 s, Result = 15740000, Performance =  37.65 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.105159 s, Result = 95920000, Performance =  38.39 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.106873 s, Result = 15b00000, Performance =  38.58 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.106792 s, Result = 95ce0000, Performance =  39.41 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.107177 s, Result = 15ec0000, Performance =  40.07 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.108729 s, Result = 960a0000, Performance =  40.29 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.109460 s, Result = 16280000, Performance =  40.81 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.109906 s, Result = 96460000, Performance =  41.42 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.112130 s, Result = 16640000, Performance =  41.37 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.112980 s, Result = 96820000, Performance =  41.82 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.113177 s, Result = 16a00000, Performance =  42.50 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.115005 s, Result = 96be0000, Performance =  42.57 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.115559 s, Result = 16dc0000, Performance =  43.11 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.115482 s, Result = 96fa0000, Performance =  43.89 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.113752 s, Result = 17180000, Performance =  45.31 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.117728 s, Result = 97360000, Performance =  44.51 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.117835 s, Result = 17540000, Performance =  45.20 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.121323 s, Result = 97720000, Performance =  44.61 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.155152 s, Result = 17900000, Performance =  35.43 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =    97   478  1280
Test passed: M N K =  2004   152   128
Test passed: M N K =   356   392    64
Test passed: M N K =   649  1266   320
Test passed: M N K =    45   890  1856
M N K =  4096  4096   256, Elapsed time =   0.024171 s, Result = 001e0000, Performance =   3.55 TOPS
M N K =  4096  4096   512, Elapsed time =   0.023301 s, Result = 003c0000, Performance =   7.37 TOPS
M N K =  4096  4096   768, Elapsed time =   0.025502 s, Result = 005a0000, Performance =  10.10 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.026849 s, Result = 00780000, Performance =  12.80 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028409 s, Result = 00960000, Performance =  15.12 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.029670 s, Result = 00b40000, Performance =  17.37 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.030833 s, Result = 00d20000, Performance =  19.50 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.032867 s, Result = 00f00000, Performance =  20.91 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.034224 s, Result = 010e0000, Performance =  22.59 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.035495 s, Result = 012c0000, Performance =  24.20 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.036899 s, Result = 014a0000, Performance =  25.61 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.041839 s, Result = 01680000, Performance =  24.64 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.040107 s, Result = 01860000, Performance =  27.84 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.042429 s, Result = 01a40000, Performance =  28.34 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.044736 s, Result = 01c20000, Performance =  28.80 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.046968 s, Result = 01e00000, Performance =  29.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.048169 s, Result = 01fe0000, Performance =  30.32 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.050603 s, Result = 021c0000, Performance =  30.56 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.051487 s, Result = 023a0000, Performance =  31.70 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.053356 s, Result = 02580000, Performance =  32.20 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.055410 s, Result = 02760000, Performance =  32.56 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.056858 s, Result = 02940000, Performance =  33.24 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.058738 s, Result = 02b20000, Performance =  33.64 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.060674 s, Result = 02d00000, Performance =  33.98 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.062151 s, Result = 02ee0000, Performance =  34.55 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.066343 s, Result = 030c0000, Performance =  33.66 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.066163 s, Result = 032a0000, Performance =  35.05 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.067541 s, Result = 03480000, Performance =  35.61 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.068452 s, Result = 03660000, Performance =  36.39 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.069962 s, Result = 03840000, Performance =  36.83 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.071286 s, Result = 03a20000, Performance =  37.35 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.084339 s, Result = 03c00000, Performance =  32.59 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.074005 s, Result = 03de0000, Performance =  38.30 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.071013 s, Result = 03fc0000, Performance =  41.13 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.072733 s, Result = 041a0000, Performance =  41.34 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.074130 s, Result = 04380000, Performance =  41.72 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.076429 s, Result = 04560000, Performance =  41.58 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.077827 s, Result = 04740000, Performance =  41.94 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.080629 s, Result = 04920000, Performance =  41.55 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.083281 s, Result = 04b00000, Performance =  41.26 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.085498 s, Result = 04ce0000, Performance =  41.19 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.087399 s, Result = 04ec0000, Performance =  41.28 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.090138 s, Result = 050a0000, Performance =  40.98 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.089064 s, Result = 05280000, Performance =  42.44 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.091277 s, Result = 05460000, Performance =  42.35 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.091730 s, Result = 05640000, Performance =  43.08 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.093685 s, Result = 05820000, Performance =  43.09 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.094650 s, Result = 05a00000, Performance =  43.56 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.094687 s, Result = 05be0000, Performance =  44.45 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.096655 s, Result = 05dc0000, Performance =  44.44 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.097418 s, Result = 05fa0000, Performance =  44.97 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.095951 s, Result = 06180000, Performance =  46.55 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.096704 s, Result = 06360000, Performance =  47.08 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.099074 s, Result = 06540000, Performance =  46.82 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.099677 s, Result = 06720000, Performance =  47.40 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.099775 s, Result = 06900000, Performance =  48.21 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.102399 s, Result = 06ae0000, Performance =  47.82 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.102856 s, Result = 06cc0000, Performance =  48.44 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.102380 s, Result = 06ea0000, Performance =  49.50 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.101587 s, Result = 07080000, Performance =  50.73 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.104126 s, Result = 07260000, Performance =  50.32 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.105523 s, Result = 07440000, Performance =  50.47 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.109284 s, Result = 07620000, Performance =  49.52 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.140801 s, Result = 07800000, Performance =  39.04 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   480   875  1024
Test passed: M N K =  1154  1862   640
Test passed: M N K =  1281   856  1216
Test passed: M N K =  1733   127   256
Test passed: M N K =  1533   955  1152
M N K =  4096  4096   256, Elapsed time =   0.018609 s, Result = a0be0000, Performance =   4.62 TOPS
M N K =  4096  4096   512, Elapsed time =   0.018040 s, Result = a0dc0000, Performance =   9.52 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018711 s, Result = a0fa0000, Performance =  13.77 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.019518 s, Result = a1180000, Performance =  17.60 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.020682 s, Result = a1360000, Performance =  20.77 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.021901 s, Result = a1540000, Performance =  23.53 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.023276 s, Result = a1720000, Performance =  25.83 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.024209 s, Result = a1900000, Performance =  28.39 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.025806 s, Result = a1ae0000, Performance =  29.96 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.026935 s, Result = a1cc0000, Performance =  31.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.028377 s, Result = a1ea0000, Performance =  33.30 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.029654 s, Result = a2080000, Performance =  34.76 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.031790 s, Result = a2260000, Performance =  35.13 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.033159 s, Result = a2440000, Performance =  36.27 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.035132 s, Result = a2620000, Performance =  36.68 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.036988 s, Result = a2800000, Performance =  37.16 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.038777 s, Result = a29e0000, Performance =  37.66 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.040427 s, Result = a2bc0000, Performance =  38.25 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.043747 s, Result = a2da0000, Performance =  37.31 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.045432 s, Result = a2f80000, Performance =  37.81 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.047268 s, Result = a3160000, Performance =  38.16 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.049103 s, Result = a3340000, Performance =  38.49 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.050511 s, Result = a3520000, Performance =  39.11 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.052204 s, Result = a3700000, Performance =  39.49 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.053583 s, Result = a38e0000, Performance =  40.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.055196 s, Result = a3ac0000, Performance =  40.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.056492 s, Result = a3ca0000, Performance =  41.06 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.072496 s, Result = a3e80000, Performance =  33.18 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.059029 s, Result = a4060000, Performance =  42.20 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.060216 s, Result = a4240000, Performance =  42.80 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.062170 s, Result = a4420000, Performance =  42.83 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.074466 s, Result = a4600000, Performance =  36.91 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.064311 s, Result = a47e0000, Performance =  44.08 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.061552 s, Result = a49c0000, Performance =  47.45 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.063128 s, Result = a4ba0000, Performance =  47.62 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.064666 s, Result = a4d80000, Performance =  47.82 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.066870 s, Result = a4f60000, Performance =  47.53 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.068844 s, Result = a5140000, Performance =  47.41 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.070962 s, Result = a5320000, Performance =  47.21 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.073436 s, Result = a5500000, Performance =  46.79 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.075119 s, Result = a56e0000, Performance =  46.88 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.077275 s, Result = a58c0000, Performance =  46.69 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.081515 s, Result = a5aa0000, Performance =  45.31 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.079789 s, Result = a5c80000, Performance =  47.37 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.081075 s, Result = a5e60000, Performance =  47.68 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.082068 s, Result = a6040000, Performance =  48.15 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.083248 s, Result = a6220000, Performance =  48.50 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.083912 s, Result = a6400000, Performance =  49.14 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.084322 s, Result = a65e0000, Performance =  49.92 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.085279 s, Result = a67c0000, Performance =  50.36 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.086547 s, Result = a69a0000, Performance =  50.62 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.085573 s, Result = a6b80000, Performance =  52.20 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.086693 s, Result = a6d60000, Performance =  52.52 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.088737 s, Result = a6f40000, Performance =  52.27 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.089899 s, Result = a7120000, Performance =  52.55 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.090095 s, Result = a7300000, Performance =  53.39 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.092612 s, Result = a74e0000, Performance =  52.87 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.093276 s, Result = a76c0000, Performance =  53.41 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.093376 s, Result = a78a0000, Performance =  54.28 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.091401 s, Result = a7a80000, Performance =  56.39 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.096251 s, Result = a7c60000, Performance =  54.44 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.095239 s, Result = a7e40000, Performance =  55.92 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.098134 s, Result = a8020000, Performance =  55.15 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.134224 s, Result = a8200000, Performance =  40.96 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   658    12   896
Test passed: M N K =  1019  1616   704
Test passed: M N K =   759  1403   896
Test passed: M N K =  1349   242   320
Test passed: M N K =  1833  1594   256
M N K =  4096  4096   256, Elapsed time =   0.001201 s, Result = 001e0000, Performance =  71.51 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002465 s, Result = 003c0000, Performance =  69.70 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003847 s, Result = 005a0000, Performance =  66.99 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003537 s, Result = 00780000, Performance =  97.13 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003250 s, Result = 00960000, Performance = 132.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003926 s, Result = 00b40000, Performance = 131.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004713 s, Result = 00d20000, Performance = 127.57 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.014829 s, Result = 00f00000, Performance =  46.34 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.015254 s, Result = 010e0000, Performance =  50.68 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015097 s, Result = 012c0000, Performance =  56.90 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017852 s, Result = 014a0000, Performance =  52.93 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.017389 s, Result = 01680000, Performance =  59.28 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.019679 s, Result = 01860000, Performance =  56.74 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.021311 s, Result = 01a40000, Performance =  56.43 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.023957 s, Result = 01c20000, Performance =  53.78 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.019193 s, Result = 01e00000, Performance =  71.61 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.023399 s, Result = 01fe0000, Performance =  62.41 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.023403 s, Result = 021c0000, Performance =  66.07 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025008 s, Result = 023a0000, Performance =  65.26 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.027158 s, Result = 02580000, Performance =  63.26 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.029551 s, Result = 02760000, Performance =  61.04 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.035441 s, Result = 02940000, Performance =  53.32 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.036726 s, Result = 02b20000, Performance =  53.80 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.036811 s, Result = 02d00000, Performance =  56.00 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.036569 s, Result = 02ee0000, Performance =  58.72 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.037670 s, Result = 030c0000, Performance =  59.29 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.039504 s, Result = 032a0000, Performance =  58.71 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.040787 s, Result = 03480000, Performance =  58.97 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.043219 s, Result = 03660000, Performance =  57.64 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.045864 s, Result = 03840000, Performance =  56.19 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.047836 s, Result = 03a20000, Performance =  55.67 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.060727 s, Result = 03c00000, Performance =  45.26 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.050459 s, Result = 03de0000, Performance =  56.18 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.048566 s, Result = 03fc0000, Performance =  60.14 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.050780 s, Result = 041a0000, Performance =  59.21 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.051194 s, Result = 04380000, Performance =  60.40 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.053572 s, Result = 04560000, Performance =  59.33 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.055488 s, Result = 04740000, Performance =  58.83 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.058190 s, Result = 04920000, Performance =  57.57 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.060496 s, Result = 04b00000, Performance =  56.80 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.063416 s, Result = 04ce0000, Performance =  55.54 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.064198 s, Result = 04ec0000, Performance =  56.20 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.066176 s, Result = 050a0000, Performance =  55.82 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.065356 s, Result = 05280000, Performance =  57.83 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.067407 s, Result = 05460000, Performance =  57.35 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.067937 s, Result = 05640000, Performance =  58.16 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.069404 s, Result = 05820000, Performance =  58.17 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.071570 s, Result = 05a00000, Performance =  57.61 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.072560 s, Result = 05be0000, Performance =  58.01 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.072943 s, Result = 05dc0000, Performance =  58.88 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.073933 s, Result = 05fa0000, Performance =  59.25 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.072409 s, Result = 06180000, Performance =  61.69 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.073710 s, Result = 06360000, Performance =  61.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.075448 s, Result = 06540000, Performance =  61.48 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.077654 s, Result = 06720000, Performance =  60.84 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.085586 s, Result = 06900000, Performance =  56.21 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.079055 s, Result = 06ae0000, Performance =  61.93 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.081672 s, Result = 06cc0000, Performance =  61.00 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.081721 s, Result = 06ea0000, Performance =  62.02 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.079806 s, Result = 07080000, Performance =  64.58 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.084226 s, Result = 07260000, Performance =  62.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.083597 s, Result = 07440000, Performance =  63.71 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.086637 s, Result = 07620000, Performance =  62.46 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.120681 s, Result = 07800000, Performance =  45.55 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   446   479    64
Test passed: M N K =   171  1790  1280
Test passed: M N K =   804    69  1216
Test passed: M N K =  2032  2013   384
Test passed: M N K =  1721   402  1216
M N K =  4096  4096   256, Elapsed time =   0.036549 s, Result = 902e0000, Performance =   2.35 TOPS
M N K =  4096  4096   512, Elapsed time =   0.041844 s, Result = 104c0000, Performance =   4.11 TOPS
M N K =  4096  4096   768, Elapsed time =   0.042916 s, Result = 906a0000, Performance =   6.00 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.044402 s, Result = 10880000, Performance =   7.74 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.045628 s, Result = 90a60000, Performance =   9.41 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.047518 s, Result = 10c40000, Performance =  10.85 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.048603 s, Result = 90e20000, Performance =  12.37 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.050130 s, Result = 11000000, Performance =  13.71 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.051783 s, Result = 911e0000, Performance =  14.93 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.053106 s, Result = 113c0000, Performance =  16.18 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.054178 s, Result = 915a0000, Performance =  17.44 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.055201 s, Result = 11780000, Performance =  18.67 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.057475 s, Result = 91960000, Performance =  19.43 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.058852 s, Result = 11b40000, Performance =  20.43 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.061131 s, Result = 91d20000, Performance =  21.08 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.062365 s, Result = 11f00000, Performance =  22.04 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.063442 s, Result = 920e0000, Performance =  23.02 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.065763 s, Result = 122c0000, Performance =  23.51 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.066300 s, Result = 924a0000, Performance =  24.62 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.066847 s, Result = 12680000, Performance =  25.70 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.068941 s, Result = 92860000, Performance =  26.17 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.070073 s, Result = 12a40000, Performance =  26.97 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.072142 s, Result = 92c20000, Performance =  27.39 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.074435 s, Result = 12e00000, Performance =  27.70 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.074954 s, Result = 92fe0000, Performance =  28.65 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.077727 s, Result = 131c0000, Performance =  28.73 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.078118 s, Result = 933a0000, Performance =  29.69 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.078743 s, Result = 13580000, Performance =  30.54 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.080418 s, Result = 93760000, Performance =  30.98 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.080939 s, Result = 13940000, Performance =  31.84 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.083425 s, Result = 93b20000, Performance =  31.92 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.091813 s, Result = 13d00000, Performance =  29.94 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.085387 s, Result = 93ee0000, Performance =  33.20 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.088057 s, Result = 140c0000, Performance =  33.17 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.087538 s, Result = 942a0000, Performance =  34.34 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.087400 s, Result = 14480000, Performance =  35.38 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.089118 s, Result = 94660000, Performance =  35.66 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.090643 s, Result = 14840000, Performance =  36.01 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.091504 s, Result = 94a20000, Performance =  36.61 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.093094 s, Result = 14c00000, Performance =  36.91 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.093141 s, Result = 94de0000, Performance =  37.81 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.097212 s, Result = 14fc0000, Performance =  37.11 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.101460 s, Result = 951a0000, Performance =  36.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.097643 s, Result = 15380000, Performance =  38.71 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.101188 s, Result = 95560000, Performance =  38.20 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.102249 s, Result = 15740000, Performance =  38.64 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.101843 s, Result = 95920000, Performance =  39.64 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.104454 s, Result = 15b00000, Performance =  39.47 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.103642 s, Result = 95ce0000, Performance =  40.61 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.105627 s, Result = 15ec0000, Performance =  40.66 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.110480 s, Result = 960a0000, Performance =  39.65 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.107318 s, Result = 16280000, Performance =  41.62 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.109024 s, Result = 96460000, Performance =  41.76 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.111716 s, Result = 16640000, Performance =  41.52 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.113679 s, Result = 96820000, Performance =  41.56 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.112763 s, Result = 16a00000, Performance =  42.66 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.116332 s, Result = 96be0000, Performance =  42.09 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.116848 s, Result = 16dc0000, Performance =  42.64 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.117537 s, Result = 96fa0000, Performance =  43.12 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.115406 s, Result = 17180000, Performance =  44.66 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.120132 s, Result = 97360000, Performance =  43.62 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.120308 s, Result = 17540000, Performance =  44.27 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.119391 s, Result = 97720000, Performance =  45.33 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.152367 s, Result = 17900000, Performance =  36.08 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   385  1807  1536
Test passed: M N K =   194  1160  1792
Test passed: M N K =   138   623  1280
Test passed: M N K =  1251   400   384
Test passed: M N K =  1055   719  1984
M N K =  4096  4096   256, Elapsed time =   0.023622 s, Result = 001e0000, Performance =   3.64 TOPS
M N K =  4096  4096   512, Elapsed time =   0.024289 s, Result = 003c0000, Performance =   7.07 TOPS
M N K =  4096  4096   768, Elapsed time =   0.026207 s, Result = 005a0000, Performance =   9.83 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.026847 s, Result = 00780000, Performance =  12.80 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.028275 s, Result = 00960000, Performance =  15.19 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.029789 s, Result = 00b40000, Performance =  17.30 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.030722 s, Result = 00d20000, Performance =  19.57 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.032591 s, Result = 00f00000, Performance =  21.09 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.033239 s, Result = 010e0000, Performance =  23.26 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.035247 s, Result = 012c0000, Performance =  24.37 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.037022 s, Result = 014a0000, Performance =  25.52 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.042414 s, Result = 01680000, Performance =  24.30 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.046624 s, Result = 01860000, Performance =  23.95 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.047989 s, Result = 01a40000, Performance =  25.06 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.049758 s, Result = 01c20000, Performance =  25.90 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.044563 s, Result = 01e00000, Performance =  30.84 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.046776 s, Result = 01fe0000, Performance =  31.22 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.048607 s, Result = 021c0000, Performance =  31.81 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.050561 s, Result = 023a0000, Performance =  32.28 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.051065 s, Result = 02580000, Performance =  33.64 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.052646 s, Result = 02760000, Performance =  34.26 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.054270 s, Result = 02940000, Performance =  34.82 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.055932 s, Result = 02b20000, Performance =  35.32 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.060504 s, Result = 02d00000, Performance =  34.07 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.061034 s, Result = 02ee0000, Performance =  35.19 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.062990 s, Result = 030c0000, Performance =  35.46 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.063362 s, Result = 032a0000, Performance =  36.60 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.064211 s, Result = 03480000, Performance =  37.46 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.065443 s, Result = 03660000, Performance =  38.06 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.067289 s, Result = 03840000, Performance =  38.30 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.068983 s, Result = 03a20000, Performance =  38.60 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.076899 s, Result = 03c00000, Performance =  35.75 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.071332 s, Result = 03de0000, Performance =  39.74 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.073006 s, Result = 03fc0000, Performance =  40.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.073168 s, Result = 041a0000, Performance =  41.09 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.072596 s, Result = 04380000, Performance =  42.60 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.074564 s, Result = 04560000, Performance =  42.62 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.076397 s, Result = 04740000, Performance =  42.73 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.078730 s, Result = 04920000, Performance =  42.55 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.078950 s, Result = 04b00000, Performance =  43.52 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.080003 s, Result = 04ce0000, Performance =  44.02 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.083334 s, Result = 04ec0000, Performance =  43.29 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.086392 s, Result = 050a0000, Performance =  42.75 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.084387 s, Result = 05280000, Performance =  44.79 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.086230 s, Result = 05460000, Performance =  44.83 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.087728 s, Result = 05640000, Performance =  45.04 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.088278 s, Result = 05820000, Performance =  45.73 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.089104 s, Result = 05a00000, Performance =  46.27 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.089638 s, Result = 05be0000, Performance =  46.96 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.091166 s, Result = 05dc0000, Performance =  47.11 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.094631 s, Result = 05fa0000, Performance =  46.29 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.092261 s, Result = 06180000, Performance =  48.41 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.094690 s, Result = 06360000, Performance =  48.08 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.095944 s, Result = 06540000, Performance =  48.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.097826 s, Result = 06720000, Performance =  48.29 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.097409 s, Result = 06900000, Performance =  49.38 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.100332 s, Result = 06ae0000, Performance =  48.80 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.101630 s, Result = 06cc0000, Performance =  49.02 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.100907 s, Result = 06ea0000, Performance =  50.22 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.099372 s, Result = 07080000, Performance =  51.87 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.103648 s, Result = 07260000, Performance =  50.55 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.105280 s, Result = 07440000, Performance =  50.59 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.103063 s, Result = 07620000, Performance =  52.51 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.142455 s, Result = 07800000, Performance =  38.59 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   864    59  1216
Test passed: M N K =   615  1404   448
Test passed: M N K =  1793  1980   832
Test passed: M N K =   173  1146   960
Test passed: M N K =   468  1413  1088
M N K =  4096  4096   256, Elapsed time =   0.018327 s, Result = a0be0000, Performance =   4.69 TOPS
M N K =  4096  4096   512, Elapsed time =   0.017918 s, Result = a0dc0000, Performance =   9.59 TOPS
M N K =  4096  4096   768, Elapsed time =   0.018479 s, Result = a0fa0000, Performance =  13.95 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.019673 s, Result = a1180000, Performance =  17.47 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.020563 s, Result = a1360000, Performance =  20.89 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.021753 s, Result = a1540000, Performance =  23.69 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.022883 s, Result = a1720000, Performance =  26.28 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.023607 s, Result = a1900000, Performance =  29.11 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.024751 s, Result = a1ae0000, Performance =  31.24 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.025990 s, Result = a1cc0000, Performance =  33.05 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.027752 s, Result = a1ea0000, Performance =  34.05 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.028579 s, Result = a2080000, Performance =  36.07 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.030114 s, Result = a2260000, Performance =  37.08 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.031062 s, Result = a2440000, Performance =  38.72 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.032713 s, Result = a2620000, Performance =  39.39 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.037176 s, Result = a2800000, Performance =  36.97 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.044022 s, Result = a29e0000, Performance =  33.17 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.038581 s, Result = a2bc0000, Performance =  40.08 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.039925 s, Result = a2da0000, Performance =  40.88 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.041228 s, Result = a2f80000, Performance =  41.67 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.043266 s, Result = a3160000, Performance =  41.69 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.045676 s, Result = a3340000, Performance =  41.37 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.048765 s, Result = a3520000, Performance =  40.51 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.050218 s, Result = a3700000, Performance =  41.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.051576 s, Result = a38e0000, Performance =  41.64 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.053468 s, Result = a3ac0000, Performance =  41.77 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.055109 s, Result = a3ca0000, Performance =  42.09 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.055967 s, Result = a3e80000, Performance =  42.97 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.057488 s, Result = a4060000, Performance =  43.33 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.058393 s, Result = a4240000, Performance =  44.13 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.059990 s, Result = a4420000, Performance =  44.39 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.068818 s, Result = a4600000, Performance =  39.94 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.062620 s, Result = a47e0000, Performance =  45.27 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.063886 s, Result = a49c0000, Performance =  45.72 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.064483 s, Result = a4ba0000, Performance =  46.62 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.064136 s, Result = a4d80000, Performance =  48.22 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.065839 s, Result = a4f60000, Performance =  48.27 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.066994 s, Result = a5140000, Performance =  48.72 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.068608 s, Result = a5320000, Performance =  48.83 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.070032 s, Result = a5500000, Performance =  49.06 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.070858 s, Result = a56e0000, Performance =  49.70 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.073967 s, Result = a58c0000, Performance =  48.78 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.077679 s, Result = a5aa0000, Performance =  47.55 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.074518 s, Result = a5c80000, Performance =  50.72 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.077294 s, Result = a5e60000, Performance =  50.01 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.078200 s, Result = a6040000, Performance =  50.53 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.078655 s, Result = a6220000, Performance =  51.33 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.080161 s, Result = a6400000, Performance =  51.44 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.080232 s, Result = a65e0000, Performance =  52.46 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.082036 s, Result = a67c0000, Performance =  52.35 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.085615 s, Result = a69a0000, Performance =  51.17 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.083039 s, Result = a6b80000, Performance =  53.79 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.085849 s, Result = a6d60000, Performance =  53.03 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.086954 s, Result = a6f40000, Performance =  53.35 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.088766 s, Result = a7120000, Performance =  53.22 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.089125 s, Result = a7300000, Performance =  53.97 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.092296 s, Result = a74e0000, Performance =  53.05 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.093963 s, Result = a76c0000, Performance =  53.02 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.092085 s, Result = a78a0000, Performance =  55.04 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.090222 s, Result = a7a80000, Performance =  57.13 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.095990 s, Result = a7c60000, Performance =  54.59 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.095579 s, Result = a7e40000, Performance =  55.72 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.093677 s, Result = a8020000, Performance =  57.77 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.129768 s, Result = a8200000, Performance =  42.36 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=512 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 512 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   360  1522   704
Test passed: M N K =   512  1732   384
Test passed: M N K =  1817   797   576
Test passed: M N K =   234  1725  1728
Test passed: M N K =   550   347   704
M N K =  4096  4096   256, Elapsed time =   0.001239 s, Result = 001e0000, Performance =  69.33 TOPS
M N K =  4096  4096   512, Elapsed time =   0.004469 s, Result = 003c0000, Performance =  38.44 TOPS
M N K =  4096  4096   768, Elapsed time =   0.004586 s, Result = 005a0000, Performance =  56.19 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002466 s, Result = 00780000, Performance = 139.35 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.003181 s, Result = 00960000, Performance = 135.00 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003936 s, Result = 00b40000, Performance = 130.94 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.004720 s, Result = 00d20000, Performance = 127.40 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.005564 s, Result = 00f00000, Performance = 123.50 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.006496 s, Result = 010e0000, Performance = 119.00 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.007402 s, Result = 012c0000, Performance = 116.05 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.017154 s, Result = 014a0000, Performance =  55.08 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.019575 s, Result = 01680000, Performance =  52.66 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.020914 s, Result = 01860000, Performance =  53.39 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.022453 s, Result = 01a40000, Performance =  53.56 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.024244 s, Result = 01c20000, Performance =  53.15 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.026298 s, Result = 01e00000, Performance =  52.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.026229 s, Result = 01fe0000, Performance =  55.68 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.029781 s, Result = 021c0000, Performance =  51.92 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.031523 s, Result = 023a0000, Performance =  51.77 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.032756 s, Result = 02580000, Performance =  52.45 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.034527 s, Result = 02760000, Performance =  52.25 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.027685 s, Result = 02940000, Performance =  68.26 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.029449 s, Result = 02b20000, Performance =  67.09 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.031615 s, Result = 02d00000, Performance =  65.21 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.033587 s, Result = 02ee0000, Performance =  63.94 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.037916 s, Result = 030c0000, Performance =  58.90 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.039331 s, Result = 032a0000, Performance =  58.97 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.041035 s, Result = 03480000, Performance =  58.61 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.042875 s, Result = 03660000, Performance =  58.10 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.044330 s, Result = 03840000, Performance =  58.13 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.045785 s, Result = 03a20000, Performance =  58.16 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.054187 s, Result = 03c00000, Performance =  50.73 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.048153 s, Result = 03de0000, Performance =  58.87 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.049845 s, Result = 03fc0000, Performance =  58.59 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.050022 s, Result = 041a0000, Performance =  60.10 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.049084 s, Result = 04380000, Performance =  63.00 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.052084 s, Result = 04560000, Performance =  61.02 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.052967 s, Result = 04740000, Performance =  61.63 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.054397 s, Result = 04920000, Performance =  61.59 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.054650 s, Result = 04b00000, Performance =  62.87 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.057082 s, Result = 04ce0000, Performance =  61.70 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.059682 s, Result = 04ec0000, Performance =  60.45 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.063729 s, Result = 050a0000, Performance =  57.96 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.060757 s, Result = 05280000, Performance =  62.21 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.063622 s, Result = 05460000, Performance =  60.76 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.064404 s, Result = 05640000, Performance =  61.35 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.065305 s, Result = 05820000, Performance =  61.82 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.066138 s, Result = 05a00000, Performance =  62.34 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.066690 s, Result = 05be0000, Performance =  63.11 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.067619 s, Result = 05dc0000, Performance =  63.52 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.082023 s, Result = 05fa0000, Performance =  53.41 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.069239 s, Result = 06180000, Performance =  64.51 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.072272 s, Result = 06360000, Performance =  62.99 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.073062 s, Result = 06540000, Performance =  63.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.075442 s, Result = 06720000, Performance =  62.62 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.074930 s, Result = 06900000, Performance =  64.20 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.077777 s, Result = 06ae0000, Performance =  62.95 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.079008 s, Result = 06cc0000, Performance =  63.06 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.078156 s, Result = 06ea0000, Performance =  64.85 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.076209 s, Result = 07080000, Performance =  67.63 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.081882 s, Result = 07260000, Performance =  63.99 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.082317 s, Result = 07440000, Performance =  64.70 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.079866 s, Result = 07620000, Performance =  67.76 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.116339 s, Result = 07800000, Performance =  47.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   926   129  1920
Test passed: M N K =   918  1306   768
Test passed: M N K =  1196  1586   576
Test passed: M N K =   297  1245  1920
Test passed: M N K =   333  1929  1728
M N K =  4096  4096   256, Elapsed time =   0.030590 s, Result = 10240000, Performance =   2.81 TOPS
M N K =  4096  4096   512, Elapsed time =   0.036436 s, Result = 10380000, Performance =   4.72 TOPS
M N K =  4096  4096   768, Elapsed time =   0.040348 s, Result = 104c0000, Performance =   6.39 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.045926 s, Result = 10600000, Performance =   7.48 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.042342 s, Result = 10740000, Performance =  10.14 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.046211 s, Result = 10880000, Performance =  11.15 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.048619 s, Result = 109c0000, Performance =  12.37 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.044013 s, Result = 10b00000, Performance =  15.61 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.044342 s, Result = 10c40000, Performance =  17.43 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.048423 s, Result = 10d80000, Performance =  17.74 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.046937 s, Result = 10ec0000, Performance =  20.13 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.048938 s, Result = 11000000, Performance =  21.06 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.050346 s, Result = 11140000, Performance =  22.18 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.050051 s, Result = 11280000, Performance =  24.03 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051093 s, Result = 113c0000, Performance =  25.22 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.052340 s, Result = 11500000, Performance =  26.26 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.053615 s, Result = 11640000, Performance =  27.24 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.054877 s, Result = 11780000, Performance =  28.18 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.055550 s, Result = 118c0000, Performance =  29.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.056248 s, Result = 11a00000, Performance =  30.54 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.057149 s, Result = 11b40000, Performance =  31.56 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.057856 s, Result = 11c80000, Performance =  32.66 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.059957 s, Result = 11dc0000, Performance =  32.95 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.061111 s, Result = 11f00000, Performance =  33.73 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.062497 s, Result = 12040000, Performance =  34.36 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.063651 s, Result = 12180000, Performance =  35.09 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.064233 s, Result = 122c0000, Performance =  36.11 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.065687 s, Result = 12400000, Performance =  36.62 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.065876 s, Result = 12540000, Performance =  37.81 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.066694 s, Result = 12680000, Performance =  38.64 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.068270 s, Result = 127c0000, Performance =  39.01 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.071369 s, Result = 12900000, Performance =  38.52 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.068367 s, Result = 12a40000, Performance =  41.46 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.070219 s, Result = 12b80000, Performance =  41.59 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.069028 s, Result = 12cc0000, Performance =  43.55 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.071408 s, Result = 12e00000, Performance =  43.31 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.074950 s, Result = 12f40000, Performance =  42.41 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.076902 s, Result = 13080000, Performance =  42.45 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.079339 s, Result = 131c0000, Performance =  42.22 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.080346 s, Result = 13300000, Performance =  42.76 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.081452 s, Result = 13440000, Performance =  43.24 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.081858 s, Result = 13580000, Performance =  44.07 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.085093 s, Result = 136c0000, Performance =  43.41 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.085362 s, Result = 13800000, Performance =  44.28 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.086558 s, Result = 13940000, Performance =  44.66 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.086458 s, Result = 13a80000, Performance =  45.70 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.088377 s, Result = 13bc0000, Performance =  45.68 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.089019 s, Result = 13d00000, Performance =  46.32 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.089027 s, Result = 13e40000, Performance =  47.28 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.089735 s, Result = 13f80000, Performance =  47.86 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.090839 s, Result = 140c0000, Performance =  48.23 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.089571 s, Result = 14200000, Performance =  49.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.090068 s, Result = 14340000, Performance =  50.55 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.089954 s, Result = 14480000, Performance =  51.57 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.089731 s, Result = 145c0000, Performance =  52.65 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.089952 s, Result = 14700000, Performance =  53.48 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.089521 s, Result = 14840000, Performance =  54.69 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.089966 s, Result = 14980000, Performance =  55.38 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.089689 s, Result = 14ac0000, Performance =  56.51 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.088344 s, Result = 14c00000, Performance =  58.34 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.090130 s, Result = 14d40000, Performance =  58.14 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.093603 s, Result = 14e80000, Performance =  56.90 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.091774 s, Result = 14fc0000, Performance =  58.97 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.130176 s, Result = 15100000, Performance =  42.23 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   634   975  2048
Test passed: M N K =  1162   862  2048
Test passed: M N K =  1896  1390   512
Test passed: M N K =  1481   124  2048
Test passed: M N K =  1688   164   448
M N K =  4096  4096   256, Elapsed time =   0.018651 s, Result = 00140000, Performance =   4.61 TOPS
M N K =  4096  4096   512, Elapsed time =   0.021434 s, Result = 00280000, Performance =   8.02 TOPS
M N K =  4096  4096   768, Elapsed time =   0.023515 s, Result = 003c0000, Performance =  10.96 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.024734 s, Result = 00500000, Performance =  13.89 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.034932 s, Result = 00640000, Performance =  12.30 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.036452 s, Result = 00780000, Performance =  14.14 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.037889 s, Result = 008c0000, Performance =  15.87 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.030345 s, Result = 00a00000, Performance =  22.65 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.031659 s, Result = 00b40000, Performance =  24.42 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.033184 s, Result = 00c80000, Performance =  25.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.034204 s, Result = 00dc0000, Performance =  27.63 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.035673 s, Result = 00f00000, Performance =  28.90 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.044574 s, Result = 01040000, Performance =  25.05 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.038460 s, Result = 01180000, Performance =  31.27 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.039843 s, Result = 012c0000, Performance =  32.34 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.041012 s, Result = 01400000, Performance =  33.51 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.041737 s, Result = 01540000, Performance =  34.99 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.043498 s, Result = 01680000, Performance =  35.55 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.044789 s, Result = 017c0000, Performance =  36.44 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.045068 s, Result = 01900000, Performance =  38.12 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.046451 s, Result = 01a40000, Performance =  38.83 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.046402 s, Result = 01b80000, Performance =  40.73 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.047332 s, Result = 01cc0000, Performance =  41.74 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.049135 s, Result = 01e00000, Performance =  41.96 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.051089 s, Result = 01f40000, Performance =  42.03 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.052282 s, Result = 02080000, Performance =  42.72 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.053777 s, Result = 021c0000, Performance =  43.13 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.054231 s, Result = 02300000, Performance =  44.35 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.054963 s, Result = 02440000, Performance =  45.32 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.056129 s, Result = 02580000, Performance =  45.91 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.057903 s, Result = 026c0000, Performance =  45.99 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.060588 s, Result = 02800000, Performance =  45.37 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.056282 s, Result = 02940000, Performance =  50.37 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.056834 s, Result = 02a80000, Performance =  51.39 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.058937 s, Result = 02bc0000, Performance =  51.01 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.060759 s, Result = 02d00000, Performance =  50.90 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.064666 s, Result = 02e40000, Performance =  49.15 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.066430 s, Result = 02f80000, Performance =  49.14 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.068802 s, Result = 030c0000, Performance =  48.69 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.069558 s, Result = 03200000, Performance =  49.40 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.070318 s, Result = 03340000, Performance =  50.08 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.071163 s, Result = 03480000, Performance =  50.70 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.073504 s, Result = 035c0000, Performance =  50.25 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.073930 s, Result = 03700000, Performance =  51.12 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.074496 s, Result = 03840000, Performance =  51.89 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.075274 s, Result = 03980000, Performance =  52.49 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.076096 s, Result = 03ac0000, Performance =  53.05 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.077428 s, Result = 03c00000, Performance =  53.25 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.077412 s, Result = 03d40000, Performance =  54.37 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.078712 s, Result = 03e80000, Performance =  54.57 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.080018 s, Result = 03fc0000, Performance =  54.75 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.079359 s, Result = 04100000, Performance =  56.29 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.080515 s, Result = 04240000, Performance =  56.54 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.080841 s, Result = 04380000, Performance =  57.38 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.080259 s, Result = 044c0000, Performance =  58.87 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.080890 s, Result = 04600000, Performance =  59.47 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.080463 s, Result = 04740000, Performance =  60.85 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.080592 s, Result = 04880000, Performance =  61.82 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.079064 s, Result = 049c0000, Performance =  64.10 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.078783 s, Result = 04b00000, Performance =  65.42 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.080227 s, Result = 04c40000, Performance =  65.31 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.083259 s, Result = 04d80000, Performance =  63.97 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.081382 s, Result = 04ec0000, Performance =  66.50 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.103137 s, Result = 05000000, Performance =  53.30 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 256, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1218   689  1472
Test passed: M N K =  1443  1664   576
Test passed: M N K =  1621   478  1536
Test passed: M N K =   970  1530   704
Test passed: M N K =  1057   454   768
M N K =  4096  4096   256, Elapsed time =   0.016307 s, Result = a0b40000, Performance =   5.27 TOPS
M N K =  4096  4096   512, Elapsed time =   0.016025 s, Result = a0c80000, Performance =  10.72 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016584 s, Result = a0dc0000, Performance =  15.54 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017396 s, Result = a0f00000, Performance =  19.75 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.018458 s, Result = a1040000, Performance =  23.27 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.019014 s, Result = a1180000, Performance =  27.11 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.020291 s, Result = a12c0000, Performance =  29.63 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.021606 s, Result = a1400000, Performance =  31.81 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.022724 s, Result = a1540000, Performance =  34.02 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.023626 s, Result = a1680000, Performance =  36.36 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.025246 s, Result = a17c0000, Performance =  37.43 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.028713 s, Result = a1900000, Performance =  35.90 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.030130 s, Result = a1a40000, Performance =  37.06 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.031210 s, Result = a1b80000, Performance =  38.53 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.031965 s, Result = a1cc0000, Performance =  40.31 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.033407 s, Result = a1e00000, Performance =  41.14 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.034302 s, Result = a1f40000, Performance =  42.57 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.035202 s, Result = a2080000, Performance =  43.92 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.036698 s, Result = a21c0000, Performance =  44.47 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.037392 s, Result = a2300000, Performance =  45.95 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.038293 s, Result = a2440000, Performance =  47.11 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.039158 s, Result = a2580000, Performance =  48.26 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.040133 s, Result = a26c0000, Performance =  49.23 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.041726 s, Result = a2800000, Performance =  49.41 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.044704 s, Result = a2940000, Performance =  48.04 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.045262 s, Result = a2a80000, Performance =  49.34 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.046248 s, Result = a2bc0000, Performance =  50.15 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.047233 s, Result = a2d00000, Performance =  50.92 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.047519 s, Result = a2e40000, Performance =  52.42 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.047929 s, Result = a2f80000, Performance =  53.77 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.049504 s, Result = a30c0000, Performance =  53.79 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.052207 s, Result = a3200000, Performance =  52.65 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.048536 s, Result = a3340000, Performance =  58.40 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.049362 s, Result = a3480000, Performance =  59.17 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.051485 s, Result = a35c0000, Performance =  58.40 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.053928 s, Result = a3700000, Performance =  57.34 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.057202 s, Result = a3840000, Performance =  55.56 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.059321 s, Result = a3980000, Performance =  55.03 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.061066 s, Result = a3ac0000, Performance =  54.86 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.061519 s, Result = a3c00000, Performance =  55.85 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.063060 s, Result = a3d40000, Performance =  55.85 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.063608 s, Result = a3e80000, Performance =  56.72 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.066284 s, Result = a3fc0000, Performance =  55.73 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.065933 s, Result = a4100000, Performance =  57.32 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.067710 s, Result = a4240000, Performance =  57.09 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.068098 s, Result = a4380000, Performance =  58.02 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.069354 s, Result = a44c0000, Performance =  58.21 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.071758 s, Result = a4600000, Performance =  57.46 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.070496 s, Result = a4740000, Performance =  59.71 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.071779 s, Result = a4880000, Performance =  59.84 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.072856 s, Result = a49c0000, Performance =  60.13 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.072593 s, Result = a4b00000, Performance =  61.53 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.073512 s, Result = a4c40000, Performance =  61.93 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.074013 s, Result = a4d80000, Performance =  62.67 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.073545 s, Result = a4ec0000, Performance =  64.24 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.072963 s, Result = a5000000, Performance =  65.93 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.071704 s, Result = a5140000, Performance =  68.28 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.073149 s, Result = a5280000, Performance =  68.11 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.071971 s, Result = a53c0000, Performance =  70.42 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.071458 s, Result = a5500000, Performance =  72.13 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.073045 s, Result = a5640000, Performance =  71.73 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.075719 s, Result = a5780000, Performance =  70.34 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.073599 s, Result = a58c0000, Performance =  73.53 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.094829 s, Result = a5a00000, Performance =  57.97 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=256 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 256, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1608   513   896
Test passed: M N K =  1053  1842  1664
Test passed: M N K =   789  1005   576
Test passed: M N K =  1589   741  1984
Test passed: M N K =  1914   288  1280
M N K =  4096  4096   256, Elapsed time =   0.001038 s, Result = 00140000, Performance =  82.77 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002147 s, Result = 00280000, Performance =  80.03 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003467 s, Result = 003c0000, Performance =  74.32 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.002338 s, Result = 00500000, Performance = 146.98 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002466 s, Result = 00640000, Performance = 174.13 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.002991 s, Result = 00780000, Performance = 172.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003532 s, Result = 008c0000, Performance = 170.26 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004672 s, Result = 00a00000, Performance = 147.08 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005541 s, Result = 00b40000, Performance = 139.53 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.006613 s, Result = 00c80000, Performance = 129.89 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.008260 s, Result = 00dc0000, Performance = 114.39 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.010003 s, Result = 00f00000, Performance = 103.05 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.011788 s, Result = 01040000, Performance =  94.73 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.022867 s, Result = 01180000, Performance =  52.59 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.014393 s, Result = 012c0000, Performance =  89.52 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.016865 s, Result = 01400000, Performance =  81.49 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.022871 s, Result = 01540000, Performance =  63.85 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.024533 s, Result = 01680000, Performance =  63.02 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.025935 s, Result = 017c0000, Performance =  62.93 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.026854 s, Result = 01900000, Performance =  63.97 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.027991 s, Result = 01a40000, Performance =  64.44 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.028629 s, Result = 01b80000, Performance =  66.01 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.029904 s, Result = 01cc0000, Performance =  66.07 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.031649 s, Result = 01e00000, Performance =  65.14 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.033448 s, Result = 01f40000, Performance =  64.20 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.034779 s, Result = 02080000, Performance =  64.22 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.035908 s, Result = 021c0000, Performance =  64.59 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.036688 s, Result = 02300000, Performance =  65.56 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.037765 s, Result = 02440000, Performance =  65.96 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.038199 s, Result = 02580000, Performance =  67.46 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.039970 s, Result = 026c0000, Performance =  66.62 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.042653 s, Result = 02800000, Performance =  64.45 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.038879 s, Result = 02940000, Performance =  72.91 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.039674 s, Result = 02a80000, Performance =  73.61 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.041742 s, Result = 02bc0000, Performance =  72.03 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.043888 s, Result = 02d00000, Performance =  70.46 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.046675 s, Result = 02e40000, Performance =  68.09 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.049135 s, Result = 02f80000, Performance =  66.43 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.051196 s, Result = 030c0000, Performance =  65.44 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.051903 s, Result = 03200000, Performance =  66.20 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.052898 s, Result = 03340000, Performance =  66.58 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.054192 s, Result = 03480000, Performance =  66.57 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.056321 s, Result = 035c0000, Performance =  65.58 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.056478 s, Result = 03700000, Performance =  66.92 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.057356 s, Result = 03840000, Performance =  67.39 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.058680 s, Result = 03980000, Performance =  67.34 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.059510 s, Result = 03ac0000, Performance =  67.84 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.060437 s, Result = 03c00000, Performance =  68.22 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.060160 s, Result = 03d40000, Performance =  69.96 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.061285 s, Result = 03e80000, Performance =  70.08 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.062653 s, Result = 03fc0000, Performance =  69.92 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.062155 s, Result = 04100000, Performance =  71.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.062955 s, Result = 04240000, Performance =  72.32 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.063198 s, Result = 04380000, Performance =  73.40 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.060561 s, Result = 044c0000, Performance =  78.01 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.058204 s, Result = 04600000, Performance =  82.65 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.074702 s, Result = 04740000, Performance =  65.54 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.062287 s, Result = 04880000, Performance =  79.99 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.061078 s, Result = 049c0000, Performance =  82.98 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.061784 s, Result = 04b00000, Performance =  83.42 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.062834 s, Result = 04c40000, Performance =  83.39 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.065916 s, Result = 04d80000, Performance =  80.80 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.064056 s, Result = 04ec0000, Performance =  84.48 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.085559 s, Result = 05000000, Performance =  64.25 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   965  1516  1536
Test passed: M N K =   921  2022  1728
Test passed: M N K =  1511   566  1472
Test passed: M N K =  1813   423  1216
Test passed: M N K =  1214  1324  1344
M N K =  4096  4096   256, Elapsed time =   0.030467 s, Result = 10240000, Performance =   2.82 TOPS
M N K =  4096  4096   512, Elapsed time =   0.036153 s, Result = 10380000, Performance =   4.75 TOPS
M N K =  4096  4096   768, Elapsed time =   0.037557 s, Result = 104c0000, Performance =   6.86 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.052522 s, Result = 10600000, Performance =   6.54 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.050816 s, Result = 10740000, Performance =   8.45 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.043686 s, Result = 10880000, Performance =  11.80 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.041626 s, Result = 109c0000, Performance =  14.45 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.042875 s, Result = 10b00000, Performance =  16.03 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.044305 s, Result = 10c40000, Performance =  17.45 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.044968 s, Result = 10d80000, Performance =  19.10 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.046649 s, Result = 10ec0000, Performance =  20.26 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.048409 s, Result = 11000000, Performance =  21.29 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.051855 s, Result = 11140000, Performance =  21.53 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.051603 s, Result = 11280000, Performance =  23.30 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.050098 s, Result = 113c0000, Performance =  25.72 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.052818 s, Result = 11500000, Performance =  26.02 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.053554 s, Result = 11640000, Performance =  27.27 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.056488 s, Result = 11780000, Performance =  27.37 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.054384 s, Result = 118c0000, Performance =  30.01 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.060060 s, Result = 11a00000, Performance =  28.60 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.055113 s, Result = 11b40000, Performance =  32.73 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.057759 s, Result = 11c80000, Performance =  32.72 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.064291 s, Result = 11dc0000, Performance =  30.73 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.066854 s, Result = 11f00000, Performance =  30.84 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.069031 s, Result = 12040000, Performance =  31.11 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.066159 s, Result = 12180000, Performance =  33.76 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.068313 s, Result = 122c0000, Performance =  33.95 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.063908 s, Result = 12400000, Performance =  37.63 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.064905 s, Result = 12540000, Performance =  38.38 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.068831 s, Result = 12680000, Performance =  37.44 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.069887 s, Result = 127c0000, Performance =  38.10 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.078098 s, Result = 12900000, Performance =  35.20 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.070436 s, Result = 12a40000, Performance =  40.24 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.069980 s, Result = 12b80000, Performance =  41.73 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.063889 s, Result = 12cc0000, Performance =  47.06 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.064591 s, Result = 12e00000, Performance =  47.88 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.068704 s, Result = 12f40000, Performance =  46.26 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.068690 s, Result = 13080000, Performance =  47.52 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.070297 s, Result = 131c0000, Performance =  47.66 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.071435 s, Result = 13300000, Performance =  48.10 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.072271 s, Result = 13440000, Performance =  48.73 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.073789 s, Result = 13580000, Performance =  48.89 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.075826 s, Result = 136c0000, Performance =  48.71 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.075663 s, Result = 13800000, Performance =  49.95 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.076125 s, Result = 13940000, Performance =  50.78 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.076449 s, Result = 13a80000, Performance =  51.69 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.077252 s, Result = 13bc0000, Performance =  52.26 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.077707 s, Result = 13d00000, Performance =  53.06 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.078215 s, Result = 13e40000, Performance =  53.81 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.079275 s, Result = 13f80000, Performance =  54.18 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.080251 s, Result = 140c0000, Performance =  54.59 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.079536 s, Result = 14200000, Performance =  56.16 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.080098 s, Result = 14340000, Performance =  56.84 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.081092 s, Result = 14480000, Performance =  57.20 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.081180 s, Result = 145c0000, Performance =  58.20 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.081157 s, Result = 14700000, Performance =  59.27 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.082510 s, Result = 14840000, Performance =  59.34 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.083297 s, Result = 14980000, Performance =  59.81 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.084365 s, Result = 14ac0000, Performance =  60.07 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.081883 s, Result = 14c00000, Performance =  62.94 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.085112 s, Result = 14d40000, Performance =  61.56 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.084876 s, Result = 14e80000, Performance =  62.75 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.086526 s, Result = 14fc0000, Performance =  62.54 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.109799 s, Result = 15100000, Performance =  50.07 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1445  1900   960
Test passed: M N K =  1304   361   832
Test passed: M N K =   106  1492   320
Test passed: M N K =   199  1014   896
Test passed: M N K =  1248  1466  1024
M N K =  4096  4096   256, Elapsed time =   0.020698 s, Result = 00140000, Performance =   4.15 TOPS
M N K =  4096  4096   512, Elapsed time =   0.020762 s, Result = 00280000, Performance =   8.27 TOPS
M N K =  4096  4096   768, Elapsed time =   0.022855 s, Result = 003c0000, Performance =  11.28 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.025485 s, Result = 00500000, Performance =  13.48 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.025623 s, Result = 00640000, Performance =  16.76 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.026715 s, Result = 00780000, Performance =  19.29 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.028129 s, Result = 008c0000, Performance =  21.38 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029589 s, Result = 00a00000, Performance =  23.22 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.030750 s, Result = 00b40000, Performance =  25.14 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031903 s, Result = 00c80000, Performance =  26.93 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.036299 s, Result = 00dc0000, Performance =  26.03 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.038103 s, Result = 00f00000, Performance =  27.05 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.043042 s, Result = 01040000, Performance =  25.94 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.042832 s, Result = 01180000, Performance =  28.08 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.038784 s, Result = 012c0000, Performance =  33.22 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.039557 s, Result = 01400000, Performance =  34.74 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.039772 s, Result = 01540000, Performance =  36.72 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.040562 s, Result = 01680000, Performance =  38.12 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.042186 s, Result = 017c0000, Performance =  38.69 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043129 s, Result = 01900000, Performance =  39.83 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.050289 s, Result = 01a40000, Performance =  35.87 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.050035 s, Result = 01b80000, Performance =  37.77 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.044885 s, Result = 01cc0000, Performance =  44.02 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.045912 s, Result = 01e00000, Performance =  44.90 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.046540 s, Result = 01f40000, Performance =  46.14 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.047246 s, Result = 02080000, Performance =  47.27 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.048147 s, Result = 021c0000, Performance =  48.17 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.049594 s, Result = 02300000, Performance =  48.50 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.049710 s, Result = 02440000, Performance =  50.11 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.050910 s, Result = 02580000, Performance =  50.62 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.051606 s, Result = 026c0000, Performance =  51.60 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.059823 s, Result = 02800000, Performance =  45.95 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.053675 s, Result = 02940000, Performance =  52.81 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.052152 s, Result = 02a80000, Performance =  56.00 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.052604 s, Result = 02bc0000, Performance =  57.15 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.054271 s, Result = 02d00000, Performance =  56.98 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.056592 s, Result = 02e40000, Performance =  56.16 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.058415 s, Result = 02f80000, Performance =  55.88 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.059827 s, Result = 030c0000, Performance =  56.00 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.061200 s, Result = 03200000, Performance =  56.14 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.061845 s, Result = 03340000, Performance =  56.95 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.063087 s, Result = 03480000, Performance =  57.19 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.065310 s, Result = 035c0000, Performance =  56.56 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.064325 s, Result = 03700000, Performance =  58.76 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.065318 s, Result = 03840000, Performance =  59.18 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.065803 s, Result = 03980000, Performance =  60.05 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.066596 s, Result = 03ac0000, Performance =  60.62 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.067357 s, Result = 03c00000, Performance =  61.21 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.067815 s, Result = 03d40000, Performance =  62.07 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.069423 s, Result = 03e80000, Performance =  61.87 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.069973 s, Result = 03fc0000, Performance =  62.61 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.068897 s, Result = 04100000, Performance =  64.83 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.069332 s, Result = 04240000, Performance =  65.67 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.070834 s, Result = 04380000, Performance =  65.49 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.071253 s, Result = 044c0000, Performance =  66.31 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.071158 s, Result = 04600000, Performance =  67.60 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.071978 s, Result = 04740000, Performance =  68.02 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.072680 s, Result = 04880000, Performance =  68.55 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.072755 s, Result = 049c0000, Performance =  69.66 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.071541 s, Result = 04b00000, Performance =  72.04 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.073577 s, Result = 04c40000, Performance =  71.22 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.073882 s, Result = 04d80000, Performance =  72.08 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.075924 s, Result = 04ec0000, Performance =  71.28 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.099076 s, Result = 05000000, Performance =  55.49 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 512, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   192   606   640
Test passed: M N K =   319   806  1600
Test passed: M N K =  1149   216  1920
Test passed: M N K =   806  1834   512
Test passed: M N K =  1476  1711    64
M N K =  4096  4096   256, Elapsed time =   0.015753 s, Result = a0b40000, Performance =   5.45 TOPS
M N K =  4096  4096   512, Elapsed time =   0.016027 s, Result = a0c80000, Performance =  10.72 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016716 s, Result = a0dc0000, Performance =  15.42 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017565 s, Result = a0f00000, Performance =  19.56 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.025818 s, Result = a1040000, Performance =  16.64 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.026674 s, Result = a1180000, Performance =  19.32 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.027527 s, Result = a12c0000, Performance =  21.84 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.028448 s, Result = a1400000, Performance =  24.16 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.030356 s, Result = a1540000, Performance =  25.47 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031126 s, Result = a1680000, Performance =  27.60 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.023681 s, Result = a17c0000, Performance =  39.90 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.024684 s, Result = a1900000, Performance =  41.76 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.028269 s, Result = a1a40000, Performance =  39.50 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.037035 s, Result = a1b80000, Performance =  32.47 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.038190 s, Result = a1cc0000, Performance =  33.74 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.039547 s, Result = a1e00000, Performance =  34.75 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.040550 s, Result = a1f40000, Performance =  36.01 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.040818 s, Result = a2080000, Performance =  37.88 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.041842 s, Result = a21c0000, Performance =  39.01 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.043433 s, Result = a2300000, Performance =  39.55 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.037322 s, Result = a2440000, Performance =  48.33 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.037346 s, Result = a2580000, Performance =  50.60 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.038780 s, Result = a26c0000, Performance =  50.95 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.039807 s, Result = a2800000, Performance =  51.79 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.040600 s, Result = a2940000, Performance =  52.89 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.041251 s, Result = a2a80000, Performance =  54.14 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.042135 s, Result = a2bc0000, Performance =  55.04 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.042803 s, Result = a2d00000, Performance =  56.19 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.043488 s, Result = a2e40000, Performance =  57.28 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.044324 s, Result = a2f80000, Performance =  58.14 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.045407 s, Result = a30c0000, Performance =  58.64 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.053395 s, Result = a3200000, Performance =  51.48 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.046612 s, Result = a3340000, Performance =  60.81 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.045326 s, Result = a3480000, Performance =  64.43 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.046110 s, Result = a35c0000, Performance =  65.20 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.047538 s, Result = a3700000, Performance =  65.05 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.056841 s, Result = a3840000, Performance =  55.91 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.051244 s, Result = a3980000, Performance =  63.70 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.053044 s, Result = a3ac0000, Performance =  63.16 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.054249 s, Result = a3c00000, Performance =  63.34 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.055574 s, Result = a3d40000, Performance =  63.37 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.055986 s, Result = a3e80000, Performance =  64.44 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.058061 s, Result = a3fc0000, Performance =  63.62 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.058032 s, Result = a4100000, Performance =  65.13 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.058610 s, Result = a4240000, Performance =  65.95 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.059191 s, Result = a4380000, Performance =  66.76 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.060322 s, Result = a44c0000, Performance =  66.93 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.060945 s, Result = a4600000, Performance =  67.65 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.061199 s, Result = a4740000, Performance =  68.78 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.062247 s, Result = a4880000, Performance =  69.00 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.063539 s, Result = a49c0000, Performance =  68.95 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.062881 s, Result = a4b00000, Performance =  71.04 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.063571 s, Result = a4c40000, Performance =  71.62 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.064498 s, Result = a4d80000, Performance =  71.92 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.064854 s, Result = a4ec0000, Performance =  72.85 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.064629 s, Result = a5000000, Performance =  74.43 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.065614 s, Result = a5140000, Performance =  74.62 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.066237 s, Result = a5280000, Performance =  75.22 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.067159 s, Result = a53c0000, Performance =  75.46 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.065086 s, Result = a5500000, Performance =  79.19 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.068501 s, Result = a5640000, Performance =  76.49 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.067689 s, Result = a5780000, Performance =  78.68 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.069905 s, Result = a58c0000, Performance =  77.42 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.093984 s, Result = a5a00000, Performance =  58.49 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=512 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 512, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =  1448  1524   512
Test passed: M N K =  1269  1339   512
Test passed: M N K =   281   963  1088
Test passed: M N K =   328     3   960
Test passed: M N K =  1537  1481  1024
M N K =  4096  4096   256, Elapsed time =   0.001064 s, Result = 00140000, Performance =  80.77 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002110 s, Result = 00280000, Performance =  81.44 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003014 s, Result = 003c0000, Performance =  85.51 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.003234 s, Result = 00500000, Performance = 106.24 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002313 s, Result = 00640000, Performance = 185.65 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.003009 s, Result = 00780000, Performance = 171.26 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003820 s, Result = 008c0000, Performance = 157.42 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004508 s, Result = 00a00000, Performance = 152.43 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.005012 s, Result = 00b40000, Performance = 154.25 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.005930 s, Result = 00c80000, Performance = 144.85 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.006857 s, Result = 00dc0000, Performance = 137.81 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.008370 s, Result = 00f00000, Performance = 123.15 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.009732 s, Result = 01040000, Performance = 114.74 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019316 s, Result = 01180000, Performance =  62.26 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.013022 s, Result = 012c0000, Performance =  98.95 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.014949 s, Result = 01400000, Performance =  91.94 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.016732 s, Result = 01540000, Performance =  87.27 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.021961 s, Result = 01680000, Performance =  70.41 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.023039 s, Result = 017c0000, Performance =  70.84 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.024353 s, Result = 01900000, Performance =  70.54 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.030307 s, Result = 01a40000, Performance =  59.52 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.026179 s, Result = 01b80000, Performance =  72.19 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.027597 s, Result = 01cc0000, Performance =  71.59 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.028417 s, Result = 01e00000, Performance =  72.55 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.036065 s, Result = 01f40000, Performance =  59.55 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.030332 s, Result = 02080000, Performance =  73.63 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.030588 s, Result = 021c0000, Performance =  75.82 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.031949 s, Result = 02300000, Performance =  75.28 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.032494 s, Result = 02440000, Performance =  76.66 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.038787 s, Result = 02580000, Performance =  66.44 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.040882 s, Result = 026c0000, Performance =  65.14 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.049413 s, Result = 02800000, Performance =  55.63 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.042322 s, Result = 02940000, Performance =  66.98 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.040751 s, Result = 02a80000, Performance =  71.67 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.042581 s, Result = 02bc0000, Performance =  70.61 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.043532 s, Result = 02d00000, Performance =  71.04 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.045977 s, Result = 02e40000, Performance =  69.13 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.047762 s, Result = 02f80000, Performance =  68.34 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.049284 s, Result = 030c0000, Performance =  67.97 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.050413 s, Result = 03200000, Performance =  68.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.051489 s, Result = 03340000, Performance =  68.40 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.052080 s, Result = 03480000, Performance =  69.27 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.054497 s, Result = 035c0000, Performance =  67.78 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.053300 s, Result = 03700000, Performance =  70.91 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.054338 s, Result = 03840000, Performance =  71.14 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.048982 s, Result = 03980000, Performance =  80.67 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.049919 s, Result = 03ac0000, Performance =  80.88 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.050877 s, Result = 03c00000, Performance =  81.04 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.050534 s, Result = 03d40000, Performance =  83.29 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.051976 s, Result = 03e80000, Performance =  82.63 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.052444 s, Result = 03fc0000, Performance =  83.53 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.051748 s, Result = 04100000, Performance =  86.32 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.052582 s, Result = 04240000, Performance =  86.58 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.053834 s, Result = 04380000, Performance =  86.16 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.054243 s, Result = 044c0000, Performance =  87.10 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.054146 s, Result = 04600000, Performance =  88.84 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.055315 s, Result = 04740000, Performance =  88.52 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.055963 s, Result = 04880000, Performance =  89.03 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.055917 s, Result = 049c0000, Performance =  90.64 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.054661 s, Result = 04b00000, Performance =  94.29 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.056755 s, Result = 04c40000, Performance =  92.32 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.057319 s, Result = 04d80000, Performance =  92.91 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.058786 s, Result = 04ec0000, Performance =  92.06 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.081913 s, Result = 05000000, Performance =  67.11 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   820   339  1920
Test passed: M N K =   545   548  1408
Test passed: M N K =  1977   640   512
Test passed: M N K =   658   367  1408
Test passed: M N K =   723   470   192
M N K =  4096  4096   256, Elapsed time =   0.030595 s, Result = 10240000, Performance =   2.81 TOPS
M N K =  4096  4096   512, Elapsed time =   0.036240 s, Result = 10380000, Performance =   4.74 TOPS
M N K =  4096  4096   768, Elapsed time =   0.036722 s, Result = 104c0000, Performance =   7.02 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.037703 s, Result = 10600000, Performance =   9.11 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.038748 s, Result = 10740000, Performance =  11.08 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.040434 s, Result = 10880000, Performance =  12.75 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.046391 s, Result = 109c0000, Performance =  12.96 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.042810 s, Result = 10b00000, Performance =  16.05 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.044758 s, Result = 10c40000, Performance =  17.27 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.045801 s, Result = 10d80000, Performance =  18.76 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.046787 s, Result = 10ec0000, Performance =  20.20 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.047516 s, Result = 11000000, Performance =  21.69 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.048129 s, Result = 11140000, Performance =  23.20 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.048803 s, Result = 11280000, Performance =  24.64 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.051128 s, Result = 113c0000, Performance =  25.20 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.054934 s, Result = 11500000, Performance =  25.02 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.051223 s, Result = 11640000, Performance =  28.51 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.056154 s, Result = 11780000, Performance =  27.53 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.053716 s, Result = 118c0000, Performance =  30.38 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.055179 s, Result = 11a00000, Performance =  31.14 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.054854 s, Result = 11b40000, Performance =  32.89 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.056824 s, Result = 11c80000, Performance =  33.26 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.057855 s, Result = 11dc0000, Performance =  34.15 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.057902 s, Result = 11f00000, Performance =  35.60 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.059517 s, Result = 12040000, Performance =  36.08 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.067607 s, Result = 12180000, Performance =  33.03 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.067489 s, Result = 122c0000, Performance =  34.37 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.068188 s, Result = 12400000, Performance =  35.27 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.061515 s, Result = 12540000, Performance =  40.50 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.062399 s, Result = 12680000, Performance =  41.30 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.063866 s, Result = 127c0000, Performance =  41.70 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.068609 s, Result = 12900000, Performance =  40.06 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.064559 s, Result = 12a40000, Performance =  43.91 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.065782 s, Result = 12b80000, Performance =  44.40 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.066745 s, Result = 12cc0000, Performance =  45.04 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.066705 s, Result = 12e00000, Performance =  46.36 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.067984 s, Result = 12f40000, Performance =  46.75 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.069782 s, Result = 13080000, Performance =  46.78 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.068983 s, Result = 131c0000, Performance =  48.56 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.069887 s, Result = 13300000, Performance =  49.16 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.070626 s, Result = 13440000, Performance =  49.87 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.073055 s, Result = 13580000, Performance =  49.38 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.074717 s, Result = 136c0000, Performance =  49.44 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.074017 s, Result = 13800000, Performance =  51.06 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.075544 s, Result = 13940000, Performance =  51.17 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.075148 s, Result = 13a80000, Performance =  52.58 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.076349 s, Result = 13bc0000, Performance =  52.88 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.077087 s, Result = 13d00000, Performance =  53.49 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.076860 s, Result = 13e40000, Performance =  54.76 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.077856 s, Result = 13f80000, Performance =  55.17 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.081088 s, Result = 140c0000, Performance =  54.03 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.079148 s, Result = 14200000, Performance =  56.44 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.082977 s, Result = 14340000, Performance =  54.87 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.081379 s, Result = 14480000, Performance =  57.00 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.084116 s, Result = 145c0000, Performance =  56.17 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.083849 s, Result = 14700000, Performance =  57.37 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.085978 s, Result = 14840000, Performance =  56.95 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.085209 s, Result = 14980000, Performance =  58.47 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.085408 s, Result = 14ac0000, Performance =  59.34 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.084366 s, Result = 14c00000, Performance =  61.09 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.087754 s, Result = 14d40000, Performance =  59.71 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.088130 s, Result = 14e80000, Performance =  60.43 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.085786 s, Result = 14fc0000, Performance =  63.08 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.112388 s, Result = 15100000, Performance =  48.92 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=1 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 1, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   563  1087   448
Test passed: M N K =   738  1881  1152
Test passed: M N K =  1267  1300   768
Test passed: M N K =   288   647  1984
Test passed: M N K =     6   132  1216
M N K =  4096  4096   256, Elapsed time =   0.019433 s, Result = 00140000, Performance =   4.42 TOPS
M N K =  4096  4096   512, Elapsed time =   0.020978 s, Result = 00280000, Performance =   8.19 TOPS
M N K =  4096  4096   768, Elapsed time =   0.022926 s, Result = 003c0000, Performance =  11.24 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.024013 s, Result = 00500000, Performance =  14.31 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.025186 s, Result = 00640000, Performance =  17.05 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.026619 s, Result = 00780000, Performance =  19.36 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.028082 s, Result = 008c0000, Performance =  21.41 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029050 s, Result = 00a00000, Performance =  23.66 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.030614 s, Result = 00b40000, Performance =  25.25 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.031871 s, Result = 00c80000, Performance =  26.95 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.033225 s, Result = 00dc0000, Performance =  28.44 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.034212 s, Result = 00f00000, Performance =  30.13 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.035869 s, Result = 01040000, Performance =  31.13 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.042804 s, Result = 01180000, Performance =  28.10 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.041152 s, Result = 012c0000, Performance =  31.31 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.047064 s, Result = 01400000, Performance =  29.20 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.048952 s, Result = 01540000, Performance =  29.83 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.048763 s, Result = 01680000, Performance =  31.71 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.050028 s, Result = 017c0000, Performance =  32.62 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.049490 s, Result = 01900000, Performance =  34.71 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.041342 s, Result = 01a40000, Performance =  43.63 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.042433 s, Result = 01b80000, Performance =  44.54 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.043486 s, Result = 01cc0000, Performance =  45.43 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.044703 s, Result = 01e00000, Performance =  46.12 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.052204 s, Result = 01f40000, Performance =  41.14 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.046477 s, Result = 02080000, Performance =  48.05 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.047651 s, Result = 021c0000, Performance =  48.67 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.048092 s, Result = 02300000, Performance =  50.01 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.048984 s, Result = 02440000, Performance =  50.85 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.049763 s, Result = 02580000, Performance =  51.79 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.051167 s, Result = 026c0000, Performance =  52.04 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.056652 s, Result = 02800000, Performance =  48.52 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.052445 s, Result = 02940000, Performance =  54.05 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.068335 s, Result = 02a80000, Performance =  42.74 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.053787 s, Result = 02bc0000, Performance =  55.90 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.053622 s, Result = 02d00000, Performance =  57.67 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.055197 s, Result = 02e40000, Performance =  57.58 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.055042 s, Result = 02f80000, Performance =  59.30 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.056751 s, Result = 030c0000, Performance =  59.03 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.058596 s, Result = 03200000, Performance =  58.64 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.057800 s, Result = 03340000, Performance =  60.93 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.068276 s, Result = 03480000, Performance =  52.84 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.062256 s, Result = 035c0000, Performance =  59.33 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.060945 s, Result = 03700000, Performance =  62.02 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.062280 s, Result = 03840000, Performance =  62.07 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.063180 s, Result = 03980000, Performance =  62.54 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.066229 s, Result = 03ac0000, Performance =  60.96 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.064501 s, Result = 03c00000, Performance =  63.92 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.064576 s, Result = 03d40000, Performance =  65.18 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.065981 s, Result = 03e80000, Performance =  65.09 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.067472 s, Result = 03fc0000, Performance =  64.93 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.066799 s, Result = 04100000, Performance =  66.87 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.068417 s, Result = 04240000, Performance =  66.54 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.068300 s, Result = 04380000, Performance =  67.91 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.069591 s, Result = 044c0000, Performance =  67.89 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.070393 s, Result = 04600000, Performance =  68.34 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.071821 s, Result = 04740000, Performance =  68.17 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.072894 s, Result = 04880000, Performance =  68.35 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.073029 s, Result = 049c0000, Performance =  69.40 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.071440 s, Result = 04b00000, Performance =  72.14 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.074100 s, Result = 04c40000, Performance =  70.71 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.075171 s, Result = 04d80000, Performance =  70.85 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.072513 s, Result = 04ec0000, Performance =  74.63 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.096925 s, Result = 05000000, Performance =  56.72 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=1 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 1, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   655  1491   256
Test passed: M N K =   507   638  1920
Test passed: M N K =   266  1063  2048
Test passed: M N K =   570   801  1280
Test passed: M N K =   340  1285  1280
M N K =  4096  4096   256, Elapsed time =   0.015910 s, Result = a0b40000, Performance =   5.40 TOPS
M N K =  4096  4096   512, Elapsed time =   0.016140 s, Result = a0c80000, Performance =  10.64 TOPS
M N K =  4096  4096   768, Elapsed time =   0.016992 s, Result = a0dc0000, Performance =  15.17 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.017650 s, Result = a0f00000, Performance =  19.47 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.018707 s, Result = a1040000, Performance =  22.96 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.019536 s, Result = a1180000, Performance =  26.38 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.020299 s, Result = a12c0000, Performance =  29.62 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.029490 s, Result = a1400000, Performance =  23.30 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.021798 s, Result = a1540000, Performance =  35.47 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.028869 s, Result = a1680000, Performance =  29.75 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.023317 s, Result = a17c0000, Performance =  40.52 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.024500 s, Result = a1900000, Performance =  42.07 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.025897 s, Result = a1a40000, Performance =  43.12 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.027642 s, Result = a1b80000, Performance =  43.51 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.029986 s, Result = a1cc0000, Performance =  42.97 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.031630 s, Result = a1e00000, Performance =  43.45 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.034085 s, Result = a1f40000, Performance =  42.84 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.034007 s, Result = a2080000, Performance =  45.47 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.035086 s, Result = a21c0000, Performance =  46.52 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.042400 s, Result = a2300000, Performance =  40.52 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.040289 s, Result = a2440000, Performance =  44.77 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.038949 s, Result = a2580000, Performance =  48.52 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.038723 s, Result = a26c0000, Performance =  51.02 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.041174 s, Result = a2800000, Performance =  50.07 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.047500 s, Result = a2940000, Performance =  45.21 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.048633 s, Result = a2a80000, Performance =  45.92 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.044861 s, Result = a2bc0000, Performance =  51.70 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.041594 s, Result = a2d00000, Performance =  57.82 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.047172 s, Result = a2e40000, Performance =  52.81 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.044003 s, Result = a2f80000, Performance =  58.56 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.048635 s, Result = a30c0000, Performance =  54.75 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.050392 s, Result = a3200000, Performance =  54.55 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.046277 s, Result = a3340000, Performance =  61.25 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.048069 s, Result = a3480000, Performance =  60.76 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.047641 s, Result = a35c0000, Performance =  63.11 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.047443 s, Result = a3700000, Performance =  65.18 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.051859 s, Result = a3840000, Performance =  61.29 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.053942 s, Result = a3980000, Performance =  60.51 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.050218 s, Result = a3ac0000, Performance =  66.71 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.051286 s, Result = a3c00000, Performance =  67.00 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.051679 s, Result = a3d40000, Performance =  68.15 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.053945 s, Result = a3e80000, Performance =  66.88 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.055459 s, Result = a3fc0000, Performance =  66.60 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.054521 s, Result = a4100000, Performance =  69.32 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.056370 s, Result = a4240000, Performance =  68.57 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.057601 s, Result = a4380000, Performance =  68.60 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.057527 s, Result = a44c0000, Performance =  70.18 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.058262 s, Result = a4600000, Performance =  70.77 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.058383 s, Result = a4740000, Performance =  72.09 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.059533 s, Result = a4880000, Performance =  72.14 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.062188 s, Result = a49c0000, Performance =  70.45 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.060653 s, Result = a4b00000, Performance =  73.64 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.062210 s, Result = a4c40000, Performance =  73.18 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.063428 s, Result = a4d80000, Performance =  73.13 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.064171 s, Result = a4ec0000, Performance =  73.62 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.063361 s, Result = a5000000, Performance =  75.92 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.065438 s, Result = a5140000, Performance =  74.82 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.066443 s, Result = a5280000, Performance =  74.98 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.066025 s, Result = a53c0000, Performance =  76.76 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.067442 s, Result = a5500000, Performance =  76.42 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.068557 s, Result = a5640000, Performance =  76.43 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.068840 s, Result = a5780000, Performance =  77.36 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.066123 s, Result = a58c0000, Performance =  81.84 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.090409 s, Result = a5a00000, Performance =  60.81 TOPS
cc -Ofast -march=native -fno-strict-aliasing -fopenmp -DCACHELINE=64 -DTM=1024 -DTN=1024 -DTK=1024 -DTEST_M=4096 -DTEST_N=4096 -DTEST_K_MAX=16384 -DTEST_K_STRIDE=256 -DSINGLE_CORE=0 -DMULTI_CORE=1 -DCORES_M=4 -DCORES_N=4 -DCORE_START=0 -DCORE_STRIDE=2 -DLOAD_C=0 -DLOAD_AB=1 -DSTORE_C=0 -DFLUSH_CACHE=1 -DFLUSH_CACHE_SIZE=100*1024*1024 -DAPAD=0 -DBPAD=0 -DCPAD=0 amx-gemm.c -o amx-gemm
objdump -d amx-gemm > amx-gemm.s
./amx-gemm
Test 16 CPU Cores (4 Cores x 4 Cores)(Core 0 - Core 15 per 2 Cores), TM TN TK = 1024 1024 1024, LOAD_C = 0, LOAD_AB = 1, STORE_C = 0, A/B/C PAD = 0 0 0, Flush Cache 100 MB
Test passed: M N K =   841  1181  1856
Test passed: M N K =   410  1430   896
Test passed: M N K =   841   342  1728
Test passed: M N K =   218   602   832
Test passed: M N K =  1284  1892   896
M N K =  4096  4096   256, Elapsed time =   0.001073 s, Result = 00140000, Performance =  80.02 TOPS
M N K =  4096  4096   512, Elapsed time =   0.002104 s, Result = 00280000, Performance =  81.67 TOPS
M N K =  4096  4096   768, Elapsed time =   0.003421 s, Result = 003c0000, Performance =  75.32 TOPS
M N K =  4096  4096  1024, Elapsed time =   0.004280 s, Result = 00500000, Performance =  80.28 TOPS
M N K =  4096  4096  1280, Elapsed time =   0.002110 s, Result = 00640000, Performance = 203.57 TOPS
M N K =  4096  4096  1536, Elapsed time =   0.002790 s, Result = 00780000, Performance = 184.73 TOPS
M N K =  4096  4096  1792, Elapsed time =   0.003437 s, Result = 008c0000, Performance = 174.95 TOPS
M N K =  4096  4096  2048, Elapsed time =   0.004026 s, Result = 00a00000, Performance = 170.68 TOPS
M N K =  4096  4096  2304, Elapsed time =   0.004820 s, Result = 00b40000, Performance = 160.38 TOPS
M N K =  4096  4096  2560, Elapsed time =   0.015207 s, Result = 00c80000, Performance =  56.49 TOPS
M N K =  4096  4096  2816, Elapsed time =   0.015980 s, Result = 00dc0000, Performance =  59.13 TOPS
M N K =  4096  4096  3072, Elapsed time =   0.007756 s, Result = 00f00000, Performance = 132.90 TOPS
M N K =  4096  4096  3328, Elapsed time =   0.017458 s, Result = 01040000, Performance =  63.96 TOPS
M N K =  4096  4096  3584, Elapsed time =   0.019259 s, Result = 01180000, Performance =  62.44 TOPS
M N K =  4096  4096  3840, Elapsed time =   0.020926 s, Result = 012c0000, Performance =  61.57 TOPS
M N K =  4096  4096  4096, Elapsed time =   0.022281 s, Result = 01400000, Performance =  61.68 TOPS
M N K =  4096  4096  4352, Elapsed time =   0.024788 s, Result = 01540000, Performance =  58.91 TOPS
M N K =  4096  4096  4608, Elapsed time =   0.016250 s, Result = 01680000, Performance =  95.15 TOPS
M N K =  4096  4096  4864, Elapsed time =   0.027055 s, Result = 017c0000, Performance =  60.32 TOPS
M N K =  4096  4096  5120, Elapsed time =   0.018950 s, Result = 01900000, Performance =  90.66 TOPS
M N K =  4096  4096  5376, Elapsed time =   0.023106 s, Result = 01a40000, Performance =  78.07 TOPS
M N K =  4096  4096  5632, Elapsed time =   0.024821 s, Result = 01b80000, Performance =  76.14 TOPS
M N K =  4096  4096  5888, Elapsed time =   0.033450 s, Result = 01cc0000, Performance =  59.06 TOPS
M N K =  4096  4096  6144, Elapsed time =   0.035517 s, Result = 01e00000, Performance =  58.05 TOPS
M N K =  4096  4096  6400, Elapsed time =   0.028034 s, Result = 01f40000, Performance =  76.60 TOPS
M N K =  4096  4096  6656, Elapsed time =   0.028919 s, Result = 02080000, Performance =  77.23 TOPS
M N K =  4096  4096  6912, Elapsed time =   0.030006 s, Result = 021c0000, Performance =  77.30 TOPS
M N K =  4096  4096  7168, Elapsed time =   0.030494 s, Result = 02300000, Performance =  78.87 TOPS
M N K =  4096  4096  7424, Elapsed time =   0.031185 s, Result = 02440000, Performance =  79.88 TOPS
M N K =  4096  4096  7680, Elapsed time =   0.032097 s, Result = 02580000, Performance =  80.29 TOPS
M N K =  4096  4096  7936, Elapsed time =   0.033089 s, Result = 026c0000, Performance =  80.48 TOPS
M N K =  4096  4096  8192, Elapsed time =   0.038825 s, Result = 02800000, Performance =  70.80 TOPS
M N K =  4096  4096  8448, Elapsed time =   0.034653 s, Result = 02940000, Performance =  81.80 TOPS
M N K =  4096  4096  8704, Elapsed time =   0.036227 s, Result = 02a80000, Performance =  80.62 TOPS
M N K =  4096  4096  8960, Elapsed time =   0.035916 s, Result = 02bc0000, Performance =  83.71 TOPS
M N K =  4096  4096  9216, Elapsed time =   0.035450 s, Result = 02d00000, Performance =  87.23 TOPS
M N K =  4096  4096  9472, Elapsed time =   0.036585 s, Result = 02e40000, Performance =  86.87 TOPS
M N K =  4096  4096  9728, Elapsed time =   0.037803 s, Result = 02f80000, Performance =  86.35 TOPS
M N K =  4096  4096  9984, Elapsed time =   0.039141 s, Result = 030c0000, Performance =  85.59 TOPS
M N K =  4096  4096 10240, Elapsed time =   0.039787 s, Result = 03200000, Performance =  86.36 TOPS
M N K =  4096  4096 10496, Elapsed time =   0.040630 s, Result = 03340000, Performance =  86.68 TOPS
M N K =  4096  4096 10752, Elapsed time =   0.043233 s, Result = 03480000, Performance =  83.45 TOPS
M N K =  4096  4096 11008, Elapsed time =   0.045382 s, Result = 035c0000, Performance =  81.39 TOPS
M N K =  4096  4096 11264, Elapsed time =   0.044237 s, Result = 03700000, Performance =  85.44 TOPS
M N K =  4096  4096 11520, Elapsed time =   0.045209 s, Result = 03840000, Performance =  85.50 TOPS
M N K =  4096  4096 11776, Elapsed time =   0.045963 s, Result = 03980000, Performance =  85.97 TOPS
M N K =  4096  4096 12032, Elapsed time =   0.046149 s, Result = 03ac0000, Performance =  87.48 TOPS
M N K =  4096  4096 12288, Elapsed time =   0.047704 s, Result = 03c00000, Performance =  86.43 TOPS
M N K =  4096  4096 12544, Elapsed time =   0.047167 s, Result = 03d40000, Performance =  89.24 TOPS
M N K =  4096  4096 12800, Elapsed time =   0.048706 s, Result = 03e80000, Performance =  88.18 TOPS
M N K =  4096  4096 13056, Elapsed time =   0.051063 s, Result = 03fc0000, Performance =  85.79 TOPS
M N K =  4096  4096 13312, Elapsed time =   0.050104 s, Result = 04100000, Performance =  89.15 TOPS
M N K =  4096  4096 13568, Elapsed time =   0.051518 s, Result = 04240000, Performance =  88.37 TOPS
M N K =  4096  4096 13824, Elapsed time =   0.052220 s, Result = 04380000, Performance =  88.83 TOPS
M N K =  4096  4096 14080, Elapsed time =   0.053006 s, Result = 044c0000, Performance =  89.13 TOPS
M N K =  4096  4096 14336, Elapsed time =   0.053451 s, Result = 04600000, Performance =  90.00 TOPS
M N K =  4096  4096 14592, Elapsed time =   0.053946 s, Result = 04740000, Performance =  90.76 TOPS
M N K =  4096  4096 14848, Elapsed time =   0.060591 s, Result = 04880000, Performance =  82.23 TOPS
M N K =  4096  4096 15104, Elapsed time =   0.055668 s, Result = 049c0000, Performance =  91.04 TOPS
M N K =  4096  4096 15360, Elapsed time =   0.057511 s, Result = 04b00000, Performance =  89.62 TOPS
M N K =  4096  4096 15616, Elapsed time =   0.056826 s, Result = 04c40000, Performance =  92.21 TOPS
M N K =  4096  4096 15872, Elapsed time =   0.057268 s, Result = 04d80000, Performance =  93.00 TOPS
M N K =  4096  4096 16128, Elapsed time =   0.055615 s, Result = 04ec0000, Performance =  97.31 TOPS
M N K =  4096  4096 16384, Elapsed time =   0.080015 s, Result = 05000000, Performance =  68.71 TOPS
